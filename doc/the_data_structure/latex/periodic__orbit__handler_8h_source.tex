\hypertarget{periodic__orbit__handler_8h_source}{}\doxysection{periodic\+\_\+orbit\+\_\+handler.\+h}
\label{periodic__orbit__handler_8h_source}\index{periodic\_orbit\_handler.h@{periodic\_orbit\_handler.h}}
\mbox{\hyperlink{periodic__orbit__handler_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00026}00026 \textcolor{preprocessor}{\#ifndef OOMPH\_PERIODIC\_ORBIT\_HANDLER\_CLASS\_HEADER}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00027}00027 \textcolor{preprocessor}{\#define OOMPH\_PERIODIC\_ORBIT\_HANDLER\_CLASS\_HEADER}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00029}00029 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00030}00030 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00031}00031 \textcolor{preprocessor}{\#include <oomph-\/lib-\/config.h>}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00032}00032 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00034}00034 \textcolor{comment}{// OOMPH-\/LIB headers}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00035}00035 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{matrices_8h}{matrices.h}}"{}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{linear__solver_8h}{linear\_solver.h}}"{}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{double__vector__with__halo_8h}{double\_vector\_with\_halo.h}}"{}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00038}00038 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{problem_8h}{problem.h}}"{}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00039}00039 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{assembly__handler_8h}{assembly\_handler.h}}"{}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00040}00040 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{refineable__line__spectral__element_8h}{refineable\_line\_spectral\_element.h}}"{}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00041}00041 \textcolor{preprocessor}{\#include "{}../meshes/one\_d\_mesh.template.h"{}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00042}00042 \textcolor{preprocessor}{\#include "{}../meshes/one\_d\_mesh.template.cc"{}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00043}00043 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00044}00044 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00045}00045 \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00046}00046   \textcolor{keyword}{class }PeriodicOrbitEquations;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00048}00048   \textcolor{keyword}{class }PeriodicOrbitAssemblyHandlerBase;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00050}00050   \textcolor{comment}{//====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00051}00051 \textcolor{comment}{  /// Timestepper used to  calculate periodic orbits directly. It's}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00052}00052 \textcolor{comment}{  /// not really a "{}timestepper"{} per se, but represents the time storage}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00053}00053 \textcolor{comment}{  /// and means of calculating time-\/derivatives given the underlying}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00054}00054 \textcolor{comment}{  /// discretisation.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00055}00055 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00056}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{00056}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00057}00057   \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00058}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a3652005e173ad0e9d796ff415406c9c4}{00058}}     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations}{PeriodicOrbitEquations}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00060}00060   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00061}00061 \textcolor{comment}{    /// Constructor for the case when we allow adaptive timestepping}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00062}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a7167c51f5a15cd10f9cf1d534534d0ab}{00062}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a7167c51f5a15cd10f9cf1d534534d0ab}{PeriodicOrbitTimeDiscretisation}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_tstorage)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00063}00063       : \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}(n\_tstorage, 1)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00064}00064     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00065}00065       \mbox{\hyperlink{classoomph_1_1TimeStepper_a39dfe6cf216263d547c430d6f7a67530}{Type}} = \textcolor{stringliteral}{"{}PeriodicOrbitTimeDiscretisation"{}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00066}00066     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00068}00068 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00069}00069 \textcolor{comment}{    /// Broken copy constructor}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00070}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_acc69575564a4216a935d0c107218d8ec}{00070}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_acc69575564a4216a935d0c107218d8ec}{PeriodicOrbitTimeDiscretisation}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}\&) =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00071}00071       \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00072}00072 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00073}00073 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00074}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_add4780d54ed3afe64d59fc2d894c9603}{00074}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_add4780d54ed3afe64d59fc2d894c9603}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00075}00075 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00076}00076 \textcolor{comment}{    /// Return the actual order of the scheme}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00077}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a395bce926ad4a0dfb474aaf05f607b99}{00077}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a395bce926ad4a0dfb474aaf05f607b99}{order}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00078}00078 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00079}00079       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00080}00080     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00081}00081 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00082}00082 \textcolor{comment}{    /// Broken initialisation the time-\/history for the Data values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00083}00083 \textcolor{comment}{    /// corresponding to an impulsive start.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00084}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a45c5cd901ddf52fb1566665a2e161497}{00084}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a45c5cd901ddf52fb1566665a2e161497}{assign\_initial\_values\_impulsive}}(\mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const}\& data\_pt)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00085}00085     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00086}00086       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00087}00087         \textcolor{stringliteral}{"{}Cannot perform impulsive start for PeriodicOrbitTimeDiscretisation"{}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00088}00088         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00089}00089         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00090}00090     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00091}00091 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00092}00092 \textcolor{comment}{    /// Broken initialisation of}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00093}00093 \textcolor{comment}{    /// the positions for the node corresponding to an impulsive start}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00094}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_ab0445858504afb534970431e8bf2d3c6}{00094}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_ab0445858504afb534970431e8bf2d3c6}{assign\_initial\_positions\_impulsive}}(\mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const}\& node\_pt)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00095}00095     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00096}00096       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00097}00097         \textcolor{stringliteral}{"{}Cannot perform impulsive start for PeriodicOrbitTimeDiscretisation"{}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00098}00098         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00099}00099         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00100}00100     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00102}00102 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00103}00103 \textcolor{comment}{    /// Typedef for function that returns the (scalar) initial}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00104}00104 \textcolor{comment}{    /// value at a given value of the continuous time t.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00105}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a0bccd8d239689d95cf7422d877a5eed8}{00105}} \textcolor{comment}{}    \textcolor{keyword}{typedef} double (*\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a0bccd8d239689d95cf7422d877a5eed8}{InitialConditionFctPt}})(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00106}00106 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00107}00107 \textcolor{comment}{    ///  Initialise the time-\/history for the Data values,}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00108}00108 \textcolor{comment}{    /// corresponding to given time history, specified by}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00109}00109 \textcolor{comment}{    /// Vector of function pointers.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00110}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_abdbc5908a5f202d6ecf37fd1a1431292}{00110}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_abdbc5908a5f202d6ecf37fd1a1431292}{assign\_initial\_data\_values}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00111}00111       \mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const}\& data\_pt, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<InitialConditionFctPt>}} initial\_value\_fct)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00112}00112     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00113}00113       \textcolor{comment}{// The time history stores the previous function values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00114}00114       \textcolor{keywordtype}{unsigned} n\_time\_value = \mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00116}00116       \textcolor{comment}{// Find number of values stored}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00117}00117       \textcolor{keywordtype}{unsigned} n\_value = data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00119}00119       \textcolor{comment}{// Loop over current and stored timesteps}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00120}00120       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_time\_value; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00121}00121       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00122}00122         \textcolor{comment}{// Get corresponding continous time}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00123}00123         \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1TimeStepper_a5a69b6874b36b2f594cbee45719d4c7b}{time}} = \mbox{\hyperlink{classoomph_1_1TimeStepper_a38740bc33e75ecfd61746ff43be54358}{Time\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Time_a43461269b799134f4b7a9aca3e79a7c8}{time}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00125}00125         \textcolor{comment}{// Loop over values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00126}00126         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_value; j++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00127}00127         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00128}00128           data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, j, initial\_value\_fct[j](\mbox{\hyperlink{classoomph_1_1TimeStepper_a5a69b6874b36b2f594cbee45719d4c7b}{time}}));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00129}00129         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00130}00130       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00131}00131     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00132}00132 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00133}00133 \textcolor{comment}{    /// Broken shifting of time values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00134}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a6893d2c1436831d5ad635b43bd91f42e}{00134}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a6893d2c1436831d5ad635b43bd91f42e}{shift\_time\_values}}(\mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const}\& data\_pt)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00135}00135     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00136}00136       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00137}00137         \textcolor{stringliteral}{"{}Cannot shift time values for PeriodicOrbitTimeDiscretisation"{}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00138}00138         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00139}00139         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00140}00140     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00141}00141 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00142}00142 \textcolor{comment}{    /// Broken shifting of time positions}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00143}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a246a40f0cfe0ebc3d5020ede92a2d0e9}{00143}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a246a40f0cfe0ebc3d5020ede92a2d0e9}{shift\_time\_positions}}(\mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const}\& node\_pt)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00144}00144     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00145}00145       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00146}00146         \textcolor{stringliteral}{"{}Cannot shift time positions for PeriodicOrbitTimeDiscretisation"{}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00147}00147         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00148}00148         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00149}00149     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00150}00150 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00151}00151 \textcolor{comment}{    /// Set the weights}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00152}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a250509cf3fb767dc65b14b8dea9ea1e8}{00152}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_a250509cf3fb767dc65b14b8dea9ea1e8}{set\_weights}}() \{\}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00153}00153 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00154}00154 \textcolor{comment}{    /// Number of previous values available.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00155}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_aff80f0af851d19d3b19cfee5d17022f3}{00155}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_aff80f0af851d19d3b19cfee5d17022f3}{nprev\_values}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00156}00156 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00157}00157       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00158}00158     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00159}00159 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00160}00160 \textcolor{comment}{    /// Number of timestep increments that need to be stored by the scheme}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00161}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_ac26b0ab91fc9ec95dad7c207d960216a}{00161}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation_ac26b0ab91fc9ec95dad7c207d960216a}{ndt}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00162}00162 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00163}00163       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00164}00164     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00165}00165   \};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00166}00166 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00167}00167 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00168}00168   \textcolor{comment}{// Special element for integrating the residuals over one period}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00169}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations}{00169}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations}{PeriodicOrbitEquations}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00170}00170   \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00171}00171     \textcolor{comment}{// Storage for the total number of time variables}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00172}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a15f995392ba77c8c664c22df656efb60}{00172}}     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a15f995392ba77c8c664c22df656efb60}{Ntstorage}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00174}00174     \textcolor{comment}{// Pointer to the global variable that represents the frequency}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00175}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a045a3ed37f016aeb55348c0703eacdbc}{00175}}     \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a045a3ed37f016aeb55348c0703eacdbc}{Omega\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00176}00176 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00177}00177 \textcolor{comment}{    /// Pointer to global time.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00178}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a015c732c43b83babe169d1ea3342fd66}{00178}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Time}{Time}}* \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a015c732c43b83babe169d1ea3342fd66}{Time\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00179}00179 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00180}00180   \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00181}00181     \textcolor{comment}{// Constructor, do nothing}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00182}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a75cb0bc88ecc1c76756f2da7910a2c06}{00182}}     \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a75cb0bc88ecc1c76756f2da7910a2c06}{PeriodicOrbitEquations}}() : \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a15f995392ba77c8c664c22df656efb60}{Ntstorage}}(0), \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a045a3ed37f016aeb55348c0703eacdbc}{Omega\_pt}}(0), \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a015c732c43b83babe169d1ea3342fd66}{Time\_pt}}(0) \{\}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00183}00183 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00184}00184 \textcolor{comment}{    /// Broken copy constructor}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00185}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_affdf4ee299c2ad43a1dddb039250f32a}{00185}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_affdf4ee299c2ad43a1dddb039250f32a}{PeriodicOrbitEquations}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations}{PeriodicOrbitEquations}}\& dummy) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00186}00186 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00187}00187 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00188}00188 \textcolor{comment}{}    \textcolor{comment}{// Commented out broken assignment operator because this can lead to a}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00189}00189     \textcolor{comment}{// conflict warning when used in the virtual inheritence hierarchy.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00190}00190     \textcolor{comment}{// Essentially the compiler doesn't realise that two separate}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00191}00191     \textcolor{comment}{// implementations of the broken function are the same and so, quite}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00192}00192     \textcolor{comment}{// rightly, it shouts.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00193}00193     \textcolor{comment}{/*void operator=(const PeriodicOrbitEquations\&) = delete;*/}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00194}00194 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00195}00195 \textcolor{comment}{    /// Set the pointer to the frequency}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00196}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a1a38e53f54ff93ce26898b4ab33db69f}{00196}} \textcolor{comment}{}    \textcolor{keywordtype}{double}*\& \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a1a38e53f54ff93ce26898b4ab33db69f}{omega\_pt}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00197}00197     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00198}00198       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a045a3ed37f016aeb55348c0703eacdbc}{Omega\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00199}00199     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00200}00200 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00201}00201 \textcolor{comment}{    /// Return the frequency}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00202}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_ae301cd215d5c6aff365fd077ff8055de}{00202}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_ae301cd215d5c6aff365fd077ff8055de}{omega}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00203}00203     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00204}00204       \textcolor{keywordflow}{return} *\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a045a3ed37f016aeb55348c0703eacdbc}{Omega\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00205}00205     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00206}00206 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00207}00207 \textcolor{comment}{    /// Set the total number of time storage values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00208}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_aaed37b9539f2f77d642a18fdd1e13e88}{00208}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_aaed37b9539f2f77d642a18fdd1e13e88}{set\_ntstorage}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_tstorage)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00209}00209     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00210}00210       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a15f995392ba77c8c664c22df656efb60}{Ntstorage}} = n\_tstorage;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00211}00211     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00212}00212 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00213}00213 \textcolor{comment}{    /// Retun the pointer to the global time}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00214}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a19d51057fd6ac9d1c152616c9ed2fd65}{00214}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Time}{Time}}*\& \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a19d51057fd6ac9d1c152616c9ed2fd65}{time\_pt}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00215}00215     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00216}00216       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a015c732c43b83babe169d1ea3342fd66}{Time\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00217}00217     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00218}00218 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00219}00219 \textcolor{comment}{    /// Return the pointer to the global time (const version)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00220}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a188877c22bb0344c85e095867a050ce6}{00220}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Time}{Time}}* \textcolor{keyword}{const}\& \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a188877c22bb0344c85e095867a050ce6}{time\_pt}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00221}00221 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00222}00222       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a015c732c43b83babe169d1ea3342fd66}{Time\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00223}00223     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00224}00224 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00225}00225 \textcolor{comment}{    /// Return the global time, accessed via the time pointer}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00226}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a75baee083d554768bd75135196ab26c5}{00226}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a75baee083d554768bd75135196ab26c5}{time}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00227}00227 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00228}00228       \textcolor{comment}{// If no Time\_pt, return 0.0}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00229}00229       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a015c732c43b83babe169d1ea3342fd66}{Time\_pt}} == 0)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00230}00230       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00231}00231         \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00232}00232       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00233}00233       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00234}00234       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00235}00235         \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a015c732c43b83babe169d1ea3342fd66}{Time\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Time_a43461269b799134f4b7a9aca3e79a7c8}{time}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00236}00236       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00237}00237     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00238}00238 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00239}00239 \textcolor{comment}{    /// Add the element's contribution to its residual vector (wrapper)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00240}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a3b1aca3d26cf545636199b830a375b04}{00240}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a3b1aca3d26cf545636199b830a375b04}{fill\_in\_contribution\_to\_integrated\_residuals}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00241}00241       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase}{PeriodicOrbitAssemblyHandlerBase}}* \textcolor{keyword}{const}\& assembly\_handler\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00242}00242       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00243}00243       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00244}00244     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00245}00245       \textcolor{comment}{// Call the generic residuals function with flag set to 0}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00246}00246       \textcolor{comment}{// using a dummy matrix argument}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00247}00247       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a8601a20947d15aa0c1f55ee0b654b71f}{fill\_in\_generic\_residual\_contribution\_orbit}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00248}00248         assembly\_handler\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00249}00249         elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00250}00250         residuals,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00251}00251         \mbox{\hyperlink{classoomph_1_1GeneralisedElement_a4bff11b8ff97aefabb2df41e61e1779f}{GeneralisedElement::Dummy\_matrix}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00252}00252         0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00253}00253     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00254}00254 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00255}00255 \textcolor{comment}{    /// Add the element's contribution to its residual vector and}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00256}00256 \textcolor{comment}{    /// element Jacobian matrix (wrapper)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00257}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a1b818facd1cf315a97176daaa4bc4ee2}{00257}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a1b818facd1cf315a97176daaa4bc4ee2}{fill\_in\_contribution\_to\_integrated\_jacobian}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00258}00258       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase}{PeriodicOrbitAssemblyHandlerBase}}* \textcolor{keyword}{const}\& assembly\_handler\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00259}00259       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00260}00260       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00261}00261       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00262}00262     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00263}00263       \textcolor{comment}{// Call the generic routine with the flag set to 1}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00264}00264       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a8601a20947d15aa0c1f55ee0b654b71f}{fill\_in\_generic\_residual\_contribution\_orbit}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00265}00265         assembly\_handler\_pt, elem\_pt, residuals, jacobian, 1);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00266}00266     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00267}00267 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00269}00269     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a117883e07ed35569cd396deb2c5bba97}{orbit\_output}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00270}00270                       std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00271}00271                       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00272}00272 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00273}00273 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00274}00274   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00275}00275 \textcolor{comment}{    /// The routine that actually does all the work!}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00276}00276 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a8601a20947d15aa0c1f55ee0b654b71f}{fill\_in\_generic\_residual\_contribution\_orbit}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00277}00277       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase}{PeriodicOrbitAssemblyHandlerBase}}* \textcolor{keyword}{const}\& assembly\_handler\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00278}00278       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00279}00279       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00280}00280       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00281}00281       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& flag);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00282}00282 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00283}00283 \textcolor{comment}{    /// Set the timestepper weights}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00284}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a253f5b0748b61c8f68d030b861ccd025}{00284}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a253f5b0748b61c8f68d030b861ccd025}{set\_timestepper\_weights}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi, \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsidt)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00285}00285     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00286}00286       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}* cast\_time\_stepper\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00287}00287         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1GeomObject_a0fc851a3b50103b6c9f68efe86e709de}{time\_stepper\_pt}}());}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00288}00288 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00289}00289 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00290}00290       \textcolor{comment}{// Zero the timestepper weights}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00291}00291       \textcolor{keywordtype}{unsigned} n\_time\_dof = cast\_time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00292}00292       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_time\_dof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00293}00293       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00294}00294         cast\_time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a0dbf867c7f0e06f790a470d547b6b3f2}{Weight}}(0, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 0.0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00295}00295         cast\_time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a0dbf867c7f0e06f790a470d547b6b3f2}{Weight}}(1, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 0.0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00296}00296       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00297}00297 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00298}00298       \textcolor{comment}{// Cache the frequency (timescale)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00299}00299       \textcolor{keyword}{const} \textcolor{keywordtype}{double} inverse\_timescale = this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_ae301cd215d5c6aff365fd077ff8055de}{omega}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00300}00300       \textcolor{comment}{// Now set the weights}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00301}00301       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00302}00302 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00303}00303       \textcolor{comment}{// Global equation for the total number of time unknowns}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00304}00304       \textcolor{comment}{// in the problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00305}00305       \textcolor{keywordtype}{int} global\_eqn;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00306}00306       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00307}00307       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00308}00308         global\_eqn = this-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(l, 0));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00309}00309         cast\_time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a0dbf867c7f0e06f790a470d547b6b3f2}{Weight}}(0, global\_eqn) = psi(l);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00310}00310         cast\_time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a0dbf867c7f0e06f790a470d547b6b3f2}{Weight}}(1, global\_eqn) =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00311}00311           dpsidt(l, 0) * inverse\_timescale;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00312}00312       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00313}00313     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00314}00314 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00315}00315 \textcolor{comment}{    /// Shape/test functions and derivs w.r.t. to global coords at}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00316}00316 \textcolor{comment}{    /// local coord. s; return  Jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00317}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a745c25bf4dc333322bc9b4c1841ec11e}{00317}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a745c25bf4dc333322bc9b4c1841ec11e}{dshape\_and\_dtest\_eulerian\_orbit}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00318}00318                                                    \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00319}00319                                                    \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsidt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00320}00320                                                    \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& test,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00321}00321                                                    \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dtestdt) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00322}00322 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00323}00323 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00324}00324 \textcolor{comment}{    /// Shape/test functions and derivs w.r.t. to global coords at}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00325}00325 \textcolor{comment}{    /// integration point ipt; return  Jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00326}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a2bf0f39d52d1416242a7f618c2ece5ca}{00326}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a2bf0f39d52d1416242a7f618c2ece5ca}{dshape\_and\_dtest\_eulerian\_at\_knot\_orbit}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00327}00327       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& ipt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00328}00328       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00329}00329       \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsidt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00330}00330       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& test,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00331}00331       \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dtestdt) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00332}00332 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00333}00333 \textcolor{comment}{    /// Compute element residual Vector only (if flag=and/or element}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00334}00334 \textcolor{comment}{    /// Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00335}00335 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00336}00336     \textcolor{comment}{// Output function}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00337}00337 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00338}00338 \textcolor{comment}{    ///  Output function:}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00339}00339 \textcolor{comment}{    ///   x,y,u   or    x,y,z,u at n\_plot\string^DIM plot points}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00340}00340 \textcolor{comment}{}  \};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00341}00341 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00342}00342 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00343}00343   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00344}00344 \textcolor{comment}{  /// QPoissonElement elements are linear/quadrilateral/brick-\/shaped}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00345}00345 \textcolor{comment}{  /// Poisson elements with isoparametric interpolation for the function.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00346}00346 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00347}00347   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00348}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement}{00348}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement}{SpectralPeriodicOrbitElement}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00349}00349     : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1QSpectralElement}{QSpectralElement}}<1, NNODE\_1D>,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00350}00350       \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1RefineableQSpectralElement}{RefineableQSpectralElement}}<1>,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00351}00351       \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations}{PeriodicOrbitEquations}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00352}00352       \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1ElementWithZ2ErrorEstimator}{ElementWithZ2ErrorEstimator}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00353}00353   \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00354}00354   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00355}00355 \textcolor{comment}{    /// Constructor: Call constructors for QElement and}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00356}00356 \textcolor{comment}{    /// Poisson equations}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00357}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ae1eefbd43491bf3437a81c8096dd9fb1}{00357}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ae1eefbd43491bf3437a81c8096dd9fb1}{SpectralPeriodicOrbitElement}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00358}00358       : \mbox{\hyperlink{classoomph_1_1QSpectralElement}{QSpectralElement}}<1, NNODE\_1D>(),}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00359}00359         \mbox{\hyperlink{classoomph_1_1RefineableQSpectralElement}{RefineableQSpectralElement}}<1>(),}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00360}00360         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations}{PeriodicOrbitEquations}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00361}00361     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00362}00362     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00363}00363 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00364}00364 \textcolor{comment}{    /// Broken copy constructor}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00365}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ae0469b27ed97bcfa65e7893e5d9d2bf4}{00365}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ae0469b27ed97bcfa65e7893e5d9d2bf4}{SpectralPeriodicOrbitElement}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00366}00366       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement}{SpectralPeriodicOrbitElement<NNODE\_1D>}}\& dummy) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00367}00367 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00368}00368 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00369}00369 \textcolor{comment}{}    \textcolor{comment}{/*void operator=(const SpectralPeriodicOrbitElement<NNODE\_1D>\&) = delete;*/}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00370}00370 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00371}00371 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00372}00372 \textcolor{comment}{    ///  Required  \# of `values' (pinned or dofs)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00373}00373 \textcolor{comment}{    /// at node n (only ever one dummy value, used for equation numbering)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00374}00374 \textcolor{comment}{    /// This is also used to represent all *spatial* variables during a}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00375}00375 \textcolor{comment}{    /// temporal refinement, which is a bit naughty but it quick and dirty.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00376}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_aa4f3fa783000d6912503de77cf06f2ca}{00376}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_aa4f3fa783000d6912503de77cf06f2ca}{required\_nvalue}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00377}00377 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00378}00378       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00379}00379     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00380}00380 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00381}00381 \textcolor{comment}{    /// Number of continuously interpolated values (1)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00382}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a7a1e61b3aa06a7402448215c6b99dcc3}{00382}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a7a1e61b3aa06a7402448215c6b99dcc3}{ncont\_interpolated\_values}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00383}00383 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00384}00384       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00385}00385     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00386}00386 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00387}00387 \textcolor{comment}{    /// Return the dummy values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00388}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a1b1076948e9f8c8a033dc576d9b41536}{00388}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a1b1076948e9f8c8a033dc576d9b41536}{get\_interpolated\_values}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& value)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00389}00389     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00390}00390       this-\/>\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a1b1076948e9f8c8a033dc576d9b41536}{get\_interpolated\_values}}(0, s, value);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00391}00391     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00392}00392 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00393}00393 \textcolor{comment}{    /// Return the temporal dummy values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00394}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a49dfdd0687d3a3ad27c1ae9e9074aea9}{00394}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a49dfdd0687d3a3ad27c1ae9e9074aea9}{get\_interpolated\_values}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00395}00395                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00396}00396                                  \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& value)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00397}00397     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00398}00398       value.resize(1);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00399}00399       value[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00400}00400 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00401}00401       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00402}00402       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00403}00403       this-\/>\mbox{\hyperlink{classoomph_1_1QSpectralElement_3_011_00_01NNODE__1D_01_4_a20a70f397d718449bcb16e6e60ea74a1}{shape}}(s, psi);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00405}00405       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00406}00406       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00407}00407         value[0] += this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a28fd5c2d4aeba5ef65bee0e0d72569f5}{nodal\_value}}(t, n, 0) * psi(n);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00408}00408       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00409}00409     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00410}00410 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00411}00411     \textcolor{comment}{// Order of recovery shape functions for Z2 error estimation:}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00412}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a38c80629b1befeb65014659c7e14ab09}{00412}}     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a38c80629b1befeb65014659c7e14ab09}{nrecovery\_order}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00413}00413     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00414}00414       \textcolor{keywordflow}{return} NNODE\_1D -\/ 1;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00415}00415     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00416}00416 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00417}00417 \textcolor{comment}{    /// Number of flux terms for Z2 error estimation}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00418}00418 \textcolor{comment}{    /// This will be used to represent all spatial values,}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00419}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a625465ff6702c623efd252d758832445}{00419}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a625465ff6702c623efd252d758832445}{num\_Z2\_flux\_terms}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00420}00420     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00421}00421       \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1Data_a9752205c5fb3bb886200b3fae9181e94}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00422}00422     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00423}00423 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00424}00424 \textcolor{comment}{    /// Get the fluxes for the recovert}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00425}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_aee2d7222e52f4d59692b8f1ac3964b17}{00425}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_aee2d7222e52f4d59692b8f1ac3964b17}{get\_Z2\_flux}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& flux)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00426}00426     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00427}00427       \textcolor{comment}{// Find out the number of nodes in the element}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00428}00428       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00429}00429 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00430}00430       \textcolor{comment}{// Get the shape functions}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00431}00431       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00432}00432       \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} dpsidx(n\_node, 1);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00433}00433 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00434}00434       \textcolor{comment}{// Get the derivatives}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00435}00435       (void)this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9296c17b134688049256a4bbc886df69}{dshape\_eulerian}}(s, psi, dpsidx);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00436}00436 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00437}00437       \textcolor{comment}{// Now assemble all the derivatives}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00438}00438       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_tstorage = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1Data_a9752205c5fb3bb886200b3fae9181e94}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00439}00439 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00440}00440       \textcolor{comment}{// Zero the flux vector}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00441}00441       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_tstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00442}00442       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00443}00443         flux[\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}] = 0.0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00444}00444       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00445}00445 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00446}00446       \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00447}00447       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00448}00448       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00449}00449         \textcolor{keyword}{const} \textcolor{keywordtype}{double} dpsidx\_ = dpsidx(n, 0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00450}00450         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_tstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00451}00451         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00452}00452           flux[\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}] += this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a28fd5c2d4aeba5ef65bee0e0d72569f5}{nodal\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, n, 0) * dpsidx\_;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00453}00453         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00454}00454       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00455}00455     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00456}00456 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00457}00457     \textcolor{comment}{// Number of vertex nodes in the element (always 2)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00458}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a3ec38d16dfb22d1e7090b230db3479d5}{00458}}     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a3ec38d16dfb22d1e7090b230db3479d5}{nvertex\_node}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00459}00459 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00460}00460       \textcolor{keywordflow}{return} 2;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00461}00461     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00462}00462 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00463}00463 \textcolor{comment}{    /// Pointer to the j-\/th vertex node in the element}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00464}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a79b6100a126d1a8b743790c1bf9c48de}{00464}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a79b6100a126d1a8b743790c1bf9c48de}{vertex\_node\_pt}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00465}00465 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00466}00466       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1QSpectralElement}{QSpectralElement<1, NNODE\_1D>::vertex\_node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00467}00467     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00468}00468 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00469}00469 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00470}00470     \textcolor{comment}{//}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00471}00471 \textcolor{comment}{    /// Function to return the number of values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00472}00472 \textcolor{comment}{}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00473}00473 \textcolor{comment}{    /// Output function:}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00474}00474 \textcolor{comment}{    ///  x,y,u   or    x,y,z,u}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00475}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ac2b85b567337f5126c4dea2e8c82ed17}{00475}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ac2b85b567337f5126c4dea2e8c82ed17}{output}}(std::ostream\& outfile)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00476}00476     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00477}00477       \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{PeriodicOrbitEquations::output}}(outfile);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00478}00478     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00479}00479 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00480}00480 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00481}00481 \textcolor{comment}{    ///  Output function:}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00482}00482 \textcolor{comment}{    ///   x,y,u   or    x,y,z,u at n\_plot\string^DIM plot points}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00483}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ab4c88a199b195d8e06630c4750ce06cf}{00483}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ab4c88a199b195d8e06630c4750ce06cf}{output}}(std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00484}00484     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00485}00485       \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{PeriodicOrbitEquations::output}}(outfile, n\_plot);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00486}00486     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00487}00487 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00488}00488 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00489}00489 \textcolor{comment}{    /// C-\/style output function:}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00490}00490 \textcolor{comment}{    ///  x,y,u   or    x,y,z,u}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00491}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a2a16805778b8497d7b394f3cbd010fc0}{00491}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a2a16805778b8497d7b394f3cbd010fc0}{output}}(FILE* file\_pt)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00492}00492     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00493}00493       \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{PeriodicOrbitEquations::output}}(file\_pt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00494}00494     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00495}00495 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00496}00496 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00497}00497 \textcolor{comment}{    ///  C-\/style output function:}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00498}00498 \textcolor{comment}{    ///   x,y,u   or    x,y,z,u at n\_plot\string^DIM plot points}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00499}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ae8bcd7bd13389fe289242750880cd9bf}{00499}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_ae8bcd7bd13389fe289242750880cd9bf}{output}}(FILE* file\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00500}00500     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00501}00501       \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{PeriodicOrbitEquations::output}}(file\_pt, n\_plot);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00502}00502     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00503}00503 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00504}00504 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00505}00505   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00506}00506 \textcolor{comment}{    /// Shape, test functions \& derivs. w.r.t. to global coords. Return}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00507}00507 \textcolor{comment}{    /// Jacobian.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00508}00508 \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a09b5fc5cee00d470952242dfea75de69}{dshape\_and\_dtest\_eulerian\_orbit}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00509}00509                                                   \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00510}00510                                                   \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsidt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00511}00511                                                   \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& test,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00512}00512                                                   \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dtestdt) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00514}00514 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00515}00515 \textcolor{comment}{    /// Shape, test functions \& derivs. w.r.t. to global coords. at}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00516}00516 \textcolor{comment}{    /// integration point ipt. Return Jacobian.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00517}00517 \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a0468d601cfa2cda0a7fc3312575bb252}{dshape\_and\_dtest\_eulerian\_at\_knot\_orbit}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00518}00518       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& ipt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00519}00519       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00520}00520       \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsidt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00521}00521       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& test,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00522}00522       \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dtestdt) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00523}00523   \};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00524}00524 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00525}00525 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00526}00526   \textcolor{comment}{// Inline functions:}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00528}00528 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00529}00529   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00530}00530 \textcolor{comment}{  /// Define the shape functions and test functions and derivatives}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00531}00531 \textcolor{comment}{  /// w.r.t. global coordinates and return Jacobian of mapping.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00532}00532 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00533}00533 \textcolor{comment}{  /// Galerkin: Test functions = shape functions}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00534}00534 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00535}00535   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00536}00536   \textcolor{keywordtype}{double} SpectralPeriodicOrbitElement<}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00537}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a09b5fc5cee00d470952242dfea75de69}{00537}}     NNODE\_1D>::dshape\_and\_dtest\_eulerian\_orbit(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00538}00538                                                \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00539}00539                                                \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsidt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00540}00540                                                \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& test,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00541}00541                                                \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dtestdt)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00542}00542 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00543}00543     \textcolor{comment}{// Call the geometrical shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00544}00544     \textcolor{keyword}{const} \textcolor{keywordtype}{double} J = this-\/>dshape\_eulerian(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, dpsidt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00545}00545 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00546}00546     \textcolor{comment}{// Set the test functions equal to the shape functions}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00547}00547     test = psi;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00548}00548     dtestdt = dpsidt;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00549}00549 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00550}00550     \textcolor{comment}{// Return the jacobian}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00551}00551     \textcolor{keywordflow}{return} J;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00552}00552   \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00553}00553 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00554}00554 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00555}00555   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00556}00556 \textcolor{comment}{  /// Define the shape functions and test functions and derivatives}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00557}00557 \textcolor{comment}{  /// w.r.t. global coordinates and return Jacobian of mapping.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00558}00558 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00559}00559 \textcolor{comment}{  /// Galerkin: Test functions = shape functions}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00560}00560 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00561}00561   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00562}00562   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement}{SpectralPeriodicOrbitElement}}<}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00563}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement_a0468d601cfa2cda0a7fc3312575bb252}{00563}}     NNODE\_1D>::dshape\_and\_dtest\_eulerian\_at\_knot\_orbit(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& ipt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00564}00564                                                        \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00565}00565                                                        \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsidt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00566}00566                                                        \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& test,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00567}00567                                                        \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dtestdt)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00568}00568 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00569}00569     \textcolor{comment}{// Call the geometrical shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00570}00570     \textcolor{keyword}{const} \textcolor{keywordtype}{double} J = this-\/>dshape\_eulerian\_at\_knot(ipt, psi, dpsidt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00571}00571 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00572}00572     \textcolor{comment}{// Set the pointers of the test functions}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00573}00573     test = psi;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00574}00574     dtestdt = dpsidt;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00575}00575 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00576}00576     \textcolor{comment}{// Return the jacobian}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00577}00577     \textcolor{keywordflow}{return} J;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00578}00578   \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00579}00579 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00580}00580 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00581}00581   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00582}00582   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler}{PeriodicOrbitAssemblyHandler}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00583}00583 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00584}00584 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00585}00585   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00586}00586 \textcolor{comment}{  /// A special temporal mesh class}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00587}00587 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00588}00588   \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00589}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh}{00589}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh}{PeriodicOrbitTemporalMesh}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1RefineableOneDMesh}{RefineableOneDMesh}}<ELEMENT>}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00590}00590   \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00591}00591     \textcolor{comment}{// Let's have the periodic handler as a friend}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00592}00592     \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00593}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_a2cbe986bcd27c28d5de7ada068d3d94c}{00593}}     \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler}{PeriodicOrbitAssemblyHandler}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00594}00594 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00595}00595   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00596}00596 \textcolor{comment}{    /// Constructor, create a 1D mesh from 0 to 1 that is periodic}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00597}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_a0060f76881f7125a298926674ddbb15e}{00597}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_a0060f76881f7125a298926674ddbb15e}{PeriodicOrbitTemporalMesh}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_element)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00598}00598       : \mbox{\hyperlink{classoomph_1_1OneDMesh}{OneDMesh}}<ELEMENT>(n\_element, 1.0),}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00599}00599         \mbox{\hyperlink{classoomph_1_1RefineableOneDMesh}{RefineableOneDMesh}}<ELEMENT>(n\_element, 1.0)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00600}00600     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00601}00601       \textcolor{comment}{// Make the mesh periodic by setting the LAST node to have the same data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00602}00602       \textcolor{comment}{// as the FIRST node}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00603}00603       \textcolor{comment}{// Not necessarily a smart move for when doing Floquet analysis}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00604}00604       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_afc4d1204afc31b9ec88fe82d8fc01625}{boundary\_node\_pt}}(1, 0)-\/>\mbox{\hyperlink{classoomph_1_1Node_aeb07848c19b83fd8b9690b8fcc200d56}{make\_periodic}}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_afc4d1204afc31b9ec88fe82d8fc01625}{boundary\_node\_pt}}(0, 0));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00605}00605     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00606}00606 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00607}00607 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00608}00608     \textcolor{comment}{// Output the orbit for all elements in the mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00609}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_a8126152646e3eaed0ab5555794a20d49}{00609}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_a8126152646e3eaed0ab5555794a20d49}{orbit\_output}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00610}00610                       std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00611}00611                       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00612}00612     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00613}00613       \textcolor{comment}{// Loop over all elements in the mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00614}00614       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00615}00615       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00616}00616       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00617}00617         \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}))}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00618}00618           -\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_a8126152646e3eaed0ab5555794a20d49}{orbit\_output}}(elem\_pt, outfile, n\_plot);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00619}00619       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00620}00620     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00621}00621 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00622}00622     \textcolor{comment}{// Loop over all temporal elements and assemble their contributions}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00623}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_af1829044fa15d410cbd5d340d9c9e458}{00623}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_af1829044fa15d410cbd5d340d9c9e458}{assemble\_residuals}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00624}00624       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase}{PeriodicOrbitAssemblyHandlerBase}}* \textcolor{keyword}{const}\& assembly\_handler\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00625}00625       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00626}00626       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00627}00627     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00628}00628       \textcolor{comment}{// Initialise the residuals to zero}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00629}00629       residuals.\mbox{\hyperlink{classoomph_1_1Vector_ad526bb1acccf11b485ebe12c9cde44fd}{initialise}}(0.0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00630}00630       \textcolor{comment}{// Loop over all elements in the mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00631}00631       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00632}00632       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00633}00633       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00634}00634         \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}))}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00635}00635           -\/>fill\_in\_contribution\_to\_integrated\_residuals(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00636}00636             assembly\_handler\_pt, elem\_pt, residuals);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00637}00637       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00638}00638     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00639}00639 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00640}00640 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00641}00641     \textcolor{comment}{// Loop over all temporal elements and assemble their contributions}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00642}00642     \textcolor{comment}{// and the jaobian}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00643}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_a5ca70a80e8673d43a0c5c15b021d10cd}{00643}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh_a5ca70a80e8673d43a0c5c15b021d10cd}{assemble\_residuals\_and\_jacobian}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00644}00644       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase}{PeriodicOrbitAssemblyHandlerBase}}* \textcolor{keyword}{const}\& assembly\_handler\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00645}00645       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00646}00646       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00647}00647       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00648}00648     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00649}00649       \textcolor{comment}{// Initialise the residuals to zero}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00650}00650       residuals.\mbox{\hyperlink{classoomph_1_1Vector_ad526bb1acccf11b485ebe12c9cde44fd}{initialise}}(0.0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00651}00651       jacobian.\mbox{\hyperlink{classoomph_1_1DenseMatrix_aafcfbb0309fdcbd84f8654fe1b5601fd}{initialise}}(0.0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00652}00652       \textcolor{comment}{// Loop over all elements in the mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00653}00653       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00654}00654       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00655}00655       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00656}00656         \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}))}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00657}00657           -\/>fill\_in\_contribution\_to\_integrated\_jacobian(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00658}00658             assembly\_handler\_pt, elem\_pt, residuals, jacobian);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00659}00659       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00660}00660     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00661}00661   \};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00662}00662 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00663}00663 \textcolor{comment}{  /// ===============================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00664}00664 \textcolor{comment}{  /// Base class to avoid template complications}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00665}00665 \textcolor{comment}{}  \textcolor{comment}{//===============================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00666}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase}{00666}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase}{PeriodicOrbitAssemblyHandlerBase}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1AssemblyHandler}{AssemblyHandler}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00667}00667   \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00668}00668   \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00669}00669     \textcolor{comment}{// Do nothing in constructor}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00670}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase_a75182b5fa555a6d410015feb180701b8}{00670}}     \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase_a75182b5fa555a6d410015feb180701b8}{PeriodicOrbitAssemblyHandlerBase}}() \{\}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00671}00671 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00672}00672     \textcolor{comment}{// Provide interface}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00673}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase_a48968325ba57e969f64298c5b2dfb8f8}{00673}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase_a48968325ba57e969f64298c5b2dfb8f8}{get\_dofs\_for\_element}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const} elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00674}00674                                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& dofs) = 0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00675}00675 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00676}00676 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00677}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase_a680c82526671e8213d317367f3f7a7e1}{00677}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase_a680c82526671e8213d317367f3f7a7e1}{get\_previous\_dofs\_for\_element}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00678}00678       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const} elem\_pt, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& dofs) = 0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00679}00679 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00680}00680 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00681}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase_a09d7c31dec8b9688cec82f8b24558b9b}{00681}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase_a09d7c31dec8b9688cec82f8b24558b9b}{set\_dofs\_for\_element}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const} elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00682}00682                                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \textcolor{keyword}{const}\& dofs) = 0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00683}00683   \};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00684}00684 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00685}00685   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00686}00686 \textcolor{comment}{  /// A class that is used to assemble and solve the augmented system}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00687}00687 \textcolor{comment}{  /// of equations associated with calculating periodic orbits directly}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00688}00688 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00689}00689   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00690}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler}{00690}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler}{PeriodicOrbitAssemblyHandler}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandlerBase}{PeriodicOrbitAssemblyHandlerBase}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00691}00691   \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00692}00692   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00693}00693 \textcolor{comment}{    /// Pointer to the timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00694}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae2a8149c7cd33e41765ef080e1654e81}{00694}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}* \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae2a8149c7cd33e41765ef080e1654e81}{Time\_stepper\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00695}00695 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00696}00696 \textcolor{comment}{    /// Pointer to the problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00697}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{00697}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Problem}{Problem}}* \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00698}00698 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00699}00699 \textcolor{comment}{    /// Storage for mesh of temporal elements}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00700}00700 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh}{PeriodicOrbitTemporalMesh<SpectralPeriodicOrbitElement<NNODE\_1D>}}>*}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00701}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{00701}}       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00702}00702 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00703}00703 \textcolor{comment}{    /// Storage for the mesh of temporal elements with a simple mesh pointer}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00704}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae527e33cddc33225b532e6a64f255483}{00704}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae527e33cddc33225b532e6a64f255483}{Basic\_time\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00705}00705 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00706}00706 \textcolor{comment}{    /// Storage for the previous solution}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00707}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aac4a358fed9397f2ffcb796252f78025}{00707}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aac4a358fed9397f2ffcb796252f78025}{Previous\_dofs}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00708}00708 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00709}00709 \textcolor{comment}{    /// Store number of degrees of freedom in the original problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00710}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{00710}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00711}00711 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00712}00712 \textcolor{comment}{    /// Storage for number of elements in the period}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00713}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a52b49ec4c94b9cf480395c7cad123ced}{00713}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a52b49ec4c94b9cf480395c7cad123ced}{N\_element\_in\_period}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00714}00714 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00715}00715 \textcolor{comment}{    /// Storage for the number of unknown time values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00716}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{00716}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00717}00717 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00718}00718 \textcolor{comment}{    /// Storage for the frequency of the orbit (scaled by 2pi)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00719}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae922867706dcf2e79e837bbbe774e053}{00719}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae922867706dcf2e79e837bbbe774e053}{Omega}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00720}00720 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00721}00721   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00722}00722 \textcolor{comment}{    /// Constructor, initialises values and constructs mesh of elements}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00723}00723 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler}{PeriodicOrbitAssemblyHandler<NNODE\_1D>}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00724}00724       \mbox{\hyperlink{classoomph_1_1Problem}{Problem}}* \textcolor{keyword}{const}\& problem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00725}00725       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_element\_in\_period,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00726}00726       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& initial\_guess,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00727}00727       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& omega)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00728}00728       : \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}(problem\_pt),}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00729}00729         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a52b49ec4c94b9cf480395c7cad123ced}{N\_element\_in\_period}}(n\_element\_in\_period),}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00730}00730         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae922867706dcf2e79e837bbbe774e053}{Omega}}(omega / (2.0 * MathematicalConstants::\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a61ae4ddbc59fbd0797ebb671e48c8d6d}{Pi}}))}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00731}00731     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00732}00732       \textcolor{comment}{// Store the current number of degrees of freedom}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00733}00733       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} = problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_a218d4dfff74bc14f3f5dc8416236e01d}{ndof}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00734}00734 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00735}00735       \textcolor{comment}{// Create the appropriate mesh of "{}1D"{} time elements depending on}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00736}00736       \textcolor{comment}{// the specified spectral order}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00737}00737       \textcolor{comment}{// The time domain runs from zero to one}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00738}00738       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}} =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00739}00739         \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTemporalMesh}{PeriodicOrbitTemporalMesh<SpectralPeriodicOrbitElement<NNODE\_1D>}}>(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00740}00740           n\_element\_in\_period);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00741}00741 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00742}00742       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae527e33cddc33225b532e6a64f255483}{Basic\_time\_mesh\_pt}} = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00743}00743 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00744}00744       \textcolor{comment}{// Set the error estimator}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00745}00745       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>spatial\_error\_estimator\_pt() = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1Z2ErrorEstimator}{Z2ErrorEstimator}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00746}00746       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>max\_permitted\_error() = 1.0e-\/2;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00747}00747       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>min\_permitted\_error() = 1.0e-\/5;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00748}00748       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>max\_refinement\_level() = 10;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00749}00749 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00750}00750       \textcolor{comment}{// Now we need to number the mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00751}00751       \textcolor{comment}{// Dummy dof pointer}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00752}00752       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double*>}} dummy\_dof\_pt;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00753}00753       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>assign\_global\_eqn\_numbers(dummy\_dof\_pt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00754}00754       \textcolor{comment}{// Assign the local equation numbers}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00755}00755       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>assign\_local\_eqn\_numbers(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00756}00756 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00757}00757       \textcolor{comment}{// Find the number of temporal degrees of freedom}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00758}00758       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} = dummy\_dof\_pt.size();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00759}00759 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00760}00760       \textcolor{comment}{// Now we need to do something clever to setup the time storage schemes}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00761}00761       \textcolor{comment}{// and the initial values (don't quite know what that is yet)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00762}00762 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00763}00763       \textcolor{comment}{// Create the "{}fake"{} timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00764}00764       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae2a8149c7cd33e41765ef080e1654e81}{Time\_stepper\_pt}} = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00765}00765       \textcolor{comment}{// Loop over the temporal elements and set the pointers}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00766}00766       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element\_in\_period; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00767}00767       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00768}00768         \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement}{SpectralPeriodicOrbitElement<NNODE\_1D>}}* el\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00769}00769           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement}{SpectralPeriodicOrbitElement<NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00770}00770             \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>element\_pt(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00771}00771 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00772}00772         \textcolor{comment}{// Set the time and the timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00773}00773         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a19d51057fd6ac9d1c152616c9ed2fd65}{time\_pt}}() = problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae87f0d17b929d9b6097e19c2507c87f9}{time\_pt}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00774}00774         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_a0fc851a3b50103b6c9f68efe86e709de}{time\_stepper\_pt}}() = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae2a8149c7cd33e41765ef080e1654e81}{Time\_stepper\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00775}00775 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00776}00776         \textcolor{comment}{// Set the number of temporal degrees of freedom}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00777}00777         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_aaed37b9539f2f77d642a18fdd1e13e88}{set\_ntstorage}}(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00778}00778         \textcolor{comment}{// Set the frequency}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00779}00779         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a1a38e53f54ff93ce26898b4ab33db69f}{omega\_pt}}() = \&\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae922867706dcf2e79e837bbbe774e053}{Omega}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00780}00780       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00781}00781 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00782}00782       \textcolor{comment}{// We now need to do something much more drastic which is to loop over all}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00783}00783       \textcolor{comment}{// our the data in the problem and change the timestepper, which is going}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00784}00784       \textcolor{comment}{// to be a real pain when I start to worry about halo nodes, etc.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00785}00785 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00786}00786       \textcolor{comment}{// Will need to use the appropriate mesh-\/level functions that have}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00787}00787       \textcolor{comment}{// not been written yet ..}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00788}00788 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00789}00789       \textcolor{comment}{// Let's just break if there are submeshes}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00790}00790       \textcolor{keywordflow}{if} (problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_accc4e5a46953800933f07ae6bd67860e}{nsub\_mesh}}() > 0)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00791}00791       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00792}00792         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00793}00793           \textcolor{stringliteral}{"{}PeriodicOrbitHandler can't cope with submeshes yet"{}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00794}00794           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00795}00795           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00796}00796       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00797}00797 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00798}00798       \textcolor{comment}{// OK now we have only one mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00799}00799       \textcolor{keywordtype}{unsigned} n\_node = problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00800}00800       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00801}00801       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00802}00802         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const} nod\_pt = problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00803}00803         nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_acd22fabfb127ff4ea37a5bc60c61b414}{set\_time\_stepper}}(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae2a8149c7cd33e41765ef080e1654e81}{Time\_stepper\_pt}}, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00804}00804         \textcolor{comment}{// If the unknowns are pinned then copy the value to all values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00805}00805         \textcolor{keywordtype}{unsigned} n\_value = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00806}00806         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_value; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00807}00807         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00808}00808           \textcolor{keywordflow}{if} (nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_aedd0c445396ddcd650c814d17fef77dc}{is\_pinned}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}))}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00809}00809           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00810}00810             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_tstorage = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a9752205c5fb3bb886200b3fae9181e94}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00811}00811             \textcolor{keyword}{const} \textcolor{keywordtype}{double} value = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afcc5cdba40bca251826ae5bee5ca15b4}{value}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00812}00812             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 1; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_tstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00813}00813             \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00814}00814               nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, value);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00815}00815             \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00816}00816           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00817}00817         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00818}00818       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00819}00819 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00820}00820       \textcolor{keywordtype}{unsigned} n\_element = problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00821}00821       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00822}00822       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00823}00823         \textcolor{keywordtype}{unsigned} n\_internal =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00824}00824           problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00825}00825         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_internal; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00826}00826         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00827}00827           \textcolor{comment}{// Cache the internal data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00828}00828           \mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const} data\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00829}00829             problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00830}00830           \textcolor{comment}{// and set the timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00831}00831           data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_acd22fabfb127ff4ea37a5bc60c61b414}{set\_time\_stepper}}(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae2a8149c7cd33e41765ef080e1654e81}{Time\_stepper\_pt}}, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00832}00832 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00833}00833           \textcolor{comment}{// If the unknowns are pinned then copy the value to all values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00834}00834           \textcolor{keywordtype}{unsigned} n\_value = data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00835}00835           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_value; j++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00836}00836           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00837}00837             \textcolor{keywordflow}{if} (data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_aedd0c445396ddcd650c814d17fef77dc}{is\_pinned}}(j))}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00838}00838             \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00839}00839               \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_tstorage = data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a9752205c5fb3bb886200b3fae9181e94}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00840}00840               \textcolor{keyword}{const} \textcolor{keywordtype}{double} value = data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a9383101536882db34e618cbe30dba2da}{value}}(j);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00841}00841               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 1; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_tstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00842}00842               \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00843}00843                 data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, j, value);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00844}00844               \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00845}00845             \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00846}00846           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00847}00847         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00848}00848       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00849}00849 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00850}00850       \textcolor{comment}{// Need to reassign equation numbers so that the DOF pointer, points to}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00851}00851       \textcolor{comment}{// the newly allocated storage}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00852}00852       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Re-\/allocated "{}} << problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_a0df501c6aed60c4938861df776b10119}{assign\_eqn\_numbers}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00853}00853                  << \textcolor{stringliteral}{"{} equation numbers\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00854}00854 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00855}00855       \textcolor{comment}{// Now's let's add all the unknowns to the problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00856}00856       problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_aa9e4cfff7e1dc295036b0e58bc11ae75}{Dof\_pt}}.resize(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} + 1);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00857}00857       \textcolor{comment}{// This is reasonably straight forward using pointer arithmetic}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00858}00858       \textcolor{comment}{// but this does rely on knowing how the data is stored in the}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00859}00859       \textcolor{comment}{// Nodes which is a little nasty}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00860}00860       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00861}00861       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00862}00862         \textcolor{keywordtype}{unsigned} offset = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00863}00863         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}}; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00864}00864         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00865}00865           problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_aa9e4cfff7e1dc295036b0e58bc11ae75}{Dof\_pt}}[offset + n] = problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_aa9e4cfff7e1dc295036b0e58bc11ae75}{Dof\_pt}}[n] + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00866}00866         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00867}00867       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00868}00868 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00869}00869       \textcolor{comment}{// Add the frequency of the orbit to the unknowns}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00870}00870       problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_aa9e4cfff7e1dc295036b0e58bc11ae75}{Dof\_pt}}[\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}] = \&\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae922867706dcf2e79e837bbbe774e053}{Omega}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00871}00871 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00872}00872       \textcolor{comment}{// Rebuild everything}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00873}00873       problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_ade01b88db08dcec1706fe44eaa0090a3}{Dof\_distribution\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_a3cab441019e738e4c6db6ee22dd71515}{build}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00874}00874         problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_a22e2521bc620ad0cc542213a24f31252}{communicator\_pt}}(), \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} + 1, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00875}00875 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00876}00876 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00877}00877       \textcolor{comment}{// Set initial condition of constant-\/ness plus wobble}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00878}00878       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00879}00879       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00880}00880         \textcolor{keywordtype}{unsigned} offset = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00881}00881         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}}; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00882}00882         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00883}00883           problem\_pt-\/>\mbox{\hyperlink{classoomph_1_1Problem_a2c025f1ba8a9f67bd7ee2dc70462b49a}{dof}}(offset + n) =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00884}00884             initial\_guess(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, n); \textcolor{comment}{// problem\_pt-\/>dof(n);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00885}00885         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00886}00886       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00887}00887 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00888}00888       \textcolor{comment}{// Set the initial unkowns to be the original problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00889}00889       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aac4a358fed9397f2ffcb796252f78025}{Previous\_dofs}}.resize(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} + 1, 0.0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00890}00890       this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3296942fb40f5ca642521db38d44988}{set\_previous\_dofs\_to\_current\_dofs}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00891}00891 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00892}00892       \textcolor{comment}{// Now check everything is OK ... it seems to be}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00893}00893       \textcolor{comment}{// std::cout << problem\_pt-\/>ndof() << "{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00894}00894       \textcolor{comment}{// Let's check it}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00895}00895       \textcolor{comment}{// for(unsigned i=0;i<problem\_pt-\/>ndof();i++)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00896}00896       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00897}00897       \textcolor{comment}{//  std::cout << i << "{} "{} << problem\_pt-\/>dof(i) << "{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00898}00898       \textcolor{comment}{//\}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00899}00899     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00900}00900 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00901}00901 \textcolor{comment}{    /// Update the previous dofs}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00902}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3296942fb40f5ca642521db38d44988}{00902}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3296942fb40f5ca642521db38d44988}{set\_previous\_dofs\_to\_current\_dofs}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00903}00903     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00904}00904       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} + 1; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00905}00905       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00906}00906         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aac4a358fed9397f2ffcb796252f78025}{Previous\_dofs}}[n] = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a2c025f1ba8a9f67bd7ee2dc70462b49a}{dof}}(n);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00907}00907       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00908}00908     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00909}00909 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00910}00910 \textcolor{comment}{    /// Return the number of degrees of freedom in the element elem\_pt}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00911}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ab960ecaac9239cfbc47f1036893362ff}{00911}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ab960ecaac9239cfbc47f1036893362ff}{ndof}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00912}00912     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00913}00913       \textcolor{keywordflow}{return} ((elem\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37204f67b37d212fd170c68d48f6da57}{ndof}}()) * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} + 1);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00914}00914     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00915}00915 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00916}00916 \textcolor{comment}{    /// Return the global equation number of the local unknown ieqn\_local}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00917}00917 \textcolor{comment}{    /// in elem\_pt.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00918}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac4d1e4e7e566061c2129157c67adab5b}{00918}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac4d1e4e7e566061c2129157c67adab5b}{eqn\_number}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00919}00919                              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& ieqn\_local)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00920}00920     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00921}00921       \textcolor{comment}{// Get unaugmented number of (spatial) dofs in element}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00922}00922       \textcolor{keywordtype}{unsigned} raw\_ndof = elem\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37204f67b37d212fd170c68d48f6da57}{ndof}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00923}00923       \textcolor{comment}{// The final variable (the period) is stored at the end}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00924}00924       \textcolor{keywordflow}{if} (ieqn\_local == raw\_ndof * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}})}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00925}00925       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00926}00926         \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00927}00927       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00928}00928       \textcolor{comment}{// Otherwise  we need to do a little more work}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00929}00929       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00930}00930       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00931}00931         \textcolor{comment}{// Now find out the time level}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00932}00932         \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = ieqn\_local / raw\_ndof;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00933}00933         \textcolor{comment}{// and the remainder (original eqn number)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00934}00934         \textcolor{keywordtype}{unsigned} raw\_ieqn = ieqn\_local \% raw\_ndof;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00935}00935         \textcolor{comment}{// hence calculate the global value}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00936}00936         \textcolor{keywordflow}{return} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} + elem\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(raw\_ieqn);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00937}00937       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00938}00938     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00939}00939 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00940}00940 \textcolor{comment}{    /// Return the contribution to the residuals of the element elem\_pt}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00941}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_af43abc524b34d8e8035e2c2323e2fc87}{00941}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_af43abc524b34d8e8035e2c2323e2fc87}{get\_residuals}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00942}00942                        \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00943}00943     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00944}00944       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>assemble\_residuals(\textcolor{keyword}{this}, elem\_pt, residuals);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00945}00945     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00946}00946 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00947}00947 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00948}00948     \textcolor{comment}{// Provide interface}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00949}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a9e8d41c8ad79134466a1a50c11c62dc3}{00949}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a9e8d41c8ad79134466a1a50c11c62dc3}{get\_dofs\_for\_element}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const} elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00950}00950                               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& dofs)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00951}00951     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00952}00952       \textcolor{comment}{// Find the number of dofs in the element}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00953}00953       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_elem\_dof = this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ab960ecaac9239cfbc47f1036893362ff}{ndof}}(elem\_pt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00954}00954       dofs.resize(n\_elem\_dof);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00955}00955       \textcolor{comment}{// Now just get the dofs corresponding to the element's unknowns from the}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00956}00956       \textcolor{comment}{// problem dof}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00957}00957       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_elem\_dof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00958}00958       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00959}00959         dofs[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a2c025f1ba8a9f67bd7ee2dc70462b49a}{dof}}(this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac4d1e4e7e566061c2129157c67adab5b}{eqn\_number}}(elem\_pt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00960}00960       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00961}00961     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00962}00962 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00963}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a681a727dc0a463e924aa88e0e691e2c6}{00963}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a681a727dc0a463e924aa88e0e691e2c6}{get\_previous\_dofs\_for\_element}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const} elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00964}00964                                        \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& dofs)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00965}00965     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00966}00966       \textcolor{comment}{// Find the number of dofs in the element}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00967}00967       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_elem\_dof = this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ab960ecaac9239cfbc47f1036893362ff}{ndof}}(elem\_pt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00968}00968       dofs.resize(n\_elem\_dof);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00969}00969       \textcolor{comment}{// Now just get the dofs corresponding to the element's unknowns from the}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00970}00970       \textcolor{comment}{// problem dof}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00971}00971       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_elem\_dof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00972}00972       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00973}00973         dofs[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aac4a358fed9397f2ffcb796252f78025}{Previous\_dofs}}[this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac4d1e4e7e566061c2129157c67adab5b}{eqn\_number}}(elem\_pt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})];}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00974}00974       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00975}00975     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00976}00976 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00977}00977 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00978}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a3d1d9f709e983495dac3113b8e716843}{00978}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a3d1d9f709e983495dac3113b8e716843}{set\_dofs\_for\_element}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const} elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00979}00979                               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \textcolor{keyword}{const}\& dofs)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00980}00980     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00981}00981       \textcolor{comment}{// Find the number of dofs in the element}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00982}00982       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_elem\_dof = this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ab960ecaac9239cfbc47f1036893362ff}{ndof}}(elem\_pt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00983}00983       \textcolor{comment}{// Now just get the dofs corresponding to the element's unknowns from the}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00984}00984       \textcolor{comment}{// problem dof}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00985}00985       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_elem\_dof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00986}00986       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00987}00987         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a2c025f1ba8a9f67bd7ee2dc70462b49a}{dof}}(this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac4d1e4e7e566061c2129157c67adab5b}{eqn\_number}}(elem\_pt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})) = dofs[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00988}00988       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00989}00989     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00990}00990 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00991}00991 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00992}00992 \textcolor{comment}{    /// Calculate the elemental Jacobian matrix "{}d equation}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00993}00993 \textcolor{comment}{    /// / d variable"{} for elem\_pt.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00994}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a6d901ecdefca1c59403a4ae4b215446f}{00994}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a6d901ecdefca1c59403a4ae4b215446f}{get\_jacobian}}(\mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& elem\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00995}00995                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00996}00996                       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00997}00997     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00998}00998       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>assemble\_residuals\_and\_jacobian(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l00999}00999         \textcolor{keyword}{this}, elem\_pt, residuals, jacobian);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01000}01000     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01001}01001 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01002}01002 \textcolor{comment}{    /// Calculate all desired vectors and matrices}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01003}01003 \textcolor{comment}{    /// provided by the element elem\_pt.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01004}01004 \textcolor{comment}{}    \textcolor{comment}{// void get\_all\_vectors\_and\_matrices(}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01005}01005     \textcolor{comment}{// GeneralisedElement* const \&elem\_pt,}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01006}01006     \textcolor{comment}{// Vector<Vector<double> >\&vec, Vector<DenseMatrix<double> > \&matrix) \{\}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01007}01007 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01008}01008 \textcolor{comment}{    /// Return an unsigned integer to indicate whether the}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01009}01009 \textcolor{comment}{    /// handler is a bifurcation tracking handler. The default}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01010}01010 \textcolor{comment}{    /// is zero (not)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01011}01011 \textcolor{comment}{}    \textcolor{comment}{// virtual int bifurcation\_type() const \{return 0;\}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01012}01012 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01013}01013 \textcolor{comment}{    /// Return a pointer to the}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01014}01014 \textcolor{comment}{    /// bifurcation parameter in bifurcation tracking problems}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01015}01015 \textcolor{comment}{}    \textcolor{comment}{// virtual double* bifurcation\_parameter\_pt() const;}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01016}01016 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01017}01017 \textcolor{comment}{    /// Return the eigenfunction(s) associated with the bifurcation that}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01018}01018 \textcolor{comment}{    /// has been detected in bifurcation tracking problems}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01019}01019 \textcolor{comment}{}    \textcolor{comment}{// virtual void get\_eigenfunction(Vector<DoubleVector> \&eigenfunction);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01020}01020 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01021}01021 \textcolor{comment}{    /// Return the contribution to the residuals of the element elem\_pt}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01022}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a51b7db6467c46b417b3e630d0ef96a8f}{01022}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a51b7db6467c46b417b3e630d0ef96a8f}{orbit\_output}}(std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01023}01023     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01024}01024       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_element = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01025}01025       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01026}01026       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01027}01027         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>orbit\_output(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01028}01028           \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}), outfile, n\_plot);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01029}01029       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01030}01030     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01031}01031 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01032}01032 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01033}01033 \textcolor{comment}{    /// Tell me the times at which you want the solution}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01034}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a555a59c5c5b5dd2e08a31f6c6e176611}{01034}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a555a59c5c5b5dd2e08a31f6c6e176611}{discrete\_times}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01035}01035     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01036}01036       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>nnode();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01037}01037       \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}.resize(n\_node);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01038}01038       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01039}01039       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01040}01040         \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}[n] = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(n)-\/>x(0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01041}01041       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01042}01042     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01043}01043 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01044}01044 \textcolor{comment}{    /// Adapt the time mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01045}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a358d1749faa8ac7dd0de87340d878088}{01045}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a358d1749faa8ac7dd0de87340d878088}{adapt\_temporal\_mesh}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01046}01046     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01047}01047       \textcolor{comment}{// First job is to compute some sort of error measure}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01048}01048       \textcolor{comment}{// Then we can decide how to refine this is probably best handled}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01049}01049       \textcolor{comment}{// separately for now}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01050}01050 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01051}01051       \textcolor{comment}{// The current plan is to copy all (locally held in the case of}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01052}01052       \textcolor{comment}{// distributed problem) spatial degrees of freedom into the dummy}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01053}01053       \textcolor{comment}{// storage of the time mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01054}01054 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01055}01055       \textcolor{comment}{// Probably should kick this down to the mesh level...}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01056}01056 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01057}01057       \textcolor{comment}{// OK, let's do it, count up all values}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01058}01058       \textcolor{keywordtype}{unsigned} total\_n\_value = 0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01059}01059 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01060}01060       \textcolor{comment}{// Firstly the global data in the mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01061}01061       \textcolor{keywordtype}{unsigned} n\_global\_data = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a60a9b6861928cf9115110b5bfc7d11a7}{nglobal\_data}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01062}01062       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_global\_data; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01063}01063       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01064}01064         total\_n\_value += \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a91a255f86e3af72ba1f27d9dee363927}{global\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01065}01065       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01066}01066 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01067}01067       \textcolor{comment}{// Now the nodal data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01068}01068       \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01069}01069       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01070}01070       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01071}01071         total\_n\_value += \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n)-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01072}01072         \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01073}01073           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01074}01074         \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01075}01075         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01076}01076           total\_n\_value += solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01077}01077         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01078}01078       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01079}01079 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01080}01080       \textcolor{comment}{// Now just do the internal data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01081}01081       \textcolor{keywordtype}{unsigned} n\_space\_element = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01082}01082       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_space\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01083}01083       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01084}01084         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_internal\_data =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01085}01085           \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01086}01086         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_internal\_data; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01087}01087         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01088}01088           total\_n\_value +=}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01089}01089             \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01090}01090         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01091}01091       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01092}01092 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01093}01093       \textcolor{comment}{// Now in theory I know the total number of values in the problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01094}01094       \textcolor{comment}{// So I can create another Fake timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01095}01095       \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* fake\_space\_time\_stepper\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01096}01096         \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}(total\_n\_value);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01097}01097 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01098}01098       \textcolor{comment}{// Now apply this time stepper to all time nodes}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01099}01099       \textcolor{keywordtype}{unsigned} n\_time\_node = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>nnode();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01100}01100       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_time\_node; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++) \textcolor{comment}{// Do  include the periodic one}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01101}01101       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01102}01102         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>set\_time\_stepper(fake\_space\_time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01103}01103                                                    \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01104}01104       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01105}01105 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01106}01106       \textcolor{comment}{// Now I "{}just"{} copy the values into the new storage}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01107}01107       \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01108}01108       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_global\_data; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01109}01109       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01110}01110         \mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const} glob\_data\_pt = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a91a255f86e3af72ba1f27d9dee363927}{global\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01111}01111         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = glob\_data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01112}01112         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_value; j++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01113}01113         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01114}01114           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01115}01115           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01116}01116             \textcolor{comment}{// Some heavy assumptions here about the time mesh, but that's OK}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01117}01117             \textcolor{comment}{// because I know exactly how it's laid out}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01118}01118             \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>set\_value(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01119}01119               count, 0, glob\_data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a9383101536882db34e618cbe30dba2da}{value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, j));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01120}01120           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01121}01121           ++count;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01122}01122         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01123}01123       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01124}01124 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01125}01125       \textcolor{comment}{// Now the nodal data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01126}01126       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01127}01127       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01128}01128         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const} nod\_pt = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01129}01129         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01130}01130         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_value; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01131}01131         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01132}01132           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01133}01133           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01134}01134             \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>set\_value(count, 0, nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afcc5cdba40bca251826ae5bee5ca15b4}{value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01135}01135           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01136}01136           ++count;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01137}01137         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01138}01138 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01139}01139         \textcolor{comment}{// Now deal with the solid node data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01140}01140         \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01141}01141         \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01142}01142         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01143}01143           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_solid\_value =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01144}01144             solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01145}01145           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_solid\_value; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01146}01146           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01147}01147             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01148}01148             \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01149}01149               \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>set\_value(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01150}01150                 count, 0, solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a9383101536882db34e618cbe30dba2da}{value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01151}01151             \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01152}01152             ++count;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01153}01153           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01154}01154         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01155}01155       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01156}01156 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01157}01157       \textcolor{comment}{// Now just do the internal data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01158}01158       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_space\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01159}01159       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01160}01160         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_internal =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01161}01161           \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01162}01162         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_internal; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01163}01163         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01164}01164           \mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const} internal\_dat\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01165}01165             \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01166}01166 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01167}01167           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = internal\_dat\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01168}01168           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_value; j++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01169}01169           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01170}01170             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01171}01171             \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01172}01172               \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>set\_value(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01173}01173                 count, 0, internal\_dat\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a9383101536882db34e618cbe30dba2da}{value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, j));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01174}01174             \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01175}01175             ++count;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01176}01176           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01177}01177         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01178}01178       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01179}01179 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01180}01180 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01181}01181       \textcolor{comment}{// Think it's done but let's check}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01182}01182       \textcolor{comment}{/*\{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01183}01183 \textcolor{comment}{       std::ofstream munge("{}data\_remunge.dat"{});}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01184}01184 \textcolor{comment}{       const unsigned n\_time\_element = Time\_mesh\_pt-\/>nelement();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01185}01185 \textcolor{comment}{       for(unsigned e=0;e<n\_time\_element;e++)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01186}01186 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01187}01187 \textcolor{comment}{         const unsigned n\_node = Time\_mesh\_pt-\/>nnode();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01188}01188 \textcolor{comment}{         for(unsigned n=0;n<n\_node;n++)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01189}01189 \textcolor{comment}{          \{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01190}01190 \textcolor{comment}{           Node* const nod\_pt = Time\_mesh\_pt-\/>node\_pt(n);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01191}01191 \textcolor{comment}{           munge << nod\_pt-\/>x(0) << "{} "{};}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01192}01192 \textcolor{comment}{           const unsigned n\_space\_storage = nod\_pt-\/>ntstorage();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01193}01193 \textcolor{comment}{           for(unsigned t=0;t<n\_space\_storage;t++)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01194}01194 \textcolor{comment}{            \{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01195}01195 \textcolor{comment}{             munge << nod\_pt-\/>value(t,0) << "{} "{};}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01196}01196 \textcolor{comment}{            \}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01197}01197 \textcolor{comment}{           munge << std::endl;}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01198}01198 \textcolor{comment}{          \}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01199}01199 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01200}01200 \textcolor{comment}{       munge.close();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01201}01201 \textcolor{comment}{       \}*/}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01202}01202 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01203}01203       \textcolor{comment}{// Ok get the elemental errors}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01204}01204       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_time\_element = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>nelement();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01205}01205       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} elemental\_error(n\_time\_element);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01206}01206       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>spatial\_error\_estimator\_pt()-\/>get\_element\_errors(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01207}01207         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a22e2521bc620ad0cc542213a24f31252}{communicator\_pt}}(), \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae527e33cddc33225b532e6a64f255483}{Basic\_time\_mesh\_pt}}, elemental\_error);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01208}01208 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01209}01209       \textcolor{comment}{// Let's dump it}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01210}01210       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_time\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01211}01211       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01212}01212         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} << \textcolor{stringliteral}{"{} "{}} << elemental\_error[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01213}01213       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01214}01214 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01215}01215       \textcolor{comment}{// Now adapt the mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01216}01216       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>adapt(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a22e2521bc620ad0cc542213a24f31252}{communicator\_pt}}(), elemental\_error);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01217}01217 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01218}01218       \textcolor{comment}{// I seem to have remunged the data,}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01219}01219       \textcolor{comment}{// Now let's pretend that we have done the the error adaptation}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01220}01220       \textcolor{comment}{// Time\_mesh\_pt-\/>refine\_uniformly();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01221}01221 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01222}01222       \textcolor{comment}{// Let's just refine the central elements twice}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01223}01223       \textcolor{comment}{// Vector<unsigned> refine\_elements;}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01224}01224       \textcolor{comment}{// refine\_elements.push\_back(0);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01225}01225       \textcolor{comment}{// refine\_elements.push\_back(9);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01226}01226       \textcolor{comment}{// Time\_mesh\_pt-\/>refine\_selected\_elements(refine\_elements);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01227}01227       \textcolor{comment}{// refine\_elements.clear();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01228}01228       \textcolor{comment}{// refine\_elements.push\_back(0);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01229}01229       \textcolor{comment}{// refine\_elements.push\_back(1);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01230}01230       \textcolor{comment}{// refine\_elements.push\_back(10);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01231}01231       \textcolor{comment}{// refine\_elements.push\_back(11);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01232}01232       \textcolor{comment}{// Time\_mesh\_pt-\/>refine\_selected\_elements(refine\_elements);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01233}01233 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01234}01234       \textcolor{comment}{/* std::ofstream munge("{}data\_refine.dat"{});}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01235}01235 \textcolor{comment}{      const unsigned n\_time\_element = Time\_mesh\_pt-\/>nelement();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01236}01236 \textcolor{comment}{      for(unsigned e=0;e<n\_time\_element;e++)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01237}01237 \textcolor{comment}{       \{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01238}01238 \textcolor{comment}{        const unsigned n\_node = Time\_mesh\_pt-\/>nnode();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01239}01239 \textcolor{comment}{        for(unsigned n=0;n<n\_node;n++)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01240}01240 \textcolor{comment}{         \{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01241}01241 \textcolor{comment}{          Node* const nod\_pt = Time\_mesh\_pt-\/>node\_pt(n);}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01242}01242 \textcolor{comment}{          munge << nod\_pt-\/>x(0) << "{} "{};}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01243}01243 \textcolor{comment}{          const unsigned n\_space\_storage = nod\_pt-\/>ntstorage();}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01244}01244 \textcolor{comment}{          for(unsigned t=0;t<n\_space\_storage;t++)}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01245}01245 \textcolor{comment}{           \{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01246}01246 \textcolor{comment}{            munge << nod\_pt-\/>value(t,0) << "{} "{};}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01247}01247 \textcolor{comment}{           \}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01248}01248 \textcolor{comment}{          munge << std::endl;}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01249}01249 \textcolor{comment}{         \}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01250}01250 \textcolor{comment}{       \}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01251}01251 \textcolor{comment}{       munge.close();*/}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01252}01252 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01253}01253       \textcolor{comment}{// Now we need to put the refined data back into the problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01254}01254 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01255}01255       \textcolor{comment}{// Now we need to number the mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01256}01256       \textcolor{comment}{// Dummy dof pointer}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01257}01257       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double*>}} dummy\_dof\_pt;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01258}01258       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>assign\_global\_eqn\_numbers(dummy\_dof\_pt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01259}01259       \textcolor{comment}{// Assign the local equation numbers}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01260}01260       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>assign\_local\_eqn\_numbers(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01261}01261 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01262}01262       \textcolor{comment}{// Find the number of temporal degrees of freedom}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01263}01263       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} = dummy\_dof\_pt.size();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01264}01264       \textcolor{comment}{// and new number of elements}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01265}01265       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a52b49ec4c94b9cf480395c7cad123ced}{N\_element\_in\_period}} = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>nelement();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01266}01266 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01267}01267       \textcolor{comment}{// Create the new "{}fake"{} timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01268}01268       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}* periodic\_time\_stepper\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01269}01269         \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitTimeDiscretisation}{PeriodicOrbitTimeDiscretisation}}(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01270}01270 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01271}01271       \textcolor{comment}{// Loop over the temporal elements and set the pointers}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01272}01272       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a52b49ec4c94b9cf480395c7cad123ced}{N\_element\_in\_period}}; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01273}01273       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01274}01274         \mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement}{SpectralPeriodicOrbitElement<NNODE\_1D>}}* el\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01275}01275           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SpectralPeriodicOrbitElement}{SpectralPeriodicOrbitElement<NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01276}01276             \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>element\_pt(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01277}01277 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01278}01278         \textcolor{comment}{// Set the time and the timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01279}01279         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a19d51057fd6ac9d1c152616c9ed2fd65}{time\_pt}}() = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae87f0d17b929d9b6097e19c2507c87f9}{time\_pt}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01280}01280         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeomObject_a0fc851a3b50103b6c9f68efe86e709de}{time\_stepper\_pt}}() = periodic\_time\_stepper\_pt;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01281}01281 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01282}01282         \textcolor{comment}{// Set the number of temporal degrees of freedom}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01283}01283         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_aaed37b9539f2f77d642a18fdd1e13e88}{set\_ntstorage}}(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01284}01284         \textcolor{comment}{// Set the frequency}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01285}01285         el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitEquations_a1a38e53f54ff93ce26898b4ab33db69f}{omega\_pt}}() = \&\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae922867706dcf2e79e837bbbe774e053}{Omega}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01286}01286       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01287}01287 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01288}01288       \textcolor{comment}{// We now need to do something much more drastic which is to loop over all}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01289}01289       \textcolor{comment}{// our the data in the problem and change the timestepper, which is going}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01290}01290       \textcolor{comment}{// to be a real pain when I start to worry about halo nodes, etc.}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01291}01291 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01292}01292       \textcolor{comment}{// Will need to use the appropriate mesh-\/level functions that have}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01293}01293       \textcolor{comment}{// not been written yet ..}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01294}01294 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01295}01295       \textcolor{comment}{// Let's just break if there are submeshes}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01296}01296       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_accc4e5a46953800933f07ae6bd67860e}{nsub\_mesh}}() > 0)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01297}01297       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01298}01298         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01299}01299           \textcolor{stringliteral}{"{}PeriodicOrbitHandler can't cope with submeshes yet"{}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01300}01300           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01301}01301           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01302}01302       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01303}01303 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01304}01304       \textcolor{comment}{// OK now we have only one mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01305}01305       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01306}01306       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01307}01307         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const} nod\_pt = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01308}01308         nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_acd22fabfb127ff4ea37a5bc60c61b414}{set\_time\_stepper}}(periodic\_time\_stepper\_pt, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01309}01309       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01310}01310 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01311}01311       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_space\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01312}01312       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01313}01313         \textcolor{keywordtype}{unsigned} n\_internal =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01314}01314           \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01315}01315         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_internal; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01316}01316         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01317}01317           \textcolor{comment}{// Cache the internal data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01318}01318           \mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const} data\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01319}01319             \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01320}01320           \textcolor{comment}{// and set the timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01321}01321           data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_acd22fabfb127ff4ea37a5bc60c61b414}{set\_time\_stepper}}(periodic\_time\_stepper\_pt, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01322}01322         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01323}01323       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01324}01324 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01325}01325       \textcolor{comment}{// Now I can delete the old timestepper and switch}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01326}01326       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae2a8149c7cd33e41765ef080e1654e81}{Time\_stepper\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01327}01327       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae2a8149c7cd33e41765ef080e1654e81}{Time\_stepper\_pt}} = periodic\_time\_stepper\_pt;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01328}01328 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01329}01329       \textcolor{comment}{// Need to reassign equation numbers so that the DOF pointer, points to}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01330}01330       \textcolor{comment}{// the newly allocated storage}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01331}01331       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Re-\/allocated "{}} << \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a0df501c6aed60c4938861df776b10119}{assign\_eqn\_numbers}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01332}01332                  << \textcolor{stringliteral}{"{} equation numbers\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01333}01333 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01334}01334       \textcolor{comment}{// Now's let's add all the unknowns to the problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01335}01335       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_aa9e4cfff7e1dc295036b0e58bc11ae75}{Dof\_pt}}.resize(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} + 1);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01336}01336       \textcolor{comment}{// This is reasonably straight forward using pointer arithmetic}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01337}01337       \textcolor{comment}{// but this does rely on knowing how the data is stored in the}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01338}01338       \textcolor{comment}{// Nodes which is a little nasty}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01339}01339       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01340}01340       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01341}01341         \textcolor{keywordtype}{unsigned} offset = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01342}01342         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}}; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01343}01343         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01344}01344           \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_aa9e4cfff7e1dc295036b0e58bc11ae75}{Dof\_pt}}[offset + n] = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_aa9e4cfff7e1dc295036b0e58bc11ae75}{Dof\_pt}}[n] + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01345}01345         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01346}01346       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01347}01347 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01348}01348       \textcolor{comment}{// Add the frequency of the orbit to the unknowns}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01349}01349       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_aa9e4cfff7e1dc295036b0e58bc11ae75}{Dof\_pt}}[\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}] = \&\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ae922867706dcf2e79e837bbbe774e053}{Omega}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01350}01350 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01351}01351       \textcolor{comment}{// Rebuild everything}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01352}01352       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ade01b88db08dcec1706fe44eaa0090a3}{Dof\_distribution\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_a3cab441019e738e4c6db6ee22dd71515}{build}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01353}01353         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a22e2521bc620ad0cc542213a24f31252}{communicator\_pt}}(), \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} + 1, \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01354}01354 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01355}01355 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01356}01356       \textcolor{comment}{// Now finally transfer the solution accross}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01357}01357 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01358}01358       \textcolor{comment}{// Now I "{}just"{} copy the values into the new storage}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01359}01359       count = 0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01360}01360       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_global\_data; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01361}01361       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01362}01362         \mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const} glob\_data\_pt = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_a91a255f86e3af72ba1f27d9dee363927}{global\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01363}01363         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = glob\_data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01364}01364         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_value; j++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01365}01365         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01366}01366           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01367}01367           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01368}01368             \textcolor{comment}{// Some heavy assumptions here about the time mesh, but that's OK}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01369}01369             \textcolor{comment}{// because I know exactly how it's laid out}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01370}01370             glob\_data\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01371}01371               \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, j, \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>value(count, 0));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01372}01372           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01373}01373           ++count;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01374}01374         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01375}01375       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01376}01376 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01377}01377       \textcolor{comment}{// Now the nodal data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01378}01378       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01379}01379       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01380}01380         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const} nod\_pt = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01381}01381         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01382}01382         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_value; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01383}01383         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01384}01384           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01385}01385           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01386}01386             nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>value(count, 0));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01387}01387           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01388}01388           ++count;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01389}01389         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01390}01390 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01391}01391         \textcolor{comment}{// Now deal with the solid node data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01392}01392         \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01393}01393         \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01394}01394         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01395}01395           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_solid\_value =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01396}01396             solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01397}01397           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_solid\_value; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01398}01398           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01399}01399             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01400}01400             \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01401}01401               solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01402}01402                 \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>value(count, 0));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01403}01403             \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01404}01404             ++count;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01405}01405           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01406}01406         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01407}01407       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01408}01408 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01409}01409       \textcolor{comment}{// Now just do the internal data}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01410}01410       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_space\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01411}01411       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01412}01412         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_internal =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01413}01413           \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01414}01414         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_internal; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01415}01415         \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01416}01416           \mbox{\hyperlink{classoomph_1_1Data}{Data}}* \textcolor{keyword}{const} internal\_dat\_pt =}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01417}01417             \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3a8b481f99a46352f50186a8f9efe4b}{Problem\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Problem_ae2e5559918832d0850b3631d004d0a37}{mesh\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9a5d03afb8730e9459ecbc67c6439143}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01418}01418 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01419}01419           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = internal\_dat\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01420}01420           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_value; j++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01421}01421           \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01422}01422             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}}; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01423}01423             \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01424}01424               internal\_dat\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01425}01425                 \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, j, \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>value(count, 0));}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01426}01426             \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01427}01427             ++count;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01428}01428           \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01429}01429         \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01430}01430       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01431}01431 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01432}01432 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01433}01433       \textcolor{comment}{// Now I should be able to delete the fake time timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01434}01434       n\_time\_node = \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>nnode();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01435}01435       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_time\_node; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01436}01436       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01437}01437         \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}}-\/>node\_pt(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})-\/>set\_time\_stepper(\&\mbox{\hyperlink{classoomph_1_1Mesh_a12243d0fee2b1fcee729ee5a4777ea10}{Mesh::Default\_TimeStepper}},}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01438}01438                                                    \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01439}01439       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01440}01440       \textcolor{comment}{// Delete the fake timestepper}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01441}01441       \textcolor{keyword}{delete} fake\_space\_time\_stepper\_pt;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01442}01442 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01443}01443       \textcolor{comment}{// Set the initial unkowns to be the original problem}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01444}01444       \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aac4a358fed9397f2ffcb796252f78025}{Previous\_dofs}}.resize(\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa04e0d8d17e69d64d53df7f9d7369fad}{Ndof}} * \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ada223550212a4e5e5b6838f96e5a2170}{N\_tstorage}} + 1, 0.0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01445}01445       this-\/>\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_ac3296942fb40f5ca642521db38d44988}{set\_previous\_dofs\_to\_current\_dofs}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01446}01446     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01447}01447 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01448}01448 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01449}01449 \textcolor{comment}{    /// Destructor, destroy the time mesh}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01450}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a919aba117d2e7f08d1462b9d00799782}{01450}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_a919aba117d2e7f08d1462b9d00799782}{\string~PeriodicOrbitAssemblyHandler}}()}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01451}01451     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01452}01452       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitAssemblyHandler_aa6a4d6fc7cfbfd3a1d8babcc3d0e8a90}{Time\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01453}01453     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01454}01454   \};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01455}01455 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01456}01456 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01457}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement}{01457}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement}{PeriodicOrbitBaseElement}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01458}01458   \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01459}01459   \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01460}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_a1eb14a3e5456ff4f6dda6032ab26f9fe}{01460}}     \mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_a1eb14a3e5456ff4f6dda6032ab26f9fe}{PeriodicOrbitBaseElement}}() : \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}() \{\}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01461}01461 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01462}01462 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01463}01463 \textcolor{comment}{    /// Interface to get the current value of all (internal and shared) unknowns}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01464}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_abba1af9fcade9cb3348ba3211b4241b6}{01464}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_abba1af9fcade9cb3348ba3211b4241b6}{get\_non\_external\_dofs}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& u) \{\}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01465}01465 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01466}01466 \textcolor{comment}{    /// Interface to get the current value of the time derivative of}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01467}01467 \textcolor{comment}{    /// all (internal and shared) unknowns}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01468}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_a115fb7538cac83389818170a6b36bdcc}{01468}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_a115fb7538cac83389818170a6b36bdcc}{get\_non\_external\_ddofs\_dt}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& du\_dt) \{\}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01469}01469 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01470}01470 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01471}01471 \textcolor{comment}{    /// Get the inner product matrix}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01472}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_acc9cea11affa9cba587419c833ef6ea9}{01472}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_acc9cea11affa9cba587419c833ef6ea9}{get\_inner\_product\_matrix}}(\mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& inner\_product)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01473}01473     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01474}01474       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dof = this-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37204f67b37d212fd170c68d48f6da57}{ndof}}();}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01475}01475       inner\_product.\mbox{\hyperlink{classoomph_1_1DenseMatrix_aafcfbb0309fdcbd84f8654fe1b5601fd}{initialise}}(0.0);}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01476}01476       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01477}01477       \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01478}01478         inner\_product(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 1.0;}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01479}01479       \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01480}01480     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01481}01481 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01482}\mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_a6d543d9fa979ed60cec6b5f0dac4b0d6}{01482}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PeriodicOrbitBaseElement_a6d543d9fa979ed60cec6b5f0dac4b0d6}{spacetime\_output}}(std::ostream\& outilfe,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01483}01483                                   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& Nplot,}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01484}01484                                   \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& time = 0.0)}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01485}01485     \{}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01486}01486     \}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01487}01487   \};}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01488}01488 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01489}01489 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01490}01490 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01491}01491 }
\DoxyCodeLine{\Hypertarget{periodic__orbit__handler_8h_source_l01492}01492 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

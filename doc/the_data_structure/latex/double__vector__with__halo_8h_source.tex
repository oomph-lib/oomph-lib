\hypertarget{double__vector__with__halo_8h_source}{}\doxysection{double\+\_\+vector\+\_\+with\+\_\+halo.\+h}
\label{double__vector__with__halo_8h_source}\index{double\_vector\_with\_halo.h@{double\_vector\_with\_halo.h}}
\mbox{\hyperlink{double__vector__with__halo_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2022 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00026}00026 \textcolor{preprocessor}{\#ifndef OOMPH\_DOUBLE\_VECTOR\_WITH\_HALO\_CLASS\_HEADER}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00027}00027 \textcolor{preprocessor}{\#define OOMPH\_DOUBLE\_VECTOR\_WITH\_HALO\_CLASS\_HEADER}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00029}00029 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00030}00030 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00031}00031 \textcolor{preprocessor}{\#include <oomph-\/lib-\/config.h>}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00032}00032 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00034}00034 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00035}00035 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{double__vector_8h}{double\_vector.h}}"{}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00037}00037 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00038}00038 \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00039}00039   \textcolor{keyword}{class }DoubleVectorWithHaloEntries;}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00041}00041   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00042}00042 \textcolor{comment}{  /// A class that stores the halo/haloed entries required when}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00043}00043 \textcolor{comment}{  /// using a DoubleVectorWithHaloEntries.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00044}00044 \textcolor{comment}{  /// This is a separate class so thay many different Vectors can share}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00045}00045 \textcolor{comment}{  /// the same object.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00046}00046 \textcolor{comment}{  /// The constructor requires the distribution of the DoubleVector}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00047}00047 \textcolor{comment}{  /// (if you pass in a different distribution things will go badly wrong)}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00048}00048 \textcolor{comment}{  /// and a vector that specifies which GLOBAL eqn numbers are required}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00049}00049 \textcolor{comment}{  /// on each processor.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00050}00050 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00051}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{00051}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{DoubleVectorHaloScheme}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00052}00052   \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00053}00053 \textcolor{comment}{    /// The DoubleVectorWithHaloEntries should be able to access the}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00054}00054 \textcolor{comment}{    /// private data.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00055}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_acae5914031232d05e22888b081f2598f}{00055}} \textcolor{comment}{}    \textcolor{keyword}{friend} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries}{DoubleVectorWithHaloEntries}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00056}00056 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00057}00057 \textcolor{comment}{    /// Storage for the translation scheme from global unknown}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00058}00058 \textcolor{comment}{    /// to local index in the additional storage vector.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00059}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a796210b483850bd17f09a0ba85033a1b}{00059}} \textcolor{comment}{}    std::map<unsigned, unsigned> \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a796210b483850bd17f09a0ba85033a1b}{Local\_index}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00060}00060 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00061}00061 \textcolor{comment}{    /// The haloed entries that will be sent in a format compatible}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00062}00062 \textcolor{comment}{    /// with MPI\_Alltoallv i.e. (send\_to\_proc0,send\_to\_proc1 ... send\_to\_procn)}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00063}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_aac79c7fe19ec6fae41e2528a540d0eae}{00063}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_aac79c7fe19ec6fae41e2528a540d0eae}{Haloed\_eqns}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00064}00064 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00065}00065 \textcolor{comment}{    /// Storage for the number of haloed entries to be sent to each}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00066}00066 \textcolor{comment}{    /// processor}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00067}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a13f0645d32135d7ffaedef8c888f7382}{00067}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a13f0645d32135d7ffaedef8c888f7382}{Haloed\_n}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00068}00068 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00069}00069 \textcolor{comment}{    /// Storage for the offsets of the haloed entries for each processor}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00070}00070 \textcolor{comment}{    /// in the packed Haloed\_eqns array}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00071}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a7e8278718224d7348051443805bf145e}{00071}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a7e8278718224d7348051443805bf145e}{Haloed\_displacement}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00072}00072 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00073}00073 \textcolor{comment}{    /// Storage for all the entries that are to be received from}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00074}00074 \textcolor{comment}{    /// other processors}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00075}00075 \textcolor{comment}{    /// (received\_from\_proc0,received\_from\_proc1,...received\_from\_procn)}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00076}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_ae9dc75c67359f762bd09bdaf904158fe}{00076}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_ae9dc75c67359f762bd09bdaf904158fe}{Halo\_eqns}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00077}00077 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00078}00078 \textcolor{comment}{    /// Storage for the number of entries to be received from each}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00079}00079 \textcolor{comment}{    /// other processor}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00080}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a47895cdeb23fef294e0facf880847063}{00080}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a47895cdeb23fef294e0facf880847063}{Halo\_n}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00081}00081 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00082}00082 \textcolor{comment}{    /// Storage for the offsets of the processor data in the}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00083}00083 \textcolor{comment}{    /// receive buffer}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00084}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a4357c43e12dbadede7f9852a96db4391}{00084}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a4357c43e12dbadede7f9852a96db4391}{Halo\_displacement}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00085}00085 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00086}00086 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00087}00087 \textcolor{comment}{    /// Store the distribution that was used to setup the halo scheme}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00088}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a4c3aa7f9d1da907fdbacf79c36355004}{00088}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a4c3aa7f9d1da907fdbacf79c36355004}{Distribution\_pt}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00089}00089 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00090}00090   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00091}00091 \textcolor{comment}{    /// Constructor that sets up the required information communicating}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00092}00092 \textcolor{comment}{    /// between all processors. Requires two "{}all to all"{} communications.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00093}00093 \textcolor{comment}{    /// Arguments are the distribution of the DoubleVector and a}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00094}00094 \textcolor{comment}{    /// Vector of global unknowns required on this processor.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00095}00095 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_ac3809f5cac00b082a66bbf706087627e}{DoubleVectorHaloScheme}}(\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* \textcolor{keyword}{const}\& dist\_pt,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00096}00096                            \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& required\_global\_eqn);}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00097}00097 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00098}00098 \textcolor{comment}{    /// Return the number of halo values}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00099}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a490138b2ae077bc6630d13057217105b}{00099}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a490138b2ae077bc6630d13057217105b}{n\_halo\_values}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00100}00100 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00101}00101       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a796210b483850bd17f09a0ba85033a1b}{Local\_index}}.size();}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00102}00102     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00103}00103 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00104}00104 \textcolor{comment}{    /// Return the pointer to the distirbution used to setup}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00105}00105 \textcolor{comment}{    /// the halo information}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00106}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_acc890e9b1db5c2fe4436a473664b4d85}{00106}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}*\& \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_acc890e9b1db5c2fe4436a473664b4d85}{distribution\_pt}}()}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00107}00107     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00108}00108       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a4c3aa7f9d1da907fdbacf79c36355004}{Distribution\_pt}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00109}00109     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00110}00110 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00111}00111 \textcolor{comment}{    /// Function that sets up a vector of pointers to halo}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00112}00112 \textcolor{comment}{    /// data, index using the scheme in Local\_index}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00113}00113 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_aa630dd65e7a97e5609426baffcb6eca9}{setup\_halo\_dofs}}(\textcolor{keyword}{const} std::map<unsigned, double*>\& halo\_data\_pt,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00114}00114                          \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double*>}}\& halo\_dof\_pt);}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00116}00116 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00117}00117 \textcolor{comment}{    /// Return the local index associated with the global equation}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00118}\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_ad589a203cdd37bc2508930d8db845a49}{00118}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_ad589a203cdd37bc2508930d8db845a49}{local\_index}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& global\_eqn)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00119}00119     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00120}00120       \textcolor{comment}{// Does the entry exist in the map}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00121}00121       std::map<unsigned, unsigned>::iterator it = \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a796210b483850bd17f09a0ba85033a1b}{Local\_index}}.find(global\_eqn);}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00122}00122       \textcolor{comment}{// If it does return it}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00123}00123       \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_a796210b483850bd17f09a0ba85033a1b}{Local\_index}}.end())}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00124}00124       \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00125}00125         \textcolor{keywordflow}{return} it-\/>second;}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00126}00126       \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00127}00127       \textcolor{comment}{// Otherwise throw an error}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00128}00128       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00129}00129       \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00130}00130         std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00131}00131         error\_stream << \textcolor{stringliteral}{"{}Global equation "{}} << global\_eqn << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00132}00132                      << \textcolor{stringliteral}{"{}has not been set as halo\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00133}00133         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00134}00134           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00135}00135         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00136}00136       \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00137}00137     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00138}00138   \};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00140}00140 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00141}00141 \textcolor{comment}{  /// =====================================================================}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00142}00142 \textcolor{comment}{  /// An extension of DoubleVector that allows access to certain}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00143}00143 \textcolor{comment}{  /// global entries that are not stored locally. Synchronisation of these}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00144}00144 \textcolor{comment}{  /// values must be performed manually by calling the synchronise()}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00145}00145 \textcolor{comment}{  /// function. Synchronisation can only be from the haloed to the halo,}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00146}00146 \textcolor{comment}{  /// but the local halo entries can all be summed and stored in the}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00147}00147 \textcolor{comment}{  /// haloed value.}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00148}00148 \textcolor{comment}{  /// ======================================================================}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00149}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries}{00149}} \textcolor{comment}{}  \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries}{DoubleVectorWithHaloEntries}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00150}00150   \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00151}00151 \textcolor{comment}{    /// Pointer to the lookup scheme that stores information about}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00152}00152 \textcolor{comment}{    /// on which processor the required information is haloed}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00153}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{00153}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{DoubleVectorHaloScheme}}* \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{Halo\_scheme\_pt}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00154}00154 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00155}00155 \textcolor{comment}{    /// Vector of the halo values}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00156}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_ac2b04ca1db09db85401e0d59a225856b}{00156}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_ac2b04ca1db09db85401e0d59a225856b}{Halo\_value}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00158}00158   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00159}00159 \textcolor{comment}{    /// Constructor for an uninitialized DoubleVectorWithHaloEntries}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00160}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a023d72d2bd81de0e62c5c860edbca5d5}{00160}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a023d72d2bd81de0e62c5c860edbca5d5}{DoubleVectorWithHaloEntries}}() : \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}(), \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{Halo\_scheme\_pt}}(0) \{\}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00161}00161 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00162}00162 \textcolor{comment}{    /// Constructor. Assembles a DoubleVectorWithHaloEntries}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00163}00163 \textcolor{comment}{    /// with a prescribed}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00164}00164 \textcolor{comment}{    /// distribution. Additionally every entry can be set (with argument v -\/}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00165}00165 \textcolor{comment}{    /// defaults to 0).}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00166}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a11d1cd58eeb7f5d125f76537f49a1c42}{00166}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a11d1cd58eeb7f5d125f76537f49a1c42}{DoubleVectorWithHaloEntries}}(}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00167}00167       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* \textcolor{keyword}{const}\& dist\_pt,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00168}00168       \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{DoubleVectorHaloScheme}}* \textcolor{keyword}{const}\& \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}} = 0,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00169}00169       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& v = 0.0)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00170}00170       : \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}(dist\_pt, v)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00171}00171     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00172}00172       \textcolor{comment}{// construct the halo scheme}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00173}00173       this-\/>\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a1aab1a84c6a82a755fdc3c6b27ce49d7}{build\_halo\_scheme}}(\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}});}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00174}00174     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00175}00175 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00176}00176 \textcolor{comment}{    /// Constructor. Assembles a DoubleVectorWithHaloEntries}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00177}00177 \textcolor{comment}{    /// with a prescribed}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00178}00178 \textcolor{comment}{    /// distribution. Additionally every entry can be set (with argument v -\/}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00179}00179 \textcolor{comment}{    /// defaults to 0).}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00180}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a28df73429d7ab3f349849c33a610df8c}{00180}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a28df73429d7ab3f349849c33a610df8c}{DoubleVectorWithHaloEntries}}(}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00181}00181       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}\& dist,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00182}00182       \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{DoubleVectorHaloScheme}}* \textcolor{keyword}{const}\& \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}} = 0,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00183}00183       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& v = 0.0)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00184}00184       : \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}(dist, v)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00185}00185     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00186}00186       \textcolor{comment}{// construct the halo scheme}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00187}00187       this-\/>\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a1aab1a84c6a82a755fdc3c6b27ce49d7}{build\_halo\_scheme}}(\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}});}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00188}00188     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00189}00189 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00190}00190 \textcolor{comment}{    /// Destructor}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00191}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_aff20c271cfabd18132df864d24ad5cbf}{00191}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_aff20c271cfabd18132df864d24ad5cbf}{\string~DoubleVectorWithHaloEntries}}() \{\}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00192}00192 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00193}00193 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00194}00194 \textcolor{comment}{    /// Copy constructor from any DoubleVector}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00195}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a9bef4c069e52aa1aa394e8b0b75d3367}{00195}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a9bef4c069e52aa1aa394e8b0b75d3367}{DoubleVectorWithHaloEntries}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries}{DoubleVectorWithHaloEntries}}\& new\_vector)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00196}00196       : \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}(new\_vector)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00197}00197     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00198}00198       \textcolor{comment}{// Build the appropriate halo scheme}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00199}00199       this-\/>\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a1aab1a84c6a82a755fdc3c6b27ce49d7}{build\_halo\_scheme}}(new\_vector.\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}}());}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00200}00200     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00201}00201 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00202}00202 \textcolor{comment}{    /// Copy constructor from any DoubleVector}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00203}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a4af6e4f6038ea0071b7b19d4f4c1a859}{00203}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a4af6e4f6038ea0071b7b19d4f4c1a859}{DoubleVectorWithHaloEntries}}(}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00204}00204       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& new\_vector,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00205}00205       \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{DoubleVectorHaloScheme}}* \textcolor{keyword}{const}\& \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}} = 0)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00206}00206       : \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}(new\_vector)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00207}00207     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00208}00208       \textcolor{comment}{// Construct the halo scheme}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00209}00209       this-\/>\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a1aab1a84c6a82a755fdc3c6b27ce49d7}{build\_halo\_scheme}}(\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}});}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00210}00210     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00211}00211 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00212}00212 \textcolor{comment}{    /// assignment operator}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00213}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_aac1e401b12a149b56fe0d6211487d30c}{00213}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_aac1e401b12a149b56fe0d6211487d30c}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries}{DoubleVectorWithHaloEntries}}\& old\_vector)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00214}00214     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00215}00215       this-\/>\mbox{\hyperlink{classoomph_1_1DoubleVector_a7bcc94c157d6853a0f0502e8a76ed380}{build}}(old\_vector);}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00216}00216       \textcolor{comment}{// Do some other stuff}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00217}00217       this-\/>\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a1aab1a84c6a82a755fdc3c6b27ce49d7}{build\_halo\_scheme}}(old\_vector.\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}}());}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00218}00218     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00219}00219 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00220}00220 \textcolor{comment}{    /// Direct access to global entry}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00221}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_ad7e911b1a0cf1ffd163d75f0777f5100}{00221}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_ad7e911b1a0cf1ffd163d75f0777f5100}{global\_value}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00222}00222     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00223}00223       \textcolor{comment}{// Only need to worry about the distributed case if}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00224}00224       \textcolor{comment}{// we have compiled with MPI}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00225}00225 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00226}00226       \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a5505731e7e73d7e4251c67c7adec6bf5}{distributed}}())}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00227}00227       \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00228}00228         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} first\_row\_local = this-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\_row}}();}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00229}00229         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_row\_local = this-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\_local}}();}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00230}00230 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00231}00231         \textcolor{comment}{// If we are in range then just call the local value}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00232}00232         \textcolor{keywordflow}{if} ((i >= first\_row\_local) \&\& (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < first\_row\_local + n\_row\_local))}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00233}00233         \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00234}00234           \textcolor{keywordflow}{return} (*\textcolor{keyword}{this})[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ first\_row\_local];}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00235}00235         \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00236}00236         \textcolor{comment}{// Otherwise the entry is not stored in the local processor}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00237}00237         \textcolor{comment}{// and we must have haloed it}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00238}00238         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00239}00239         \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00240}00240 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00241}00241           \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{Halo\_scheme\_pt}} == 0)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00242}00242           \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00243}00243             std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00244}00244             error\_stream}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00245}00245               << \textcolor{stringliteral}{"{}Halo data requested, but no halo scheme has been setup\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00246}00246               << \textcolor{stringliteral}{"{}You should call this-\/>build\_halo\_scheme(halo\_scheme\_pt).\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00247}00247               << \textcolor{stringliteral}{"{}You may wish to setup the scheme for the Problem using \(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00248}00248               << \textcolor{stringliteral}{"{}Problem::setup\_dof\_halo\_scheme()\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00249}00249 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00250}00250             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00251}00251                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00252}00252                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00253}00253           \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00254}00254 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00255}00255           \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_ac2b04ca1db09db85401e0d59a225856b}{Halo\_value}}[\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{Halo\_scheme\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_ad589a203cdd37bc2508930d8db845a49}{local\_index}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})];}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00256}00256         \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00257}00257       \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00258}00258       \textcolor{comment}{// If not distributed the global entry is}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00259}00259       \textcolor{comment}{// the local entry}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00260}00260       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00261}00261 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00262}00262       \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00263}00263         \textcolor{keywordflow}{return} (*\textcolor{keyword}{this})[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00264}00264       \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00265}00265     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00266}00266 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00267}00267 \textcolor{comment}{    /// Direct access to the global entry (const version)}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00268}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_ad98faaf52c404514c6c6190289458e40}{00268}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_ad98faaf52c404514c6c6190289458e40}{global\_value}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00269}00269 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00270}00270       \textcolor{comment}{// Only need to worry about the distributed case if}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00271}00271       \textcolor{comment}{// we have compiled with MPI}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00272}00272 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00273}00273       \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a5505731e7e73d7e4251c67c7adec6bf5}{distributed}}())}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00274}00274       \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00275}00275         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} first\_row\_local = this-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\_row}}();}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00276}00276         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_row\_local = this-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\_local}}();}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00278}00278         \textcolor{comment}{// If we are in range then just call the local value}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00279}00279         \textcolor{keywordflow}{if} ((i >= first\_row\_local) \&\& (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < first\_row\_local + n\_row\_local))}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00280}00280         \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00281}00281           \textcolor{keywordflow}{return} (*\textcolor{keyword}{this})[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ first\_row\_local];}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00282}00282         \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00283}00283         \textcolor{comment}{// Otherwise the entry is not stored in the local processor}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00284}00284         \textcolor{comment}{// and we must have haloed it}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00285}00285         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00286}00286         \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00287}00287 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00288}00288           \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{Halo\_scheme\_pt}} == 0)}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00289}00289           \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00290}00290             std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00291}00291             error\_stream}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00292}00292               << \textcolor{stringliteral}{"{}Halo data requested, but no halo scheme has been setup\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00293}00293               << \textcolor{stringliteral}{"{}You should call this-\/>build\_halo\_scheme(halo\_scheme\_pt).\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00294}00294               << \textcolor{stringliteral}{"{}You may wish to setup the scheme for the Problem using \(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00295}00295               << \textcolor{stringliteral}{"{}Problem::setup\_dof\_halo\_scheme()\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00296}00296 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00297}00297             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00298}00298                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00299}00299                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00300}00300           \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00301}00301 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00302}00302           \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_ac2b04ca1db09db85401e0d59a225856b}{Halo\_value}}[\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{Halo\_scheme\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme_ad589a203cdd37bc2508930d8db845a49}{local\_index}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})];}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00303}00303         \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00304}00304       \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00305}00305       \textcolor{comment}{// If not distributed the global entry is}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00306}00306       \textcolor{comment}{// the local entry}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00307}00307       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00308}00308 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00309}00309       \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00310}00310         \textcolor{keywordflow}{return} (*\textcolor{keyword}{this})[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00311}00311       \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00312}00312     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00313}00313 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00314}00314 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00315}00315 \textcolor{comment}{    /// Synchronise the halo data}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00316}00316 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a6d5b6e2c1c80d4fb468c851030d62492}{synchronise}}();}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00317}00317 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00318}00318 \textcolor{comment}{    /// Sum all the data, store in the master (haloed) data and then}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00319}00319 \textcolor{comment}{    /// synchronise}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00320}00320 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7165745d3397b6ea9d87f123cc97e5c9}{sum\_all\_halo\_and\_haloed\_values}}();}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00321}00321 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00322}00322 \textcolor{comment}{    /// Access function for halo scheme}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00323}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{00323}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{DoubleVectorHaloScheme}}*\& \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}}()}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00324}00324     \{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00325}00325       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{Halo\_scheme\_pt}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00326}00326     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00327}00327 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00328}00328 \textcolor{comment}{    /// Access function for halo scheme (const version)}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00329}\mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a227b3502b01bf9719cceff99ac38c7f5}{00329}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{DoubleVectorHaloScheme}}* \textcolor{keyword}{const}\& \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a227b3502b01bf9719cceff99ac38c7f5}{halo\_scheme\_pt}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00330}00330 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00331}00331       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a59c62401e999f683365a34151362e328}{Halo\_scheme\_pt}};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00332}00332     \}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00333}00333 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00334}00334 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00335}00335 \textcolor{comment}{    /// Construct the halo scheme and storage for the halo}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00336}00336 \textcolor{comment}{    /// data}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00337}00337 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a1aab1a84c6a82a755fdc3c6b27ce49d7}{build\_halo\_scheme}}(\mbox{\hyperlink{classoomph_1_1DoubleVectorHaloScheme}{DoubleVectorHaloScheme}}* \textcolor{keyword}{const}\& \mbox{\hyperlink{classoomph_1_1DoubleVectorWithHaloEntries_a7d753121acddfdc4b29d04812b91b5ec}{halo\_scheme\_pt}});}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00338}00338   \};}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00339}00339 }
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00340}00340 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{double__vector__with__halo_8h_source_l00341}00341 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

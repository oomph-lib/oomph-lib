\hypertarget{impose__parallel__outflow__element_8h_source}{}\doxysection{impose\+\_\+parallel\+\_\+outflow\+\_\+element.\+h}
\label{impose__parallel__outflow__element_8h_source}\index{impose\_parallel\_outflow\_element.h@{impose\_parallel\_outflow\_element.h}}
\mbox{\hyperlink{impose__parallel__outflow__element_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2022 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00026}00026 \textcolor{preprocessor}{\#ifndef OOMPH\_IMPOSE\_PARALL\_ELEMENTS\_HEADER}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00027}00027 \textcolor{preprocessor}{\#define OOMPH\_IMPOSE\_PARALL\_ELEMENTS\_HEADER}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00029}00029 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00030}00030 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00031}00031 \textcolor{preprocessor}{\#include <oomph-\/lib-\/config.h>}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00032}00032 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00034}00034 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00035}00035 \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00036}00036   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00037}00037 \textcolor{comment}{  ///  ImposeParallelOutflowElement}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00038}00038 \textcolor{comment}{  /// are elements that coincide with the faces of}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00039}00039 \textcolor{comment}{  /// higher-\/dimensional "{}bulk"{} elements. They are used on}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00040}00040 \textcolor{comment}{  /// boundaries where we would like to impose parallel outflow and}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00041}00041 \textcolor{comment}{  /// impose the pressure.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00042}00042 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00043}00043   \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00044}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement}{00044}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement}{ImposeParallelOutflowElement}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<ELEMENT>,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00045}00045                                        \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FaceElement}{FaceElement}}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00046}00046   \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00047}00047   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00048}00048 \textcolor{comment}{    /// pointer to imposed pressure -\/-\/ if null then no pressure imposed.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00049}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a94eb742690d8173e99d482a8f2426729}{00049}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a94eb742690d8173e99d482a8f2426729}{Pressure\_pt}};}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00050}00050 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00051}00051 \textcolor{comment}{    /// Lagrange Id}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00052}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a8eae8247a1a373ea998eda8b5d409c02}{00052}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a8eae8247a1a373ea998eda8b5d409c02}{Id}};}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00055}00055   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00056}00056 \textcolor{comment}{    /// Constructor takes a "{}bulk"{} element, the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00057}00057 \textcolor{comment}{    /// index that identifies which face the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00058}00058 \textcolor{comment}{    /// ImposeParallelOutflowElement is supposed}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00059}00059 \textcolor{comment}{    /// to be attached to, and the face element ID}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00060}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_ace1712cccb1e4b43ccf13d0dcfefee86}{00060}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_ace1712cccb1e4b43ccf13d0dcfefee86}{ImposeParallelOutflowElement}}(\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* \textcolor{keyword}{const}\& element\_pt,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00061}00061                                  \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& \mbox{\hyperlink{classoomph_1_1FaceElement_a14990bd081523c47cfe57e5ecf54dfe1}{face\_index}},}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00062}00062                                  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \textcolor{keywordtype}{id} = 0)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00063}00063       : \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<ELEMENT>(), \mbox{\hyperlink{classoomph_1_1FaceElement}{FaceElement}}()}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00064}00064     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00065}00065       \textcolor{comment}{//  set the Id}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00066}00066       \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a8eae8247a1a373ea998eda8b5d409c02}{Id}} = id;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00068}00068       \textcolor{comment}{// Build the face element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00069}00069       element\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_aaf7bead5b462cfd5401d97b3dbdc7af7}{build\_face\_element}}(\mbox{\hyperlink{classoomph_1_1FaceElement_a14990bd081523c47cfe57e5ecf54dfe1}{face\_index}}, \textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00071}00071       \textcolor{comment}{// dimension of the bulk element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00072}00072       \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}} = element\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00074}00074       \textcolor{comment}{// we need dim-\/1 additional values for each FaceElement node}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00075}00075       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} n\_additional\_values(\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}(), \mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}} -\/ 1);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00077}00077       \textcolor{comment}{// add storage for lagrange multipliers and set the map containing}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00078}00078       \textcolor{comment}{// the position of the first entry of this face element's}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00079}00079       \textcolor{comment}{// additional values.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00080}00080       \mbox{\hyperlink{classoomph_1_1FaceElement_a652aa3d84b6d91e0ce93bdb2e6718338}{add\_additional\_values}}(n\_additional\_values, \textcolor{keywordtype}{id});}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00082}00082       \textcolor{comment}{// set the pressure pointer to zero}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00083}00083       \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a94eb742690d8173e99d482a8f2426729}{Pressure\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00084}00084     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00085}00085 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00086}00086 \textcolor{comment}{    /// Fill in the residuals}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00087}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a843675c8f7cb2f457df56fe69dd84517}{00087}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a843675c8f7cb2f457df56fe69dd84517}{fill\_in\_contribution\_to\_residuals}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00088}00088     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00089}00089       \textcolor{comment}{// Call the generic routine with the flag set to 0}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00090}00090       \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a34414fec7ca51f720ac5a0a548cd9ef2}{fill\_in\_generic\_contribution\_to\_residuals\_parall\_lagr\_multiplier}}(}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00091}00091         residuals, \mbox{\hyperlink{classoomph_1_1GeneralisedElement_a4bff11b8ff97aefabb2df41e61e1779f}{GeneralisedElement::Dummy\_matrix}}, 0);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00092}00092     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00093}00093 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00094}00094 \textcolor{comment}{    /// Fill in contribution from Jacobian}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00095}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_aa299d5f5aa5184db817b4219665c77ed}{00095}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_aa299d5f5aa5184db817b4219665c77ed}{fill\_in\_contribution\_to\_jacobian}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00096}00096                                           \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00097}00097     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00098}00098       \textcolor{comment}{// Call the generic routine with the flag set to 1}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00099}00099       \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a34414fec7ca51f720ac5a0a548cd9ef2}{fill\_in\_generic\_contribution\_to\_residuals\_parall\_lagr\_multiplier}}(}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00100}00100         residuals, jacobian, 1);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00101}00101     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00102}00102 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00103}00103 \textcolor{comment}{    /// Overload the output function}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00104}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_ac423772737af10cd5efd0c49c3cdef80}{00104}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_ac423772737af10cd5efd0c49c3cdef80}{output}}(std::ostream\& outfile)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00105}00105     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00106}00106       \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{FiniteElement::output}}(outfile);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00107}00107     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00108}00108 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00109}00109 \textcolor{comment}{    /// Output function: x,y,[z],u,v,[w],p in tecplot format}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00110}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a94fce0938876acf656a7c43fc53aa8ca}{00110}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a94fce0938876acf656a7c43fc53aa8ca}{output}}(std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00111}00111     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00112}00112       \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{FiniteElement::output}}(outfile, nplot);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00113}00113     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00114}00114 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00115}00115 \textcolor{comment}{    /// The "{}global"{} intrinsic coordinate of the element when}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00116}00116 \textcolor{comment}{    /// viewed as part of a geometric object should be given by}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00117}00117 \textcolor{comment}{    /// the FaceElement representation, by default}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00118}00118 \textcolor{comment}{    /// This final over-\/ride is required because both SolidFiniteElements}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00119}00119 \textcolor{comment}{    /// and FaceElements overload zeta\_nodal}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00120}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_afa3691d3309b635967e81461b7db8173}{00120}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_afa3691d3309b635967e81461b7db8173}{zeta\_nodal}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00121}00121                       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& k,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00122}00122                       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00123}00123 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00124}00124       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1FaceElement_a58c9f93705c7741f76c8487d152e68a6}{FaceElement::zeta\_nodal}}(n, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00125}00125     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00127}00127 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00128}00128 \textcolor{comment}{    ///  Access function for the pressure}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00129}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a6a99ae539f03a4feedc32cb58c0a9cad}{00129}} \textcolor{comment}{}    \textcolor{keywordtype}{double}*\& \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a6a99ae539f03a4feedc32cb58c0a9cad}{pressure\_pt}}()}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00130}00130     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00131}00131       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a94eb742690d8173e99d482a8f2426729}{Pressure\_pt}};}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00132}00132     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00134}00134   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00135}00135 \textcolor{comment}{    /// Helper function to compute the residuals and, if flag==1, the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00136}00136 \textcolor{comment}{    /// Jacobian}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00137}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a34414fec7ca51f720ac5a0a548cd9ef2}{00137}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a34414fec7ca51f720ac5a0a548cd9ef2}{fill\_in\_generic\_contribution\_to\_residuals\_parall\_lagr\_multiplier}}(}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00138}00138       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00139}00139       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00140}00140       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& flag)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00141}00141     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00142}00142       \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00143}00143       \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00145}00145       \textcolor{comment}{// Dimension of element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00146}00146       \textcolor{keywordtype}{unsigned} dim\_el = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00148}00148       \textcolor{comment}{// Set up memory for the shape functions}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00149}00149       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00151}00151       \textcolor{comment}{// Set the value of n\_intpt}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00152}00152       \textcolor{keywordtype}{unsigned} n\_intpt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_a1a270de9d99a1fcf1d25a6c1017f65fa}{nweight}}();}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00153}00153 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00154}00154       \textcolor{comment}{// to store local equation number}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00155}00155       \textcolor{keywordtype}{int} local\_eqn = 0;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00156}00156       \textcolor{keywordtype}{int} local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00158}00158       \textcolor{comment}{// to store normal vector}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00159}00159       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} norm\_vec(dim\_el + 1);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00161}00161       \textcolor{comment}{// to store tangantial vectors}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00162}00162       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> tang\_vec(dim\_el, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}(dim\_el + 1));}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00163}00163 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00164}00164       \textcolor{comment}{// get the value at which the velocities are stored}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00165}00165       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} u\_index(dim\_el + 1);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00166}00166       ELEMENT* el\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1FaceElement_a89e9f7ebc8019c47d54dded72f05479e}{bulk\_element\_pt}}());}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00167}00167       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dim\_el + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00168}00168       \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00169}00169         u\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = el\_pt-\/>u\_index\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00170}00170       \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00172}00172       \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00173}00173       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00174}00174       \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00175}00175         \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00176}00176         \textcolor{keywordtype}{double} w = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Integral_ac65335e2aab120b285b3d6c294507b06}{weight}}(ipt);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00178}00178         \textcolor{comment}{// Jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00179}00179         \textcolor{keywordtype}{double} J = \mbox{\hyperlink{classoomph_1_1FaceElement_aa6380a08afc18bd4f35e337a1131a9d8}{J\_eulerian\_at\_knot}}(ipt);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00180}00180 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00181}00181         \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00182}00182         \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00183}00183 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00184}00184         \textcolor{comment}{// Calculate the shape functions}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00185}00185         \mbox{\hyperlink{classoomph_1_1FiniteElement_aeccc0f774e3fab8c536e2d41004a1665}{shape\_at\_knot}}(ipt, psi);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00187}00187         \textcolor{comment}{// compute  the velocity and the Lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00188}00188         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} interpolated\_u(dim\_el + 1, 0.0);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00189}00189         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} lambda(dim\_el, 0.0);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00190}00190         \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00191}00191         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00192}00192         \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00193}00193           \textcolor{comment}{// Assemble the velocity component}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00194}00194           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dim\_el + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00195}00195           \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00196}00196             interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += \mbox{\hyperlink{classoomph_1_1FiniteElement_a28fd5c2d4aeba5ef65bee0e0d72569f5}{nodal\_value}}(j, u\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) * psi(j);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00197}00197           \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00198}00198 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00199}00199           \textcolor{comment}{// Cast to a boundary node}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00200}00200           \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00201}00201             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00203}00203           \textcolor{comment}{// get the node}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00204}00204           \mbox{\hyperlink{classoomph_1_1Node}{Node}}* nod\_pt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00205}00205 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00206}00206           \textcolor{comment}{// Get the index of the first nodal value associated with}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00207}00207           \textcolor{comment}{// this FaceElement}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00208}00208           \textcolor{keywordtype}{unsigned} first\_index =}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00209}00209             bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a67c470bd15750e91775101b5bce65a58}{index\_of\_first\_value\_assigned\_by\_face\_element}}(\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a8eae8247a1a373ea998eda8b5d409c02}{Id}});}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00210}00210 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00211}00211           \textcolor{comment}{// Assemble the Lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00212}00212           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < dim\_el; l++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00213}00213           \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00214}00214             lambda[l] += nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afcc5cdba40bca251826ae5bee5ca15b4}{value}}(first\_index + l) * psi(j);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00215}00215           \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00216}00216         \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00217}00217 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00218}00218         this-\/>\mbox{\hyperlink{classoomph_1_1FaceElement_a182997beb4a64fde40a47007344913f1}{continuous\_tangent\_and\_outer\_unit\_normal}}(ipt, tang\_vec, norm\_vec);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00219}00219 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00220}00220         \textcolor{comment}{// Assemble residuals and jacobian}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00221}00221 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00222}00222         \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00223}00223         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00224}00224         \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00225}00225           \textcolor{comment}{// Cast to a boundary node}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00226}00226           \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00227}00227             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00229}00229           \textcolor{comment}{// Get the index of the first nodal value associated with}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00230}00230           \textcolor{comment}{// this FaceElement}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00231}00231           \textcolor{keywordtype}{unsigned} first\_index =}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00232}00232             bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a67c470bd15750e91775101b5bce65a58}{index\_of\_first\_value\_assigned\_by\_face\_element}}(\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a8eae8247a1a373ea998eda8b5d409c02}{Id}});}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00233}00233 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00234}00234           \textcolor{comment}{// loop over the lagrange multiplier components}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00235}00235           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < dim\_el; l++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00236}00236           \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00237}00237             \textcolor{comment}{// Local eqn number for the l-\/th component of lamdba}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00238}00238             \textcolor{comment}{// in the j-\/th element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00239}00239             local\_eqn = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(j, first\_index + l);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00240}00240 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00241}00241             \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00242}00242             \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00243}00243               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dim\_el + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00244}00244               \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00245}00245                 \textcolor{comment}{// Assemble residual for lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00246}00246                 residuals[local\_eqn] +=}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00247}00247                   interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * tang\_vec[l][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(j) * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00248}00248 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00249}00249                 \textcolor{comment}{// Assemble Jacobian for Lagrange multiplier:}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00250}00250                 \textcolor{keywordflow}{if} (flag == 1)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00251}00251                 \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00252}00252                   \textcolor{comment}{// Loop over the nodes again for unknowns}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00253}00253                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} jj = 0; jj < n\_node; jj++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00254}00254                   \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00255}00255                     \textcolor{comment}{// Local eqn number for the i-\/th component}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00256}00256                     \textcolor{comment}{// of the velocity in the jj-\/th element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00257}00257                     local\_unknown = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(jj, u\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00258}00258                     \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00259}00259                     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00260}00260                       jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00261}00261                         tang\_vec[l][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(jj) * psi(j) * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00262}00262                     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00263}00263                   \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00264}00264                 \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00265}00265               \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00266}00266             \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00267}00267           \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00269}00269           \textcolor{comment}{// Loop over the directions}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00270}00270           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dim\_el + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00271}00271           \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00272}00272             \textcolor{comment}{// Local eqn number for the i-\/th component of the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00273}00273             \textcolor{comment}{// velocity in the j-\/th element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00274}00274             local\_eqn = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(j, u\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00276}00276             \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00277}00277             \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00278}00278               \textcolor{comment}{// Add the contribution of the imposed pressure}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00279}00279               \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a94eb742690d8173e99d482a8f2426729}{Pressure\_pt}} != 0)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00280}00280               \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00281}00281                 residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00282}00282                   (*Pressure\_pt) * norm\_vec[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(j) * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00283}00283               \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00284}00284 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00285}00285               \textcolor{comment}{// Add lagrange multiplier contribution to the bulk equation}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00286}00286               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < dim\_el; l++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00287}00287               \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00288}00288                 \textcolor{comment}{// Add to residual}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00289}00289                 residuals[local\_eqn] += tang\_vec[l][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(j) * lambda[l] * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00291}00291                 \textcolor{comment}{// Do Jacobian too?}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00292}00292                 \textcolor{keywordflow}{if} (flag == 1)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00293}00293                 \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00294}00294                   \textcolor{comment}{// Loop over the nodes again for unknowns}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00295}00295                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} jj = 0; jj < n\_node; jj++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00296}00296                   \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00297}00297                     \textcolor{comment}{// Cast to a boundary node}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00298}00298                     \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnode\_pt =}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00299}00299                       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(jj));}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00300}00300 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00301}00301                     \textcolor{comment}{// Local eqn number for the l-\/th component of lamdba}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00302}00302                     \textcolor{comment}{// in the jj-\/th element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00303}00303                     local\_unknown = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00304}00304                       jj,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00305}00305                       bnode\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a67c470bd15750e91775101b5bce65a58}{index\_of\_first\_value\_assigned\_by\_face\_element}}(}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00306}00306                         \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a8eae8247a1a373ea998eda8b5d409c02}{Id}}) +}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00307}00307                         l);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00308}00308                     \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00309}00309                     \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00310}00310                       jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00311}00311                         tang\_vec[l][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(jj) * psi(j) * \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00312}00312                     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00313}00313                   \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00314}00314                 \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00315}00315               \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00316}00316             \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00317}00317           \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00318}00318         \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00319}00319       \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00320}00320     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00321}00321 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00322}00322 \textcolor{comment}{    /// The number of degrees of freedom types that this element is}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00323}00323 \textcolor{comment}{    /// divided into: The ImposeParallelOutflowElement is responsible for 1(2)}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00324}00324 \textcolor{comment}{    /// of it's own degrees of freedom. In addition to this, it also classifies}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00325}00325 \textcolor{comment}{    /// the 2(3) constrained velocity bulk degrees of freedom which this face}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00326}00326 \textcolor{comment}{    /// element is attached to.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00327}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a3d403d29fdcbbc8954ae360331d03be4}{00327}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a3d403d29fdcbbc8954ae360331d03be4}{ndof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00328}00328 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00329}00329       \textcolor{comment}{// The the dof types in this element is 1 in 2D, 2 in 3D, so we use the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00330}00330       \textcolor{comment}{// elemental dimension function this-\/>dim().}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00331}00331       \textcolor{comment}{// In addition, we have the number of constrained velocity dof types, this}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00332}00332       \textcolor{comment}{// is this-\/>dim()+1 dof types.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00333}00333       \textcolor{comment}{// In total we have 2*(this-\/>dim()) + 1 dof types.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00334}00334       \textcolor{keywordflow}{return} 2 * (this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}()) + 1;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00335}00335     \}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00336}00336 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00337}00337 \textcolor{comment}{    /// Create a list of pairs for all unknowns in this element,}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00338}00338 \textcolor{comment}{    /// so that the first entry in each pair contains the global equation}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00339}00339 \textcolor{comment}{    /// number of the unknown, while the second one contains the LOCAL number}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00340}00340 \textcolor{comment}{    /// of the "{}DOF types"{} that this unknown is associated with.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00341}00341 \textcolor{comment}{    /// (Function can obviously only be called if the equation numbering}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00342}00342 \textcolor{comment}{    /// scheme has been set up.)}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00343}00343 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00344}00344 \textcolor{comment}{    /// For the ImposeParallelOutflowElement, we need to classify both the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00345}00345 \textcolor{comment}{    /// constrained velocity from the bulk element and the dof types from this}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00346}00346 \textcolor{comment}{    /// element. In 3D, let up, vp, wp be the constrained velocity dof types}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00347}00347 \textcolor{comment}{    /// associated with the ImposeParallelOutflowElement. Let Lp1 and Lp2 be the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00348}00348 \textcolor{comment}{    /// two Lagrange multiplier dof types associated with the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00349}00349 \textcolor{comment}{    /// ImposeParallelOutflowElement. Then we have:}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00350}00350 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00351}00351 \textcolor{comment}{    /// 0  1  2  3  4}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00352}00352 \textcolor{comment}{    /// up vp wp L1 L2}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00353}\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a326aec64731513faa189b7a42856b0fe}{00353}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a326aec64731513faa189b7a42856b0fe}{get\_dof\_numbers\_for\_unknowns}}(}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00354}00354       std::list<std::pair<unsigned long, unsigned>>\& dof\_lookup\_list)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00355}00355 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00356}00356       \textcolor{comment}{// Temporary pair (used to store dof lookup prior to being added to list)}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00357}00357       std::pair<unsigned, unsigned> dof\_lookup;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00358}00358 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00359}00359       \textcolor{comment}{// Number of nodes in this element.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00360}00360       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00362}00362       \textcolor{comment}{// The elemental dimension.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00363}00363       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} dim\_el = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00364}00364 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00365}00365       \textcolor{comment}{// The spatial dimension, since this is a face element, as assume that the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00366}00366       \textcolor{comment}{// spatial dimension is one higher than the elemental dimension.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00367}00367       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} dim\_bulk = dim\_el + 1;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00368}00368 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00369}00369       \textcolor{comment}{// The classification of the constrained bulk velocity dof types is}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00370}00370       \textcolor{comment}{// i, i = 0, ..., dim\_bulk.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00371}00371       \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00372}00372       \textcolor{comment}{// The classification of the lagrange multiplier dof types is}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00373}00373       \textcolor{comment}{// i + dim\_bulk, i = 0, ..., dim\_el}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00374}00374       \textcolor{comment}{// as it is offset by the spatial dimension.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00375}00375 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00376}00376       \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00377}00377       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} node\_i = 0; node\_i < n\_node; node\_i++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00378}00378       \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00379}00379         \textcolor{comment}{// First we classify the constrained velocity dof types from the bulk}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00380}00380         \textcolor{comment}{// element. NOTE: This is a RE-\/CLASSIFICATION, since the dof types we}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00381}00381         \textcolor{comment}{// are classifying should already be classified at least once by the}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00382}00382         \textcolor{comment}{// bulk element. Furthermore, we assume that the velocity dof types}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00383}00383         \textcolor{comment}{// comes first, then the pressure dof types. This is indeed true with}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00384}00384         \textcolor{comment}{// OOMPH-\/LIB's implementation of Navier-\/Stokes elements.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00385}00385         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} velocity\_i = 0; velocity\_i < dim\_bulk; velocity\_i++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00386}00386         \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00387}00387           \textcolor{comment}{// We only concern ourselves with the nodes of the "{}bulk"{} element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00388}00388           \textcolor{comment}{// that are associated with this "{}face"{} element. Bulk\_node\_number}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00389}00389           \textcolor{comment}{// gives us the mapping from the face element's node to the bulk}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00390}00390           \textcolor{comment}{// element's node. The local equation number is required to check if}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00391}00391           \textcolor{comment}{// the value is pinned, if it is not pinned, the local equation number}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00392}00392           \textcolor{comment}{// is required to get the global equation number.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00393}00393           \textcolor{keywordtype}{int} local\_eqn = \mbox{\hyperlink{classoomph_1_1FaceElement_a2d616b77ff557bbc70ece741fa2c6d96}{Bulk\_element\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00394}00394             \mbox{\hyperlink{classoomph_1_1FaceElement_a27a8a3240049a53c7fac20ebde716846}{Bulk\_node\_number}}[node\_i], velocity\_i);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00395}00395 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00396}00396           \textcolor{comment}{// Ignore pinned values.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00397}00397           \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00398}00398           \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00399}00399             \textcolor{comment}{// Store the dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00400}00400             \textcolor{comment}{// is the global equation number; second entry is the LOCAL dof}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00401}00401             \textcolor{comment}{// type. It is assumed that the velocity dof types comes first. We}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00402}00402             \textcolor{comment}{// do not re-\/classify the pressure dof types as they are not}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00403}00403             \textcolor{comment}{// constrained.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00404}00404             dof\_lookup.first = \mbox{\hyperlink{classoomph_1_1FaceElement_a2d616b77ff557bbc70ece741fa2c6d96}{Bulk\_element\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(local\_eqn);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00405}00405             dof\_lookup.second = velocity\_i;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00406}00406             dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00407}00407           \} \textcolor{comment}{// ignore pinned nodes "{}if(local-\/eqn>=0)"{}}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00408}00408         \} \textcolor{comment}{// for loop over the velocity components}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00410}00410         \textcolor{comment}{// Now we classify the dof types of this face element.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00411}00411         \textcolor{comment}{// Cast to a boundary node}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00412}00412         \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00413}00413           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(node\_i));}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00414}00414 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00415}00415         \textcolor{comment}{// Loop over directions in this Face(!)Element}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00416}00416         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} dim\_i = 0; dim\_i < dim\_el; dim\_i++)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00417}00417         \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00418}00418           \textcolor{comment}{// Local eqn number:}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00419}00419           \textcolor{keywordtype}{int} local\_eqn = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00420}00420             node\_i,}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00421}00421             bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a67c470bd15750e91775101b5bce65a58}{index\_of\_first\_value\_assigned\_by\_face\_element}}(\mbox{\hyperlink{classoomph_1_1ImposeParallelOutflowElement_a8eae8247a1a373ea998eda8b5d409c02}{Id}}) + dim\_i);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00422}00422 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00423}00423           \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00424}00424           \{}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00425}00425             \textcolor{comment}{// Store dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00426}00426             \textcolor{comment}{// is global equation number; second entry is dof type.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00427}00427             \textcolor{comment}{// We assume that the first 2(3) types are fluid dof types in}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00428}00428             \textcolor{comment}{// 2(3) spatial dimensions (classified above):}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00429}00429             \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00430}00430             \textcolor{comment}{// 0  1  2  3  4}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00431}00431             \textcolor{comment}{// up vp wp L1 L2}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00432}00432             \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00433}00433             \textcolor{comment}{// Thus the offset is the dim\_bulk.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00434}00434             dof\_lookup.first = this-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(local\_eqn);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00435}00435             dof\_lookup.second = dim\_i + dim\_bulk;}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00436}00436 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00437}00437             \textcolor{comment}{// Add to list}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00438}00438             dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00439}00439           \} \textcolor{comment}{// if local\_eqn > 0}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00440}00440         \} \textcolor{comment}{// for: loop over the directions in the face element.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00441}00441       \} \textcolor{comment}{// for: loop over the nodes in the face element.}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00442}00442 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00443}00443     \} \textcolor{comment}{// get\_dof\_numbers\_for\_unknowns}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00444}00444 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00445}00445   \}; \textcolor{comment}{// End of ImposeParallelOutflowElement class}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00446}00446 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00447}00447 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00448}00448 }
\DoxyCodeLine{\Hypertarget{impose__parallel__outflow__element_8h_source_l00449}00449 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

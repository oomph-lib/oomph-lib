\hypertarget{pseudosolid__node__update__elements_8h_source}{}\doxysection{pseudosolid\+\_\+node\+\_\+update\+\_\+elements.\+h}
\label{pseudosolid__node__update__elements_8h_source}\index{pseudosolid\_node\_update\_elements.h@{pseudosolid\_node\_update\_elements.h}}
\mbox{\hyperlink{pseudosolid__node__update__elements_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00026}00026 \textcolor{comment}{// This header file contains elements that combine two element types in}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00027}00027 \textcolor{comment}{// a generic way.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00029}00029 \textcolor{preprocessor}{\#ifndef OOMPH\_PSEUDO\_SOLID\_REMESH\_ELEMENTS\_HEADER}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00030}00030 \textcolor{preprocessor}{\#define OOMPH\_PSEUDO\_SOLID\_REMESH\_ELEMENTS\_HEADER}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00032}00032 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{elements_8h}{elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00034}00034 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00035}00035 \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00036}00036   \textcolor{comment}{//===========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00037}00037 \textcolor{comment}{  /// Helper namespace for pseudo-\/elastic elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00038}00038 \textcolor{comment}{}  \textcolor{comment}{//===========================================================================}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00039}00039   \textcolor{keyword}{namespace }PseudoSolidHelper}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00040}00040   \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00041}00041 \textcolor{comment}{    /// Static variable to hold the default value for the pseudo-\/solid's}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00042}00042 \textcolor{comment}{    /// inertia parameter Lambda\string^2.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00043}00043 \textcolor{comment}{}    \textcolor{keyword}{extern} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_1_1PseudoSolidHelper_a4d6244e865fddd406dc8589beb58a654}{Zero}};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00045}00045   \} \textcolor{comment}{// namespace PseudoSolidHelper}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00048}00048   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00049}00049 \textcolor{comment}{  /// A templated class that permits combination two different element types,}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00050}00050 \textcolor{comment}{  /// for the solution of problems in deforming domains. The first template}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00051}00051 \textcolor{comment}{  /// paremter BASIC is the standard element and the second SOLID solves}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00052}00052 \textcolor{comment}{  /// the equations that are used to control the mesh deformation.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00053}00053 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00054}00054   \textcolor{keyword}{template}<\textcolor{keyword}{class} BASIC, \textcolor{keyword}{class} SOLID>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00055}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement}{00055}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement}{PseudoSolidNodeUpdateElement}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} BASIC,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00056}00056                                        \textcolor{keyword}{public} \textcolor{keyword}{virtual} SOLID}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00058}00058   \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00059}00059 \textcolor{comment}{    /// Boolean flag to indicate shape derivative method}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00060}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a09f75eb760cb430ff6a54a8e88a7bc16}{00060}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a09f75eb760cb430ff6a54a8e88a7bc16}{Shape\_derivs\_by\_direct\_fd}};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00062}00062   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00063}00063 \textcolor{comment}{    /// Constructor, call the BASIC and SOLID elements' constructors and}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00064}00064 \textcolor{comment}{    /// set the "{}density"{} parameter for solid element to zero}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00065}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_afd44332410c5956938614b5899f85cb8}{00065}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_afd44332410c5956938614b5899f85cb8}{PseudoSolidNodeUpdateElement}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00066}00066       : BASIC(), SOLID(), \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a09f75eb760cb430ff6a54a8e88a7bc16}{Shape\_derivs\_by\_direct\_fd}}(true)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00067}00067     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00068}00068       SOLID::lambda\_sq\_pt() = \&\mbox{\hyperlink{namespaceoomph_1_1PseudoSolidHelper_a4d6244e865fddd406dc8589beb58a654}{PseudoSolidHelper::Zero}};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00069}00069     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00070}00070 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00071}00071 \textcolor{comment}{    /// Function to describe the local dofs of the element. The ostream}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00072}00072 \textcolor{comment}{    /// specifies the output stream to which the description}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00073}00073 \textcolor{comment}{    /// is written; the string stores the currently}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00074}00074 \textcolor{comment}{    /// assembled output that is ultimately written to the}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00075}00075 \textcolor{comment}{    /// output stream by Data::describe\_dofs(...); it is typically}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00076}00076 \textcolor{comment}{    /// built up incrementally as we descend through the}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00077}00077 \textcolor{comment}{    /// call hierarchy of this function when called from}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00078}00078 \textcolor{comment}{    /// Problem::describe\_dofs(...)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00079}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a1736af22476b283ee75d4626ec1b0c7e}{00079}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a1736af22476b283ee75d4626ec1b0c7e}{describe\_local\_dofs}}(std::ostream\& out,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00080}00080                              \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}}\& current\_string)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00081}00081 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00082}00082       BASIC::describe\_local\_dofs(out, current\_string);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00083}00083       SOLID::describe\_local\_dofs(out, current\_string);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00084}00084     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00085}00085 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00086}00086 \textcolor{comment}{    /// Compute norm of solution: use the version in the BASIC}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00087}00087 \textcolor{comment}{    /// class if there's any ambiguity}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00088}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a4db0954b3a48a6b1bb6df7a34d86b0e8}{00088}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a4db0954b3a48a6b1bb6df7a34d86b0e8}{compute\_norm}}(\textcolor{keywordtype}{double}\& el\_norm)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00089}00089     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00090}00090       BASIC::compute\_norm(el\_norm);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00091}00091     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00092}00092 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00093}00093 \textcolor{comment}{    /// The required number of values is the sum of the two}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00094}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a1d3ae58be7e3d2d9aa95086e631ce730}{00094}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a1d3ae58be7e3d2d9aa95086e631ce730}{required\_nvalue}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00095}00095 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00096}00096       \textcolor{keywordflow}{return} BASIC::required\_nvalue(n) + SOLID::required\_nvalue(n);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00097}00097     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00098}00098 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00099}00099 \textcolor{comment}{    /// We assume that the solid stuff is stored at the end of}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00100}00100 \textcolor{comment}{    /// the nodes, i.e. its index is the number of continuously interplated}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00101}00101 \textcolor{comment}{    /// values in the BASIC equations.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00102}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_ad78c40ba5be3d9b922dfd92f2e683ba8}{00102}} \textcolor{comment}{}    \textcolor{keywordtype}{int} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_ad78c40ba5be3d9b922dfd92f2e683ba8}{solid\_p\_nodal\_index}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00103}00103 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00104}00104       \textcolor{comment}{// At the moment, we can't handle this case in generality so throw an}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00105}00105       \textcolor{comment}{// error if the solid pressure is stored at the nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00106}00106       \textcolor{keywordflow}{if} (SOLID::solid\_p\_nodal\_index() >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00107}00107       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00108}00108         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Cannot handle (non-\/refineable) continuous solid "{}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00109}00109                             \textcolor{stringliteral}{"{}pressure interpolation"{}},}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00110}00110                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00111}00111                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00112}00112       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00113}00113 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00114}00114       \textcolor{keywordflow}{return} SOLID::solid\_p\_nodal\_index();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00115}00115     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00116}00116 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00117}00117 \textcolor{comment}{    /// Final override for the residuals function. Contributions are}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00118}00118 \textcolor{comment}{    /// added from both underlying element types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00119}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a12009b16c000c65ad384c74246074384}{00119}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a12009b16c000c65ad384c74246074384}{fill\_in\_contribution\_to\_residuals}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00120}00120     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00121}00121       \textcolor{comment}{// Call the basic equations first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00122}00122       BASIC::fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00123}00123       \textcolor{comment}{// Add the solid equations contribution}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00124}00124       SOLID::fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00125}00125     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00126}00126 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00127}00127 \textcolor{comment}{    /// Final override for jacobian function: Contributions are}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00128}00128 \textcolor{comment}{    /// included from both the underlying element types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00129}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6e3b3193e2d66317dc45f17217ddb5c3}{00129}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6e3b3193e2d66317dc45f17217ddb5c3}{fill\_in\_contribution\_to\_jacobian}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00130}00130                                           \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00131}00131     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00132}00132       \textcolor{comment}{// Call the basic equations first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00133}00133       BASIC::fill\_in\_contribution\_to\_jacobian(residuals, jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00134}00134       \textcolor{comment}{// Call the solid equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00135}00135       SOLID::fill\_in\_contribution\_to\_jacobian(residuals, jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00137}00137       \textcolor{comment}{// Now fill in the off-\/diagonal entries (the shape derivatives),}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00138}00138       \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a254e54579d692d4480e30dee7c6b71cc}{fill\_in\_shape\_derivatives}}(jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00139}00139     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00140}00140 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00141}00141 \textcolor{comment}{    /// Final override for mass matrix function: contributions}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00142}00142 \textcolor{comment}{    /// are included from both the underlying element types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00143}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_aba0869b0de889df9be90647c28632f8b}{00143}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_aba0869b0de889df9be90647c28632f8b}{fill\_in\_contribution\_to\_jacobian\_and\_mass\_matrix}}(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00144}00144       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00145}00145       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00146}00146       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& mass\_matrix)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00147}00147     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00148}00148       \textcolor{comment}{// Call the basic equations first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00149}00149       BASIC::fill\_in\_contribution\_to\_jacobian\_and\_mass\_matrix(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00150}00150         residuals, jacobian, mass\_matrix);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00151}00151       \textcolor{comment}{// Call the solid equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00152}00152       SOLID::fill\_in\_contribution\_to\_jacobian\_and\_mass\_matrix(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00153}00153         residuals, jacobian, mass\_matrix);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00154}00154 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00155}00155       \textcolor{comment}{// Now fill in the off-\/diagonal entries (the shape derivatives),}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00156}00156       \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a254e54579d692d4480e30dee7c6b71cc}{fill\_in\_shape\_derivatives}}(jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00157}00157     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00158}00158 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00159}00159 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00160}00160 \textcolor{comment}{    /// Evaluate shape derivatives by direct finite differencing}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00161}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_ad35128b838a51f8db6c3d51964b9b00a}{00161}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_ad35128b838a51f8db6c3d51964b9b00a}{evaluate\_shape\_derivs\_by\_direct\_fd}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00162}00162     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00163}00163       \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a09f75eb760cb430ff6a54a8e88a7bc16}{Shape\_derivs\_by\_direct\_fd}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00164}00164     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00165}00165 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00166}00166 \textcolor{comment}{    /// Evaluate shape derivatives by chain rule}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00167}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a9f60c036205aacef2a97aafffb616d85}{00167}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a9f60c036205aacef2a97aafffb616d85}{evaluate\_shape\_derivs\_by\_chain\_rule}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00168}00168     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00169}00169       \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a09f75eb760cb430ff6a54a8e88a7bc16}{Shape\_derivs\_by\_direct\_fd}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00170}00170     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00171}00171 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00172}00172 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00173}00173 \textcolor{comment}{    /// Fill in the shape derivatives of the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00174}00174 \textcolor{comment}{    /// w.r.t. the solid position dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00175}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a254e54579d692d4480e30dee7c6b71cc}{00175}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a254e54579d692d4480e30dee7c6b71cc}{fill\_in\_shape\_derivatives}}(\mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00176}00176     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00177}00177       \textcolor{comment}{// Default is to use finite differences}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00178}00178       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a09f75eb760cb430ff6a54a8e88a7bc16}{Shape\_derivs\_by\_direct\_fd}})}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00179}00179       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00180}00180         this-\/>\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6f5600cb23d1e26816ae36ae8195c01e}{fill\_in\_shape\_derivatives\_by\_fd}}(jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00181}00181       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00182}00182       \textcolor{comment}{// Otherwise need to do a bit more work}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00183}00183       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00184}00184       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00185}00185         \textcolor{comment}{// Calculate storage requirements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00186}00186         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dof = this-\/>ndof();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00187}00187         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00188}00188         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} nodal\_dim = this-\/>nodal\_dimension();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00190}00190         \textcolor{comment}{// If there are no nodes or dofs return}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00191}00191         \textcolor{keywordflow}{if} ((n\_dof == 0) || (n\_node == 0))}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00192}00192         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00193}00193           \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00194}00194         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00196}00196         \textcolor{comment}{// Generalised dofs have NOT been considered, shout}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00197}00197         \textcolor{keywordflow}{if} (this-\/>nnodal\_position\_type() != 1)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00198}00198         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00199}00199           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Shape derivatives do not (yet) allow for "{}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00200}00200                               \textcolor{stringliteral}{"{}generalised position dofs\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00201}00201                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00202}00202                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00203}00203         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00204}00204 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00205}00205         \textcolor{comment}{// Storage for derivatives of residuals w.r.t. nodal coordinates}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00206}00206         \mbox{\hyperlink{classoomph_1_1RankThreeTensor}{RankThreeTensor<double>}} dresidual\_dnodal\_coordinates(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00207}00207           n\_dof, nodal\_dim, n\_node, 0.0);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00208}00208 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00209}00209         \textcolor{comment}{// Get the analytic derivatives for the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00210}00210         BASIC::get\_dresidual\_dnodal\_coordinates(dresidual\_dnodal\_coordinates);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00211}00211 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00212}00212         \textcolor{comment}{// Now add the appropriate contributions to the Jacobian}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00213}00213         \textcolor{keywordtype}{int} local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00214}00214 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00215}00215         \textcolor{comment}{// Loop over dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00216}00216         \textcolor{comment}{//(this will include the solid dofs,}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00217}00217         \textcolor{comment}{// but all those contributions should be zero)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00218}00218         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_dof; l++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00219}00219         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00220}00220           \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00221}00221           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00222}00222           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00223}00223             \textcolor{comment}{// Loop over the position\_types (only one)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00224}00224             \textcolor{keywordtype}{unsigned} k = 0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00225}00225             \textcolor{comment}{// Loop over the coordinates}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00226}00226             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00227}00227             \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00228}00228               \textcolor{comment}{// Get the equation of the local unknown}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00229}00229               local\_unknown = this-\/>position\_local\_eqn(n, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00230}00230 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00231}00231               \textcolor{comment}{// If not pinned, add the contribution to the Jacobian}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00232}00232               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00233}00233               \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00234}00234                 jacobian(l, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00235}00235                   dresidual\_dnodal\_coordinates(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, n);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00236}00236               \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00237}00237             \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00238}00238           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00239}00239         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00240}00240       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00241}00241     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00242}00242 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00243}00243 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00244}00244 \textcolor{comment}{    /// Fill in the derivatives of the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00245}00245 \textcolor{comment}{    /// w.r.t. the solid position dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00246}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6f5600cb23d1e26816ae36ae8195c01e}{00246}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6f5600cb23d1e26816ae36ae8195c01e}{fill\_in\_shape\_derivatives\_by\_fd}}(\mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00247}00247     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00248}00248       \textcolor{comment}{// Flag to indicate if we use first or second order FD}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00249}00249       \textcolor{comment}{// bool use\_first\_order\_fd=false;}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00251}00251       \textcolor{comment}{// Find the number of nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00252}00252       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00253}00253 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00254}00254       \textcolor{comment}{// If there aren't any nodes, then return straight away}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00255}00255       \textcolor{keywordflow}{if} (n\_node == 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00256}00256       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00257}00257         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00258}00258       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00259}00259 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00260}00260       \textcolor{comment}{// Call the update function to ensure that the element is in}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00261}00261       \textcolor{comment}{// a consistent state before finite differencing starts}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00262}00262       this-\/>update\_before\_solid\_position\_fd();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00264}00264       \textcolor{comment}{// Get the number of position dofs and dimensions at the node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00265}00265       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_position\_type = this-\/>nnodal\_position\_type();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00266}00266       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} nodal\_dim = this-\/>nodal\_dimension();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00267}00267 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00268}00268       \textcolor{comment}{// Find the number of dofs in the element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00269}00269       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dof = this-\/>ndof();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00271}00271       \textcolor{comment}{// Create residual newres vectors}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00272}00272       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} residuals(n\_dof);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00273}00273       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} newres(n\_dof);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00274}00274       \textcolor{comment}{// Vector<double> newres\_minus(n\_dof);}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00276}00276       \textcolor{comment}{// Calculate the residuals (for the BASIC) equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00277}00277       \textcolor{comment}{// Need to do this using fill\_in because get\_residuals will}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00278}00278       \textcolor{comment}{// compute all residuals for the problem, which is}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00279}00279       \textcolor{comment}{// a little ineffecient}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00280}00280       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_dof; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00281}00281       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00282}00282         residuals[m] = 0.0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00283}00283       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00284}00284       BASIC::fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00286}00286       \textcolor{comment}{// Need to determine which degrees of freedom are solid degrees of}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00287}00287       \textcolor{comment}{// freedom}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00288}00288       \textcolor{comment}{// A vector of booleans that will be true if the dof is associated}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00289}00289       \textcolor{comment}{// with the solid equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00290}00290       std::vector<bool> dof\_is\_solid(n\_dof, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00292}00292       \textcolor{comment}{// Now set all solid positional dofs in the vector}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00293}00293       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00294}00294       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00295}00295         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00296}00296         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00297}00297           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00298}00298           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00299}00299             \textcolor{keywordtype}{int} local\_dof = this-\/>position\_local\_eqn(n, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00300}00300             \textcolor{keywordflow}{if} (local\_dof >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00301}00301             \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00302}00302               dof\_is\_solid[local\_dof] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00303}00303             \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00304}00304           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00305}00305         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00306}00306       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00307}00307 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00308}00308       \textcolor{comment}{// Add the solid pressures (in solid elements without}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00309}00309       \textcolor{comment}{// solid pressure the number will be zero).}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00310}00310       \textcolor{keywordtype}{unsigned} n\_solid\_pres = this-\/>npres\_solid();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00311}00311       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_solid\_pres; l++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00312}00312       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00313}00313         \textcolor{keywordtype}{int} local\_dof = this-\/>solid\_p\_local\_eqn(l);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00314}00314         \textcolor{keywordflow}{if} (local\_dof >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00315}00315         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00316}00316           dof\_is\_solid[local\_dof] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00317}00317         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00318}00318       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00320}00320 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00321}00321       \textcolor{comment}{// Integer storage for local unknown}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00322}00322       \textcolor{keywordtype}{int} local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00324}00324       \textcolor{comment}{// Use default value defined in GeneralisedElement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00325}00325       \textcolor{keyword}{const} \textcolor{keywordtype}{double} fd\_step = this-\/>Default\_fd\_jacobian\_step;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00327}00327       \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00328}00328       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00329}00329       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00330}00330         \textcolor{comment}{// Loop over position dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00331}00331         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00332}00332         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00333}00333           \textcolor{comment}{// Loop over dimension}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00334}00334           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00335}00335           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00336}00336             \textcolor{comment}{// If the variable is free}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00337}00337             local\_unknown = this-\/>position\_local\_eqn(n, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00338}00338             \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00339}00339             \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00340}00340               \textcolor{comment}{// Store a pointer to the (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00341}00341               \textcolor{keywordtype}{double}* \textcolor{keyword}{const} value\_pt = \&(this-\/>node\_pt(n)-\/>x\_gen(k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00342}00342 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00343}00343               \textcolor{comment}{// Save the old value of the (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00344}00344               \textcolor{keyword}{const} \textcolor{keywordtype}{double} old\_var = *value\_pt;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00346}00346               \textcolor{comment}{// Increment the (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00347}00347               *value\_pt += fd\_step;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00349}00349               \textcolor{comment}{// Perform any auxialiary node updates}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00350}00350               this-\/>node\_pt(n)-\/>perform\_auxiliary\_node\_update\_fct();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00352}00352               \textcolor{comment}{// Calculate the new residuals}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00353}00353               \textcolor{comment}{// Need to do this using fill\_in because get\_residuals will}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00354}00354               \textcolor{comment}{// compute all residuals for the problem, which is}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00355}00355               \textcolor{comment}{// a little ineffecient}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00356}00356               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_dof; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00357}00357               \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00358}00358                 newres[m] = 0.0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00359}00359               \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00360}00360               BASIC::fill\_in\_contribution\_to\_residuals(newres);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00362}00362               \textcolor{comment}{//          if (use\_first\_order\_fd)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00363}00363               \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00364}00364                 \textcolor{comment}{// Do forward finite differences}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00365}00365                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_dof; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00366}00366                 \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00367}00367                   \textcolor{comment}{// Stick the entry into the Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00368}00368                   \textcolor{comment}{// but only if it's not a solid dof}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00369}00369                   \textcolor{keywordflow}{if} (dof\_is\_solid[m] == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00370}00370                   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00371}00371                     jacobian(m, local\_unknown) =}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00372}00372                       (newres[m] -\/ residuals[m]) / fd\_step;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00373}00373                   \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00374}00374                 \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00375}00375               \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00376}00376               \textcolor{comment}{//           else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00377}00377               \textcolor{comment}{//            \{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00378}00378               \textcolor{comment}{//             //Take backwards step for the  (generalised)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00379}00379               \textcolor{comment}{//             Eulerian nodal}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00380}00380               \textcolor{comment}{//             // position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00381}00381               \textcolor{comment}{//             node\_pt(n)-\/>x\_gen(k,i) = old\_var-\/fd\_step;}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00383}00383               \textcolor{comment}{//             //Calculate the new residuals at backward position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00384}00384               \textcolor{comment}{//             //BASIC::get\_residuals(newres\_minus);}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00385}00385 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00386}00386               \textcolor{comment}{//             //Do central finite differences}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00387}00387               \textcolor{comment}{//             for(unsigned m=0;m<n\_dof;m++)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00388}00388               \textcolor{comment}{//              \{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00389}00389               \textcolor{comment}{//               //Stick the entry into the Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00390}00390               \textcolor{comment}{//               jacobian(m,local\_unknown) =}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00391}00391               \textcolor{comment}{//                (newres[m] -\/ newres\_minus[m])/(2.0*fd\_step);}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00392}00392               \textcolor{comment}{//              \}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00393}00393               \textcolor{comment}{//            \}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00395}00395               \textcolor{comment}{// Reset the (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00396}00396               *value\_pt = old\_var;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00397}00397 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00398}00398               \textcolor{comment}{// Perform any auxialiary node updates}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00399}00399               this-\/>node\_pt(n)-\/>perform\_auxiliary\_node\_update\_fct();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00400}00400             \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00401}00401           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00402}00402         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00403}00403       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00405}00405       \textcolor{comment}{// End of finite difference loop}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00406}00406       \textcolor{comment}{// Final reset of any dependent data}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00407}00407       this-\/>reset\_after\_solid\_position\_fd();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00408}00408     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00410}00410 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00411}00411 \textcolor{comment}{    /// Specify Data that affects the geometry of the element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00412}00412 \textcolor{comment}{    /// by adding the position Data to the set that's passed in.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00413}00413 \textcolor{comment}{    /// (This functionality is required in FSI problems; set is used to}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00414}00414 \textcolor{comment}{    /// avoid double counting).}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00415}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_adfbae74b4fefc2a3916bb792fbde4fa0}{00415}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_adfbae74b4fefc2a3916bb792fbde4fa0}{identify\_geometric\_data}}(std::set<Data*>\& geometric\_data\_pt)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00416}00416     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00417}00417       \textcolor{comment}{// Loop over the node update data and add to the set}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00418}00418       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00419}00419       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00420}00420       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00421}00421         geometric\_data\_pt.insert(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00422}00422           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(this-\/>node\_pt(j))-\/>variable\_position\_pt());}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00423}00423       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00424}00424     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00425}00425 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00426}00426 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00427}00427 \textcolor{comment}{    /// Overload the output function: Call that of the basic element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00428}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a41addbcf4a1ed2711e24632c8a122dcb}{00428}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a41addbcf4a1ed2711e24632c8a122dcb}{output}}(std::ostream\& outfile)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00429}00429     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00430}00430       \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{BASIC::output}}(outfile);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00431}00431     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00432}00432 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00433}00433 \textcolor{comment}{    /// Output function: Plot at n\_p plot points using the basic}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00434}00434 \textcolor{comment}{    /// element's output function}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00435}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a293e9f73e7dd0429755379e17326994b}{00435}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a293e9f73e7dd0429755379e17326994b}{output}}(std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_p)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00436}00436     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00437}00437       \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{BASIC::output}}(outfile, n\_p);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00438}00438     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00439}00439 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00440}00440 \textcolor{comment}{    /// Overload the output function: Call that of the basic element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00441}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_ade73359e3600d32d64cf8acced341776}{00441}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_ade73359e3600d32d64cf8acced341776}{output}}(FILE* file\_pt)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00442}00442     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00443}00443       \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{BASIC::output}}(file\_pt);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00444}00444     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00445}00445 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00446}00446 \textcolor{comment}{    /// Output function is just the same as the basic equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00447}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_ac4e895c35d56c2137bd35ad988264bc8}{00447}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_ac4e895c35d56c2137bd35ad988264bc8}{output}}(FILE* file\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_p)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00448}00448     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00449}00449       \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{BASIC::output}}(file\_pt, n\_p);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00450}00450     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00451}00451 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00452}00452 \textcolor{comment}{    /// Number of 'flux' terms for Z2 error estimation: Error estimation}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00453}00453 \textcolor{comment}{    /// is based on error in BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00454}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_adbda8595ca36cd972870af6f1e498601}{00454}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_adbda8595ca36cd972870af6f1e498601}{num\_Z2\_flux\_terms}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00455}00455     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00456}00456       \textcolor{keywordflow}{return} BASIC::num\_Z2\_flux\_terms();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00457}00457     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00458}00458 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00459}00459 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00460}00460 \textcolor{comment}{    /// Plot the error when compared against a given exact flux.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00461}00461 \textcolor{comment}{    /// Also calculates the norm of the error and that of the exact flux.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00462}00462 \textcolor{comment}{    /// Use version in BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00463}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a1b1baac59b7500a04f06e9ac5bc534b0}{00463}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a1b1baac59b7500a04f06e9ac5bc534b0}{compute\_exact\_Z2\_error}}(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00464}00464       std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00465}00465       \mbox{\hyperlink{classoomph_1_1FiniteElement_a690fd33af26cc3e84f39bba6d5a85202}{FiniteElement::SteadyExactSolutionFctPt}} exact\_flux\_pt,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00466}00466       \textcolor{keywordtype}{double}\& error,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00467}00467       \textcolor{keywordtype}{double}\& norm)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00468}00468     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00469}00469       BASIC::compute\_exact\_Z2\_error(outfile, exact\_flux\_pt, error, norm);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00470}00470     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00471}00471 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00472}00472 \textcolor{comment}{    /// 'Flux' vector for Z2 error estimation: Error estimation}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00473}00473 \textcolor{comment}{    /// is based on error in BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00474}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6af297e5106ad545b61757ff020380ac}{00474}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6af297e5106ad545b61757ff020380ac}{get\_Z2\_flux}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& flux)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00475}00475     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00476}00476       BASIC::get\_Z2\_flux(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, flux);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00477}00477     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00478}00478 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00479}00479 \textcolor{comment}{    /// Number of vertex nodes in the element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00480}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a8a6830facb4584f4e077169296d3d88c}{00480}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a8a6830facb4584f4e077169296d3d88c}{nvertex\_node}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00481}00481 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00482}00482       \textcolor{keywordflow}{return} BASIC::nvertex\_node();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00483}00483     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00484}00484 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00485}00485 \textcolor{comment}{    /// Pointer to the j-\/th vertex node in the element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00486}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a2facf446f0527256f8b2c4a86a5d2a7a}{00486}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a2facf446f0527256f8b2c4a86a5d2a7a}{vertex\_node\_pt}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00487}00487 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00488}00488       \textcolor{keywordflow}{return} BASIC::vertex\_node\_pt(j);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00489}00489     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00490}00490 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00491}00491 \textcolor{comment}{    /// Order of recovery shape functions for Z2 error estimation: Done}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00492}00492 \textcolor{comment}{    /// for BASIC element since it determines the refinement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00493}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a673a5bdd155f24f333c0bb493f645202}{00493}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a673a5bdd155f24f333c0bb493f645202}{nrecovery\_order}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00494}00494     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00495}00495       \textcolor{keywordflow}{return} BASIC::nrecovery\_order();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00496}00496     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00497}00497 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00498}00498 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00499}00499 \textcolor{comment}{    /// The number of "{}DOF types"{} that degrees of freedom in this element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00500}00500 \textcolor{comment}{    /// are sub-\/divided into.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00501}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_afc87fa6598bbabf49d872296e47bf1ea}{00501}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_afc87fa6598bbabf49d872296e47bf1ea}{ndof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00502}00502 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00503}00503       \textcolor{keywordflow}{return} BASIC::ndof\_types() + SOLID::ndof\_types();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00504}00504     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00505}00505 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00506}00506 \textcolor{comment}{    /// return the number of DOF types associated with the BASIC}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00507}00507 \textcolor{comment}{    /// elements in this combined element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00508}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6fbeab78f1f6ebe9fc76625d88009e61}{00508}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6fbeab78f1f6ebe9fc76625d88009e61}{nbasic\_dof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00509}00509 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00510}00510       \textcolor{keywordflow}{return} BASIC::ndof\_types();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00511}00511     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00512}00512 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00513}00513 \textcolor{comment}{    /// return the number of DOF types associated with the SOLID}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00514}00514 \textcolor{comment}{    /// elements in this combined element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00515}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a20d4f8be49920f8599b60981b1b1775f}{00515}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a20d4f8be49920f8599b60981b1b1775f}{nsolid\_dof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00516}00516 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00517}00517       \textcolor{keywordflow}{return} SOLID::ndof\_types();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00518}00518     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00519}00519 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00520}00520 \textcolor{comment}{    /// Create a list of pairs for all unknowns in this element,}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00521}00521 \textcolor{comment}{    /// so that the first entry in each pair contains the global equation}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00522}00522 \textcolor{comment}{    /// number of the unknown, while the second one contains the number}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00523}00523 \textcolor{comment}{    /// of the "{}DOF type"{} that this unknown is associated with.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00524}00524 \textcolor{comment}{    /// This method combines the get\_dof\_numbers\_for\_unknowns(...)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00525}00525 \textcolor{comment}{    /// method for the BASIC and SOLID elements. The basic elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00526}00526 \textcolor{comment}{    /// retain their DOF type numbering and the SOLID elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00527}00527 \textcolor{comment}{    /// DOF type numbers are incremented by nbasic\_dof\_types().}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00528}\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a18101610910f61e68da44e0fedf68c2c}{00528}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a18101610910f61e68da44e0fedf68c2c}{get\_dof\_numbers\_for\_unknowns}}(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00529}00529       std::list<std::pair<unsigned long, unsigned>>\& dof\_lookup\_list)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00530}00530 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00531}00531       \textcolor{comment}{// get the solid list}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00532}00532       std::list<std::pair<unsigned long, unsigned>> solid\_list;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00533}00533       SOLID::get\_dof\_numbers\_for\_unknowns(solid\_list);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00534}00534 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00535}00535       \textcolor{comment}{// get the basic list}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00536}00536       BASIC::get\_dof\_numbers\_for\_unknowns(dof\_lookup\_list);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00537}00537 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00538}00538       \textcolor{comment}{// get the number of basic dof types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00539}00539       \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6fbeab78f1f6ebe9fc76625d88009e61}{nbasic\_dof\_types}} = BASIC::ndof\_types();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00540}00540 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00541}00541       \textcolor{comment}{// add the solid lookup list to the basic lookup list}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00542}00542       \textcolor{comment}{// incrementing the solid dof numbers by nbasic\_dof\_types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00543}00543       \textcolor{keyword}{typedef} std::list<std::pair<unsigned long, unsigned>>::iterator IT;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00544}00544       \textcolor{keywordflow}{for} (IT it = solid\_list.begin(); it != solid\_list.end(); it++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00545}00545       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00546}00546         std::pair<unsigned long, unsigned> new\_pair;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00547}00547         new\_pair.first = it-\/>first;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00548}00548         new\_pair.second = it-\/>second + \mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement_a6fbeab78f1f6ebe9fc76625d88009e61}{nbasic\_dof\_types}};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00549}00549         dof\_lookup\_list.push\_front(new\_pair);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00550}00550       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00551}00551     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00552}00552   \};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00553}00553 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00554}00554 \textcolor{comment}{  /// Explicit definition of the face geometry of these elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00555}00555 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keyword}{class} BASIC, \textcolor{keyword}{class} SOLID>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00556}\mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01PseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4}{00556}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement}{PseudoSolidNodeUpdateElement}}<BASIC, SOLID>>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00557}00557     : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<SOLID>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00558}00558   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00559}00559   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00560}00560 \textcolor{comment}{    /// Constuctor calls the constructor of the SolidQElement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00561}00561 \textcolor{comment}{    /// (Only the Intel compiler seems to need this!)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00562}\mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01PseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_aca4982e3df0a3293daf1192aa380f5a3}{00562}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01PseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_aca4982e3df0a3293daf1192aa380f5a3}{FaceGeometry}}() : \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<SOLID>() \{\}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00563}00563   \};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00564}00564 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00565}00565 \textcolor{comment}{  /// Explicit definition of the face geometry of these elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00566}00566 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keyword}{class} BASIC, \textcolor{keyword}{class} SOLID>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00567}\mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01PseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_01_4}{00567}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<\mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<\mbox{\hyperlink{classoomph_1_1PseudoSolidNodeUpdateElement}{PseudoSolidNodeUpdateElement}}<BASIC, SOLID>>>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00568}00568     : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<FaceGeometry<SOLID>>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00569}00569   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00570}00570   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00571}00571 \textcolor{comment}{    /// Constuctor calls the constructor of the SolidQElement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00572}00572 \textcolor{comment}{    /// (Only the Intel compiler seems to need this!)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00573}\mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01PseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_01_4_a6c8c9148818426e94b61b0f6d22b4c61}{00573}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01PseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_01_4_a6c8c9148818426e94b61b0f6d22b4c61}{FaceGeometry}}() : \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<\mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<SOLID>>() \{\}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00574}00574 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00575}00575   \textcolor{keyword}{protected}:}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00576}00576   \};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00577}00577 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00578}00578 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00579}00579   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00580}00580 \textcolor{comment}{  /// Refineable version of the PseudoSolidNodeUpdateELement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00581}00581 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00582}00582   \textcolor{keyword}{template}<\textcolor{keyword}{class} BASIC, \textcolor{keyword}{class} SOLID>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00583}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement}{00583}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement}{RefineablePseudoSolidNodeUpdateElement}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} BASIC,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00584}00584                                                  \textcolor{keyword}{public} \textcolor{keyword}{virtual} SOLID}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00585}00585   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00586}00586   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00587}00587 \textcolor{comment}{    /// Constructor, call the BASIC and SOLID elements' constructors and}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00588}00588 \textcolor{comment}{    /// set the "{}density"{} parameter for solid element to zero}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00589}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a5d066a14376949c5a0d598ad2edbf179}{00589}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a5d066a14376949c5a0d598ad2edbf179}{RefineablePseudoSolidNodeUpdateElement}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00590}00590       : \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}(), BASIC(), SOLID()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00591}00591     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00592}00592       SOLID::lambda\_sq\_pt() = \&\mbox{\hyperlink{namespaceoomph_1_1PseudoSolidHelper_a4d6244e865fddd406dc8589beb58a654}{PseudoSolidHelper::Zero}};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00593}00593     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00594}00594 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00595}00595 \textcolor{comment}{    /// Function to describe the local dofs of the element. The ostream}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00596}00596 \textcolor{comment}{    /// specifies the output stream to which the description}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00597}00597 \textcolor{comment}{    /// is written; the string stores the currently}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00598}00598 \textcolor{comment}{    /// assembled output that is ultimately written to the}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00599}00599 \textcolor{comment}{    /// output stream by Data::describe\_dofs(...); it is typically}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00600}00600 \textcolor{comment}{    /// built up incrementally as we descend through the}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00601}00601 \textcolor{comment}{    /// call hierarchy of this function when called from}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00602}00602 \textcolor{comment}{    /// Problem::describe\_dofs(...)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00603}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ae8d1530df547c5d697c640d45cb6c941}{00603}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ae8d1530df547c5d697c640d45cb6c941}{describe\_local\_dofs}}(std::ostream\& out,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00604}00604                              \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}}\& current\_string)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00605}00605 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00606}00606       BASIC::describe\_local\_dofs(out, current\_string);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00607}00607       SOLID::describe\_local\_dofs(out, current\_string);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00608}00608     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00609}00609 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00610}00610 \textcolor{comment}{    /// The required number of values is the sum of the two}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00611}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_af1d5e0fb32d61d553eba93b705ec0052}{00611}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_af1d5e0fb32d61d553eba93b705ec0052}{required\_nvalue}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00612}00612 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00613}00613       \textcolor{keywordflow}{return} BASIC::required\_nvalue(n) + SOLID::required\_nvalue(n);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00614}00614     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00615}00615 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00616}00616 \textcolor{comment}{    /// The number of continuously interpolated values is the}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00617}00617 \textcolor{comment}{    /// sum of the SOLID and BASIC values}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00618}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a4384a23bbf41dd44ccc2c64579cdd03b}{00618}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a4384a23bbf41dd44ccc2c64579cdd03b}{ncont\_interpolated\_values}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00619}00619 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00620}00620       \textcolor{keywordflow}{return} BASIC::ncont\_interpolated\_values() +}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00621}00621              SOLID::ncont\_interpolated\_values();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00622}00622     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00623}00623 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00624}00624 \textcolor{comment}{    /// We assume that the solid stuff is stored at the end of}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00625}00625 \textcolor{comment}{    /// the nodes, i.e. its index is the number of continuously interplated}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00626}00626 \textcolor{comment}{    /// values in the BASIC equations.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00627}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a511ebac2f17e098f4a01949d9d42be2d}{00627}} \textcolor{comment}{}    \textcolor{keywordtype}{int} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a511ebac2f17e098f4a01949d9d42be2d}{solid\_p\_nodal\_index}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00628}00628 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00629}00629       \textcolor{comment}{// Find the index in the solid}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00630}00630       \textcolor{keywordtype}{int} solid\_p\_index = SOLID::solid\_p\_nodal\_index();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00631}00631       \textcolor{comment}{// If there is a solid pressure at the nodes, return the}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00632}00632       \textcolor{comment}{// index after all the BASIC stuff}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00633}00633       \textcolor{keywordflow}{if} (solid\_p\_index >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00634}00634       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00635}00635         \textcolor{keywordflow}{return} BASIC::ncont\_interpolated\_values() +}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00636}00636                SOLID::solid\_p\_nodal\_index();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00637}00637       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00638}00638       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00639}00639       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00640}00640         \textcolor{keywordflow}{return} solid\_p\_index;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00641}00641       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00642}00642     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00643}00643 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00644}00644 \textcolor{comment}{    /// Final override for residuals function: adds contributions}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00645}00645 \textcolor{comment}{    /// from both underlying element types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00646}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a36add3ef201fc05954ab982a67840cb3}{00646}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a36add3ef201fc05954ab982a67840cb3}{fill\_in\_contribution\_to\_residuals}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00647}00647     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00648}00648       \textcolor{comment}{// Call the basic equations first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00649}00649       BASIC::fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00650}00650       \textcolor{comment}{// Call the solid equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00651}00651       SOLID::fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00652}00652     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00653}00653 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00654}00654 \textcolor{comment}{    /// Final override for jacobian function: Calls get\_jacobian() for}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00655}00655 \textcolor{comment}{    /// both of the underlying element types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00656}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a56a4edc264874dc8673dccd92672b608}{00656}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a56a4edc264874dc8673dccd92672b608}{fill\_in\_contribution\_to\_jacobian}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00657}00657                                           \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00658}00658     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00659}00659       \textcolor{comment}{// Call the basic equations first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00660}00660       BASIC::fill\_in\_contribution\_to\_jacobian(residuals, jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00661}00661 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00662}00662       \textcolor{comment}{// Call the solid equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00663}00663       SOLID::fill\_in\_contribution\_to\_jacobian(residuals, jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00664}00664 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00665}00665       \textcolor{comment}{// Now fill in the off-\/diagonal entries (the shape derivatives),}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00666}00666       \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ac7a9338e59678df2d5e9fcf838bd95d1}{fill\_in\_shape\_derivatives\_by\_fd}}(jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00667}00667     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00668}00668 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00669}00669 \textcolor{comment}{    /// Final override for mass matrix function: contributions}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00670}00670 \textcolor{comment}{    /// are included from both the underlying element types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00671}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a7ac165866aa2c717fb47df9ea1883d32}{00671}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a7ac165866aa2c717fb47df9ea1883d32}{fill\_in\_contribution\_to\_jacobian\_and\_mass\_matrix}}(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00672}00672       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00673}00673       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00674}00674       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& mass\_matrix)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00675}00675     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00676}00676       \textcolor{comment}{// Call the basic equations first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00677}00677       BASIC::fill\_in\_contribution\_to\_jacobian\_and\_mass\_matrix(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00678}00678         residuals, jacobian, mass\_matrix);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00679}00679       \textcolor{comment}{// Call the solid equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00680}00680       SOLID::fill\_in\_contribution\_to\_jacobian\_and\_mass\_matrix(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00681}00681         residuals, jacobian, mass\_matrix);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00682}00682 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00683}00683       \textcolor{comment}{// Now fill in the off-\/diagonal entries (the shape derivatives),}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00684}00684       \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ac7a9338e59678df2d5e9fcf838bd95d1}{fill\_in\_shape\_derivatives\_by\_fd}}(jacobian);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00685}00685     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00686}00686 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00687}00687 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00688}00688 \textcolor{comment}{    /// Fill in the derivatives of the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00689}00689 \textcolor{comment}{    /// w.r.t. to the solid position dofs, taking hanging nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00690}00690 \textcolor{comment}{    /// into account}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00691}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ac7a9338e59678df2d5e9fcf838bd95d1}{00691}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ac7a9338e59678df2d5e9fcf838bd95d1}{fill\_in\_shape\_derivatives\_by\_fd}}(\mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& jacobian)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00692}00692     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00693}00693       \textcolor{comment}{// Find the number of nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00694}00694       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00695}00695 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00696}00696       \textcolor{comment}{// If there are no nodes, return straight away}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00697}00697       \textcolor{keywordflow}{if} (n\_node == 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00698}00698       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00699}00699         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00700}00700       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00701}00701 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00702}00702       \textcolor{comment}{// Call the update function to ensure that the element is in}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00703}00703       \textcolor{comment}{// a consistent state before finite differencing starts}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00704}00704       this-\/>update\_before\_solid\_position\_fd();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00705}00705 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00706}00706       \textcolor{comment}{//  bool use\_first\_order\_fd=false;}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00707}00707 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00708}00708       \textcolor{comment}{// Find the number of positional dofs and nodal dimension}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00709}00709       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_position\_type = this-\/>nnodal\_position\_type();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00710}00710       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} nodal\_dim = this-\/>nodal\_dimension();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00711}00711 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00712}00712       \textcolor{comment}{// Find the number of dofs in the element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00713}00713       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dof = this-\/>ndof();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00714}00714 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00715}00715       \textcolor{comment}{// Create residual newres vectors}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00716}00716       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} residuals(n\_dof);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00717}00717       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} newres(n\_dof);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00718}00718       \textcolor{comment}{// Vector<double> newres\_minus(n\_dof);}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00719}00719 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00720}00720       \textcolor{comment}{// Calculate the residuals (for the BASIC) equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00721}00721       \textcolor{comment}{// Need to do this using fill\_in because get\_residuals will}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00722}00722       \textcolor{comment}{// compute all residuals for the problem, which is}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00723}00723       \textcolor{comment}{// a little ineffecient}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00724}00724       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_dof; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00725}00725       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00726}00726         residuals[m] = 0.0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00727}00727       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00728}00728       BASIC::fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00729}00729 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00730}00730       \textcolor{comment}{// Need to determine which degrees of freedom are solid degrees of}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00731}00731       \textcolor{comment}{// freedom}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00732}00732       \textcolor{comment}{// A vector of booleans that will be true if the dof is associated}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00733}00733       \textcolor{comment}{// with the solid equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00734}00734       std::vector<bool> dof\_is\_solid(n\_dof, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00735}00735 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00736}00736       \textcolor{comment}{// Now set all solid positional dofs in the vector}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00737}00737       \textcolor{comment}{// This is a bit more involved because we need to take account of}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00738}00738       \textcolor{comment}{// any hanging nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00739}00739       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00740}00740       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00741}00741         \textcolor{comment}{// Get pointer to the local node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00742}00742         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const} local\_node\_pt = this-\/>node\_pt(n);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00743}00743 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00744}00744         \textcolor{comment}{// If the node is not a hanging node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00745}00745         \textcolor{keywordflow}{if} (local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_af0e6237dfafad62cf427ff5013ddcfef}{is\_hanging}}() == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00746}00746         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00747}00747           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00748}00748           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00749}00749             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00750}00750             \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00751}00751               \textcolor{keywordtype}{int} local\_dof = this-\/>position\_local\_eqn(n, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00752}00752               \textcolor{keywordflow}{if} (local\_dof >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00753}00753               \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00754}00754                 dof\_is\_solid[local\_dof] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00755}00755               \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00756}00756             \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00757}00757           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00758}00758         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00759}00759         \textcolor{comment}{// Otherwise the node is hanging}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00760}00760         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00761}00761         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00762}00762           \textcolor{comment}{// Find the local hanging object}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00763}00763           \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* hang\_info\_pt = local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00764}00764           \textcolor{comment}{// Loop over the master nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00765}00765           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_master = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00766}00766           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00767}00767           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00768}00768             \textcolor{comment}{// Get the local equation numbers for the master node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00769}00769             \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<int>}} Position\_local\_eqn\_at\_node =}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00770}00770               this-\/>local\_position\_hang\_eqn(hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(m));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00771}00771 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00772}00772             \textcolor{comment}{// Loop over position dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00773}00773             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00774}00774             \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00775}00775               \textcolor{comment}{// Loop over dimension}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00776}00776               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00777}00777               \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00778}00778                 \textcolor{keywordtype}{int} local\_dof = Position\_local\_eqn\_at\_node(k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00779}00779                 \textcolor{keywordflow}{if} (local\_dof >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00780}00780                 \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00781}00781                   dof\_is\_solid[local\_dof] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00782}00782                 \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00783}00783               \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00784}00784             \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00785}00785           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00786}00786         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00787}00787       \} \textcolor{comment}{// End of loop over nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00788}00788 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00789}00789       \textcolor{comment}{// Add the solid pressures (in solid elements without}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00790}00790       \textcolor{comment}{// solid pressure the number will be zero).}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00791}00791       \textcolor{keywordtype}{unsigned} n\_solid\_pres = this-\/>npres\_solid();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00792}00792       \textcolor{comment}{// Now is the solid pressure hanging}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00793}00793       \textcolor{keyword}{const} \textcolor{keywordtype}{int} solid\_p\_index = this-\/>\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a511ebac2f17e098f4a01949d9d42be2d}{solid\_p\_nodal\_index}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00794}00794       \textcolor{comment}{// Find out whether the solid node is hanging}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00795}00795       std::vector<bool> solid\_p\_is\_hanging(n\_solid\_pres);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00796}00796       \textcolor{comment}{// If we have nodal solid pressures then read out the hanging status}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00797}00797       \textcolor{keywordflow}{if} (solid\_p\_index >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00798}00798       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00799}00799         \textcolor{comment}{// Loop over the solid dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00800}00800         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_solid\_pres; l++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00801}00801         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00802}00802           solid\_p\_is\_hanging[l] =}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00803}00803             this-\/>solid\_pressure\_node\_pt(l)-\/>is\_hanging(solid\_p\_index);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00804}00804         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00805}00805       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00806}00806       \textcolor{comment}{// Otherwise the pressure is not nodal, so cannot hang}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00807}00807       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00808}00808       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00809}00809         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_solid\_pres; l++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00810}00810         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00811}00811           solid\_p\_is\_hanging[l] = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00812}00812         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00813}00813       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00814}00814 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00815}00815       \textcolor{comment}{// Now we can loop of the dofs again to actually set that the appropriate}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00816}00816       \textcolor{comment}{// dofs are solid}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00817}00817       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_solid\_pres; l++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00818}00818       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00819}00819         \textcolor{comment}{// If the solid pressure is not hanging}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00820}00820         \textcolor{comment}{// we just read out the local equation numbers directly}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00821}00821         \textcolor{keywordflow}{if} (solid\_p\_is\_hanging[l] == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00822}00822         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00823}00823           \textcolor{keywordtype}{int} local\_dof = this-\/>solid\_p\_local\_eqn(l);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00824}00824           \textcolor{keywordflow}{if} (local\_dof >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00825}00825           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00826}00826             dof\_is\_solid[local\_dof] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00827}00827           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00828}00828         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00829}00829         \textcolor{comment}{// Otherwise solid pressure is hanging and we need to take}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00830}00830         \textcolor{comment}{// care of the master nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00831}00831         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00832}00832         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00833}00833           \textcolor{comment}{// Find the local hanging object}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00834}00834           \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* hang\_info\_pt =}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00835}00835             this-\/>solid\_pressure\_node\_pt(l)-\/>hanging\_pt(solid\_p\_index);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00836}00836           \textcolor{comment}{// Loop over the master nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00837}00837           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_master = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00838}00838           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00839}00839           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00840}00840             \textcolor{comment}{// Get the local dof}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00841}00841             \textcolor{keywordtype}{int} local\_dof = this-\/>local\_hang\_eqn(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00842}00842               hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(m), solid\_p\_index);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00843}00843 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00844}00844             \textcolor{keywordflow}{if} (local\_dof >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00845}00845             \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00846}00846               dof\_is\_solid[local\_dof] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00847}00847             \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00848}00848           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00849}00849         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00850}00850       \} \textcolor{comment}{// end of loop over solid pressure dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00851}00851 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00852}00852 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00853}00853       \textcolor{comment}{// Used default value defined in GeneralisedElement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00854}00854       \textcolor{keyword}{const} \textcolor{keywordtype}{double} fd\_step = this-\/>Default\_fd\_jacobian\_step;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00855}00855 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00856}00856       \textcolor{comment}{// Integer storage for local unknowns}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00857}00857       \textcolor{keywordtype}{int} local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00858}00858 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00859}00859       \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00860}00860       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00861}00861       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00862}00862         \textcolor{comment}{// Get the pointer to the node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00863}00863         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const} local\_node\_pt = this-\/>node\_pt(l);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00864}00864 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00865}00865         \textcolor{comment}{// If the node is not a hanging node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00866}00866         \textcolor{keywordflow}{if} (local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_af0e6237dfafad62cf427ff5013ddcfef}{is\_hanging}}() == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00867}00867         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00868}00868           \textcolor{comment}{// Loop over position dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00869}00869           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00870}00870           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00871}00871             \textcolor{comment}{// Loop over dimension}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00872}00872             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00873}00873             \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00874}00874               local\_unknown = this-\/>position\_local\_eqn(l, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00875}00875               \textcolor{comment}{// If the variable is free}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00876}00876               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00877}00877               \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00878}00878                 \textcolor{comment}{// Store a pointer to the (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00879}00879                 \textcolor{keywordtype}{double}* \textcolor{keyword}{const} value\_pt = \&(local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_af7fdc0dfda495d69bd31c790ee77da73}{x\_gen}}(k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00880}00880 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00881}00881                 \textcolor{comment}{// Save the old value of the (generalised) Eulerian nodal}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00882}00882                 \textcolor{comment}{// position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00883}00883                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} old\_var = *value\_pt;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00884}00884 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00885}00885                 \textcolor{comment}{// Increment the  (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00886}00886                 *value\_pt += fd\_step;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00887}00887 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00888}00888                 \textcolor{comment}{// Perform any auxialiary node updates}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00889}00889                 local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a6c287aa85c19f2d37ed7952ece5c76dd}{perform\_auxiliary\_node\_update\_fct}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00890}00890 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00891}00891                 \textcolor{comment}{// Calculate the new residuals}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00892}00892                 \textcolor{comment}{// Need to do this using fill\_in because get\_residuals will}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00893}00893                 \textcolor{comment}{// compute all residuals for the problem, which is}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00894}00894                 \textcolor{comment}{// a little ineffecient}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00895}00895                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_dof; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00896}00896                 \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00897}00897                   newres[m] = 0.0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00898}00898                 \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00899}00899                 BASIC::fill\_in\_contribution\_to\_residuals(newres);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00900}00900 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00901}00901 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00902}00902                 \textcolor{comment}{//           if (use\_first\_order\_fd)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00903}00903                 \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00904}00904                   \textcolor{comment}{// Do forward finite differences}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00905}00905                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_dof; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00906}00906                   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00907}00907                     \textcolor{comment}{// Stick the entry into the Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00908}00908                     \textcolor{comment}{// But only if it's not a solid dof}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00909}00909                     \textcolor{keywordflow}{if} (dof\_is\_solid[m] == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00910}00910                     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00911}00911                       jacobian(m, local\_unknown) =}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00912}00912                         (newres[m] -\/ residuals[m]) / fd\_step;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00913}00913                     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00914}00914                   \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00915}00915                 \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00916}00916                 \textcolor{comment}{//             else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00917}00917                 \textcolor{comment}{//              \{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00918}00918                 \textcolor{comment}{//               //Take backwards step for the  (generalised)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00919}00919                 \textcolor{comment}{//               Eulerian nodal}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00920}00920                 \textcolor{comment}{//               // position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00921}00921                 \textcolor{comment}{//               node\_pt(l)-\/>x\_gen(k,i) = old\_var-\/fd\_step;}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00922}00922 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00923}00923                 \textcolor{comment}{//               //Calculate the new residuals at backward}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00924}00924                 \textcolor{comment}{//               position BASIC::get\_residuals(newres\_minus);}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00925}00925 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00926}00926                 \textcolor{comment}{//               //Do central finite differences}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00927}00927                 \textcolor{comment}{//               for(unsigned m=0;m<n\_dof;m++)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00928}00928                 \textcolor{comment}{//                \{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00929}00929                 \textcolor{comment}{//                 //Stick the entry into the Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00930}00930                 \textcolor{comment}{//                 jacobian(m,local\_unknown) =}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00931}00931                 \textcolor{comment}{//                  (newres[m] -\/ newres\_minus[m])/(2.0*fd\_step);}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00932}00932                 \textcolor{comment}{//                \}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00933}00933                 \textcolor{comment}{//              \}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00934}00934 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00935}00935                 \textcolor{comment}{// Reset the (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00936}00936                 *value\_pt = old\_var;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00937}00937 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00938}00938                 \textcolor{comment}{// Perform any auxialiary node updates}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00939}00939                 local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a6c287aa85c19f2d37ed7952ece5c76dd}{perform\_auxiliary\_node\_update\_fct}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00940}00940               \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00941}00941             \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00942}00942           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00943}00943         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00944}00944         \textcolor{comment}{// Otherwise it's a hanging node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00945}00945         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00946}00946         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00947}00947           \textcolor{comment}{// Find the local hanging object}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00948}00948           \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* hang\_info\_pt = local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00949}00949           \textcolor{comment}{// Loop over the master nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00950}00950           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_master = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00951}00951           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00952}00952           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00953}00953             \textcolor{comment}{// Get the pointer to the master node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00954}00954             \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \textcolor{keyword}{const} master\_node\_pt = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(m);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00955}00955 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00956}00956             \textcolor{comment}{// Get the local equation numbers for the master node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00957}00957             \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<int>}} Position\_local\_eqn\_at\_node =}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00958}00958               this-\/>local\_position\_hang\_eqn(master\_node\_pt);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00959}00959 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00960}00960             \textcolor{comment}{// Loop over position dofs}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00961}00961             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_position\_type; k++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00962}00962             \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00963}00963               \textcolor{comment}{// Loop over dimension}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00964}00964               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nodal\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00965}00965               \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00966}00966                 local\_unknown = Position\_local\_eqn\_at\_node(k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00967}00967                 \textcolor{comment}{// If the variable is free}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00968}00968                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00969}00969                 \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00970}00970                   \textcolor{comment}{// Store a pointer to the (generalised) Eulerian nodal}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00971}00971                   \textcolor{comment}{// position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00972}00972                   \textcolor{keywordtype}{double}* \textcolor{keyword}{const} value\_pt = \&(master\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_af7fdc0dfda495d69bd31c790ee77da73}{x\_gen}}(k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00973}00973 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00974}00974                   \textcolor{comment}{// Save the old value of the (generalised) Eulerian nodal}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00975}00975                   \textcolor{comment}{// position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00976}00976                   \textcolor{keyword}{const} \textcolor{keywordtype}{double} old\_var = *value\_pt;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00977}00977 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00978}00978                   \textcolor{comment}{// Increment the  (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00979}00979                   *value\_pt += fd\_step;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00980}00980 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00981}00981                   \textcolor{comment}{// Perform any auxialiary node updates}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00982}00982                   master\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a6c287aa85c19f2d37ed7952ece5c76dd}{perform\_auxiliary\_node\_update\_fct}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00983}00983 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00984}00984                   \textcolor{comment}{// Calculate the new residuals}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00985}00985                   \textcolor{comment}{// Need to do this using fill\_in because get\_residuals will}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00986}00986                   \textcolor{comment}{// compute all residuals for the problem, which is}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00987}00987                   \textcolor{comment}{// a little ineffecient}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00988}00988                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_dof; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00989}00989                   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00990}00990                     newres[m] = 0.0;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00991}00991                   \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00992}00992                   BASIC::fill\_in\_contribution\_to\_residuals(newres);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00993}00993 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00994}00994                   \textcolor{comment}{//            if (use\_first\_order\_fd)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00995}00995                   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00996}00996                     \textcolor{comment}{// Do forward finite differences}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00997}00997                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_dof; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00998}00998                     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l00999}00999                       \textcolor{comment}{// Stick the entry into the Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01000}01000                       \textcolor{comment}{// But only if it's not a solid dof}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01001}01001                       \textcolor{keywordflow}{if} (dof\_is\_solid[m] == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01002}01002                       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01003}01003                         jacobian(m, local\_unknown) =}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01004}01004                           (newres[m] -\/ residuals[m]) / fd\_step;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01005}01005                       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01006}01006                     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01007}01007                   \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01008}01008                   \textcolor{comment}{//               else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01009}01009                   \textcolor{comment}{//                \{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01010}01010                   \textcolor{comment}{//                 //Take backwards step for the (generalised)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01011}01011                   \textcolor{comment}{//                 Eulerian nodal}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01012}01012                   \textcolor{comment}{//                 // position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01013}01013                   \textcolor{comment}{//                 master\_node\_pt-\/>x\_gen(k,i) =}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01014}01014                   \textcolor{comment}{//                 old\_var-\/fd\_step;}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01015}01015 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01016}01016                   \textcolor{comment}{//                 //Calculate the new residuals at backward}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01017}01017                   \textcolor{comment}{//                 position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01018}01018                   \textcolor{comment}{//                 BASIC::get\_residuals(newres\_minus);}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01019}01019 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01020}01020                   \textcolor{comment}{//                 //Do central finite differences}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01021}01021                   \textcolor{comment}{//                 for(unsigned m=0;m<n\_dof;m++)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01022}01022                   \textcolor{comment}{//                  \{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01023}01023                   \textcolor{comment}{//                   //Stick the entry into the Jacobian}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01024}01024                   \textcolor{comment}{//                   matrix jacobian(m,local\_unknown) =}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01025}01025                   \textcolor{comment}{//                    (newres[m] -\/}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01026}01026                   \textcolor{comment}{//                    newres\_minus[m])/(2.0*fd\_step);}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01027}01027                   \textcolor{comment}{//                  \}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01028}01028                   \textcolor{comment}{//                \}}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01029}01029 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01030}01030                   \textcolor{comment}{// Reset the (generalised) Eulerian nodal position}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01031}01031                   *value\_pt = old\_var;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01032}01032 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01033}01033                   \textcolor{comment}{// Perform any auxialiary node updates}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01034}01034                   master\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a6c287aa85c19f2d37ed7952ece5c76dd}{perform\_auxiliary\_node\_update\_fct}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01035}01035                 \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01036}01036               \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01037}01037             \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01038}01038           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01039}01039         \} \textcolor{comment}{// End of hanging node case}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01040}01040 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01041}01041       \} \textcolor{comment}{// End of loop over nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01042}01042 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01043}01043       \textcolor{comment}{// End of finite difference loop}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01044}01044 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01045}01045       \textcolor{comment}{// Final reset of any dependent data}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01046}01046       this-\/>reset\_after\_solid\_position\_fd();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01047}01047     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01048}01048 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01049}01049 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01050}01050 \textcolor{comment}{    /// Specify Data that affects the geometry of the element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01051}01051 \textcolor{comment}{    /// by adding the position Data to the set that's passed in.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01052}01052 \textcolor{comment}{    /// (This functionality is required in FSI problems; set is used to}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01053}01053 \textcolor{comment}{    /// avoid double counting). Refineable version includes hanging nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01054}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_afdc1206bfdc44d22d3ef1d7d1bb943e9}{01054}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_afdc1206bfdc44d22d3ef1d7d1bb943e9}{identify\_geometric\_data}}(std::set<Data*>\& geometric\_data\_pt)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01055}01055     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01056}01056       \textcolor{comment}{// Loop over the node update data and add to the set}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01057}01057       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01058}01058       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01059}01059       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01060}01060         \textcolor{comment}{// If the node is a hanging node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01061}01061         \textcolor{keywordflow}{if} (this-\/>node\_pt(j)-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01062}01062         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01063}01063           \textcolor{comment}{// Find the local hang info object}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01064}01064           \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* hang\_info\_pt = this-\/>node\_pt(j)-\/>hanging\_pt();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01065}01065 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01066}01066           \textcolor{comment}{// Find the number of master nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01067}01067           \textcolor{keywordtype}{unsigned} n\_master = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01068}01068 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01069}01069           \textcolor{comment}{// Loop over the master nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01070}01070           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master; m++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01071}01071           \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01072}01072             \textcolor{comment}{// Get the m-\/th master node}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01073}01073             \mbox{\hyperlink{classoomph_1_1Node}{Node}}* Master\_node\_pt = hang\_info\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(m);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01074}01074 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01075}01075             \textcolor{comment}{// Add to set}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01076}01076             geometric\_data\_pt.insert(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01077}01077               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(Master\_node\_pt)-\/>variable\_position\_pt());}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01078}01078           \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01079}01079         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01080}01080         \textcolor{comment}{// Not hanging}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01081}01081         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01082}01082         \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01083}01083           \textcolor{comment}{// Add node itself to set}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01084}01084           geometric\_data\_pt.insert(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01085}01085             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(this-\/>node\_pt(j))-\/>variable\_position\_pt());}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01086}01086         \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01087}01087       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01088}01088     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01089}01089 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01090}01090 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01091}01091 \textcolor{comment}{    /// Final override for the assign\_\_additional\_local\_eqn\_numbers():}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01092}01092 \textcolor{comment}{    ///  Call the version for the BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01093}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_aa6056e3f49ad76050543b1b11475d95f}{01093}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_aa6056e3f49ad76050543b1b11475d95f}{assign\_additional\_local\_eqn\_numbers}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01094}01094     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01095}01095       BASIC::assign\_additional\_local\_eqn\_numbers();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01096}01096       SOLID::assign\_additional\_local\_eqn\_numbers();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01097}01097     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01098}01098 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01099}01099 \textcolor{comment}{    /// Call rebuild\_from\_sons() for both of the underlying element types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01100}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ac653ab28abf52506f54b1306272390ce}{01100}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ac653ab28abf52506f54b1306272390ce}{rebuild\_from\_sons}}(\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01101}01101     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01102}01102       BASIC::rebuild\_from\_sons(mesh\_pt);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01103}01103       SOLID::rebuild\_from\_sons(mesh\_pt);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01104}01104     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01105}01105 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01106}01106 \textcolor{comment}{    /// Call get\_interpolated\_values(...) for both of the underlying element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01107}01107 \textcolor{comment}{    /// types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01108}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a0d92d0ec7145da660fdbf5f2a46814fd}{01108}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a0d92d0ec7145da660fdbf5f2a46814fd}{get\_interpolated\_values}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}},}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01109}01109                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01110}01110                                  \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& values)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01111}01111     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01112}01112       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} basic\_values;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01113}01113       BASIC::get\_interpolated\_values(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, basic\_values);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01114}01114       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} solid\_values;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01115}01115       SOLID::get\_interpolated\_values(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, solid\_values);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01116}01116 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01117}01117       \textcolor{comment}{// Now add the basic value first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01118}01118       \textcolor{keywordflow}{for} (\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>::iterator}} it = basic\_values.begin();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01119}01119            it != basic\_values.end();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01120}01120            ++it)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01121}01121       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01122}01122         values.push\_back(*it);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01123}01123       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01124}01124       \textcolor{comment}{// Then the solid}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01125}01125       \textcolor{keywordflow}{for} (\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>::iterator}} it = solid\_values.begin();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01126}01126            it != solid\_values.end();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01127}01127            ++it)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01128}01128       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01129}01129         values.push\_back(*it);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01130}01130       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01131}01131     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01132}01132 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01133}01133 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01134}01134 \textcolor{comment}{    /// Call get\_interpolated\_values(...) for both of the underlying element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01135}01135 \textcolor{comment}{    /// types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01136}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a031d296b43e300b84278e93757741735}{01136}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a031d296b43e300b84278e93757741735}{get\_interpolated\_values}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01137}01137                                  \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& values)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01138}01138     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01139}01139       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} basic\_values;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01140}01140       BASIC::get\_interpolated\_values(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, basic\_values);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01141}01141       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} solid\_values;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01142}01142       SOLID::get\_interpolated\_values(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, solid\_values);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01143}01143 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01144}01144       \textcolor{comment}{// Now add the basic value first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01145}01145       \textcolor{keywordflow}{for} (\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>::iterator}} it = basic\_values.begin();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01146}01146            it != basic\_values.end();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01147}01147            ++it)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01148}01148       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01149}01149         values.push\_back(*it);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01150}01150       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01151}01151       \textcolor{comment}{// Then the solid}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01152}01152       \textcolor{keywordflow}{for} (\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>::iterator}} it = solid\_values.begin();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01153}01153            it != solid\_values.end();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01154}01154            ++it)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01155}01155       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01156}01156         values.push\_back(*it);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01157}01157       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01158}01158     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01159}01159 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01160}01160 \textcolor{comment}{    /// We must compose the underlying interpolating nodes from}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01161}01161 \textcolor{comment}{    /// the BASIC and SOLID equations, the BASIC ones are first}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01162}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a97f84d8fab446b33853f71fc02079867}{01162}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a97f84d8fab446b33853f71fc02079867}{interpolating\_node\_pt}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01163}01163     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01164}01164       \textcolor{comment}{// Find the number of interpolated values in the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01165}01165       \textcolor{keywordtype}{int} n\_basic\_values = BASIC::ncont\_interpolated\_values();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01166}01166       \textcolor{comment}{// If the id is below this number, we call the BASIC functon}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01167}01167       \textcolor{keywordflow}{if} (value\_id < n\_basic\_values)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01168}01168       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01169}01169         \textcolor{keywordflow}{return} BASIC::interpolating\_node\_pt(n, value\_id);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01170}01170       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01171}01171       \textcolor{comment}{// Otherwise it's the solid and its value\_id is the the current}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01172}01172       \textcolor{comment}{// it minus n\_basic\_values}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01173}01173       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01174}01174       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01175}01175         \textcolor{keywordflow}{return} SOLID::interpolating\_node\_pt(n, (value\_id -\/ n\_basic\_values));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01176}01176       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01177}01177     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01178}01178 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01179}01179 \textcolor{comment}{    /// The pressure nodes are the corner nodes, so when value\_id==0,}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01180}01180 \textcolor{comment}{    /// the fraction is the same as the 1d node number, 0 or 1.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01181}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a8e1c7e4695dec50813227ceafa340ada}{01181}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a8e1c7e4695dec50813227ceafa340ada}{local\_one\_d\_fraction\_of\_interpolating\_node}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n1d,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01182}01182                                                       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01183}01183                                                       \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01184}01184     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01185}01185       \textcolor{comment}{// Find the number of interpolated values in the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01186}01186       \textcolor{keywordtype}{int} n\_basic\_values = BASIC::ncont\_interpolated\_values();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01187}01187       \textcolor{comment}{// If the id is below this number, we call the BASIC functon}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01188}01188       \textcolor{keywordflow}{if} (value\_id < n\_basic\_values)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01189}01189       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01190}01190         \textcolor{keywordflow}{return} BASIC::local\_one\_d\_fraction\_of\_interpolating\_node(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01191}01191           n1d, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, value\_id);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01192}01192       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01193}01193       \textcolor{comment}{// Otherwise it's the solid and its value\_id is the the current}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01194}01194       \textcolor{comment}{// it minus n\_basic\_values}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01195}01195       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01196}01196       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01197}01197         \textcolor{keywordflow}{return} SOLID::local\_one\_d\_fraction\_of\_interpolating\_node(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01198}01198           n1d, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, (value\_id -\/ n\_basic\_values));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01199}01199       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01200}01200     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01201}01201 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01202}01202 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01203}01203 \textcolor{comment}{    /// The velocity nodes are the same as the geometric nodes. The}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01204}01204 \textcolor{comment}{    /// pressure nodes must be calculated by using the same methods as}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01205}01205 \textcolor{comment}{    /// the geometric nodes, but by recalling that there are only two pressure}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01206}01206 \textcolor{comment}{    /// nodes per edge.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01207}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_aaecb901c5704abe944f5eee55128773b}{01207}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_aaecb901c5704abe944f5eee55128773b}{get\_interpolating\_node\_at\_local\_coordinate}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01208}01208                                                      \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01209}01209     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01210}01210       \textcolor{comment}{// Find the number of interpolated values in the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01211}01211       \textcolor{keywordtype}{int} n\_basic\_values = BASIC::ncont\_interpolated\_values();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01212}01212       \textcolor{comment}{// If the id is below this number, we call the BASIC functon}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01213}01213       \textcolor{keywordflow}{if} (value\_id < n\_basic\_values)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01214}01214       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01215}01215         \textcolor{keywordflow}{return} BASIC::get\_interpolating\_node\_at\_local\_coordinate(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, value\_id);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01216}01216       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01217}01217       \textcolor{comment}{// Otherwise it's the solid and its value\_id is the the current}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01218}01218       \textcolor{comment}{// it minus n\_basic\_values}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01219}01219       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01220}01220       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01221}01221         \textcolor{keywordflow}{return} SOLID::get\_interpolating\_node\_at\_local\_coordinate(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01222}01222           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, (value\_id -\/ n\_basic\_values));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01223}01223       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01224}01224     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01225}01225 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01226}01226 \textcolor{comment}{    /// The number of 1d pressure nodes is 2, otherwise we have}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01227}01227 \textcolor{comment}{    /// the positional nodes}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01228}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a65f9d660a500017d25fc2e2375049274}{01228}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a65f9d660a500017d25fc2e2375049274}{ninterpolating\_node\_1d}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01229}01229     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01230}01230       \textcolor{comment}{// Find the number of interpolated values in the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01231}01231       \textcolor{keywordtype}{int} n\_basic\_values = BASIC::ncont\_interpolated\_values();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01232}01232       \textcolor{comment}{// If the id is below this number, we call the BASIC functon}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01233}01233       \textcolor{keywordflow}{if} (value\_id < n\_basic\_values)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01234}01234       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01235}01235         \textcolor{keywordflow}{return} BASIC::ninterpolating\_node\_1d(value\_id);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01236}01236       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01237}01237       \textcolor{comment}{// Otherwise it's the solid and its value\_id is the the current}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01238}01238       \textcolor{comment}{// it minus n\_basic\_values}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01239}01239       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01240}01240       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01241}01241         \textcolor{keywordflow}{return} SOLID::ninterpolating\_node\_1d((value\_id -\/ n\_basic\_values));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01242}01242       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01243}01243     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01244}01244 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01245}01245 \textcolor{comment}{    /// The number of pressure nodes is 2\string^DIM. The number of}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01246}01246 \textcolor{comment}{    /// velocity nodes is the same as the number of geometric nodes.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01247}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ab73207cdcfb40fbd04de408d4f9cc10d}{01247}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ab73207cdcfb40fbd04de408d4f9cc10d}{ninterpolating\_node}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01248}01248     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01249}01249       \textcolor{comment}{// Find the number of interpolated values in the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01250}01250       \textcolor{keywordtype}{int} n\_basic\_values = BASIC::ncont\_interpolated\_values();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01251}01251       \textcolor{comment}{// If the id is below this number, we call the BASIC functon}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01252}01252       \textcolor{keywordflow}{if} (value\_id < n\_basic\_values)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01253}01253       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01254}01254         \textcolor{keywordflow}{return} BASIC::ninterpolating\_node(value\_id);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01255}01255       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01256}01256       \textcolor{comment}{// Otherwise it's the solid and its value\_id is the the current}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01257}01257       \textcolor{comment}{// it minus n\_basic\_values}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01258}01258       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01259}01259       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01260}01260         \textcolor{keywordflow}{return} SOLID::ninterpolating\_node((value\_id -\/ n\_basic\_values));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01261}01261       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01262}01262     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01263}01263 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01264}01264 \textcolor{comment}{    /// The basis interpolating the pressure is given by pshape().}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01265}01265 \textcolor{comment}{    /// / The basis interpolating the velocity is shape().}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01266}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a53c2c8918665b7bb190634cdefa5ea1c}{01266}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a53c2c8918665b7bb190634cdefa5ea1c}{interpolating\_basis}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01267}01267                              \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01268}01268                              \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01269}01269 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01270}01270       \textcolor{comment}{// Find the number of interpolated values in the BASIC equations}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01271}01271       \textcolor{keywordtype}{int} n\_basic\_values = BASIC::ncont\_interpolated\_values();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01272}01272       \textcolor{comment}{// If the id is below this number, we call the BASIC functon}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01273}01273       \textcolor{keywordflow}{if} (value\_id < n\_basic\_values)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01274}01274       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01275}01275         \textcolor{keywordflow}{return} BASIC::interpolating\_basis(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, value\_id);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01276}01276       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01277}01277       \textcolor{comment}{// Otherwise it's the solid and its value\_id is the the current}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01278}01278       \textcolor{comment}{// it minus n\_basic\_values}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01279}01279       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01280}01280       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01281}01281         \textcolor{keywordflow}{return} SOLID::interpolating\_basis(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, (value\_id -\/ n\_basic\_values));}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01282}01282       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01283}01283     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01284}01284 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01285}01285 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01286}01286 \textcolor{comment}{    /// Number of 'flux' terms for Z2 error estimation: Error estimation}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01287}01287 \textcolor{comment}{    /// is based on error in BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01288}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a577241e74df25b8548f475bf4a9fffa7}{01288}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a577241e74df25b8548f475bf4a9fffa7}{num\_Z2\_flux\_terms}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01289}01289     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01290}01290       \textcolor{keywordflow}{return} BASIC::num\_Z2\_flux\_terms();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01291}01291     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01292}01292 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01293}01293 \textcolor{comment}{    /// 'Flux' vector for Z2 error estimation: Error estimation}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01294}01294 \textcolor{comment}{    /// is based on error in BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01295}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_acbe1e5ee654278e79ccc9bfa25ab7891}{01295}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_acbe1e5ee654278e79ccc9bfa25ab7891}{get\_Z2\_flux}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& flux)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01296}01296     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01297}01297       BASIC::get\_Z2\_flux(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, flux);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01298}01298     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01299}01299 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01300}01300 \textcolor{comment}{    /// Perform additional hanging node procedures for variables}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01301}01301 \textcolor{comment}{    /// that are not interpolated by all nodes. Done for both of the}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01302}01302 \textcolor{comment}{    /// underlying element types.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01303}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a7f2375e2097699d5a175db3bc9f6b868}{01303}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a7f2375e2097699d5a175db3bc9f6b868}{further\_setup\_hanging\_nodes}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01304}01304     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01305}01305       BASIC::further\_setup\_hanging\_nodes();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01306}01306       SOLID::further\_setup\_hanging\_nodes();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01307}01307     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01308}01308 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01309}01309 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01310}01310 \textcolor{comment}{    /// Build function: Call the one for the SOLID element since it}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01311}01311 \textcolor{comment}{    /// calls the one basic build function automatically.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01312}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a9997600d809a1fb258ca8958d2f43f15}{01312}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a9997600d809a1fb258ca8958d2f43f15}{build}}(\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01313}01313                \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}\& new\_node\_pt,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01314}01314                \textcolor{keywordtype}{bool}\& was\_already\_built,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01315}01315                std::ofstream\& new\_nodes\_file)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01316}01316     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01317}01317       SOLID::build(mesh\_pt, new\_node\_pt, was\_already\_built, new\_nodes\_file);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01318}01318     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01319}01319 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01320}01320 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01321}01321 \textcolor{comment}{    /// Build function: Call the one for the SOLID element since it}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01322}01322 \textcolor{comment}{    /// calls the one basic build function automatically.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01323}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a639b081f80df731cb5047401cfd41d40}{01323}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a639b081f80df731cb5047401cfd41d40}{build}}(\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01324}01324                \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}\& new\_node\_pt,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01325}01325                \textcolor{keywordtype}{bool}\& was\_already\_built)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01326}01326     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01327}01327       SOLID::build(mesh\_pt, new\_node\_pt, was\_already\_built);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01328}01328     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01329}01329 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01330}01330 \textcolor{comment}{    ///  Further build: Done for both of the}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01331}01331 \textcolor{comment}{    /// underlying element types.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01332}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a19e2a578e4d8a0e08041e2a0cf33d06f}{01332}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a19e2a578e4d8a0e08041e2a0cf33d06f}{further\_build}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01333}01333     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01334}01334       BASIC::further\_build();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01335}01335       SOLID::further\_build();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01336}01336     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01337}01337 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01338}01338 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01339}01339 \textcolor{comment}{    /// Number of vertex nodes in the element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01340}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a2d8820cdbca56cf4c913b8d1baab7102}{01340}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a2d8820cdbca56cf4c913b8d1baab7102}{nvertex\_node}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01341}01341 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01342}01342       \textcolor{keywordflow}{return} BASIC::nvertex\_node();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01343}01343     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01344}01344 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01345}01345 \textcolor{comment}{    /// Pointer to the j-\/th vertex node in the element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01346}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ab81f61455f32959dd8da1993195379bd}{01346}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_ab81f61455f32959dd8da1993195379bd}{vertex\_node\_pt}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01347}01347 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01348}01348       \textcolor{keywordflow}{return} BASIC::vertex\_node\_pt(j);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01349}01349     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01350}01350 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01351}01351 \textcolor{comment}{    /// Compute norm of solution. Use version in BASIC element.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01352}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a2a7fb32ce6b9b442f7b328d382ff017a}{01352}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a2a7fb32ce6b9b442f7b328d382ff017a}{compute\_norm}}(\textcolor{keywordtype}{double}\& norm)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01353}01353     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01354}01354       BASIC::compute\_norm(norm);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01355}01355     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01356}01356 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01357}01357 \textcolor{comment}{    /// Plot the error when compared against a given exact flux.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01358}01358 \textcolor{comment}{    /// Also calculates the norm of the error and that of the exact flux.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01359}01359 \textcolor{comment}{    /// Use version in BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01360}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a566d35b215a97e63ce6ebba0e94631b9}{01360}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a566d35b215a97e63ce6ebba0e94631b9}{compute\_exact\_Z2\_error}}(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01361}01361       std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01362}01362       \mbox{\hyperlink{classoomph_1_1FiniteElement_a690fd33af26cc3e84f39bba6d5a85202}{FiniteElement::SteadyExactSolutionFctPt}} exact\_flux\_pt,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01363}01363       \textcolor{keywordtype}{double}\& error,}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01364}01364       \textcolor{keywordtype}{double}\& norm)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01365}01365     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01366}01366       BASIC::compute\_exact\_Z2\_error(outfile, exact\_flux\_pt, error, norm);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01367}01367     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01368}01368 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01369}01369 \textcolor{comment}{    /// Order of recovery shape functions for Z2 error estimation: Done}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01370}01370 \textcolor{comment}{    /// for BASIC element since it determines the refinement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01371}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a3947be55246e7cbaa127057db8881858}{01371}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a3947be55246e7cbaa127057db8881858}{nrecovery\_order}}()}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01372}01372     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01373}01373       \textcolor{keywordflow}{return} BASIC::nrecovery\_order();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01374}01374     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01375}01375 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01376}01376 \textcolor{comment}{    /// Overload the output function: Use that of the BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01377}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a88f2bf6d044bc9b768afaba1368c0c18}{01377}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a88f2bf6d044bc9b768afaba1368c0c18}{output}}(std::ostream\& outfile)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01378}01378     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01379}01379       \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{BASIC::output}}(outfile);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01380}01380     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01381}01381 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01382}01382 \textcolor{comment}{    /// Output function, plotting at n\_p points: Use that of the BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01383}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a41c401315754cb1d5f3f8b827215eaf4}{01383}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a41c401315754cb1d5f3f8b827215eaf4}{output}}(std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_p)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01384}01384     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01385}01385       \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{BASIC::output}}(outfile, n\_p);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01386}01386     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01387}01387 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01388}01388 \textcolor{comment}{    /// Overload the output function: Use that of the BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01389}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a1fc357bd2adafd81683163f42e2dfd61}{01389}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a1fc357bd2adafd81683163f42e2dfd61}{output}}(FILE* file\_pt)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01390}01390     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01391}01391       \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{BASIC::output}}(file\_pt);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01392}01392     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01393}01393 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01394}01394 \textcolor{comment}{    /// Output function: Use that of the BASIC element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01395}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a9393711c3d4c4cf5a7142b9dd99d3baa}{01395}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a9393711c3d4c4cf5a7142b9dd99d3baa}{output}}(FILE* file\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_p)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01396}01396     \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01397}01397       \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{BASIC::output}}(file\_pt, n\_p);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01398}01398     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01399}01399 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01400}01400 \textcolor{comment}{    /// The number of "{}DOF types"{} that degrees of freedom in this element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01401}01401 \textcolor{comment}{    /// are sub-\/divided into.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01402}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a04cbdc63d7d79c04ed80b7a0903e8199}{01402}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a04cbdc63d7d79c04ed80b7a0903e8199}{ndof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01403}01403 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01404}01404       \textcolor{keywordflow}{return} BASIC::ndof\_types() + SOLID::ndof\_types();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01405}01405     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01406}01406 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01407}01407 \textcolor{comment}{    /// return the number of DOF types associated with the BASIC}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01408}01408 \textcolor{comment}{    /// elements in this combined element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01409}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a029f632bdb246c67eb49b7803fd40ab1}{01409}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a029f632bdb246c67eb49b7803fd40ab1}{nbasic\_dof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01410}01410 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01411}01411       \textcolor{keywordflow}{return} BASIC::ndof\_types();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01412}01412     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01413}01413 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01414}01414 \textcolor{comment}{    /// return the number of DOF types associated with the SOLID}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01415}01415 \textcolor{comment}{    /// elements in this combined element}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01416}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a5361a31f5a74d4779dbf1e074e08a4f2}{01416}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a5361a31f5a74d4779dbf1e074e08a4f2}{nsolid\_dof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01417}01417 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01418}01418       \textcolor{keywordflow}{return} SOLID::ndof\_types();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01419}01419     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01420}01420 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01421}01421 \textcolor{comment}{    /// Create a list of pairs for all unknowns in this element,}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01422}01422 \textcolor{comment}{    /// so that the first entry in each pair contains the global equation}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01423}01423 \textcolor{comment}{    /// number of the unknown, while the second one contains the number}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01424}01424 \textcolor{comment}{    /// of the "{}DOF type"{} that this unknown is associated with.}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01425}01425 \textcolor{comment}{    /// This method combines the get\_dof\_numbers\_for\_unknowns(...)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01426}01426 \textcolor{comment}{    /// method for the BASIC and SOLID elements. The basic elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01427}01427 \textcolor{comment}{    /// retain their DOF type numbering and the SOLID elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01428}01428 \textcolor{comment}{    /// DOF type numbers are incremented by nbasic\_dof\_types().}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01429}\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a4b59bb716a54bc8d174d68f2ed70e151}{01429}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a4b59bb716a54bc8d174d68f2ed70e151}{get\_dof\_numbers\_for\_unknowns}}(}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01430}01430       std::list<std::pair<unsigned long, unsigned>>\& dof\_lookup\_list)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01431}01431 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01432}01432       \textcolor{comment}{// get the solid list}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01433}01433       std::list<std::pair<unsigned long, unsigned>> solid\_list;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01434}01434       SOLID::get\_dof\_numbers\_for\_unknowns(solid\_list);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01435}01435 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01436}01436       \textcolor{comment}{// get the basic list}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01437}01437       BASIC::get\_dof\_numbers\_for\_unknowns(dof\_lookup\_list);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01438}01438 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01439}01439       \textcolor{comment}{// get the number of basic dof types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01440}01440       \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a029f632bdb246c67eb49b7803fd40ab1}{nbasic\_dof\_types}} = BASIC::ndof\_types();}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01441}01441 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01442}01442       \textcolor{comment}{// add the solid lookup list to the basic lookup list}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01443}01443       \textcolor{comment}{// incrementing the solid dof numbers by nbasic\_dof\_types}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01444}01444       \textcolor{keyword}{typedef} std::list<std::pair<unsigned long, unsigned>>::iterator IT;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01445}01445       \textcolor{keywordflow}{for} (IT it = solid\_list.begin(); it != solid\_list.end(); it++)}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01446}01446       \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01447}01447         std::pair<unsigned long, unsigned> new\_pair;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01448}01448         new\_pair.first = it-\/>first;}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01449}01449         new\_pair.second = it-\/>second + \mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement_a029f632bdb246c67eb49b7803fd40ab1}{nbasic\_dof\_types}};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01450}01450         dof\_lookup\_list.push\_front(new\_pair);}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01451}01451       \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01452}01452     \}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01453}01453   \};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01454}01454 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01455}01455 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01456}01456 \textcolor{comment}{  /// Explicit definition of the face geometry of these elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01457}01457 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keyword}{class} BASIC, \textcolor{keyword}{class} SOLID>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01458}\mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01RefineablePseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4}{01458}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement}{RefineablePseudoSolidNodeUpdateElement}}<BASIC, SOLID>>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01459}01459     : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<SOLID>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01460}01460   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01461}01461   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01462}01462 \textcolor{comment}{    /// Constructor calls the constructor of the SolidQElement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01463}01463 \textcolor{comment}{    /// (Only the Intel compiler seems to need this!)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01464}\mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01RefineablePseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_aa03d04632af1d3cdb9b98f85a2a1a344}{01464}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01RefineablePseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_aa03d04632af1d3cdb9b98f85a2a1a344}{FaceGeometry}}() : \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<SOLID>() \{\}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01465}01465 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01466}01466   \textcolor{keyword}{protected}:}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01467}01467   \};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01468}01468 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01469}01469 \textcolor{comment}{  /// Explicit definition of the face geometry of these elements}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01470}01470 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keyword}{class} BASIC, \textcolor{keyword}{class} SOLID>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01471}\mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01RefineablePseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_01_4}{01471}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01472}01472     \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<\mbox{\hyperlink{classoomph_1_1RefineablePseudoSolidNodeUpdateElement}{RefineablePseudoSolidNodeUpdateElement}}<BASIC, SOLID>>>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01473}01473     : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<FaceGeometry<SOLID>>}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01474}01474   \{}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01475}01475   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01476}01476 \textcolor{comment}{    /// Constuctor calls the constructor of the SolidQElement}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01477}01477 \textcolor{comment}{    /// (Only the Intel compiler seems to need this!)}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01478}\mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01RefineablePseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_01_4_adc2b1a8073ce32b62d259c1e032c19d9}{01478}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1FaceGeometry_3_01FaceGeometry_3_01RefineablePseudoSolidNodeUpdateElement_3_01BASIC_00_01SOLID_01_4_01_4_01_4_adc2b1a8073ce32b62d259c1e032c19d9}{FaceGeometry}}() : \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<\mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<SOLID>>() \{\}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01479}01479 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01480}01480   \textcolor{keyword}{protected}:}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01481}01481   \};}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01482}01482 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01483}01483 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01484}01484 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01485}01485 }
\DoxyCodeLine{\Hypertarget{pseudosolid__node__update__elements_8h_source_l01486}01486 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

\hypertarget{axisym__navier__stokes__elements_8cc_source}{}\doxysection{axisym\+\_\+navier\+\_\+stokes\+\_\+elements.\+cc}
\label{axisym__navier__stokes__elements_8cc_source}\index{axisym\_navier\_stokes\_elements.cc@{axisym\_navier\_stokes\_elements.cc}}
\mbox{\hyperlink{axisym__navier__stokes__elements_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00026}00026 \textcolor{comment}{// Non-\/inline functions for NS elements}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00027}00027 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{axisym__navier__stokes__elements_8h}{axisym\_navier\_stokes\_elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00030}00030 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00031}00031 \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00032}00032 \textcolor{comment}{  /// Navier-\/-\/Stokes equations static data}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00033}00033 \textcolor{comment}{}  Vector<double> AxisymmetricNavierStokesEquations::Gamma(2, 1.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00035}00035   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00036}00036 \textcolor{comment}{  /// "{}Magic"{} negative number that indicates that the pressure is}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00037}00037 \textcolor{comment}{  /// not stored at a node. This cannot be -\/1 because that represents}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00038}00038 \textcolor{comment}{  /// the positional hanging scheme in the hanging\_pt object of nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00039}00039 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00040}00040   \textcolor{keywordtype}{int} AxisymmetricNavierStokesEquations::Pressure\_not\_stored\_at\_node = -\/100;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00041}00041 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00042}00042 \textcolor{comment}{  /// Navier-\/-\/Stokes equations static data}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00043}00043 \textcolor{comment}{}  \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_1_1MultiDomainBoussinesqHelper_ae77c07b69cffe295ac07e2c25c31a8aa}{AxisymmetricNavierStokesEquations::Default\_Physical\_Constant\_Value}} =}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00044}00044     0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00046}00046   \textcolor{comment}{// Navier-\/-\/Stokes equations static data}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00047}00047   \textcolor{keywordtype}{double} AxisymmetricNavierStokesEquations::Default\_Physical\_Ratio\_Value = 1.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00048}00048 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00049}00049 \textcolor{comment}{  /// Navier-\/Stokes equations default gravity vector}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00050}00050 \textcolor{comment}{}  Vector<double> AxisymmetricNavierStokesEquations::Default\_Gravity\_vector(3,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00051}00051                                                                            0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00054}00054   \textcolor{comment}{//================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00055}00055 \textcolor{comment}{  /// Compute the diagonal of the velocity/pressure mass matrices.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00056}00056 \textcolor{comment}{  /// If which one=0, both are computed, otherwise only the pressure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00057}00057 \textcolor{comment}{  /// (which\_one=1) or the velocity mass matrix (which\_one=2 -\/-\/ the}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00058}00058 \textcolor{comment}{  /// LSC version of the preconditioner only needs that one)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00059}00059 \textcolor{comment}{  /// NOTE: pressure versions isn't implemented yet because this}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00060}00060 \textcolor{comment}{  ///       element has never been tried with Fp preconditoner.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00061}00061 \textcolor{comment}{}  \textcolor{comment}{//================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00062}00062   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00063}00063     get\_pressure\_and\_velocity\_mass\_matrix\_diagonal(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00064}00064       Vector<double>\& press\_mass\_diag,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00065}00065       Vector<double>\& veloc\_mass\_diag,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00066}00066       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& which\_one)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00067}00067   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00068}00068 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00069}00069     \textcolor{keywordflow}{if} ((which\_one == 0) || (which\_one == 1))}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00070}00070     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00071}00071       \textcolor{keywordflow}{throw} OomphLibError(\textcolor{stringliteral}{"{}Computation of diagonal of pressure mass matrix is "{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00072}00072                           \textcolor{stringliteral}{"{}not impmented yet.\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00073}00073                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00074}00074                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00075}00075     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00076}00076 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00078}00078     \textcolor{comment}{// Resize and initialise}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00079}00079     veloc\_mass\_diag.assign(ndof(), 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00081}00081     \textcolor{comment}{// find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00082}00082     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00083}00083 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00084}00084     \textcolor{comment}{// find number of coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00085}00085     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = 3;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00087}00087     \textcolor{comment}{// find the indices at which the local velocities are stored}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00088}00088     Vector<unsigned> u\_nodal\_index(n\_value);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00089}00089     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_value; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00090}00090     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00091}00091       u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = this-\/>u\_index\_axi\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00092}00092     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00094}00094     \textcolor{comment}{// Set up memory for test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00095}00095     Shape test(n\_node);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00097}00097     \textcolor{comment}{// Number of integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00098}00098     \textcolor{keywordtype}{unsigned} n\_intpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00099}00099 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00100}00100     \textcolor{comment}{// Integer to store the local equations no}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00101}00101     \textcolor{keywordtype}{int} local\_eqn = 0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00103}00103     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00104}00104     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00105}00105     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00106}00106       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00107}00107       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00109}00109       \textcolor{comment}{// Get determinant of Jacobian of the mapping}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00110}00110       \textcolor{keywordtype}{double} J = J\_eulerian\_at\_knot(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00111}00111 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00112}00112       \textcolor{comment}{// Premultiply weights and Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00113}00113       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00114}00114 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00115}00115       \textcolor{comment}{// Get the velocity test functions -\/ there is no explicit}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00116}00116       \textcolor{comment}{// function to give the test function so use shape}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00117}00117       shape\_at\_knot(ipt, test);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00119}00119       \textcolor{comment}{// Need to get the position to sort out the jacobian properly}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00120}00120       \textcolor{keywordtype}{double} r = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00121}00121       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00122}00122       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00123}00123         r += this-\/>nodal\_position(l, 0) * test(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00124}00124       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00125}00125 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00126}00126       \textcolor{comment}{// Multiply by the geometric factor}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00127}00127       \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} *= r;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00129}00129       \textcolor{comment}{// Loop over the veclocity test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00130}00130       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00131}00131       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00132}00132         \textcolor{comment}{// Loop over the velocity components}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00133}00133         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_value; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00134}00134         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00135}00135           local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00137}00137           \textcolor{comment}{// If not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00138}00138           \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00139}00139           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00140}00140             \textcolor{comment}{// Add the contribution}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00141}00141             veloc\_mass\_diag[local\_eqn] += test[l] * test[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00142}00142           \} \textcolor{comment}{// End of if not boundary condition statement}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00143}00143         \} \textcolor{comment}{// End of loop over dimension}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00144}00144       \} \textcolor{comment}{// End of loop over test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00145}00145     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00146}00146   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00148}00148 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00149}00149   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00150}00150 \textcolor{comment}{  /// Validate against exact velocity solution at given time.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00151}00151 \textcolor{comment}{  /// Solution is provided via function pointer.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00152}00152 \textcolor{comment}{  /// Plot at a given number of plot points and compute L2 error}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00153}00153 \textcolor{comment}{  /// and L2 norm of velocity solution over element.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00154}00154 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00155}00155   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::compute\_error(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00156}00156     std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00157}00157     \mbox{\hyperlink{classoomph_1_1FiniteElement_ad4ecf2b61b158a4b4d351a60d23c633e}{FiniteElement::UnsteadyExactSolutionFctPt}} exact\_soln\_pt,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00158}00158     \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& time,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00159}00159     \textcolor{keywordtype}{double}\& error,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00160}00160     \textcolor{keywordtype}{double}\& norm)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00161}00161   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00162}00162     error = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00163}00163     norm = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00164}00164 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00165}00165     \textcolor{comment}{// Vector of local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00166}00166     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00167}00167 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00168}00168     \textcolor{comment}{// Vector for coordintes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00169}00169     Vector<double> \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00170}00170 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00171}00171     \textcolor{comment}{// Set the value of Nintpt}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00172}00172     \textcolor{keywordtype}{unsigned} Nintpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00174}00174     outfile << \textcolor{stringliteral}{"{}ZONE"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00176}00176     \textcolor{comment}{// Exact solution Vector (u,v,w,p)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00177}00177     Vector<double> exact\_soln(4);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00178}00178 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00179}00179     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00180}00180     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < Nintpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00181}00181     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00182}00182       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00183}00183       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00184}00184       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00185}00185         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00186}00186       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00187}00187 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00188}00188       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00189}00189       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00190}00190 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00191}00191       \textcolor{comment}{// Get jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00192}00192       \textcolor{keywordtype}{double} J = J\_eulerian(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00193}00193 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00194}00194       \textcolor{comment}{// Get x position as Vector}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00195}00195       interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00197}00197       \textcolor{comment}{// Premultiply the weights and the Jacobian and r}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00198}00198       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} = w * J * \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[0];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00200}00200       \textcolor{comment}{// Get exact solution at this point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00201}00201       (*exact\_soln\_pt)(time, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, exact\_soln);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00203}00203       \textcolor{comment}{// Velocity error}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00204}00204       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00205}00205       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00206}00206         norm += exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00207}00207         error += (exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00208}00208                  (exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00209}00209       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00210}00210 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00211}00211       \textcolor{comment}{// Output x,y,...,u\_exact}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00212}00212       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00213}00213       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00214}00214         outfile << \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00215}00215       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00216}00216 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00217}00217       \textcolor{comment}{// Output x,y,[z],u\_error,v\_error,[w\_error]}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00218}00218       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00219}00219       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00220}00220         outfile << exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00221}00221       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00222}00222 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00223}00223       outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00224}00224     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00225}00225   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00226}00226 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00227}00227   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00228}00228 \textcolor{comment}{  /// Validate against exact velocity solution}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00229}00229 \textcolor{comment}{  /// Solution is provided via function pointer.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00230}00230 \textcolor{comment}{  /// Plot at a given number of plot points and compute L2 error}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00231}00231 \textcolor{comment}{  /// and L2 norm of velocity solution over element.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00232}00232 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00233}00233   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::compute\_error(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00234}00234     std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00235}00235     \mbox{\hyperlink{classoomph_1_1FiniteElement_a690fd33af26cc3e84f39bba6d5a85202}{FiniteElement::SteadyExactSolutionFctPt}} exact\_soln\_pt,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00236}00236     \textcolor{keywordtype}{double}\& error,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00237}00237     \textcolor{keywordtype}{double}\& norm)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00238}00238   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00239}00239     error = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00240}00240     norm = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00241}00241 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00242}00242     \textcolor{comment}{// Vector of local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00243}00243     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00244}00244 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00245}00245     \textcolor{comment}{// Vector for coordintes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00246}00246     Vector<double> \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00247}00247 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00248}00248     \textcolor{comment}{// Set the value of Nintpt}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00249}00249     \textcolor{keywordtype}{unsigned} Nintpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00251}00251     outfile << \textcolor{stringliteral}{"{}ZONE"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00253}00253     \textcolor{comment}{// Exact solution Vector (u,v,w,p)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00254}00254     Vector<double> exact\_soln(4);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00256}00256     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00257}00257     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < Nintpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00258}00258     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00259}00259       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00260}00260       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00261}00261       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00262}00262         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00263}00263       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00264}00264 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00265}00265       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00266}00266       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00267}00267 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00268}00268       \textcolor{comment}{// Get jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00269}00269       \textcolor{keywordtype}{double} J = J\_eulerian(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00271}00271       \textcolor{comment}{// Get x position as Vector}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00272}00272       interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00273}00273 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00274}00274       \textcolor{comment}{// Premultiply the weights and the Jacobian and r}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00275}00275       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} = w * J * \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[0];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00276}00276 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00277}00277       \textcolor{comment}{// Get exact solution at this point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00278}00278       (*exact\_soln\_pt)(\mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, exact\_soln);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00279}00279 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00280}00280       \textcolor{comment}{// Velocity error}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00281}00281       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00282}00282       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00283}00283         norm += exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00284}00284         error += (exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00285}00285                  (exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00286}00286       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00287}00287 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00288}00288       \textcolor{comment}{// Output x,y,...,u\_exact}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00289}00289       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00290}00290       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00291}00291         outfile << \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00292}00292       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00293}00293 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00294}00294       \textcolor{comment}{// Output x,y,u\_error,v\_error,w\_error}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00295}00295       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00296}00296       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00297}00297         outfile << exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00298}00298       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00299}00299 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00300}00300       outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00301}00301     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00302}00302   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00303}00303 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00304}00304   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00305}00305 \textcolor{comment}{  /// Output "{}exact"{} solution}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00306}00306 \textcolor{comment}{  /// Solution is provided via function pointer.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00307}00307 \textcolor{comment}{  /// Plot at a given number of plot points.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00308}00308 \textcolor{comment}{  /// Function prints as many components as are returned in solution Vector.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00309}00309 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00310}00310   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::output\_fct(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00311}00311     std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00312}00312     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00313}00313     \mbox{\hyperlink{classoomph_1_1FiniteElement_a690fd33af26cc3e84f39bba6d5a85202}{FiniteElement::SteadyExactSolutionFctPt}} exact\_soln\_pt)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00314}00314   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00315}00315     \textcolor{comment}{// Vector of local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00316}00316     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00317}00317 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00318}00318     \textcolor{comment}{// Vector for coordintes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00319}00319     Vector<double> \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00320}00320 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00321}00321     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00322}00322     outfile << tecplot\_zone\_string(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00324}00324     \textcolor{comment}{// Exact solution Vector}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00325}00325     Vector<double> exact\_soln;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00327}00327     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00328}00328     \textcolor{keywordtype}{unsigned} num\_plot\_points = nplot\_points(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00329}00329     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} iplot = 0; iplot < num\_plot\_points; iplot++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00330}00330     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00331}00331       \textcolor{comment}{// Get local coordinates of plot point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00332}00332       get\_s\_plot(iplot, nplot, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00333}00333 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00334}00334       \textcolor{comment}{// Get x position as Vector}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00335}00335       interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00336}00336 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00337}00337       \textcolor{comment}{// Get exact solution at this point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00338}00338       (*exact\_soln\_pt)(\mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, exact\_soln);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00339}00339 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00340}00340       \textcolor{comment}{// Output x,y,...}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00341}00341       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00342}00342       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00343}00343         outfile << \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00344}00344       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00346}00346       \textcolor{comment}{// Output "{}exact solution"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00347}00347       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < exact\_soln.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00348}00348       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00349}00349         outfile << exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00350}00350       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00352}00352       outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00353}00353     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00354}00354 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00355}00355     \textcolor{comment}{// Write tecplot footer (e.g. FE connectivity lists)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00356}00356     write\_tecplot\_zone\_footer(outfile, nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00357}00357   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00358}00358 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00359}00359   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00360}00360 \textcolor{comment}{  /// Output "{}exact"{} solution at a given time}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00361}00361 \textcolor{comment}{  /// Solution is provided via function pointer.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00362}00362 \textcolor{comment}{  /// Plot at a given number of plot points.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00363}00363 \textcolor{comment}{  /// Function prints as many components as are returned in solution Vector.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00364}00364 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00365}00365   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::output\_fct(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00366}00366     std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00367}00367     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00368}00368     \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& time,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00369}00369     \mbox{\hyperlink{classoomph_1_1FiniteElement_ad4ecf2b61b158a4b4d351a60d23c633e}{FiniteElement::UnsteadyExactSolutionFctPt}} exact\_soln\_pt)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00370}00370   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00371}00371     \textcolor{comment}{// Vector of local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00372}00372     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00374}00374     \textcolor{comment}{// Vector for coordintes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00375}00375     Vector<double> \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00377}00377     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00378}00378     outfile << tecplot\_zone\_string(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00379}00379 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00380}00380     \textcolor{comment}{// Exact solution Vector}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00381}00381     Vector<double> exact\_soln;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00383}00383     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00384}00384     \textcolor{keywordtype}{unsigned} num\_plot\_points = nplot\_points(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00385}00385     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} iplot = 0; iplot < num\_plot\_points; iplot++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00386}00386     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00387}00387       \textcolor{comment}{// Get local coordinates of plot point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00388}00388       get\_s\_plot(iplot, nplot, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00389}00389 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00390}00390       \textcolor{comment}{// Get x position as Vector}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00391}00391       interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00393}00393       \textcolor{comment}{// Get exact solution at this point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00394}00394       (*exact\_soln\_pt)(time, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, exact\_soln);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00395}00395 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00396}00396       \textcolor{comment}{// Output x,y,...}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00397}00397       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00398}00398       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00399}00399         outfile << \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00400}00400       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00401}00401 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00402}00402       \textcolor{comment}{// Output "{}exact solution"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00403}00403       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < exact\_soln.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00404}00404       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00405}00405         outfile << exact\_soln[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00406}00406       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00408}00408       outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00409}00409     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00410}00410 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00411}00411     \textcolor{comment}{// Write tecplot footer (e.g. FE connectivity lists)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00412}00412     write\_tecplot\_zone\_footer(outfile, nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00413}00413   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00414}00414 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00415}00415   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00416}00416 \textcolor{comment}{  /// Output function: Velocities only}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00417}00417 \textcolor{comment}{  /// x,y,[z],u,v,[w]}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00418}00418 \textcolor{comment}{  /// in tecplot format at specified previous timestep (t=0: present;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00419}00419 \textcolor{comment}{  /// t>0: previous timestep). Specified number of plot points in each}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00420}00420 \textcolor{comment}{  /// coordinate direction.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00421}00421 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00422}00422   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::output\_veloc(std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00423}00423                                                        \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00424}00424                                                        \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}})}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00425}00425   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00426}00426     \textcolor{comment}{// Find number of nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00427}00427     \textcolor{keywordtype}{unsigned} n\_node = nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00428}00428 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00429}00429     \textcolor{comment}{// Local shape function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00430}00430     Shape psi(n\_node);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00431}00431 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00432}00432     \textcolor{comment}{// Vectors of local coordinates and coords and velocities}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00433}00433     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00434}00434     Vector<double> interpolated\_x(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00435}00435     Vector<double> interpolated\_u(3);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00436}00436 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00437}00437 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00438}00438     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00439}00439     outfile << tecplot\_zone\_string(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00440}00440 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00441}00441     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00442}00442     \textcolor{keywordtype}{unsigned} num\_plot\_points = nplot\_points(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00443}00443     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} iplot = 0; iplot < num\_plot\_points; iplot++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00444}00444     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00445}00445       \textcolor{comment}{// Get local coordinates of plot point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00446}00446       get\_s\_plot(iplot, nplot, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00447}00447 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00448}00448       \textcolor{comment}{// Get shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00449}00449       \mbox{\hyperlink{namespaceoomph_1_1OneDimLagrange_a117f8b892dc89989ecdad99ff261e120}{shape}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00450}00450 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00451}00451       \textcolor{comment}{// Loop over coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00452}00452       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00453}00453       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00454}00454         interpolated\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00455}00455         \textcolor{comment}{// Loop over the local nodes and sum}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00456}00456         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00457}00457         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00458}00458           interpolated\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += nodal\_position(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psi[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00459}00459         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00460}00460       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00462}00462       \textcolor{comment}{// Loop over the velocity components}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00463}00463       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00464}00464       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00465}00465         \textcolor{comment}{// Get the index at which the velocity is stored}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00466}00466         \textcolor{keywordtype}{unsigned} u\_nodal\_index = u\_index\_axi\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00467}00467         interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00468}00468         \textcolor{comment}{// Loop over the local nodes and sum}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00469}00469         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00470}00470         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00471}00471           interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += nodal\_value(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, l, u\_nodal\_index) * psi[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00472}00472         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00473}00473       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00475}00475       \textcolor{comment}{// Coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00476}00476       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00477}00477       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00478}00478         outfile << interpolated\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00479}00479       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00480}00480 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00481}00481       \textcolor{comment}{// Velocities}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00482}00482       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00483}00483       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00484}00484         outfile << interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00485}00485       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00486}00486 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00487}00487       outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00488}00488     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00489}00489 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00490}00490     \textcolor{comment}{// Write tecplot footer (e.g. FE connectivity lists)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00491}00491     write\_tecplot\_zone\_footer(outfile, nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00492}00492   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00493}00493 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00494}00494   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00495}00495 \textcolor{comment}{  /// Output function:}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00496}00496 \textcolor{comment}{  /// r,z,u,v,w,p}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00497}00497 \textcolor{comment}{  /// in tecplot format. Specified number of plot points in each}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00498}00498 \textcolor{comment}{  /// coordinate direction.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00499}00499 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00500}00500   \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{AxisymmetricNavierStokesEquations::output}}(std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00501}00501                                                  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00502}00502   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00503}00503     \textcolor{comment}{// Vector of local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00504}00504     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00505}00505 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00506}00506     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00507}00507     outfile << tecplot\_zone\_string(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00508}00508 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00509}00509     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00510}00510     \textcolor{keywordtype}{unsigned} num\_plot\_points = nplot\_points(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00511}00511     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} iplot = 0; iplot < num\_plot\_points; iplot++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00512}00512     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00513}00513       \textcolor{comment}{// Get local coordinates of plot point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00514}00514       get\_s\_plot(iplot, nplot, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00515}00515 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00516}00516       \textcolor{comment}{// Coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00517}00517       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00518}00518       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00519}00519         outfile << interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00520}00520       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00521}00521 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00522}00522       \textcolor{comment}{// Velocities}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00523}00523       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00524}00524       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00525}00525         outfile << interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00526}00526       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00528}00528       \textcolor{comment}{// Pressure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00529}00529       outfile << interpolated\_p\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00530}00530 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00531}00531       outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00532}00532     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00533}00533     outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00534}00534 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00535}00535     \textcolor{comment}{// Write tecplot footer (e.g. FE connectivity lists)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00536}00536     write\_tecplot\_zone\_footer(outfile, nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00537}00537   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00538}00538 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00539}00539 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00540}00540   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00541}00541 \textcolor{comment}{  /// Output function:}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00542}00542 \textcolor{comment}{  /// r,z,u,v,w,p}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00543}00543 \textcolor{comment}{  /// in tecplot format. Specified number of plot points in each}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00544}00544 \textcolor{comment}{  /// coordinate direction.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00545}00545 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00546}00546   \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{AxisymmetricNavierStokesEquations::output}}(FILE* file\_pt,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00547}00547                                                  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00548}00548   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00549}00549     \textcolor{comment}{// Vector of local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00550}00550     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00551}00551 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00552}00552     \textcolor{comment}{// Tecplot header info}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00553}00553     fprintf(file\_pt, \textcolor{stringliteral}{"{}\%s "{}}, tecplot\_zone\_string(nplot).c\_str());}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00554}00554 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00555}00555     \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00556}00556     \textcolor{keywordtype}{unsigned} num\_plot\_points = nplot\_points(nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00557}00557     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} iplot = 0; iplot < num\_plot\_points; iplot++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00558}00558     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00559}00559       \textcolor{comment}{// Get local coordinates of plot point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00560}00560       get\_s\_plot(iplot, nplot, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00561}00561 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00562}00562       \textcolor{comment}{// Coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00563}00563       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00564}00564       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00565}00565         \textcolor{comment}{// outfile << interpolated\_x(s,i) << "{} "{};}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00566}00566         fprintf(file\_pt, \textcolor{stringliteral}{"{}\%g "{}}, interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00567}00567       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00569}00569       \textcolor{comment}{// Velocities}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00570}00570       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00571}00571       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00572}00572         \textcolor{comment}{// outfile << interpolated\_u(s,i) << "{} "{};}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00573}00573         fprintf(file\_pt, \textcolor{stringliteral}{"{}\%g "{}}, interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00574}00574       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00575}00575 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00576}00576       \textcolor{comment}{// Pressure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00577}00577       \textcolor{comment}{// outfile << interpolated\_p(s)  << "{} "{};}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00578}00578       fprintf(file\_pt, \textcolor{stringliteral}{"{}\%g "{}}, interpolated\_p\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00579}00579 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00580}00580       \textcolor{comment}{// outfile << std::endl;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00581}00581       fprintf(file\_pt, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00582}00582     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00583}00583     \textcolor{comment}{// outfile << std::endl;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00584}00584     fprintf(file\_pt, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00585}00585 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00586}00586     \textcolor{comment}{// Write tecplot footer (e.g. FE connectivity lists)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00587}00587     write\_tecplot\_zone\_footer(file\_pt, nplot);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00588}00588   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00589}00589 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00590}00590 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00591}00591   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00592}00592 \textcolor{comment}{  /// Return integral of dissipation over element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00593}00593 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00594}00594   \textcolor{keywordtype}{double} AxisymmetricNavierStokesEquations::dissipation()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00595}00595 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00596}00596     \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00597}00597       \textcolor{stringliteral}{"{}Check the dissipation calculation for axisymmetric NSt"{}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00598}00598       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00599}00599       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00600}00600 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00601}00601     \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00602}00602     \textcolor{keywordtype}{double} diss = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00603}00603 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00604}00604     \textcolor{comment}{// Set the value of Nintpt}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00605}00605     \textcolor{keywordtype}{unsigned} Nintpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00606}00606 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00607}00607     \textcolor{comment}{// Set the Vector to hold local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00608}00608     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00609}00609 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00610}00610     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00611}00611     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < Nintpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00612}00612     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00613}00613       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00614}00614       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00615}00615       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00616}00616         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00617}00617       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00618}00618 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00619}00619       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00620}00620       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00621}00621 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00622}00622       \textcolor{comment}{// Get Jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00623}00623       \textcolor{keywordtype}{double} J = J\_eulerian(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00624}00624 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00625}00625       \textcolor{comment}{// Get strain rate matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00626}00626       DenseMatrix<double> strainrate(3, 3);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00627}00627       strain\_rate(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, strainrate);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00628}00628 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00629}00629       \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00630}00630       \textcolor{keywordtype}{double} local\_diss = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00631}00631       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00632}00632       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00633}00633         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00634}00634         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00635}00635           local\_diss += 2.0 * strainrate(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) * strainrate(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00636}00636         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00637}00637       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00638}00638 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00639}00639       diss += local\_diss * w * J;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00640}00640     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00641}00641 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00642}00642     \textcolor{keywordflow}{return} diss;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00643}00643   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00644}00644 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00645}00645   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00646}00646 \textcolor{comment}{  /// Compute traction (on the viscous scale) at local}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00647}00647 \textcolor{comment}{  /// coordinate s for outer unit normal N}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00648}00648 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00649}00649   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::traction(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00650}00650     \textcolor{keyword}{const} Vector<double>\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00651}00651     \textcolor{keyword}{const} Vector<double>\& \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00652}00652     Vector<double>\& traction)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00653}00653 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00654}00654     \textcolor{comment}{// throw OomphLibError(}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00655}00655     \textcolor{comment}{// "{}Check the traction calculation for axisymmetric NSt"{},}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00656}00656     \textcolor{comment}{// OOMPH\_CURRENT\_FUNCTION,}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00657}00657     \textcolor{comment}{// OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00658}00658 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00659}00659     \textcolor{comment}{// Pad out normal vector if required}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00660}00660     Vector<double> n\_local(3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00661}00661     n\_local[0] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[0];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00662}00662     n\_local[1] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[1];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00663}00663 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00664}00664 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00665}00665     \textcolor{keywordflow}{if} ((\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}.size() == 3) \&\& (\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}[2] != 0.0))}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00666}00666     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00667}00667       \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00668}00668         \textcolor{stringliteral}{"{}Unit normal passed into this fct should either be 2D (r,z) or have a "{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00669}00669         \textcolor{stringliteral}{"{}zero component in the theta-\/direction"{}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00670}00670         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00671}00671         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00672}00672     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00673}00673 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00674}00674 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00675}00675     \textcolor{comment}{// Get velocity gradients}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00676}00676     DenseMatrix<double> strainrate(3, 3);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00677}00677     strain\_rate(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, strainrate);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00678}00678 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00679}00679     \textcolor{comment}{// Get pressure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00680}00680     \textcolor{keywordtype}{double} press = interpolated\_p\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00681}00681 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00682}00682     \textcolor{comment}{// Loop over traction components}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00683}00683     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00684}00684     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00685}00685       traction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = -\/press * n\_local[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00686}00686       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00687}00687       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00688}00688         traction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += 2.0 * strainrate(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) * n\_local[j];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00689}00689       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00690}00690     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00691}00691   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00692}00692 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00693}00693   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00694}00694 \textcolor{comment}{  /// Return dissipation at local coordinate s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00695}00695 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00696}00696   \textcolor{keywordtype}{double} AxisymmetricNavierStokesEquations::dissipation(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00697}00697     \textcolor{keyword}{const} Vector<double>\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00698}00698 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00699}00699     \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00700}00700       \textcolor{stringliteral}{"{}Check the dissipation calculation for axisymmetric NSt"{}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00701}00701       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00702}00702       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00703}00703 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00704}00704     \textcolor{comment}{// Get strain rate matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00705}00705     DenseMatrix<double> strainrate(3, 3);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00706}00706     strain\_rate(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, strainrate);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00707}00707 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00708}00708     \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00709}00709     \textcolor{keywordtype}{double} local\_diss = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00710}00710     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00711}00711     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00712}00712       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00713}00713       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00714}00714         local\_diss += 2.0 * strainrate(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) * strainrate(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00715}00715       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00716}00716     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00717}00717 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00718}00718     \textcolor{keywordflow}{return} local\_diss;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00719}00719   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00720}00720 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00721}00721   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00722}00722 \textcolor{comment}{  /// Get strain-\/rate tensor: \(\backslash\)f\$ e\_\{ij\} \(\backslash\)f\$  where}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00723}00723 \textcolor{comment}{  /// \(\backslash\)f\$ i,j = r,z,\(\backslash\)theta \(\backslash\)f\$ (in that order)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00724}00724 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00725}00725   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::strain\_rate(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00726}00726     \textcolor{keyword}{const} Vector<double>\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, DenseMatrix<double>\& strainrate)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00727}00727 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00728}00728 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00729}00729     \textcolor{keywordflow}{if} ((strainrate.ncol() != 3) || (strainrate.nrow() != 3))}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00730}00730     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00731}00731       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00732}00732       error\_message << \textcolor{stringliteral}{"{}The strain rate has incorrect dimensions "{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00733}00733                     << strainrate.ncol() << \textcolor{stringliteral}{"{} x "{}} << strainrate.nrow()}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00734}00734                     << \textcolor{stringliteral}{"{} Not 3"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00735}00735 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00736}00736       \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00737}00737         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00738}00738     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00739}00739 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00740}00740 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00741}00741     \textcolor{comment}{// Find out how many nodes there are in the element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00742}00742     \textcolor{keywordtype}{unsigned} n\_node = nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00743}00743 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00744}00744     \textcolor{comment}{// Set up memory for the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00745}00745     Shape psi(n\_node);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00746}00746     DShape dpsidx(n\_node, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00747}00747 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00748}00748     \textcolor{comment}{// Call the derivatives of the shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00749}00749     dshape\_eulerian(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, dpsidx);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00750}00750 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00751}00751     \textcolor{comment}{// Radius}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00752}00752     \textcolor{keywordtype}{double} interpolated\_r = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00753}00753 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00754}00754     \textcolor{comment}{// Velocity components and their derivatives}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00755}00755     \textcolor{keywordtype}{double} ur = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00756}00756     \textcolor{keywordtype}{double} durdr = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00757}00757     \textcolor{keywordtype}{double} durdz = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00758}00758     \textcolor{keywordtype}{double} uz = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00759}00759     \textcolor{keywordtype}{double} duzdr = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00760}00760     \textcolor{keywordtype}{double} duzdz = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00761}00761     \textcolor{keywordtype}{double} uphi = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00762}00762     \textcolor{keywordtype}{double} duphidr = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00763}00763     \textcolor{keywordtype}{double} duphidz = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00764}00764 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00765}00765     \textcolor{comment}{// Get the local storage for the indices}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00766}00766     \textcolor{keywordtype}{unsigned} u\_nodal\_index[3];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00767}00767     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00768}00768     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00769}00769       u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = u\_index\_axi\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00770}00770     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00771}00771 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00772}00772     \textcolor{comment}{// Loop over nodes to assemble velocities and their derivatives}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00773}00773     \textcolor{comment}{// w.r.t. to r and z (x\_0 and x\_1)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00774}00774     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00775}00775     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00776}00776       interpolated\_r += nodal\_position(l, 0) * psi[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00777}00777 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00778}00778       ur += nodal\_value(l, u\_nodal\_index[0]) * psi[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00779}00779       uz += nodal\_value(l, u\_nodal\_index[1]) * psi[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00780}00780       uphi += nodal\_value(l, u\_nodal\_index[2]) * psi[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00781}00781 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00782}00782       durdr += nodal\_value(l, u\_nodal\_index[0]) * dpsidx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00783}00783       durdz += nodal\_value(l, u\_nodal\_index[0]) * dpsidx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00784}00784 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00785}00785       duzdr += nodal\_value(l, u\_nodal\_index[1]) * dpsidx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00786}00786       duzdz += nodal\_value(l, u\_nodal\_index[1]) * dpsidx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00787}00787 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00788}00788       duphidr += nodal\_value(l, u\_nodal\_index[2]) * dpsidx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00789}00789       duphidz += nodal\_value(l, u\_nodal\_index[2]) * dpsidx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00790}00790     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00791}00791 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00792}00792 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00793}00793     \textcolor{comment}{// Assign strain rates without negative powers of the radius}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00794}00794     \textcolor{comment}{// and zero those with:}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00795}00795     strainrate(0, 0) = durdr;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00796}00796     strainrate(0, 1) = 0.5 * (durdz + duzdr);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00797}00797     strainrate(1, 0) = strainrate(0, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00798}00798     strainrate(0, 2) = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00799}00799     strainrate(2, 0) = strainrate(0, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00800}00800     strainrate(1, 1) = duzdz;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00801}00801     strainrate(1, 2) = 0.5 * duphidz;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00802}00802     strainrate(2, 1) = strainrate(1, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00803}00803     strainrate(2, 2) = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00804}00804 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00805}00805 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00806}00806     \textcolor{comment}{// Overwrite the strain rates with negative powers of the radius}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00807}00807     \textcolor{comment}{// unless we're at the origin}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00808}00808     \textcolor{keywordflow}{if} (std::fabs(interpolated\_r) > 1.0e-\/16)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00809}00809     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00810}00810       \textcolor{keywordtype}{double} inverse\_radius = 1.0 / interpolated\_r;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00811}00811       strainrate(0, 2) = 0.5 * (duphidr -\/ inverse\_radius * uphi);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00812}00812       strainrate(2, 0) = strainrate(0, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00813}00813       strainrate(2, 2) = inverse\_radius * ur;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00814}00814     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00815}00815   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00816}00816 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00817}00817 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00818}00818   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00819}00819 \textcolor{comment}{  ///  Get integral of kinetic energy over element:}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00820}00820 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00821}00821   \textcolor{keywordtype}{double} AxisymmetricNavierStokesEquations::kin\_energy()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00822}00822 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00823}00823     \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00824}00824       \textcolor{stringliteral}{"{}Check the kinetic energy calculation for axisymmetric NSt"{}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00825}00825       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00826}00826       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00827}00827 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00828}00828     \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00829}00829     \textcolor{keywordtype}{double} kin\_en = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00830}00830 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00831}00831     \textcolor{comment}{// Set the value of Nintpt}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00832}00832     \textcolor{keywordtype}{unsigned} Nintpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00833}00833 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00834}00834     \textcolor{comment}{// Set the Vector to hold local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00835}00835     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00836}00836 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00837}00837     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00838}00838     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < Nintpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00839}00839     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00840}00840       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00841}00841       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00842}00842       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00843}00843         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00844}00844       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00845}00845 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00846}00846       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00847}00847       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00848}00848 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00849}00849       \textcolor{comment}{// Get Jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00850}00850       \textcolor{keywordtype}{double} J = J\_eulerian(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00851}00851 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00852}00852       \textcolor{comment}{// Loop over directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00853}00853       \textcolor{keywordtype}{double} veloc\_squared = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00854}00854       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00855}00855       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00856}00856         veloc\_squared +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00857}00857           interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * interpolated\_u\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00858}00858       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00859}00859 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00860}00860       kin\_en += 0.5 * veloc\_squared * w * J * interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00861}00861     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00862}00862 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00863}00863     \textcolor{keywordflow}{return} kin\_en;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00864}00864   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00865}00865 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00866}00866   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00867}00867 \textcolor{comment}{  /// Return pressure integrated over the element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00868}00868 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00869}00869   \textcolor{keywordtype}{double} AxisymmetricNavierStokesEquations::pressure\_integral()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00870}00870 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00871}00871     \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00872}00872     \textcolor{keywordtype}{double} press\_int = 0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00873}00873 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00874}00874     \textcolor{comment}{// Set the value of Nintpt}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00875}00875     \textcolor{keywordtype}{unsigned} Nintpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00876}00876 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00877}00877     \textcolor{comment}{// Set the Vector to hold local coordinates}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00878}00878     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00879}00879 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00880}00880     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00881}00881     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < Nintpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00882}00882     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00883}00883       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00884}00884       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00885}00885       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00886}00886         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00887}00887       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00888}00888 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00889}00889       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00890}00890       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00891}00891 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00892}00892       \textcolor{comment}{// Get Jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00893}00893       \textcolor{keywordtype}{double} J = J\_eulerian(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00894}00894 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00895}00895       \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00896}00896       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} = w * J * interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00897}00897 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00898}00898       \textcolor{comment}{// Get pressure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00899}00899       \textcolor{keywordtype}{double} press = interpolated\_p\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00900}00900 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00901}00901       \textcolor{comment}{// Add}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00902}00902       press\_int += press * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00903}00903     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00904}00904 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00905}00905     \textcolor{keywordflow}{return} press\_int;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00906}00906   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00907}00907 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00908}00908   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00909}00909 \textcolor{comment}{  ///  Compute the residuals for the Navier-\/-\/Stokes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00910}00910 \textcolor{comment}{  ///  equations; flag=1(or 0): do (or don't) compute the}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00911}00911 \textcolor{comment}{  ///  Jacobian as well.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00912}00912 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00913}00913   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00914}00914     fill\_in\_generic\_residual\_contribution\_axi\_nst(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00915}00915       Vector<double>\& residuals,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00916}00916       DenseMatrix<double>\& jacobian,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00917}00917       DenseMatrix<double>\& mass\_matrix,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00918}00918       \textcolor{keywordtype}{unsigned} flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00919}00919   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00920}00920     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00921}00921     \textcolor{keywordtype}{unsigned} n\_node = nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00922}00922 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00923}00923     \textcolor{comment}{// Get continuous time from timestepper of first node}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00924}00924     \textcolor{keywordtype}{double} time = node\_pt(0)-\/>time\_stepper\_pt()-\/>time\_pt()-\/>time();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00925}00925 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00926}00926     \textcolor{comment}{// Find out how many pressure dofs there are}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00927}00927     \textcolor{keywordtype}{unsigned} n\_pres = npres\_axi\_nst();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00928}00928 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00929}00929     \textcolor{comment}{// Get the nodal indices at which the velocity is stored}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00930}00930     \textcolor{keywordtype}{unsigned} u\_nodal\_index[3];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00931}00931     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00932}00932     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00933}00933       u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = u\_index\_axi\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00934}00934     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00935}00935 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00936}00936     \textcolor{comment}{// Set up memory for the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00937}00937     \textcolor{comment}{// Note that there are only two dimensions, r and z in this problem}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00938}00938     Shape psif(n\_node), testf(n\_node);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00939}00939     DShape dpsifdx(n\_node, 2), dtestfdx(n\_node, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00940}00940 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00941}00941     \textcolor{comment}{// Set up memory for pressure shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00942}00942     Shape psip(n\_pres), testp(n\_pres);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00943}00943 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00944}00944     \textcolor{comment}{// Number of integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00945}00945     \textcolor{keywordtype}{unsigned} Nintpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00946}00946 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00947}00947     \textcolor{comment}{// Set the Vector to hold local coordinates (two dimensions)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00948}00948     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00949}00949 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00950}00950     \textcolor{comment}{// Get Physical Variables from Element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00951}00951     \textcolor{comment}{// Reynolds number must be multiplied by the density ratio}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00952}00952     \textcolor{keywordtype}{double} scaled\_re = re() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00953}00953     \textcolor{keywordtype}{double} scaled\_re\_st = re\_st() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00954}00954     \textcolor{keywordtype}{double} scaled\_re\_inv\_fr = re\_invfr() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00955}00955     \textcolor{keywordtype}{double} scaled\_re\_inv\_ro = re\_invro() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00956}00956     \textcolor{comment}{// double visc\_ratio = viscosity\_ratio();}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00957}00957     Vector<double> G = g();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00958}00958 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00959}00959     \textcolor{comment}{// Integers used to store the local equation and unknown numbers}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00960}00960     \textcolor{keywordtype}{int} local\_eqn = 0, local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00961}00961 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00962}00962     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00963}00963     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < Nintpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00964}00964     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00965}00965       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00966}00966       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++) \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00967}00967       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00968}00968       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00969}00969 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00970}00970       \textcolor{comment}{// Call the derivatives of the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00971}00971       \textcolor{keywordtype}{double} J = dshape\_and\_dtest\_eulerian\_at\_knot\_axi\_nst(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00972}00972         ipt, psif, dpsifdx, testf, dtestfdx);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00973}00973 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00974}00974       \textcolor{comment}{// Call the pressure shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00975}00975       pshape\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psip, testp);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00976}00976 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00977}00977       \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00978}00978       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00979}00979 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00980}00980       \textcolor{comment}{// Allocate storage for the position and the derivative of the}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00981}00981       \textcolor{comment}{// mesh positions wrt time}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00982}00982       Vector<double> interpolated\_x(2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00983}00983       Vector<double> mesh\_velocity(2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00984}00984       \textcolor{comment}{// Allocate storage for the pressure, velocity components and their}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00985}00985       \textcolor{comment}{// time and spatial derivatives}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00986}00986       \textcolor{keywordtype}{double} interpolated\_p = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00987}00987       Vector<double> interpolated\_u(3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00988}00988       Vector<double> dudt(3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00989}00989       DenseMatrix<double> interpolated\_dudx(3, 2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00990}00990 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00991}00991       \textcolor{comment}{// Calculate pressure at integration point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00992}00992       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_pres; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00993}00993       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00994}00994         interpolated\_p += p\_axi\_nst(l) * psip[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00995}00995       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00996}00996 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00997}00997       \textcolor{comment}{// Calculate velocities and derivatives at integration point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00998}00998 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l00999}00999       \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01000}01000       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01001}01001       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01002}01002         \textcolor{comment}{// Cache the shape function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01003}01003         \textcolor{keyword}{const} \textcolor{keywordtype}{double} psif\_ = psif(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01004}01004         \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01005}01005         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01006}01006         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01007}01007           interpolated\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += this-\/>raw\_nodal\_position(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01008}01008         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01009}01009         \textcolor{comment}{// mesh\_velocity[i]  += dnodal\_position\_dt(l,i)*psif[l];}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01010}01010 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01011}01011         \textcolor{comment}{// Loop over the three velocity directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01012}01012         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01013}01013         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01014}01014           \textcolor{comment}{// Get the u\_value}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01015}01015           \textcolor{keyword}{const} \textcolor{keywordtype}{double} u\_value = this-\/>raw\_nodal\_value(l, u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01016}01016           interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += u\_value * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01017}01017           dudt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += du\_dt\_axi\_nst(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01018}01018           \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01019}01019           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01020}01020           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01021}01021             interpolated\_dudx(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) += u\_value * dpsifdx(l, j);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01022}01022           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01023}01023         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01024}01024       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01025}01025 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01026}01026       \textcolor{comment}{// Get the mesh velocity if ALE is enabled}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01027}01027       \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01028}01028       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01029}01029         \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01030}01030         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01031}01031         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01032}01032           \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01033}01033           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01034}01034           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01035}01035             mesh\_velocity[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += this-\/>raw\_dnodal\_position\_dt(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01036}01036           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01037}01037         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01038}01038       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01039}01039 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01040}01040 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01041}01041       \textcolor{comment}{// Get the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01042}01042       Vector<double> body\_force(3);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01043}01043       get\_body\_force\_axi\_nst(time, ipt, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, interpolated\_x, body\_force);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01044}01044 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01045}01045       \textcolor{comment}{// Get the user-\/defined source function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01046}01046       \textcolor{keywordtype}{double} source = get\_source\_fct(time, ipt, interpolated\_x);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01047}01047 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01048}01048       \textcolor{comment}{// Get the user-\/defined viscosity function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01049}01049       \textcolor{keywordtype}{double} visc\_ratio;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01050}01050       get\_viscosity\_ratio\_axisym\_nst(ipt, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, interpolated\_x, visc\_ratio);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01051}01051 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01052}01052       \textcolor{comment}{// r is the first position component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01053}01053       \textcolor{keywordtype}{double} r = interpolated\_x[0];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01054}01054 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01055}01055       \textcolor{comment}{// MOMENTUM EQUATIONS}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01056}01056       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01057}01057 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01058}01058       \textcolor{comment}{// Loop over the test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01059}01059       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01060}01060       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01061}01061         \textcolor{comment}{// FIRST (RADIAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01062}01062         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01063}01063         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01064}01064         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01065}01065         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01066}01066           \textcolor{comment}{// Add the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01067}01067           residuals[local\_eqn] += r * body\_force[0] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01068}01068 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01069}01069           \textcolor{comment}{// Add the gravitational body force term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01070}01070           residuals[local\_eqn] += r * scaled\_re\_inv\_fr * testf[l] * G[0] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01071}01071 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01072}01072           \textcolor{comment}{// Add the pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01073}01073           residuals[local\_eqn] +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01074}01074             interpolated\_p * (testf[l] + r * dtestfdx(l, 0)) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01075}01075 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01076}01076           \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01077}01077           \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01078}01078           \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01079}01079           \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01080}01080           residuals[local\_eqn] -\/= visc\_ratio * r * (1.0 + Gamma[0]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01081}01081                                   interpolated\_dudx(0, 0) * dtestfdx(l, 0) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01082}01082 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01083}01083           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01084}01084             visc\_ratio * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01085}01085             (interpolated\_dudx(0, 1) + Gamma[0] * interpolated\_dudx(1, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01086}01086             dtestfdx(l, 1) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01087}01087 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01088}01088           residuals[local\_eqn] -\/= visc\_ratio * (1.0 + Gamma[0]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01089}01089                                   interpolated\_u[0] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} / r;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01090}01090 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01091}01091           \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01092}01092           \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01093}01093           residuals[local\_eqn] -\/= scaled\_re\_st * r * dudt[0] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01094}01094 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01095}01095           \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01096}01096           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01097}01097             scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01098}01098             (r * interpolated\_u[0] * interpolated\_dudx(0, 0) -\/}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01099}01099              interpolated\_u[2] * interpolated\_u[2] +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01100}01100              r * interpolated\_u[1] * interpolated\_dudx(0, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01101}01101             testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01102}01102 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01103}01103           \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01104}01104           \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01105}01105           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01106}01106             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01107}01107             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01108}01108               residuals[local\_eqn] += scaled\_re\_st * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01109}01109                                       interpolated\_dudx(0, k) * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01110}01110             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01111}01111           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01112}01112 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01113}01113           \textcolor{comment}{// Add the Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01114}01114           residuals[local\_eqn] +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01115}01115             2.0 * r * scaled\_re\_inv\_ro * interpolated\_u[2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01116}01116 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01117}01117           \textcolor{comment}{// CALCULATE THE JACOBIAN}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01118}01118           \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01119}01119           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01120}01120             \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01121}01121             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01122}01122             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01123}01123               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01124}01124               \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01125}01125               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01126}01126               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01127}01127                 \textcolor{keywordflow}{if} (flag == 2)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01128}01128                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01129}01129                   \textcolor{comment}{// Add the mass matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01130}01130                   mass\_matrix(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01131}01131                     scaled\_re\_st * r * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01132}01132                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01133}01133 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01134}01134                 \textcolor{comment}{// Add contribution to the Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01135}01135                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01136}01136                   visc\_ratio * r * (1.0 + Gamma[0]) * dpsifdx(l2, 0) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01137}01137                   dtestfdx(l, 0) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01138}01138 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01139}01139                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01140}01140                   visc\_ratio * r * dpsifdx(l2, 1) * dtestfdx(l, 1) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01141}01141 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01142}01142                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01143}01143                   visc\_ratio * (1.0 + Gamma[0]) * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} / r;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01144}01144 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01145}01145                 \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01146}01146                 \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01147}01147                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01148}01148                   scaled\_re\_st * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01149}01149                   node\_pt(l2)-\/>time\_stepper\_pt()-\/>weight(1, 0) * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01150}01150                   testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01151}01151 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01152}01152                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01153}01153                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01154}01154                   scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01155}01155                   (r * psif[l2] * interpolated\_dudx(0, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01156}01156                    r * interpolated\_u[0] * dpsifdx(l2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01157}01157                    r * interpolated\_u[1] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01158}01158                   testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01159}01159 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01160}01160                 \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01161}01161                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01162}01162                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01163}01163                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01164}01164                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01165}01165                     jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01166}01166                       scaled\_re\_st * r * mesh\_velocity[k] * dpsifdx(l2, k) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01167}01167                       testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01168}01168                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01169}01169                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01170}01170               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01171}01171 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01172}01172 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01173}01173               \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01174}01174               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01175}01175               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01176}01176               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01177}01177                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01178}01178                   visc\_ratio * r * Gamma[0] * dpsifdx(l2, 0) * dtestfdx(l, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01179}01179                   \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01180}01180 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01181}01181                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01182}01182                 jacobian(local\_eqn, local\_unknown) -\/= scaled\_re * r * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01183}01183                                                       interpolated\_dudx(0, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01184}01184                                                       testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01185}01185               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01186}01186 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01187}01187               \textcolor{comment}{// Azimuthal velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01188}01188               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01189}01189               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01190}01190               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01191}01191                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01192}01192                 jacobian(local\_eqn, local\_unknown) -\/= -\/scaled\_re * 2.0 *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01193}01193                                                       interpolated\_u[2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01194}01194                                                       psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01195}01195 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01196}01196                 \textcolor{comment}{// Coriolis terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01197}01197                 jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01198}01198                   2.0 * r * scaled\_re\_inv\_ro * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01199}01199               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01200}01200             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01201}01201 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01202}01202             \textcolor{comment}{/*Now loop over pressure shape functions*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01203}01203             \textcolor{comment}{/*This is the contribution from pressure gradient*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01204}01204             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_pres; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01205}01205             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01206}01206               local\_unknown = p\_local\_eqn(l2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01207}01207               \textcolor{comment}{/*If we are at a non-\/zero degree of freedom in the entry*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01208}01208               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01209}01209               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01210}01210                 jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01211}01211                   psip[l2] * (testf[l] + r * dtestfdx(l, 0)) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01212}01212               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01213}01213             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01214}01214           \} \textcolor{comment}{/*End of Jacobian calculation*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01215}01215 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01216}01216         \} \textcolor{comment}{// End of if not boundary condition statement}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01217}01217 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01218}01218         \textcolor{comment}{// SECOND (AXIAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01219}01219         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01220}01220         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01221}01221         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01222}01222         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01223}01223           \textcolor{comment}{// Add the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01224}01224           \textcolor{comment}{// Remember to multiply by the density ratio!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01225}01225           residuals[local\_eqn] += r * body\_force[1] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01226}01226 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01227}01227           \textcolor{comment}{// Add the gravitational body force term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01228}01228           residuals[local\_eqn] += r * scaled\_re\_inv\_fr * testf[l] * G[1] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01229}01229 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01230}01230           \textcolor{comment}{// Add the pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01231}01231           residuals[local\_eqn] += r * interpolated\_p * dtestfdx(l, 1) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01232}01232 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01233}01233           \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01234}01234           \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01235}01235           \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01236}01236           \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01237}01237           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01238}01238             visc\_ratio * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01239}01239             (interpolated\_dudx(1, 0) + Gamma[1] * interpolated\_dudx(0, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01240}01240             dtestfdx(l, 0) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01241}01241 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01242}01242           residuals[local\_eqn] -\/= visc\_ratio * r * (1.0 + Gamma[1]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01243}01243                                   interpolated\_dudx(1, 1) * dtestfdx(l, 1) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01244}01244 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01245}01245           \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01246}01246           \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01247}01247           residuals[local\_eqn] -\/= scaled\_re\_st * r * dudt[1] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01248}01248 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01249}01249           \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01250}01250           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01251}01251             scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01252}01252             (r * interpolated\_u[0] * interpolated\_dudx(1, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01253}01253              r * interpolated\_u[1] * interpolated\_dudx(1, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01254}01254             testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01255}01255 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01256}01256           \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01257}01257           \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01258}01258           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01259}01259             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01260}01260             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01261}01261               residuals[local\_eqn] += scaled\_re\_st * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01262}01262                                       interpolated\_dudx(1, k) * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01263}01263             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01264}01264           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01265}01265 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01266}01266           \textcolor{comment}{// CALCULATE THE JACOBIAN}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01267}01267           \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01268}01268           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01269}01269             \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01270}01270             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01271}01271             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01272}01272               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01273}01273               \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01274}01274               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01275}01275               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01276}01276                 \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01277}01277                 \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01278}01278                 \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01279}01279                 \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01280}01280                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01281}01281                   visc\_ratio * r * Gamma[1] * dpsifdx(l2, 1) * dtestfdx(l, 0) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01282}01282                   \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01283}01283 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01284}01284                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01285}01285                 jacobian(local\_eqn, local\_unknown) -\/= scaled\_re * r * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01286}01286                                                       interpolated\_dudx(1, 0) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01287}01287                                                       testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01288}01288               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01289}01289 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01290}01290               \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01291}01291               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01292}01292               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01293}01293               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01294}01294                 \textcolor{keywordflow}{if} (flag == 2)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01295}01295                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01296}01296                   \textcolor{comment}{// Add the mass matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01297}01297                   mass\_matrix(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01298}01298                     scaled\_re\_st * r * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01299}01299                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01300}01300 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01301}01301 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01302}01302                 \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01303}01303                 \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01304}01304                 \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01305}01305                 \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01306}01306                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01307}01307                   visc\_ratio * r * dpsifdx(l2, 0) * dtestfdx(l, 0) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01308}01308 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01309}01309                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01310}01310                   visc\_ratio * r * (1.0 + Gamma[1]) * dpsifdx(l2, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01311}01311                   dtestfdx(l, 1) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01312}01312 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01313}01313                 \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01314}01314                 \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01315}01315                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01316}01316                   scaled\_re\_st * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01317}01317                   node\_pt(l2)-\/>time\_stepper\_pt()-\/>weight(1, 0) * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01318}01318                   testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01319}01319 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01320}01320                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01321}01321                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01322}01322                   scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01323}01323                   (r * interpolated\_u[0] * dpsifdx(l2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01324}01324                    r * psif[l2] * interpolated\_dudx(1, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01325}01325                    r * interpolated\_u[1] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01326}01326                   testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01327}01327 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01328}01328 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01329}01329                 \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01330}01330                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01331}01331                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01332}01332                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01333}01333                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01334}01334                     jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01335}01335                       scaled\_re\_st * r * mesh\_velocity[k] * dpsifdx(l2, k) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01336}01336                       testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01337}01337                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01338}01338                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01339}01339               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01340}01340 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01341}01341               \textcolor{comment}{// There are no azimithal terms in the axial momentum equation}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01342}01342             \} \textcolor{comment}{// End of loop over velocity shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01343}01343 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01344}01344             \textcolor{comment}{/*Now loop over pressure shape functions*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01345}01345             \textcolor{comment}{/*This is the contribution from pressure gradient*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01346}01346             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_pres; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01347}01347             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01348}01348               local\_unknown = p\_local\_eqn(l2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01349}01349               \textcolor{comment}{/*If we are at a non-\/zero degree of freedom in the entry*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01350}01350               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01351}01351               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01352}01352                 jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01353}01353                   r * psip[l2] * dtestfdx(l, 1) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01354}01354               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01355}01355             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01356}01356           \} \textcolor{comment}{/*End of Jacobian calculation*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01357}01357 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01358}01358         \} \textcolor{comment}{// End of AXIAL MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01359}01359 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01360}01360         \textcolor{comment}{// THIRD (AZIMUTHAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01361}01361         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01362}01362         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01363}01363         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01364}01364           \textcolor{comment}{// Add the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01365}01365           \textcolor{comment}{// Remember to multiply by the density ratio!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01366}01366           residuals[local\_eqn] += r * body\_force[2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01367}01367 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01368}01368           \textcolor{comment}{// Add the gravitational body force term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01369}01369           residuals[local\_eqn] += r * scaled\_re\_inv\_fr * testf[l] * G[2] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01370}01370 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01371}01371           \textcolor{comment}{// There is NO pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01372}01372 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01373}01373           \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01374}01374           \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01375}01375           \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01376}01376           \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01377}01377           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01378}01378             visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01379}01379             (r * interpolated\_dudx(2, 0) -\/ Gamma[0] * interpolated\_u[2]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01380}01380             dtestfdx(l, 0) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01381}01381 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01382}01382           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01383}01383             visc\_ratio * r * interpolated\_dudx(2, 1) * dtestfdx(l, 1) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01384}01384 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01385}01385           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01386}01386             visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01387}01387             ((interpolated\_u[2] / r) -\/ Gamma[0] * interpolated\_dudx(2, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01388}01388             testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01389}01389 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01390}01390 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01391}01391           \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01392}01392           \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01393}01393           residuals[local\_eqn] -\/= scaled\_re\_st * r * dudt[2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01394}01394 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01395}01395           \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01396}01396           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01397}01397             scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01398}01398             (r * interpolated\_u[0] * interpolated\_dudx(2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01399}01399              interpolated\_u[0] * interpolated\_u[2] +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01400}01400              r * interpolated\_u[1] * interpolated\_dudx(2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01401}01401             testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01402}01402 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01403}01403           \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01404}01404           \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01405}01405           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01406}01406             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01407}01407             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01408}01408               residuals[local\_eqn] += scaled\_re\_st * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01409}01409                                       interpolated\_dudx(2, k) * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01410}01410             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01411}01411           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01412}01412 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01413}01413           \textcolor{comment}{// Add the Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01414}01414           residuals[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01415}01415             2.0 * r * scaled\_re\_inv\_ro * interpolated\_u[0] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01416}01416 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01417}01417           \textcolor{comment}{// CALCULATE THE JACOBIAN}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01418}01418           \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01419}01419           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01420}01420             \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01421}01421             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01422}01422             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01423}01423               \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01424}01424               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01425}01425               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01426}01426               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01427}01427                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01428}01428                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01429}01429                   scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01430}01430                   (r * psif[l2] * interpolated\_dudx(2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01431}01431                    psif[l2] * interpolated\_u[2]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01432}01432                   testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01433}01433 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01434}01434                 \textcolor{comment}{// Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01435}01435                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01436}01436                   2.0 * r * scaled\_re\_inv\_ro * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01437}01437               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01438}01438 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01439}01439               \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01440}01440               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01441}01441               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01442}01442               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01443}01443                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01444}01444                 jacobian(local\_eqn, local\_unknown) -\/= scaled\_re * r * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01445}01445                                                       interpolated\_dudx(2, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01446}01446                                                       testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01447}01447               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01448}01448 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01449}01449               \textcolor{comment}{// Azimuthal velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01450}01450               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01451}01451               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01452}01452               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01453}01453                 \textcolor{keywordflow}{if} (flag == 2)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01454}01454                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01455}01455                   \textcolor{comment}{// Add the mass matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01456}01456                   mass\_matrix(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01457}01457                     scaled\_re\_st * r * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01458}01458                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01459}01459 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01460}01460                 \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01461}01461                 \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01462}01462                 \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01463}01463                 \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01464}01464                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01465}01465                   visc\_ratio * (r * dpsifdx(l2, 0) -\/ Gamma[0] * psif[l2]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01466}01466                   dtestfdx(l, 0) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01467}01467 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01468}01468                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01469}01469                   visc\_ratio * r * dpsifdx(l2, 1) * dtestfdx(l, 1) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01470}01470 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01471}01471                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01472}01472                   visc\_ratio * ((psif[l2] / r) -\/ Gamma[0] * dpsifdx(l2, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01473}01473                   testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01474}01474 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01475}01475                 \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01476}01476                 \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01477}01477                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01478}01478                   scaled\_re\_st * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01479}01479                   node\_pt(l2)-\/>time\_stepper\_pt()-\/>weight(1, 0) * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01480}01480                   testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01481}01481 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01482}01482                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01483}01483                 jacobian(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01484}01484                   scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01485}01485                   (r * interpolated\_u[0] * dpsifdx(l2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01486}01486                    interpolated\_u[0] * psif[l2] +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01487}01487                    r * interpolated\_u[1] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01488}01488                   testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01489}01489 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01490}01490                 \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01491}01491                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01492}01492                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01493}01493                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01494}01494                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01495}01495                     jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01496}01496                       scaled\_re\_st * r * mesh\_velocity[k] * dpsifdx(l2, k) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01497}01497                       testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01498}01498                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01499}01499                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01500}01500               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01501}01501             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01502}01502 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01503}01503             \textcolor{comment}{// There are no pressure terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01504}01504           \} \textcolor{comment}{// End of Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01505}01505 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01506}01506         \} \textcolor{comment}{// End of AZIMUTHAL EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01507}01507 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01508}01508       \} \textcolor{comment}{// End of loop over shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01509}01509 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01510}01510 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01511}01511       \textcolor{comment}{// CONTINUITY EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01512}01512       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01513}01513 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01514}01514       \textcolor{comment}{// Loop over the shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01515}01515       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_pres; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01516}01516       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01517}01517         local\_eqn = p\_local\_eqn(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01518}01518         \textcolor{comment}{// If not a boundary conditions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01519}01519         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01520}01520         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01521}01521           \textcolor{comment}{// Source term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01522}01522           residuals[local\_eqn] -\/= r * source * testp[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01523}01523 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01524}01524           \textcolor{comment}{// Gradient terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01525}01525           residuals[local\_eqn] +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01526}01526             (interpolated\_u[0] + r * interpolated\_dudx(0, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01527}01527              r * interpolated\_dudx(1, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01528}01528             testp[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01529}01529 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01530}01530           \textcolor{comment}{/*CALCULATE THE JACOBIAN*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01531}01531           \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01532}01532           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01533}01533             \textcolor{comment}{/*Loop over the velocity shape functions*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01534}01534             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01535}01535             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01536}01536               \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01537}01537               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01538}01538               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01539}01539               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01540}01540                 jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01541}01541                   (psif[l2] + r * dpsifdx(l2, 0)) * testp[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01542}01542               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01543}01543 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01544}01544               \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01545}01545               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01546}01546               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01547}01547               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01548}01548                 jacobian(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01549}01549                   r * dpsifdx(l2, 1) * testp[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01550}01550               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01551}01551             \} \textcolor{comment}{/*End of loop over l2*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01552}01552           \} \textcolor{comment}{/*End of Jacobian calculation*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01553}01553 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01554}01554         \} \textcolor{comment}{// End of if not boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01555}01555 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01556}01556       \} \textcolor{comment}{// End of loop over l}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01557}01557     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01558}01558   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01559}01559 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01560}01560 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01561}01561   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01562}01562 \textcolor{comment}{  /// Compute derivatives of elemental residual vector with respect}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01563}01563 \textcolor{comment}{  /// to nodal coordinates.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01564}01564 \textcolor{comment}{  /// dresidual\_dnodal\_coordinates(l,i,j) = d res(l) / dX\_\{ij\}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01565}01565 \textcolor{comment}{  /// Overloads the FD-\/based version in the FiniteElement base class.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01566}01566 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01567}01567   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::get\_dresidual\_dnodal\_coordinates(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01568}01568     RankThreeTensor<double>\& dresidual\_dnodal\_coordinates)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01569}01569   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01570}01570     \textcolor{comment}{// Return immediately if there are no dofs}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01571}01571     \textcolor{keywordflow}{if} (ndof() == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01572}01572     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01573}01573       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01574}01574     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01575}01575 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01576}01576     \textcolor{comment}{// Get continuous time from timestepper of first node}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01577}01577     \textcolor{keywordtype}{double} time = node\_pt(0)-\/>time\_stepper\_pt()-\/>time\_pt()-\/>time();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01578}01578 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01579}01579     \textcolor{comment}{// Determine number of nodes in element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01580}01580     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01581}01581 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01582}01582     \textcolor{comment}{// Determine number of pressure dofs in element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01583}01583     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_pres = npres\_axi\_nst();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01584}01584 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01585}01585     \textcolor{comment}{// Find the indices at which the local velocities are stored}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01586}01586     \textcolor{keywordtype}{unsigned} u\_nodal\_index[3];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01587}01587     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01588}01588     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01589}01589       u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = u\_index\_axi\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01590}01590     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01591}01591 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01592}01592     \textcolor{comment}{// Set up memory for the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01593}01593     \textcolor{comment}{// Note that there are only two dimensions, r and z, in this problem}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01594}01594     Shape psif(n\_node), testf(n\_node);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01595}01595     DShape dpsifdx(n\_node, 2), dtestfdx(n\_node, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01596}01596 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01597}01597     \textcolor{comment}{// Set up memory for pressure shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01598}01598     Shape psip(n\_pres), testp(n\_pres);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01599}01599 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01600}01600     \textcolor{comment}{// Deriatives of shape fct derivatives w.r.t. nodal coords}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01601}01601     RankFourTensor<double> d\_dpsifdx\_dX(2, n\_node, n\_node, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01602}01602     RankFourTensor<double> d\_dtestfdx\_dX(2, n\_node, n\_node, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01603}01603 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01604}01604     \textcolor{comment}{// Derivative of Jacobian of mapping w.r.t. to nodal coords}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01605}01605     DenseMatrix<double> dJ\_dX(2, n\_node);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01606}01606 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01607}01607     \textcolor{comment}{// Derivatives of derivative of u w.r.t. nodal coords}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01608}01608     \textcolor{comment}{// Note that the entry d\_dudx\_dX(p,q,i,k) contains the derivative w.r.t.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01609}01609     \textcolor{comment}{// nodal coordinate X\_pq of du\_i/dx\_k. Since there are three velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01610}01610     \textcolor{comment}{// components, i can take on the values 0, 1 and 2, while k and p only}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01611}01611     \textcolor{comment}{// take on the values 0 and 1 since there are only two spatial dimensions.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01612}01612     RankFourTensor<double> d\_dudx\_dX(2, n\_node, 3, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01613}01613 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01614}01614     \textcolor{comment}{// Derivatives of nodal velocities w.r.t. nodal coords:}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01615}01615     \textcolor{comment}{// Assumption: Interaction only local via no-\/slip so}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01616}01616     \textcolor{comment}{// X\_pq only affects U\_iq.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01617}01617     \textcolor{comment}{// Note that the entry d\_U\_dX(p,q,i) contains the derivative w.r.t. nodal}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01618}01618     \textcolor{comment}{// coordinate X\_pq of nodal value U\_iq. In other words this entry is the}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01619}01619     \textcolor{comment}{// derivative of the i-\/th velocity component w.r.t. the p-\/th spatial}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01620}01620     \textcolor{comment}{// coordinate, taken at the q-\/th local node.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01621}01621     RankThreeTensor<double> d\_U\_dX(2, n\_node, 3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01622}01622 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01623}01623     \textcolor{comment}{// Determine the number of integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01624}01624     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_intpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01625}01625 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01626}01626     \textcolor{comment}{// Vector to hold local coordinates (two dimensions)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01627}01627     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01628}01628 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01629}01629     \textcolor{comment}{// Get physical variables from element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01630}01630     \textcolor{comment}{// (Reynolds number must be multiplied by the density ratio)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01631}01631     \textcolor{keyword}{const} \textcolor{keywordtype}{double} scaled\_re = re() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01632}01632     \textcolor{keyword}{const} \textcolor{keywordtype}{double} scaled\_re\_st = re\_st() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01633}01633     \textcolor{keyword}{const} \textcolor{keywordtype}{double} scaled\_re\_inv\_fr = re\_invfr() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01634}01634     \textcolor{keyword}{const} \textcolor{keywordtype}{double} scaled\_re\_inv\_ro = re\_invro() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01635}01635     \textcolor{keyword}{const} \textcolor{keywordtype}{double} visc\_ratio = viscosity\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01636}01636     \textcolor{keyword}{const} Vector<double> G = g();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01637}01637 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01638}01638     \textcolor{comment}{// FD step}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01639}01639     \textcolor{keywordtype}{double} eps\_fd = \mbox{\hyperlink{classoomph_1_1GeneralisedElement_a156163c9f6fbd17548a9fa836616d19b}{GeneralisedElement::Default\_fd\_jacobian\_step}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01640}01640 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01641}01641     \textcolor{comment}{// Pre-\/compute derivatives of nodal velocities w.r.t. nodal coords:}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01642}01642     \textcolor{comment}{// Assumption: Interaction only local via no-\/slip so}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01643}01643     \textcolor{comment}{// X\_ij only affects U\_ij.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01644}01644     \textcolor{keywordtype}{bool} element\_has\_node\_with\_aux\_node\_update\_fct = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01645}01645     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < n\_node; q++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01646}01646     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01647}01647       \textcolor{comment}{// Get pointer to q-\/th local node}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01648}01648       Node* nod\_pt = node\_pt(q);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01649}01649 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01650}01650       \textcolor{comment}{// Only compute if there's a node-\/update fct involved}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01651}01651       \textcolor{keywordflow}{if} (nod\_pt-\/>has\_auxiliary\_node\_update\_fct\_pt())}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01652}01652       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01653}01653         element\_has\_node\_with\_aux\_node\_update\_fct = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01654}01654 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01655}01655         \textcolor{comment}{// This functionality has not been tested so issue a warning}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01656}01656         \textcolor{comment}{// to this effect}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01657}01657         std::ostringstream warning\_stream;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01658}01658         warning\_stream << \textcolor{stringliteral}{"{}\(\backslash\)nThe functionality to evaluate the additional"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01659}01659                        << \textcolor{stringliteral}{"{}\(\backslash\)ncontribution to the deriv of the residual eqn"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01660}01660                        << \textcolor{stringliteral}{"{}\(\backslash\)nw.r.t. the nodal coordinates which comes about"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01661}01661                        << \textcolor{stringliteral}{"{}\(\backslash\)nif a node's values are updated using an auxiliary"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01662}01662                        << \textcolor{stringliteral}{"{}\(\backslash\)nnode update function has NOT been tested for"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01663}01663                        << \textcolor{stringliteral}{"{}\(\backslash\)naxisymmetric Navier-\/Stokes elements. Use at your"{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01664}01664                        << \textcolor{stringliteral}{"{}\(\backslash\)nown risk"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01665}01665         OomphLibWarning(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01666}01666           warning\_stream.str(),}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01667}01667           \textcolor{stringliteral}{"{}AxisymmetricNavierStokesEquations::get\_dresidual\_dnodal\_coordinates"{}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01668}01668           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01669}01669 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01670}01670         \textcolor{comment}{// Current nodal velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01671}01671         Vector<double> u\_ref(3);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01672}01672         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01673}01673         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01674}01674           u\_ref[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = *(nod\_pt-\/>value\_pt(u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01675}01675         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01676}01676 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01677}01677         \textcolor{comment}{// FD}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01678}01678         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < 2; p++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01679}01679         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01680}01680           \textcolor{comment}{// Make backup}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01681}01681           \textcolor{keywordtype}{double} backup = nod\_pt-\/>x(p);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01682}01682 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01683}01683           \textcolor{comment}{// Do FD step. No node update required as we're}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01684}01684           \textcolor{comment}{// attacking the coordinate directly...}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01685}01685           nod\_pt-\/>x(p) += eps\_fd;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01686}01686 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01687}01687           \textcolor{comment}{// Do auxiliary node update (to apply no slip)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01688}01688           nod\_pt-\/>perform\_auxiliary\_node\_update\_fct();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01689}01689 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01690}01690           \textcolor{comment}{// Loop over velocity components}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01691}01691           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01692}01692           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01693}01693             \textcolor{comment}{// Evaluate}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01694}01694             d\_U\_dX(p, q, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) =}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01695}01695               (*(nod\_pt-\/>value\_pt(u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}])) -\/ u\_ref[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) / eps\_fd;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01696}01696           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01697}01697 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01698}01698           \textcolor{comment}{// Reset}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01699}01699           nod\_pt-\/>x(p) = backup;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01700}01700 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01701}01701           \textcolor{comment}{// Do auxiliary node update (to apply no slip)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01702}01702           nod\_pt-\/>perform\_auxiliary\_node\_update\_fct();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01703}01703         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01704}01704       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01705}01705     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01706}01706 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01707}01707     \textcolor{comment}{// Integer to store the local equation number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01708}01708     \textcolor{keywordtype}{int} local\_eqn = 0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01709}01709 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01710}01710     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01711}01711     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01712}01712     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01713}01713       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01714}01714       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01715}01715       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01716}01716         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01717}01717       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01718}01718 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01719}01719       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01720}01720       \textcolor{keyword}{const} \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01721}01721 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01722}01722       \textcolor{comment}{// Call the derivatives of the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01723}01723       \textcolor{keyword}{const} \textcolor{keywordtype}{double} J = dshape\_and\_dtest\_eulerian\_at\_knot\_axi\_nst(ipt,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01724}01724                                                                  psif,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01725}01725                                                                  dpsifdx,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01726}01726                                                                  d\_dpsifdx\_dX,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01727}01727                                                                  testf,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01728}01728                                                                  dtestfdx,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01729}01729                                                                  d\_dtestfdx\_dX,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01730}01730                                                                  dJ\_dX);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01731}01731 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01732}01732       \textcolor{comment}{// Call the pressure shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01733}01733       pshape\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psip, testp);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01734}01734 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01735}01735       \textcolor{comment}{// Allocate storage for the position and the derivative of the}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01736}01736       \textcolor{comment}{// mesh positions w.r.t. time}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01737}01737       Vector<double> interpolated\_x(2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01738}01738       Vector<double> mesh\_velocity(2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01739}01739 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01740}01740       \textcolor{comment}{// Allocate storage for the pressure, velocity components and their}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01741}01741       \textcolor{comment}{// time and spatial derivatives}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01742}01742       \textcolor{keywordtype}{double} interpolated\_p = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01743}01743       Vector<double> interpolated\_u(3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01744}01744       Vector<double> dudt(3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01745}01745       DenseMatrix<double> interpolated\_dudx(3, 2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01746}01746 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01747}01747       \textcolor{comment}{// Calculate pressure at integration point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01748}01748       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_pres; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01749}01749       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01750}01750         interpolated\_p += p\_axi\_nst(l) * psip[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01751}01751       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01752}01752 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01753}01753       \textcolor{comment}{// Calculate velocities and derivatives at integration point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01754}01754       \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01755}01755 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01756}01756       \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01757}01757       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01758}01758       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01759}01759         \textcolor{comment}{// Cache the shape function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01760}01760         \textcolor{keyword}{const} \textcolor{keywordtype}{double} psif\_ = psif(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01761}01761 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01762}01762         \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01763}01763         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01764}01764         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01765}01765           interpolated\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += this-\/>raw\_nodal\_position(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01766}01766         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01767}01767 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01768}01768         \textcolor{comment}{// Loop over the three velocity directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01769}01769         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01770}01770         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01771}01771           \textcolor{comment}{// Get the nodal value}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01772}01772           \textcolor{keyword}{const} \textcolor{keywordtype}{double} u\_value = this-\/>raw\_nodal\_value(l, u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01773}01773           interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += u\_value * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01774}01774           dudt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += du\_dt\_axi\_nst(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01775}01775 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01776}01776           \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01777}01777           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01778}01778           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01779}01779             interpolated\_dudx(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) += u\_value * dpsifdx(l, j);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01780}01780           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01781}01781         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01782}01782       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01783}01783 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01784}01784       \textcolor{comment}{// Get the mesh velocity if ALE is enabled}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01785}01785       \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01786}01786       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01787}01787         \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01788}01788         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01789}01789         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01790}01790           \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01791}01791           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01792}01792           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01793}01793             mesh\_velocity[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += this-\/>raw\_dnodal\_position\_dt(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01794}01794           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01795}01795         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01796}01796       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01797}01797 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01798}01798       \textcolor{comment}{// Calculate derivative of du\_i/dx\_k w.r.t. nodal positions X\_\{pq\}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01799}01799       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < n\_node; q++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01800}01800       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01801}01801         \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01802}01802         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < 2; p++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01803}01803         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01804}01804           \textcolor{comment}{// Loop over the three velocity components}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01805}01805           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01806}01806           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01807}01807             \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01808}01808             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01809}01809             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01810}01810               \textcolor{keywordtype}{double} aux = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01811}01811 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01812}01812               \textcolor{comment}{// Loop over nodes and add contribution}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01813}01813               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01814}01814               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01815}01815                 aux += this-\/>raw\_nodal\_value(j, u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01816}01816                        d\_dpsifdx\_dX(p, q, j, k);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01817}01817               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01818}01818               d\_dudx\_dX(p, q, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, k) = aux;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01819}01819             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01820}01820           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01821}01821         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01822}01822       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01823}01823 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01824}01824       \textcolor{comment}{// Get weight of actual nodal position/value in computation of mesh}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01825}01825       \textcolor{comment}{// velocity from positional/value time stepper}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01826}01826       \textcolor{keyword}{const} \textcolor{keywordtype}{double} pos\_time\_weight =}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01827}01827         node\_pt(0)-\/>position\_time\_stepper\_pt()-\/>weight(1, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01828}01828       \textcolor{keyword}{const} \textcolor{keywordtype}{double} val\_time\_weight =}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01829}01829         node\_pt(0)-\/>time\_stepper\_pt()-\/>weight(1, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01830}01830 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01831}01831       \textcolor{comment}{// Get the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01832}01832       Vector<double> body\_force(3);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01833}01833       get\_body\_force\_axi\_nst(time, ipt, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, interpolated\_x, body\_force);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01834}01834 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01835}01835       \textcolor{comment}{// Get the user-\/defined source function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01836}01836       \textcolor{keyword}{const} \textcolor{keywordtype}{double} source = get\_source\_fct(time, ipt, interpolated\_x);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01837}01837 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01838}01838       \textcolor{comment}{// Note: Can use raw values and avoid bypassing hanging information}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01839}01839       \textcolor{comment}{// because this is the non-\/refineable version!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01840}01840 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01841}01841       \textcolor{comment}{// Get gradient of body force function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01842}01842       DenseMatrix<double> d\_body\_force\_dx(3, 2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01843}01843       get\_body\_force\_gradient\_axi\_nst(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01844}01844         time, ipt, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, interpolated\_x, d\_body\_force\_dx);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01845}01845 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01846}01846       \textcolor{comment}{// Get gradient of source function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01847}01847       Vector<double> source\_gradient(2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01848}01848       get\_source\_fct\_gradient(time, ipt, interpolated\_x, source\_gradient);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01849}01849 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01850}01850       \textcolor{comment}{// Cache r (the first position component)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01851}01851       \textcolor{keyword}{const} \textcolor{keywordtype}{double} r = interpolated\_x[0];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01852}01852 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01853}01853       \textcolor{comment}{// Assemble shape derivatives}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01854}01854       \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01855}01855 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01856}01856       \textcolor{comment}{// ==================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01857}01857       \textcolor{comment}{// MOMENTUM EQUATIONS}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01858}01858       \textcolor{comment}{// ==================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01859}01859 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01860}01860       \textcolor{comment}{// Loop over the test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01861}01861       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01862}01862       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01863}01863         \textcolor{comment}{// Cache the test function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01864}01864         \textcolor{keyword}{const} \textcolor{keywordtype}{double} testf\_ = testf[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01865}01865 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01866}01866         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01867}01867         \textcolor{comment}{// FIRST (RADIAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01868}01868         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01869}01869         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01870}01870         ;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01871}01871 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01872}01872         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01873}01873         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01874}01874         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01875}01875           \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01876}01876           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < 2; p++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01877}01877           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01878}01878             \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01879}01879             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < n\_node; q++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01880}01880             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01881}01881               \textcolor{comment}{// Residual x deriv of Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01882}01882               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01883}01883 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01884}01884               \textcolor{comment}{// Add the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01885}01885               \textcolor{keywordtype}{double} sum = r * body\_force[0] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01886}01886 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01887}01887               \textcolor{comment}{// Add the gravitational body force term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01888}01888               sum += r * scaled\_re\_inv\_fr * testf\_ * G[0];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01889}01889 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01890}01890               \textcolor{comment}{// Add the pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01891}01891               sum += interpolated\_p * (testf\_ + r * dtestfdx(l, 0));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01892}01892 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01893}01893               \textcolor{comment}{// Add the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01894}01894               \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01895}01895               \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01896}01896               \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01897}01897               sum -\/= visc\_ratio * r * (1.0 + Gamma[0]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01898}01898                      interpolated\_dudx(0, 0) * dtestfdx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01899}01899 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01900}01900               sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01901}01901                 visc\_ratio * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01902}01902                 (interpolated\_dudx(0, 1) + Gamma[0] * interpolated\_dudx(1, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01903}01903                 dtestfdx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01904}01904 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01905}01905               sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01906}01906                 visc\_ratio * (1.0 + Gamma[0]) * interpolated\_u[0] * testf\_ / r;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01907}01907 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01908}01908               \textcolor{comment}{// Add the du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01909}01909               sum -\/= scaled\_re\_st * r * dudt[0] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01910}01910 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01911}01911               \textcolor{comment}{// Add the convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01912}01912               sum -\/= scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01913}01913                      (r * interpolated\_u[0] * interpolated\_dudx(0, 0) -\/}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01914}01914                       interpolated\_u[2] * interpolated\_u[2] +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01915}01915                       r * interpolated\_u[1] * interpolated\_dudx(0, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01916}01916                      testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01917}01917 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01918}01918               \textcolor{comment}{// Add the mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01919}01919               \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01920}01920               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01921}01921                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01922}01922                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01923}01923                   sum += scaled\_re\_st * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01924}01924                          interpolated\_dudx(0, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01925}01925                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01926}01926               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01927}01927 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01928}01928               \textcolor{comment}{// Add the Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01929}01929               sum += 2.0 * r * scaled\_re\_inv\_ro * interpolated\_u[2] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01930}01930 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01931}01931               \textcolor{comment}{// Multiply through by deriv of Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01932}01932               dresidual\_dnodal\_coordinates(local\_eqn, p, q) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01933}01933                 sum * dJ\_dX(p, q) * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01934}01934 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01935}01935               \textcolor{comment}{// Derivative of residual x Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01936}01936               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01937}01937 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01938}01938               \textcolor{comment}{// Body force}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01939}01939               sum = r * d\_body\_force\_dx(0, p) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01940}01940               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01941}01941               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01942}01942                 sum += body\_force[0] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01943}01943               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01944}01944 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01945}01945               \textcolor{comment}{// Gravitational body force}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01946}01946               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01947}01947               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01948}01948                 sum += scaled\_re\_inv\_fr * G[0] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01949}01949               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01950}01950 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01951}01951               \textcolor{comment}{// Pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01952}01952               sum += r * interpolated\_p * d\_dtestfdx\_dX(p, q, l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01953}01953               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01954}01954               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01955}01955                 sum += interpolated\_p * psif[q] * dtestfdx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01956}01956               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01957}01957 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01958}01958               \textcolor{comment}{// Viscous terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01959}01959               sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01960}01960                 r * visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01961}01961                 ((1.0 + Gamma[0]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01962}01962                    (d\_dudx\_dX(p, q, 0, 0) * dtestfdx(l, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01963}01963                     interpolated\_dudx(0, 0) * d\_dtestfdx\_dX(p, q, l, 0)) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01964}01964                  (d\_dudx\_dX(p, q, 0, 1) + Gamma[0] * d\_dudx\_dX(p, q, 1, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01965}01965                    dtestfdx(l, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01966}01966                  (interpolated\_dudx(0, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01967}01967                   Gamma[0] * interpolated\_dudx(1, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01968}01968                    d\_dtestfdx\_dX(p, q, l, 1));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01969}01969               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01970}01970               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01971}01971                 sum -\/= visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01972}01972                        ((1.0 + Gamma[0]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01973}01973                           (interpolated\_dudx(0, 0) * psif[q] * dtestfdx(l, 0) -\/}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01974}01974                            interpolated\_u[0] * psif[q] * testf\_ / (r * r)) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01975}01975                         (interpolated\_dudx(0, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01976}01976                          Gamma[0] * interpolated\_dudx(1, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01977}01977                           psif[q] * dtestfdx(l, 1));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01978}01978               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01979}01979 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01980}01980               \textcolor{comment}{// Convective terms, including mesh velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01981}01981               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01982}01982               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01983}01983                 \textcolor{keywordtype}{double} tmp = scaled\_re * interpolated\_u[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01984}01984                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01985}01985                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01986}01986                   tmp -\/= scaled\_re\_st * mesh\_velocity[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01987}01987                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01988}01988                 sum -\/= r * tmp * d\_dudx\_dX(p, q, 0, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01989}01989                 \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01990}01990                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01991}01991                   sum -\/= tmp * interpolated\_dudx(0, k) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01992}01992                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01993}01993               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01994}01994               \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01995}01995               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01996}01996                 sum += scaled\_re\_st * r * pos\_time\_weight *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01997}01997                        interpolated\_dudx(0, p) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01998}01998               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l01999}01999 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02000}02000               \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02001}02001               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02002}02002               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02003}02003                 sum -\/= scaled\_re\_st * dudt[0] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02004}02004               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02005}02005 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02006}02006               \textcolor{comment}{// Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02007}02007               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02008}02008               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02009}02009                 sum +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02010}02010                   2.0 * scaled\_re\_inv\_ro * interpolated\_u[2] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02011}02011               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02012}02012 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02013}02013               \textcolor{comment}{// Multiply through by Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02014}02014               dresidual\_dnodal\_coordinates(local\_eqn, p, q) += sum * J * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02015}02015 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02016}02016               \textcolor{comment}{// Derivs w.r.t. nodal velocities}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02017}02017               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02018}02018               \textcolor{keywordflow}{if} (element\_has\_node\_with\_aux\_node\_update\_fct)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02019}02019               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02020}02020                 \textcolor{comment}{// Contribution from deriv of first velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02021}02021                 \textcolor{keywordtype}{double} tmp =}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02022}02022                   scaled\_re\_st * r * val\_time\_weight * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02023}02023                 tmp +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02024}02024                   r * scaled\_re * interpolated\_dudx(0, 0) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02025}02025                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02026}02026                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02027}02027                   \textcolor{keywordtype}{double} tmp2 = scaled\_re * interpolated\_u[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02028}02028                   \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02029}02029                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02030}02030                     tmp2 -\/= scaled\_re\_st * mesh\_velocity[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02031}02031                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02032}02032                   tmp += r * tmp2 * dpsifdx(q, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02033}02033                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02034}02034 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02035}02035                 tmp += r * visc\_ratio * (1.0 + Gamma[0]) * dpsifdx(q, 0) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02036}02036                        dtestfdx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02037}02037                 tmp += r * visc\_ratio * dpsifdx(q, 1) * dtestfdx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02038}02038                 tmp += visc\_ratio * (1.0 + Gamma[0]) * psif[q] * testf\_ / r;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02039}02039 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02040}02040                 \textcolor{comment}{// Multiply through by dU\_0q/dX\_pq}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02041}02041                 sum = -\/d\_U\_dX(p, q, 0) * tmp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02042}02042 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02043}02043                 \textcolor{comment}{// Contribution from deriv of second velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02044}02044                 tmp =}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02045}02045                   scaled\_re * r * interpolated\_dudx(0, 1) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02046}02046                 tmp +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02047}02047                   r * visc\_ratio * Gamma[0] * dpsifdx(q, 0) * dtestfdx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02048}02048 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02049}02049                 \textcolor{comment}{// Multiply through by dU\_1q/dX\_pq}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02050}02050                 sum -\/= d\_U\_dX(p, q, 1) * tmp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02051}02051 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02052}02052                 \textcolor{comment}{// Contribution from deriv of third velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02053}02053                 tmp = 2.0 *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02054}02054                       (r * scaled\_re\_inv\_ro + scaled\_re * interpolated\_u[2]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02055}02055                       psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02056}02056 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02057}02057                 \textcolor{comment}{// Multiply through by dU\_2q/dX\_pq}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02058}02058                 sum += d\_U\_dX(p, q, 2) * tmp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02059}02059 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02060}02060                 \textcolor{comment}{// Multiply through by Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02061}02061                 dresidual\_dnodal\_coordinates(local\_eqn, p, q) += sum * J * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02062}02062               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02063}02063             \} \textcolor{comment}{// End of loop over q}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02064}02064           \} \textcolor{comment}{// End of loop over p}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02065}02065         \} \textcolor{comment}{// End of if it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02066}02066 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02067}02067         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02068}02068         \textcolor{comment}{// SECOND (AXIAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02069}02069         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02070}02070         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02071}02071         ;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02072}02072 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02073}02073         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02074}02074         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02075}02075         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02076}02076           \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02077}02077           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < 2; p++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02078}02078           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02079}02079             \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02080}02080             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < n\_node; q++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02081}02081             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02082}02082               \textcolor{comment}{// Residual x deriv of Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02083}02083               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02084}02084 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02085}02085               \textcolor{comment}{// Add the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02086}02086               \textcolor{keywordtype}{double} sum = r * body\_force[1] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02087}02087 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02088}02088               \textcolor{comment}{// Add the gravitational body force term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02089}02089               sum += r * scaled\_re\_inv\_fr * testf\_ * G[1];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02090}02090 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02091}02091               \textcolor{comment}{// Add the pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02092}02092               sum += r * interpolated\_p * dtestfdx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02093}02093 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02094}02094               \textcolor{comment}{// Add the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02095}02095               \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02096}02096               \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02097}02097               \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02098}02098               sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02099}02099                 visc\_ratio * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02100}02100                 (interpolated\_dudx(1, 0) + Gamma[1] * interpolated\_dudx(0, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02101}02101                 dtestfdx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02102}02102 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02103}02103               sum -\/= visc\_ratio * r * (1.0 + Gamma[1]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02104}02104                      interpolated\_dudx(1, 1) * dtestfdx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02105}02105 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02106}02106               \textcolor{comment}{// Add the du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02107}02107               sum -\/= scaled\_re\_st * r * dudt[1] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02108}02108 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02109}02109               \textcolor{comment}{// Add the convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02110}02110               sum -\/= scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02111}02111                      (r * interpolated\_u[0] * interpolated\_dudx(1, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02112}02112                       r * interpolated\_u[1] * interpolated\_dudx(1, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02113}02113                      testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02114}02114 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02115}02115               \textcolor{comment}{// Add the mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02116}02116               \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02117}02117               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02118}02118                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02119}02119                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02120}02120                   sum += scaled\_re\_st * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02121}02121                          interpolated\_dudx(1, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02122}02122                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02123}02123               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02124}02124 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02125}02125               \textcolor{comment}{// Multiply through by deriv of Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02126}02126               dresidual\_dnodal\_coordinates(local\_eqn, p, q) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02127}02127                 sum * dJ\_dX(p, q) * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02128}02128 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02129}02129               \textcolor{comment}{// Derivative of residual x Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02130}02130               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02131}02131 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02132}02132               \textcolor{comment}{// Body force}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02133}02133               sum = r * d\_body\_force\_dx(1, p) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02134}02134               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02135}02135               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02136}02136                 sum += body\_force[1] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02137}02137               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02138}02138 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02139}02139               \textcolor{comment}{// Gravitational body force}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02140}02140               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02141}02141               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02142}02142                 sum += scaled\_re\_inv\_fr * G[1] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02143}02143               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02144}02144 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02145}02145               \textcolor{comment}{// Pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02146}02146               sum += r * interpolated\_p * d\_dtestfdx\_dX(p, q, l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02147}02147               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02148}02148               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02149}02149                 sum += interpolated\_p * psif[q] * dtestfdx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02150}02150               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02151}02151 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02152}02152               \textcolor{comment}{// Viscous terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02153}02153               sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02154}02154                 r * visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02155}02155                 ((d\_dudx\_dX(p, q, 1, 0) + Gamma[1] * d\_dudx\_dX(p, q, 0, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02156}02156                    dtestfdx(l, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02157}02157                  (interpolated\_dudx(1, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02158}02158                   Gamma[1] * interpolated\_dudx(0, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02159}02159                    d\_dtestfdx\_dX(p, q, l, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02160}02160                  (1.0 + Gamma[1]) * d\_dudx\_dX(p, q, 1, 1) * dtestfdx(l, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02161}02161                  (1.0 + Gamma[1]) * interpolated\_dudx(1, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02162}02162                    d\_dtestfdx\_dX(p, q, l, 1));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02163}02163               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02164}02164               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02165}02165                 sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02166}02166                   visc\_ratio * ((interpolated\_dudx(1, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02167}02167                                  Gamma[1] * interpolated\_dudx(0, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02168}02168                                   psif[q] * dtestfdx(l, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02169}02169                                 (1.0 + Gamma[1]) * interpolated\_dudx(1, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02170}02170                                   psif[q] * dtestfdx(l, 1));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02171}02171               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02172}02172 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02173}02173               \textcolor{comment}{// Convective terms, including mesh velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02174}02174               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02175}02175               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02176}02176                 \textcolor{keywordtype}{double} tmp = scaled\_re * interpolated\_u[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02177}02177                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02178}02178                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02179}02179                   tmp -\/= scaled\_re\_st * mesh\_velocity[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02180}02180                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02181}02181                 sum -\/= r * tmp * d\_dudx\_dX(p, q, 1, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02182}02182                 \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02183}02183                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02184}02184                   sum -\/= tmp * interpolated\_dudx(1, k) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02185}02185                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02186}02186               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02187}02187               \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02188}02188               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02189}02189                 sum += scaled\_re\_st * r * pos\_time\_weight *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02190}02190                        interpolated\_dudx(1, p) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02191}02191               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02192}02192 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02193}02193               \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02194}02194               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02195}02195               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02196}02196                 sum -\/= scaled\_re\_st * dudt[1] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02197}02197               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02198}02198 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02199}02199               \textcolor{comment}{// Multiply through by Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02200}02200               dresidual\_dnodal\_coordinates(local\_eqn, p, q) += sum * J * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02201}02201 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02202}02202               \textcolor{comment}{// Derivs w.r.t. to nodal velocities}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02203}02203               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02204}02204               \textcolor{keywordflow}{if} (element\_has\_node\_with\_aux\_node\_update\_fct)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02205}02205               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02206}02206                 \textcolor{comment}{// Contribution from deriv of first velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02207}02207                 \textcolor{keywordtype}{double} tmp =}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02208}02208                   scaled\_re * r * interpolated\_dudx(1, 0) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02209}02209                 tmp +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02210}02210                   r * visc\_ratio * Gamma[1] * dpsifdx(q, 1) * dtestfdx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02211}02211 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02212}02212                 \textcolor{comment}{// Multiply through by dU\_0q/dX\_pq}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02213}02213                 sum = -\/d\_U\_dX(p, q, 0) * tmp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02214}02214 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02215}02215                 \textcolor{comment}{// Contribution from deriv of second velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02216}02216                 tmp = scaled\_re\_st * r * val\_time\_weight * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02217}02217                 tmp +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02218}02218                   r * scaled\_re * interpolated\_dudx(1, 1) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02219}02219                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02220}02220                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02221}02221                   \textcolor{keywordtype}{double} tmp2 = scaled\_re * interpolated\_u[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02222}02222                   \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02223}02223                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02224}02224                     tmp2 -\/= scaled\_re\_st * mesh\_velocity[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02225}02225                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02226}02226                   tmp += r * tmp2 * dpsifdx(q, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02227}02227                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02228}02228                 tmp += r * visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02229}02229                        (dpsifdx(q, 0) * dtestfdx(l, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02230}02230                         (1.0 + Gamma[1]) * dpsifdx(q, 1) * dtestfdx(l, 1));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02231}02231 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02232}02232                 \textcolor{comment}{// Multiply through by dU\_1q/dX\_pq}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02233}02233                 sum -\/= d\_U\_dX(p, q, 1) * tmp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02234}02234 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02235}02235                 \textcolor{comment}{// Multiply through by Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02236}02236                 dresidual\_dnodal\_coordinates(local\_eqn, p, q) += sum * J * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02237}02237               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02238}02238             \} \textcolor{comment}{// End of loop over q}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02239}02239           \} \textcolor{comment}{// End of loop over p}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02240}02240         \} \textcolor{comment}{// End of if it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02241}02241 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02242}02242         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02243}02243         \textcolor{comment}{// THIRD (AZIMUTHAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02244}02244         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02245}02245         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02246}02246         ;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02247}02247 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02248}02248         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02249}02249         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02250}02250         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02251}02251           \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02252}02252           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < 2; p++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02253}02253           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02254}02254             \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02255}02255             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < n\_node; q++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02256}02256             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02257}02257               \textcolor{comment}{// Residual x deriv of Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02258}02258               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02259}02259 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02260}02260               \textcolor{comment}{// Add the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02261}02261               \textcolor{keywordtype}{double} sum = r * body\_force[2] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02262}02262 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02263}02263               \textcolor{comment}{// Add the gravitational body force term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02264}02264               sum += r * scaled\_re\_inv\_fr * testf\_ * G[2];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02265}02265 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02266}02266               \textcolor{comment}{// There is NO pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02267}02267 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02268}02268               \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02269}02269               \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02270}02270               \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02271}02271               \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02272}02272               sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02273}02273                 visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02274}02274                 (r * interpolated\_dudx(2, 0) -\/ Gamma[0] * interpolated\_u[2]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02275}02275                 dtestfdx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02276}02276 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02277}02277               sum -\/= visc\_ratio * r * interpolated\_dudx(2, 1) * dtestfdx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02278}02278 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02279}02279               sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02280}02280                 visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02281}02281                 ((interpolated\_u[2] / r) -\/ Gamma[0] * interpolated\_dudx(2, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02282}02282                 testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02283}02283 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02284}02284               \textcolor{comment}{// Add the du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02285}02285               sum -\/= scaled\_re\_st * r * dudt[2] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02286}02286 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02287}02287               \textcolor{comment}{// Add the convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02288}02288               sum -\/= scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02289}02289                      (r * interpolated\_u[0] * interpolated\_dudx(2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02290}02290                       interpolated\_u[0] * interpolated\_u[2] +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02291}02291                       r * interpolated\_u[1] * interpolated\_dudx(2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02292}02292                      testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02293}02293 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02294}02294               \textcolor{comment}{// Add the mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02295}02295               \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02296}02296               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02297}02297                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02298}02298                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02299}02299                   sum += scaled\_re\_st * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02300}02300                          interpolated\_dudx(2, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02301}02301                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02302}02302               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02303}02303 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02304}02304               \textcolor{comment}{// Add the Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02305}02305               sum -\/= 2.0 * r * scaled\_re\_inv\_ro * interpolated\_u[0] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02306}02306 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02307}02307               \textcolor{comment}{// Multiply through by deriv of Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02308}02308               dresidual\_dnodal\_coordinates(local\_eqn, p, q) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02309}02309                 sum * dJ\_dX(p, q) * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02310}02310 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02311}02311               \textcolor{comment}{// Derivative of residual x Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02312}02312               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02313}02313 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02314}02314               \textcolor{comment}{// Body force}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02315}02315               sum = r * d\_body\_force\_dx(2, p) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02316}02316               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02317}02317               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02318}02318                 sum += body\_force[2] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02319}02319               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02320}02320 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02321}02321               \textcolor{comment}{// Gravitational body force}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02322}02322               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02323}02323               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02324}02324                 sum += scaled\_re\_inv\_fr * G[2] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02325}02325               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02326}02326 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02327}02327               \textcolor{comment}{// There is NO pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02328}02328 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02329}02329               \textcolor{comment}{// Viscous terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02330}02330               sum -\/= visc\_ratio * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02331}02331                      (d\_dudx\_dX(p, q, 2, 0) * dtestfdx(l, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02332}02332                       interpolated\_dudx(2, 0) * d\_dtestfdx\_dX(p, q, l, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02333}02333                       d\_dudx\_dX(p, q, 2, 1) * dtestfdx(l, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02334}02334                       interpolated\_dudx(2, 1) * d\_dtestfdx\_dX(p, q, l, 1));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02335}02335 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02336}02336               sum += visc\_ratio * Gamma[0] * d\_dudx\_dX(p, q, 2, 0) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02337}02337 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02338}02338               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02339}02339               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02340}02340                 sum -\/= visc\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02341}02341                        (interpolated\_dudx(2, 0) * psif[q] * dtestfdx(l, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02342}02342                         interpolated\_dudx(2, 1) * psif[q] * dtestfdx(l, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02343}02343                         interpolated\_u[2] * psif[q] * testf\_ / (r * r));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02344}02344               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02345}02345 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02346}02346               \textcolor{comment}{// Convective terms, including mesh velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02347}02347               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02348}02348               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02349}02349                 \textcolor{keywordtype}{double} tmp = scaled\_re * interpolated\_u[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02350}02350                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02351}02351                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02352}02352                   tmp -\/= scaled\_re\_st * mesh\_velocity[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02353}02353                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02354}02354                 sum -\/= r * tmp * d\_dudx\_dX(p, q, 2, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02355}02355                 \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02356}02356                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02357}02357                   sum -\/= tmp * interpolated\_dudx(2, k) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02358}02358                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02359}02359               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02360}02360               \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02361}02361               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02362}02362                 sum += scaled\_re\_st * r * pos\_time\_weight *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02363}02363                        interpolated\_dudx(2, p) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02364}02364               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02365}02365 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02366}02366               \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02367}02367               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02368}02368               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02369}02369                 sum -\/= scaled\_re\_st * dudt[2] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02370}02370               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02371}02371 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02372}02372               \textcolor{comment}{// Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02373}02373               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02374}02374               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02375}02375                 sum -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02376}02376                   2.0 * scaled\_re\_inv\_ro * interpolated\_u[0] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02377}02377               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02378}02378 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02379}02379               \textcolor{comment}{// Multiply through by Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02380}02380               dresidual\_dnodal\_coordinates(local\_eqn, p, q) += sum * J * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02381}02381 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02382}02382               \textcolor{comment}{// Derivs w.r.t. to nodal velocities}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02383}02383               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02384}02384               \textcolor{keywordflow}{if} (element\_has\_node\_with\_aux\_node\_update\_fct)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02385}02385               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02386}02386                 \textcolor{comment}{// Contribution from deriv of first velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02387}02387                 \textcolor{keywordtype}{double} tmp = (2.0 * r * scaled\_re\_inv\_ro +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02388}02388                               r * scaled\_re * interpolated\_dudx(2, 0) -\/}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02389}02389                               scaled\_re * interpolated\_u[2]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02390}02390                              psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02391}02391 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02392}02392                 \textcolor{comment}{// Multiply through by dU\_0q/dX\_pq}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02393}02393                 sum = -\/d\_U\_dX(p, q, 0) * tmp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02394}02394 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02395}02395                 \textcolor{comment}{// Contribution from deriv of second velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02396}02396                 \textcolor{comment}{// Multiply through by dU\_1q/dX\_pq}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02397}02397                 sum -\/= d\_U\_dX(p, q, 1) * scaled\_re * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02398}02398                        interpolated\_dudx(2, 1) * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02399}02399 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02400}02400                 \textcolor{comment}{// Contribution from deriv of third velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02401}02401                 tmp = scaled\_re\_st * r * val\_time\_weight * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02402}02402                 tmp -\/= scaled\_re * interpolated\_u[0] * psif[q] * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02403}02403                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02404}02404                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02405}02405                   \textcolor{keywordtype}{double} tmp2 = scaled\_re * interpolated\_u[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02406}02406                   \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02407}02407                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02408}02408                     tmp2 -\/= scaled\_re\_st * mesh\_velocity[k];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02409}02409                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02410}02410                   tmp += r * tmp2 * dpsifdx(q, k) * testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02411}02411                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02412}02412                 tmp += visc\_ratio * (r * dpsifdx(q, 0) -\/ Gamma[0] * psif[q]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02413}02413                        dtestfdx(l, 0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02414}02414                 tmp += r * visc\_ratio * dpsifdx(q, 1) * dtestfdx(l, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02415}02415                 tmp += visc\_ratio * ((psif[q] / r) -\/ Gamma[0] * dpsifdx(q, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02416}02416                        testf\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02417}02417 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02418}02418                 \textcolor{comment}{// Multiply through by dU\_2q/dX\_pq}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02419}02419                 sum -\/= d\_U\_dX(p, q, 2) * tmp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02420}02420 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02421}02421                 \textcolor{comment}{// Multiply through by Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02422}02422                 dresidual\_dnodal\_coordinates(local\_eqn, p, q) += sum * J * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02423}02423               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02424}02424             \} \textcolor{comment}{// End of loop over q}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02425}02425           \} \textcolor{comment}{// End of loop over p}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02426}02426         \} \textcolor{comment}{// End of if it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02427}02427 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02428}02428       \} \textcolor{comment}{// End of loop over test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02429}02429 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02430}02430 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02431}02431       \textcolor{comment}{// ===================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02432}02432       \textcolor{comment}{// CONTINUITY EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02433}02433       \textcolor{comment}{// ===================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02434}02434 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02435}02435       \textcolor{comment}{// Loop over the shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02436}02436       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_pres; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02437}02437       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02438}02438         local\_eqn = p\_local\_eqn(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02439}02439 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02440}02440         \textcolor{comment}{// Cache the test function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02441}02441         \textcolor{keyword}{const} \textcolor{keywordtype}{double} testp\_ = testp[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02442}02442 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02443}02443         \textcolor{comment}{// If not a boundary conditions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02444}02444         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02445}02445         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02446}02446           \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02447}02447           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < 2; p++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02448}02448           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02449}02449             \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02450}02450             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < n\_node; q++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02451}02451             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02452}02452               \textcolor{comment}{// Residual x deriv of Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02453}02453               \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02454}02454 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02455}02455               \textcolor{comment}{// Source term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02456}02456               \textcolor{keywordtype}{double} aux = -\/r * source;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02457}02457 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02458}02458               \textcolor{comment}{// Gradient terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02459}02459               aux += (interpolated\_u[0] + r * interpolated\_dudx(0, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02460}02460                       r * interpolated\_dudx(1, 1));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02461}02461 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02462}02462               \textcolor{comment}{// Multiply through by deriv of Jacobian and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02463}02463               dresidual\_dnodal\_coordinates(local\_eqn, p, q) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02464}02464                 aux * dJ\_dX(p, q) * testp\_ * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02465}02465 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02466}02466               \textcolor{comment}{// Derivative of residual x Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02467}02467               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02468}02468 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02469}02469               \textcolor{comment}{// Gradient of source function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02470}02470               aux = -\/r * source\_gradient[p] * psif[q];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02471}02471               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02472}02472               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02473}02473                 aux -\/= source * psif[q];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02474}02474               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02475}02475 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02476}02476               \textcolor{comment}{// Gradient terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02477}02477               aux += r * (d\_dudx\_dX(p, q, 0, 0) + d\_dudx\_dX(p, q, 1, 1));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02478}02478               \textcolor{keywordflow}{if} (p == 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02479}02479               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02480}02480                 aux +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02481}02481                   (interpolated\_dudx(0, 0) + interpolated\_dudx(1, 1)) * psif[q];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02482}02482               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02483}02483 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02484}02484               \textcolor{comment}{// Derivs w.r.t. nodal velocities}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02485}02485               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02486}02486               \textcolor{keywordflow}{if} (element\_has\_node\_with\_aux\_node\_update\_fct)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02487}02487               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02488}02488                 aux += d\_U\_dX(p, q, 0) * (psif[q] + r * dpsifdx(q, 0));}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02489}02489                 aux += d\_U\_dX(p, q, 1) * r * dpsifdx(q, 1);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02490}02490               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02491}02491 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02492}02492               \textcolor{comment}{// Multiply through by Jacobian, test fct and integration weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02493}02493               dresidual\_dnodal\_coordinates(local\_eqn, p, q) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02494}02494                 aux * testp\_ * J * w;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02495}02495             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02496}02496           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02497}02497         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02498}02498       \} \textcolor{comment}{// End of loop over shape functions for continuity eqn}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02499}02499 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02500}02500     \} \textcolor{comment}{// End of loop over integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02501}02501   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02502}02502 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02503}02503 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02504}02504   \textcolor{comment}{//==============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02505}02505 \textcolor{comment}{  ///  Compute the residuals for the Navier-\/-\/Stokes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02506}02506 \textcolor{comment}{  ///  equations; flag=1(or 0): do (or don't) compute the}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02507}02507 \textcolor{comment}{  ///  Jacobian as well.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02508}02508 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02509}02509   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02510}02510     fill\_in\_generic\_dresidual\_contribution\_axi\_nst(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02511}02511       \textcolor{keywordtype}{double}* \textcolor{keyword}{const}\& parameter\_pt,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02512}02512       Vector<double>\& dres\_dparam,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02513}02513       DenseMatrix<double>\& djac\_dparam,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02514}02514       DenseMatrix<double>\& dmass\_matrix\_dparam,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02515}02515       \textcolor{keywordtype}{unsigned} flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02516}02516   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02517}02517     \textcolor{comment}{// Die if the parameter is not the Reynolds number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02518}02518     \textcolor{keywordflow}{if} (parameter\_pt != this-\/>re\_pt())}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02519}02519     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02520}02520       std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02521}02521       error\_stream}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02522}02522         << \textcolor{stringliteral}{"{}Cannot compute analytic jacobian for parameter addressed by "{}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02523}02523         << parameter\_pt << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02524}02524       error\_stream << \textcolor{stringliteral}{"{}Can only compute derivatives wrt Re ("{}} << Re\_pt << \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02525}02525       \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02526}02526         error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02527}02527     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02528}02528 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02529}02529     \textcolor{comment}{// Which parameters are we differentiating with respect to}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02530}02530     \textcolor{keywordtype}{bool} diff\_re = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02531}02531     \textcolor{keywordtype}{bool} diff\_re\_st = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02532}02532     \textcolor{keywordtype}{bool} diff\_re\_inv\_fr = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02533}02533     \textcolor{keywordtype}{bool} diff\_re\_inv\_ro = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02534}02534 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02535}02535     \textcolor{comment}{// Set the boolean flags according to the parameter pointer}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02536}02536     \textcolor{keywordflow}{if} (parameter\_pt == this-\/>re\_pt())}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02537}02537     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02538}02538       diff\_re = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02539}02539     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02540}02540     \textcolor{keywordflow}{if} (parameter\_pt == this-\/>re\_st\_pt())}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02541}02541     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02542}02542       diff\_re\_st = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02543}02543     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02544}02544     \textcolor{keywordflow}{if} (parameter\_pt == this-\/>re\_invfr\_pt())}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02545}02545     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02546}02546       diff\_re\_inv\_fr = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02547}02547     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02548}02548     \textcolor{keywordflow}{if} (parameter\_pt == this-\/>re\_invro\_pt())}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02549}02549     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02550}02550       diff\_re\_inv\_ro = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02551}02551     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02552}02552 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02553}02553 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02554}02554     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02555}02555     \textcolor{keywordtype}{unsigned} n\_node = nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02556}02556 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02557}02557     \textcolor{comment}{// Find out how many pressure dofs there are}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02558}02558     \textcolor{keywordtype}{unsigned} n\_pres = npres\_axi\_nst();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02559}02559 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02560}02560     \textcolor{comment}{// Get the nodal indices at which the velocity is stored}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02561}02561     \textcolor{keywordtype}{unsigned} u\_nodal\_index[3];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02562}02562     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02563}02563     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02564}02564       u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = u\_index\_axi\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02565}02565     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02566}02566 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02567}02567     \textcolor{comment}{// Set up memory for the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02568}02568     \textcolor{comment}{// Note that there are only two dimensions, r and z in this problem}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02569}02569     Shape psif(n\_node), testf(n\_node);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02570}02570     DShape dpsifdx(n\_node, 2), dtestfdx(n\_node, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02571}02571 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02572}02572     \textcolor{comment}{// Set up memory for pressure shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02573}02573     Shape psip(n\_pres), testp(n\_pres);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02574}02574 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02575}02575     \textcolor{comment}{// Number of integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02576}02576     \textcolor{keywordtype}{unsigned} Nintpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02577}02577 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02578}02578     \textcolor{comment}{// Set the Vector to hold local coordinates (two dimensions)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02579}02579     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02580}02580 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02581}02581     \textcolor{comment}{// Get Physical Variables from Element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02582}02582     \textcolor{comment}{// Reynolds number must be multiplied by the density ratio}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02583}02583     \textcolor{comment}{// double scaled\_re = re()*density\_ratio();}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02584}02584     \textcolor{comment}{// double scaled\_re\_st = re\_st()*density\_ratio();}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02585}02585     \textcolor{comment}{// double scaled\_re\_inv\_fr = re\_invfr()*density\_ratio();}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02586}02586     \textcolor{comment}{// double scaled\_re\_inv\_ro = re\_invro()*density\_ratio();}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02587}02587     \textcolor{keywordtype}{double} dens\_ratio = this-\/>density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02588}02588     \textcolor{comment}{// double visc\_ratio = viscosity\_ratio();}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02589}02589     Vector<double> G = g();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02590}02590 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02591}02591     \textcolor{comment}{// Integers used to store the local equation and unknown numbers}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02592}02592     \textcolor{keywordtype}{int} local\_eqn = 0, local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02593}02593 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02594}02594     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02595}02595     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < Nintpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02596}02596     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02597}02597       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02598}02598       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++) \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02599}02599       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02600}02600       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02601}02601 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02602}02602       \textcolor{comment}{// Call the derivatives of the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02603}02603       \textcolor{keywordtype}{double} J = dshape\_and\_dtest\_eulerian\_at\_knot\_axi\_nst(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02604}02604         ipt, psif, dpsifdx, testf, dtestfdx);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02605}02605 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02606}02606       \textcolor{comment}{// Call the pressure shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02607}02607       pshape\_axi\_nst(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psip, testp);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02608}02608 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02609}02609       \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02610}02610       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02611}02611 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02612}02612       \textcolor{comment}{// Allocate storage for the position and the derivative of the}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02613}02613       \textcolor{comment}{// mesh positions wrt time}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02614}02614       Vector<double> interpolated\_x(2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02615}02615       Vector<double> mesh\_velocity(2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02616}02616       \textcolor{comment}{// Allocate storage for the pressure, velocity components and their}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02617}02617       \textcolor{comment}{// time and spatial derivatives}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02618}02618       \textcolor{keywordtype}{double} interpolated\_p = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02619}02619       Vector<double> interpolated\_u(3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02620}02620       Vector<double> dudt(3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02621}02621       DenseMatrix<double> interpolated\_dudx(3, 2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02622}02622 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02623}02623       \textcolor{comment}{// Calculate pressure at integration point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02624}02624       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_pres; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02625}02625       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02626}02626         interpolated\_p += p\_axi\_nst(l) * psip[l];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02627}02627       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02628}02628 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02629}02629       \textcolor{comment}{// Calculate velocities and derivatives at integration point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02630}02630 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02631}02631       \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02632}02632       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02633}02633       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02634}02634         \textcolor{comment}{// Cache the shape function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02635}02635         \textcolor{keyword}{const} \textcolor{keywordtype}{double} psif\_ = psif(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02636}02636         \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02637}02637         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02638}02638         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02639}02639           interpolated\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += this-\/>raw\_nodal\_position(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02640}02640         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02641}02641         \textcolor{comment}{// mesh\_velocity[i]  += dnodal\_position\_dt(l,i)*psif[l];}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02642}02642 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02643}02643         \textcolor{comment}{// Loop over the three velocity directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02644}02644         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02645}02645         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02646}02646           \textcolor{comment}{// Get the u\_value}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02647}02647           \textcolor{keyword}{const} \textcolor{keywordtype}{double} u\_value = this-\/>raw\_nodal\_value(l, u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02648}02648           interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += u\_value * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02649}02649           dudt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += du\_dt\_axi\_nst(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02650}02650           \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02651}02651           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02652}02652           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02653}02653             interpolated\_dudx(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) += u\_value * dpsifdx(l, j);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02654}02654           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02655}02655         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02656}02656       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02657}02657 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02658}02658       \textcolor{comment}{// Get the mesh velocity if ALE is enabled}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02659}02659       \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02660}02660       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02661}02661         \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02662}02662         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02663}02663         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02664}02664           \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02665}02665           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02666}02666           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02667}02667             mesh\_velocity[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += this-\/>raw\_dnodal\_position\_dt(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02668}02668           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02669}02669         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02670}02670       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02671}02671 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02672}02672 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02673}02673       \textcolor{comment}{// Get the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02674}02674       \textcolor{comment}{// Vector<double> body\_force(3);}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02675}02675       \textcolor{comment}{// get\_body\_force(time(),ipt,interpolated\_x,body\_force);}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02676}02676 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02677}02677       \textcolor{comment}{// Get the user-\/defined source function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02678}02678       \textcolor{comment}{// double source = get\_source\_fct(time(),ipt,interpolated\_x);}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02679}02679 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02680}02680       \textcolor{comment}{// Get the user-\/defined viscosity function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02681}02681       \textcolor{keywordtype}{double} visc\_ratio;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02682}02682       get\_viscosity\_ratio\_axisym\_nst(ipt, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, interpolated\_x, visc\_ratio);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02683}02683 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02684}02684       \textcolor{comment}{// r is the first position component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02685}02685       \textcolor{keywordtype}{double} r = interpolated\_x[0];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02686}02686 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02687}02687 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02688}02688       \textcolor{comment}{// MOMENTUM EQUATIONS}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02689}02689       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02690}02690 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02691}02691       \textcolor{comment}{// Loop over the test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02692}02692       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02693}02693       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02694}02694         \textcolor{comment}{// FIRST (RADIAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02695}02695         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02696}02696         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02697}02697         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02698}02698         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02699}02699           \textcolor{comment}{// No user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02700}02700           \textcolor{comment}{// dres\_dparam[local\_eqn] +=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02701}02701           \textcolor{comment}{// r*body\_force[0]*testf[l]*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02702}02702 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02703}02703           \textcolor{comment}{// Add the gravitational body force term if the reynolds number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02704}02704           \textcolor{comment}{// is equal to re\_inv\_fr}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02705}02705           \textcolor{keywordflow}{if} (diff\_re\_inv\_fr)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02706}02706           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02707}02707             dres\_dparam[local\_eqn] += r * dens\_ratio * testf[l] * G[0] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02708}02708           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02709}02709 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02710}02710           \textcolor{comment}{// No pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02711}02711           \textcolor{comment}{// residuals[local\_eqn]  +=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02712}02712           \textcolor{comment}{// interpolated\_p*(testf[l] + r*dtestfdx(l,0))*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02713}02713 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02714}02714           \textcolor{comment}{// No in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02715}02715           \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02716}02716           \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02717}02717           \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02718}02718           \textcolor{comment}{// residuals[local\_eqn] -\/= visc\_ratio*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02719}02719           \textcolor{comment}{// r*(1.0+Gamma[0])*interpolated\_dudx(0,0)*dtestfdx(l,0)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02720}02720 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02721}02721           \textcolor{comment}{// residuals[local\_eqn] -\/= visc\_ratio*r*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02722}02722           \textcolor{comment}{// (interpolated\_dudx(0,1) + Gamma[0]*interpolated\_dudx(1,0))*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02723}02723           \textcolor{comment}{// dtestfdx(l,1)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02724}02724 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02725}02725           \textcolor{comment}{// residuals[local\_eqn] -\/=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02726}02726           \textcolor{comment}{// visc\_ratio*(1.0 + Gamma[0])*interpolated\_u[0]*testf[l]*W/r;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02727}02727 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02728}02728           \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02729}02729           \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02730}02730           \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02731}02731           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02732}02732             dres\_dparam[local\_eqn] -\/= dens\_ratio * r * dudt[0] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02733}02733           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02734}02734 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02735}02735           \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02736}02736           \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02737}02737           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02738}02738             dres\_dparam[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02739}02739               dens\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02740}02740               (r * interpolated\_u[0] * interpolated\_dudx(0, 0) -\/}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02741}02741                interpolated\_u[2] * interpolated\_u[2] +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02742}02742                r * interpolated\_u[1] * interpolated\_dudx(0, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02743}02743               testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02744}02744           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02745}02745 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02746}02746           \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02747}02747           \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02748}02748           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02749}02749             \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02750}02750             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02751}02751               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02752}02752               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02753}02753                 dres\_dparam[local\_eqn] += dens\_ratio * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02754}02754                                           interpolated\_dudx(0, k) * testf[l] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02755}02755                                           \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02756}02756               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02757}02757             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02758}02758           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02759}02759 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02760}02760           \textcolor{comment}{// Add the Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02761}02761           \textcolor{keywordflow}{if} (diff\_re\_inv\_ro)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02762}02762           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02763}02763             dres\_dparam[local\_eqn] +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02764}02764               2.0 * r * dens\_ratio * interpolated\_u[2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02765}02765           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02766}02766 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02767}02767           \textcolor{comment}{// CALCULATE THE JACOBIAN}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02768}02768           \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02769}02769           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02770}02770             \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02771}02771             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02772}02772             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02773}02773               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02774}02774               \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02775}02775               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02776}02776               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02777}02777                 \textcolor{keywordflow}{if} (flag == 2)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02778}02778                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02779}02779                   \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02780}02780                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02781}02781                     \textcolor{comment}{// Add the mass matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02782}02782                     dmass\_matrix\_dparam(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02783}02783                       dens\_ratio * r * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02784}02784                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02785}02785                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02786}02786 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02787}02787                 \textcolor{comment}{// Add contribution to the Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02788}02788                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02789}02789                 \textcolor{comment}{// -\/= visc\_ratio*r*(1.0+Gamma[0])}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02790}02790                 \textcolor{comment}{//*dpsifdx(l2,0)*dtestfdx(l,0)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02791}02791 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02792}02792                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02793}02793                 \textcolor{comment}{// -\/= visc\_ratio*r*dpsifdx(l2,1)*dtestfdx(l,1)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02794}02794 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02795}02795                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02796}02796                 \textcolor{comment}{// -\/= visc\_ratio*(1.0 + Gamma[0])*psif[l2]*testf[l]*W/r;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02797}02797 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02798}02798                 \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02799}02799                 \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02800}02800                 \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02801}02801                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02802}02802                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02803}02803                     dens\_ratio * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02804}02804                     node\_pt(l2)-\/>time\_stepper\_pt()-\/>weight(1, 0) * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02805}02805                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02806}02806                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02807}02807 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02808}02808                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02809}02809                 \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02810}02810                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02811}02811                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02812}02812                     dens\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02813}02813                     (r * psif[l2] * interpolated\_dudx(0, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02814}02814                      r * interpolated\_u[0] * dpsifdx(l2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02815}02815                      r * interpolated\_u[1] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02816}02816                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02817}02817                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02818}02818 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02819}02819                 \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02820}02820                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02821}02821                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02822}02822                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02823}02823                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02824}02824                     \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02825}02825                     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02826}02826                       djac\_dparam(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02827}02827                         dens\_ratio * r * mesh\_velocity[k] * dpsifdx(l2, k) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02828}02828                         testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02829}02829                     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02830}02830                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02831}02831                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02832}02832               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02833}02833 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02834}02834               \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02835}02835               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02836}02836               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02837}02837               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02838}02838                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown) -\/=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02839}02839                 \textcolor{comment}{// visc\_ratio*r*Gamma[0]*dpsifdx(l2,0)*dtestfdx(l,1)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02840}02840 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02841}02841                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02842}02842                 \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02843}02843                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02844}02844                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02845}02845                     dens\_ratio * r * psif[l2] * interpolated\_dudx(0, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02846}02846                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02847}02847                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02848}02848               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02849}02849 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02850}02850               \textcolor{comment}{// Azimuthal velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02851}02851               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02852}02852               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02853}02853               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02854}02854                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02855}02855                 \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02856}02856                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02857}02857                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02858}02858                     -\/dens\_ratio * 2.0 * interpolated\_u[2] * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02859}02859                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02860}02860                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02861}02861                 \textcolor{comment}{// Coriolis terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02862}02862                 \textcolor{keywordflow}{if} (diff\_re\_inv\_ro)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02863}02863                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02864}02864                   djac\_dparam(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02865}02865                     2.0 * r * dens\_ratio * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02866}02866                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02867}02867               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02868}02868             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02869}02869 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02870}02870             \textcolor{comment}{/*Now loop over pressure shape functions*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02871}02871             \textcolor{comment}{/*This is the contribution from pressure gradient*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02872}02872             \textcolor{comment}{// for(unsigned l2=0;l2<n\_pres;l2++)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02873}02873             \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02874}02874             \textcolor{comment}{//  local\_unknown = p\_local\_eqn(l2);}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02875}02875             \textcolor{comment}{//  /*If we are at a non-\/zero degree of freedom in the entry*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02876}02876             \textcolor{comment}{//  if(local\_unknown >= 0)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02877}02877             \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02878}02878             \textcolor{comment}{//    jacobian(local\_eqn,local\_unknown)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02879}02879             \textcolor{comment}{//     += psip[l2]*(testf[l] + r*dtestfdx(l,0))*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02880}02880             \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02881}02881             \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02882}02882           \} \textcolor{comment}{/*End of Jacobian calculation*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02883}02883 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02884}02884         \} \textcolor{comment}{// End of if not boundary condition statement}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02885}02885 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02886}02886         \textcolor{comment}{// SECOND (AXIAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02887}02887         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02888}02888         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02889}02889         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02890}02890         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02891}02891           \textcolor{comment}{// Add the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02892}02892           \textcolor{comment}{// Remember to multiply by the density ratio!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02893}02893           \textcolor{comment}{// residuals[local\_eqn] +=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02894}02894           \textcolor{comment}{// r*body\_force[1]*testf[l]*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02895}02895 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02896}02896           \textcolor{comment}{// Add the gravitational body force term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02897}02897           \textcolor{keywordflow}{if} (diff\_re\_inv\_fr)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02898}02898           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02899}02899             dres\_dparam[local\_eqn] += r * dens\_ratio * testf[l] * G[1] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02900}02900           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02901}02901 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02902}02902           \textcolor{comment}{// Add the pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02903}02903           \textcolor{comment}{// residuals[local\_eqn]  += r*interpolated\_p*dtestfdx(l,1)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02904}02904 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02905}02905           \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02906}02906           \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02907}02907           \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02908}02908           \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02909}02909           \textcolor{comment}{// residuals[local\_eqn] -\/= visc\_ratio*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02910}02910           \textcolor{comment}{//  r*(interpolated\_dudx(1,0) + Gamma[1]*interpolated\_dudx(0,1))}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02911}02911           \textcolor{comment}{// *dtestfdx(l,0)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02912}02912 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02913}02913           \textcolor{comment}{// residuals[local\_eqn] -\/= visc\_ratio*r*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02914}02914           \textcolor{comment}{// (1.0 + Gamma[1])*interpolated\_dudx(1,1)*dtestfdx(l,1)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02915}02915 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02916}02916           \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02917}02917           \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02918}02918           \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02919}02919           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02920}02920             dres\_dparam[local\_eqn] -\/= dens\_ratio * r * dudt[1] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02921}02921           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02922}02922 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02923}02923           \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02924}02924           \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02925}02925           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02926}02926             dres\_dparam[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02927}02927               dens\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02928}02928               (r * interpolated\_u[0] * interpolated\_dudx(1, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02929}02929                r * interpolated\_u[1] * interpolated\_dudx(1, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02930}02930               testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02931}02931           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02932}02932 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02933}02933           \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02934}02934           \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02935}02935           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02936}02936             \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02937}02937             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02938}02938               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02939}02939               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02940}02940                 dres\_dparam[local\_eqn] += dens\_ratio * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02941}02941                                           interpolated\_dudx(1, k) * testf[l] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02942}02942                                           \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02943}02943               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02944}02944             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02945}02945           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02946}02946 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02947}02947           \textcolor{comment}{// CALCULATE THE JACOBIAN}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02948}02948           \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02949}02949           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02950}02950             \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02951}02951             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02952}02952             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02953}02953               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02954}02954               \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02955}02955               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02956}02956               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02957}02957                 \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02958}02958                 \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02959}02959                 \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02960}02960                 \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02961}02961                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown) -\/=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02962}02962                 \textcolor{comment}{// visc\_ratio*r*Gamma[1]*dpsifdx(l2,1)*dtestfdx(l,0)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02963}02963 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02964}02964                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02965}02965                 \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02966}02966                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02967}02967                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02968}02968                     dens\_ratio * r * psif[l2] * interpolated\_dudx(1, 0) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02969}02969                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02970}02970                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02971}02971               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02972}02972 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02973}02973               \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02974}02974               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02975}02975               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02976}02976               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02977}02977                 \textcolor{keywordflow}{if} (flag == 2)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02978}02978                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02979}02979                   \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02980}02980                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02981}02981                     \textcolor{comment}{// Add the mass matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02982}02982                     dmass\_matrix\_dparam(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02983}02983                       dens\_ratio * r * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02984}02984                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02985}02985                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02986}02986 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02987}02987 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02988}02988                 \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02989}02989                 \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02990}02990                 \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02991}02991                 \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02992}02992                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown) -\/=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02993}02993                 \textcolor{comment}{// visc\_ratio*r*dpsifdx(l2,0)*dtestfdx(l,0)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02994}02994 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02995}02995                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown) -\/=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02996}02996                 \textcolor{comment}{// visc\_ratio*r*(1.0 + Gamma[1])*dpsifdx(l2,1)*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02997}02997                 \textcolor{comment}{// dtestfdx(l,1)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02998}02998 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l02999}02999                 \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03000}03000                 \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03001}03001                 \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03002}03002                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03003}03003                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03004}03004                     dens\_ratio * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03005}03005                     node\_pt(l2)-\/>time\_stepper\_pt()-\/>weight(1, 0) * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03006}03006                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03007}03007                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03008}03008 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03009}03009                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03010}03010                 \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03011}03011                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03012}03012                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03013}03013                     dens\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03014}03014                     (r * interpolated\_u[0] * dpsifdx(l2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03015}03015                      r * psif[l2] * interpolated\_dudx(1, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03016}03016                      r * interpolated\_u[1] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03017}03017                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03018}03018                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03019}03019 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03020}03020                 \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03021}03021                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03022}03022                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03023}03023                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03024}03024                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03025}03025                     \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03026}03026                     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03027}03027                       djac\_dparam(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03028}03028                         dens\_ratio * r * mesh\_velocity[k] * dpsifdx(l2, k) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03029}03029                         testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03030}03030                     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03031}03031                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03032}03032                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03033}03033               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03034}03034 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03035}03035               \textcolor{comment}{// There are no azimithal terms in the axial momentum equation}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03036}03036             \} \textcolor{comment}{// End of loop over velocity shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03037}03037 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03038}03038           \} \textcolor{comment}{/*End of Jacobian calculation*/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03039}03039 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03040}03040         \} \textcolor{comment}{// End of AXIAL MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03041}03041 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03042}03042         \textcolor{comment}{// THIRD (AZIMUTHAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03043}03043         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03044}03044         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03045}03045         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03046}03046           \textcolor{comment}{// Add the user-\/defined body force terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03047}03047           \textcolor{comment}{// Remember to multiply by the density ratio!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03048}03048           \textcolor{comment}{// residuals[local\_eqn] +=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03049}03049           \textcolor{comment}{// r*body\_force[2]*testf[l]*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03050}03050 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03051}03051           \textcolor{comment}{// Add the gravitational body force term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03052}03052           \textcolor{keywordflow}{if} (diff\_re\_inv\_fr)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03053}03053           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03054}03054             dres\_dparam[local\_eqn] += r * dens\_ratio * testf[l] * G[2] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03055}03055           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03056}03056 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03057}03057           \textcolor{comment}{// There is NO pressure gradient term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03058}03058 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03059}03059           \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03060}03060           \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03061}03061           \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03062}03062           \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03063}03063           \textcolor{comment}{// residuals[local\_eqn] -\/= visc\_ratio*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03064}03064           \textcolor{comment}{// (r*interpolated\_dudx(2,0) -\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03065}03065           \textcolor{comment}{//  Gamma[0]*interpolated\_u[2])*dtestfdx(l,0)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03066}03066 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03067}03067           \textcolor{comment}{// residuals[local\_eqn] -\/= visc\_ratio*r*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03068}03068           \textcolor{comment}{// interpolated\_dudx(2,1)*dtestfdx(l,1)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03069}03069 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03070}03070           \textcolor{comment}{// residuals[local\_eqn] -\/= visc\_ratio*}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03071}03071           \textcolor{comment}{// ((interpolated\_u[2]/r) -\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03072}03072           \textcolor{comment}{// Gamma[0]*interpolated\_dudx(2,0))*testf[l]*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03073}03073 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03074}03074 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03075}03075           \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03076}03076           \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03077}03077           \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03078}03078           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03079}03079             dres\_dparam[local\_eqn] -\/= dens\_ratio * r * dudt[2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03080}03080           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03081}03081 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03082}03082           \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03083}03083           \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03084}03084           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03085}03085             dres\_dparam[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03086}03086               dens\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03087}03087               (r * interpolated\_u[0] * interpolated\_dudx(2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03088}03088                interpolated\_u[0] * interpolated\_u[2] +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03089}03089                r * interpolated\_u[1] * interpolated\_dudx(2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03090}03090               testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03091}03091           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03092}03092 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03093}03093           \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03094}03094           \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03095}03095           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03096}03096             \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03097}03097             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03098}03098               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03099}03099               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03100}03100                 dres\_dparam[local\_eqn] += dens\_ratio * r * mesh\_velocity[k] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03101}03101                                           interpolated\_dudx(2, k) * testf[l] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03102}03102                                           \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03103}03103               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03104}03104             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03105}03105           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03106}03106 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03107}03107           \textcolor{comment}{// Add the Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03108}03108           \textcolor{keywordflow}{if} (diff\_re\_inv\_ro)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03109}03109           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03110}03110             dres\_dparam[local\_eqn] -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03111}03111               2.0 * r * dens\_ratio * interpolated\_u[0] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03112}03112           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03113}03113 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03114}03114           \textcolor{comment}{// CALCULATE THE JACOBIAN}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03115}03115           \textcolor{keywordflow}{if} (flag)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03116}03116           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03117}03117             \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03118}03118             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03119}03119             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03120}03120               \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03121}03121               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03122}03122               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03123}03123               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03124}03124                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03125}03125                 \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03126}03126                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03127}03127                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03128}03128                     dens\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03129}03129                     (r * psif[l2] * interpolated\_dudx(2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03130}03130                      psif[l2] * interpolated\_u[2]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03131}03131                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03132}03132                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03133}03133 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03134}03134                 \textcolor{comment}{// Coriolis term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03135}03135                 \textcolor{keywordflow}{if} (diff\_re\_inv\_ro)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03136}03136                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03137}03137                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03138}03138                     2.0 * r * dens\_ratio * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03139}03139                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03140}03140               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03141}03141 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03142}03142               \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03143}03143               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03144}03144               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03145}03145               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03146}03146                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03147}03147                 \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03148}03148                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03149}03149                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03150}03150                     dens\_ratio * r * psif[l2] * interpolated\_dudx(2, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03151}03151                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03152}03152                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03153}03153               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03154}03154 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03155}03155               \textcolor{comment}{// Azimuthal velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03156}03156               local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03157}03157               \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03158}03158               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03159}03159                 \textcolor{keywordflow}{if} (flag == 2)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03160}03160                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03161}03161                   \textcolor{comment}{// Add the mass matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03162}03162                   \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03163}03163                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03164}03164                     dmass\_matrix\_dparam(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03165}03165                       dens\_ratio * r * psif[l2] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03166}03166                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03167}03167                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03168}03168 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03169}03169                 \textcolor{comment}{// Add in the stress tensor terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03170}03170                 \textcolor{comment}{// The viscosity ratio needs to go in here to ensure}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03171}03171                 \textcolor{comment}{// continuity of normal stress is satisfied even in flows}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03172}03172                 \textcolor{comment}{// with zero pressure gradient!}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03173}03173                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown) -\/=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03174}03174                 \textcolor{comment}{// visc\_ratio*(r*dpsifdx(l2,0) -\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03175}03175                 \textcolor{comment}{//                  Gamma[0]*psif[l2])*dtestfdx(l,0)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03176}03176 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03177}03177                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown) -\/=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03178}03178                 \textcolor{comment}{// visc\_ratio*r*dpsifdx(l2,1)*dtestfdx(l,1)*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03179}03179 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03180}03180                 \textcolor{comment}{// jacobian(local\_eqn,local\_unknown) -\/=}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03181}03181                 \textcolor{comment}{// visc\_ratio*((psif[l2]/r) -\/ Gamma[0]*dpsifdx(l2,0))}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03182}03182                 \textcolor{comment}{// *testf[l]*W;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03183}03183 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03184}03184                 \textcolor{comment}{// Add in the inertial terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03185}03185                 \textcolor{comment}{// du/dt term}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03186}03186                 \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03187}03187                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03188}03188                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03189}03189                     dens\_ratio * r *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03190}03190                     node\_pt(l2)-\/>time\_stepper\_pt()-\/>weight(1, 0) * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03191}03191                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03192}03192                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03193}03193 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03194}03194                 \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03195}03195                 \textcolor{keywordflow}{if} (diff\_re)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03196}03196                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03197}03197                   djac\_dparam(local\_eqn, local\_unknown) -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03198}03198                     dens\_ratio *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03199}03199                     (r * interpolated\_u[0] * dpsifdx(l2, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03200}03200                      interpolated\_u[0] * psif[l2] +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03201}03201                      r * interpolated\_u[1] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03202}03202                     testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03203}03203                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03204}03204 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03205}03205                 \textcolor{comment}{// Mesh velocity terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03206}03206                 \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03207}03207                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03208}03208                   \textcolor{keywordflow}{if} (diff\_re\_st)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03209}03209                   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03210}03210                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03211}03211                     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03212}03212                       djac\_dparam(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03213}03213                         dens\_ratio * r * mesh\_velocity[k] * dpsifdx(l2, k) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03214}03214                         testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03215}03215                     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03216}03216                   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03217}03217                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03218}03218               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03219}03219             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03220}03220 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03221}03221             \textcolor{comment}{// There are no pressure terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03222}03222           \} \textcolor{comment}{// End of Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03223}03223 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03224}03224         \} \textcolor{comment}{// End of AZIMUTHAL EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03225}03225 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03226}03226       \} \textcolor{comment}{// End of loop over shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03227}03227 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03228}03228 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03229}03229       \textcolor{comment}{// CONTINUITY EQUATION NO PARAMETERS}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03230}03230       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03231}03231     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03232}03232   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03233}03233 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03234}03234   \textcolor{comment}{//=========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03235}03235 \textcolor{comment}{  /// Compute the hessian tensor vector products required to}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03236}03236 \textcolor{comment}{  /// perform continuation of bifurcations analytically}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03237}03237 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03238}03238   \textcolor{keywordtype}{void} AxisymmetricNavierStokesEquations::}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03239}03239     fill\_in\_contribution\_to\_hessian\_vector\_products(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03240}03240       Vector<double> \textcolor{keyword}{const}\& Y,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03241}03241       DenseMatrix<double> \textcolor{keyword}{const}\& C,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03242}03242       DenseMatrix<double>\& product)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03243}03243   \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03244}03244     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03245}03245     \textcolor{keywordtype}{unsigned} n\_node = nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03246}03246 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03247}03247     \textcolor{comment}{// Get the nodal indices at which the velocity is stored}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03248}03248     \textcolor{keywordtype}{unsigned} u\_nodal\_index[3];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03249}03249     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03250}03250     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03251}03251       u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = u\_index\_axi\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03252}03252     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03253}03253 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03254}03254     \textcolor{comment}{// Set up memory for the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03255}03255     \textcolor{comment}{// Note that there are only two dimensions, r and z in this problem}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03256}03256     Shape psif(n\_node), testf(n\_node);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03257}03257     DShape dpsifdx(n\_node, 2), dtestfdx(n\_node, 2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03258}03258 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03259}03259     \textcolor{comment}{// Number of integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03260}03260     \textcolor{keywordtype}{unsigned} Nintpt = integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03261}03261 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03262}03262     \textcolor{comment}{// Set the Vector to hold local coordinates (two dimensions)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03263}03263     Vector<double> \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03264}03264 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03265}03265     \textcolor{comment}{// Get Physical Variables from Element}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03266}03266     \textcolor{comment}{// Reynolds number must be multiplied by the density ratio}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03267}03267     \textcolor{keywordtype}{double} scaled\_re = re() * density\_ratio();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03268}03268     \textcolor{comment}{// double visc\_ratio = viscosity\_ratio();}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03269}03269     Vector<double> G = g();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03270}03270 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03271}03271     \textcolor{comment}{// Integers used to store the local equation and unknown numbers}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03272}03272     \textcolor{keywordtype}{int} local\_eqn = 0, local\_unknown = 0, local\_freedom = 0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03273}03273 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03274}03274     \textcolor{comment}{// How may dofs are there}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03275}03275     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dof = this-\/>ndof();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03276}03276 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03277}03277     \textcolor{comment}{// Create a local matrix eigenvector product contribution}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03278}03278     DenseMatrix<double> jac\_y(n\_dof, n\_dof, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03279}03279 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03280}03280     \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03281}03281     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < Nintpt; ipt++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03282}03282     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03283}03283       \textcolor{comment}{// Assign values of s}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03284}03284       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++) \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = integral\_pt()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03285}03285       \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03286}03286       \textcolor{keywordtype}{double} w = integral\_pt()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03287}03287 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03288}03288       \textcolor{comment}{// Call the derivatives of the shape and test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03289}03289       \textcolor{keywordtype}{double} J = dshape\_and\_dtest\_eulerian\_at\_knot\_axi\_nst(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03290}03290         ipt, psif, dpsifdx, testf, dtestfdx);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03291}03291 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03292}03292       \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03293}03293       \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03294}03294 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03295}03295       \textcolor{comment}{// Allocate storage for the position and the derivative of the}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03296}03296       \textcolor{comment}{// mesh positions wrt time}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03297}03297       Vector<double> interpolated\_x(2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03298}03298       \textcolor{comment}{// Vector<double> mesh\_velocity(2,0.0);}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03299}03299       \textcolor{comment}{// Allocate storage for the pressure, velocity components and their}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03300}03300       \textcolor{comment}{// time and spatial derivatives}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03301}03301       Vector<double> interpolated\_u(3, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03302}03302       \textcolor{comment}{// Vector<double> dudt(3,0.0);}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03303}03303       DenseMatrix<double> interpolated\_dudx(3, 2, 0.0);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03304}03304 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03305}03305       \textcolor{comment}{// Calculate velocities and derivatives at integration point}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03306}03306 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03307}03307       \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03308}03308       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03309}03309       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03310}03310         \textcolor{comment}{// Cache the shape function}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03311}03311         \textcolor{keyword}{const} \textcolor{keywordtype}{double} psif\_ = psif(l);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03312}03312         \textcolor{comment}{// Loop over the two coordinate directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03313}03313         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03314}03314         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03315}03315           interpolated\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += this-\/>raw\_nodal\_position(l, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03316}03316         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03317}03317 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03318}03318         \textcolor{comment}{// Loop over the three velocity directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03319}03319         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03320}03320         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03321}03321           \textcolor{comment}{// Get the u\_value}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03322}03322           \textcolor{keyword}{const} \textcolor{keywordtype}{double} u\_value = this-\/>raw\_nodal\_value(l, u\_nodal\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03323}03323           interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += u\_value * psif\_;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03324}03324           \textcolor{comment}{// dudt[i]+= du\_dt\_axi\_nst(l,i)*psif\_;}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03325}03325           \textcolor{comment}{// Loop over derivative directions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03326}03326           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03327}03327           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03328}03328             interpolated\_dudx(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) += u\_value * dpsifdx(l, j);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03329}03329           \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03330}03330         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03331}03331       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03332}03332 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03333}03333       \textcolor{comment}{// Get the mesh velocity if ALE is enabled}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03334}03334       \textcolor{keywordflow}{if} (!ALE\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03335}03335       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03336}03336         \textcolor{keywordflow}{throw} OomphLibError(\textcolor{stringliteral}{"{}Moving nodes not implemented\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03337}03337                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03338}03338                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03339}03339       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03340}03340 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03341}03341       \textcolor{comment}{// r is the first position component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03342}03342       \textcolor{keywordtype}{double} r = interpolated\_x[0];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03343}03343 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03344}03344 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03345}03345       \textcolor{comment}{// MOMENTUM EQUATIONS}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03346}03346       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03347}03347 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03348}03348       \textcolor{comment}{// Loop over the test functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03349}03349       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < n\_node; l++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03350}03350       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03351}03351         \textcolor{comment}{// FIRST (RADIAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03352}03352         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03353}03353         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03354}03354         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03355}03355         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03356}03356           \textcolor{comment}{// Loop over the velocity shape functions yet again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03357}03357           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l3 = 0; l3 < n\_node; l3++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03358}03358           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03359}03359             \textcolor{comment}{// Derivative of jacobian terms with respect to radial velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03360}03360             local\_freedom = nodal\_local\_eqn(l3, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03361}03361             \textcolor{keywordflow}{if} (local\_freedom >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03362}03362             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03363}03363               \textcolor{comment}{// Storage for the sums}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03364}03364               \textcolor{keywordtype}{double} temp = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03365}03365 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03366}03366               \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03367}03367               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03368}03368               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03369}03369                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03370}03370                 \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03371}03371                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03372}03372                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03373}03373                   \textcolor{comment}{// Remains of convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03374}03374                   temp -\/= scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03375}03375                           (r * psif[l2] * dpsifdx(l3, 0) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03376}03376                            r * psif[l3] * dpsifdx(l2, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03377}03377                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03378}03378                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03379}03379 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03380}03380                 \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03381}03381                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03382}03382                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03383}03383                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03384}03384                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03385}03385                   temp -\/= scaled\_re * r * psif[l2] * dpsifdx(l3, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03386}03386                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03387}03387                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03388}03388               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03389}03389               \textcolor{comment}{// Add the summed contribution to the product matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03390}03390               jac\_y(local\_eqn, local\_freedom) += temp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03391}03391             \} \textcolor{comment}{// End of derivative wrt radial coordinate}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03392}03392 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03393}03393 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03394}03394             \textcolor{comment}{// Derivative of jacobian terms with respect to axial velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03395}03395             local\_freedom = nodal\_local\_eqn(l3, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03396}03396             \textcolor{keywordflow}{if} (local\_freedom >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03397}03397             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03398}03398               \textcolor{keywordtype}{double} temp = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03399}03399 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03400}03400               \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03401}03401               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03402}03402               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03403}03403                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03404}03404                 \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03405}03405                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03406}03406                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03407}03407                   \textcolor{comment}{// Remains of convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03408}03408                   temp -\/= scaled\_re * (r * psif[l3] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03409}03409                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03410}03410                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03411}03411               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03412}03412               \textcolor{comment}{// Add the summed contribution to the product matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03413}03413               jac\_y(local\_eqn, local\_freedom) += temp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03414}03414             \} \textcolor{comment}{// End of derivative wrt axial coordinate}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03415}03415 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03416}03416             \textcolor{comment}{// Derivative of jacobian terms with respect to azimuthal velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03417}03417             local\_freedom = nodal\_local\_eqn(l3, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03418}03418             \textcolor{keywordflow}{if} (local\_freedom >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03419}03419             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03420}03420               \textcolor{keywordtype}{double} temp = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03421}03421 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03422}03422               \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03423}03423               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03424}03424               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03425}03425                 \textcolor{comment}{// Azimuthal velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03426}03426                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03427}03427                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03428}03428                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03429}03429                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03430}03430                   temp -\/= -\/scaled\_re * 2.0 * psif[l3] * psif[l2] *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03431}03431                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03432}03432                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03433}03433               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03434}03434               \textcolor{comment}{// Add the summed contibution}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03435}03435               jac\_y(local\_eqn, local\_freedom) += temp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03436}03436 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03437}03437             \} \textcolor{comment}{// End of if not boundary condition statement}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03438}03438           \} \textcolor{comment}{// End of loop over freedoms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03439}03439         \} \textcolor{comment}{// End of RADIAL MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03440}03440 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03441}03441 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03442}03442         \textcolor{comment}{// SECOND (AXIAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03443}03443         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03444}03444         \textcolor{comment}{// If it's not a boundary condition}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03445}03445         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03446}03446         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03447}03447           \textcolor{comment}{// Loop over the velocity shape functions yet again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03448}03448           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l3 = 0; l3 < n\_node; l3++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03449}03449           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03450}03450             \textcolor{comment}{// Derivative of jacobian terms with respect to radial velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03451}03451             local\_freedom = nodal\_local\_eqn(l3, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03452}03452             \textcolor{keywordflow}{if} (local\_freedom >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03453}03453             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03454}03454               \textcolor{keywordtype}{double} temp = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03455}03455 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03456}03456               \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03457}03457               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03458}03458               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03459}03459                 \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03460}03460                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03461}03461                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03462}03462                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03463}03463                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03464}03464                   temp -\/= scaled\_re * (r * psif[l3] * dpsifdx(l2, 0)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03465}03465                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03466}03466                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03467}03467               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03468}03468               jac\_y(local\_eqn, local\_freedom) += temp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03469}03469 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03470}03470               \textcolor{comment}{// There are no azimithal terms in the axial momentum equation}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03471}03471             \} \textcolor{comment}{// End of loop over velocity shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03472}03472 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03473}03473 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03474}03474             \textcolor{comment}{// Derivative of jacobian terms with respect to axial velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03475}03475             local\_freedom = nodal\_local\_eqn(l3, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03476}03476             \textcolor{keywordflow}{if} (local\_freedom >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03477}03477             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03478}03478               \textcolor{keywordtype}{double} temp = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03479}03479 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03480}03480               \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03481}03481               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03482}03482               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03483}03483                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03484}03484                 \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03485}03485                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03486}03486                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03487}03487                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03488}03488                   temp -\/= scaled\_re * r * psif[l2] * dpsifdx(l3, 0) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03489}03489                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03490}03490                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03491}03491 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03492}03492                 \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03493}03493                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03494}03494                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03495}03495                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03496}03496                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03497}03497                   temp -\/= scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03498}03498                           (r * psif[l2] * dpsifdx(l3, 1) +}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03499}03499                            r * psif[l3] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03500}03500                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03501}03501                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03502}03502 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03503}03503                 \textcolor{comment}{// There are no azimithal terms in the axial momentum equation}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03504}03504               \} \textcolor{comment}{// End of loop over velocity shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03505}03505 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03506}03506               \textcolor{comment}{// Add summed contributiont to jacobian product matrix}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03507}03507               jac\_y(local\_eqn, local\_freedom) += temp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03508}03508             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03509}03509           \} \textcolor{comment}{// End of loop over local freedoms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03510}03510 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03511}03511         \} \textcolor{comment}{// End of AXIAL MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03512}03512 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03513}03513         \textcolor{comment}{// THIRD (AZIMUTHAL) MOMENTUM EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03514}03514         local\_eqn = nodal\_local\_eqn(l, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03515}03515         \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03516}03516         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03517}03517           \textcolor{comment}{// Loop over the velocity shape functions yet again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03518}03518           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l3 = 0; l3 < n\_node; l3++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03519}03519           \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03520}03520             \textcolor{comment}{// Derivative of jacobian terms with respect to radial velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03521}03521             local\_freedom = nodal\_local\_eqn(l3, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03522}03522             \textcolor{keywordflow}{if} (local\_freedom >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03523}03523             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03524}03524               \textcolor{keywordtype}{double} temp = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03525}03525 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03526}03526               \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03527}03527               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03528}03528               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03529}03529                 \textcolor{comment}{// Azimuthal velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03530}03530                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03531}03531                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03532}03532                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03533}03533                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03534}03534                   temp -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03535}03535                     scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03536}03536                     (r * psif[l3] * dpsifdx(l2, 0) + psif[l3] * psif[l2]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03537}03537                     Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03538}03538                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03539}03539               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03540}03540               \textcolor{comment}{// Add the summed contribution to the jacobian eigenvector sum}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03541}03541               jac\_y(local\_eqn, local\_freedom) += temp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03542}03542             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03543}03543 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03544}03544             \textcolor{comment}{// Derivative of jacobian terms with respect to axial velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03545}03545             local\_freedom = nodal\_local\_eqn(l3, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03546}03546             \textcolor{keywordflow}{if} (local\_freedom >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03547}03547             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03548}03548               \textcolor{keywordtype}{double} temp = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03549}03549 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03550}03550               \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03551}03551               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03552}03552               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03553}03553                 \textcolor{comment}{// Azimuthal velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03554}03554                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03555}03555                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03556}03556                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03557}03557                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03558}03558                   temp -\/= scaled\_re * (r * psif[l3] * dpsifdx(l2, 1)) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03559}03559                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03560}03560                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03561}03561               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03562}03562               \textcolor{comment}{// Add the summed contribution to the jacobian eigenvector sum}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03563}03563               jac\_y(local\_eqn, local\_freedom) += temp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03564}03564             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03565}03565 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03566}03566 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03567}03567             \textcolor{comment}{// Derivative of jacobian terms with respect to azimuthal velocity}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03568}03568             local\_freedom = nodal\_local\_eqn(l3, u\_nodal\_index[2]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03569}03569             \textcolor{keywordflow}{if} (local\_freedom >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03570}03570             \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03571}03571               \textcolor{keywordtype}{double} temp = 0.0;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03572}03572 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03573}03573 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03574}03574               \textcolor{comment}{// Loop over the velocity shape functions again}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03575}03575               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l2 = 0; l2 < n\_node; l2++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03576}03576               \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03577}03577                 \textcolor{comment}{// Radial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03578}03578                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[0]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03579}03579                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03580}03580                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03581}03581                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03582}03582                   temp -\/=}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03583}03583                     scaled\_re *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03584}03584                     (r * psif[l2] * dpsifdx(l3, 0) + psif[l2] * psif[l3]) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03585}03585                     Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03586}03586                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03587}03587 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03588}03588                 \textcolor{comment}{// Axial velocity component}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03589}03589                 local\_unknown = nodal\_local\_eqn(l2, u\_nodal\_index[1]);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03590}03590                 \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03591}03591                 \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03592}03592                   \textcolor{comment}{// Convective terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03593}03593                   temp -\/= scaled\_re * r * psif[l2] * dpsifdx(l3, 1) *}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03594}03594                           Y[local\_unknown] * testf[l] * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03595}03595                 \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03596}03596               \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03597}03597               \textcolor{comment}{// Add the fully summed contribution}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03598}03598               jac\_y(local\_eqn, local\_freedom) += temp;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03599}03599             \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03600}03600           \} \textcolor{comment}{// End of loop over freedoms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03601}03601 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03602}03602           \textcolor{comment}{// There are no pressure terms}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03603}03603         \} \textcolor{comment}{// End of AZIMUTHAL EQUATION}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03604}03604 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03605}03605       \} \textcolor{comment}{// End of loop over shape functions}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03606}03606     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03607}03607 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03608}03608     \textcolor{comment}{// We have now assembled the matrix (d J\_\{ij\} Y\_j)/d u\_\{k\}}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03609}03609     \textcolor{comment}{// and simply need to sum over the vectors}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03610}03610     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_vec = C.nrow();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03611}03611     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03612}03612     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03613}03613       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dof; k++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03614}03614       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03615}03615         \textcolor{comment}{// Cache the value of the hessian y product}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03616}03616         \textcolor{keyword}{const} \textcolor{keywordtype}{double} j\_y = jac\_y(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, k);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03617}03617         \textcolor{comment}{// Loop over the possible vectors}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03618}03618         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_vec; v++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03619}03619         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03620}03620           product(v, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) += j\_y * C(v, k);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03621}03621         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03622}03622       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03623}03623     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03624}03624   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03625}03625 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03626}03626 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03627}03627 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03628}03628 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03629}03629 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03630}03630 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03631}03631   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03632}03632 \textcolor{comment}{  /// Create a list of pairs for all unknowns in this element,}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03633}03633 \textcolor{comment}{  /// so that the first entry in each pair contains the global equation}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03634}03634 \textcolor{comment}{  /// number of the unknown, while the second one contains the number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03635}03635 \textcolor{comment}{  /// of the "{}DOF type"{} that this unknown is associated with.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03636}03636 \textcolor{comment}{  /// (Function can obviously only be called if the equation numbering}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03637}03637 \textcolor{comment}{  /// scheme has been set up.)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03638}03638 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03639}\mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_a83a50021a007f1a932fe841119d93412}{03639}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_a83a50021a007f1a932fe841119d93412}{AxisymmetricQCrouzeixRaviartElement::get\_dof\_numbers\_for\_unknowns}}(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03640}03640     std::list<std::pair<unsigned long, unsigned>>\& dof\_lookup\_list)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03641}03641 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03642}03642     \textcolor{comment}{// number of nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03643}03643     \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03644}03644 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03645}03645     \textcolor{comment}{// number of pressure values}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03646}03646     \textcolor{keywordtype}{unsigned} n\_press = this-\/>\mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_a923c2ccbc5bd523118273e63cc18fd5f}{npres\_axi\_nst}}();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03647}03647 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03648}03648     \textcolor{comment}{// temporary pair (used to store dof lookup prior to being added to list)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03649}03649     std::pair<unsigned, unsigned> dof\_lookup;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03650}03650 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03651}03651     \textcolor{comment}{// pressure dof number (is this really OK?)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03652}03652     \textcolor{keywordtype}{unsigned} pressure\_dof\_number = 3;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03653}03653 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03654}03654     \textcolor{comment}{// loop over the pressure values}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03655}03655     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_press; n++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03656}03656     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03657}03657       \textcolor{comment}{// determine local eqn number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03658}03658       \textcolor{keywordtype}{int} local\_eqn\_number = this-\/>\mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_adc569122e3649deba56231175f3116cf}{p\_local\_eqn}}(n);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03659}03659 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03660}03660       \textcolor{comment}{// ignore pinned values -\/ far away degrees of freedom resulting}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03661}03661       \textcolor{comment}{// from hanging nodes can be ignored since these are be dealt}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03662}03662       \textcolor{comment}{// with by the element containing their master nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03663}03663       \textcolor{keywordflow}{if} (local\_eqn\_number >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03664}03664       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03665}03665         \textcolor{comment}{// store dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03666}03666         \textcolor{comment}{// is global equation number; second entry is dof type}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03667}03667         dof\_lookup.first = this-\/>eqn\_number(local\_eqn\_number);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03668}03668         dof\_lookup.second = pressure\_dof\_number;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03669}03669 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03670}03670         \textcolor{comment}{// add to list}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03671}03671         dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03672}03672       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03673}03673     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03674}03674 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03675}03675     \textcolor{comment}{// loop over the nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03676}03676     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03677}03677     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03678}03678       \textcolor{comment}{// find the number of values at this node}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03679}03679       \textcolor{keywordtype}{unsigned} nv = this-\/>node\_pt(n)-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03680}03680 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03681}03681       \textcolor{comment}{// loop over these values}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03682}03682       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < nv; v++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03683}03683       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03684}03684         \textcolor{comment}{// determine local eqn number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03685}03685         \textcolor{keywordtype}{int} local\_eqn\_number = this-\/>nodal\_local\_eqn(n, v);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03686}03686 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03687}03687         \textcolor{comment}{// ignore pinned values}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03688}03688         \textcolor{keywordflow}{if} (local\_eqn\_number >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03689}03689         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03690}03690           \textcolor{comment}{// store dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03691}03691           \textcolor{comment}{// is global equation number; second entry is dof type}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03692}03692           dof\_lookup.first = this-\/>eqn\_number(local\_eqn\_number);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03693}03693           dof\_lookup.second = v;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03694}03694 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03695}03695           \textcolor{comment}{// add to list}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03696}03696           dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03697}03697         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03698}03698       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03699}03699     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03700}03700   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03701}03701 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03702}03702 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03703}03703 \textcolor{comment}{  /// Axisymmetric Crouzeix-\/Raviart elements}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03704}03704 \textcolor{comment}{}  \textcolor{comment}{// Set the data for the number of Variables at each node}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03705}03705   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_a6edd4a05741c3ee8ee1ac82f7c3f9eff}{AxisymmetricQCrouzeixRaviartElement::Initial\_Nvalue}}[9] = \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03706}03706     3, 3, 3, 3, 3, 3, 3, 3, 3\};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03707}03707 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03708}03708   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03709}03709 \textcolor{comment}{  /// Number of values (pinned or dofs) required at node n.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03710}03710 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03711}\mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_ae7988679549e63ef87fc3f062fb6a559}{03711}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_ae7988679549e63ef87fc3f062fb6a559}{AxisymmetricQCrouzeixRaviartElement::required\_nvalue}}(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03712}03712     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03713}03713 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03714}03714     \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_a6edd4a05741c3ee8ee1ac82f7c3f9eff}{Initial\_Nvalue}}[n];}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03715}03715   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03716}03716 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03717}03717   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03718}03718 \textcolor{comment}{  /// Compute traction at local coordinate s for outer unit normal N}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03719}03719 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03720}\mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_a60ea4ee3c006bc04984f1dcadb87a79d}{03720}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1AxisymmetricQCrouzeixRaviartElement_a60ea4ee3c006bc04984f1dcadb87a79d}{AxisymmetricQCrouzeixRaviartElement::get\_traction}}(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03721}03721     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03722}03722     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03723}03723     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& traction)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03724}03724 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03725}03725     AxisymmetricNavierStokesEquations::traction(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}, traction);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03726}03726   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03727}03727 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03728}03728 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03729}03729 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03730}03730 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03731}03731 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03732}03732 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03733}03733   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03734}03734 \textcolor{comment}{  /// Create a list of pairs for all unknowns in this element,}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03735}03735 \textcolor{comment}{  /// so the first entry in each pair contains the global equation}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03736}03736 \textcolor{comment}{  /// number of the unknown, while the second one contains the number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03737}03737 \textcolor{comment}{  /// of the "{}DOF type"{} that this unknown is associated with.}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03738}03738 \textcolor{comment}{  /// (Function can obviously only be called if the equation numbering}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03739}03739 \textcolor{comment}{  /// scheme has been set up.)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03740}03740 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03741}\mbox{\hyperlink{classoomph_1_1AxisymmetricQTaylorHoodElement_ad763c91177814d4221ec485b076a38e9}{03741}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1AxisymmetricQTaylorHoodElement_ad763c91177814d4221ec485b076a38e9}{AxisymmetricQTaylorHoodElement::get\_dof\_numbers\_for\_unknowns}}(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03742}03742     std::list<std::pair<unsigned long, unsigned>>\& dof\_lookup\_list)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03743}03743 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03744}03744     \textcolor{comment}{// number of nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03745}03745     \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03746}03746 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03747}03747     \textcolor{comment}{// temporary pair (used to store dof lookup prior to being added to list)}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03748}03748     std::pair<unsigned, unsigned> dof\_lookup;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03749}03749 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03750}03750     \textcolor{comment}{// loop over the nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03751}03751     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03752}03752     \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03753}03753       \textcolor{comment}{// find the number of values at this node}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03754}03754       \textcolor{keywordtype}{unsigned} nv = this-\/>node\_pt(n)-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03755}03755 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03756}03756       \textcolor{comment}{// loop over these values}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03757}03757       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < nv; v++)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03758}03758       \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03759}03759         \textcolor{comment}{// determine local eqn number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03760}03760         \textcolor{keywordtype}{int} local\_eqn\_number = this-\/>nodal\_local\_eqn(n, v);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03761}03761 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03762}03762         \textcolor{comment}{// ignore pinned values -\/ far away degrees of freedom resulting}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03763}03763         \textcolor{comment}{// from hanging nodes can be ignored since these are be dealt}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03764}03764         \textcolor{comment}{// with by the element containing their master nodes}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03765}03765         \textcolor{keywordflow}{if} (local\_eqn\_number >= 0)}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03766}03766         \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03767}03767           \textcolor{comment}{// store dof lookup in temporary pair: Global equation number}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03768}03768           \textcolor{comment}{// is the first entry in pair}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03769}03769           dof\_lookup.first = this-\/>eqn\_number(local\_eqn\_number);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03770}03770 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03771}03771           \textcolor{comment}{// set dof numbers: Dof number is the second entry in pair}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03772}03772           dof\_lookup.second = v;}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03773}03773 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03774}03774           \textcolor{comment}{// add to list}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03775}03775           dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03776}03776         \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03777}03777       \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03778}03778     \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03779}03779   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03780}03780 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03781}03781 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03782}03782   \textcolor{comment}{// Axisymmetric Taylor-\/-\/Hood}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03783}03783   \textcolor{comment}{// Set the data for the number of Variables at each node}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03784}03784   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1AxisymmetricQTaylorHoodElement_ae0826bd23cb739552135795de862c758}{AxisymmetricQTaylorHoodElement::Initial\_Nvalue}}[9] = \{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03785}03785     4, 3, 4, 3, 3, 3, 4, 3, 4\};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03786}03786 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03787}03787   \textcolor{comment}{// Set the data for the pressure conversion array}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03788}03788   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1AxisymmetricQTaylorHoodElement_a40720e74e6b8ce8d803ee95d7a6ad119}{AxisymmetricQTaylorHoodElement::Pconv}}[4] = \{0, 2, 6, 8\};}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03789}03789 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03790}03790 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03791}03791   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03792}03792 \textcolor{comment}{  /// Compute traction at local coordinate s for outer unit normal N}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03793}03793 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03794}\mbox{\hyperlink{classoomph_1_1AxisymmetricQTaylorHoodElement_abfaf2fb0ff51a888f77c724af8c20809}{03794}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1AxisymmetricQTaylorHoodElement_abfaf2fb0ff51a888f77c724af8c20809}{AxisymmetricQTaylorHoodElement::get\_traction}}(}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03795}03795     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03796}03796     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}},}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03797}03797     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& traction)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03798}03798 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03799}03799     AxisymmetricNavierStokesEquations::traction(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}, traction);}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03800}03800   \}}
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03801}03801 }
\DoxyCodeLine{\Hypertarget{axisym__navier__stokes__elements_8cc_source_l03802}03802 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

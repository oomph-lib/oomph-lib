\hypertarget{missing__masters_8cc_source}{}\doxysection{missing\+\_\+masters.\+cc}
\label{missing__masters_8cc_source}\index{missing\_masters.cc@{missing\_masters.cc}}
\mbox{\hyperlink{missing__masters_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2022 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00026}00026 \textcolor{comment}{// Non-\/templated missing masters functions which help to reconcile the hanging}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00027}00027 \textcolor{comment}{// status of nodes in the halo layer of distributed meshes}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00029}00029 \textcolor{comment}{// oomph-\/lib header}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00030}00030 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{missing__masters_8h}{missing\_masters.h}}"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00031}00031 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{missing__masters_8template_8cc}{missing\_masters.template.cc}}"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00032}00032 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mesh_8h}{mesh.h}}"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00033}00033 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{algebraic__elements_8h}{algebraic\_elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00034}00034 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{macro__element__node__update__element_8h}{macro\_element\_node\_update\_element.h}}"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00035}00035 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Qelements_8h}{Qelements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00037}00037 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00038}00038 \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00039}00039   \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00040}00040   \textcolor{comment}{// Namespace for "{}global"{} missing-\/master-\/locating functions}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00041}00041   \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00042}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions}{00042}}   \textcolor{keyword}{namespace }Missing\_masters\_functions}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00043}00043   \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00044}00044     \textcolor{comment}{// Workspace for locate zeta methods}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00045}00045     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00047}00047 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00048}00048 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00049}00049     \textcolor{comment}{// Temporary vector of strings to enable full annotation of multi domain}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00050}00050     \textcolor{comment}{// comms (but keep alive because it would be such a bloody pain to}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00051}00051     \textcolor{comment}{// rewrite it if things ever go wrong again...)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00052}00052     \textcolor{comment}{// This is left over from the multi-\/domain stuff and should work}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00053}00053     \textcolor{comment}{// in the same way, but it has not been tested.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00054}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{00054}}     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<std::string>}} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00056}00056 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00057}00057 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00058}00058 \textcolor{comment}{    /// Boolean to indicate whether to doc timings or not.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00059}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_acd9cae489a6217b1566a1e40cbca86cf}{00059}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_acd9cae489a6217b1566a1e40cbca86cf}{Doc\_timings}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00060}00060 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00061}00061 \textcolor{comment}{    /// Boolean to indicate whether to output basic info during}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00062}00062 \textcolor{comment}{    ///        setup\_multi\_domain\_interaction() routines}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00063}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a86ac04bf0028ba6e66c07466cc9774ce}{00063}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a86ac04bf0028ba6e66c07466cc9774ce}{Doc\_stats}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00064}00064 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00065}00065 \textcolor{comment}{    /// Boolean to indicate whether to output further info during}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00066}00066 \textcolor{comment}{    ///        setup\_multi\_domain\_interaction() routines}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00067}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a5059632b6254fcfc11f688e3e643d71c}{00067}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a5059632b6254fcfc11f688e3e643d71c}{Doc\_full\_stats}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00069}00069 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00072}00072     \textcolor{comment}{// Functions for location method in multi-\/domain problems}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00074}00074     \textcolor{comment}{//========start of add\_external\_haloed\_node\_to\_storage====================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00075}00075 \textcolor{comment}{    /// Helper function to add external haloed nodes, including any masters}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00076}00076 \textcolor{comment}{}    \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00077}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a94805dfb28ba45ff7f4d7a0d6fef108d}{00077}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a94805dfb28ba45ff7f4d7a0d6fef108d}{add\_external\_haloed\_node\_to\_storage}}(\textcolor{keywordtype}{int}\& iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00078}00078                                              \mbox{\hyperlink{classoomph_1_1Node}{Node}}* nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00079}00079                                              \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00080}00080                                              \textcolor{keywordtype}{int}\& n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00081}00081                                              \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00082}00082                                              \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& send\_doubles)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00083}00083     \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00084}00084       \textcolor{comment}{// Add the node if required}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00085}00085       \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a6034e2c1c81a56272efd35886b2a9543}{add\_external\_haloed\_node\_helper}}(iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00086}00086                                       nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00087}00087                                       mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00088}00088                                       n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00089}00089                                       send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00090}00090                                       send\_doubles);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00092}00092       \textcolor{comment}{// Recursively add any master nodes (and their master nodes etc)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00093}00093       \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a954b632d3a93388358723d33bca9c549}{recursively\_add\_masters\_of\_external\_haloed\_node}}(iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00094}00094                                                       nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00095}00095                                                       mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00096}00096                                                       n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00097}00097                                                       send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00098}00098                                                       send\_doubles);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00099}00099     \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00102}00102     \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00103}00103 \textcolor{comment}{    /// Recursively add any master nodes (and their master nodes etc) of}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00104}00104 \textcolor{comment}{    /// external nodes}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00105}00105 \textcolor{comment}{}    \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00106}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a954b632d3a93388358723d33bca9c549}{00106}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a954b632d3a93388358723d33bca9c549}{recursively\_add\_masters\_of\_external\_haloed\_node}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00107}00107       \textcolor{keywordtype}{int}\& iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00108}00108       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00109}00109       \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00110}00110       \textcolor{keywordtype}{int}\& n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00111}00111       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00112}00112       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& send\_doubles)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00113}00113     \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00114}00114       \textcolor{comment}{// Loop over continuously interpolated values and add masters}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00115}00115       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_cont = -\/1; i\_cont < n\_cont\_inter\_values; i\_cont++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00116}00116       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00117}00117         \textcolor{keywordflow}{if} (nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_af0e6237dfafad62cf427ff5013ddcfef}{is\_hanging}}(i\_cont))}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00118}00118         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00119}00119           \textcolor{comment}{// Indicate that this node is a hanging node so the other}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00120}00120           \textcolor{comment}{// process knows to create HangInfo and masters, etc.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00121}00121           send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00122}00122 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00123}00123           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Is hanging"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00124}00124 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00125}00125           \textcolor{comment}{// If this is a hanging node then add all its masters as}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00126}00126           \textcolor{comment}{// external halo nodes if they have not yet been added}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00127}00127           \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* hang\_pt = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}(i\_cont);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00128}00128           \textcolor{comment}{// Loop over masters}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00129}00129           \textcolor{keywordtype}{unsigned} n\_master = hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00131}00131           \textcolor{comment}{// Indicate number of master nodes to add on other process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00132}00132           send\_unsigneds.push\_back(n\_master);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00133}00133 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00134}00134           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}nmaster"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00135}00135 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00136}00136           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master; m++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00137}00137           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00138}00138             \mbox{\hyperlink{classoomph_1_1Node}{Node}}* master\_nod\_pt = hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(m);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00140}00140             \textcolor{comment}{// Call the helper function for master nodes}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00141}00141             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_acd3ecd40c8ebcfdb04f2e26c3fc304cc}{add\_external\_haloed\_master\_node\_helper}}(iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00142}00142                                                    master\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00143}00143                                                    mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00144}00144                                                    n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00145}00145                                                    send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00146}00146                                                    send\_doubles);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00148}00148             \textcolor{comment}{// Indicate the weight of this master}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00149}00149             send\_doubles.push\_back(hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_ac49ebdd8957a658fe4a2420108d2dcee}{master\_weight}}(m));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00151}00151             \textcolor{comment}{// Recursively add any master nodes (and their master nodes etc)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00152}00152             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a954b632d3a93388358723d33bca9c549}{recursively\_add\_masters\_of\_external\_haloed\_node}}(iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00153}00153                                                             master\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00154}00154                                                             mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00155}00155                                                             n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00156}00156                                                             send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00157}00157                                                             send\_doubles);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00158}00158           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00159}00159         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00160}00160         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00161}00161         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00162}00162           \textcolor{comment}{// Indicate that it's not a hanging node in this variable}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00163}00163           send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00164}00164 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00165}00165           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Not hanging"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00166}00166 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00167}00167         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00168}00168       \} \textcolor{comment}{// end loop over continously interpolated values}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00169}00169     \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00170}00170 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00171}00171     \textcolor{comment}{//==========start of add\_external\_haloed\_node\_helper======================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00172}00172 \textcolor{comment}{    /// Helper to add external haloed node that is not a master}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00173}00173 \textcolor{comment}{}    \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00174}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a6034e2c1c81a56272efd35886b2a9543}{00174}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a6034e2c1c81a56272efd35886b2a9543}{add\_external\_haloed\_node\_helper}}(\textcolor{keywordtype}{int}\& iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00175}00175                                          \mbox{\hyperlink{classoomph_1_1Node}{Node}}* nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00176}00176                                          \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00177}00177                                          \textcolor{keywordtype}{int}\& n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00178}00178                                          \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00179}00179                                          \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& send\_doubles)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00180}00180     \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00181}00181       \textcolor{comment}{// Check to see if this haloed node already exists in (internal)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00182}00182       \textcolor{comment}{// haloed node storage with any processor}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00183}00183       \textcolor{keywordtype}{bool} found\_internally = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00184}00184       \textcolor{keywordtype}{unsigned} shared\_node\_index = 0;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00185}00185 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00186}00186       \textcolor{comment}{// Get vector of all shared nodes with processor iproc}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00187}00187       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} shared\_node\_pt;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00188}00188       mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac7df5130201504b27ce2de8a8b9037f5}{get\_shared\_node\_pt}}(iproc, shared\_node\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00190}00190       \textcolor{comment}{// Search the internal haloed storage for this node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00191}00191       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>::iterator}} it =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00192}00192         std::find(shared\_node\_pt.begin(), shared\_node\_pt.end(), nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00193}00193 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00194}00194       \textcolor{comment}{// Check if the node was found in shared storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00195}00195       \textcolor{keywordflow}{if} (it != shared\_node\_pt.end())}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00196}00196       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00197}00197         \textcolor{comment}{// Node found in (internal) haloed storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00198}00198         found\_internally = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00199}00199         \textcolor{comment}{// Store the index in this storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00200}00200         shared\_node\_index = it -\/ shared\_node\_pt.begin();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00201}00201       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00202}00202 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00203}00203 \textcolor{comment}{      /// / Slow search version without additional access function in Mesh class}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00204}00204 \textcolor{comment}{      /// /Search the internal shared node storage for this node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00205}00205 \textcolor{comment}{}      \textcolor{comment}{// for(unsigned i=0; i<mesh\_pt-\/>nshared\_node(iproc); i++)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00206}00206       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00207}00207       \textcolor{comment}{//  if(nod\_pt == mesh\_pt-\/>shared\_node\_pt(iproc,i))}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00208}00208       \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00209}00209       \textcolor{comment}{//    //Node found in (internal) shared storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00210}00210       \textcolor{comment}{//    found\_internally = true;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00211}00211       \textcolor{comment}{//    shared\_node\_index = i;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00212}00212       \textcolor{comment}{//    break;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00213}00213       \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00214}00214       \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00215}00215 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00216}00216       \textcolor{comment}{// If we've found the node internally}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00217}00217       \textcolor{keywordflow}{if} (found\_internally)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00218}00218       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00219}00219         \textcolor{comment}{// Indicate that this node doesn not need to be constructed on}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00220}00220         \textcolor{comment}{// the other process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00221}00221         send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00222}00222 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00223}00223         std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00224}00224         junk << \textcolor{stringliteral}{"{}Node was already added [size="{}} << send\_unsigneds.size()}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00225}00225              << \textcolor{stringliteral}{"{}]; last entry: "{}} << send\_unsigneds[send\_unsigneds.size() -\/ 1];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00226}00226 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00227}00227         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00228}00228 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00229}00229 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00230}00230         \textcolor{comment}{// This node is already shared with processor iproc, so tell the other}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00231}00231         \textcolor{comment}{// processor its index in the shared node storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00232}00232         send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00233}00233 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00234}00234         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}haloed node found internally"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00235}00235 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00236}00236         send\_unsigneds.push\_back(shared\_node\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00237}00237 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00238}00238         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}(internal) haloed node index"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00239}00239 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00240}00240       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00241}00241       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00242}00242       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00243}00243         \textcolor{comment}{// Attempt to add this node as an external haloed node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00244}00244         \textcolor{keywordtype}{unsigned} n\_ext\_haloed\_nod = mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad37eca6c72c9687954aa2d321938d692}{nexternal\_haloed\_node}}(iproc);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00245}00245         \textcolor{keywordtype}{unsigned} external\_haloed\_node\_index;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00246}00246         external\_haloed\_node\_index =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00247}00247           mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a2cc2600eb480287be5afe6bebf430c00}{add\_external\_haloed\_node\_pt}}(iproc, nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00248}00248 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00249}00249         \textcolor{comment}{// If it was added then the new index should match the size of the}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00250}00250         \textcolor{comment}{// storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00251}00251         \textcolor{keywordflow}{if} (external\_haloed\_node\_index == n\_ext\_haloed\_nod)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00252}00252         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00253}00253           \textcolor{comment}{// Indicate that this node needs to be constructed on}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00254}00254           \textcolor{comment}{// the other process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00255}00255           send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00256}00256 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00257}00257           std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00258}00258           junk << \textcolor{stringliteral}{"{}Node needs to be constructed [size="{}} << send\_unsigneds.size()}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00259}00259                << \textcolor{stringliteral}{"{}]; last entry: "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00260}00260                << send\_unsigneds[send\_unsigneds.size() -\/ 1];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00261}00261           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00262}00262 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00264}00264           \textcolor{comment}{// This helper function gets all the required information for the}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00265}00265           \textcolor{comment}{// specified node and stores it into MPI-\/sendable information}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00266}00266           \textcolor{comment}{// so that a halo copy can be made on the receiving process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00267}00267           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_acc3c8930de1090a3dd7d4a3ddb55cacb}{get\_required\_nodal\_information\_helper}}(iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00268}00268                                                 nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00269}00269                                                 mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00270}00270                                                 n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00271}00271                                                 send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00272}00272                                                 send\_doubles);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00273}00273         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00274}00274         \textcolor{keywordflow}{else} \textcolor{comment}{// It was already added}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00275}00275         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00276}00276           \textcolor{comment}{// Indicate that this node doesn not need to be constructed on}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00277}00277           \textcolor{comment}{// the other process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00278}00278           send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00279}00279 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00280}00280           std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00281}00281           junk << \textcolor{stringliteral}{"{}Node was already added [size="{}} << send\_unsigneds.size()}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00282}00282                << \textcolor{stringliteral}{"{}]; last entry: "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00283}00283                << send\_unsigneds[send\_unsigneds.size() -\/ 1];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00284}00284 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00285}00285           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00286}00286 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00287}00287 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00288}00288           \textcolor{comment}{// This node is already an external haloed node, so tell}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00289}00289           \textcolor{comment}{// the other process its index in the equivalent external halo storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00290}00290           send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00291}00291 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00292}00292           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00293}00293             \textcolor{stringliteral}{"{}haloed node found externally"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00294}00294 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00295}00295           send\_unsigneds.push\_back(external\_haloed\_node\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00296}00296 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00297}00297           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}external haloed node index"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00298}00298 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00299}00299         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00300}00300       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00301}00301     \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00302}00302 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00303}00303 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00304}00304     \textcolor{comment}{//==========start of add\_external\_haloed\_master\_node\_helper===============}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00305}00305 \textcolor{comment}{    /// Helper function to add external haloed node that is a master}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00306}00306 \textcolor{comment}{}    \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00307}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_acd3ecd40c8ebcfdb04f2e26c3fc304cc}{00307}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_acd3ecd40c8ebcfdb04f2e26c3fc304cc}{add\_external\_haloed\_master\_node\_helper}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00308}00308       \textcolor{keywordtype}{int}\& iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00309}00309       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* master\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00310}00310       \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00311}00311       \textcolor{keywordtype}{int}\& n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00312}00312       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00313}00313       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& send\_doubles)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00314}00314     \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00315}00315       \textcolor{comment}{// Check to see if this haloed node already exists in (internal)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00316}00316       \textcolor{comment}{// haloed node storage with any processor}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00317}00317       \textcolor{keywordtype}{bool} found\_internally = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00318}00318       \textcolor{keywordtype}{unsigned} shared\_node\_index = 0;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00320}00320       \textcolor{comment}{// Get vector of all shared nodes with processor iproc}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00321}00321       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} shared\_node\_pt;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00322}00322       mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac7df5130201504b27ce2de8a8b9037f5}{get\_shared\_node\_pt}}(iproc, shared\_node\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00324}00324       \textcolor{comment}{// Search the internal haloed storage for this node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00325}00325       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>::iterator}} it =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00326}00326         std::find(shared\_node\_pt.begin(), shared\_node\_pt.end(), master\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00327}00327 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00328}00328       \textcolor{comment}{// Check if the node was found in shared storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00329}00329       \textcolor{keywordflow}{if} (it != shared\_node\_pt.end())}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00330}00330       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00331}00331         \textcolor{comment}{// Node found in (internal) haloed storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00332}00332         found\_internally = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00333}00333         \textcolor{comment}{// Store the index in this storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00334}00334         shared\_node\_index = it -\/ shared\_node\_pt.begin();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00335}00335       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00336}00336 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00337}00337 \textcolor{comment}{      /// / Slow search version without additional access function in Mesh class}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00338}00338 \textcolor{comment}{      /// /Search the internal shared node storage for this node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00339}00339 \textcolor{comment}{}      \textcolor{comment}{// for(unsigned i=0; i<mesh\_pt-\/>nshared\_node(iproc); i++)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00340}00340       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00341}00341       \textcolor{comment}{//  if(master\_nod\_pt == mesh\_pt-\/>shared\_node\_pt(iproc,i))}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00342}00342       \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00343}00343       \textcolor{comment}{//    //Node found in (internal) shared storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00344}00344       \textcolor{comment}{//    found\_internally = true;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00345}00345       \textcolor{comment}{//    shared\_node\_index = i;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00346}00346       \textcolor{comment}{//    break;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00347}00347       \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00348}00348       \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00349}00349 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00350}00350       \textcolor{comment}{// If we've found the node internally}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00351}00351       \textcolor{keywordflow}{if} (found\_internally)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00352}00352       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00353}00353         \textcolor{comment}{// Indicate that this node doesn not need to be constructed on}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00354}00354         \textcolor{comment}{// the other process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00355}00355         send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00356}00356 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00357}00357         std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00358}00358         junk << \textcolor{stringliteral}{"{}Node was already added [size="{}} << send\_unsigneds.size()}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00359}00359              << \textcolor{stringliteral}{"{}]; last entry: "{}} << send\_unsigneds[send\_unsigneds.size() -\/ 1];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00360}00360 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00361}00361         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00362}00362 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00364}00364         \textcolor{comment}{// This node is already shared with processor iproc, so tell the other}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00365}00365         \textcolor{comment}{// processor its index in the shared node storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00366}00366         send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00367}00367 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00368}00368         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}haloed node found internally"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00369}00369 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00370}00370         send\_unsigneds.push\_back(shared\_node\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00371}00371 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00372}00372         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}(internal) haloed node index"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00373}00373 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00374}00374       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00375}00375       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00376}00376       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00377}00377         \textcolor{comment}{// Attempt to add node as an external haloed node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00378}00378         \textcolor{keywordtype}{unsigned} n\_ext\_haloed\_nod = mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad37eca6c72c9687954aa2d321938d692}{nexternal\_haloed\_node}}(iproc);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00379}00379         \textcolor{keywordtype}{unsigned} external\_haloed\_node\_index;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00380}00380         external\_haloed\_node\_index =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00381}00381           mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a2cc2600eb480287be5afe6bebf430c00}{add\_external\_haloed\_node\_pt}}(iproc, master\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00383}00383         \textcolor{comment}{// If it was added the returned index is the same as current storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00384}00384         \textcolor{comment}{// size}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00385}00385         \textcolor{keywordflow}{if} (external\_haloed\_node\_index == n\_ext\_haloed\_nod)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00386}00386         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00387}00387           \textcolor{comment}{// Indicate that this node needs to be constructed on}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00388}00388           \textcolor{comment}{// the other process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00389}00389           send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00390}00390 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00391}00391           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00392}00392             \textcolor{stringliteral}{"{}Node needs to be constructed[2]"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00393}00393 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00395}00395           \textcolor{comment}{// This gets all the required information for the specified}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00396}00396           \textcolor{comment}{// master node and stores it into MPI-\/sendable information}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00397}00397           \textcolor{comment}{// so that a halo copy can be made on the receiving process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00398}00398           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a56eaf8c8da98960d9929a0c9921c4df7}{get\_required\_master\_nodal\_information\_helper}}(iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00399}00399                                                        master\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00400}00400                                                        mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00401}00401                                                        n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00402}00402                                                        send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00403}00403                                                        send\_doubles);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00404}00404         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00405}00405         \textcolor{keywordflow}{else} \textcolor{comment}{// It was already added}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00406}00406         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00407}00407           \textcolor{comment}{// Indicate that this node doesn not need to be constructed on}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00408}00408           \textcolor{comment}{// the other process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00409}00409           send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00410}00410 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00411}00411           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Node was already added[2]"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00412}00412 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00413}00413 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00414}00414           \textcolor{comment}{// This node is already an external haloed node, so tell}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00415}00415           \textcolor{comment}{// the other process its index in the equivalent external halo storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00416}00416           send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00417}00417 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00418}00418           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00419}00419             \textcolor{stringliteral}{"{}haloed node found externally"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00420}00420 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00421}00421           send\_unsigneds.push\_back(external\_haloed\_node\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00422}00422 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00423}00423           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00424}00424             \textcolor{stringliteral}{"{}external haloed node index[2]"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00425}00425 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00426}00426         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00427}00427       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00428}00428     \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00429}00429 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00431}00431     \textcolor{comment}{//========start of get\_required\_nodal\_information\_helper==================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00432}00432 \textcolor{comment}{    /// Helper function to get the required nodal information from an}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00433}00433 \textcolor{comment}{    /// external haloed node so that a fully-\/functional external halo}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00434}00434 \textcolor{comment}{    /// node (and therefore element) can be created on the receiving process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00435}00435 \textcolor{comment}{}    \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00436}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_acc3c8930de1090a3dd7d4a3ddb55cacb}{00436}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_acc3c8930de1090a3dd7d4a3ddb55cacb}{get\_required\_nodal\_information\_helper}}(\textcolor{keywordtype}{int}\& iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00437}00437                                                \mbox{\hyperlink{classoomph_1_1Node}{Node}}* nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00438}00438                                                \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00439}00439                                                \textcolor{keywordtype}{int}\& n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00440}00440                                                \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00441}00441                                                \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& send\_doubles)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00442}00442     \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00443}00443       \textcolor{comment}{// Tell the halo copy of this node how many values there are}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00444}00444       \textcolor{comment}{// [NB this may be different for nodes within the same element, e.g.}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00445}00445       \textcolor{comment}{//  when using Lagrange multipliers]}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00446}00446       \textcolor{keywordtype}{unsigned} n\_val = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00447}00447       send\_unsigneds.push\_back(n\_val);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00448}00448 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00449}00449       \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Number of values"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00450}00450 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00451}00451 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00452}00452       \textcolor{keywordtype}{unsigned} n\_dim = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a786c96a8e46eb27a03b2b31f629d41b3}{ndim}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00453}00453       \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a065d7bffcec82bf4d4bd7b41f9aa80b3}{time\_stepper\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00454}00454 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00455}00455       \textcolor{comment}{// Default number of previous values to 1}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00456}00456       \textcolor{keywordtype}{unsigned} n\_prev = 1;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00457}00457       \textcolor{keywordflow}{if} (time\_stepper\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00458}00458       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00459}00459         \textcolor{comment}{// Add number of history values to n\_prev}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00460}00460         n\_prev = time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00461}00461       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00462}00462 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00463}00463       \textcolor{comment}{// Is the node on any boundaries?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00464}00464       \textcolor{keywordflow}{if} (nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a2ca215e42116ee8a2acc7d6a35e37788}{is\_on\_boundary}}())}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00465}00465       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00466}00466         send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00467}00467 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00468}00468         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Node is on boundary"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00469}00469 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00470}00470 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00471}00471         \textcolor{comment}{// Loop over the boundaries of the external mesh}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00472}00472         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} boundaries;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00473}00473         \textcolor{keywordtype}{unsigned} n\_bnd = mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00474}00474         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_bnd = 0; i\_bnd < n\_bnd; i\_bnd++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00475}00475         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00476}00476           \textcolor{comment}{// Which boundaries (could be more than one) is it on?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00477}00477           \textcolor{keywordflow}{if} (nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a2ca215e42116ee8a2acc7d6a35e37788}{is\_on\_boundary}}(i\_bnd))}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00478}00478           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00479}00479             boundaries.push\_back(i\_bnd);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00480}00480           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00481}00481         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00482}00482         \textcolor{keywordtype}{unsigned} nb = boundaries.size();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00483}00483         send\_unsigneds.push\_back(nb);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00484}00484 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00485}00485         std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00486}00486         junk << \textcolor{stringliteral}{"{}Node is on "{}} << nb << \textcolor{stringliteral}{"{} boundaries"{}};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00487}00487         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00488}00488 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00489}00489         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nb; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00490}00490         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00491}00491           send\_unsigneds.push\_back(boundaries[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00492}00492 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00493}00493           std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00494}00494           junk << \textcolor{stringliteral}{"{}Node is on boundary "{}} << boundaries[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} of "{}} << n\_bnd;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00495}00495           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00496}00496 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00497}00497         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00499}00499         \textcolor{comment}{// Get pointer to the map of indices associated with}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00500}00500         \textcolor{comment}{// additional values created by face elements}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00501}00501         \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00502}00502 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00503}00503         \textcolor{keywordflow}{if} (bnod\_pt == 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00504}00504         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00505}00505           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Failed to cast new node to boundary node\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00506}00506                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00507}00507                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00508}00508         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00509}00509 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00510}00510         std::map<unsigned, unsigned>* map\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00511}00511           bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a5f73c54dbb9bdfe3538b61117a0cc674}{index\_of\_first\_value\_assigned\_by\_face\_element\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00512}00512 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00513}00513         \textcolor{comment}{// No additional values created}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00514}00514         \textcolor{keywordflow}{if} (map\_pt == 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00515}00515         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00516}00516           send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00517}00517 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00518}00518           std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00519}00519           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00520}00520             \textcolor{stringliteral}{"{}No additional values were created by face element"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00521}00521 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00522}00522         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00523}00523         \textcolor{comment}{// Created additional values}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00524}00524         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00525}00525         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00526}00526           \textcolor{comment}{// How many?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00527}00527           send\_unsigneds.push\_back(map\_pt-\/>size());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00528}00528 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00529}00529           std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00530}00530           junk << \textcolor{stringliteral}{"{}Map size "{}} << map\_pt-\/>size() << n\_bnd;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00531}00531           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00532}00532 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00533}00533           \textcolor{comment}{// Loop over entries in map and add to send data}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00534}00534           \textcolor{keywordflow}{for} (std::map<unsigned, unsigned>::iterator p = map\_pt-\/>begin();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00535}00535                p != map\_pt-\/>end();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00536}00536                p++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00537}00537           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00538}00538             send\_unsigneds.push\_back((*p).first);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00539}00539 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00540}00540             std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00541}00541             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Key of map entry"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00542}00542 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00543}00543             send\_unsigneds.push\_back((*p).second);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00544}00544 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00545}00545             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Value of map entry"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00546}00546 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00547}00547           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00548}00548         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00549}00549       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00550}00550       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00551}00551       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00552}00552         \textcolor{comment}{// Not on any boundary}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00553}00553         send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00554}00554 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00555}00555         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Node is not on any boundary"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00556}00556 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00557}00557       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00558}00558 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00559}00559       \textcolor{comment}{// Is the Node algebraic?  If so, send its ref values and}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00560}00560       \textcolor{comment}{// an indication of its geometric objects if they are stored}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00561}00561       \textcolor{comment}{// in the algebraic mesh}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00562}00562       \mbox{\hyperlink{classoomph_1_1AlgebraicNode}{AlgebraicNode}}* alg\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicNode}{AlgebraicNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00563}00563       \textcolor{keywordflow}{if} (alg\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00564}00564       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00565}00565         \textcolor{comment}{// The external mesh should be algebraic}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00566}00566         \mbox{\hyperlink{classoomph_1_1AlgebraicMesh}{AlgebraicMesh}}* alg\_mesh\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicMesh}{AlgebraicMesh}}*\textcolor{keyword}{>}(mesh\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00567}00567 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00568}00568         \textcolor{comment}{// Get default node update function ID}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00569}00569         \textcolor{keywordtype}{unsigned} update\_id = alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a8887f3a7c445b098835a7703c3a19bd2}{node\_update\_fct\_id}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00570}00570         send\_unsigneds.push\_back(update\_id);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00571}00571 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00572}00572         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Alg Node update id"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00573}00573 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00574}00574 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00575}00575         \textcolor{comment}{// Get reference values at default...}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00576}00576         \textcolor{keywordtype}{unsigned} n\_ref\_val = alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a18b508012bc638d85539568219865383}{nref\_value}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00577}00577         send\_unsigneds.push\_back(n\_ref\_val);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00578}00578 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00579}00579         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Alg Node n ref values"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00580}00580 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00581}00581         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_ref\_val = 0; i\_ref\_val < n\_ref\_val; i\_ref\_val++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00582}00582         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00583}00583           send\_doubles.push\_back(alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a9658be0ccdb312e7cf0175663407f463}{ref\_value}}(i\_ref\_val));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00584}00584         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00585}00585 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00586}00586         \textcolor{comment}{// Access geometric objects at default...}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00587}00587         \textcolor{keywordtype}{unsigned} n\_geom\_obj = alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a0e1fa66d3543da39a5e728d8af5c1734}{ngeom\_object}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00588}00588         send\_unsigneds.push\_back(n\_geom\_obj);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00589}00589 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00590}00590         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Alg Node n geom objects"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00591}00591 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00592}00592         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_geom = 0; i\_geom < n\_geom\_obj; i\_geom++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00593}00593         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00594}00594           \mbox{\hyperlink{classoomph_1_1GeomObject}{GeomObject}}* geom\_obj\_pt = alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a72a49e9a56c2bab91b1467547671fe65}{geom\_object\_pt}}(i\_geom);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00595}00595 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00596}00596           \textcolor{comment}{// Check this against the stored geometric objects in mesh}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00597}00597           \textcolor{keywordtype}{unsigned} n\_geom\_list = alg\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicMesh_ab6a636ffb928e10e004747988fb03404}{ngeom\_object\_list\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00598}00598 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00599}00599           \textcolor{comment}{// Default found index to zero}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00600}00600           \textcolor{keywordtype}{unsigned} found\_geom\_object = 0;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00601}00601           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_list = 0; i\_list < n\_geom\_list; i\_list++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00602}00602           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00603}00603             \textcolor{keywordflow}{if} (geom\_obj\_pt == alg\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicMesh_a7257c48270d6dbc21b78d7e49cc6d952}{geom\_object\_list\_pt}}(i\_list))}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00604}00604             \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00605}00605               found\_geom\_object = i\_list;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00606}00606             \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00607}00607           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00608}00608           send\_unsigneds.push\_back(found\_geom\_object);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00609}00609 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00610}00610           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Found geom object"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00611}00611 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00612}00612         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00613}00613       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00614}00614 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00615}00615       \textcolor{comment}{// If it is a MacroElementNodeUpdateNode, everything has been}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00616}00616       \textcolor{comment}{// dealt with by the new element already}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00617}00617 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00618}00618       \textcolor{comment}{// Is it a SolidNode?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00619}00619       \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00620}00620       \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00621}00621       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00622}00622         \textcolor{keywordtype}{unsigned} n\_solid\_val = solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00623}00623         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_val = 0; i\_val < n\_solid\_val; i\_val++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00624}00624         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00625}00625           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00626}00626           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00627}00627             send\_doubles.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00628}00628               solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a9383101536882db34e618cbe30dba2da}{value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, i\_val));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00629}00629           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00630}00630         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00631}00631       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00632}00632 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00633}00633       \textcolor{comment}{// Finally copy info required for all node types}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00634}00634       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_val = 0; i\_val < n\_val; i\_val++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00635}00635       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00636}00636         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00637}00637         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00638}00638           send\_doubles.push\_back(nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afcc5cdba40bca251826ae5bee5ca15b4}{value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, i\_val));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00639}00639         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00640}00640       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00641}00641 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00642}00642       \textcolor{comment}{// Now do positions}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00643}00643       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} idim = 0; idim < n\_dim; idim++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00644}00644       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00645}00645         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00646}00646         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00647}00647           send\_doubles.push\_back(nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, idim));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00648}00648         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00649}00649       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00650}00650     \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00651}00651 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00652}00652     \textcolor{comment}{//=========start of get\_required\_master\_nodal\_information\_helper==========}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00653}00653 \textcolor{comment}{    /// Helper function to get the required master nodal information from an}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00654}00654 \textcolor{comment}{    /// external haloed master node so that a fully-\/functional external halo}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00655}00655 \textcolor{comment}{    /// master node (and possible element) can be created on the receiving}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00656}00656 \textcolor{comment}{    /// process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00657}00657 \textcolor{comment}{}    \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00658}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a56eaf8c8da98960d9929a0c9921c4df7}{00658}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a56eaf8c8da98960d9929a0c9921c4df7}{get\_required\_master\_nodal\_information\_helper}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00659}00659       \textcolor{keywordtype}{int}\& iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00660}00660       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* master\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00661}00661       \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00662}00662       \textcolor{keywordtype}{int}\& n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00663}00663       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00664}00664       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& send\_doubles)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00665}00665     \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00666}00666       \textcolor{comment}{// Need to send over dimension, position type and number of values}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00667}00667       send\_unsigneds.push\_back(master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a786c96a8e46eb27a03b2b31f629d41b3}{ndim}}());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00668}00668 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00669}00669       \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Master node ndim"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00670}00670 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00671}00671       send\_unsigneds.push\_back(master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_aee6f2b7a46fc9d875c6736895d7fc095}{nposition\_type}}());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00672}00672 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00673}00673       \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Master node npos\_type"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00674}00674 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00675}00675       send\_unsigneds.push\_back(master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00676}00676 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00677}00677       \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Master node nvalue"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00678}00678 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00679}00679       \textcolor{keywordflow}{if} (master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a6227d2775850d6cf482d8af0afc50f5c}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00680}00680       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00681}00681         send\_unsigneds.push\_back(master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_ae8ef6f90c536b83bd393dbc87920741e}{non\_halo\_proc\_ID}}());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00682}00682       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00683}00683       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00684}00684       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00685}00685         send\_unsigneds.push\_back(mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_acf161a414b4cf0ee905f0d54fc27c24a}{communicator\_pt}}()-\/>my\_rank());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00686}00686       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00687}00687 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00688}00688       \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00689}00689         \textcolor{stringliteral}{"{}Master node non-\/halo processor ID"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00690}00690 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00691}00691 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00692}00692       \textcolor{comment}{// If it's a solid node, also need to send lagrangian dim and type}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00693}00693       \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(master\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00694}00694       \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00695}00695       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00696}00696         send\_unsigneds.push\_back(solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_af98a0623f9e41a10f48112b9ff7b38a0}{nlagrangian}}());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00697}00697 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00698}00698         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Master solid node nlagr"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00699}00699 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00700}00700         send\_unsigneds.push\_back(solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a3c1e52e4b6dde53b98228d621f7fcb0a}{nlagrangian\_type}}());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00701}00701 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00702}00702         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Master solid node nlagr\_type"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00703}00703 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00704}00704       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00705}00705 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00706}00706       \textcolor{keywordtype}{unsigned} n\_dim = master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a786c96a8e46eb27a03b2b31f629d41b3}{ndim}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00707}00707       \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a065d7bffcec82bf4d4bd7b41f9aa80b3}{time\_stepper\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00708}00708 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00709}00709       \textcolor{comment}{// Default number of previous values to 1}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00710}00710       \textcolor{keywordtype}{unsigned} n\_prev = 1;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00711}00711       \textcolor{keywordflow}{if} (time\_stepper\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00712}00712       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00713}00713         \textcolor{comment}{// Add number of history values to n\_prev}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00714}00714         n\_prev = time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00715}00715       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00716}00716 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00717}00717       \textcolor{comment}{// Is the node on any boundaries?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00718}00718       \textcolor{keywordflow}{if} (master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a2ca215e42116ee8a2acc7d6a35e37788}{is\_on\_boundary}}())}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00719}00719       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00720}00720         send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00721}00721 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00722}00722         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Master node is on boundary"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00723}00723 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00724}00724         \textcolor{comment}{// Loop over the boundaries of the external mesh}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00725}00725         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} boundaries;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00726}00726         \textcolor{keywordtype}{unsigned} n\_bnd = mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00727}00727         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_bnd = 0; i\_bnd < n\_bnd; i\_bnd++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00728}00728         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00729}00729           \textcolor{comment}{// Which boundaries (could be more than one) is it on?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00730}00730           \textcolor{keywordflow}{if} (master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a2ca215e42116ee8a2acc7d6a35e37788}{is\_on\_boundary}}(i\_bnd))}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00731}00731           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00732}00732             boundaries.push\_back(i\_bnd);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00733}00733           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00734}00734         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00735}00735         \textcolor{keywordtype}{unsigned} nb = boundaries.size();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00736}00736         send\_unsigneds.push\_back(nb);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00737}00737 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00738}00738         std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00739}00739         junk << \textcolor{stringliteral}{"{}Master node is on "{}} << nb << \textcolor{stringliteral}{"{} boundaries"{}};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00740}00740         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00741}00741 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00742}00742         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nb; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00743}00743         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00744}00744           send\_unsigneds.push\_back(boundaries[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00745}00745 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00746}00746           std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00747}00747           junk << \textcolor{stringliteral}{"{}Master noode is on boundary "{}} << boundaries[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} of "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00748}00748                << n\_bnd;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00749}00749           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00750}00750 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00751}00751         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00752}00752 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00753}00753         \textcolor{comment}{// Get pointer to the map of indices associated with}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00754}00754         \textcolor{comment}{// additional values created by face elements}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00755}00755         \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00756}00756           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(master\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00757}00757 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00758}00758         \textcolor{keywordflow}{if} (bnod\_pt == 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00759}00759         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00760}00760           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Failed to cast new node to boundary node\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00761}00761                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00762}00762                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00763}00763         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00764}00764 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00765}00765         std::map<unsigned, unsigned>* map\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00766}00766           bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a5f73c54dbb9bdfe3538b61117a0cc674}{index\_of\_first\_value\_assigned\_by\_face\_element\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00767}00767 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00768}00768         \textcolor{comment}{// No additional values created}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00769}00769         \textcolor{keywordflow}{if} (map\_pt == 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00770}00770         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00771}00771           send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00772}00772 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00773}00773           std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00774}00774           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00775}00775             \textcolor{stringliteral}{"{}No additional values were created by face element for this master "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00776}00776             \textcolor{stringliteral}{"{}node"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00777}00777 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00778}00778         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00779}00779         \textcolor{comment}{// Created additional values}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00780}00780         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00781}00781         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00782}00782           \textcolor{comment}{// How many?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00783}00783           send\_unsigneds.push\_back(map\_pt-\/>size());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00784}00784 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00785}00785           std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00786}00786           junk << \textcolor{stringliteral}{"{}Map size for master node "{}} << map\_pt-\/>size() << n\_bnd;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00787}00787           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(junk.str());}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00788}00788 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00789}00789           \textcolor{comment}{// Loop over entries in map and add to send data}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00790}00790           \textcolor{keywordflow}{for} (std::map<unsigned, unsigned>::iterator p = map\_pt-\/>begin();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00791}00791                p != map\_pt-\/>end();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00792}00792                p++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00793}00793           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00794}00794             send\_unsigneds.push\_back((*p).first);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00795}00795 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00796}00796             std::stringstream junk;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00797}00797             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00798}00798               \textcolor{stringliteral}{"{}Key of map entry for master node"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00799}00799 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00800}00800             send\_unsigneds.push\_back((*p).second);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00801}00801 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00802}00802             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00803}00803               \textcolor{stringliteral}{"{}Value of map entry for master node"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00804}00804 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00805}00805           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00806}00806         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00807}00807       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00808}00808       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00809}00809       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00810}00810         \textcolor{comment}{// Not on any boundary}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00811}00811         send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00812}00812 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00813}00813         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00814}00814           \textcolor{stringliteral}{"{}Master node is not on any boundary"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00815}00815 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00816}00816       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00817}00817 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00818}00818       \textcolor{comment}{// Is the Node algebraic?  If so, send its ref values and}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00819}00819       \textcolor{comment}{// an indication of its geometric objects if they are stored}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00820}00820       \textcolor{comment}{// in the algebraic mesh}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00821}00821       \mbox{\hyperlink{classoomph_1_1AlgebraicNode}{AlgebraicNode}}* alg\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicNode}{AlgebraicNode}}*\textcolor{keyword}{>}(master\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00822}00822       \textcolor{keywordflow}{if} (alg\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00823}00823       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00824}00824         \textcolor{comment}{// The external mesh should be algebraic}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00825}00825         \mbox{\hyperlink{classoomph_1_1AlgebraicMesh}{AlgebraicMesh}}* alg\_mesh\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicMesh}{AlgebraicMesh}}*\textcolor{keyword}{>}(mesh\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00826}00826 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00827}00827         \textcolor{comment}{// Get default node update function ID}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00828}00828         \textcolor{keywordtype}{unsigned} update\_id = alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a8887f3a7c445b098835a7703c3a19bd2}{node\_update\_fct\_id}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00829}00829         send\_unsigneds.push\_back(update\_id);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00830}00830 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00831}00831         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Master Alg Node update id"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00832}00832 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00833}00833 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00834}00834         \textcolor{comment}{// Get reference values at default...}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00835}00835         \textcolor{keywordtype}{unsigned} n\_ref\_val = alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a18b508012bc638d85539568219865383}{nref\_value}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00836}00836         send\_unsigneds.push\_back(n\_ref\_val);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00837}00837 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00838}00838         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Master Alg Node n ref values"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00839}00839 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00840}00840         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_ref\_val = 0; i\_ref\_val < n\_ref\_val; i\_ref\_val++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00841}00841         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00842}00842           send\_doubles.push\_back(alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a9658be0ccdb312e7cf0175663407f463}{ref\_value}}(i\_ref\_val));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00843}00843         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00844}00844 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00845}00845         \textcolor{comment}{// Access geometric objects at default...}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00846}00846         \textcolor{keywordtype}{unsigned} n\_geom\_obj = alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a0e1fa66d3543da39a5e728d8af5c1734}{ngeom\_object}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00847}00847         send\_unsigneds.push\_back(n\_geom\_obj);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00848}00848 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00849}00849         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00850}00850           \textcolor{stringliteral}{"{}Master Alg Node n geom objects"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00851}00851 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00852}00852         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_geom = 0; i\_geom < n\_geom\_obj; i\_geom++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00853}00853         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00854}00854           \mbox{\hyperlink{classoomph_1_1GeomObject}{GeomObject}}* geom\_obj\_pt = alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a72a49e9a56c2bab91b1467547671fe65}{geom\_object\_pt}}(i\_geom);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00855}00855           \textcolor{comment}{// Check this against the stored geometric objects in mesh}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00856}00856           \textcolor{keywordtype}{unsigned} n\_geom\_list = alg\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicMesh_ab6a636ffb928e10e004747988fb03404}{ngeom\_object\_list\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00857}00857           \textcolor{comment}{// Default found index to zero}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00858}00858           \textcolor{keywordtype}{unsigned} found\_geom\_object = 0;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00859}00859           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_list = 0; i\_list < n\_geom\_list; i\_list++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00860}00860           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00861}00861             \textcolor{keywordflow}{if} (geom\_obj\_pt == alg\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicMesh_a7257c48270d6dbc21b78d7e49cc6d952}{geom\_object\_list\_pt}}(i\_list))}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00862}00862             \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00863}00863               found\_geom\_object = i\_list;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00864}00864             \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00865}00865           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00866}00866           send\_unsigneds.push\_back(found\_geom\_object);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00867}00867 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00868}00868           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00869}00869             \textcolor{stringliteral}{"{}Master node Found geom object"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00870}00870 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00871}00871         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00872}00872       \} \textcolor{comment}{// end AlgebraicNode check}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00873}00873 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00874}00874       \textcolor{comment}{// Is it a MacroElementNodeUpdateNode?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00875}00875       \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateNode}{MacroElementNodeUpdateNode}}* macro\_nod\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00876}00876         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateNode}{MacroElementNodeUpdateNode}}*\textcolor{keyword}{>}(master\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00877}00877       \textcolor{keywordflow}{if} (macro\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00878}00878       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00879}00879         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Adding external haloed master node: "{}} << master\_nod\_pt}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00880}00880                    << \textcolor{stringliteral}{"{} at "{}} << master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0) << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00881}00881                    << master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{} ]"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00882}00882         \textcolor{comment}{// Loop over current external haloed elements -\/ has the element which}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00883}00883         \textcolor{comment}{// controls the node update for this node been added yet?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00884}00884         \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* macro\_node\_update\_el\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00885}00885           macro\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateNode_aee127758a6c511cff9df4004d98744e6}{node\_update\_element\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00886}00886 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00887}00887         \textcolor{comment}{// BENFLAG: Check that the node's macro element node update element}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00888}00888         \textcolor{comment}{// actually contains the node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00889}00889         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Master node's macro update element:"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00890}00890         \textcolor{keywordtype}{bool} really\_bad = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00891}00891         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* mac\_el\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00892}00892           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(macro\_node\_update\_el\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00893}00893         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < mac\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}(); j++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00894}00894         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00895}00895           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << mac\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j) << \textcolor{stringliteral}{"{}: [ "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00896}00896                      << mac\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0) << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00897}00897                      << mac\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{} ] "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00898}00898           \textcolor{keywordflow}{if} (mac\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j) == master\_nod\_pt)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00899}00899           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00900}00900             really\_bad = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00901}00901             \textcolor{comment}{// oomph\_info << "{}Found it!"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00902}00902           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00903}00903         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00904}00904         \textcolor{keywordflow}{if} (really\_bad == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00905}00905         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00906}00906           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}This is REALLY BAD! The master node is not part of "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00907}00907                         \textcolor{stringliteral}{"{}its own update element..."{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00908}00908                      << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00909}00909         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00910}00910 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00911}00911         \textcolor{comment}{// BENFLAG: Search internal storage for node update element}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00912}00912         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} int\_haloed\_el\_pt(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00913}00913           mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(iproc));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00914}00914         \textcolor{comment}{// unsigned n\_int\_haloed\_el=int\_haloed\_el\_pt.size();}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00915}00915         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>::iterator}} it =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00916}00916           std::find(int\_haloed\_el\_pt.begin(),}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00917}00917                     int\_haloed\_el\_pt.end(),}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00918}00918                     macro\_node\_update\_el\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00919}00919         \textcolor{keywordflow}{if} (it != int\_haloed\_el\_pt.end())}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00920}00920         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00921}00921           \textcolor{comment}{// Found in internal haloed storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00922}00922           \textcolor{keywordtype}{unsigned} int\_haloed\_el\_index = it -\/ int\_haloed\_el\_pt.begin();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00923}00923           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Found internally at index "{}} << int\_haloed\_el\_index}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00924}00924                      << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00925}00925           \textcolor{comment}{// BENFLAG: Check index corresponds to correct element}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00926}00926           \textcolor{keywordflow}{if} ((mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(iproc))[int\_haloed\_el\_index] !=}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00927}00927               macro\_node\_update\_el\_pt)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00928}00928           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00929}00929             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Found wrong index!!!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00930}00930             \textcolor{keywordflow}{throw};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00931}00931           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00932}00932           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00933}00933           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00934}00934             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}index and proc are correct in internal storage."{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00935}00935                        << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00936}00936             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}i.e. "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00937}00937                        << (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00938}00938                             iproc))[int\_haloed\_el\_index]}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00939}00939                        << \textcolor{stringliteral}{"{}=="{}} << macro\_node\_update\_el\_pt << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00940}00940           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00941}00941 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00942}00942 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00943}00943           \textcolor{comment}{// Say haloed element already exists}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00944}00944           send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00945}00945 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00946}00946           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00947}00947             \textcolor{stringliteral}{"{}External haloed element already exists"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00948}00948 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00949}00949           \textcolor{comment}{// Say found internally}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00950}00950           send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00951}00951 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00952}00952           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00953}00953             \textcolor{stringliteral}{"{}Haloed element found internally"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00954}00954 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00955}00955           \textcolor{comment}{// Say what the index is}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00956}00956           send\_unsigneds.push\_back(int\_haloed\_el\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00957}00957 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00958}00958           \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00959}00959             \textcolor{stringliteral}{"{}Index of existing internal haloed element"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00960}00960 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00961}00961           \textcolor{comment}{// BENFLAG:}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00962}00962           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* tmp\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00963}00963             (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(iproc))[int\_haloed\_el\_index]);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00964}00964           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Internal haloed element ("{}} << tmp\_el\_pt}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00965}00965                      << \textcolor{stringliteral}{"{}) already exists..."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00966}00966           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}on proc "{}} << iproc << \textcolor{stringliteral}{"{} at index "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00967}00967                      << int\_haloed\_el\_index << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00968}00968           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < tmp\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}(); j++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00969}00969           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00970}00970             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << tmp\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j) << \textcolor{stringliteral}{"{}=="{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00971}00971                        << \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00972}00972                             (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00973}00973                               iproc))[int\_haloed\_el\_index])}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00974}00974                             -\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00975}00975                        << \textcolor{stringliteral}{"{} at [ "{}} << tmp\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0) << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00976}00976                        << tmp\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{} ]"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00977}00977           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00978}00978 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00979}00979           \textcolor{comment}{// oomph\_info << "{}now "{} << tmp\_el\_pt << "{}=="{} <<}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00980}00980           \textcolor{comment}{// (mesh\_pt-\/>haloed\_element\_pt(iproc))[int\_haloed\_el\_index] << "{}=="{} <<}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00981}00981           \textcolor{comment}{// macro\_node\_update\_el\_pt << std::endl;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00982}00982 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00983}00983           \textcolor{comment}{//       //BENFLAG: Add to external storage too}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00984}00984           \textcolor{comment}{//       unsigned n\_ext\_haloed\_el=mesh\_pt-\/>}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00985}00985           \textcolor{comment}{//        nexternal\_haloed\_element(iproc);}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00986}00986           \textcolor{comment}{//       unsigned external\_haloed\_el\_index;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00987}00987           \textcolor{comment}{//       external\_haloed\_el\_index=mesh\_pt-\/>}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00988}00988           \textcolor{comment}{//        add\_external\_haloed\_element\_pt(iproc,macro\_node\_update\_el\_pt);}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00989}00989           \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00990}00990           \textcolor{comment}{//       // If it was already added, say}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00991}00991           \textcolor{comment}{//       if (external\_haloed\_el\_index!=n\_ext\_haloed\_el)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00992}00992           \textcolor{comment}{//        \{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00993}00993           \textcolor{comment}{//         oomph\_info << "{}Element ("{} << tmp\_el\_pt << "{}=="{} <<}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00994}00994           \textcolor{comment}{//         macro\_node\_update\_el\_pt << "{}=="{} <<}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00995}00995           \textcolor{comment}{//         mesh\_pt-\/>external\_haloed\_element\_pt(iproc,external\_haloed\_el\_index)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00996}00996           \textcolor{comment}{//         << "{}) also exists in external storage with proc "{} << iproc}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00997}00997           \textcolor{comment}{//         << "{} at index "{} << external\_haloed\_el\_index << "{} of "{} <<}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00998}00998           \textcolor{comment}{//         n\_ext\_haloed\_el << "{}..."{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l00999}00999           \textcolor{comment}{//         // Say also exists in external storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01000}01000           \textcolor{comment}{//         send\_unsigneds.push\_back(1234);}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01001}01001           \textcolor{comment}{//\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01002}01002           \textcolor{comment}{//         Flat\_packed\_unsigneds\_string.push\_back("{}Haloed element also}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01003}01003           \textcolor{comment}{//         found externally"{});}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01004}01004           \textcolor{comment}{//\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01005}01005           \textcolor{comment}{//         // Say what the index is}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01006}01006           \textcolor{comment}{//         send\_unsigneds.push\_back(external\_haloed\_el\_index);}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01007}01007           \textcolor{comment}{//\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01008}01008           \textcolor{comment}{//         Flat\_packed\_unsigneds\_string.push\_back("{}Index of existing}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01009}01009           \textcolor{comment}{//         internal haloed element"{});}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01010}01010           \textcolor{comment}{//\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01011}01011           \textcolor{comment}{//         oomph\_info << "{}sent external\_haloed\_el\_index = "{} <<}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01012}01012           \textcolor{comment}{//         external\_haloed\_el\_index << std::endl;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01013}01013           \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01014}01014           \textcolor{comment}{//        \}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01015}01015           \textcolor{comment}{//       else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01016}01016           \textcolor{comment}{//        \{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01017}01017           \textcolor{comment}{//         oomph\_info << "{}Element didn't exist in external storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01018}01018           \textcolor{comment}{//         with proc "{} << iproc << "{}..."{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01019}01019           \textcolor{comment}{//         // Say doesn't exists in external storage}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01020}01020           \textcolor{comment}{//         send\_unsigneds.push\_back(0);}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01021}01021           \textcolor{comment}{//\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01022}01022           \textcolor{comment}{//         Flat\_packed\_unsigneds\_string.push\_back("{}Haloed element not}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01023}01023           \textcolor{comment}{//         also found externally"{});}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01024}01024           \textcolor{comment}{//\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01025}01025           \textcolor{comment}{//        \}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01026}01026         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01027}01027         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01028}01028         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01029}01029           \textcolor{keywordtype}{unsigned} n\_ext\_haloed\_el = mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a2ab617e7c2c754234dcad02d3d0ed5ba}{nexternal\_haloed\_element}}(iproc);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01030}01030           \textcolor{keywordtype}{unsigned} external\_haloed\_el\_index;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01031}01031           external\_haloed\_el\_index = mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a85fd3fc85e61062a50cdc56dec197449}{add\_external\_haloed\_element\_pt}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01032}01032             iproc, macro\_node\_update\_el\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01033}01033 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01034}01034           \textcolor{comment}{// If it wasn't already added, we need to create a halo copy}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01035}01035           \textcolor{keywordflow}{if} (external\_haloed\_el\_index == n\_ext\_haloed\_el)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01036}01036           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01037}01037             send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01038}01038 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01039}01039             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01040}01040               \textcolor{stringliteral}{"{}Master Node needs to be constructed"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01041}01041 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01042}01042             \textcolor{comment}{// Cast to a finite elemnet}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01043}01043             \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* macro\_node\_update\_finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01044}01044               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(macro\_node\_update\_el\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01045}01045 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01046}01046             \textcolor{comment}{// We're using macro elements to update...}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01047}01047             \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateMesh}{MacroElementNodeUpdateMesh}}* macro\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01048}01048               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateMesh}{MacroElementNodeUpdateMesh}}*\textcolor{keyword}{>}(mesh\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01049}01049             \textcolor{keywordflow}{if} (macro\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01050}01050             \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01051}01051               send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01052}01052 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01053}01053               \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01054}01054                 \textcolor{stringliteral}{"{}Mesh is macro element mesh"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01055}01055 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01056}01056               \textcolor{comment}{// Need to send the macro element number in the mesh across}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01057}01057               \mbox{\hyperlink{classoomph_1_1MacroElement}{MacroElement}}* macro\_el\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01058}01058                 macro\_node\_update\_finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a801bbe89619c28e181afa8fa3e9ac836}{macro\_elem\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01059}01059               \textcolor{keywordtype}{unsigned} macro\_el\_num = macro\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElement_abeb744cd6c9bd213a1375fc8d924d445}{macro\_element\_number}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01060}01060               send\_unsigneds.push\_back(macro\_el\_num);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01061}01061 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01062}01062               \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Number of macro element"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01063}01063 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01064}01064               \textcolor{comment}{// Also need to send}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01065}01065               \textcolor{comment}{// the lower left and upper right coordinates of the macro element}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01066}01066               \mbox{\hyperlink{classoomph_1_1QElementBase}{QElementBase}}* q\_el\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01067}01067                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1QElementBase}{QElementBase}}*\textcolor{keyword}{>}(macro\_node\_update\_el\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01068}01068               \textcolor{keywordflow}{if} (q\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01069}01069               \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01070}01070                 \textcolor{comment}{// The macro element needs to be set first before}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01071}01071                 \textcolor{comment}{// its lower left and upper right coordinates can be accessed}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01072}01072                 \textcolor{comment}{// Now send the lower left and upper right coordinates}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01073}01073                 \textcolor{keywordtype}{unsigned} el\_dim = q\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01074}01074                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_dim = 0; i\_dim < el\_dim; i\_dim++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01075}01075                 \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01076}01076                   send\_doubles.push\_back(q\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(i\_dim));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01077}01077                   send\_doubles.push\_back(q\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a0e02d2c0be2b93967700723d77891cb2}{s\_macro\_ur}}(i\_dim));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01078}01078                 \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01079}01079               \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01080}01080               \textcolor{keywordflow}{else} \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01081}01081               \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01082}01082                 std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01083}01083                 error\_stream << \textcolor{stringliteral}{"{}You are using a MacroElement node update\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01084}01084                              << \textcolor{stringliteral}{"{}in a case with non-\/QElements. This has not\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01085}01085                              << \textcolor{stringliteral}{"{}yet been implemented.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01086}01086                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01087}01087                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01088}01088                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01089}01089               \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01090}01090             \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01091}01091             \textcolor{keywordflow}{else} \textcolor{comment}{// Not using macro elements for node update... umm, we're}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01092}01092                  \textcolor{comment}{// already inside a loop over macro elements, so this}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01093}01093                  \textcolor{comment}{// should never get here... an error should be thrown I suppose}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01094}01094             \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01095}01095               send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01096}01096 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01097}01097               \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01098}01098                 \textcolor{stringliteral}{"{}Mesh is not a macro element mesh"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01099}01099 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01100}01100             \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01101}01101 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01102}01102             \textcolor{comment}{// If the element is p-\/refineable we need to send the p-\/order so}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01103}01103             \textcolor{comment}{// that the halo version can be constructed correctly}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01104}01104             \mbox{\hyperlink{classoomph_1_1PRefineableElement}{PRefineableElement}}* p\_refineable\_el\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01105}01105               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableElement}{PRefineableElement}}*\textcolor{keyword}{>}(macro\_node\_update\_finite\_el\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01106}01106             \textcolor{keywordflow}{if} (p\_refineable\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01107}01107             \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01108}01108               send\_unsigneds.push\_back(1);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01109}01109 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01110}01110               \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}Element is p-\/refineable"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01111}01111 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01112}01112               \textcolor{comment}{// Send p-\/order of macro element node update element}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01113}01113               \textcolor{keywordtype}{unsigned} p\_order = p\_refineable\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01114}01114               send\_unsigneds.push\_back(p\_order);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01115}01115 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01116}01116               \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(\textcolor{stringliteral}{"{}p-\/order of element"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01117}01117 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01118}01118             \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01119}01119             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01120}01120             \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01121}01121               send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01122}01122 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01123}01123               \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01124}01124                 \textcolor{stringliteral}{"{}Element is not p-\/refineable"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01125}01125 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01126}01126             \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01127}01127 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01128}01128             \textcolor{comment}{// This element needs to be fully functioning on the other}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01129}01129             \textcolor{comment}{// process, so send all the information required to create it}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01130}01130             \textcolor{keywordtype}{unsigned} n\_node = macro\_node\_update\_finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01131}01131             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01132}01132             \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01133}01133               \mbox{\hyperlink{classoomph_1_1Node}{Node}}* new\_nod\_pt = macro\_node\_update\_finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01134}01134               \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a94805dfb28ba45ff7f4d7a0d6fef108d}{add\_external\_haloed\_node\_to\_storage}}(iproc,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01135}01135                                                   new\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01136}01136                                                   mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01137}01137                                                   n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01138}01138                                                   send\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01139}01139                                                   send\_doubles);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01140}01140             \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01141}01141           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01142}01142           \textcolor{keywordflow}{else} \textcolor{comment}{// The external haloed element already exists}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01143}01143           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01144}01144             \textcolor{comment}{// Say haloed element already exists}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01145}01145             send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01146}01146 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01147}01147             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01148}01148               \textcolor{stringliteral}{"{}External haloed element already exists"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01149}01149 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01150}01150             \textcolor{comment}{// Say found externally}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01151}01151             send\_unsigneds.push\_back(0);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01152}01152 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01153}01153             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01154}01154               \textcolor{stringliteral}{"{}Haloed element found externally"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01155}01155 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01156}01156             send\_unsigneds.push\_back(external\_haloed\_el\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01157}01157 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01158}01158             \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_af558db56295524af220b5b4c981d5aa0}{Flat\_packed\_unsigneds\_string}}.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01159}01159               \textcolor{stringliteral}{"{}Index of existing external haloed element"{}});}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01160}01160 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01161}01161             \textcolor{comment}{// BENFLAG:}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01162}01162             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}External haloed element already exists..."{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01163}01163                        << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01164}01164             \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* tmp\_el\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01165}01165               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a4718b68acd1961c943b47859487bd870}{external\_haloed\_element\_pt}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01166}01166                 iproc, external\_haloed\_el\_index));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01167}01167             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}on proc "{}} << iproc << \textcolor{stringliteral}{"{} at index "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01168}01168                        << external\_haloed\_el\_index << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01169}01169             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < tmp\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}(); j++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01170}01170             \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01171}01171               \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << tmp\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j) << \textcolor{stringliteral}{"{} at [ "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01172}01172                          << tmp\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0) << \textcolor{stringliteral}{"{}, "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01173}01173                          << tmp\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{} ]"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01174}01174             \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01175}01175           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01176}01176         \} \textcolor{comment}{// End of case where not found internally}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01177}01177 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01178}01178       \} \textcolor{comment}{// end of MacroElementNodeUpdateNode check}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01179}01179 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01180}01180       \textcolor{comment}{// Is it a SolidNode?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01181}01181       \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01182}01182       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01183}01183         \textcolor{keywordtype}{unsigned} n\_val = solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01184}01184         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_val = 0; i\_val < n\_val; i\_val++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01185}01185         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01186}01186           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01187}01187           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01188}01188             send\_doubles.push\_back(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01189}01189               solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a9383101536882db34e618cbe30dba2da}{value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, i\_val));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01190}01190           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01191}01191         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01192}01192       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01193}01193 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01194}01194       \textcolor{comment}{// Finally copy info required for all node types}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01195}01195 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01196}01196       \textcolor{comment}{// Halo copy needs to know all the history values}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01197}01197       \textcolor{keywordtype}{unsigned} n\_val = master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01198}01198       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_val = 0; i\_val < n\_val; i\_val++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01199}01199       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01200}01200         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01201}01201         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01202}01202           send\_doubles.push\_back(master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afcc5cdba40bca251826ae5bee5ca15b4}{value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, i\_val));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01203}01203         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01204}01204       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01205}01205 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01206}01206       \textcolor{comment}{// Now do positions}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01207}01207       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} idim = 0; idim < n\_dim; idim++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01208}01208       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01209}01209         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01210}01210         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01211}01211           send\_doubles.push\_back(master\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, idim));}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01212}01212         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01213}01213       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01214}01214     \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01215}01215 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01216}01216 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01217}01217     \textcolor{comment}{//=======start of add\_external\_halo\_node\_helper===========================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01218}01218 \textcolor{comment}{    /// Helper functiono to add external halo node that is not a master}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01219}01219 \textcolor{comment}{}    \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01220}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a537b9f129421d1ad4f6915794d9dd66f}{01220}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_a537b9f129421d1ad4f6915794d9dd66f}{add\_external\_halo\_node\_helper}}(\mbox{\hyperlink{classoomph_1_1Node}{Node}}*\& new\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01221}01221                                        \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01222}01222                                        \textcolor{keywordtype}{unsigned}\& loc\_p,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01223}01223                                        \textcolor{keywordtype}{unsigned}\& node\_index,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01224}01224                                        \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* \textcolor{keyword}{const}\& new\_el\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01225}01225                                        \textcolor{keywordtype}{int}\& n\_cont\_inter\_values,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01226}01226                                        \textcolor{keywordtype}{unsigned}\& counter\_for\_recv\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01227}01227                                        \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& recv\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01228}01228                                        \textcolor{keywordtype}{unsigned}\& counter\_for\_recv\_doubles,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01229}01229                                        \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& recv\_doubles)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01230}01230     \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01231}01231       \textcolor{comment}{// Given the node and the external mesh, and received information}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01232}01232       \textcolor{comment}{// about them from process loc\_p, construct them on the current process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01233}01233 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01234}01234       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01235}01235                  << \textcolor{stringliteral}{"{} Bool: New node needs to be constructed "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01236}01236                  << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01237}01237 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01238}01238       \textcolor{keywordflow}{if} (recv\_unsigneds[counter\_for\_recv\_unsigneds++] == 1)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01239}01239       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01240}01240         \textcolor{comment}{// Construct a new node based upon sent information}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01241}01241         \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_ae60b3fe43b4c8a9ccd03d2bc22f437c6}{construct\_new\_external\_halo\_node\_helper}}(new\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01242}01242                                                 loc\_p,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01243}01243                                                 node\_index,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01244}01244                                                 new\_el\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01245}01245                                                 mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01246}01246                                                 counter\_for\_recv\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01247}01247                                                 recv\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01248}01248                                                 counter\_for\_recv\_doubles,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01249}01249                                                 recv\_doubles);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01250}01250       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01251}01251       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01252}01252       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01253}01253         \textcolor{comment}{// Need to check which storage we should copy this halo node from}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01254}01254 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01255}01255         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01256}01256                    << \textcolor{stringliteral}{"{}  Existing external halo node was found externally (0) "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01257}01257                       \textcolor{stringliteral}{"{}or internally (1): "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01258}01258                    << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01259}01259 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01260}01260         \textcolor{keywordtype}{unsigned} node\_found\_internally =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01261}01261           recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01262}01262         \textcolor{keywordflow}{if} (node\_found\_internally)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01263}01263         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01264}01264 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01265}01265           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01266}01266                      << \textcolor{stringliteral}{"{}  index of existing (internal) halo master node "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01267}01267                      << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01268}01268 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01269}01269 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01270}01270           \textcolor{comment}{// Copy node from received location}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01271}01271           new\_nod\_pt = mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01272}01272             loc\_p, recv\_unsigneds[counter\_for\_recv\_unsigneds++]);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01273}01273 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01274}01274           new\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(node\_index) = new\_nod\_pt;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01275}01275         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01276}01276         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01277}01277         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01278}01278 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01279}01279           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01280}01280                      << \textcolor{stringliteral}{"{}  Index of existing external halo node "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01281}01281                      << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01282}01282 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01283}01283 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01284}01284           \textcolor{comment}{// Copy node from received location}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01285}01285           new\_nod\_pt = mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a1f88352a0bf5be7d15858915097c1e70}{external\_halo\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01286}01286             loc\_p, recv\_unsigneds[counter\_for\_recv\_unsigneds++]);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01287}01287 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01288}01288           new\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(node\_index) = new\_nod\_pt;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01289}01289         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01290}01290       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01291}01291     \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01292}01292 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01293}01293 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01294}01294     \textcolor{comment}{//========start of construct\_new\_external\_halo\_node\_helper=================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01295}01295 \textcolor{comment}{    /// Helper function which constructs a new external halo node (on new}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01296}01296 \textcolor{comment}{    /// element) with the required information sent from the haloed process}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01297}01297 \textcolor{comment}{}    \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01298}\mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_ae60b3fe43b4c8a9ccd03d2bc22f437c6}{01298}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1Missing__masters__functions_ae60b3fe43b4c8a9ccd03d2bc22f437c6}{construct\_new\_external\_halo\_node\_helper}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01299}01299       \mbox{\hyperlink{classoomph_1_1Node}{Node}}*\& new\_nod\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01300}01300       \textcolor{keywordtype}{unsigned}\& loc\_p,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01301}01301       \textcolor{keywordtype}{unsigned}\& node\_index,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01302}01302       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* \textcolor{keyword}{const}\& new\_el\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01303}01303       \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01304}01304       \textcolor{keywordtype}{unsigned}\& counter\_for\_recv\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01305}01305       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& recv\_unsigneds,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01306}01306       \textcolor{keywordtype}{unsigned}\& counter\_for\_recv\_doubles,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01307}01307       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& recv\_doubles)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01308}01308     \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01309}01309       \textcolor{comment}{// The first entry indicates the number of values at this new Node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01310}01310       \textcolor{comment}{// (which may be different across the same element e.g. Lagrange}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01311}01311       \textcolor{comment}{// multipliers)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01312}01312 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01313}01313       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01314}01314                  << \textcolor{stringliteral}{"{}  Number of values of external halo node "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01315}01315                  << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01316}01316 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01317}01317       \textcolor{keywordtype}{unsigned} n\_val = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01318}01318 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01319}01319       \textcolor{comment}{// Null TimeStepper for now}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01320}01320       \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = 0;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01321}01321       \textcolor{comment}{// Default number of previous values to 1}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01322}01322       \textcolor{keywordtype}{unsigned} n\_prev = 1;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01323}01323 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01324}01324       \textcolor{comment}{// Just take timestepper from a node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01325}01325       \textcolor{comment}{// Let's use first node of first element since this must exist}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01326}01326       time\_stepper\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01327}01327         mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1Data_a065d7bffcec82bf4d4bd7b41f9aa80b3}{time\_stepper\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01328}01328 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01329}01329       \textcolor{comment}{// If this node was on a boundary then it needs to}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01330}01330       \textcolor{comment}{// be on the same boundary here}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01331}01331 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01332}01332       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01333}01333                  << \textcolor{stringliteral}{"{}  Is node on boundary? "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01334}01334                  << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01335}01335 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01336}01336       \textcolor{keywordflow}{if} (recv\_unsigneds[counter\_for\_recv\_unsigneds++] == 1)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01337}01337       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01338}01338         \textcolor{comment}{// Construct a new boundary node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01339}01339         \textcolor{keywordflow}{if} (time\_stepper\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01340}01340         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01341}01341           new\_nod\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01342}01342             new\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a88a427f24deee1be92d6e63eac0fb36f}{construct\_boundary\_node}}(node\_index, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01343}01343         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01344}01344         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01345}01345         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01346}01346           new\_nod\_pt = new\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a88a427f24deee1be92d6e63eac0fb36f}{construct\_boundary\_node}}(node\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01347}01347         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01348}01348 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01349}01349         \textcolor{comment}{// How many boundaries does the node live on?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01350}01350 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01351}01351         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01352}01352                    << \textcolor{stringliteral}{"{} Number of boundaries the node is on: "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01353}01353                    << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01354}01354 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01355}01355         \textcolor{keywordtype}{unsigned} nb = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01356}01356         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nb; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01357}01357         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01358}01358           \textcolor{comment}{// Boundary number}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01359}01359 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01360}01360           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01361}01361                      << \textcolor{stringliteral}{"{}  Node is on boundary "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01362}01362                      << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01363}01363 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01364}01364           \textcolor{keywordtype}{unsigned} i\_bnd = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01365}01365           mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(i\_bnd, new\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01366}01366         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01367}01367 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01368}01368         \textcolor{comment}{// Do we have additional values created by face elements?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01369}01369 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01370}01370         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01371}01371                    << \textcolor{stringliteral}{"{} Number of additional values created by face element "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01372}01372                    << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01373}01373 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01374}01374         \textcolor{keywordtype}{unsigned} n\_entry = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01375}01375         \textcolor{keywordflow}{if} (n\_entry > 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01376}01376         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01377}01377           \textcolor{comment}{// Create storage, if it doesn't already exist, for the map}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01378}01378           \textcolor{comment}{// that will contain the position of the first entry of}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01379}01379           \textcolor{comment}{// this face element's additional values,}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01380}01380           \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnew\_nod\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01381}01381             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(new\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01382}01382 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01383}01383           \textcolor{keywordflow}{if} (bnew\_nod\_pt == 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01384}01384           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01385}01385             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Failed to cast new node to boundary node\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01386}01386                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01387}01387                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01388}01388           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01389}01389 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01390}01390           \textcolor{keywordflow}{if} (bnew\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a5f73c54dbb9bdfe3538b61117a0cc674}{index\_of\_first\_value\_assigned\_by\_face\_element\_pt}}() ==}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01391}01391               0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01392}01392           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01393}01393             bnew\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a5f73c54dbb9bdfe3538b61117a0cc674}{index\_of\_first\_value\_assigned\_by\_face\_element\_pt}}() =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01394}01394               \textcolor{keyword}{new} std::map<unsigned, unsigned>;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01395}01395           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01396}01396 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01397}01397           \textcolor{comment}{// Get pointer to the map of indices associated with}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01398}01398           \textcolor{comment}{// additional values created by face elements}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01399}01399           std::map<unsigned, unsigned>* map\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01400}01400             bnew\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a5f73c54dbb9bdfe3538b61117a0cc674}{index\_of\_first\_value\_assigned\_by\_face\_element\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01401}01401 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01402}01402           \textcolor{comment}{// Loop over number of entries in map}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01403}01403           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_entry; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01404}01404           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01405}01405             \textcolor{comment}{// Read out pairs...}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01406}01406 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01407}01407 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01408}01408             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01409}01409                        << \textcolor{stringliteral}{"{} Key of map entry"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01410}01410                        << recv\_unsigneds[counter\_for\_recv\_unsigneds]}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01411}01411                        << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01412}01412 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01413}01413             \textcolor{keywordtype}{unsigned} first = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01414}01414 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01415}01415 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01416}01416             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01417}01417                        << \textcolor{stringliteral}{"{} Value of map entry"{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01418}01418                        << recv\_unsigneds[counter\_for\_recv\_unsigneds]}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01419}01419                        << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01420}01420 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01421}01421             \textcolor{keywordtype}{unsigned} second = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01422}01422 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01423}01423             \textcolor{comment}{// ...and assign}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01424}01424             (*map\_pt)[first] = second;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01425}01425           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01426}01426         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01427}01427       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01428}01428       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01429}01429       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01430}01430         \textcolor{comment}{// Construct an ordinary (non-\/boundary) node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01431}01431         \textcolor{keywordflow}{if} (time\_stepper\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01432}01432         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01433}01433           new\_nod\_pt = new\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a54676a4e37813f207d53ef9a7d16fd41}{construct\_node}}(node\_index, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01434}01434         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01435}01435         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01436}01436         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01437}01437           new\_nod\_pt = new\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a54676a4e37813f207d53ef9a7d16fd41}{construct\_node}}(node\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01438}01438         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01439}01439       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01440}01440 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01441}01441       \textcolor{comment}{// Node constructed: add to external halo nodes}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01442}01442       mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac0b818d3cf5f2eae2816574b6d0a4f07}{add\_external\_halo\_node\_pt}}(loc\_p, new\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01443}01443 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01444}01444       \textcolor{comment}{// Is the new constructed node Algebraic?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01445}01445       \mbox{\hyperlink{classoomph_1_1AlgebraicNode}{AlgebraicNode}}* new\_alg\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicNode}{AlgebraicNode}}*\textcolor{keyword}{>}(new\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01446}01446 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01447}01447       \textcolor{comment}{// If it is algebraic, its node update functions will}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01448}01448       \textcolor{comment}{// not yet have been set up properly}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01449}01449       \textcolor{keywordflow}{if} (new\_alg\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01450}01450       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01451}01451         \textcolor{comment}{// The AlgebraicMesh is the external mesh}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01452}01452         \mbox{\hyperlink{classoomph_1_1AlgebraicMesh}{AlgebraicMesh}}* alg\_mesh\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicMesh}{AlgebraicMesh}}*\textcolor{keyword}{>}(mesh\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01453}01453 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01454}01454 \textcolor{comment}{        /// The first entry of All\_alg\_nodal\_info contains}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01455}01455 \textcolor{comment}{        /// the default node update id}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01456}01456 \textcolor{comment}{        /// e.g. for the quarter circle there are}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01457}01457 \textcolor{comment}{        /// "{}Upper\_left\_box"{}, "{}Lower right box"{} etc...}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01458}01458 \textcolor{comment}{}\textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01459}01459         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01460}01460                    << \textcolor{stringliteral}{"{}  Alg node update id "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01461}01461                    << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01462}01462 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01463}01463 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01464}01464         \textcolor{keywordtype}{unsigned} update\_id = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01465}01465 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01466}01466         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} ref\_value;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01467}01467 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01468}01468         \textcolor{comment}{// The size of this vector is in the next entry}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01469}01469         \textcolor{comment}{// of All\_alg\_nodal\_info}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01470}01470 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01471}01471         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01472}01472                    << \textcolor{stringliteral}{"{}  Alg node \# of ref values "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01473}01473                    << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01474}01474 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01475}01475         \textcolor{keywordtype}{unsigned} n\_ref\_val = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01476}01476 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01477}01477         \textcolor{comment}{// The reference values themselves are in}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01478}01478         \textcolor{comment}{// All\_alg\_ref\_value}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01479}01479         ref\_value.resize(n\_ref\_val);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01480}01480         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_ref = 0; i\_ref < n\_ref\_val; i\_ref++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01481}01481         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01482}01482           ref\_value[i\_ref] = recv\_doubles[counter\_for\_recv\_doubles++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01483}01483         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01484}01484 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01485}01485         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_pt;\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01486}01486 \textcolor{comment}{        /// again we need the size of this vector as it varies}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01487}01487 \textcolor{comment}{        /// between meshes; we also need some indication}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01488}01488 \textcolor{comment}{        /// as to which geometric object should be used...}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01489}01489 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01490}01490         \textcolor{comment}{// The size of this vector is in the next entry}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01491}01491         \textcolor{comment}{// of All\_alg\_nodal\_info}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01492}01492 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01493}01493         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01494}01494                    << \textcolor{stringliteral}{"{}  Alg node \# of geom objects "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01495}01495                    << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01496}01496 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01497}01497         \textcolor{keywordtype}{unsigned} n\_geom\_obj = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01498}01498 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01499}01499         \textcolor{comment}{// The remaining indices are in the rest of}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01500}01500         \textcolor{comment}{// All\_alg\_nodal\_info}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01501}01501         geom\_object\_pt.resize(n\_geom\_obj);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01502}01502         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_geom = 0; i\_geom < n\_geom\_obj; i\_geom++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01503}01503         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01504}01504 \textcolor{preprocessor}{\#ifdef ANNOTATE\_MISSING\_MASTERS\_COMMUNICATION}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01505}01505           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Rec:"{}} << counter\_for\_recv\_unsigneds}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01506}01506                      << \textcolor{stringliteral}{"{}  Alg node: geom object index "{}}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01507}01507                      << recv\_unsigneds[counter\_for\_recv\_unsigneds] << std::endl;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01508}01508 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01509}01509           \textcolor{keywordtype}{unsigned} geom\_index = recv\_unsigneds[counter\_for\_recv\_unsigneds++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01510}01510           \textcolor{comment}{// This index indicates which of the AlgebraicMesh's}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01511}01511           \textcolor{comment}{// stored geometric objects should be used}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01512}01512           \textcolor{comment}{// (0 is a null pointer; everything else should have}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01513}01513           \textcolor{comment}{//  been filled in by the specific Mesh).  If it}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01514}01514           \textcolor{comment}{// hasn't been filled in then the update\_node\_update}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01515}01515           \textcolor{comment}{// call should fix it}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01516}01516           geom\_object\_pt[i\_geom] = alg\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicMesh_a7257c48270d6dbc21b78d7e49cc6d952}{geom\_object\_list\_pt}}(geom\_index);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01517}01517         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01518}01518 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01519}01519 \textcolor{comment}{        /// For the received update\_id, ref\_value, geom\_object}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01520}01520 \textcolor{comment}{        /// call add\_node\_update\_info}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01521}01521 \textcolor{comment}{}        new\_alg\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_ac6bd268c80889507d92431a4638eb85c}{add\_node\_update\_info}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01522}01522           update\_id, alg\_mesh\_pt, geom\_object\_pt, ref\_value);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01523}01523 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01524}01524 \textcolor{comment}{        /// Now call update\_node\_update}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01525}01525 \textcolor{comment}{}        alg\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicMesh_a6c6a35ae2be6e2766f5b80d85693c1ce}{update\_node\_update}}(new\_alg\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01526}01526       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01527}01527 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01528}01528       \textcolor{comment}{// Is the node a MacroElementNodeUpdateNode?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01529}01529       \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateNode}{MacroElementNodeUpdateNode}}* macro\_nod\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01530}01530         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateNode}{MacroElementNodeUpdateNode}}*\textcolor{keyword}{>}(new\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01531}01531 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01532}01532       \textcolor{keywordflow}{if} (macro\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01533}01533       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01534}01534         \textcolor{comment}{// Need to call set\_node\_update\_info; this requires}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01535}01535         \textcolor{comment}{// a Vector<GeomObject*> (taken from the mesh)}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01536}01536         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_vector\_pt;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01537}01537 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01538}01538         \textcolor{comment}{// Access the required geom objects from the}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01539}01539         \textcolor{comment}{// MacroElementNodeUpdateMesh}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01540}01540         \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateMesh}{MacroElementNodeUpdateMesh}}* macro\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01541}01541           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateMesh}{MacroElementNodeUpdateMesh}}*\textcolor{keyword}{>}(mesh\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01542}01542         geom\_object\_vector\_pt = macro\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateMesh_aa550e97598d235eb609bd004d8dbfff2}{geom\_object\_vector\_pt}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01543}01543 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01544}01544         \textcolor{comment}{// Get local coordinate of node in new element}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01545}01545         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_macro\_node\_update\_element;}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01546}01546         new\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a22bc4ee35e4f948d8d7fba18c7b4f4c4}{local\_coordinate\_of\_node}}(node\_index,}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01547}01547                                             s\_in\_macro\_node\_update\_element);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01548}01548 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01549}01549         \textcolor{comment}{// Set node update info for this node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01550}01550         macro\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateNode_ad12704b416585f4e34433f4df6bb22b5}{set\_node\_update\_info}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01551}01551           new\_el\_pt, s\_in\_macro\_node\_update\_element, geom\_object\_vector\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01552}01552       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01553}01553 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01554}01554       \textcolor{comment}{// Is the new node a SolidNode?}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01555}01555       \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(new\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01556}01556       \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01557}01557       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01558}01558         \textcolor{keywordtype}{unsigned} n\_solid\_val = solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01559}01559         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_val = 0; i\_val < n\_solid\_val; i\_val++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01560}01560         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01561}01561           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01562}01562           \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01563}01563             solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01564}01564               \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, i\_val, recv\_doubles[counter\_for\_recv\_doubles++]);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01565}01565           \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01566}01566         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01567}01567       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01568}01568 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01569}01569       \textcolor{comment}{// If there are additional values, resize the node}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01570}01570       \textcolor{keywordtype}{unsigned} n\_new\_val = new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01571}01571       \textcolor{keywordflow}{if} (n\_val > n\_new\_val)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01572}01572       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01573}01573         new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ae6598da29d403889020ccd47a2c07cc4}{resize}}(n\_val);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01574}01574       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01575}01575 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01576}01576       \textcolor{comment}{// Get copied history values}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01577}01577       \textcolor{comment}{//  unsigned n\_val=new\_nod\_pt-\/>nvalue();}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01578}01578       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_val = 0; i\_val < n\_val; i\_val++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01579}01579       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01580}01580         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01581}01581         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01582}01582           new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01583}01583             \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, i\_val, recv\_doubles[counter\_for\_recv\_doubles++]);}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01584}01584         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01585}01585       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01586}01586 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01587}01587       \textcolor{comment}{// Get copied history values for positions}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01588}01588       \textcolor{keywordtype}{unsigned} n\_dim = new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a786c96a8e46eb27a03b2b31f629d41b3}{ndim}}();}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01589}01589       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} idim = 0; idim < n\_dim; idim++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01590}01590       \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01591}01591         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_prev; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01592}01592         \{}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01593}01593           \textcolor{comment}{// Copy to coordinate}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01594}01594           new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, idim) = recv\_doubles[counter\_for\_recv\_doubles++];}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01595}01595         \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01596}01596       \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01597}01597     \}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01598}01598 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01599}01599 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01600}01600 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01601}01601 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01602}01602   \} \textcolor{comment}{// namespace Missing\_masters\_functions}}
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01603}01603 }
\DoxyCodeLine{\Hypertarget{missing__masters_8cc_source_l01604}01604 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

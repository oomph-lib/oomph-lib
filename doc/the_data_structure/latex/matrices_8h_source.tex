\hypertarget{matrices_8h_source}{}\doxysection{matrices.\+h}
\label{matrices_8h_source}\index{matrices.h@{matrices.h}}
\mbox{\hyperlink{matrices_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00026}00026 \textcolor{comment}{// This header file contains classes and inline function definitions for}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00027}00027 \textcolor{comment}{// matrices and their derived types}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00029}00029 \textcolor{comment}{// Include guards to prevent multiple inclusion of the header}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00030}00030 \textcolor{preprocessor}{\#ifndef OOMPH\_MATRICES\_HEADER}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00031}00031 \textcolor{preprocessor}{\#define OOMPH\_MATRICES\_HEADER}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00033}00033 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00034}00034 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00035}00035 \textcolor{preprocessor}{\#include <oomph-\/lib-\/config.h>}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00036}00036 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00038}00038 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00039}00039 \textcolor{preprocessor}{\#include "{}mpi.h"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00040}00040 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00043}00043 \textcolor{comment}{// Needed for g++ in some cases}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00044}00044 \textcolor{preprocessor}{\#include <iomanip>}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00046}00046 \textcolor{comment}{// oomph-\/lib headers}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00047}00047 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Vector_8h}{Vector.h}}"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00048}00048 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{oomph__utilities_8h}{oomph\_utilities.h}}"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00049}00049 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{linear__algebra__distribution_8h}{linear\_algebra\_distribution.h}}"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00050}00050 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{double__vector_8h}{double\_vector.h}}"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00053}00053 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_TRILINOS}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00054}00054 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{trilinos__helpers_8h}{trilinos\_helpers.h}}"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00055}00055 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00056}00056 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00057}00057 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00058}00058 \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00059}00059 \textcolor{comment}{// Initialise dense pointer-\/based matrices/tensors?}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00060}00060 \textcolor{preprocessor}{\#define OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00061}00061 \textcolor{preprocessor}{\#undef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00063}00063   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00064}00064 \textcolor{comment}{  /// Abstract base class for matrices, templated by}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00065}00065 \textcolor{comment}{  /// the type of object that is stored in them and the type of matrix.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00066}00066 \textcolor{comment}{  /// The MATRIX\_TYPE template argument is used as part of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00067}00067 \textcolor{comment}{  /// Curiously Recurring Template Pattern, see}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00068}00068 \textcolor{comment}{  /// http://en.wikipedia.org/wiki/Curiously\_Recurring\_Template\_Pattern}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00069}00069 \textcolor{comment}{  /// The pattern is used to force the inlining of the round bracket access}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00070}00070 \textcolor{comment}{  /// functions by ensuring that they are NOT virtual functions.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00071}00071 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00072}00072   \textcolor{keyword}{template}<\textcolor{keyword}{class} T, \textcolor{keyword}{class} MATRIX\_TYPE>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00073}\mbox{\hyperlink{classoomph_1_1Matrix}{00073}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1Matrix}{Matrix}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00074}00074   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00075}00075   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00076}00076 \textcolor{comment}{    /// Range check to catch when an index is out of bounds, if so, it}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00077}00077 \textcolor{comment}{    /// issues a warning message and dies by throwing an \(\backslash\)c OomphLibError}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00078}\mbox{\hyperlink{classoomph_1_1Matrix_a2fed2ea1840638eb0ddaa2d4ab1da82f}{00078}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Matrix_a2fed2ea1840638eb0ddaa2d4ab1da82f}{range\_check}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00079}00079 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00080}00080       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} >= \mbox{\hyperlink{classoomph_1_1Matrix_ac366ca5324d3e00e23d9800f3d5f4d5f}{nrow}}())}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00081}00081       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00082}00082         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00083}00083         error\_message << \textcolor{stringliteral}{"{}Range Error: i="{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00084}00084                       << \mbox{\hyperlink{classoomph_1_1Matrix_ac366ca5324d3e00e23d9800f3d5f4d5f}{nrow}}() -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00085}00085 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00086}00086         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00087}00087                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00088}00088                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00089}00089       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00090}00090       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j >= \mbox{\hyperlink{classoomph_1_1Matrix_ad1af46b34096c348272b0dfacb5ce6a9}{ncol}}())}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00091}00091       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00092}00092         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00093}00093         error\_message << \textcolor{stringliteral}{"{}Range Error: j="{}} << j << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00094}00094                       << \mbox{\hyperlink{classoomph_1_1Matrix_ad1af46b34096c348272b0dfacb5ce6a9}{ncol}}() -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00096}00096         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00097}00097                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00098}00098                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00099}00099       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00100}00100     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00103}00103   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00104}00104 \textcolor{comment}{    /// (Empty) constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00105}\mbox{\hyperlink{classoomph_1_1Matrix_ab414a0bf8e2658fc30d2c516f3bf4837}{00105}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Matrix_ab414a0bf8e2658fc30d2c516f3bf4837}{Matrix}}() \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00106}00106 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00107}00107 \textcolor{comment}{    /// Broken copy constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00108}\mbox{\hyperlink{classoomph_1_1Matrix_ac40b846daa81698ea61aba9dfb1ae361}{00108}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Matrix_ac40b846daa81698ea61aba9dfb1ae361}{Matrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Matrix}{Matrix}}\& matrix) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00109}00109 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00110}00110 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00111}\mbox{\hyperlink{classoomph_1_1Matrix_a81c8f71e6eae8ebf79aa206666e666b4}{00111}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Matrix_a81c8f71e6eae8ebf79aa206666e666b4}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Matrix}{Matrix}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00112}00112 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00113}00113 \textcolor{comment}{    /// Virtual (empty) destructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00114}\mbox{\hyperlink{classoomph_1_1Matrix_a3bc2eeb0940268de5252a9234d126f11}{00114}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1Matrix_a3bc2eeb0940268de5252a9234d126f11}{\string~Matrix}}() \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00115}00115 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00116}00116 \textcolor{comment}{    /// Return the number of rows of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00117}\mbox{\hyperlink{classoomph_1_1Matrix_ac366ca5324d3e00e23d9800f3d5f4d5f}{00117}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1Matrix_ac366ca5324d3e00e23d9800f3d5f4d5f}{nrow}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00118}00118 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00119}00119 \textcolor{comment}{    /// Return the number of columns of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00120}\mbox{\hyperlink{classoomph_1_1Matrix_ad1af46b34096c348272b0dfacb5ce6a9}{00120}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1Matrix_ad1af46b34096c348272b0dfacb5ce6a9}{ncol}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00121}00121 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00122}00122 \textcolor{comment}{    /// Round brackets to give access as a(i,j) for read only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00123}00123 \textcolor{comment}{    /// (we're not providing a general interface for component-\/wise write}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00124}00124 \textcolor{comment}{    /// access since not all matrix formats allow efficient direct access!)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00125}00125 \textcolor{comment}{    /// The function uses the  MATRIX\_TYPE template parameter to call the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00126}00126 \textcolor{comment}{    /// get\_entry() function which must be defined in all derived classes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00127}00127 \textcolor{comment}{    /// that are to be fully instantiated.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00128}\mbox{\hyperlink{classoomph_1_1Matrix_a26f23d2b331cb7f533fd8585f1ef8d28}{00128}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1Matrix_a26f23d2b331cb7f533fd8585f1ef8d28}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00129}00129 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00130}00130       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}MATRIX\_TYPE const*\textcolor{keyword}{>}(\textcolor{keyword}{this})-\/>get\_entry(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00131}00131     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00132}00132 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00133}00133 \textcolor{comment}{    ///  Round brackets to give access as a(i,j) for read-\/write}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00134}00134 \textcolor{comment}{    /// access.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00135}00135 \textcolor{comment}{    /// The function uses the MATRIX\_TYPE template parameter to call the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00136}00136 \textcolor{comment}{    /// entry() function which must be defined in all derived classes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00137}00137 \textcolor{comment}{    /// that are to be fully instantiated. If the particular Matrix does}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00138}00138 \textcolor{comment}{    /// not allow write access, the function should break with an error}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00139}00139 \textcolor{comment}{    /// message.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00140}\mbox{\hyperlink{classoomph_1_1Matrix_a0f6a65782771830fd4fa1a16284c6bc9}{00140}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1Matrix_a0f6a65782771830fd4fa1a16284c6bc9}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00141}00141     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00142}00142       \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}MATRIX\_TYPE*\textcolor{keyword}{>}(\textcolor{keyword}{this})-\/>entry(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00143}00143     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00144}00144 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00145}00145 \textcolor{comment}{    /// Output function to print a matrix row-\/by-\/row, in the form}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00146}00146 \textcolor{comment}{    /// a(0,0) a(0,1) ...}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00147}00147 \textcolor{comment}{    /// a(1,0) a(1,1) ...}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00148}00148 \textcolor{comment}{    /// ...}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00149}00149 \textcolor{comment}{    /// to the stream outfile.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00150}00150 \textcolor{comment}{    /// Broken virtual since it might not be sensible to implement this for}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00151}00151 \textcolor{comment}{    /// some sparse matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00152}\mbox{\hyperlink{classoomph_1_1Matrix_ace9b59cbe514c77f0b3816b144c740f6}{00152}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Matrix_ace9b59cbe514c77f0b3816b144c740f6}{output}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00153}00153 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00154}00154       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00155}00155         \textcolor{stringliteral}{"{}Output function is not implemented for this matrix class"{}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00156}00156         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00157}00157         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00158}00158     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00159}00159 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00160}00160 \textcolor{comment}{    /// Output the "{}bottom right"{} entry regardless of it being}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00161}00161 \textcolor{comment}{    /// zero or not (this allows automatic detection of matrix size in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00162}00162 \textcolor{comment}{    /// e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00163}00163 \textcolor{comment}{    /// This functionality was moved from the function}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00164}00164 \textcolor{comment}{    /// sparse\_indexed\_output(...) because at the moment, generalisation of}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00165}00165 \textcolor{comment}{    /// this functionality does not work in parallel. CRDoubleMatrix has an}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00166}00166 \textcolor{comment}{    /// nrow() function but it should it should use nrow\_local() -\/ which is the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00167}00167 \textcolor{comment}{    /// N variable in the underlaying CRMatrix.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00168}\mbox{\hyperlink{classoomph_1_1Matrix_a10ee338f4d3893010291a692aea04248}{00168}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Matrix_a10ee338f4d3893010291a692aea04248}{output\_bottom\_right\_zero\_helper}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00169}00169       std::ostream\& outfile) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00170}00170 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00171}00171 \textcolor{comment}{    /// Indexed output function to print a matrix to the stream outfile}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00172}00172 \textcolor{comment}{    /// as i,j,a(i,j) for a(i,j)!=0 only.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00173}\mbox{\hyperlink{classoomph_1_1Matrix_a7a5b44e7688ce2c2f7552da104e615c8}{00173}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Matrix_a7a5b44e7688ce2c2f7552da104e615c8}{sparse\_indexed\_output\_helper}}(std::ostream\& outfile) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00175}00175 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00176}00176 \textcolor{comment}{    /// Indexed output function to print a matrix to the stream outfile}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00177}00177 \textcolor{comment}{    /// as i,j,a(i,j) for a(i,j)!=0 only with specified precision (if}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00178}00178 \textcolor{comment}{    /// precision=0 then nothing is changed). If optional boolean flag is set}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00179}00179 \textcolor{comment}{    /// to true we also output the "{}bottom right"{} entry regardless of it being}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00180}00180 \textcolor{comment}{    /// zero or not (this allows automatic detection of matrix size in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00181}00181 \textcolor{comment}{    /// e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00182}\mbox{\hyperlink{classoomph_1_1Matrix_a4f97fa3c94e6fd664e46acb8873a80f8}{00182}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Matrix_a4f97fa3c94e6fd664e46acb8873a80f8}{sparse\_indexed\_output}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00183}00183       std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00184}00184       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& precision = 0,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00185}00185       \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& output\_bottom\_right\_zero = \textcolor{keyword}{false})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00186}00186 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00187}00187       \textcolor{comment}{// Implemented as a wrapper around "{}sparse\_indexed\_output(std::ostream)"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00188}00188       \textcolor{comment}{// so that only one output helper function is needed in derived classes.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00189}00189 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00190}00190       \textcolor{comment}{// We can't have separate functions for only "{}output\_bottom\_right\_zero"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00191}00191       \textcolor{comment}{// because people often write false as "{}0"{} and then C++ would pick the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00192}00192       \textcolor{comment}{// wrong function.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00193}00193 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00194}00194       \textcolor{comment}{// If requested set the new precision and store the previous value.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00195}00195       \textcolor{keywordtype}{unsigned} old\_precision = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00196}00196       \textcolor{keywordflow}{if} (precision != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00197}00197       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00198}00198         old\_precision = outfile.precision();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00199}00199         outfile.precision(precision);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00200}00200       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00201}00201 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00202}00202       \textcolor{comment}{// Output as normal using the helper function defined in each matrix class}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00203}00203       \mbox{\hyperlink{classoomph_1_1Matrix_a7a5b44e7688ce2c2f7552da104e615c8}{sparse\_indexed\_output\_helper}}(outfile);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00204}00204 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00205}00205       \textcolor{comment}{// If requested and there is no output for the last entry then output a}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00206}00206       \textcolor{comment}{// zero entry.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00207}00207       \textcolor{keywordflow}{if} (output\_bottom\_right\_zero \&\& \mbox{\hyperlink{classoomph_1_1Matrix_ad1af46b34096c348272b0dfacb5ce6a9}{ncol}}() > 0 \&\& \mbox{\hyperlink{classoomph_1_1Matrix_ac366ca5324d3e00e23d9800f3d5f4d5f}{nrow}}() > 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00208}00208       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00209}00209         \textcolor{comment}{// Output as normal using the helper function defined}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00210}00210         \textcolor{comment}{// in each matrix class}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00211}00211         \mbox{\hyperlink{classoomph_1_1Matrix_a10ee338f4d3893010291a692aea04248}{output\_bottom\_right\_zero\_helper}}(outfile);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00212}00212       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00213}00213 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00214}00214       \textcolor{comment}{// Restore the old value of the precision if we changed it}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00215}00215       \textcolor{keywordflow}{if} (precision != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00216}00216       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00217}00217         outfile.precision(old\_precision);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00218}00218       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00219}00219     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00220}00220 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00221}00221 \textcolor{comment}{    /// Indexed output function to print a matrix to the file named}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00222}00222 \textcolor{comment}{    /// filename as i,j,a(i,j) for a(i,j)!=0 only with specified precision. If}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00223}00223 \textcolor{comment}{    /// optional boolean flag is set to true we also output the "{}bottom right"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00224}00224 \textcolor{comment}{    /// entry regardless of it being zero or not (this allows automatic}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00225}00225 \textcolor{comment}{    /// detection of matrix size in e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00226}\mbox{\hyperlink{classoomph_1_1Matrix_ac7473fb07d4db925b4cf3a22131b561a}{00226}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Matrix_ac7473fb07d4db925b4cf3a22131b561a}{sparse\_indexed\_output}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00227}00227       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} filename,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00228}00228       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& precision = 0,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00229}00229       \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& output\_bottom\_right\_zero = \textcolor{keyword}{false})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00230}00230 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00231}00231       \textcolor{comment}{// Implemented as a wrapper around "{}sparse\_indexed\_output(std::ostream)"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00232}00232       \textcolor{comment}{// so that only one output function needs to be written in matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00233}00233       \textcolor{comment}{// subclasses.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00234}00234 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00235}00235       \textcolor{comment}{// Open file}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00236}00236       std::ofstream some\_file(filename.c\_str());}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00237}00237 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00238}00238       \textcolor{comment}{// Output as normal}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00239}00239       \mbox{\hyperlink{classoomph_1_1Matrix_a4f97fa3c94e6fd664e46acb8873a80f8}{sparse\_indexed\_output}}(some\_file, precision, output\_bottom\_right\_zero);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00240}00240 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00241}00241       \textcolor{comment}{// Close file}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00242}00242       some\_file.close();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00243}00243     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00244}00244   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00245}00245 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00246}00246 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00247}00247 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00248}00248 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00249}00249 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00250}00250 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00251}00251 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00252}00252   \textcolor{comment}{// Forward definition of the linear solver class}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00253}00253   \textcolor{keyword}{class }LinearSolver;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00254}00254 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00255}00255   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00256}00256 \textcolor{comment}{  /// Abstract base class for matrices of doubles -\/-\/ adds}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00257}00257 \textcolor{comment}{  /// abstract interfaces for solving, LU decomposition and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00258}00258 \textcolor{comment}{  /// multiplication by vectors.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00259}00259 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00260}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{00260}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00261}00261   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00262}00262   \textcolor{keyword}{protected}:}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00263}00263     \textcolor{comment}{// Pointer to a linear solver}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00264}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a86f0315e581cd5b41b75867383aa3760}{00264}}     \mbox{\hyperlink{classoomph_1_1LinearSolver}{LinearSolver}}* \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a86f0315e581cd5b41b75867383aa3760}{Linear\_solver\_pt}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00265}00265 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00266}00266     \textcolor{comment}{// Pointer to a default linear solver}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00267}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a6ef2e36e4e5907af2738934f131e8dcf}{00267}}     \mbox{\hyperlink{classoomph_1_1LinearSolver}{LinearSolver}}* \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a6ef2e36e4e5907af2738934f131e8dcf}{Default\_linear\_solver\_pt}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00269}00269   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00270}00270 \textcolor{comment}{    /// (Empty) constructor.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00271}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a9ab2dcaf990403cd43d4b952f7dbaa1c}{00271}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a9ab2dcaf990403cd43d4b952f7dbaa1c}{DoubleMatrixBase}}() : \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a86f0315e581cd5b41b75867383aa3760}{Linear\_solver\_pt}}(0), \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a6ef2e36e4e5907af2738934f131e8dcf}{Default\_linear\_solver\_pt}}(0) \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00272}00272 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00273}00273 \textcolor{comment}{    /// Broken copy constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00274}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a449fe88a14eed90f8820a75f53883c66}{00274}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a449fe88a14eed90f8820a75f53883c66}{DoubleMatrixBase}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}}\& matrix) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00275}00275 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00276}00276 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00277}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_abc390458d9899179f84488f6a94b261d}{00277}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_abc390458d9899179f84488f6a94b261d}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00278}00278 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00279}00279 \textcolor{comment}{    /// Return the number of rows of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00280}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_acdcd6e1ea2bf2380f1a2fa32c7829cb5}{00280}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_acdcd6e1ea2bf2380f1a2fa32c7829cb5}{nrow}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00281}00281 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00282}00282 \textcolor{comment}{    /// Return the number of columns of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00283}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a253feffbf1db1976cdd86c6134c50abe}{00283}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a253feffbf1db1976cdd86c6134c50abe}{ncol}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00284}00284 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00285}00285 \textcolor{comment}{    /// virtual (empty) destructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00286}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a82ece2e3cfc355bb68ba78a2ed9dae9f}{00286}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a82ece2e3cfc355bb68ba78a2ed9dae9f}{\string~DoubleMatrixBase}}() \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00287}00287 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00288}00288 \textcolor{comment}{    /// Round brackets to give access as a(i,j) for read only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00289}00289 \textcolor{comment}{    /// (we're not providing a general interface for component-\/wise write}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00290}00290 \textcolor{comment}{    /// access since not all matrix formats allow efficient direct access!)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00291}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a20b85f0286f80464f42f0846fede2d77}{00291}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a20b85f0286f80464f42f0846fede2d77}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00292}00292                               \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00293}00293 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00294}00294 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00295}00295 \textcolor{comment}{    /// Return a pointer to the linear solver object}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00296}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_aa2ef063bc84bee59fec7a933093ac8f7}{00296}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1LinearSolver}{LinearSolver}}*\& \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_aa2ef063bc84bee59fec7a933093ac8f7}{linear\_solver\_pt}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00297}00297     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00298}00298       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a86f0315e581cd5b41b75867383aa3760}{Linear\_solver\_pt}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00299}00299     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00300}00300 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00301}00301 \textcolor{comment}{    /// Return a pointer to the linear solver object (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00302}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a48e6ef5e74c6c260919d3bf0420c7a68}{00302}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1LinearSolver}{LinearSolver}}* \textcolor{keyword}{const}\& \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a48e6ef5e74c6c260919d3bf0420c7a68}{linear\_solver\_pt}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00303}00303 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00304}00304       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a86f0315e581cd5b41b75867383aa3760}{Linear\_solver\_pt}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00305}00305     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00306}00306 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00307}00307 \textcolor{comment}{    /// Complete LU solve (replaces matrix by its LU decomposition}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00308}00308 \textcolor{comment}{    /// and overwrites RHS with solution). The default should not need}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00309}00309 \textcolor{comment}{    /// to be over-\/written}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00310}00310 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a4d445c4a1204da569f40ec1bdace9ef3}{solve}}(\mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& rhs);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00311}00311 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00312}00312 \textcolor{comment}{    /// Complete LU solve (Nothing gets overwritten!). The default should}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00313}00313 \textcolor{comment}{    /// not need to be overwritten}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00314}00314 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a4d445c4a1204da569f40ec1bdace9ef3}{solve}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& rhs, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00315}00315 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00316}00316 \textcolor{comment}{    /// Complete LU solve (replaces matrix by its LU decomposition}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00317}00317 \textcolor{comment}{    /// and overwrites RHS with solution). The default should not need}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00318}00318 \textcolor{comment}{    /// to be over-\/written}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00319}00319 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a4d445c4a1204da569f40ec1bdace9ef3}{solve}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& rhs);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00320}00320 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00321}00321 \textcolor{comment}{    /// Complete LU solve (Nothing gets overwritten!). The default should}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00322}00322 \textcolor{comment}{    /// not need to be overwritten}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00323}00323 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a4d445c4a1204da569f40ec1bdace9ef3}{solve}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& rhs, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& soln);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00324}00324 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00325}00325 \textcolor{comment}{    /// Find the residual, i.e. r=b-\/Ax the residual}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00326}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a971bdc2d9297fc582af8467178f4e00e}{00326}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a971bdc2d9297fc582af8467178f4e00e}{residual}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00327}00327                           \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& b,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00328}00328                           \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& residual\_)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00329}00329     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00330}00330       \textcolor{comment}{// compute residual = Ax}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00331}00331       this-\/>\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a78204eab557e0dc99618e41a28a5c092}{multiply}}(x, residual\_);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00332}00332 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00333}00333       \textcolor{comment}{// set residual to -\/residual (-\/Ax)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00334}00334       \textcolor{keywordtype}{unsigned} nrow\_local = residual\_.\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\_local}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00335}00335       \textcolor{keywordtype}{double}* residual\_pt = residual\_.\mbox{\hyperlink{classoomph_1_1DoubleVector_ae3484a5eb4cb663e09640806ef1bf05a}{values\_pt}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00336}00336       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nrow\_local; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00337}00337       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00338}00338         residual\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = -\/residual\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00339}00339       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00341}00341       \textcolor{comment}{// set residual = b + residuals}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00342}00342       residual\_ += b;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00343}00343     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00344}00344 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00345}00345 \textcolor{comment}{    /// Find the maximum residual r=b-\/Ax -\/-\/ generic version, can be}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00346}00346 \textcolor{comment}{    /// overloaded for specific derived classes where the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00347}00347 \textcolor{comment}{    /// max. can be determined "{}on the fly"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00348}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a69a001b704e1d67277170ff7c0e4f6af}{00348}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a69a001b704e1d67277170ff7c0e4f6af}{max\_residual}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& rhs)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00349}00349     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00350}00350       \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} res;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00351}00351       \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a971bdc2d9297fc582af8467178f4e00e}{residual}}(\mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, rhs, res);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00352}00352       \textcolor{keywordflow}{return} res.\mbox{\hyperlink{classoomph_1_1DoubleVector_a4c176b562f503701d65882a930d5b8f5}{max}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00353}00353     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00354}00354 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00355}00355 \textcolor{comment}{    /// Multiply the matrix by the vector x: soln=Ax.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00356}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a78204eab557e0dc99618e41a28a5c092}{00356}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a78204eab557e0dc99618e41a28a5c092}{multiply}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00357}00357 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00358}00358 \textcolor{comment}{    /// Multiply the  transposed matrix by the vector x: soln=A\string^T x}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00359}\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a843d44405b70da1d96b43218a21e6ffc}{00359}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase_a843d44405b70da1d96b43218a21e6ffc}{multiply\_transpose}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00360}00360                                     \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00361}00361 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00362}00362 \textcolor{comment}{    /// For every row, find the maximum absolute value of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00363}00363 \textcolor{comment}{    /// entries in this row. Set all values that are less than alpha times}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00364}00364 \textcolor{comment}{    /// this maximum to zero and return the resulting matrix in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00365}00365 \textcolor{comment}{    /// reduced\_matrix. Note: Diagonal entries are retained regardless}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00366}00366 \textcolor{comment}{    /// of their size.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00367}00367 \textcolor{comment}{}    \textcolor{comment}{// virtual void matrix\_reduction(const double \&alpha,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00368}00368     \textcolor{comment}{//                              DoubleMatrixBase\& reduced\_matrix)=0;}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00369}00369   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00370}00370 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00371}00371 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00372}00372 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00373}00373 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00374}00374 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00375}00375 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00377}00377   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00378}00378 \textcolor{comment}{  /// Class for dense matrices, storing all the values of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00379}00379 \textcolor{comment}{  /// matrix as a pointer to a pointer with assorted output functions}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00380}00380 \textcolor{comment}{  /// inherited from Matrix<T>. The curious recursive template pattern is}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00381}00381 \textcolor{comment}{  /// used here to pass the specific class to the base class so that}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00382}00382 \textcolor{comment}{  /// round bracket access can be inlined.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00383}00383 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00384}00384   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00385}\mbox{\hyperlink{classoomph_1_1DenseMatrix}{00385}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1Matrix}{Matrix}}<T, DenseMatrix<T>>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00386}00386   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00387}00387   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00388}00388 \textcolor{comment}{    /// Internal representation of matrix as a pointer to data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00389}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{00389}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00390}00390 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00391}00391 \textcolor{comment}{    /// Number of rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00392}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{00392}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00393}00393 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00394}00394 \textcolor{comment}{    /// Number of columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00395}\mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{00395}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00396}00396 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00397}00397   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00398}00398 \textcolor{comment}{    /// Empty constructor, simply assign the lengths N and M to 0}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00399}\mbox{\hyperlink{classoomph_1_1DenseMatrix_aecfca835918b50b607e080fc706b6fcf}{00399}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseMatrix_aecfca835918b50b607e080fc706b6fcf}{DenseMatrix}}() : \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}}(0), \mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}}(0), \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}}(0) \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00400}00400 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00401}00401 \textcolor{comment}{    /// Copy constructor: Deep copy!}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00402}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a1d8bf7ffb6cc91b882be17b25ff6d452}{00402}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseMatrix_a1d8bf7ffb6cc91b882be17b25ff6d452}{DenseMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix}}\& source\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00403}00403     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00404}00404       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00405}00405       \mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}} = source\_matrix.\mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{nrow}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00406}00406       \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}} = source\_matrix.\mbox{\hyperlink{classoomph_1_1DenseMatrix_a9937181f1cb4cfaed7aaf3b483c42456}{ncol}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00407}00407       \textcolor{comment}{// Assign space for the data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00408}00408       \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}} * \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00409}00409       \textcolor{comment}{// Copy the data across from the other matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00410}00410       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00411}00411       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00412}00412         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00413}00413         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00414}00414           \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}}[\mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j] = source\_matrix(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00415}00415         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00416}00416       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00417}00417     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00418}00418 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00419}00419 \textcolor{comment}{    /// Copy assignment}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00420}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a01b02acc166aa69ec0a7d9153076b5f4}{00420}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix}}\& \mbox{\hyperlink{classoomph_1_1DenseMatrix_a01b02acc166aa69ec0a7d9153076b5f4}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix}}\& source\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00421}00421     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00422}00422       \textcolor{comment}{// Don't create a new matrix if the assignment is the identity}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00423}00423       \textcolor{keywordflow}{if} (\textcolor{keyword}{this} != \&source\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00424}00424       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00425}00425         \textcolor{comment}{// Check row and column length}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00426}00426         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = source\_matrix.\mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{nrow}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00427}00427         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} m = source\_matrix.\mbox{\hyperlink{classoomph_1_1DenseMatrix_a9937181f1cb4cfaed7aaf3b483c42456}{ncol}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00428}00428         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}} != n) || (\mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}} != m))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00429}00429         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00430}00430           \mbox{\hyperlink{classoomph_1_1DenseMatrix_adec1ef741b1c5048a12ba9a540c2719c}{resize}}(n, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00431}00431         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00432}00432         \textcolor{comment}{// Copy entries across from the other matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00433}00433         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00434}00434         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00435}00435           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00436}00436           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00437}00437             (*this)(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) = source\_matrix(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00438}00438           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00439}00439         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00440}00440       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00441}00441       \textcolor{comment}{// Return reference to object itself (i.e. de-\/reference this pointer)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00442}00442       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00443}00443     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00444}00444 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00445}00445 \textcolor{comment}{    /// The access function that will be called by the read-\/write}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00446}00446 \textcolor{comment}{    /// round-\/bracket operator.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00447}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a727aed44cb4b695daa4120178517c03d}{00447}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1DenseMatrix_a727aed44cb4b695daa4120178517c03d}{entry}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00448}00448     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00449}00449 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00450}00450       this-\/>\mbox{\hyperlink{classoomph_1_1Matrix_a2fed2ea1840638eb0ddaa2d4ab1da82f}{range\_check}}(i, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00451}00451 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00452}00452       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}}[\mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00453}00453     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00454}00454 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00455}00455 \textcolor{comment}{    /// The access function the will be called by the read-\/only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00456}00456 \textcolor{comment}{    /// (const version) round-\/bracket operator.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00457}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a0b03682b4c7d8f820599bd2681a01ee0}{00457}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a0b03682b4c7d8f820599bd2681a01ee0}{get\_entry}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00458}00458 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00459}00459 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00460}00460       this-\/>\mbox{\hyperlink{classoomph_1_1Matrix_a2fed2ea1840638eb0ddaa2d4ab1da82f}{range\_check}}(i, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00461}00461 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00462}00462       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}}[\mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00463}00463     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00464}00464 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00465}00465 \textcolor{comment}{    /// Constructor to build a square n by n matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00466}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a2291404def276dcee1a6099d054d44d6}{00466}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseMatrix_a2291404def276dcee1a6099d054d44d6}{DenseMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00467}00467 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00468}00468 \textcolor{comment}{    /// Constructor to build a matrix with n rows and m columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00469}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a5afcfd56a9720541e67a6e8d002016d4}{00469}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseMatrix_a5afcfd56a9720541e67a6e8d002016d4}{DenseMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00470}00470 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00471}00471 \textcolor{comment}{    /// Constructor to build a matrix with n rows and m columns,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00472}00472 \textcolor{comment}{    /// with initial value initial\_val}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00473}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a7b599610bd78a7818b2e4d0835b27e3a}{00473}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseMatrix_a7b599610bd78a7818b2e4d0835b27e3a}{DenseMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00474}00474                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00475}00475                 \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_val);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00476}00476 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00477}00477 \textcolor{comment}{    /// Destructor, clean up the matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00478}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a673e04c72174ec084e56ad5f53ba51da}{00478}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a673e04c72174ec084e56ad5f53ba51da}{\string~DenseMatrix}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00479}00479     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00480}00480       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00481}00481       \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00482}00482     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00483}00483 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00484}00484 \textcolor{comment}{    /// Return the number of rows of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00485}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{00485}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{nrow}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00486}00486 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00487}00487       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00488}00488     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00489}00489 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00490}00490 \textcolor{comment}{    /// Return the number of columns of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00491}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a9937181f1cb4cfaed7aaf3b483c42456}{00491}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a9937181f1cb4cfaed7aaf3b483c42456}{ncol}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00492}00492 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00493}00493       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00494}00494     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00495}00495 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00496}00496 \textcolor{comment}{    /// Resize to a square nxn matrix;}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00497}00497 \textcolor{comment}{    /// any values already present will be transfered}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00498}\mbox{\hyperlink{classoomph_1_1DenseMatrix_adec1ef741b1c5048a12ba9a540c2719c}{00498}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_adec1ef741b1c5048a12ba9a540c2719c}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00499}00499     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00500}00500       \mbox{\hyperlink{classoomph_1_1DenseMatrix_adec1ef741b1c5048a12ba9a540c2719c}{resize}}(n, n);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00501}00501     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00502}00502 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00503}00503 \textcolor{comment}{    /// Resize to a non-\/square n x m matrix;}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00504}00504 \textcolor{comment}{    /// any values already present will be transfered}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00505}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a0f01dd97b1c71868371f93259efc26b0}{00505}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a0f01dd97b1c71868371f93259efc26b0}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00506}00506 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00507}00507 \textcolor{comment}{    /// Resize to a non-\/square n x m matrix and initialize the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00508}00508 \textcolor{comment}{    /// new values to initial\_value.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00509}\mbox{\hyperlink{classoomph_1_1DenseMatrix_aeb6daf6539fee8d3d6f7a81306798b10}{00509}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_aeb6daf6539fee8d3d6f7a81306798b10}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00510}00510                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00511}00511                 \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_value);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00512}00512 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00513}00513 \textcolor{comment}{    /// Initialize all values in the matrix to val.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00514}\mbox{\hyperlink{classoomph_1_1DenseMatrix_aafcfbb0309fdcbd84f8654fe1b5601fd}{00514}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_aafcfbb0309fdcbd84f8654fe1b5601fd}{initialise}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& val)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00515}00515     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00516}00516       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < (\mbox{\hyperlink{classoomph_1_1DenseMatrix_a23cb539be0b4ef0381b9f18e8e50f75e}{N}} * \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa36631ee95fe55afe697377b03d05d6a}{M}}); ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00517}00517       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00518}00518         \mbox{\hyperlink{classoomph_1_1DenseMatrix_a92a2eea603a42e22fd4d3ea0a258e6f8}{Matrixdata}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = val;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00519}00519       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00520}00520     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00521}00521 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00522}00522 \textcolor{comment}{    /// Output function to print a matrix row-\/by-\/row to the stream outfile}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00523}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a03e20626e889a1ab4582614f55784165}{00523}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a03e20626e889a1ab4582614f55784165}{output}}(std::ostream\& outfile) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00524}00524 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00525}00525 \textcolor{comment}{    /// Output function to print a matrix row-\/by-\/row to a file. Specify}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00526}00526 \textcolor{comment}{    /// filename.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00527}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a4ab60b1e7db98bcb5b75b080266e452e}{00527}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a4ab60b1e7db98bcb5b75b080266e452e}{output}}(\mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} filename) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00528}00528 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00529}00529 \textcolor{comment}{    /// Indexed output function to print a matrix to the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00530}00530 \textcolor{comment}{    /// stream outfile as i,j,a(i,j)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00531}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a440b549690cfc07c85f395eb06951321}{00531}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a440b549690cfc07c85f395eb06951321}{indexed\_output}}(std::ostream\& outfile) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00532}00532 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00533}00533 \textcolor{comment}{    /// Indexed output function to print a matrix to a}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00534}00534 \textcolor{comment}{    /// file as i,j,a(i,j). Specify filename.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00535}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a5730d359fa98ea501ab7115147a4bd87}{00535}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a5730d359fa98ea501ab7115147a4bd87}{indexed\_output}}(\mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} filename) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00536}00536 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00537}00537 \textcolor{comment}{    /// Output the "{}bottom right"{} entry regardless of it being}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00538}00538 \textcolor{comment}{    /// zero or not (this allows automatic detection of matrix size in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00539}00539 \textcolor{comment}{    /// e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00540}\mbox{\hyperlink{classoomph_1_1DenseMatrix_aa02dc7c9b2f4e1cc1204cc8281f030f9}{00540}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa02dc7c9b2f4e1cc1204cc8281f030f9}{output\_bottom\_right\_zero\_helper}}(std::ostream\& outfile) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00541}00541 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00542}00542 \textcolor{comment}{    /// Indexed output function to print a matrix to the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00543}00543 \textcolor{comment}{    /// stream outfile as i,j,a(i,j) for a(i,j)!=0 only.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00544}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a6e9084acc11e036d4c5f7e5322d12034}{00544}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a6e9084acc11e036d4c5f7e5322d12034}{sparse\_indexed\_output\_helper}}(std::ostream\& outfile) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00545}00545   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00546}00546 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00547}00547 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00548}00548 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00549}00549 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00550}00550 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00551}00551 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00552}00552 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00553}00553   \textcolor{comment}{//================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00554}00554 \textcolor{comment}{  /// Class for sparse matrices, that store only the non-\/zero values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00555}00555 \textcolor{comment}{  /// in a linear array in memory. The details of the array indexing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00556}00556 \textcolor{comment}{  /// vary depending on the storage scheme used. The MATRIX\_TYPE}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00557}00557 \textcolor{comment}{  /// template parameter for use in the curious recursive template}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00558}00558 \textcolor{comment}{  /// pattern is included and passed directly to the base Matrix class.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00559}00559 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00560}00560   \textcolor{keyword}{template}<\textcolor{keyword}{class} T, \textcolor{keyword}{class} MATRIX\_TYPE>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00561}\mbox{\hyperlink{classoomph_1_1SparseMatrix}{00561}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1Matrix}{Matrix}}<T, MATRIX\_TYPE>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00562}00562   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00563}00563   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00564}00564 \textcolor{comment}{    /// Internal representation of the matrix values, a pointer}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00565}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{00565}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00566}00566 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00567}00567 \textcolor{comment}{    /// Number of rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00568}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{00568}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00569}00569 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00570}00570 \textcolor{comment}{    /// Number of columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00571}\mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{00571}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00572}00572 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00573}00573 \textcolor{comment}{    /// Number of non-\/zero values (i.e. size of Value array)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00574}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{00574}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00575}00575 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00576}00576 \textcolor{comment}{    /// Dummy zero}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00577}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a71a5ae159c26f93c314c839f4db6eaaf}{00577}} \textcolor{comment}{}    \textcolor{keyword}{static} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a71a5ae159c26f93c314c839f4db6eaaf}{Zero}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00578}00578 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00579}00579   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00580}00580 \textcolor{comment}{    /// Default constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00581}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a9aff0ae09aadbc704580726a53fe51c5}{00581}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1SparseMatrix_a9aff0ae09aadbc704580726a53fe51c5}{SparseMatrix}}() : \mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}}(0), \mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}}(0), \mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{M}}(0), \mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}}(0) \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00582}00582 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00583}00583 \textcolor{comment}{    /// Copy constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00584}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a9e4062d0e4f877537d195aada71d854d}{00584}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1SparseMatrix_a9e4062d0e4f877537d195aada71d854d}{SparseMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}\& source\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00585}00585     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00586}00586       \textcolor{comment}{// Number of nonzero entries}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00587}00587       \mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}} = source\_matrix.\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8b8010edcc0869283621e72a9bbc51e3}{nnz}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00588}00588 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00589}00589       \textcolor{comment}{// Number of rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00590}00590       \mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}} = source\_matrix.\mbox{\hyperlink{classoomph_1_1SparseMatrix_a21e22f93a942583ca83cea18c23bdd11}{nrow}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00591}00591 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00592}00592       \textcolor{comment}{// Number of columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00593}00593       \mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{M}} = source\_matrix.\mbox{\hyperlink{classoomph_1_1SparseMatrix_a4db71b6d794cfcee1624c15c09d62d7f}{ncol}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00594}00594 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00595}00595       \textcolor{comment}{// Values stored in C-\/style array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00596}00596       \mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00597}00597 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00598}00598       \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00599}00599       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00600}00600       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00601}00601         \mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = source\_matrix.\mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}}()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00602}00602       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00603}00603     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00604}00604 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00605}00605 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00606}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8646d89594b246a394c89d4be134c423}{00606}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a8646d89594b246a394c89d4be134c423}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00607}00607 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00608}00608 \textcolor{comment}{    /// Destructor, delete the memory associated with the values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00609}\mbox{\hyperlink{classoomph_1_1SparseMatrix_aa938bb1200e49f080b980fe7248f589e}{00609}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1SparseMatrix_aa938bb1200e49f080b980fe7248f589e}{\string~SparseMatrix}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00610}00610     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00611}00611       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00612}00612       \mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00613}00613     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00614}00614 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00615}00615 \textcolor{comment}{    /// Access to C-\/style value array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00616}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{00616}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00617}00617     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00618}00618       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00619}00619     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00620}00620 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00621}00621 \textcolor{comment}{    /// Access to C-\/style value array (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00622}\mbox{\hyperlink{classoomph_1_1SparseMatrix_af3284bc630be1707c08c81aa25d9a836}{00622}} \textcolor{comment}{}    \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1SparseMatrix_af3284bc630be1707c08c81aa25d9a836}{value}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00623}00623 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00624}00624       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00625}00625     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00626}00626 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00627}00627 \textcolor{comment}{    /// Return the number of rows of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00628}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a21e22f93a942583ca83cea18c23bdd11}{00628}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a21e22f93a942583ca83cea18c23bdd11}{nrow}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00629}00629 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00630}00630       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00631}00631     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00632}00632 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00633}00633 \textcolor{comment}{    /// Return the number of columns of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00634}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a4db71b6d794cfcee1624c15c09d62d7f}{00634}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a4db71b6d794cfcee1624c15c09d62d7f}{ncol}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00635}00635 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00636}00636       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00637}00637     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00638}00638 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00639}00639 \textcolor{comment}{    /// Return the number of nonzero entries}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00640}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8b8010edcc0869283621e72a9bbc51e3}{00640}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a8b8010edcc0869283621e72a9bbc51e3}{nnz}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00641}00641 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00642}00642       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00643}00643     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00644}00644 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00645}00645 \textcolor{comment}{    /// Output the "{}bottom right"{} entry regardless of it being}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00646}00646 \textcolor{comment}{    /// zero or not (this allows automatic detection of matrix size in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00647}00647 \textcolor{comment}{    /// e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00648}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a4c638f36db786e159565e1f890402ed2}{00648}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a4c638f36db786e159565e1f890402ed2}{output\_bottom\_right\_zero\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00649}00649 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00650}00650       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message = \textcolor{stringliteral}{"{}SparseMatrix::output\_bottom\_right\_zero\_"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00651}00651                                   \textcolor{stringliteral}{"{}helper() is a virtual function.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00652}00652       error\_message +=}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00653}00653         \textcolor{stringliteral}{"{}It must be overloaded for specific sparse matrix storage formats\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00654}00654 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00655}00655       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00656}00656         error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00657}00657     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00658}00658 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00659}00659 \textcolor{comment}{    /// Indexed output function to print a matrix to the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00660}00660 \textcolor{comment}{    /// stream outfile as i,j,a(i,j) for a(i,j)!=0 only.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00661}\mbox{\hyperlink{classoomph_1_1SparseMatrix_a84a08f7e77be50af6a5655cbe0609619}{00661}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a84a08f7e77be50af6a5655cbe0609619}{sparse\_indexed\_output\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00662}00662 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00663}00663       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00664}00664         \textcolor{stringliteral}{"{}SparseMatrix::sparse\_indexed\_output\_helper() is a virtual function.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00665}00665       error\_message +=}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00666}00666         \textcolor{stringliteral}{"{}It must be overloaded for specific sparse matrix storage formats\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00667}00667 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00668}00668       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00669}00669         error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00670}00670     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00671}00671   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00672}00672 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00673}00673 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00674}00674   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00675}00675 \textcolor{comment}{  /// A class for compressed row matrices, a sparse storage format}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00676}00676 \textcolor{comment}{  /// Once again the recursive template trick is used to inform that base}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00677}00677 \textcolor{comment}{  /// class that is should use the access functions provided in the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00678}00678 \textcolor{comment}{  /// CRMatrix class.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00679}00679 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00680}00680   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00681}\mbox{\hyperlink{classoomph_1_1CRMatrix}{00681}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1CRMatrix}{CRMatrix}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}<T, CRMatrix<T>>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00682}00682   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00683}00683   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00684}00684 \textcolor{comment}{    /// Default constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00685}\mbox{\hyperlink{classoomph_1_1CRMatrix_a0b362175c2474a0531ed7b196681209b}{00685}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRMatrix_a0b362175c2474a0531ed7b196681209b}{CRMatrix}}() : \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}, \mbox{\hyperlink{classoomph_1_1CRMatrix}{CRMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}>>()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00686}00686     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00687}00687       \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00688}00688       \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00689}00689     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00690}00690 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00691}00691 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00692}00692 \textcolor{comment}{    /// Constructor: Pass vector of values, vector of column indices,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00693}00693 \textcolor{comment}{    /// vector of row starts and number of rows and columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00694}00694 \textcolor{comment}{    /// Number of nonzero entries is read}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00695}00695 \textcolor{comment}{    /// off from value, so make sure the vector has been shrunk}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00696}00696 \textcolor{comment}{    /// to its correct length.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00697}\mbox{\hyperlink{classoomph_1_1CRMatrix_afefb2869fd01835cd23a8db25b90148f}{00697}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRMatrix_afefb2869fd01835cd23a8db25b90148f}{CRMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<T>}}\& \mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00698}00698              \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& column\_index\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00699}00699              \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& row\_start\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00700}00700              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00701}00701              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00702}00702       : \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}, \mbox{\hyperlink{classoomph_1_1CRMatrix}{CRMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}>>()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00703}00703     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00704}00704       \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00705}00705       \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00706}00706       \mbox{\hyperlink{classoomph_1_1CRMatrix_a73e05d0fc4fe5fb402416b18f17316b8}{build}}(\mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}}, column\_index\_, row\_start\_, n, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00707}00707     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00708}00708 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00709}00709 \textcolor{comment}{    /// Copy constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00710}\mbox{\hyperlink{classoomph_1_1CRMatrix_a27b5182b560fd414bde62baf6fe7f519}{00710}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRMatrix_a27b5182b560fd414bde62baf6fe7f519}{CRMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CRMatrix}{CRMatrix}}\& source\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00711}00711       : \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}, \mbox{\hyperlink{classoomph_1_1CRMatrix}{CRMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}>>(source\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00712}00712     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00713}00713       \textcolor{comment}{// NNz, N and M are set the the copy constructor of the SparseMatrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00714}00714       \textcolor{comment}{// called above}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00715}00715       \textcolor{comment}{// Column indices stored in C-\/style array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00716}00716       \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}} = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00717}00717 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00718}00718       \textcolor{comment}{// Assign:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00719}00719       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00720}00720       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00721}00721         \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = source\_matrix.\mbox{\hyperlink{classoomph_1_1CRMatrix_a6102f6708bca13832e05d5914397a5f1}{column\_index}}()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00722}00722       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00723}00723 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00724}00724       \textcolor{comment}{// Row start:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00725}00725       \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}} = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}} + 1];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00726}00726 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00727}00727       \textcolor{comment}{// Assign:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00728}00728       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} <= this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00729}00729       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00730}00730         \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = source\_matrix.\mbox{\hyperlink{classoomph_1_1CRMatrix_a8764aaff252eac12f2d822e62852d729}{row\_start}}()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00731}00731       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00732}00732     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00733}00733 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00734}00734 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00735}\mbox{\hyperlink{classoomph_1_1CRMatrix_a917b997c472d83f060397da610e5c061}{00735}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_a917b997c472d83f060397da610e5c061}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CRMatrix}{CRMatrix}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00736}00736 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00737}00737 \textcolor{comment}{    /// Destructor, delete any allocated memory}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00738}\mbox{\hyperlink{classoomph_1_1CRMatrix_ae0f73d8120305af7a20f6f7b64af0547}{00738}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1CRMatrix_ae0f73d8120305af7a20f6f7b64af0547}{\string~CRMatrix}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00739}00739     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00740}00740       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00741}00741       \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00742}00742       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00743}00743       \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00744}00744     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00745}00745 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00746}00746 \textcolor{comment}{    /// Access function that will be called by the read-\/only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00747}00747 \textcolor{comment}{    /// round-\/bracket operator (const)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00748}\mbox{\hyperlink{classoomph_1_1CRMatrix_afc7fe758067c8ab3fe2dba96a4258492}{00748}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1CRMatrix_afc7fe758067c8ab3fe2dba96a4258492}{get\_entry}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00749}00749 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00750}00750 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00751}00751       this-\/>\mbox{\hyperlink{classoomph_1_1Matrix_a2fed2ea1840638eb0ddaa2d4ab1da82f}{range\_check}}(i, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00752}00752 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00753}00753       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} k = \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]; k < \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + 1]; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00754}00754       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00755}00755         \textcolor{keywordflow}{if} (\textcolor{keywordtype}{unsigned}(\mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}}[k]) == j)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00756}00756         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00757}00757           \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}}[k];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00758}00758         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00759}00759       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00760}00760       \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a71a5ae159c26f93c314c839f4db6eaaf}{Zero}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00761}00761     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00762}00762 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00763}00763 \textcolor{comment}{    /// The read-\/write access function is deliberately broken}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00764}\mbox{\hyperlink{classoomph_1_1CRMatrix_a41a047afd71ed5d6e3ed91489d213f51}{00764}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1CRMatrix_a41a047afd71ed5d6e3ed91489d213f51}{entry}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00765}00765     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00766}00766       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_string =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00767}00767         \textcolor{stringliteral}{"{}Non-\/const access not provided for the CRMatrix<T> class\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00768}00768       error\_string +=}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00769}00769         \textcolor{stringliteral}{"{}It is not possible to use round-\/bracket access: M(i,j)\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00770}00770       error\_string += \textcolor{stringliteral}{"{}if M is not declared as const.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00771}00771       error\_string += \textcolor{stringliteral}{"{}The solution (albeit ugly) is to create const reference "{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00772}00772                       \textcolor{stringliteral}{"{}to the matrix\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00773}00773       error\_string += \textcolor{stringliteral}{"{} const CRMatrix<T>\& read\_M = M;\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00774}00774       error\_string += \textcolor{stringliteral}{"{}Then read\_M(i,j) is permitted\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00775}00775 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00776}00776       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00777}00777         error\_string, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00778}00778 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00779}00779       \textcolor{comment}{// Dummy return}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00780}00780       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} dummy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00781}00781       \textcolor{keywordflow}{return} dummy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00782}00782     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00783}00783 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00784}00784 \textcolor{comment}{    /// Access to C-\/style row\_start array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00785}\mbox{\hyperlink{classoomph_1_1CRMatrix_a8764aaff252eac12f2d822e62852d729}{00785}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRMatrix_a8764aaff252eac12f2d822e62852d729}{row\_start}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00786}00786     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00787}00787       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00788}00788     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00789}00789 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00790}00790 \textcolor{comment}{    /// Access to C-\/style row\_start array (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00791}\mbox{\hyperlink{classoomph_1_1CRMatrix_abfc044709ad160d0c9157f4301808438}{00791}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRMatrix_abfc044709ad160d0c9157f4301808438}{row\_start}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00792}00792 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00793}00793       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00794}00794     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00795}00795 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00796}00796 \textcolor{comment}{    /// Access to C-\/style column index array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00797}\mbox{\hyperlink{classoomph_1_1CRMatrix_a6102f6708bca13832e05d5914397a5f1}{00797}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRMatrix_a6102f6708bca13832e05d5914397a5f1}{column\_index}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00798}00798     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00799}00799       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00800}00800     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00801}00801 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00802}00802 \textcolor{comment}{    /// Access to C-\/style column index array (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00803}\mbox{\hyperlink{classoomph_1_1CRMatrix_af8720382a1f90276eaacb34649c4f4b7}{00803}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRMatrix_af8720382a1f90276eaacb34649c4f4b7}{column\_index}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00804}00804 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00805}00805       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00806}00806     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00807}00807 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00808}00808 \textcolor{comment}{    /// Output the "{}bottom right"{} entry regardless of it being}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00809}00809 \textcolor{comment}{    /// zero or not (this allows automatic detection of matrix size in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00810}00810 \textcolor{comment}{    /// e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00811}\mbox{\hyperlink{classoomph_1_1CRMatrix_abf764862746afbbe2655a41bdf726327}{00811}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_abf764862746afbbe2655a41bdf726327}{output\_bottom\_right\_zero\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00812}00812 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00813}00813       \textcolor{keywordtype}{int} last\_row\_local = this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}} -\/ 1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00814}00814       \textcolor{keywordtype}{int} last\_col = this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{M}} -\/ 1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00815}00815 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00816}00816       \textcolor{comment}{// Use this strange thingy because of the CRTP discussed above.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00817}00817       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} last\_value = this-\/>\mbox{\hyperlink{classoomph_1_1Matrix_a26f23d2b331cb7f533fd8585f1ef8d28}{operator()}}(last\_row\_local, last\_col);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00818}00818 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00819}00819       \textcolor{keywordflow}{if} (last\_value == \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00820}00820       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00821}00821         outfile << last\_row\_local << \textcolor{stringliteral}{"{} "{}} << last\_col << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00822}00822                 << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00823}00823       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00824}00824     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00825}00825 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00826}00826 \textcolor{comment}{    /// Indexed output function to print a matrix to the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00827}00827 \textcolor{comment}{    /// stream outfile as i,j,a(i,j) for a(i,j)!=0 only.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00828}\mbox{\hyperlink{classoomph_1_1CRMatrix_af34167172020d60e5fa382e4bd5d6466}{00828}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_af34167172020d60e5fa382e4bd5d6466}{sparse\_indexed\_output\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00829}00829 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00830}00830       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00831}00831       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00832}00832         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} j = \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]; j < \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + 1]; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00833}00833         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00834}00834           outfile << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}}[j] << \textcolor{stringliteral}{"{} "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}}[j]}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00835}00835                   << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00836}00836         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00837}00837       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00838}00838     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00839}00839 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00840}00840 \textcolor{comment}{    /// Wipe matrix data and set all values to 0.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00841}\mbox{\hyperlink{classoomph_1_1CRMatrix_a14f6cf02e78e14afc9a50eb73c6d517a}{00841}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_a14f6cf02e78e14afc9a50eb73c6d517a}{clean\_up\_memory}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00842}00842 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00843}00843 \textcolor{comment}{    /// Build matrix from compressed representation. Number of nonzero}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00844}00844 \textcolor{comment}{    /// entries is read off from value, so make sure the vector has been shrunk}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00845}00845 \textcolor{comment}{    /// to its correct length. This matrix forms the storage for}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00846}00846 \textcolor{comment}{    /// CRDoubleMatrices which are distributable. The argument n should be the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00847}00847 \textcolor{comment}{    /// number of local rows. The argument m is the number of columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00848}\mbox{\hyperlink{classoomph_1_1CRMatrix_a73e05d0fc4fe5fb402416b18f17316b8}{00848}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_a73e05d0fc4fe5fb402416b18f17316b8}{build}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<T>}}\& \mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00849}00849                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CRMatrix_a6102f6708bca13832e05d5914397a5f1}{column\_index}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00850}00850                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CRMatrix_a8764aaff252eac12f2d822e62852d729}{row\_start}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00851}00851                \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00852}00852                \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00853}00853 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00854}00854 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00855}00855 \textcolor{comment}{    /// Function to build matrix from pointers to arrays}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00856}00856 \textcolor{comment}{    /// which hold the row starts, column indices and non-\/zero values.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00857}00857 \textcolor{comment}{    /// The final two arguments are the number of rows and columns.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00858}00858 \textcolor{comment}{    /// Note that, as the name suggests, this function does not}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00859}00859 \textcolor{comment}{    /// make a copy of the data pointed to by the first three arguments!}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00860}\mbox{\hyperlink{classoomph_1_1CRMatrix_aee41b01876f3b8ce9011e6fe7a332da6}{00860}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_aee41b01876f3b8ce9011e6fe7a332da6}{build\_without\_copy}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00861}00861                             \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRMatrix_a6102f6708bca13832e05d5914397a5f1}{column\_index}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00862}00862                             \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRMatrix_a8764aaff252eac12f2d822e62852d729}{row\_start}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00863}00863                             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{classoomph_1_1SparseMatrix_a8b8010edcc0869283621e72a9bbc51e3}{nnz}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00864}00864                             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00865}00865                             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00866}00866 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00867}00867 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00868}00868   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00869}00869 \textcolor{comment}{    /// Column index}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00870}\mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{00870}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRMatrix_a713740a548e1b022b4153145c465a2c3}{Column\_index}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00871}00871 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00872}00872 \textcolor{comment}{    /// Start index for row}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00873}\mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{00873}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRMatrix_a6d2a0db8650e65c9278febe27feeb22e}{Row\_start}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00874}00874   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00875}00875 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00876}00876 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00877}00877   \textcolor{comment}{// Forward definition for the superlu solver}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00878}00878   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1SuperLUSolver}{SuperLUSolver}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00879}00879 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00880}00880 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00881}00881   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00882}00882 \textcolor{comment}{  /// A class for compressed row matrices. This is a distributable}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00883}00883 \textcolor{comment}{  /// object.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00884}00884 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00885}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{00885}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1Matrix}{Matrix}}<double, CRDoubleMatrix>,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00886}00886                          \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00887}00887                          \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject}{DistributableLinearAlgebraObject}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00888}00888   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00889}00889   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00890}00890 \textcolor{comment}{    /// Default constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00891}00891 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ad8914fa1a5a98f7602a1724b76eef26c}{CRDoubleMatrix}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00892}00892 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00893}00893 \textcolor{comment}{    /// Constructor: vector of values, vector of column indices,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00894}00894 \textcolor{comment}{    /// vector of row starts and number of rows and columns.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00895}00895 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ad8914fa1a5a98f7602a1724b76eef26c}{CRDoubleMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00896}00896                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{ncol}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00897}00897                    \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00898}00898                    \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00899}00899                    \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}});}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00900}00900 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00901}00901 \textcolor{comment}{    /// Constructor: just stores the distribution but does not build the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00902}00902 \textcolor{comment}{    /// matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00903}00903 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ad8914fa1a5a98f7602a1724b76eef26c}{CRDoubleMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}});}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00904}00904 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00905}00905 \textcolor{comment}{    /// Copy constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00906}00906 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ad8914fa1a5a98f7602a1724b76eef26c}{CRDoubleMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& matrix);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00907}00907 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00908}00908 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00909}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a3def3614952fcdd16a8edbc82f472490}{00909}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a3def3614952fcdd16a8edbc82f472490}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00910}00910 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00911}00911 \textcolor{comment}{    /// Destructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00912}00912 \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a27c30b4faf3d2328f3b9ce9c590f43a4}{\string~CRDoubleMatrix}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00913}00913 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00914}00914 \textcolor{comment}{    /// Access function: returns the vector Index\_of\_diagonal\_entries.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00915}00915 \textcolor{comment}{    /// The i-\/th entry of the vector contains the index of the last entry}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00916}00916 \textcolor{comment}{    /// below or on the diagonal. If there are no entries below or on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00917}00917 \textcolor{comment}{    /// diagonal then the corresponding entry is -\/1. If, however, there are}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00918}00918 \textcolor{comment}{    /// no entries in the row then the entry is irrelevant and is kept}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00919}00919 \textcolor{comment}{    /// as the initialised value; 0.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00920}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a52aed99d498f7279bcc9d975873dec50}{00920}} \textcolor{comment}{}    \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a52aed99d498f7279bcc9d975873dec50}{get\_index\_of\_diagonal\_entries}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00921}00921 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00922}00922       \textcolor{comment}{// Check to see if the vector has been set up}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00923}00923       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a6cb9860ebacf742fc7fc47d77703cc82}{Index\_of\_diagonal\_entries}}.size() == 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00924}00924       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00925}00925         \textcolor{comment}{// Make the warning}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00926}00926         \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} err\_strng =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00927}00927           \textcolor{stringliteral}{"{}The Index\_of\_diagonal\_entries vector has not been "{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00928}00928         err\_strng += \textcolor{stringliteral}{"{}set up yet. Run sort\_entries() to set this vector up."{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00929}00929 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00930}00930         \textcolor{comment}{// Throw the warning}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00931}00931         \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(err\_strng,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00932}00932                         \textcolor{stringliteral}{"{}CRDoubleMatrix::get\_index\_of\_diagonal\_entries()"{}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00933}00933                         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00934}00934       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00935}00935 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00936}00936       \textcolor{comment}{// Return the vector}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00937}00937       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a6cb9860ebacf742fc7fc47d77703cc82}{Index\_of\_diagonal\_entries}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00938}00938     \} \textcolor{comment}{// End of index\_of\_diagonal\_entries}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00939}00939 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00940}00940 \textcolor{comment}{    /// Create a struct to provide a comparison function for std::sort}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00941}\mbox{\hyperlink{structoomph_1_1CRDoubleMatrix_1_1CRDoubleMatrixComparisonHelper}{00941}} \textcolor{comment}{}    \textcolor{keyword}{struct }\mbox{\hyperlink{structoomph_1_1CRDoubleMatrix_1_1CRDoubleMatrixComparisonHelper}{CRDoubleMatrixComparisonHelper}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00942}00942     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00943}00943       \textcolor{comment}{// Define the comparison operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00944}\mbox{\hyperlink{structoomph_1_1CRDoubleMatrix_1_1CRDoubleMatrixComparisonHelper_a7ea8ef5909b1303f91e5a5c5d26c61cd}{00944}}       \textcolor{keywordtype}{bool} \mbox{\hyperlink{structoomph_1_1CRDoubleMatrix_1_1CRDoubleMatrixComparisonHelper_a7ea8ef5909b1303f91e5a5c5d26c61cd}{operator()}}(\textcolor{keyword}{const} std::pair<int, double>\& pair\_1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00945}00945                       \textcolor{keyword}{const} std::pair<int, double>\& pair\_2)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00946}00946       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00947}00947         \textcolor{comment}{// If the first argument of pair\_1 is less than the first argument of}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00948}00948         \textcolor{comment}{// pair\_2 then return TRUE otherwise return FALSE}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00949}00949         \textcolor{keywordflow}{return} (pair\_1.first < pair\_2.first);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00950}00950       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00951}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a37d76ad3814e127802b80e1e274a3f15}{00951}}     \} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a37d76ad3814e127802b80e1e274a3f15}{Comparison\_struct}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00952}00952 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00953}00953 \textcolor{comment}{    /// Runs through the column index vector and checks if the entries}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00954}00954 \textcolor{comment}{    /// follow the regular lexicographical ordering of matrix entries, i.e.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00955}00955 \textcolor{comment}{    /// it will check (at the i-\/th row of the matrix) if the entries in the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00956}00956 \textcolor{comment}{    /// column index vector associated with this row are in increasing order}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00957}00957 \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ae35fbae1702bbf75601c2a1026df103e}{entries\_are\_sorted}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& doc\_unordered\_entries = \textcolor{keyword}{false}) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00958}00958 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00959}00959 \textcolor{comment}{    /// Sorts the entries associated with each row of the matrix in the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00960}00960 \textcolor{comment}{    /// column index vector and the value vector into ascending order and sets}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00961}00961 \textcolor{comment}{    /// up the Index\_of\_diagonal\_entries vector}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00962}00962 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a2107875787d4dfa1cf007c05a041b078}{sort\_entries}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00963}00963 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00964}00964 \textcolor{comment}{    /// build method: vector of values, vector of column indices,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00965}00965 \textcolor{comment}{    /// vector of row starts and number of rows and columns.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00966}00966 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_af44bac2acd071317f96dae49cbb0d977}{build}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00967}00967                \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{ncol}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00968}00968                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00969}00969                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00970}00970                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}});}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00971}00971 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00972}00972 \textcolor{comment}{    /// rebuild the matrix -\/ assembles an empty matrix will a defined}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00973}00973 \textcolor{comment}{    /// distribution}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00974}00974 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_af44bac2acd071317f96dae49cbb0d977}{build}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}});}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00975}00975 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00976}00976 \textcolor{comment}{    /// keeps the existing distribution and just matrix that is stored}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00977}00977 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_af44bac2acd071317f96dae49cbb0d977}{build}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{ncol}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00978}00978                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00979}00979                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00980}00980                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}});}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00981}00981 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00982}00982 \textcolor{comment}{    /// keeps the existing distribution and just matrix that is stored}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00983}00983 \textcolor{comment}{    /// without copying the matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00984}00984 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafb4d7de0a87b4bda560928e6a128060}{build\_without\_copy}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{ncol}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00985}00985                             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a9482dafc0a17ebc5b7431369d8d07565}{nnz}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00986}00986                             \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00987}00987                             \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00988}00988                             \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}});}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00989}00989 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00990}00990 \textcolor{comment}{    /// The contents of the matrix are redistributed to match the new}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00991}00991 \textcolor{comment}{    /// distribution. In a non-\/MPI build this method does nothing.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00992}00992 \textcolor{comment}{    /// \(\backslash\)b NOTE 1: The current distribution and the new distribution must have}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00993}00993 \textcolor{comment}{    /// the same number of global rows.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00994}00994 \textcolor{comment}{    /// \(\backslash\)b NOTE 2: The current distribution and the new distribution must have}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00995}00995 \textcolor{comment}{    /// the same Communicator.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00996}00996 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a9ba295a04e08e3153ae06bc0556f507d}{redistribute}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution}{LinearAlgebraDistribution}}* \textcolor{keyword}{const}\& dist\_pt);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00997}00997 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00998}00998 \textcolor{comment}{    /// clear}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l00999}00999 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a70c8a67158c081e70b4d07a6b248bc7a}{clear}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01000}01000 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01001}01001 \textcolor{comment}{    /// Return the number of rows of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01002}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_abd8d231b0549540144b4739a667b1e75}{01002}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_abd8d231b0549540144b4739a667b1e75}{nrow}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01003}01003 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01004}01004       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a7569556f14fd68b28508920e89bd5eee}{DistributableLinearAlgebraObject::nrow}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01005}01005     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01006}01006 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01007}01007 \textcolor{comment}{    /// Return the number of columns of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01008}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{01008}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{ncol}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01009}01009 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01010}01010       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.ncol();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01011}01011     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01012}01012 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01013}01013 \textcolor{comment}{    /// Output the "{}bottom right"{} entry regardless of it being}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01014}01014 \textcolor{comment}{    /// zero or not (this allows automatic detection of matrix size in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01015}01015 \textcolor{comment}{    /// e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01016}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ab0887b5420752c47bfc14777006bcc1e}{01016}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ab0887b5420752c47bfc14777006bcc1e}{output\_bottom\_right\_zero\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01017}01017 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01018}01018       \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.output\_bottom\_right\_zero\_helper(outfile);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01019}01019     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01020}01020 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01021}01021 \textcolor{comment}{    /// Indexed output function to print a matrix to the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01022}01022 \textcolor{comment}{    /// stream outfile as i,j,a(i,j) for a(i,j)!=0 only.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01023}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a468055aa2e36ff270a769a74c9ac2856}{01023}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a468055aa2e36ff270a769a74c9ac2856}{sparse\_indexed\_output\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01024}01024 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01025}01025       \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.sparse\_indexed\_output\_helper(outfile);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01026}01026     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01027}01027 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01028}01028 \textcolor{comment}{    /// Indexed output function to print a matrix to a}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01029}01029 \textcolor{comment}{    /// file as i,j,a(i,j) for a(i,j)!=0 only. Specify filename.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01030}01030 \textcolor{comment}{    /// This uses acual global row numbers.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01031}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a2b5dcdc5e1b9ccea51647f02b3239e66}{01031}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a2b5dcdc5e1b9ccea51647f02b3239e66}{sparse\_indexed\_output\_with\_offset}}(\mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} filename)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01032}01032     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01033}01033       \textcolor{comment}{// Get offset}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01034}01034       \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\_row}} = \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_a2634e540a78fe1ee3f5c907aff500b58}{first\_row}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01035}01035 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01036}01036       \textcolor{comment}{// Open file}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01037}01037       std::ofstream some\_file;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01038}01038       some\_file.open(filename.c\_str());}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01039}01039       \textcolor{keywordtype}{unsigned} n = \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\_local}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01040}01040       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01041}01041       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01042}01042         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} j = \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}}()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]; j < \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}}()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + 1]; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01043}01043         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01044}01044           some\_file << \mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_ab00a3919b8634c698749f14a4d92947d}{first\_row}} + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}}()[j] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01045}01045                     << \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}}()[j] << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01046}01046         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01047}01047       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01048}01048       some\_file.close();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01049}01049     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01050}01050 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01051}01051 \textcolor{comment}{    /// Overload the round-\/bracket access operator for read-\/only access. In a}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01052}01052 \textcolor{comment}{    /// distributed matrix i refers to the local row index.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01053}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_af5b1d934bae618c92aa1089671b6130e}{01053}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_af5b1d934bae618c92aa1089671b6130e}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01054}01054                              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01055}01055 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01056}01056       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.get\_entry(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01057}01057     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01058}01058 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01059}01059 \textcolor{comment}{    /// Access to C-\/style row\_start array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01060}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{01060}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01061}01061     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01062}01062       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.row\_start();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01063}01063     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01064}01064 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01065}01065 \textcolor{comment}{    /// Access to C-\/style row\_start array (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01066}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ab288a44a89581070675d536d931eb73f}{01066}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ab288a44a89581070675d536d931eb73f}{row\_start}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01067}01067 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01068}01068       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.row\_start();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01069}01069     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01070}01070 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01071}01071 \textcolor{comment}{    /// Access to C-\/style column index array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01072}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{01072}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01073}01073     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01074}01074       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.column\_index();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01075}01075     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01076}01076 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01077}01077 \textcolor{comment}{    /// Access to C-\/style column index array (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01078}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aed3ef1fa860752c33ac3fe6ecabde136}{01078}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aed3ef1fa860752c33ac3fe6ecabde136}{column\_index}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01079}01079 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01080}01080       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.column\_index();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01081}01081     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01082}01082 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01083}01083 \textcolor{comment}{    /// Access to C-\/style value array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01084}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{01084}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01085}01085     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01086}01086       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.value();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01087}01087     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01088}01088 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01089}01089 \textcolor{comment}{    /// Access to C-\/style value array (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01090}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4a2812ca4c4a026d5e50972dab83d793}{01090}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4a2812ca4c4a026d5e50972dab83d793}{value}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01091}01091 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01092}01092       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.value();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01093}01093     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01094}01094 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01095}01095 \textcolor{comment}{    /// Return the number of nonzero entries (the local nnz)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01096}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a9482dafc0a17ebc5b7431369d8d07565}{01096}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a9482dafc0a17ebc5b7431369d8d07565}{nnz}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01097}01097 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01098}01098       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}}.nnz();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01099}01099     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01100}01100 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01101}01101 \textcolor{comment}{    /// LU decomposition using SuperLU if matrix is not distributed or}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01102}01102 \textcolor{comment}{    /// distributed onto a single processor.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01103}01103 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4b90203edbcbfec4e5e1c79f7d8d2722}{ludecompose}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01104}01104 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01105}01105 \textcolor{comment}{    /// LU back solve for given RHS}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01106}01106 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_af2c0f286f77ca44453f0da684b8f9dc7}{lubksub}}(\mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& rhs);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01107}01107 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01108}01108 \textcolor{comment}{    /// Multiply the matrix by the vector x: soln=Ax}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01109}01109 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a54b75960df52e3aebd21aaab20e9869d}{multiply}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01110}01110 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01111}01111 \textcolor{comment}{    /// Multiply the  transposed matrix by the vector x: soln=A\string^T x}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01112}01112 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a42fb274c98ccf4c2a542ca15343fcc0e}{multiply\_transpose}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01113}01113 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01114}01114 \textcolor{comment}{    /// Function to multiply this matrix by the CRDoubleMatrix matrix\_in.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01115}01115 \textcolor{comment}{    /// In a serial matrix, there are 4 methods available:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01116}01116 \textcolor{comment}{    /// Method 1: First runs through this matrix and matrix\_in to find the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01117}01117 \textcolor{comment}{    /// storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01118}01118 \textcolor{comment}{    ///           requirements for result -\/ arrays of the correct size are}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01119}01119 \textcolor{comment}{    ///           then allocated before performing the calculation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01120}01120 \textcolor{comment}{    ///           Minimises memory requirements but more costly.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01121}01121 \textcolor{comment}{    /// Method 2: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01122}01122 \textcolor{comment}{    ///           fly' using an array of maps. Faster but more memory}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01123}01123 \textcolor{comment}{    ///           intensive.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01124}01124 \textcolor{comment}{    /// Method 3: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01125}01125 \textcolor{comment}{    ///           fly' using a vector of vectors. Not particularly impressive}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01126}01126 \textcolor{comment}{    ///           on the platforms we tried...}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01127}01127 \textcolor{comment}{    /// Method 4: Trilinos Epetra Matrix Matrix multiply.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01128}01128 \textcolor{comment}{    /// Method 5: Trilinox Epetra Matrix Matrix Mulitply (ml based)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01129}01129 \textcolor{comment}{    /// If Trilinos is installed then Method 4 is employed by default, otherwise}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01130}01130 \textcolor{comment}{    /// Method 2 is employed by default.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01131}01131 \textcolor{comment}{    /// In a distributed matrix, only Trilinos Epetra Matrix Matrix multiply}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01132}01132 \textcolor{comment}{    /// is available.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01133}01133 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a54b75960df52e3aebd21aaab20e9869d}{multiply}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& matrix\_in,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01134}01134                   \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& result) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01135}01135 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01136}01136 \textcolor{comment}{    /// For every row, find the maximum absolute value of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01137}01137 \textcolor{comment}{    /// entries in this row. Set all values that are less than alpha times}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01138}01138 \textcolor{comment}{    /// this maximum to zero and return the resulting matrix in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01139}01139 \textcolor{comment}{    /// reduced\_matrix. Note: Diagonal entries are retained regardless}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01140}01140 \textcolor{comment}{    /// of their size.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01141}01141 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a3853068b7fce9e83bc817930262e9ca1}{matrix\_reduction}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& alpha, \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& reduced\_matrix);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01142}01142 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01143}01143 \textcolor{comment}{    /// Access function to Serial\_matrix\_matrix\_multiply\_method, the flag}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01144}01144 \textcolor{comment}{    /// which determines the matrix matrix multiplication method used for serial}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01145}01145 \textcolor{comment}{    /// matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01146}01146 \textcolor{comment}{    /// Method 1: First runs through this matrix and matrix\_in to find the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01147}01147 \textcolor{comment}{    /// storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01148}01148 \textcolor{comment}{    ///           requirements for result -\/ arrays of the correct size are}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01149}01149 \textcolor{comment}{    ///           then allocated before performing the calculation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01150}01150 \textcolor{comment}{    ///           Minimises memory requirements but more costly.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01151}01151 \textcolor{comment}{    /// Method 2: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01152}01152 \textcolor{comment}{    ///           fly' using an array of maps. Faster but more memory}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01153}01153 \textcolor{comment}{    ///           intensive.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01154}01154 \textcolor{comment}{    /// Method 3: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01155}01155 \textcolor{comment}{    ///           fly' using a vector of vectors. Not particularly impressive}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01156}01156 \textcolor{comment}{    ///           on the platforms we tried...}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01157}01157 \textcolor{comment}{    /// Method 4: Trilinos Epetra Matrix Matrix multiply.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01158}01158 \textcolor{comment}{    /// Method 5: Trilinos Epetra Matrix Matrix multiply (ML based).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01159}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a0b77e4dd1d6633d68264c0f41fc0e5e7}{01159}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a0b77e4dd1d6633d68264c0f41fc0e5e7}{serial\_matrix\_matrix\_multiply\_method}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01160}01160     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01161}01161       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ac8fab9824a0766b6bb6361a6b25df9ce}{Serial\_matrix\_matrix\_multiply\_method}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01162}01162     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01163}01163 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01164}01164 \textcolor{comment}{    /// Read only access function (const version) to}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01165}01165 \textcolor{comment}{    /// Serial\_matrix\_matrix\_multiply\_method, the flag}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01166}01166 \textcolor{comment}{    /// which determines the matrix matrix multiplication method used for serial}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01167}01167 \textcolor{comment}{    /// matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01168}01168 \textcolor{comment}{    /// Method 1: First runs through this matrix and matrix\_in to find the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01169}01169 \textcolor{comment}{    /// storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01170}01170 \textcolor{comment}{    ///           requirements for result -\/ arrays of the correct size are}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01171}01171 \textcolor{comment}{    ///           then allocated before performing the calculation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01172}01172 \textcolor{comment}{    ///           Minimises memory requirements but more costly.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01173}01173 \textcolor{comment}{    /// Method 2: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01174}01174 \textcolor{comment}{    ///           fly' using an array of maps. Faster but more memory}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01175}01175 \textcolor{comment}{    ///           intensive.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01176}01176 \textcolor{comment}{    /// Method 3: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01177}01177 \textcolor{comment}{    ///           fly' using a vector of vectors. Not particularly impressive}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01178}01178 \textcolor{comment}{    ///           on the platforms we tried...}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01179}01179 \textcolor{comment}{    /// Method 4: Trilinos Epetra Matrix Matrix multiply.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01180}01180 \textcolor{comment}{    /// Method 5: Trilinos Epetra Matrix Matrix multiply (ML based).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01181}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a8ca76ee3ec67406f16ef1d958fedc710}{01181}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a8ca76ee3ec67406f16ef1d958fedc710}{serial\_matrix\_matrix\_multiply\_method}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01182}01182 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01183}01183       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ac8fab9824a0766b6bb6361a6b25df9ce}{Serial\_matrix\_matrix\_multiply\_method}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01184}01184     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01185}01185 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01186}01186 \textcolor{comment}{    /// Access function to Distributed\_matrix\_matrix\_multiply\_method, the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01187}01187 \textcolor{comment}{    /// flag which determines the matrix matrix multiplication method used for}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01188}01188 \textcolor{comment}{    /// distributed matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01189}01189 \textcolor{comment}{    /// Method 1: Trilinos Epetra Matrix Matrix multiply.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01190}01190 \textcolor{comment}{    /// Method 2: Trilinos Epetra Matrix Matrix multiply (ML based).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01191}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a5c1850605f916040619230a5760dc6be}{01191}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a5c1850605f916040619230a5760dc6be}{distributed\_matrix\_matrix\_multiply\_method}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01192}01192     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01193}01193       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ab4056eff376d383c613a11082651cb}{Distributed\_matrix\_matrix\_multiply\_method}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01194}01194     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01195}01195 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01196}01196 \textcolor{comment}{    /// Read only access function (const version) to}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01197}01197 \textcolor{comment}{    /// Distributed\_matrix\_matrix\_multiply\_method, the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01198}01198 \textcolor{comment}{    /// flag which determines the matrix matrix multiplication method used for}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01199}01199 \textcolor{comment}{    /// distributed matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01200}01200 \textcolor{comment}{    /// Method 1: Trilinos Epetra Matrix Matrix multiply.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01201}01201 \textcolor{comment}{    /// Method 2: Trilinos Epetra Matrix Matrix multiply (ML based).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01202}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aae258c4df846901a39c86af1fadc262d}{01202}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aae258c4df846901a39c86af1fadc262d}{distributed\_matrix\_matrix\_multiply\_method}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01203}01203 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01204}01204       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ab4056eff376d383c613a11082651cb}{Distributed\_matrix\_matrix\_multiply\_method}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01205}01205     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01206}01206 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01207}01207 \textcolor{comment}{    /// access function to the Built flag -\/ indicates whether the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01208}01208 \textcolor{comment}{    /// has been build -\/ i.e. the distribution has been defined and the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01209}01209 \textcolor{comment}{    /// assembled.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01210}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aa0503bc64ef0ccb60cb7d7e645425a62}{01210}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aa0503bc64ef0ccb60cb7d7e645425a62}{built}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01211}01211 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01212}01212       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a63afd9976f0970a4e6ffee3755d21540}{Built}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01213}01213     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01214}01214 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01215}01215 \textcolor{comment}{    /// if this matrix is distributed then a the equivalent global matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01216}01216 \textcolor{comment}{    /// is built using new and returned. The calling method is responsible for}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01217}01217 \textcolor{comment}{    /// the destruction of the new matrix.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01218}01218 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}* \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a984602c9df0c573451f315a025820ced}{global\_matrix}}() \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01219}01219 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01220}01220 \textcolor{comment}{    /// Returns the transpose of this matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01221}01221 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a82cb428139f7c35a7c62a09fad38eecb}{get\_matrix\_transpose}}(\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}* result) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01222}01222 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01223}01223 \textcolor{comment}{    /// returns the inf-\/norm of this matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01224}01224 \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a6cd938ba5f026f1508239cef05b16cb4}{inf\_norm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01225}01225 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01226}01226 \textcolor{comment}{    /// returns a Vector of diagonal entries of this matrix.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01227}01227 \textcolor{comment}{    /// This only works with square matrices. This condition may be relaxed}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01228}01228 \textcolor{comment}{    /// in the future if need be.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01229}01229 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ad438e693468cd0ae179460eafcaab038}{diagonal\_entries}}() \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01230}01230 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01231}01231 \textcolor{comment}{    /// element-\/wise addition of this matrix with matrix\_in.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01232}01232 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a57f88253acfa87a764652c06c1bdc362}{add}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& matrix\_in,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01233}01233              \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& result\_matrix) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01234}01234 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01235}01235   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01236}01236 \textcolor{comment}{    /// Vector whose i'th entry contains the index of the last entry}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01237}01237 \textcolor{comment}{    /// below or on the diagonal of the i'th row of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01238}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a6cb9860ebacf742fc7fc47d77703cc82}{01238}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a6cb9860ebacf742fc7fc47d77703cc82}{Index\_of\_diagonal\_entries}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01239}01239 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01240}01240 \textcolor{comment}{    /// Flag to determine which matrix-\/matrix multiplication method is}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01241}01241 \textcolor{comment}{    /// used (for serial (or global) matrices)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01242}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ac8fab9824a0766b6bb6361a6b25df9ce}{01242}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_ac8fab9824a0766b6bb6361a6b25df9ce}{Serial\_matrix\_matrix\_multiply\_method}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01243}01243 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01244}01244 \textcolor{comment}{    /// Flag to determine which matrix-\/matrix multiplication method is}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01245}01245 \textcolor{comment}{    /// used (for distributed matrices)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01246}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ab4056eff376d383c613a11082651cb}{01246}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ab4056eff376d383c613a11082651cb}{Distributed\_matrix\_matrix\_multiply\_method}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01247}01247 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01248}01248 \textcolor{comment}{    /// Storage for the Matrix in CR Format}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01249}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{01249}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CRMatrix}{CRMatrix<double>}} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aefc9a269911694cdd5bde98dc536148f}{CR\_matrix}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01250}01250 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01251}01251 \textcolor{comment}{    /// Flag to indicate whether the matrix has been built -\/ i.e. the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01252}01252 \textcolor{comment}{    /// distribution has been setup AND the matrix has been assembled.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01253}\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a63afd9976f0970a4e6ffee3755d21540}{01253}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a63afd9976f0970a4e6ffee3755d21540}{Built}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01254}01254   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01255}01255 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01256}01256 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01257}01257 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01258}01258 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01259}01259 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01260}01260 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01261}01261 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01262}01262   \textcolor{comment}{// Forward definition of the DenseLU class}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01263}01263   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1DenseLU}{DenseLU}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01264}01264 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01265}01265   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01266}01266 \textcolor{comment}{  /// Class of matrices containing doubles, and stored as a}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01267}01267 \textcolor{comment}{  /// DenseMatrix<double>, but with solving functionality inherited}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01268}01268 \textcolor{comment}{  /// from the abstract DoubleMatrix class.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01269}01269 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01270}\mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{01270}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{DenseDoubleMatrix}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}}, \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix}}<double>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01271}01271   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01272}01272   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01273}01273 \textcolor{comment}{    /// Constructor, set the default linear solver}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01274}01274 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a3f4448fda5506f6f8080228c3f8c7e06}{DenseDoubleMatrix}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01275}01275 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01276}01276 \textcolor{comment}{    /// Constructor to build a square n by n matrix.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01277}01277 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a3f4448fda5506f6f8080228c3f8c7e06}{DenseDoubleMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01278}01278 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01279}01279 \textcolor{comment}{    /// Constructor to build a matrix with n rows and m columns.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01280}01280 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a3f4448fda5506f6f8080228c3f8c7e06}{DenseDoubleMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01281}01281 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01282}01282 \textcolor{comment}{    /// Constructor to build a matrix with n rows and m columns,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01283}01283 \textcolor{comment}{    /// with initial value initial\_val}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01284}01284 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a3f4448fda5506f6f8080228c3f8c7e06}{DenseDoubleMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01285}01285                       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01286}01286                       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& initial\_val);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01287}01287 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01288}01288 \textcolor{comment}{    /// Broken copy constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01289}\mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a4aa1aa09f4d228967a9c07b77aa1c189}{01289}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a4aa1aa09f4d228967a9c07b77aa1c189}{DenseDoubleMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{DenseDoubleMatrix}}\& matrix) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01290}01290 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01291}01291 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01292}\mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_af87d3c489a673adcd5bf4b8c5e7d0d3f}{01292}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_af87d3c489a673adcd5bf4b8c5e7d0d3f}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{DenseDoubleMatrix}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01293}01293 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01294}01294 \textcolor{comment}{    /// Return the number of rows of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01295}\mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_ab67993d1a41ca5ddf05c8210673723f0}{01295}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_ab67993d1a41ca5ddf05c8210673723f0}{nrow}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01296}01296 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01297}01297       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a1b425094510d833ffe91920747a0a962}{DenseMatrix<double>::nrow}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01298}01298     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01299}01299 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01300}01300 \textcolor{comment}{    /// Return the number of columns of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01301}\mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_aec36d12984999f29f5fc21feea55df1d}{01301}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_aec36d12984999f29f5fc21feea55df1d}{ncol}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01302}01302 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01303}01303       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a9937181f1cb4cfaed7aaf3b483c42456}{DenseMatrix<double>::ncol}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01304}01304     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01305}01305 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01306}01306 \textcolor{comment}{    /// Overload the const version of the round-\/bracket access operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01307}01307 \textcolor{comment}{    /// for read-\/only access.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01308}\mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_ae41c14d2d7e4b5b568a9b371e7e53fbd}{01308}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_ae41c14d2d7e4b5b568a9b371e7e53fbd}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01309}01309                              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01310}01310 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01311}01311       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a0b03682b4c7d8f820599bd2681a01ee0}{DenseMatrix<double>::get\_entry}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01312}01312     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01313}01313 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01314}01314 \textcolor{comment}{    /// Overload the non-\/const version of the round-\/bracket access}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01315}01315 \textcolor{comment}{    /// operator for read-\/write access}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01316}\mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a19fac4a1c8b4513668df17b2977db1c0}{01316}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a19fac4a1c8b4513668df17b2977db1c0}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01317}01317     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01318}01318       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a727aed44cb4b695daa4120178517c03d}{DenseMatrix<double>::entry}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01319}01319     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01320}01320 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01321}01321 \textcolor{comment}{    /// Destructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01322}01322 \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a5b68ac6eb31db9b0221d0dd724bcc3a6}{\string~DenseDoubleMatrix}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01323}01323 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01324}01324 \textcolor{comment}{    /// LU decomposition using DenseLU (default linea solver)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01325}01325 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a741d54dbea2a16e6e3f10bbd2d9d726e}{ludecompose}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01326}01326 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01327}01327 \textcolor{comment}{    /// LU backsubstitution}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01328}01328 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a52515653ab5b792388258ca04e9dcbcc}{lubksub}}(\mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& rhs);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01329}01329 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01330}01330 \textcolor{comment}{    /// LU backsubstitution}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01331}01331 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a52515653ab5b792388258ca04e9dcbcc}{lubksub}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& rhs);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01332}01332 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01333}01333 \textcolor{comment}{    /// Determine eigenvalues and eigenvectors, using}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01334}01334 \textcolor{comment}{    /// Jacobi rotations. Only for symmetric matrices. Nothing gets overwritten!}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01335}01335 \textcolor{comment}{    /// -\/ \(\backslash\)c eigen\_vect(i,j) = j-\/th component of i-\/th eigenvector.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01336}01336 \textcolor{comment}{    /// -\/ \(\backslash\)c eigen\_val(i) is the i-\/th eigenvalue; same ordering as in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01337}01337 \textcolor{comment}{    /// eigenvectors}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01338}01338 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_aef56ba05f1ba190c3461cf27d57abd9d}{eigenvalues\_by\_jacobi}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& eigen\_val,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01339}01339                                \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& eigen\_vect) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01340}01340 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01341}01341 \textcolor{comment}{    /// Multiply the matrix by the vector x: soln=Ax}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01342}01342 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_ab575dfefa0bdd8f495453baa5575a4a0}{multiply}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01343}01343 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01344}01344 \textcolor{comment}{    /// Multiply the  transposed matrix by the vector x: soln=A\string^T x}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01345}01345 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a7cc35997d87b4ee7b77fcaaf85eeeaec}{multiply\_transpose}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01346}01346 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01347}01347 \textcolor{comment}{    /// For every row, find the maximum absolute value of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01348}01348 \textcolor{comment}{    /// entries in this row. Set all values that are less than alpha times}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01349}01349 \textcolor{comment}{    /// this maximum to zero and return the resulting matrix in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01350}01350 \textcolor{comment}{    /// reduced\_matrix. Note: Diagonal entries are retained regardless}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01351}01351 \textcolor{comment}{    /// of their size.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01352}01352 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_a64b81a329f8e9204e50b75ea367a77d4}{matrix\_reduction}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& alpha,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01353}01353                           \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{DenseDoubleMatrix}}\& reduced\_matrix);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01354}01354 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01355}01355 \textcolor{comment}{    /// Function to multiply this matrix by a DenseDoubleMatrix matrix\_in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01356}01356 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix_ab575dfefa0bdd8f495453baa5575a4a0}{multiply}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{DenseDoubleMatrix}}\& matrix\_in,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01357}01357                   \mbox{\hyperlink{classoomph_1_1DenseDoubleMatrix}{DenseDoubleMatrix}}\& result);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01358}01358   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01359}01359 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01360}01360 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01361}01361 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01362}01362 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01363}01363 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01364}01364 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01365}01365   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01366}01366 \textcolor{comment}{  /// A Rank 3 Tensor class}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01367}01367 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01368}01368   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01369}\mbox{\hyperlink{classoomph_1_1RankThreeTensor}{01369}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1RankThreeTensor}{RankThreeTensor}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01370}01370   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01371}01371   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01372}01372 \textcolor{comment}{    /// Private internal representation  as pointer to data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01373}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{01373}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01374}01374 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01375}01375 \textcolor{comment}{    /// 1st Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01376}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{01376}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01377}01377 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01378}01378 \textcolor{comment}{    /// 2nd Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01379}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{01379}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01380}01380 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01381}01381 \textcolor{comment}{    /// 3rd Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01382}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{01382}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01383}01383 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01384}01384 \textcolor{comment}{    /// Range check to catch when an index is out of bounds, if so, it}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01385}01385 \textcolor{comment}{    /// issues a warning message and dies by throwing an \(\backslash\)c OomphLibError}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01386}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7a54cd8aaf72f4876314ed23aa9b813e}{01386}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7a54cd8aaf72f4876314ed23aa9b813e}{range\_check}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01387}01387                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01388}01388                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01389}01389 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01390}01390       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} >= \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01391}01391       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01392}01392         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01393}01393         error\_message << \textcolor{stringliteral}{"{}Range Error: i="{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01394}01394                       << \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01395}01395 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01396}01396         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01397}01397                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01398}01398                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01399}01399       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01400}01400       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j >= \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01401}01401       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01402}01402         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01403}01403         error\_message << \textcolor{stringliteral}{"{}Range Error: j="{}} << j << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01404}01404                       << \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01405}01405 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01406}01406         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01407}01407                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01408}01408                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01409}01409       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01410}01410       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (k >= \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01411}01411       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01412}01412         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01413}01413         error\_message << \textcolor{stringliteral}{"{}Range Error: k="{}} << k << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01414}01414                       << \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01415}01415 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01416}01416         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01417}01417                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01418}01418                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01419}01419       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01420}01420     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01421}01421 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01422}01422 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01423}01423   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01424}01424 \textcolor{comment}{    /// Empty constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01425}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a8f2c4cf96f9e6c1c66e6958fd52b0b76}{01425}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a8f2c4cf96f9e6c1c66e6958fd52b0b76}{RankThreeTensor}}() : \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}}(0), \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}}(0), \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}}(0), \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}(0) \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01426}01426 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01427}01427 \textcolor{comment}{    /// Copy constructor: Deep copy}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01428}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7de68d66eec11565e0ffb55494fd66c6}{01428}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7de68d66eec11565e0ffb55494fd66c6}{RankThreeTensor}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1RankThreeTensor}{RankThreeTensor}}\& source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01429}01429     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01430}01430       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01431}01431       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a6efa48062b66970a12ac5bc712d8704b}{nindex1}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01432}01432       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7934dad6cda9e9716c086cd15ee05dad}{nindex2}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01433}01433       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ac8c7eb798506698c0e231557af26310d}{nindex3}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01434}01434       \textcolor{comment}{// Assign space for the data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01435}01435       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01436}01436       \textcolor{comment}{// Copy the data across from the other matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01437}01437       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01438}01438       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01439}01439         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01440}01440         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01441}01441           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01442}01442           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01443}01443             \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} * (\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k] = source\_tensor(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01444}01444           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01445}01445         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01446}01446       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01447}01447     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01448}01448 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01449}01449 \textcolor{comment}{    /// Copy assignement}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01450}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a4181eb5fde8f85edf83fc8ad2692ab3d}{01450}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankThreeTensor}{RankThreeTensor}}\& \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a4181eb5fde8f85edf83fc8ad2692ab3d}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1RankThreeTensor}{RankThreeTensor}}\& source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01451}01451     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01452}01452       \textcolor{comment}{// Don't create a new matrix if the assignement is the identity}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01453}01453       \textcolor{keywordflow}{if} (\textcolor{keyword}{this} != \&source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01454}01454       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01455}01455         \textcolor{comment}{// Check row and column length}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01456}01456         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a6efa48062b66970a12ac5bc712d8704b}{nindex1}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01457}01457         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} m = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7934dad6cda9e9716c086cd15ee05dad}{nindex2}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01458}01458         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} p = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ac8c7eb798506698c0e231557af26310d}{nindex3}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01459}01459         \textcolor{comment}{// Resie the tensor to be the same size as the old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01460}01460         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} != n) || (\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} != m) || (\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} != p))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01461}01461         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01462}01462           \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ab09490399cf8db93b08e07f893e8724d}{resize}}(n, m, p);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01463}01463         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01464}01464 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01465}01465         \textcolor{comment}{// Copy entries across from the other matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01466}01466         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01467}01467         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01468}01468           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01469}01469           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01470}01470             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01471}01471             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01472}01472               (*this)(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k) = source\_tensor(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01473}01473             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01474}01474           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01475}01475         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01476}01476       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01477}01477       \textcolor{comment}{// Return reference to object itself (i.e. de-\/reference this pointer)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01478}01478       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01479}01479     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01480}01480 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01481}01481 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01482}01482 \textcolor{comment}{    /// One parameter constructor produces a cubic nxnxn tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01483}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_af3f6a2cc2032025608f5c8564c6da651}{01483}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankThreeTensor_af3f6a2cc2032025608f5c8564c6da651}{RankThreeTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01484}01484     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01485}01485       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01486}01486       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01487}01487       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01488}01488       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01489}01489       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01490}01490       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01491}01491       \textcolor{comment}{// Initialise to zero if required}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01492}01492 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01493}01493       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ad63ed4eef146b20783c1df45584f0847}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01494}01494 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01495}01495     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01496}01496 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01497}01497 \textcolor{comment}{    /// Three parameter constructor, general non-\/square tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01498}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae876d81ad44aafcd195aeddfdfa913f7}{01498}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae876d81ad44aafcd195aeddfdfa913f7}{RankThreeTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01499}01499                     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01500}01500                     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01501}01501     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01502}01502       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01503}01503       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01504}01504       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01505}01505       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01506}01506       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01507}01507       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01508}01508       \textcolor{comment}{// Initialise to zero if required}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01509}01509 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01510}01510       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ad63ed4eef146b20783c1df45584f0847}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01511}01511 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01512}01512     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01513}01513 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01514}01514 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01515}01515 \textcolor{comment}{    /// Three parameter constructor, general non-\/square tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01516}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a3b3599070a42f679597bcd8a263aed25}{01516}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a3b3599070a42f679597bcd8a263aed25}{RankThreeTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01517}01517                     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01518}01518                     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01519}01519                     \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_val)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01520}01520     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01521}01521       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01522}01522       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01523}01523       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01524}01524       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01525}01525       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01526}01526       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01527}01527       \textcolor{comment}{// Initialise to the initial value}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01528}01528       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ad63ed4eef146b20783c1df45584f0847}{initialise}}(initial\_val);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01529}01529     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01530}01530 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01531}01531 \textcolor{comment}{    /// Destructor: delete the pointers}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01532}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a19b8797a792309e78106dbb2d90f83a7}{01532}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a19b8797a792309e78106dbb2d90f83a7}{\string~RankThreeTensor}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01533}01533     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01534}01534       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01535}01535       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01536}01536     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01537}01537 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01538}01538 \textcolor{comment}{    /// Resize to a square nxnxn tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01539}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ab09490399cf8db93b08e07f893e8724d}{01539}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ab09490399cf8db93b08e07f893e8724d}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01540}01540     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01541}01541       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ab09490399cf8db93b08e07f893e8724d}{resize}}(n, n, n);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01542}01542     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01543}01543 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01544}01544 \textcolor{comment}{    /// Resize to a general tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01545}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ac192a93e6971712de84c705895443544}{01545}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ac192a93e6971712de84c705895443544}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01546}01546                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01547}01547                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01548}01548     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01549}01549       \textcolor{comment}{// If the sizes have not changed do nothing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01550}01550       \textcolor{keywordflow}{if} ((n\_index1 == \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}}) \&\& (n\_index2 == \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}}) \&\& (n\_index3 == \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01551}01551       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01552}01552         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01553}01553       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01554}01554       \textcolor{comment}{// Store old sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01555}01555       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_old = \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}}, m\_old = \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}}, p\_old = \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01556}01556       \textcolor{comment}{// Reassign the sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01557}01557       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01558}01558       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01559}01559       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01560}01560       \textcolor{comment}{// Store triple pointer to old matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01561}01561       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* temp\_tensor = \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01562}01562       \textcolor{comment}{// Re-\/create Tensordata in new size}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01563}01563       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01564}01564 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01565}01565       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ad63ed4eef146b20783c1df45584f0847}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01566}01566 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01567}01567       \textcolor{comment}{// Transfer values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01568}01568       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_copy, m\_copy, p\_copy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01569}01569       n\_copy = std::min(n\_old, n\_index1);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01570}01570       m\_copy = std::min(m\_old, n\_index2);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01571}01571       p\_copy = std::min(p\_old, n\_index3);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01572}01572       \textcolor{comment}{// If matrix has values, transfer them to new matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01573}01573       \textcolor{comment}{// Loop over rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01574}01574       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_copy; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01575}01575       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01576}01576         \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01577}01577         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < m\_copy; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01578}01578         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01579}01579           \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01580}01580           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < p\_copy; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01581}01581           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01582}01582             \textcolor{comment}{// Transfer values from temp\_tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01583}01583             \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} * j + k] =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01584}01584               temp\_tensor[m\_old * p\_old * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + p\_old * j + k];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01585}01585           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01586}01586         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01587}01587       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01588}01588       \textcolor{comment}{// Now kill storage for old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01589}01589       \textcolor{keyword}{delete}[] temp\_tensor;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01590}01590     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01591}01591 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01592}01592 \textcolor{comment}{    /// Resize to a general tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01593}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2b7967ca1fb782b26d9b2d9f0d760d16}{01593}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2b7967ca1fb782b26d9b2d9f0d760d16}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01594}01594                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01595}01595                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01596}01596                 \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_value)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01597}01597     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01598}01598       \textcolor{comment}{// If the sizes have not changed do nothing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01599}01599       \textcolor{keywordflow}{if} ((n\_index1 == \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}}) \&\& (n\_index2 == \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}}) \&\& (n\_index3 == \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01600}01600       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01601}01601         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01602}01602       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01603}01603       \textcolor{comment}{// Store old sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01604}01604       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_old = \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}}, m\_old = \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}}, p\_old = \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01605}01605       \textcolor{comment}{// Reassign the sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01606}01606       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01607}01607       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01608}01608       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01609}01609       \textcolor{comment}{// Store triple pointer to old matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01610}01610       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* temp\_tensor = \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01611}01611       \textcolor{comment}{// Re-\/create Tensordata in new size}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01612}01612       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01613}01613       \textcolor{comment}{// Initialise the newly allocated storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01614}01614       \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ad63ed4eef146b20783c1df45584f0847}{initialise}}(initial\_value);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01615}01615 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01616}01616       \textcolor{comment}{// Transfer values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01617}01617       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_copy, m\_copy, p\_copy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01618}01618       n\_copy = std::min(n\_old, n\_index1);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01619}01619       m\_copy = std::min(m\_old, n\_index2);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01620}01620       p\_copy = std::min(p\_old, n\_index3);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01621}01621       \textcolor{comment}{// If matrix has values, transfer them to new matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01622}01622       \textcolor{comment}{// Loop over rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01623}01623       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_copy; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01624}01624       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01625}01625         \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01626}01626         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < m\_copy; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01627}01627         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01628}01628           \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01629}01629           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < p\_copy; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01630}01630           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01631}01631             \textcolor{comment}{// Transfer values from temp\_tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01632}01632             \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} * j + k] =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01633}01633               temp\_tensor[m\_old * p\_old * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + p\_old * j + k];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01634}01634           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01635}01635         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01636}01636       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01637}01637       \textcolor{comment}{// Now kill storage for old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01638}01638       \textcolor{keyword}{delete}[] temp\_tensor;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01639}01639     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01640}01640 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01641}01641 \textcolor{comment}{    /// Initialise all values in the tensor to val}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01642}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ad63ed4eef146b20783c1df45584f0847}{01642}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ad63ed4eef146b20783c1df45584f0847}{initialise}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& val)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01643}01643     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01644}01644       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < (\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}}); ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01645}01645       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01646}01646         \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = val;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01647}01647       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01648}01648     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01649}01649 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01650}01650 \textcolor{comment}{    /// Return the range of index 1 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01651}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a6efa48062b66970a12ac5bc712d8704b}{01651}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a6efa48062b66970a12ac5bc712d8704b}{nindex1}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01652}01652 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01653}01653       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a2d5b895e2cb3543b16a64159041d52c3}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01654}01654     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01655}01655 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01656}01656 \textcolor{comment}{    /// Return the range of index 2 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01657}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7934dad6cda9e9716c086cd15ee05dad}{01657}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7934dad6cda9e9716c086cd15ee05dad}{nindex2}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01658}01658 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01659}01659       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01660}01660     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01661}01661 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01662}01662 \textcolor{comment}{    /// Return the range of index 3 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01663}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ac8c7eb798506698c0e231557af26310d}{01663}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ac8c7eb798506698c0e231557af26310d}{nindex3}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01664}01664 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01665}01665       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01666}01666     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01667}01667 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01668}01668 \textcolor{comment}{    /// Overload the round brackets to give access as a(i,j,k)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01669}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_aa0be6188c1d32c6843381ebf7ebf47dd}{01669}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aa0be6188c1d32c6843381ebf7ebf47dd}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01670}01670                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01671}01671                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01672}01672     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01673}01673 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01674}01674       this-\/>\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7a54cd8aaf72f4876314ed23aa9b813e}{range\_check}}(i, j, k);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01675}01675 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01676}01676       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} * (\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01677}01677     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01678}01678 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01679}01679 \textcolor{comment}{    /// Overload a const version for read-\/only access as a(i,j,k)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01680}\mbox{\hyperlink{classoomph_1_1RankThreeTensor_aa97b7b4cb4b619c24ef9abebcd0d892c}{01680}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aa97b7b4cb4b619c24ef9abebcd0d892c}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01681}01681                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01682}01682                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01683}01683 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01684}01684 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01685}01685       this-\/>\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a7a54cd8aaf72f4876314ed23aa9b813e}{range\_check}}(i, j, k);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01686}01686 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01687}01687       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankThreeTensor_aef2671e89361c2260c7d3936fc8860ec}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankThreeTensor_ae93ba8b2baf4f92af533ae66bfcbe570}{P}} * (\mbox{\hyperlink{classoomph_1_1RankThreeTensor_a9e28da9e2862c47f2f5562742202748d}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01688}01688     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01689}01689   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01690}01690 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01691}01691 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01692}01692 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01693}01693 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01694}01694 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01695}01695 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01696}01696   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01697}01697 \textcolor{comment}{  /// A Rank 4 Tensor class}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01698}01698 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01699}01699   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01700}\mbox{\hyperlink{classoomph_1_1RankFourTensor}{01700}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1RankFourTensor}{RankFourTensor}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01701}01701   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01702}01702   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01703}01703 \textcolor{comment}{    /// Private internal representation  as pointer to data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01704}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{01704}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01705}01705 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01706}01706 \textcolor{comment}{    /// 1st Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01707}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{01707}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01708}01708 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01709}01709 \textcolor{comment}{    /// 2nd Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01710}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{01710}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01711}01711 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01712}01712 \textcolor{comment}{    /// 3rd Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01713}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{01713}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01714}01714 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01715}01715 \textcolor{comment}{    /// 4th Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01716}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{01716}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01717}01717 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01718}01718 \textcolor{comment}{    /// Range check to catch when an index is out of bounds, if so, it}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01719}01719 \textcolor{comment}{    /// issues a warning message and dies by throwing an \(\backslash\)c OomphLibError}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01720}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad9e629184b51ee7cb8074ce6d3641f36}{01720}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad9e629184b51ee7cb8074ce6d3641f36}{range\_check}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01721}01721                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01722}01722                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01723}01723                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& l)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01724}01724 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01725}01725       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} >= \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01726}01726       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01727}01727         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01728}01728         error\_message << \textcolor{stringliteral}{"{}Range Error: i="{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01729}01729                       << \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01730}01730 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01731}01731         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01732}01732                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01733}01733                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01734}01734       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01735}01735       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j >= \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01736}01736       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01737}01737         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01738}01738         error\_message << \textcolor{stringliteral}{"{}Range Error: j="{}} << j << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01739}01739                       << \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01740}01740 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01741}01741         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01742}01742                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01743}01743                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01744}01744       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01745}01745       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (k >= \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01746}01746       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01747}01747         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01748}01748         error\_message << \textcolor{stringliteral}{"{}Range Error: k="{}} << k << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01749}01749                       << \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01750}01750 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01751}01751         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01752}01752                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01753}01753                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01754}01754       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01755}01755       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (l >= \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01756}01756       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01757}01757         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01758}01758         error\_message << \textcolor{stringliteral}{"{}Range Error: l="{}} << l << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01759}01759                       << \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01760}01760 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01761}01761         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01762}01762                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01763}01763                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01764}01764       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01765}01765     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01766}01766 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01767}01767   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01768}01768 \textcolor{comment}{    /// Empty constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01769}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a1fc311bc9c6ae0d7e2845b743b963e80}{01769}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFourTensor_a1fc311bc9c6ae0d7e2845b743b963e80}{RankFourTensor}}() : \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}(0), \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}}(0), \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}}(0), \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}}(0), \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}(0) \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01770}01770 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01771}01771 \textcolor{comment}{    /// Copy constructor: Deep copy}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01772}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae1d00ed47ac1c4ce7dd1b8360affeecc}{01772}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae1d00ed47ac1c4ce7dd1b8360affeecc}{RankFourTensor}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1RankFourTensor}{RankFourTensor}}\& source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01773}01773     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01774}01774       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01775}01775       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFourTensor_a96a373f0573d4fc37a23a6eaee4c3fec}{nindex1}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01776}01776       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFourTensor_a78ffffb217f84535529c6c9cb5d1b91f}{nindex2}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01777}01777       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFourTensor_ab9d4f33cb872d48050eb05c879f19011}{nindex3}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01778}01778       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFourTensor_a5bf51e7091f081ff09d2ef710131b9e0}{nindex4}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01779}01779 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01780}01780       \textcolor{comment}{// Assign space for the data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01781}01781       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01782}01782 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01783}01783       \textcolor{comment}{// Copy the data across from the other matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01784}01784       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01785}01785       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01786}01786         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01787}01787         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01788}01788           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}}; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01789}01789           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01790}01790             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}; l++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01791}01791             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01792}01792               \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k) + l] =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01793}01793                 source\_tensor(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k, l);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01794}01794             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01795}01795           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01796}01796         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01797}01797       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01798}01798     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01799}01799 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01800}01800 \textcolor{comment}{    /// Copy assignement}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01801}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a69427ddc6cd996569ca9c5b3034e69fd}{01801}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFourTensor}{RankFourTensor}}\& \mbox{\hyperlink{classoomph_1_1RankFourTensor_a69427ddc6cd996569ca9c5b3034e69fd}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1RankFourTensor}{RankFourTensor}}\& source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01802}01802     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01803}01803       \textcolor{comment}{// Don't create a new matrix if the assignement is the identity}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01804}01804       \textcolor{keywordflow}{if} (\textcolor{keyword}{this} != \&source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01805}01805       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01806}01806         \textcolor{comment}{// Check row and column length}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01807}01807         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFourTensor_a96a373f0573d4fc37a23a6eaee4c3fec}{nindex1}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01808}01808         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} m = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFourTensor_a78ffffb217f84535529c6c9cb5d1b91f}{nindex2}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01809}01809         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} p = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFourTensor_ab9d4f33cb872d48050eb05c879f19011}{nindex3}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01810}01810         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} q = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFourTensor_a5bf51e7091f081ff09d2ef710131b9e0}{nindex4}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01811}01811         \textcolor{comment}{// Resize the tensor to be the same size as the old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01812}01812         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} != n) || (\mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} != m) || (\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} != p) || (\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} != q))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01813}01813         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01814}01814           \mbox{\hyperlink{classoomph_1_1RankFourTensor_af70b319deb21a179326460b41def5aff}{resize}}(n, m, p, q);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01815}01815         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01816}01816 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01817}01817         \textcolor{comment}{// Copy entries across from the other matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01818}01818         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01819}01819         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01820}01820           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01821}01821           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01822}01822             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}}; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01823}01823             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01824}01824               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} l = 0; l < \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}; l++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01825}01825               \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01826}01826                 (*this)(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k, l) = source\_tensor(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k, l);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01827}01827               \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01828}01828             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01829}01829           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01830}01830         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01831}01831       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01832}01832       \textcolor{comment}{// Return reference to object itself (i.e. de-\/reference this pointer)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01833}01833       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01834}01834     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01835}01835 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01836}01836 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01837}01837 \textcolor{comment}{    /// One parameter constructor produces a  nxnxnxn tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01838}\mbox{\hyperlink{classoomph_1_1RankFourTensor_abc9c7f196e6a8521ee01a8a656700cc4}{01838}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFourTensor_abc9c7f196e6a8521ee01a8a656700cc4}{RankFourTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01839}01839     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01840}01840       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01841}01841       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01842}01842       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01843}01843       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01844}01844       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01845}01845       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01846}01846       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01847}01847       \textcolor{comment}{// Initialise to zero if required}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01848}01848 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01849}01849       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae75018549ea237c4608b41ecc62eef65}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01850}01850 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01851}01851     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01852}01852 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01853}01853 \textcolor{comment}{    /// Four parameter constructor, general non-\/square tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01854}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a24e7326e6ca5143f47d221ad7f45e7a6}{01854}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFourTensor_a24e7326e6ca5143f47d221ad7f45e7a6}{RankFourTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01855}01855                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01856}01856                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01857}01857                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index4)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01858}01858     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01859}01859       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01860}01860       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01861}01861       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01862}01862       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01863}01863       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} = n\_index4;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01864}01864       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01865}01865       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01866}01866       \textcolor{comment}{// Initialise to zero if required}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01867}01867 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01868}01868       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae75018549ea237c4608b41ecc62eef65}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01869}01869 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01870}01870     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01871}01871 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01872}01872 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01873}01873 \textcolor{comment}{    /// Four parameter constructor, general non-\/square tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01874}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ac23f09c14842914d318c594a2dd0d424}{01874}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFourTensor_ac23f09c14842914d318c594a2dd0d424}{RankFourTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01875}01875                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01876}01876                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01877}01877                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index4,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01878}01878                    \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_val)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01879}01879     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01880}01880       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01881}01881       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01882}01882       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01883}01883       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01884}01884       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} = n\_index4;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01885}01885       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01886}01886       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01887}01887       \textcolor{comment}{// Initialise to the initial value}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01888}01888       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae75018549ea237c4608b41ecc62eef65}{initialise}}(initial\_val);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01889}01889     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01890}01890 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01891}01891 \textcolor{comment}{    /// Destructor: delete the pointers}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01892}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a4165ed9adc8b0c0702a3a6d883cd9844}{01892}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4165ed9adc8b0c0702a3a6d883cd9844}{\string~RankFourTensor}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01893}01893     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01894}01894       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01895}01895       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01896}01896     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01897}01897 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01898}01898 \textcolor{comment}{    /// Resize to a square nxnxnxn tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01899}\mbox{\hyperlink{classoomph_1_1RankFourTensor_af70b319deb21a179326460b41def5aff}{01899}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFourTensor_af70b319deb21a179326460b41def5aff}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01900}01900     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01901}01901       \mbox{\hyperlink{classoomph_1_1RankFourTensor_af70b319deb21a179326460b41def5aff}{resize}}(n, n, n, n);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01902}01902     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01903}01903 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01904}01904 \textcolor{comment}{    /// Resize to a general tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01905}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a57fbad42c64d5e452851730e64a2dfcf}{01905}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a57fbad42c64d5e452851730e64a2dfcf}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01906}01906                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01907}01907                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01908}01908                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index4)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01909}01909     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01910}01910       \textcolor{comment}{// If the sizes have not changed do nothing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01911}01911       \textcolor{keywordflow}{if} ((n\_index1 == \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}}) \&\& (n\_index2 == \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}}) \&\& (n\_index3 == \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}}) \&\&}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01912}01912           (n\_index4 == \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01913}01913       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01914}01914         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01915}01915       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01916}01916       \textcolor{comment}{// Store old sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01917}01917       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_old = \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}}, m\_old = \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}}, p\_old = \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}}, q\_old = \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01918}01918       \textcolor{comment}{// Reassign the sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01919}01919       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01920}01920       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01921}01921       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01922}01922       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} = n\_index4;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01923}01923       \textcolor{comment}{// Store pointer to old matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01924}01924       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* temp\_tensor = \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01925}01925       \textcolor{comment}{// Re-\/create Tensordata in new size}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01926}01926       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01927}01927 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01928}01928       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae75018549ea237c4608b41ecc62eef65}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01929}01929 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01930}01930       \textcolor{comment}{// Transfer values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01931}01931       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_copy, m\_copy, p\_copy, q\_copy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01932}01932       n\_copy = std::min(n\_old, n\_index1);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01933}01933       m\_copy = std::min(m\_old, n\_index2);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01934}01934       p\_copy = std::min(p\_old, n\_index3);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01935}01935       q\_copy = std::min(q\_old, n\_index4);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01936}01936       \textcolor{comment}{// If matrix has values, transfer them to new matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01937}01937       \textcolor{comment}{// Loop over rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01938}01938       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_copy; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01939}01939       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01940}01940         \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01941}01941         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < m\_copy; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01942}01942         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01943}01943           \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01944}01944           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < p\_copy; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01945}01945           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01946}01946             \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01947}01947             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} l = 0; l < q\_copy; l++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01948}01948             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01949}01949               \textcolor{comment}{// Transfer values from temp\_tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01950}01950               \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * j + k) + l] =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01951}01951                 temp\_tensor[q\_old * (m\_old * p\_old * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + p\_old * j + k) + l];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01952}01952             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01953}01953           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01954}01954         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01955}01955       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01956}01956       \textcolor{comment}{// Now kill storage for old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01957}01957       \textcolor{keyword}{delete}[] temp\_tensor;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01958}01958     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01959}01959 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01960}01960 \textcolor{comment}{    /// Resize to a general tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01961}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a26e0b2c9eb50816ec3f30e6bfeb39293}{01961}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a26e0b2c9eb50816ec3f30e6bfeb39293}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01962}01962                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01963}01963                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01964}01964                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index4,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01965}01965                 \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_value)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01966}01966     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01967}01967       \textcolor{comment}{// If the sizes have not changed do nothing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01968}01968       \textcolor{keywordflow}{if} ((n\_index1 == \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}}) \&\& (n\_index2 == \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}}) \&\& (n\_index3 == \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}}) \&\&}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01969}01969           (n\_index4 == \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01970}01970       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01971}01971         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01972}01972       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01973}01973       \textcolor{comment}{// Store old sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01974}01974       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_old = \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}}, m\_old = \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}}, p\_old = \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}}, q\_old = \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01975}01975       \textcolor{comment}{// Reassign the sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01976}01976       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01977}01977       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01978}01978       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01979}01979       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} = n\_index4;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01980}01980       \textcolor{comment}{// Store triple pointer to old matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01981}01981       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* temp\_tensor = \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01982}01982       \textcolor{comment}{// Re-\/create Tensordata in new size}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01983}01983       \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01984}01984       \textcolor{comment}{// Initialise the newly allocated storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01985}01985       \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae75018549ea237c4608b41ecc62eef65}{initialise}}(initial\_value);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01986}01986 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01987}01987       \textcolor{comment}{// Transfer values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01988}01988       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_copy, m\_copy, p\_copy, q\_copy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01989}01989       n\_copy = std::min(n\_old, n\_index1);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01990}01990       m\_copy = std::min(m\_old, n\_index2);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01991}01991       p\_copy = std::min(p\_old, n\_index3);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01992}01992       q\_copy = std::min(q\_old, n\_index4);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01993}01993       \textcolor{comment}{// If matrix has values, transfer them to new matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01994}01994       \textcolor{comment}{// Loop over rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01995}01995       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_copy; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01996}01996       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01997}01997         \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01998}01998         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < m\_copy; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l01999}01999         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02000}02000           \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02001}02001           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < p\_copy; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02002}02002           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02003}02003             \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02004}02004             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} l = 0; l < q\_copy; l++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02005}02005             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02006}02006               \textcolor{comment}{// Transfer values from temp\_tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02007}02007               \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * j + k) + l] =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02008}02008                 temp\_tensor[q\_old * (m\_old * p\_old * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + p\_old * j + k) + l];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02009}02009             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02010}02010           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02011}02011         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02012}02012       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02013}02013       \textcolor{comment}{// Now kill storage for old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02014}02014       \textcolor{keyword}{delete}[] temp\_tensor;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02015}02015     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02016}02016 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02017}02017 \textcolor{comment}{    /// Initialise all values in the tensor to val}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02018}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae75018549ea237c4608b41ecc62eef65}{02018}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae75018549ea237c4608b41ecc62eef65}{initialise}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& val)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02019}02019     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02020}02020       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < (\mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}}); ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02021}02021       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02022}02022         \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = val;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02023}02023       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02024}02024     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02025}02025 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02026}02026 \textcolor{comment}{    /// Return the range of index 1 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02027}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a96a373f0573d4fc37a23a6eaee4c3fec}{02027}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a96a373f0573d4fc37a23a6eaee4c3fec}{nindex1}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02028}02028 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02029}02029       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a122b61b1b83d3a8df6976e735b89244c}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02030}02030     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02031}02031 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02032}02032 \textcolor{comment}{    /// Return the range of index 2 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02033}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a78ffffb217f84535529c6c9cb5d1b91f}{02033}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a78ffffb217f84535529c6c9cb5d1b91f}{nindex2}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02034}02034 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02035}02035       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02036}02036     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02037}02037 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02038}02038 \textcolor{comment}{    /// Return the range of index 3 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02039}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ab9d4f33cb872d48050eb05c879f19011}{02039}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFourTensor_ab9d4f33cb872d48050eb05c879f19011}{nindex3}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02040}02040 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02041}02041       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02042}02042     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02043}02043 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02044}02044 \textcolor{comment}{    /// Return the range of index 4 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02045}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a5bf51e7091f081ff09d2ef710131b9e0}{02045}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a5bf51e7091f081ff09d2ef710131b9e0}{nindex4}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02046}02046 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02047}02047       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02048}02048     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02049}02049 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02050}02050 \textcolor{comment}{    /// Overload the round brackets to give access as a(i,j,k,l)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02051}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae17bed648f6da407cd357cf2d9c51add}{02051}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1RankFourTensor_ae17bed648f6da407cd357cf2d9c51add}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02052}02052                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02053}02053                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02054}02054                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& l)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02055}02055     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02056}02056 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02057}02057       this-\/>\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad9e629184b51ee7cb8074ce6d3641f36}{range\_check}}(i, j, k, l);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02058}02058 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02059}02059       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k) + l];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02060}02060     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02061}02061 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02062}02062 \textcolor{comment}{    /// Overload a const version for read-\/only access as a(i,j,k,l)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02063}\mbox{\hyperlink{classoomph_1_1RankFourTensor_ab2319b2c0d1e48c6908b3a51c6105099}{02063}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1RankFourTensor_ab2319b2c0d1e48c6908b3a51c6105099}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02064}02064                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02065}02065                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02066}02066                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& l)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02067}02067 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02068}02068 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02069}02069       this-\/>\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad9e629184b51ee7cb8074ce6d3641f36}{range\_check}}(i, j, k, l);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02070}02070 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02071}02071       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k) + l];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02072}02072     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02073}02073 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02074}02074 \textcolor{comment}{    /// Direct access to internal storage of data in flat-\/packed C-\/style}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02075}02075 \textcolor{comment}{    /// column-\/major format. WARNING: Only for experienced users. Only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02076}02076 \textcolor{comment}{    /// use this if raw speed is of the essence, as in the solid mechanics}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02077}02077 \textcolor{comment}{    /// problems.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02078}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a203d72131ae3708747268aae9b020749}{02078}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1RankFourTensor_a203d72131ae3708747268aae9b020749}{raw\_direct\_access}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02079}02079     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02080}02080       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02081}02081     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02082}02082 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02083}02083 \textcolor{comment}{    /// Direct access to internal storage of data in flat-\/packed C-\/style}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02084}02084 \textcolor{comment}{    /// column-\/major format. WARNING: Only for experienced users. Only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02085}02085 \textcolor{comment}{    /// use this if raw speed is of the essence, as in the solid mechanics}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02086}02086 \textcolor{comment}{    /// problems.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02087}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a8cd89fd3103e0cb7bde292c02c0badef}{02087}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1RankFourTensor_a8cd89fd3103e0cb7bde292c02c0badef}{raw\_direct\_access}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02088}02088 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02089}02089       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4e195572c01989507a4be4cfdcd26210}{Tensordata}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02090}02090     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02091}02091 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02092}02092 \textcolor{comment}{    /// Caculate the offset in flat-\/packed C-\/style, column-\/major format,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02093}02093 \textcolor{comment}{    /// required for a given i,j. WARNING: Only for experienced users. Only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02094}02094 \textcolor{comment}{    /// use this if raw speed is of the essence, as in the solid mechanics}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02095}02095 \textcolor{comment}{    /// problems.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02096}\mbox{\hyperlink{classoomph_1_1RankFourTensor_a4218f2bff16fe393ed704207e39c9b55}{02096}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFourTensor_a4218f2bff16fe393ed704207e39c9b55}{offset}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02097}02097 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02098}02098       \textcolor{keywordflow}{return} (\mbox{\hyperlink{classoomph_1_1RankFourTensor_ae62059ee0897816d899c266ad6c03c8b}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_ad7c18005b6cb68643c2718e67dd6a0d7}{P}} * (\mbox{\hyperlink{classoomph_1_1RankFourTensor_a0f0e34937940e082dbba6b95383086d5}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + 0) + 0);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02099}02099     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02100}02100   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02101}02101 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02102}02102 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02103}02103 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02104}02104 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02105}02105 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02106}02106 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02107}02107 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02108}02108   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02109}02109 \textcolor{comment}{  /// A Rank 5 Tensor class}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02110}02110 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02111}02111   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02112}\mbox{\hyperlink{classoomph_1_1RankFiveTensor}{02112}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1RankFiveTensor}{RankFiveTensor}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02113}02113   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02114}02114   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02115}02115 \textcolor{comment}{    /// Private internal representation  as pointer to data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02116}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{02116}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02117}02117 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02118}02118 \textcolor{comment}{    /// 1st Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02119}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{02119}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02120}02120 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02121}02121 \textcolor{comment}{    /// 2nd Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02122}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{02122}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02123}02123 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02124}02124 \textcolor{comment}{    /// 3rd Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02125}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{02125}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02126}02126 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02127}02127 \textcolor{comment}{    /// 4th Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02128}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{02128}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02129}02129 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02130}02130 \textcolor{comment}{    /// 5th Tensor dimension}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02131}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{02131}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02132}02132 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02133}02133 \textcolor{comment}{    /// Range check to catch when an index is out of bounds, if so, it}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02134}02134 \textcolor{comment}{    /// issues a warning message and dies by throwing an \(\backslash\)c OomphLibError}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02135}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a8fce9375f99c153e3d5b91193996dad8}{02135}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a8fce9375f99c153e3d5b91193996dad8}{range\_check}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02136}02136                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02137}02137                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02138}02138                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& l,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02139}02139                      \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02140}02140 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02141}02141       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} >= \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02142}02142       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02143}02143         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02144}02144         error\_message << \textcolor{stringliteral}{"{}Range Error: i="{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02145}02145                       << \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02146}02146 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02147}02147         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02148}02148                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02149}02149                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02150}02150       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02151}02151       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j >= \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02152}02152       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02153}02153         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02154}02154         error\_message << \textcolor{stringliteral}{"{}Range Error: j="{}} << j << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02155}02155                       << \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02156}02156 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02157}02157         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02158}02158                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02159}02159                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02160}02160       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02161}02161       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (k >= \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02162}02162       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02163}02163         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02164}02164         error\_message << \textcolor{stringliteral}{"{}Range Error: k="{}} << k << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02165}02165                       << \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02166}02166 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02167}02167         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02168}02168                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02169}02169                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02170}02170       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02171}02171       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (l >= \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02172}02172       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02173}02173         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02174}02174         error\_message << \textcolor{stringliteral}{"{}Range Error: l="{}} << l << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02175}02175                       << \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02176}02176 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02177}02177         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02178}02178                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02179}02179                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02180}02180       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02181}02181       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (m >= \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02182}02182       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02183}02183         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02184}02184         error\_message << \textcolor{stringliteral}{"{}Range Error: m="{}} << m << \textcolor{stringliteral}{"{} is not in the range (0,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02185}02185                       << \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} -\/ 1 << \textcolor{stringliteral}{"{})."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02186}02186 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02187}02187         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02188}02188                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02189}02189                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02190}02190       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02191}02191     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02192}02192 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02193}02193   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02194}02194 \textcolor{comment}{    /// Empty constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02195}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a388a9f191189d174e521d422e3bc44cd}{02195}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a388a9f191189d174e521d422e3bc44cd}{RankFiveTensor}}() : \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}(0), \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}}(0), \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}}(0), \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}}(0), \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}}(0), \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}(0) \{\}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02196}02196 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02197}02197 \textcolor{comment}{    /// Copy constructor: Deep copy}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02198}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a17aa636c6c8b4aa80ff4e168bca1881b}{02198}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a17aa636c6c8b4aa80ff4e168bca1881b}{RankFiveTensor}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1RankFiveTensor}{RankFiveTensor}}\& source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02199}02199     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02200}02200       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02201}02201       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad9f5651447193b2c7e669beff9146cc9}{nindex1}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02202}02202       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a92d2a0f9ffc41e75cf5fffa9cfd601fd}{nindex2}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02203}02203       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a720c024bccf0b33f2f3bd6367611a4fa}{nindex3}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02204}02204       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a2f59dd13534545f9e2641dafee86bc27}{nindex4}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02205}02205       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aa880f750e9d2e2bf5ec5c41ad3241568}{nindex5}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02206}02206 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02207}02207       \textcolor{comment}{// Assign space for the data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02208}02208       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02209}02209 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02210}02210       \textcolor{comment}{// Copy the data across from the other matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02211}02211       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02212}02212       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02213}02213         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02214}02214         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02215}02215           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}}; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02216}02216           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02217}02217             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}}; l++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02218}02218             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02219}02219               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}; m++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02220}02220               \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02221}02221                 \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k) + l) + m] =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02222}02222                   source\_tensor(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k, l, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02223}02223               \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02224}02224             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02225}02225           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02226}02226         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02227}02227       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02228}02228     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02229}02229 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02230}02230 \textcolor{comment}{    /// Copy assignement}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02231}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a20c271491dbce39872a9244a8d9711bf}{02231}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFiveTensor}{RankFiveTensor}}\& \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a20c271491dbce39872a9244a8d9711bf}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1RankFiveTensor}{RankFiveTensor}}\& source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02232}02232     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02233}02233       \textcolor{comment}{// Don't create a new matrix if the assignement is the identity}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02234}02234       \textcolor{keywordflow}{if} (\textcolor{keyword}{this} != \&source\_tensor)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02235}02235       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02236}02236         \textcolor{comment}{// Check row and column length}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02237}02237         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad9f5651447193b2c7e669beff9146cc9}{nindex1}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02238}02238         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} m = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a92d2a0f9ffc41e75cf5fffa9cfd601fd}{nindex2}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02239}02239         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} p = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a720c024bccf0b33f2f3bd6367611a4fa}{nindex3}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02240}02240         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} q = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a2f59dd13534545f9e2641dafee86bc27}{nindex4}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02241}02241         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} r = source\_tensor.\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aa880f750e9d2e2bf5ec5c41ad3241568}{nindex5}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02242}02242         \textcolor{comment}{// Resize the tensor to be the same size as the old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02243}02243         \textcolor{keywordflow}{if} ((\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} != n) || (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} != m) || (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} != p) || (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} != q) || (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} != r))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02244}02244         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02245}02245           \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a8d0f38a3627c9d07dbf1106a26f61578}{resize}}(n, m, p, q, r);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02246}02246         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02247}02247 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02248}02248         \textcolor{comment}{// Copy entries across from the other matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02249}02249         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02250}02250         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02251}02251           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02252}02252           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02253}02253             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}}; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02254}02254             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02255}02255               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} l = 0; l < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}}; l++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02256}02256               \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02257}02257                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} m = 0; m < \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}; m++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02258}02258                 \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02259}02259                   (*this)(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k, l, m) = source\_tensor(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j, k, l, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02260}02260                 \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02261}02261               \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02262}02262             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02263}02263           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02264}02264         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02265}02265       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02266}02266       \textcolor{comment}{// Return reference to object itself (i.e. de-\/reference this pointer)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02267}02267       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02268}02268     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02269}02269 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02270}02270 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02271}02271 \textcolor{comment}{    /// One parameter constructor produces a  nxnxnxnxn tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02272}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a2fb5f83bfa8237882705e16ca1fbd04b}{02272}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a2fb5f83bfa8237882705e16ca1fbd04b}{RankFiveTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02273}02273     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02274}02274       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02275}02275       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02276}02276       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02277}02277       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02278}02278       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02279}02279       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02280}02280       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02281}02281       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02282}02282       \textcolor{comment}{// Initialise to zero if required}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02283}02283 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02284}02284       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad3fbc9fc71b68eec0fa4c00d9ad663b6}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02285}02285 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02286}02286     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02287}02287 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02288}02288 \textcolor{comment}{    /// Four parameter constructor, general non-\/square tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02289}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_af7e765aecc61bca8ad9742e07822c54f}{02289}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFiveTensor_af7e765aecc61bca8ad9742e07822c54f}{RankFiveTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02290}02290                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02291}02291                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02292}02292                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index4,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02293}02293                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index5)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02294}02294     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02295}02295       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02296}02296       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02297}02297       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02298}02298       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02299}02299       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} = n\_index4;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02300}02300       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} = n\_index5;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02301}02301       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02302}02302       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02303}02303       \textcolor{comment}{// Initialise to zero if required}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02304}02304 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02305}02305       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad3fbc9fc71b68eec0fa4c00d9ad663b6}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02306}02306 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02307}02307     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02308}02308 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02309}02309 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02310}02310 \textcolor{comment}{    /// Four parameter constructor, general non-\/square tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02311}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a79ebab81e4e9f7fdd193f59a4858930c}{02311}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a79ebab81e4e9f7fdd193f59a4858930c}{RankFiveTensor}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02312}02312                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02313}02313                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02314}02314                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index4,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02315}02315                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index5,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02316}02316                    \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_val)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02317}02317     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02318}02318       \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02319}02319       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02320}02320       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02321}02321       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02322}02322       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} = n\_index4;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02323}02323       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} = n\_index5;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02324}02324       \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02325}02325       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02326}02326       \textcolor{comment}{// Initialise to the initial value}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02327}02327       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad3fbc9fc71b68eec0fa4c00d9ad663b6}{initialise}}(initial\_val);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02328}02328     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02329}02329 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02330}02330 \textcolor{comment}{    /// Destructor: delete the pointers}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02331}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aee507ed9367b053bcf538b3eaaf62d03}{02331}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aee507ed9367b053bcf538b3eaaf62d03}{\string~RankFiveTensor}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02332}02332     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02333}02333       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02334}02334       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02335}02335     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02336}02336 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02337}02337 \textcolor{comment}{    /// Resize to a square nxnxnxn tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02338}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a8d0f38a3627c9d07dbf1106a26f61578}{02338}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a8d0f38a3627c9d07dbf1106a26f61578}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02339}02339     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02340}02340       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a8d0f38a3627c9d07dbf1106a26f61578}{resize}}(n, n, n, n, n);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02341}02341     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02342}02342 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02343}02343 \textcolor{comment}{    /// Resize to a general tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02344}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_afdd04cd2a29fb7b8c41f5300200813e1}{02344}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_afdd04cd2a29fb7b8c41f5300200813e1}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02345}02345                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02346}02346                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02347}02347                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index4,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02348}02348                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index5)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02349}02349     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02350}02350       \textcolor{comment}{// If the sizes have not changed do nothing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02351}02351       \textcolor{keywordflow}{if} ((n\_index1 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}}) \&\& (n\_index2 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}}) \&\& (n\_index3 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}}) \&\&}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02352}02352           (n\_index4 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}}) \&\& (n\_index5 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02353}02353       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02354}02354         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02355}02355       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02356}02356       \textcolor{comment}{// Store old sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02357}02357       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}}, m\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}}, p\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}}, q\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}}, r\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02358}02358       \textcolor{comment}{// Reassign the sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02359}02359       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02360}02360       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02361}02361       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02362}02362       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} = n\_index4;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02363}02363       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} = n\_index5;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02364}02364       \textcolor{comment}{// Store pointer to old matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02365}02365       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* temp\_tensor = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02366}02366       \textcolor{comment}{// Re-\/create Tensordata in new size}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02367}02367       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02368}02368 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02369}02369       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad3fbc9fc71b68eec0fa4c00d9ad663b6}{initialise}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02370}02370 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02371}02371       \textcolor{comment}{// Transfer values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02372}02372       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_copy, m\_copy, p\_copy, q\_copy, r\_copy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02373}02373       n\_copy = std::min(n\_old, n\_index1);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02374}02374       m\_copy = std::min(m\_old, n\_index2);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02375}02375       p\_copy = std::min(p\_old, n\_index3);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02376}02376       q\_copy = std::min(q\_old, n\_index4);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02377}02377       r\_copy = std::min(r\_old, n\_index5);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02378}02378       \textcolor{comment}{// If matrix has values, transfer them to new matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02379}02379       \textcolor{comment}{// Loop over rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02380}02380       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_copy; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02381}02381       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02382}02382         \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02383}02383         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < m\_copy; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02384}02384         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02385}02385           \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02386}02386           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < p\_copy; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02387}02387           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02388}02388             \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02389}02389             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} l = 0; l < q\_copy; l++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02390}02390             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02391}02391               \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02392}02392               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} m = 0; m < r\_copy; m++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02393}02393               \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02394}02394                 \textcolor{comment}{// Transfer values from temp\_tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02395}02395                 \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * j + k) + l) + m] =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02396}02396                   temp\_tensor[r\_old *}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02397}02397                                 (q\_old * (m\_old * p\_old * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + p\_old * j + k) +}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02398}02398                                  l) +}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02399}02399                               m];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02400}02400               \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02401}02401             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02402}02402           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02403}02403         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02404}02404       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02405}02405       \textcolor{comment}{// Now kill storage for old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02406}02406       \textcolor{keyword}{delete}[] temp\_tensor;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02407}02407     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02408}02408 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02409}02409 \textcolor{comment}{    /// Resize to a general tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02410}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a80eeaef66e9252fa5d1d7031e4ec402c}{02410}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a80eeaef66e9252fa5d1d7031e4ec402c}{resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index1,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02411}02411                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index2,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02412}02412                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index3,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02413}02413                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index4,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02414}02414                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n\_index5,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02415}02415                 \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_value)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02416}02416     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02417}02417       \textcolor{comment}{// If the sizes have not changed do nothing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02418}02418       \textcolor{keywordflow}{if} ((n\_index1 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}}) \&\& (n\_index2 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}}) \&\& (n\_index3 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}}) \&\&}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02419}02419           (n\_index4 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}}) \&\& (n\_index5 == \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02420}02420       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02421}02421         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02422}02422       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02423}02423       \textcolor{comment}{// Store old sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02424}02424       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}}, m\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}}, p\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}}, q\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}}, r\_old = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02425}02425       \textcolor{comment}{// Reassign the sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02426}02426       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} = n\_index1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02427}02427       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} = n\_index2;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02428}02428       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} = n\_index3;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02429}02429       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} = n\_index4;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02430}02430       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} = n\_index5;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02431}02431       \textcolor{comment}{// Store triple pointer to old matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02432}02432       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* temp\_tensor = \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02433}02433       \textcolor{comment}{// Re-\/create Tensordata in new size}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02434}02434       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}} = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02435}02435       \textcolor{comment}{// Initialise the newly allocated storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02436}02436       \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad3fbc9fc71b68eec0fa4c00d9ad663b6}{initialise}}(initial\_value);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02437}02437 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02438}02438       \textcolor{comment}{// Transfer values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02439}02439       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_copy, m\_copy, p\_copy, q\_copy, r\_copy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02440}02440       n\_copy = std::min(n\_old, n\_index1);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02441}02441       m\_copy = std::min(m\_old, n\_index2);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02442}02442       p\_copy = std::min(p\_old, n\_index3);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02443}02443       q\_copy = std::min(q\_old, n\_index4);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02444}02444       r\_copy = std::min(r\_old, n\_index5);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02445}02445       \textcolor{comment}{// If matrix has values, transfer them to new matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02446}02446       \textcolor{comment}{// Loop over rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02447}02447       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_copy; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02448}02448       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02449}02449         \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02450}02450         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < m\_copy; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02451}02451         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02452}02452           \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02453}02453           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} k = 0; k < p\_copy; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02454}02454           \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02455}02455             \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02456}02456             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} l = 0; l < q\_copy; l++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02457}02457             \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02458}02458               \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02459}02459               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} m = 0; m < r\_copy; m++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02460}02460               \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02461}02461                 \textcolor{comment}{// Transfer values from temp\_tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02462}02462                 \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * j + k) + l) + m] =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02463}02463                   temp\_tensor[r\_old *}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02464}02464                                 (q\_old * (m\_old * p\_old * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + p\_old * j + k) +}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02465}02465                                  l) +}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02466}02466                               m];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02467}02467               \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02468}02468             \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02469}02469           \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02470}02470         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02471}02471       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02472}02472       \textcolor{comment}{// Now kill storage for old tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02473}02473       \textcolor{keyword}{delete}[] temp\_tensor;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02474}02474     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02475}02475 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02476}02476 \textcolor{comment}{    /// Initialise all values in the tensor to val}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02477}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad3fbc9fc71b68eec0fa4c00d9ad663b6}{02477}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad3fbc9fc71b68eec0fa4c00d9ad663b6}{initialise}}(\textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& val)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02478}02478     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02479}02479       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}}); ++\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02480}02480       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02481}02481         \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = val;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02482}02482       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02483}02483     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02484}02484 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02485}02485 \textcolor{comment}{    /// Return the range of index 1 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02486}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad9f5651447193b2c7e669beff9146cc9}{02486}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ad9f5651447193b2c7e669beff9146cc9}{nindex1}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02487}02487 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02488}02488       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aeea12f3e80605e2c7b6b4a8ec47bf91c}{N}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02489}02489     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02490}02490 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02491}02491 \textcolor{comment}{    /// Return the range of index 2 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02492}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a92d2a0f9ffc41e75cf5fffa9cfd601fd}{02492}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a92d2a0f9ffc41e75cf5fffa9cfd601fd}{nindex2}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02493}02493 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02494}02494       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02495}02495     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02496}02496 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02497}02497 \textcolor{comment}{    /// Return the range of index 3 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02498}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a720c024bccf0b33f2f3bd6367611a4fa}{02498}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a720c024bccf0b33f2f3bd6367611a4fa}{nindex3}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02499}02499 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02500}02500       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02501}02501     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02502}02502 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02503}02503 \textcolor{comment}{    /// Return the range of index 4 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02504}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a2f59dd13534545f9e2641dafee86bc27}{02504}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a2f59dd13534545f9e2641dafee86bc27}{nindex4}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02505}02505 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02506}02506       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02507}02507     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02508}02508 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02509}02509 \textcolor{comment}{    /// Return the range of index 5 of the tensor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02510}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aa880f750e9d2e2bf5ec5c41ad3241568}{02510}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aa880f750e9d2e2bf5ec5c41ad3241568}{nindex5}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02511}02511 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02512}02512       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02513}02513     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02514}02514 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02515}02515 \textcolor{comment}{    /// Overload the round brackets to give access as a(i,j,k,l,m)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02516}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_aa4e20c4ddef857cad0ddf9e4de264ad4}{02516}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1RankFiveTensor_aa4e20c4ddef857cad0ddf9e4de264ad4}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02517}02517                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02518}02518                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02519}02519                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& l,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02520}02520                          \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02521}02521     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02522}02522 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02523}02523       this-\/>\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a8fce9375f99c153e3d5b91193996dad8}{range\_check}}(i, j, k, l, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02524}02524 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02525}02525       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k) + l) + m];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02526}02526     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02527}02527 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02528}02528 \textcolor{comment}{    /// Overload a const version for read-\/only access as a(i,j,k,l,m)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02529}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0d2ef9d9bcc8103b2d60f768ffa60532}{02529}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0d2ef9d9bcc8103b2d60f768ffa60532}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02530}02530                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02531}02531                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02532}02532                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& l,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02533}02533                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02534}02534 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02535}02535 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02536}02536       this-\/>\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a8fce9375f99c153e3d5b91193996dad8}{range\_check}}(i, j, k, l, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02537}02537 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02538}02538       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}[\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k) + l) + m];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02539}02539     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02540}02540 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02541}02541 \textcolor{comment}{    /// Direct access to internal storage of data in flat-\/packed C-\/style}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02542}02542 \textcolor{comment}{    /// column-\/major format. WARNING: Only for experienced users. Only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02543}02543 \textcolor{comment}{    /// use this if raw speed is of the essence, as in the solid mechanics}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02544}02544 \textcolor{comment}{    /// problems.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02545}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a75d42bf8529d20a18c573eb62aeffed1}{02545}} \textcolor{comment}{}    \textcolor{keyword}{inline} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a75d42bf8529d20a18c573eb62aeffed1}{raw\_direct\_access}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02546}02546     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02547}02547       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02548}02548     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02549}02549 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02550}02550 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02551}02551 \textcolor{comment}{    /// Direct access to internal storage of data in flat-\/packed C-\/style}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02552}02552 \textcolor{comment}{    /// column-\/major format. WARNING: Only for experienced users. Only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02553}02553 \textcolor{comment}{    /// use this if raw speed is of the essence, as in the solid mechanics}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02554}02554 \textcolor{comment}{    /// problems.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02555}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a7de048a5cdd37e9f5266de9718548b61}{02555}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1RankFiveTensor_a7de048a5cdd37e9f5266de9718548b61}{raw\_direct\_access}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02556}02556 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02557}02557       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ae93e781da0ba64c2c5403099dc75dd3d}{Tensordata}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02558}02558     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02559}02559 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02560}02560 \textcolor{comment}{    /// Caculate the offset in flat-\/packed Cy-\/style, column-\/major format,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02561}02561 \textcolor{comment}{    /// required for a given i,j,k. WARNING: Only for experienced users. Only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02562}02562 \textcolor{comment}{    /// use this if raw speed is of the essence, as in the solid mechanics}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02563}02563 \textcolor{comment}{    /// problems.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02564}\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab3bd11afa49e36ff28c1d4968796f5a3}{02564}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab3bd11afa49e36ff28c1d4968796f5a3}{offset}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02565}02565                     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02566}02566                     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& k)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02567}02567 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02568}02568       \textcolor{keywordflow}{return} (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a0c348e8860783caf59103dd86f38d1a6}{R}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a68d3c3387b64dc8124cb0800ab4814a5}{Q}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_ab23d40bd6af9279e1e35362249c32855}{P}} * (\mbox{\hyperlink{classoomph_1_1RankFiveTensor_a240c4e62ffa0dd3e5dfc3b0063f94c7f}{M}} * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) + k) + 0) + 0);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02569}02569     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02570}02570   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02571}02571 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02572}02572 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02573}02573 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02574}02574 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02575}02575 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02576}02576 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02577}02577   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02578}02578 \textcolor{comment}{  /// A class for compressed column matrices: a sparse matrix format}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02579}02579 \textcolor{comment}{  /// The class is passed as the MATRIX\_TYPE paramater so that the base}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02580}02580 \textcolor{comment}{  /// class can use the specific access functions in the round-\/bracket}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02581}02581 \textcolor{comment}{  /// operator.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02582}02582 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02583}02583   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02584}\mbox{\hyperlink{classoomph_1_1CCMatrix}{02584}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1CCMatrix}{CCMatrix}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}<T, CCMatrix<T>>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02585}02585   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02586}02586   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02587}02587 \textcolor{comment}{    /// Default constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02588}\mbox{\hyperlink{classoomph_1_1CCMatrix_a16be0ba4cd8d9d5422de26513bab3b41}{02588}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CCMatrix_a16be0ba4cd8d9d5422de26513bab3b41}{CCMatrix}}() : \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}, \mbox{\hyperlink{classoomph_1_1CCMatrix}{CCMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}>>()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02589}02589     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02590}02590       \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02591}02591       \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02592}02592     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02593}02593 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02594}02594 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02595}02595 \textcolor{comment}{    /// Constructor: Pass vector of values, vector of row indices,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02596}02596 \textcolor{comment}{    /// vector of column starts and number of rows (can be suppressed}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02597}02597 \textcolor{comment}{    /// for square matrices). Number of nonzero entries is read}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02598}02598 \textcolor{comment}{    /// off from value, so make sure the vector has been shrunk}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02599}02599 \textcolor{comment}{    /// to its correct length.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02600}\mbox{\hyperlink{classoomph_1_1CCMatrix_a4d8bf86e2cb87a710fb5485ac5904274}{02600}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CCMatrix_a4d8bf86e2cb87a710fb5485ac5904274}{CCMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<T>}}\& \mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02601}02601              \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& row\_index\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02602}02602              \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& column\_start\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02603}02603              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02604}02604              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02605}02605       : \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}, \mbox{\hyperlink{classoomph_1_1CCMatrix}{CCMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}>>()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02606}02606     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02607}02607       \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02608}02608       \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02609}02609       \mbox{\hyperlink{classoomph_1_1CCMatrix_aa08192365e3c87357d1f7ca8131f03de}{build}}(\mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}}, row\_index\_, column\_start\_, n, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02610}02610     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02611}02611 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02612}02612 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02613}02613 \textcolor{comment}{    /// Copy constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02614}\mbox{\hyperlink{classoomph_1_1CCMatrix_a815c8a3473ce3b8fe70c682e7591a33d}{02614}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CCMatrix_a815c8a3473ce3b8fe70c682e7591a33d}{CCMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CCMatrix}{CCMatrix}}\& source\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02615}02615       : \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}, \mbox{\hyperlink{classoomph_1_1CCMatrix}{CCMatrix}}<\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}>>(source\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02616}02616     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02617}02617       \textcolor{comment}{// NNz, N and M are set the the copy constructor of the SparseMatrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02618}02618       \textcolor{comment}{// called above}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02619}02619 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02620}02620       \textcolor{comment}{// Row indices stored in C-\/style array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02621}02621       \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}} = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02622}02622 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02623}02623       \textcolor{comment}{// Assign:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02624}02624       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a1459cbaeec275fe95ba45f7d843b26a5}{Nnz}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02625}02625       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02626}02626         \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = source\_matrix.\mbox{\hyperlink{classoomph_1_1CCMatrix_ae72bd1ac1b78c2433197587b499a0d62}{row\_index}}()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02627}02627       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02628}02628 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02629}02629       \textcolor{comment}{// Column start:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02630}02630       \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}} = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{M}} + 1];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02631}02631 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02632}02632       \textcolor{comment}{// Assign:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02633}02633       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} <= this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{M}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02634}02634       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02635}02635         \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = source\_matrix.\mbox{\hyperlink{classoomph_1_1CCMatrix_a9cf931b97d5e6f57ae6dd7d03727dbdd}{column\_start}}()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02636}02636       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02637}02637     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02638}02638 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02639}02639 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02640}\mbox{\hyperlink{classoomph_1_1CCMatrix_aa1c3f775aeac6b548370e14dbe875d6a}{02640}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_aa1c3f775aeac6b548370e14dbe875d6a}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CCMatrix}{CCMatrix}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02641}02641 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02642}02642 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02643}02643 \textcolor{comment}{    /// Destructor, delete any allocated memory}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02644}\mbox{\hyperlink{classoomph_1_1CCMatrix_a5f6e403c6f6478abe752ca515d3120d9}{02644}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1CCMatrix_a5f6e403c6f6478abe752ca515d3120d9}{\string~CCMatrix}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02645}02645     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02646}02646       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02647}02647       \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02648}02648       \textcolor{keyword}{delete}[] \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02649}02649       \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02650}02650     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02651}02651 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02652}02652 \textcolor{comment}{    /// Access function that will be called by the read-\/only}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02653}02653 \textcolor{comment}{    /// round-\/bracket operator (const)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02654}\mbox{\hyperlink{classoomph_1_1CCMatrix_a9b40b8a395a94be77939308cc413828a}{02654}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1CCMatrix_a9b40b8a395a94be77939308cc413828a}{get\_entry}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02655}02655 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02656}02656 \textcolor{preprocessor}{\#ifdef RANGE\_CHECKING}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02657}02657       this-\/>\mbox{\hyperlink{classoomph_1_1Matrix_a2fed2ea1840638eb0ddaa2d4ab1da82f}{range\_check}}(i, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02658}02658 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02659}02659       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} k = \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}}[j]; k < \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}}[j + 1]; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02660}02660       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02661}02661         \textcolor{keywordflow}{if} (\textcolor{keywordtype}{unsigned}(\mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}}[k]) == \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02662}02662         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02663}02663           \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}}[k];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02664}02664         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02665}02665       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02666}02666       \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a71a5ae159c26f93c314c839f4db6eaaf}{Zero}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02667}02667     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02668}02668 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02669}02669 \textcolor{comment}{    /// Read-\/write access is not permitted for these matrices and is}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02670}02670 \textcolor{comment}{    /// deliberately broken.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02671}\mbox{\hyperlink{classoomph_1_1CCMatrix_a30fb5552543c8d2f0626578ee2f9a5ae}{02671}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& \mbox{\hyperlink{classoomph_1_1CCMatrix_a30fb5552543c8d2f0626578ee2f9a5ae}{entry}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02672}02672     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02673}02673       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_string =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02674}02674         \textcolor{stringliteral}{"{}Non-\/const access not provided for the CCMatrix<T> class\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02675}02675       error\_string +=}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02676}02676         \textcolor{stringliteral}{"{}It is not possible to use round-\/bracket access: M(i,j)\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02677}02677       error\_string += \textcolor{stringliteral}{"{}if M is not declared as const.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02678}02678       error\_string += \textcolor{stringliteral}{"{}The solution (albeit ugly) is to create const reference "{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02679}02679                       \textcolor{stringliteral}{"{}to the matrix\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02680}02680       error\_string += \textcolor{stringliteral}{"{} const CCMatrix<T>\& read\_M = M;\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02681}02681       error\_string += \textcolor{stringliteral}{"{}Then read\_M(i,j) is permitted\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02682}02682 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02683}02683       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02684}02684         error\_string, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02685}02685 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02686}02686       \textcolor{comment}{// Dummy return}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02687}02687       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} dummy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02688}02688       \textcolor{keywordflow}{return} dummy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02689}02689     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02690}02690 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02691}02691 \textcolor{comment}{    /// Access to C-\/style column\_start array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02692}\mbox{\hyperlink{classoomph_1_1CCMatrix_a9cf931b97d5e6f57ae6dd7d03727dbdd}{02692}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CCMatrix_a9cf931b97d5e6f57ae6dd7d03727dbdd}{column\_start}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02693}02693     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02694}02694       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02695}02695     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02696}02696 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02697}02697 \textcolor{comment}{    /// Access to C-\/style column\_start array (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02698}\mbox{\hyperlink{classoomph_1_1CCMatrix_ae8fc61adedf5d658d6efa374ff3a4530}{02698}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CCMatrix_ae8fc61adedf5d658d6efa374ff3a4530}{column\_start}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02699}02699 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02700}02700       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02701}02701     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02702}02702 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02703}02703 \textcolor{comment}{    /// Access to C-\/style row index array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02704}\mbox{\hyperlink{classoomph_1_1CCMatrix_ae72bd1ac1b78c2433197587b499a0d62}{02704}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CCMatrix_ae72bd1ac1b78c2433197587b499a0d62}{row\_index}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02705}02705     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02706}02706       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02707}02707     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02708}02708 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02709}02709 \textcolor{comment}{    /// Access to C-\/style row index array (const version)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02710}\mbox{\hyperlink{classoomph_1_1CCMatrix_ad16551df5f9bb8469ea096acf56ba3b7}{02710}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CCMatrix_ad16551df5f9bb8469ea096acf56ba3b7}{row\_index}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02711}02711 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02712}02712       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02713}02713     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02714}02714 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02715}02715 \textcolor{comment}{    /// Output the "{}bottom right"{} entry regardless of it being}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02716}02716 \textcolor{comment}{    /// zero or not (this allows automatic detection of matrix size in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02717}02717 \textcolor{comment}{    /// e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02718}\mbox{\hyperlink{classoomph_1_1CCMatrix_ac3b138b2ed470866999f2a92f3e1f239}{02718}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_ac3b138b2ed470866999f2a92f3e1f239}{output\_bottom\_right\_zero\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02719}02719 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02720}02720       \textcolor{keywordtype}{int} last\_row = this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}} -\/ 1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02721}02721       \textcolor{keywordtype}{int} last\_col\_local = this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_ae558ff039363bd2aa163525442090508}{M}} -\/ 1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02722}02722 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02723}02723       \textcolor{comment}{// Use this strange thingy because of the CRTP discussed above.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02724}02724       \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} last\_value = this-\/>\mbox{\hyperlink{classoomph_1_1Matrix_a26f23d2b331cb7f533fd8585f1ef8d28}{operator()}}(last\_row, last\_col\_local);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02725}02725 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02726}02726       \textcolor{keywordflow}{if} (last\_value == \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02727}02727       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02728}02728         outfile << last\_row << \textcolor{stringliteral}{"{} "{}} << last\_col\_local << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02729}02729                 << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02730}02730       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02731}02731     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02732}02732 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02733}02733 \textcolor{comment}{    /// Indexed output function to print a matrix to the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02734}02734 \textcolor{comment}{    /// stream outfile as i,j,a(i,j) for a(i,j)!=0 only.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02735}\mbox{\hyperlink{classoomph_1_1CCMatrix_a1f6e451f0688c392e45bc03bf20fdda7}{02735}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_a1f6e451f0688c392e45bc03bf20fdda7}{sparse\_indexed\_output\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02736}02736 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02737}02737       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a8f15f962605f52fc75e8679efc6c8677}{N}}; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02738}02738       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02739}02739         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} k = \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}}[j]; k < \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}}[j + 1]; k++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02740}02740         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02741}02741           outfile << \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}}[k] << \textcolor{stringliteral}{"{} "{}} << j << \textcolor{stringliteral}{"{} "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1SparseMatrix_a55b53c70fe3906a65d0f84c429e963b1}{Value}}[k]}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02742}02742                   << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02743}02743         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02744}02744       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02745}02745     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02746}02746 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02747}02747 \textcolor{comment}{    /// Wipe matrix data and set all values to 0.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02748}\mbox{\hyperlink{classoomph_1_1CCMatrix_af3f7a40493a8576558e211c681b1ca3c}{02748}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_af3f7a40493a8576558e211c681b1ca3c}{clean\_up\_memory}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02749}02749 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02750}02750 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02751}02751 \textcolor{comment}{    /// Build matrix from compressed representation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02752}02752 \textcolor{comment}{    /// Number of nonzero entries is read}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02753}02753 \textcolor{comment}{    /// off from value, so make sure the vector has been shrunk}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02754}02754 \textcolor{comment}{    /// to its correct length.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02755}\mbox{\hyperlink{classoomph_1_1CCMatrix_aa08192365e3c87357d1f7ca8131f03de}{02755}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_aa08192365e3c87357d1f7ca8131f03de}{build}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<T>}}\& \mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02756}02756                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CCMatrix_ae72bd1ac1b78c2433197587b499a0d62}{row\_index}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02757}02757                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& \mbox{\hyperlink{classoomph_1_1CCMatrix_a9cf931b97d5e6f57ae6dd7d03727dbdd}{column\_start}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02758}02758                \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02759}02759                \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02760}02760 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02761}02761 \textcolor{comment}{    /// Function to build matrix from pointers to arrays}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02762}02762 \textcolor{comment}{    /// which hold the column starts, row indices and non-\/zero values.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02763}02763 \textcolor{comment}{    /// The final parameters specifies the number of rows and columns.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02764}02764 \textcolor{comment}{    /// Note that, as the name suggests, this function does not}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02765}02765 \textcolor{comment}{    /// make a copy of the data pointed to by the first three arguments!}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02766}\mbox{\hyperlink{classoomph_1_1CCMatrix_a57eddb79a6a3af698a1c92196482335a}{02766}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_a57eddb79a6a3af698a1c92196482335a}{build\_without\_copy}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* \mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02767}02767                             \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CCMatrix_ae72bd1ac1b78c2433197587b499a0d62}{row\_index}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02768}02768                             \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CCMatrix_a9cf931b97d5e6f57ae6dd7d03727dbdd}{column\_start}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02769}02769                             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{classoomph_1_1SparseMatrix_a8b8010edcc0869283621e72a9bbc51e3}{nnz}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02770}02770                             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02771}02771                             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02772}02772 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02773}02773 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02774}02774   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02775}02775 \textcolor{comment}{    /// Row index}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02776}\mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{02776}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CCMatrix_a7dba85934f3059d0163dda06f94ddf9b}{Row\_index}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02777}02777 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02778}02778 \textcolor{comment}{    /// Start index for column}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02779}\mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{02779}} \textcolor{comment}{}    \textcolor{keywordtype}{int}* \mbox{\hyperlink{classoomph_1_1CCMatrix_a6a38ae2bd1a69905375585d5b24c6136}{Column\_start}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02780}02780   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02781}02781 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02782}02782 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02783}02783 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02784}02784 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02785}02785 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02786}02786 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02787}02787   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02788}02788 \textcolor{comment}{  /// A class for compressed column matrices that store doubles}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02789}02789 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02790}\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix}{02790}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix}{CCDoubleMatrix}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}}, \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1CCMatrix}{CCMatrix}}<double>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02791}02791   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02792}02792   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02793}02793 \textcolor{comment}{    /// Default constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02794}02794 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_abc80ef8ffa3a961daf6759bb2c574239}{CCDoubleMatrix}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02795}02795 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02796}02796 \textcolor{comment}{    /// Constructor: Pass vector of values, vector of row indices,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02797}02797 \textcolor{comment}{    /// vector of column starts and number of rows (can be suppressed}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02798}02798 \textcolor{comment}{    /// for square matrices). Number of nonzero entries is read}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02799}02799 \textcolor{comment}{    /// off from value, so make sure the vector has been shrunk}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02800}02800 \textcolor{comment}{    /// to its correct length.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02801}02801 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_abc80ef8ffa3a961daf6759bb2c574239}{CCDoubleMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{classoomph_1_1SparseMatrix_a7a5b585410f9b23da6f269faa4a1db72}{value}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02802}02802                    \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& row\_index\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02803}02803                    \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& column\_start\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02804}02804                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02805}02805                    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02806}02806 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02807}02807 \textcolor{comment}{    /// Broken copy constructor}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02808}\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a957569463e2ccab8b45d303d36b4d477}{02808}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a957569463e2ccab8b45d303d36b4d477}{CCDoubleMatrix}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix}{CCDoubleMatrix}}\& matrix) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02809}02809 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02810}02810 \textcolor{comment}{    /// Broken assignment operator}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02811}\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a38e8e217e54cd435769ac7d88f3e95af}{02811}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a38e8e217e54cd435769ac7d88f3e95af}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix}{CCDoubleMatrix}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02812}02812 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02813}02813 \textcolor{comment}{    /// Destructor: Kill the LU factors if they have been setup.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02814}02814 \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a89019bdd7b9a64a2f32cd4efa07fe45c}{\string~CCDoubleMatrix}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02815}02815 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02816}02816 \textcolor{comment}{    /// Return the number of rows of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02817}\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_ab541153fa5ab2c1bc18e5339bacadfb9}{02817}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_ab541153fa5ab2c1bc18e5339bacadfb9}{nrow}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02818}02818 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02819}02819       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a21e22f93a942583ca83cea18c23bdd11}{CCMatrix<double>::nrow}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02820}02820     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02821}02821 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02822}02822 \textcolor{comment}{    /// Return the number of columns of the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02823}\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_aa38cc544ab30f9318161763e13c20957}{02823}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_aa38cc544ab30f9318161763e13c20957}{ncol}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02824}02824 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02825}02825       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1SparseMatrix_a4db71b6d794cfcee1624c15c09d62d7f}{CCMatrix<double>::ncol}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02826}02826     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02827}02827 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02828}02828 \textcolor{comment}{    /// Overload the round-\/bracket access operator to provide}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02829}02829 \textcolor{comment}{    /// read-\/only (const) access to the data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02830}\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a2fd1f3dfa66ed45be1ced60d2835634c}{02830}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a2fd1f3dfa66ed45be1ced60d2835634c}{operator()}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}},}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02831}02831                              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& j)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02832}02832 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02833}02833       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CCMatrix_a9b40b8a395a94be77939308cc413828a}{CCMatrix<double>::get\_entry}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02834}02834     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02835}02835 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02836}02836 \textcolor{comment}{    /// LU decomposition using SuperLU}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02837}02837 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_acb7c9b4e04b877b3ef40be905829eb41}{ludecompose}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02838}02838 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02839}02839 \textcolor{comment}{    /// LU back solve for given RHS}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02840}02840 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a59fbc30e6a856794cd2678856c8aea6d}{lubksub}}(\mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& rhs);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02841}02841 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02842}02842 \textcolor{comment}{    /// Multiply the matrix by the vector x: soln=Ax}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02843}02843 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_add24c25e344b84fb5b732e294af5e8b2}{multiply}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02844}02844 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02845}02845 \textcolor{comment}{    /// Multiply the  transposed matrix by the vector x: soln=A\string^T x}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02846}02846 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a582352912b0a7e097f9ac31c5054beed}{multiply\_transpose}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& soln) \textcolor{keyword}{const};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02847}02847 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02848}02848 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02849}02849 \textcolor{comment}{    /// Function to multiply this matrix by the CCDoubleMatrix matrix\_in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02850}02850 \textcolor{comment}{    /// The multiplication method used can be selected using the flag}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02851}02851 \textcolor{comment}{    /// Matrix\_matrix\_multiply\_method. By default Method 2 is used.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02852}02852 \textcolor{comment}{    /// Method 1: First runs through this matrix and matrix\_in to find the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02853}02853 \textcolor{comment}{    /// storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02854}02854 \textcolor{comment}{    ///           requirements for result -\/ arrays of the correct size are}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02855}02855 \textcolor{comment}{    ///           then allocated before performing the calculation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02856}02856 \textcolor{comment}{    ///           Minimises memory requirements but more costly.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02857}02857 \textcolor{comment}{    /// Method 2: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02858}02858 \textcolor{comment}{    ///           fly' using an array of maps. Faster but more memory}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02859}02859 \textcolor{comment}{    ///           intensive.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02860}02860 \textcolor{comment}{    /// Method 3: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02861}02861 \textcolor{comment}{    ///           fly' using a vector of vectors. Not particularly impressive}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02862}02862 \textcolor{comment}{    ///           on the platforms we tried...}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02863}02863 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_add24c25e344b84fb5b732e294af5e8b2}{multiply}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix}{CCDoubleMatrix}}\& matrix\_in, \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix}{CCDoubleMatrix}}\& result);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02864}02864 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02865}02865 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02866}02866 \textcolor{comment}{    /// For every row, find the maximum absolute value of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02867}02867 \textcolor{comment}{    /// entries in this row. Set all values that are less than alpha times}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02868}02868 \textcolor{comment}{    /// this maximum to zero and return the resulting matrix in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02869}02869 \textcolor{comment}{    /// reduced\_matrix. Note: Diagonal entries are retained regardless}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02870}02870 \textcolor{comment}{    /// of their size.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02871}02871 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a600a58c92baf401a534598cedcfd3415}{matrix\_reduction}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& alpha, \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix}{CCDoubleMatrix}}\& reduced\_matrix);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02872}02872 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02873}02873 \textcolor{comment}{    /// Access function to Matrix\_matrix\_multiply\_method, the flag}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02874}02874 \textcolor{comment}{    /// which determines the matrix matrix multiplication method used.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02875}02875 \textcolor{comment}{    /// Method 1: First runs through this matrix and matrix\_in to find the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02876}02876 \textcolor{comment}{    /// storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02877}02877 \textcolor{comment}{    ///           requirements for result -\/ arrays of the correct size are}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02878}02878 \textcolor{comment}{    ///           then allocated before performing the calculation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02879}02879 \textcolor{comment}{    ///           Minimises memory requirements but more costly.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02880}02880 \textcolor{comment}{    /// Method 2: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02881}02881 \textcolor{comment}{    ///           fly' using an array of maps. Faster but more memory}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02882}02882 \textcolor{comment}{    ///           intensive.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02883}02883 \textcolor{comment}{    /// Method 3: Grows storage for values and column indices of result 'on the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02884}02884 \textcolor{comment}{    ///           fly' using a vector of vectors. Not particularly impressive}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02885}02885 \textcolor{comment}{    ///           on the platforms we tried...}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02886}\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a7e3aada5f3737a9ffd2261c718964852}{02886}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_a7e3aada5f3737a9ffd2261c718964852}{matrix\_matrix\_multiply\_method}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02887}02887     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02888}02888       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_afb1660974c8f6218c2a000c2d6c6d267}{Matrix\_matrix\_multiply\_method}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02889}02889     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02890}02890 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02891}02891   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02892}02892 \textcolor{comment}{    /// Flag to determine which matrix-\/matrix multiplication method is used.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02893}\mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_afb1660974c8f6218c2a000c2d6c6d267}{02893}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1CCDoubleMatrix_afb1660974c8f6218c2a000c2d6c6d267}{Matrix\_matrix\_multiply\_method}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02894}02894   \};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02895}02895 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02896}02896 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02897}02897 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02898}02898 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02899}02899 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02900}02900 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02901}02901 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02902}02902   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02903}02903 \textcolor{comment}{  /// Constructor to build a square n by n matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02904}02904 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02905}02905   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02906}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a2291404def276dcee1a6099d054d44d6}{02906}}   \mbox{\hyperlink{classoomph_1_1DenseMatrix_aecfca835918b50b607e080fc706b6fcf}{DenseMatrix<T>::DenseMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02907}02907   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02908}02908     \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02909}02909     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02910}02910     M = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02911}02911     \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02912}02912     Matrixdata = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[n * n];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02913}02913     \textcolor{comment}{// Initialise to zero if required}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02914}02914 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02915}02915     initialise(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02916}02916 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02917}02917   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02918}02918 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02919}02919 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02920}02920   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02921}02921 \textcolor{comment}{  /// Constructor to build a matrix with n rows and m columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02922}02922 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02923}02923   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02924}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a5afcfd56a9720541e67a6e8d002016d4}{02924}}   \mbox{\hyperlink{classoomph_1_1DenseMatrix_aecfca835918b50b607e080fc706b6fcf}{DenseMatrix<T>::DenseMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02925}02925   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02926}02926     \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02927}02927     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02928}02928     M = m;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02929}02929     \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02930}02930     Matrixdata = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[n * m];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02931}02931 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02932}02932     initialise(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02933}02933 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02934}02934   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02935}02935 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02936}02936   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02937}02937 \textcolor{comment}{  /// Constructor to build a matrix with n rows and m columns,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02938}02938 \textcolor{comment}{  /// with initial value initial\_val}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02939}02939 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02940}02940   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02941}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a7b599610bd78a7818b2e4d0835b27e3a}{02941}}   \mbox{\hyperlink{classoomph_1_1DenseMatrix_aecfca835918b50b607e080fc706b6fcf}{DenseMatrix<T>::DenseMatrix}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02942}02942                               \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02943}02943                               \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_val)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02944}02944   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02945}02945     \textcolor{comment}{// Set row and column lengths}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02946}02946     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02947}02947     M = m;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02948}02948     \textcolor{comment}{// Assign space for the n rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02949}02949     Matrixdata = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[n * m];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02950}02950     initialise(initial\_val);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02951}02951   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02952}02952 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02953}02953 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02954}02954   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02955}02955 \textcolor{comment}{  /// Resize to a non-\/square n\_row x m\_col matrix,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02956}02956 \textcolor{comment}{  /// where any values already present will be transfered.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02957}02957 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02958}02958   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02959}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a0f01dd97b1c71868371f93259efc26b0}{02959}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_adec1ef741b1c5048a12ba9a540c2719c}{DenseMatrix<T>::resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02960}02960   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02961}02961     \textcolor{comment}{// If the sizes are the same, do nothing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02962}02962     \textcolor{keywordflow}{if} ((n == \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}) \&\& (m == M))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02963}02963     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02964}02964       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02965}02965     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02966}02966     \textcolor{comment}{// Store old sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02967}02967     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_old = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}, m\_old = M;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02968}02968     \textcolor{comment}{// Reassign the sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02969}02969     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02970}02970     M = m;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02971}02971     \textcolor{comment}{// Store double pointer to old matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02972}02972     \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* temp\_matrix = Matrixdata;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02973}02973 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02974}02974     \textcolor{comment}{// Re-\/create Matrixdata in new size}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02975}02975     Matrixdata = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[n * m];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02976}02976     \textcolor{comment}{// Initialise to zero}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02977}02977 \textcolor{preprocessor}{\#ifdef OOMPH\_INITIALISE\_DENSE\_MATRICES}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02978}02978     initialise(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0));}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02979}02979 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02980}02980 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02981}02981     \textcolor{comment}{// Transfer previously existing values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02982}02982     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_copy, m\_copy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02983}02983     n\_copy = std::min(n\_old, n);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02984}02984     m\_copy = std::min(m\_old, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02985}02985 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02986}02986     \textcolor{comment}{// If matrix has values, transfer them to new matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02987}02987     \textcolor{comment}{// Loop over rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02988}02988     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_copy; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02989}02989     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02990}02990       \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02991}02991       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < m\_copy; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02992}02992       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02993}02993         \textcolor{comment}{// Transfer values from temp\_matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02994}02994         Matrixdata[m * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j] = temp\_matrix[m\_old * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02995}02995       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02996}02996     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02997}02997 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02998}02998     \textcolor{comment}{// Now kill storage for old matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l02999}02999     \textcolor{keyword}{delete}[] temp\_matrix;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03000}03000   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03001}03001 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03002}03002 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03003}03003   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03004}03004 \textcolor{comment}{  /// Resize to a non-\/square n\_row x m\_col matrix and initialize the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03005}03005 \textcolor{comment}{  /// new entries to specified value.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03006}03006 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03007}03007   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03008}\mbox{\hyperlink{classoomph_1_1DenseMatrix_aeb6daf6539fee8d3d6f7a81306798b10}{03008}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_adec1ef741b1c5048a12ba9a540c2719c}{DenseMatrix<T>::resize}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03009}03009                               \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03010}03010                               \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}\& initial\_value)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03011}03011   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03012}03012     \textcolor{comment}{// If the size is not changed, just return}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03013}03013     \textcolor{keywordflow}{if} ((n == \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}) \&\& (m == M))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03014}03014     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03015}03015       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03016}03016     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03017}03017     \textcolor{comment}{// Store old sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03018}03018     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_old = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}, m\_old = M;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03019}03019     \textcolor{comment}{// Reassign the sizes}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03020}03020     \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03021}03021     M = m;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03022}03022     \textcolor{comment}{// Store double pointer to old matrix data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03023}03023     \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* temp\_matrix = Matrixdata;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03024}03024     \textcolor{comment}{// Re-\/create Matrixdata in new size}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03025}03025     Matrixdata = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[n * m];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03026}03026     \textcolor{comment}{// Assign initial value (will use the newly allocated data)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03027}03027     initialise(initial\_value);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03028}03028 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03029}03029     \textcolor{comment}{// Transfering values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03030}03030     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_copy, m\_copy;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03031}03031     n\_copy = std::min(n\_old, n);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03032}03032     m\_copy = std::min(m\_old, m);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03033}03033     \textcolor{comment}{// If matrix has values, transfer them to temp\_matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03034}03034     \textcolor{comment}{// Loop over rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03035}03035     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_copy; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03036}03036     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03037}03037       \textcolor{comment}{// Loop over columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03038}03038       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} j = 0; j < m\_copy; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03039}03039       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03040}03040         \textcolor{comment}{// Transfer values to temp\_matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03041}03041         Matrixdata[m * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j] = temp\_matrix[m\_old * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03042}03042       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03043}03043     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03044}03044 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03045}03045     \textcolor{comment}{// Now kill storage for old matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03046}03046     \textcolor{keyword}{delete}[] temp\_matrix;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03047}03047   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03048}03048 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03049}03049 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03050}03050   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03051}03051 \textcolor{comment}{  /// Output function to print a matrix row-\/by-\/row to the stream outfile}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03052}03052 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03053}03053   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03054}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a03e20626e889a1ab4582614f55784165}{03054}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a03e20626e889a1ab4582614f55784165}{DenseMatrix<T>::output}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03055}03055 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03056}03056     \textcolor{comment}{// Loop over the rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03057}03057     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03058}03058     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03059}03059       \textcolor{comment}{// Loop over the columne}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03060}03060       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < M; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03061}03061       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03062}03062         outfile << (*this)(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03063}03063       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03064}03064       \textcolor{comment}{// Put in a newline}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03065}03065       outfile << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03066}03066     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03067}03067   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03068}03068 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03069}03069 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03070}03070   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03071}03071 \textcolor{comment}{  /// Output function to print a matrix row-\/by-\/row to a file. Specify filename.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03072}03072 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03073}03073   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03074}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a4ab60b1e7db98bcb5b75b080266e452e}{03074}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a03e20626e889a1ab4582614f55784165}{DenseMatrix<T>::output}}(\mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} filename)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03075}03075 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03076}03076     \textcolor{comment}{// Open file}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03077}03077     std::ofstream some\_file;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03078}03078     some\_file.open(filename.c\_str());}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03079}03079 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03080}03080     \mbox{\hyperlink{namespaceoomph_1_1CommandLineArgs_aca07d359a96b9c7b566142112604ea87}{output}}(some\_file);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03081}03081     some\_file.close();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03082}03082   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03083}03083 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03084}03084 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03085}03085   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03086}03086 \textcolor{comment}{  /// Indexed output as i,j,a(i,j)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03087}03087 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03088}03088   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03089}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a440b549690cfc07c85f395eb06951321}{03089}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a440b549690cfc07c85f395eb06951321}{DenseMatrix<T>::indexed\_output}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03090}03090 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03091}03091     \textcolor{comment}{// Loop over the rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03092}03092     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03093}03093     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03094}03094       \textcolor{comment}{// Loop over the columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03095}03095       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < M; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03096}03096       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03097}03097         outfile << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} "{}} << j << \textcolor{stringliteral}{"{} "{}} << (*this)(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03098}03098       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03099}03099     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03100}03100   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03101}03101 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03102}03102 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03103}03103   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03104}03104 \textcolor{comment}{  /// Indexed output function to print a matrix to a}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03105}03105 \textcolor{comment}{  /// file as i,j,a(i,j). Specify filename.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03106}03106 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03107}03107   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03108}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a5730d359fa98ea501ab7115147a4bd87}{03108}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a440b549690cfc07c85f395eb06951321}{DenseMatrix<T>::indexed\_output}}(\mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} filename)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03109}03109 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03110}03110     \textcolor{comment}{// Open file}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03111}03111     std::ofstream some\_file;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03112}03112     some\_file.open(filename.c\_str());}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03113}03113     indexed\_output(some\_file);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03114}03114     some\_file.close();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03115}03115   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03116}03116 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03117}03117 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03118}03118   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03119}03119 \textcolor{comment}{  /// Output the "{}bottom right"{} entry regardless of it being}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03120}03120 \textcolor{comment}{  /// zero or not (this allows automatic detection of matrix size in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03121}03121 \textcolor{comment}{  /// e.g. matlab, python).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03122}03122 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03123}03123   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03124}\mbox{\hyperlink{classoomph_1_1DenseMatrix_aa02dc7c9b2f4e1cc1204cc8281f030f9}{03124}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_aa02dc7c9b2f4e1cc1204cc8281f030f9}{DenseMatrix<T>::output\_bottom\_right\_zero\_helper}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03125}03125     std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03126}03126 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03127}03127     \textcolor{keywordtype}{int} last\_row = this-\/>\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} -\/ 1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03128}03128     \textcolor{keywordtype}{int} last\_col = this-\/>M -\/ 1;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03129}03129 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03130}03130     \textcolor{comment}{// Use this strange thingy because of the CRTP discussed above.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03131}03131     \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} last\_value = this-\/>operator()(last\_row, last\_col);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03132}03132 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03133}03133     \textcolor{keywordflow}{if} (last\_value == \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03134}03134     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03135}03135       outfile << last\_row << \textcolor{stringliteral}{"{} "{}} << last\_col << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0) << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03136}03136     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03137}03137   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03138}03138 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03139}03139   \textcolor{comment}{//============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03140}03140 \textcolor{comment}{  /// Sparse indexed output as i,j,a(i,j) for a(i,j)!=0 only.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03141}03141 \textcolor{comment}{}  \textcolor{comment}{//============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03142}03142   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03143}\mbox{\hyperlink{classoomph_1_1DenseMatrix_a6e9084acc11e036d4c5f7e5322d12034}{03143}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1DenseMatrix_a6e9084acc11e036d4c5f7e5322d12034}{DenseMatrix<T>::sparse\_indexed\_output\_helper}}(std::ostream\& outfile)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03144}03144 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03145}03145     \textcolor{comment}{// Loop over the rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03146}03146     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03147}03147     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03148}03148       \textcolor{comment}{// Loop over the column}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03149}03149       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < M; j++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03150}03150       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03151}03151         \textcolor{keywordflow}{if} ((*\textcolor{keyword}{this})(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) != \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0))}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03152}03152         \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03153}03153           outfile << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} "{}} << j << \textcolor{stringliteral}{"{} "{}} << (*this)(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, j) << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03154}03154         \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03155}03155       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03156}03156     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03157}03157   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03158}03158 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03159}03159 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03160}03160 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03161}03161 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03162}03162 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03163}03163 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03164}03164 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03165}03165   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03166}03166 \textcolor{comment}{  /// Wipe matrix data and set all values to 0.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03167}03167 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03168}03168   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03169}\mbox{\hyperlink{classoomph_1_1CCMatrix_af3f7a40493a8576558e211c681b1ca3c}{03169}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_af3f7a40493a8576558e211c681b1ca3c}{CCMatrix<T>::clean\_up\_memory}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03170}03170   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03171}03171     \textcolor{comment}{// delete any previously allocated  storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03172}03172     \textcolor{keywordflow}{if} (this-\/>Value != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03173}03173     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03174}03174       \textcolor{keyword}{delete}[] this-\/>Value;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03175}03175       this-\/>Value = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03176}03176     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03177}03177     \textcolor{keywordflow}{if} (this-\/>Row\_index != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03178}03178     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03179}03179       \textcolor{keyword}{delete}[] this-\/>Row\_index;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03180}03180       this-\/>Row\_index = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03181}03181     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03182}03182     \textcolor{keywordflow}{if} (this-\/>Column\_start != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03183}03183     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03184}03184       \textcolor{keyword}{delete}[] this-\/>Column\_start;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03185}03185       this-\/>Column\_start = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03186}03186     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03187}03187     this-\/>Nnz = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03188}03188     this-\/>\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03189}03189     this-\/>M = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03190}03190   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03191}03191 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03192}03192 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03193}03193   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03194}03194 \textcolor{comment}{  /// Build matrix from compressed representation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03195}03195 \textcolor{comment}{  /// Note that, as the name suggests, this function does not}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03196}03196 \textcolor{comment}{  /// make a copy of the data pointed to by the first three arguments!}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03197}03197 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03198}03198   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03199}\mbox{\hyperlink{classoomph_1_1CCMatrix_a57eddb79a6a3af698a1c92196482335a}{03199}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_a57eddb79a6a3af698a1c92196482335a}{CCMatrix<T>::build\_without\_copy}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* value,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03200}03200                                        \textcolor{keywordtype}{int}* row\_index,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03201}03201                                        \textcolor{keywordtype}{int}* column\_start,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03202}03202                                        \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& nnz,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03203}03203                                        \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03204}03204                                        \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03205}03205   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03206}03206     \textcolor{comment}{// Number of nonzero entries}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03207}03207     this-\/>Nnz = nnz;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03208}03208 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03209}03209     \textcolor{comment}{// Number of rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03210}03210     this-\/>\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03211}03211 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03212}03212     \textcolor{comment}{// Number of columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03213}03213     this-\/>M = m;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03214}03214 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03215}03215     \textcolor{comment}{// delete any previously allocated  storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03216}03216     \textcolor{keywordflow}{if} (this-\/>Value != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03217}03217     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03218}03218       \textcolor{keyword}{delete}[] this-\/>Value;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03219}03219     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03220}03220     \textcolor{keywordflow}{if} (this-\/>Row\_index != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03221}03221     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03222}03222       \textcolor{keyword}{delete}[] this-\/>Row\_index;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03223}03223     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03224}03224     \textcolor{keywordflow}{if} (this-\/>Column\_start != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03225}03225     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03226}03226       \textcolor{keyword}{delete}[] this-\/>Column\_start;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03227}03227     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03228}03228 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03229}03229     \textcolor{comment}{// set Value}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03230}03230     this-\/>Value = value;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03231}03231 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03232}03232     \textcolor{comment}{// set Row\_index}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03233}03233     this-\/>Row\_index = row\_index;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03234}03234 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03235}03235     \textcolor{comment}{// set Column\_start}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03236}03236     this-\/>Column\_start = column\_start;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03237}03237   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03238}03238 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03239}03239 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03240}03240   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03241}03241 \textcolor{comment}{  /// Build matrix from compressed representation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03242}03242 \textcolor{comment}{  /// Number of nonzero entries is read}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03243}03243 \textcolor{comment}{  /// off from value, so make sure the vector has been shrunk}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03244}03244 \textcolor{comment}{  /// to its correct length.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03245}03245 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03246}03246   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03247}\mbox{\hyperlink{classoomph_1_1CCMatrix_aa08192365e3c87357d1f7ca8131f03de}{03247}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CCMatrix_aa08192365e3c87357d1f7ca8131f03de}{CCMatrix<T>::build}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<T>}}\& value,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03248}03248                           \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& row\_index\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03249}03249                           \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& column\_start\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03250}03250                           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03251}03251                           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03252}03252   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03253}03253 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03254}03254     \textcolor{keywordflow}{if} (value.size() != row\_index\_.size())}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03255}03255     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03256}03256       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03257}03257       error\_message << \textcolor{stringliteral}{"{}length of value "{}} << value.size()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03258}03258                     << \textcolor{stringliteral}{"{} and row\_index vectors "{}} << row\_index\_.size()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03259}03259                     << \textcolor{stringliteral}{"{} should match "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03260}03260 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03261}03261       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03262}03262         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03263}03263     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03264}03264 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03265}03265 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03266}03266     \textcolor{comment}{// Number of nonzero entries}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03267}03267     this-\/>Nnz = value.size();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03268}03268 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03269}03269     \textcolor{comment}{// Number of rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03270}03270     this-\/>\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03271}03271 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03272}03272     \textcolor{comment}{// Number of columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03273}03273     this-\/>M = m;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03274}03274 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03275}03275     \textcolor{comment}{// We need to delete any previously allocated  storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03276}03276     \textcolor{keywordflow}{if} (this-\/>Value != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03277}03277     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03278}03278       \textcolor{keyword}{delete}[] this-\/>Value;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03279}03279     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03280}03280     \textcolor{keywordflow}{if} (this-\/>Row\_index != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03281}03281     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03282}03282       \textcolor{keyword}{delete}[] this-\/>Row\_index;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03283}03283     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03284}03284     \textcolor{keywordflow}{if} (this-\/>Column\_start != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03285}03285     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03286}03286       \textcolor{keyword}{delete}[] this-\/>Column\_start;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03287}03287     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03288}03288 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03289}03289     \textcolor{comment}{// Values stored in C-\/style array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03290}03290     this-\/>Value = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[this-\/>Nnz];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03291}03291 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03292}03292     \textcolor{comment}{// Row indices stored in C-\/style array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03293}03293     this-\/>Row\_index = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[this-\/>Nnz];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03294}03294 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03295}03295     \textcolor{comment}{// Assign:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03296}03296     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < this-\/>Nnz; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03297}03297     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03298}03298       this-\/>Value[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = value[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03299}03299       this-\/>Row\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = row\_index\_[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03300}03300     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03301}03301 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03302}03302     \textcolor{comment}{// Column start:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03303}03303     \textcolor{comment}{// Find the size and aollcate}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03304}03304     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_column\_start = column\_start\_.size();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03305}03305     this-\/>Column\_start = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[n\_column\_start];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03306}03306 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03307}03307     \textcolor{comment}{// Assign:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03308}03308     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_column\_start; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03309}03309     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03310}03310       this-\/>Column\_start[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = column\_start\_[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03311}03311     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03312}03312   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03313}03313 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03314}03314 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03315}03315 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03316}03316 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03317}03317 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03318}03318 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03319}03319   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03320}03320 \textcolor{comment}{  /// Wipe matrix data and set all values to 0.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03321}03321 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03322}03322   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03323}\mbox{\hyperlink{classoomph_1_1CRMatrix_a14f6cf02e78e14afc9a50eb73c6d517a}{03323}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_a14f6cf02e78e14afc9a50eb73c6d517a}{CRMatrix<T>::clean\_up\_memory}}()}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03324}03324   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03325}03325     \textcolor{comment}{// delete any previously allocated  storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03326}03326     \textcolor{keywordflow}{if} (this-\/>Value != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03327}03327     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03328}03328       \textcolor{keyword}{delete}[] this-\/>Value;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03329}03329       this-\/>Value = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03330}03330     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03331}03331     \textcolor{keywordflow}{if} (this-\/>Column\_index != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03332}03332     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03333}03333       \textcolor{keyword}{delete}[] this-\/>Column\_index;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03334}03334       this-\/>Column\_index = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03335}03335     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03336}03336     \textcolor{keywordflow}{if} (this-\/>Row\_start != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03337}03337     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03338}03338       \textcolor{keyword}{delete}[] this-\/>Row\_start;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03339}03339       this-\/>Row\_start = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03340}03340     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03341}03341     this-\/>Nnz = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03342}03342     this-\/>\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03343}03343     this-\/>M = 0;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03344}03344   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03345}03345 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03346}03346 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03347}03347   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03348}03348 \textcolor{comment}{  /// Function to build a CRMatrix from pointers to arrays which hold the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03349}03349 \textcolor{comment}{  /// row starts, column indices and non-\/zero values}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03350}03350 \textcolor{comment}{  /// Note that, as the name suggests, this function does not}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03351}03351 \textcolor{comment}{  /// make a copy of the data pointed to by the first three arguments!}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03352}03352 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03353}03353   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03354}\mbox{\hyperlink{classoomph_1_1CRMatrix_aee41b01876f3b8ce9011e6fe7a332da6}{03354}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_aee41b01876f3b8ce9011e6fe7a332da6}{CRMatrix<T>::build\_without\_copy}}(\mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}* value,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03355}03355                                        \textcolor{keywordtype}{int}* column\_index\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03356}03356                                        \textcolor{keywordtype}{int}* row\_start\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03357}03357                                        \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& nnz,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03358}03358                                        \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03359}03359                                        \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03360}03360   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03361}03361     \textcolor{comment}{// Number of nonzero entries}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03362}03362     this-\/>Nnz = nnz;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03363}03363 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03364}03364     \textcolor{comment}{// Number of rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03365}03365     this-\/>\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03366}03366 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03367}03367     \textcolor{comment}{// Number of columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03368}03368     this-\/>M = m;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03369}03369 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03370}03370     \textcolor{comment}{// delete any previously allocated  storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03371}03371     \textcolor{keywordflow}{if} (this-\/>Value != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03372}03372     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03373}03373       \textcolor{keyword}{delete}[] this-\/>Value;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03374}03374     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03375}03375     \textcolor{keywordflow}{if} (this-\/>Column\_index != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03376}03376     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03377}03377       \textcolor{keyword}{delete}[] this-\/>Column\_index;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03378}03378     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03379}03379     \textcolor{keywordflow}{if} (this-\/>Row\_start != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03380}03380     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03381}03381       \textcolor{keyword}{delete}[] this-\/>Row\_start;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03382}03382     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03383}03383 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03384}03384     \textcolor{comment}{// set Value}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03385}03385     this-\/>Value = value;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03386}03386 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03387}03387     \textcolor{comment}{// set Column\_index}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03388}03388     this-\/>Column\_index = column\_index\_;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03389}03389 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03390}03390     \textcolor{comment}{// set Row\_start}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03391}03391     this-\/>Row\_start = row\_start\_;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03392}03392   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03393}03393 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03394}03394 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03395}03395   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03396}03396 \textcolor{comment}{  /// Build matrix from compressed representation.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03397}03397 \textcolor{comment}{  /// Number of nonzero entries is read}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03398}03398 \textcolor{comment}{  /// off from value, so make sure the vector has been shrunk}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03399}03399 \textcolor{comment}{  /// to its correct length. The optional final}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03400}03400 \textcolor{comment}{  /// parameter specifies the number of columns. If it is not specified}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03401}03401 \textcolor{comment}{  /// the matrix is assumed to be quadratic.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03402}03402 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03403}03403   \textcolor{keyword}{template}<\textcolor{keyword}{class} T>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03404}\mbox{\hyperlink{classoomph_1_1CRMatrix_a73e05d0fc4fe5fb402416b18f17316b8}{03404}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1CRMatrix_a73e05d0fc4fe5fb402416b18f17316b8}{CRMatrix<T>::build}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<T>}}\& value,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03405}03405                           \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& column\_index\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03406}03406                           \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& row\_start\_,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03407}03407                           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& n,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03408}03408                           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long}\& m)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03409}03409   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03410}03410 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03411}03411     \textcolor{keywordflow}{if} (value.size() != column\_index\_.size())}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03412}03412     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03413}03413       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03414}03414       error\_message << \textcolor{stringliteral}{"{}Must have the same number of values and column indices,"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03415}03415                     << \textcolor{stringliteral}{"{}we have "{}} << value.size() << \textcolor{stringliteral}{"{} values and "{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03416}03416                     << column\_index\_.size() << \textcolor{stringliteral}{"{} column inidicies."{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03417}03417                     << std::endl;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03418}03418       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03419}03419         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03420}03420     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03421}03421 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03422}03422     \textcolor{comment}{// Number of nonzero entries}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03423}03423     this-\/>Nnz = value.size();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03424}03424 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03425}03425     \textcolor{comment}{// Number of rows}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03426}03426     this-\/>\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} = n;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03427}03427 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03428}03428     \textcolor{comment}{// Number of columns}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03429}03429     this-\/>M = m;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03430}03430 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03431}03431     \textcolor{comment}{// We need to delete any previously allocated  storage}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03432}03432     \textcolor{keywordflow}{if} (this-\/>Value != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03433}03433     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03434}03434       \textcolor{keyword}{delete}[] this-\/>Value;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03435}03435     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03436}03436     \textcolor{keywordflow}{if} (this-\/>Column\_index != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03437}03437     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03438}03438       \textcolor{keyword}{delete}[] this-\/>Column\_index;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03439}03439     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03440}03440     \textcolor{keywordflow}{if} (this-\/>Row\_start != 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03441}03441     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03442}03442       \textcolor{keyword}{delete}[] this-\/>Row\_start;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03443}03443     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03444}03444 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03445}03445     \textcolor{comment}{// Values stored in C-\/style array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03446}03446     this-\/>Value = \textcolor{keyword}{new} \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}[this-\/>Nnz];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03447}03447 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03448}03448     \textcolor{comment}{// Column indices stored in C-\/style array}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03449}03449     this-\/>Column\_index = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[this-\/>Nnz];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03450}03450 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03451}03451     \textcolor{comment}{// Assign:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03452}03452     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < this-\/>Nnz; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03453}03453     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03454}03454       this-\/>Value[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = value[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03455}03455       this-\/>Column\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = column\_index\_[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03456}03456     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03457}03457 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03458}03458     \textcolor{comment}{// Row start:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03459}03459     \textcolor{comment}{// Find the size and allocate}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03460}03460     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_row\_start = row\_start\_.size();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03461}03461     this-\/>Row\_start = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[n\_row\_start];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03462}03462 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03463}03463     \textcolor{comment}{// Assign:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03464}03464     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_row\_start; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03465}03465     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03466}03466       this-\/>Row\_start[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = row\_start\_[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03467}03467     \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03468}03468   \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03469}03469 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03470}03470 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03471}03471   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03472}03472 \textcolor{comment}{  /// Dummy zero}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03473}03473 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03474}03474   \textcolor{keyword}{template}<\textcolor{keyword}{class} T, \textcolor{keyword}{class} MATRIX\_TYPE>}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03475}03475   \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}} \mbox{\hyperlink{classoomph_1_1SparseMatrix}{SparseMatrix<T, MATRIX\_TYPE>::Zero}} = \mbox{\hyperlink{namespaceoomph_1_1ElementGeometry_a86ff99972b0205d7524e294c58c1182aa9c3705b667836ab13e1b3b81a3eb28b8}{T}}(0);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03476}03476 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03477}03477 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03478}\mbox{\hyperlink{namespaceoomph_1_1RRR}{03478}}   \textcolor{keyword}{namespace }RRR}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03479}03479   \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03480}03480     \textcolor{keyword}{extern} \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} \mbox{\hyperlink{namespaceoomph_1_1RRR_aeb3f04d09ecf50524c3a913b35a10f82}{RayStr}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03481}03481     \textcolor{keyword}{extern} \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespaceoomph_1_1RRR_ae792a9ead71fdc3c728f5cf843c257d3}{RayBool}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03482}03482   \} \textcolor{comment}{// namespace RRR}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03483}03483 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03484}03484   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03485}03485 \textcolor{comment}{  /// Namespace for helper functions for CRDoubleMatrices}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03486}03486 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03487}03487   \textcolor{keyword}{namespace }CRDoubleMatrixHelpers}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03488}03488   \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03489}03489 \textcolor{comment}{    /// Create a deep copy of the matrix pointed to by in\_matrix\_pt}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03490}\mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_a157511f700993ab8bc014f9d0d44f4c7}{03490}} \textcolor{comment}{}    \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_a157511f700993ab8bc014f9d0d44f4c7}{deep\_copy}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}* \textcolor{keyword}{const} in\_matrix\_pt,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03491}03491                           \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& out\_matrix)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03492}03492     \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03493}03493 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03494}03494       \textcolor{comment}{// Is the out matrix built? We need an empty out matrix!}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03495}03495       \textcolor{keywordflow}{if} (out\_matrix.\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aa0503bc64ef0ccb60cb7d7e645425a62}{built}}())}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03496}03496       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03497}03497         std::ostringstream err\_msg;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03498}03498         err\_msg << \textcolor{stringliteral}{"{}The result matrix has been built.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03499}03499                 << \textcolor{stringliteral}{"{}Please clear the matrix.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03500}03500         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03501}03501           err\_msg.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03502}03502       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03503}03503 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03504}03504       \textcolor{comment}{// Check that the in matrix pointer is not null.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03505}03505       \textcolor{keywordflow}{if} (in\_matrix\_pt == 0)}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03506}03506       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03507}03507         std::ostringstream err\_msg;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03508}03508         err\_msg << \textcolor{stringliteral}{"{}The in\_matrix\_pt is null.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03509}03509         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03510}03510           err\_msg.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03511}03511       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03512}03512 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03513}03513       \textcolor{comment}{// Check that the in matrix is built.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03514}03514       \textcolor{keywordflow}{if} (!in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aa0503bc64ef0ccb60cb7d7e645425a62}{built}}())}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03515}03515       \{}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03516}03516         std::ostringstream err\_msg;}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03517}03517         err\_msg << \textcolor{stringliteral}{"{}The in\_matrix\_pt is null.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03518}03518         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03519}03519           err\_msg.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03520}03520       \}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03521}03521 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03522}03522 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03523}03523       \textcolor{comment}{// First set the matrix matrix multiply methods (for both serial and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03524}03524       \textcolor{comment}{// distributed)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03525}03525       out\_matrix.\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a0b77e4dd1d6633d68264c0f41fc0e5e7}{serial\_matrix\_matrix\_multiply\_method}}() =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03526}03526         in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a0b77e4dd1d6633d68264c0f41fc0e5e7}{serial\_matrix\_matrix\_multiply\_method}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03527}03527 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03528}03528       out\_matrix.\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a5c1850605f916040619230a5760dc6be}{distributed\_matrix\_matrix\_multiply\_method}}() =}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03529}03529         in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a5c1850605f916040619230a5760dc6be}{distributed\_matrix\_matrix\_multiply\_method}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03530}03530 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03531}03531 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03532}03532       \textcolor{comment}{// The local nrow and nnz of the in matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03533}03533       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} in\_nrow\_local = in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_a9bd7e1d242c69a28da85a804a7717fce}{nrow\_local}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03534}03534       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} in\_nnz = in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a9482dafc0a17ebc5b7431369d8d07565}{nnz}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03535}03535 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03536}03536       \textcolor{comment}{// Storage for the values, column indices and row start}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03537}03537       \textcolor{keywordtype}{double}* out\_values = \textcolor{keyword}{new} \textcolor{keywordtype}{double}[in\_nnz];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03538}03538       \textcolor{keywordtype}{int}* out\_column\_indices = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[in\_nnz];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03539}03539       \textcolor{keywordtype}{int}* out\_row\_start = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[in\_nrow\_local + 1];}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03540}03540 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03541}03541       \textcolor{comment}{// The data to copy over}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03542}03542       \textcolor{keyword}{const} \textcolor{keywordtype}{double}* \textcolor{keyword}{const} in\_values = in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafc5f1896dc3a317cdeddb067290c796}{value}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03543}03543       \textcolor{keyword}{const} \textcolor{keywordtype}{int}* \textcolor{keyword}{const} in\_column\_indices = in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a925b465e7e86cf1ec45c1fb70a37c105}{column\_index}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03544}03544       \textcolor{keyword}{const} \textcolor{keywordtype}{int}* \textcolor{keyword}{const} in\_row\_start = in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a31a5d05c00d653a02e7b07714472d372}{row\_start}}();}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03545}03545 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03546}03546       \textcolor{comment}{// Copy the data}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03547}03547       std::copy(in\_values, in\_values + in\_nnz, out\_values);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03548}03548 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03549}03549       std::copy(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03550}03550         in\_column\_indices, in\_column\_indices + in\_nnz, out\_column\_indices);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03551}03551 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03552}03552       std::copy(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03553}03553         in\_row\_start, in\_row\_start + (in\_nrow\_local + 1), out\_row\_start);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03554}03554 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03555}03555       \textcolor{comment}{// Build the matrix}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03556}03556       out\_matrix.\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_af44bac2acd071317f96dae49cbb0d977}{build}}(in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}());}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03557}03557 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03558}03558       out\_matrix.\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_aafb4d7de0a87b4bda560928e6a128060}{build\_without\_copy}}(in\_matrix\_pt-\/>\mbox{\hyperlink{classoomph_1_1CRDoubleMatrix_a4ed5597d8a34dd14f90b0e6cfb88ca2e}{ncol}}(),}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03559}03559                                     in\_nnz,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03560}03560                                     out\_values,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03561}03561                                     out\_column\_indices,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03562}03562                                     out\_row\_start);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03563}03563 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03564}03564       \textcolor{comment}{// The only thing we haven't copied over is the default linear solver}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03565}03565       \textcolor{comment}{// pointer, but I cannot figure out how to copy over a solver since}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03566}03566       \textcolor{comment}{// I do not know what it is.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03567}03567     \} \textcolor{comment}{// EoFunc deep\_copy}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03568}03568 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03569}03569 \textcolor{comment}{    /// Builds a uniformly distributed matrix.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03570}03570 \textcolor{comment}{    /// A locally replicated matrix is constructed then redistributed using}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03571}03571 \textcolor{comment}{    /// OOMPH-\/LIB's default uniform row distribution.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03572}03572 \textcolor{comment}{    /// This is memory intensive thus should be used for}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03573}03573 \textcolor{comment}{    /// testing or small problems only.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03574}03574 \textcolor{comment}{    /// The resulting matrix (mat\_out) must not have been built.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03575}03575 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_ae3c10e59d5857457c7e34be8e9262035}{create\_uniformly\_distributed\_matrix}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03576}03576       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nrow,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03577}03577       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& ncol,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03578}03578       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1OomphCommunicator}{OomphCommunicator}}* \textcolor{keyword}{const} comm\_pt,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03579}03579       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& values,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03580}03580       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& column\_indicies,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03581}03581       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}}\& row\_start,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03582}03582       \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& mat\_out);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03583}03583 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03584}03584 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03585}03585 \textcolor{comment}{    /// Calculates the infinity (maximum) norm of a DenseMartrix of}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03586}03586 \textcolor{comment}{    /// CRDoubleMatrices as if it was one large matrix.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03587}03587 \textcolor{comment}{    /// This avoids creating a concatenation of the sub-\/blocks just to calculate}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03588}03588 \textcolor{comment}{    /// the infinity norm.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03589}03589 \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_1_1CRDoubleMatrixHelpers_ab17222c9461096e3d5b8cf6250524644}{inf\_norm}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<CRDoubleMatrix*>}}\& matrix\_pt);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03590}03590 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03591}03591 \textcolor{comment}{    /// Calculates the largest Gershgorin disc whilst preserving the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03592}03592 \textcolor{comment}{    /// sign. Let A be an n by n matrix, with entries aij. For \(\backslash\)f\$ i \(\backslash\)in \(\backslash\)\{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03593}\mbox{\hyperlink{namespaceoomph_a574d5c40e6181073e528848c30e15f63}{03593}} \textcolor{comment}{    /// 1,...,n \(\backslash\)\} \(\backslash\)f\$ let \(\backslash\)f\$ R\_i = \(\backslash\)sum\_\{i\(\backslash\)neq j\}|a\_\{ij\}| \(\backslash\)f\$ be the sum of}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03594}03594 \textcolor{comment}{    /// the absolute values of the non-\/diagonal entries in the i-\/th row. Let \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03595}03595 \textcolor{comment}{    /// D(a\_\{ii\},R\_i) \(\backslash\)f\$ be the closed disc centered at \(\backslash\)f\$ a\_\{ii\} \(\backslash\)f\$ with}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03596}03596 \textcolor{comment}{    /// radius \(\backslash\)f\$ R\_i \(\backslash\)f\$, such a disc is called a Gershgorin disc.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03597}03597 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03598}03598 \textcolor{comment}{    /// \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03599}03599 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03600}03600 \textcolor{comment}{    /// We calculate \(\backslash\)f\$ |D(a\_\{ii\},R\_i)|\_\{max\} \(\backslash\)f\$and multiply by the sign of}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03601}03601 \textcolor{comment}{    /// the diagonal entry.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03602}03602 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03603}03603 \textcolor{comment}{    /// \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03604}03604 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03605}03605 \textcolor{comment}{    /// The DenseMatrix of CRDoubleMatrices are treated as if they are one}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03606}03606 \textcolor{comment}{    /// large matrix. Therefore the dimensions of the sub matrices has to}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03607}03607 \textcolor{comment}{    /// "{}make sense"{}, there is a paranoid check for this.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03608}03608 \textcolor{comment}{}    \textcolor{keywordtype}{double} gershgorin\_eigenvalue\_estimate(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03609}03609       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<CRDoubleMatrix*>}}\& matrix\_pt);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03610}03610 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03611}03611 \textcolor{comment}{    /// Concatenate CRDoubleMatrix matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03612}03612 \textcolor{comment}{    /// The in matrices are concatenated such that the block structure of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03613}03613 \textcolor{comment}{    /// in matrices are preserved in the result matrix. Communication between}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03614}03614 \textcolor{comment}{    /// processors is required. If the block structure of the sub matrices does}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03615}03615 \textcolor{comment}{    /// not need to be preserved, consider using}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03616}03616 \textcolor{comment}{    /// CRDoubleMatrixHelpers::concatenate\_without\_communication(...).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03617}03617 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03618}03618 \textcolor{comment}{    /// The matrix manipulation functions}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03619}03619 \textcolor{comment}{    /// CRDoubleMatrixHelpers::concatenate(...) and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03620}03620 \textcolor{comment}{    /// CRDoubleMatrixHelpers::concatenate\_without\_communication(...)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03621}03621 \textcolor{comment}{    /// are analogous to the Vector manipulation functions}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03622}03622 \textcolor{comment}{    /// DoubleVectorHelpers::concatenate(...) and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03623}03623 \textcolor{comment}{    /// DoubleVectorHelpers::concatenate\_without\_communication(...).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03624}03624 \textcolor{comment}{    /// Please look at the DoubleVector functions for an illustration of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03625}03625 \textcolor{comment}{    /// differences between concatenate(...) and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03626}03626 \textcolor{comment}{    /// concatenate\_without\_communication(...).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03627}03627 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03628}03628 \textcolor{comment}{    /// Distribution of the result matrix:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03629}03629 \textcolor{comment}{    /// If the result matrix does not have a distribution built, then it will be}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03630}03630 \textcolor{comment}{    /// given a uniform row distribution. Otherwise we use the existing}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03631}03631 \textcolor{comment}{    /// distribution. This gives the user the ability to define their own}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03632}03632 \textcolor{comment}{    /// distribution, or save computing power if a distribution has}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03633}03633 \textcolor{comment}{    /// been pre-\/built.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03634}03634 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03635}03635 \textcolor{comment}{    /// NOTE: ALL the matrices pointed to by matrix\_pt has to be built. This is}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03636}03636 \textcolor{comment}{    /// not the case with concatenate\_without\_communication(...)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03637}\mbox{\hyperlink{namespaceoomph_a2d240459b98565dd04314903d707de48}{03637}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_a2d240459b98565dd04314903d707de48}{concatenate}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<CRDoubleMatrix*>}}\& matrix\_pt,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03638}03638                      \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& result\_matrix);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03639}03639 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03640}03640 \textcolor{comment}{    /// Concatenate CRDoubleMatrix matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03641}03641 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03642}03642 \textcolor{comment}{    /// The Vector row\_distribution\_pt contains the LinearAlgebraDistribution}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03643}03643 \textcolor{comment}{    /// of each block row.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03644}03644 \textcolor{comment}{    /// The Vector col\_distribution\_pt contains the LinearAlgebraDistribution}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03645}03645 \textcolor{comment}{    /// of each block column.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03646}03646 \textcolor{comment}{    /// The DenseMatrix matrix\_pt contains pointers to the CRDoubleMatrices}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03647}03647 \textcolor{comment}{    /// to concatenate.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03648}03648 \textcolor{comment}{    /// The CRDoubleMatrix result\_matrix is the result matrix.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03649}03649 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03650}03650 \textcolor{comment}{    /// The result matrix is a permutation of the sub matrices such that the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03651}03651 \textcolor{comment}{    /// data stays on the same processor when the result matrix is built, there}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03652}03652 \textcolor{comment}{    /// is no communication between processors. Thus the block structure of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03653}03653 \textcolor{comment}{    /// sub matrices are NOT preserved in the result matrix. The rows are}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03654}03654 \textcolor{comment}{    /// block-\/permuted, defined by the concatenation of the distributions in}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03655}03655 \textcolor{comment}{    /// row\_distribution\_pt. Similarly, the columns are block-\/permuted, defined}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03656}03656 \textcolor{comment}{    /// by the concatenation of the distributions in col\_distribution\_pt. For}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03657}03657 \textcolor{comment}{    /// more details on the block-\/permutation, see}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03658}03658 \textcolor{comment}{    /// LinearAlgebraDistributionHelpers::concatenate(...).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03659}03659 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03660}03660 \textcolor{comment}{    /// If one wishes to preserve the block structure of the sub matrices in the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03661}03661 \textcolor{comment}{    /// result matrix, consider using CRDoubleMatrixHelpers::concatenate(...),}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03662}03662 \textcolor{comment}{    /// which uses communication between processors to ensure that the block}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03663}03663 \textcolor{comment}{    /// structure of the sub matrices are preserved.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03664}03664 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03665}03665 \textcolor{comment}{    /// The matrix manipulation functions}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03666}03666 \textcolor{comment}{    /// CRDoubleMatrixHelpers::concatenate(...) and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03667}03667 \textcolor{comment}{    /// CRDoubleMatrixHelpers::concatenate\_without\_communication(...)}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03668}03668 \textcolor{comment}{    /// are analogous to the Vector manipulation functions}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03669}03669 \textcolor{comment}{    /// DoubleVectorHelpers::concatenate(...) and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03670}03670 \textcolor{comment}{    /// DoubleVectorHelpers::concatenate\_without\_communication(...).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03671}03671 \textcolor{comment}{    /// Please look at the DoubleVector functions for an illustration of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03672}03672 \textcolor{comment}{    /// differences between concatenate(...) and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03673}03673 \textcolor{comment}{    /// concatenate\_without\_communication(...).}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03674}03674 \textcolor{comment}{    ///}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03675}03675 \textcolor{comment}{    /// Distribution of the result matrix:}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03676}03676 \textcolor{comment}{    /// If the result matrix does not have a distribution built, then it will be}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03677}03677 \textcolor{comment}{    /// given a distribution built from the concatenation of the distributions}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03678}03678 \textcolor{comment}{    /// from row\_distribution\_pt, see}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03679}03679 \textcolor{comment}{    /// LinearAlgebraDistributionHelpers::concatenate(...) for more detail.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03680}03680 \textcolor{comment}{    /// Otherwise we use the existing distribution.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03681}03681 \textcolor{comment}{    /// If there is an existing distribution then it must be the same as the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03682}03682 \textcolor{comment}{    /// distribution from the concatenation of row distributions as described}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03683}03683 \textcolor{comment}{    /// above.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03684}03684 \textcolor{comment}{    /// Why don't we always compute the distribution "{}on the fly"{}?}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03685}03685 \textcolor{comment}{    /// Because a non-\/uniform distribution requires communication.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03686}03686 \textcolor{comment}{    /// All block preconditioner distributions are concatenations of the}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03687}03687 \textcolor{comment}{    /// distributions of the individual blocks.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03688}\mbox{\hyperlink{namespaceoomph_a60abbd397064d971f529752aa9644fc7}{03688}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_a60abbd397064d971f529752aa9644fc7}{concatenate\_without\_communication}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03689}03689       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<LinearAlgebraDistribution*>}}\& row\_distribution\_pt,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03690}03690       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<LinearAlgebraDistribution*>}}\& col\_distribution\_pt,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03691}03691       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<CRDoubleMatrix*>}}\& matrix\_pt,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03692}03692       \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& result\_matrix);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03693}03693 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03694}03694 \textcolor{comment}{    /// Concatenate CRDoubleMatrix matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03695}03695 \textcolor{comment}{    /// This calls the other concatenate\_without\_communication(...) function,}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03696}03696 \textcolor{comment}{    /// passing block\_distribution\_pt as both the row\_distribution\_pt and}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03697}03697 \textcolor{comment}{    /// col\_distribution\_pt. This should only be called for block square}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03698}03698 \textcolor{comment}{    /// matrices.}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03699}\mbox{\hyperlink{namespaceoomph_a92e8e6ce5ba691e0bd31542d41a385f8}{03699}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_a60abbd397064d971f529752aa9644fc7}{concatenate\_without\_communication}}(}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03700}03700       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<LinearAlgebraDistribution*>}}\& block\_distribution\_pt,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03701}03701       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<CRDoubleMatrix*>}}\& matrix\_pt,}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03702}03702       \mbox{\hyperlink{classoomph_1_1CRDoubleMatrix}{CRDoubleMatrix}}\& result\_matrix);}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03703}03703 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03704}03704   \} \textcolor{comment}{// namespace CRDoubleMatrixHelpers}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03705}03705 }
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03706}03706 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{matrices_8h_source_l03707}03707 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

\hypertarget{trilinos__solver_8h_source}{}\doxysection{trilinos\+\_\+solver.\+h}
\label{trilinos__solver_8h_source}\index{trilinos\_solver.h@{trilinos\_solver.h}}
\mbox{\hyperlink{trilinos__solver_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2022 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00026}00026 \textcolor{preprocessor}{\#ifndef OOMPH\_TRILINOS\_SOLVER\_HEADER}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00027}00027 \textcolor{preprocessor}{\#define OOMPH\_TRILINOS\_SOLVER\_HEADER}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00029}00029 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{trilinos__preconditioners_8h}{trilinos\_preconditioners.h}}"{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00030}00030 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{iterative__linear__solver_8h}{iterative\_linear\_solver.h}}"{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00032}00032 \textcolor{preprocessor}{\#include "{}AztecOO.h"{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00034}00034 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00035}00035 \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00036}00036   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00037}00037 \textcolor{comment}{  /// An Epetra\_Operator class for oomph-\/lib preconditioners.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00038}00038 \textcolor{comment}{  /// A helper class for TrilinosOomphLibPreconditioner to allow an oomph-\/lib}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00039}00039 \textcolor{comment}{  /// preconditioner (i.e. one derived from Preconditioner) to be used with}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00040}00040 \textcolor{comment}{  /// a trilinos solver (TrilinosAztecOOSolver)}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00041}00041 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00042}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator}{00042}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator}{OomphLibPreconditionerEpetraOperator}} : \textcolor{keyword}{public} Epetra\_Operator}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00043}00043   \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00044}00044   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00045}00045 \textcolor{comment}{    /// Constructor -\/ takes the pointer to the oomph-\/lib}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00046}00046 \textcolor{comment}{    /// preconditioner and the distribution of the preconditioner}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00047}00047 \textcolor{comment}{    /// Note: the oomph-\/lib preconditioner must be setup.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00048}00048 \textcolor{comment}{    /// If use\_eptra\_values is true then the epetra vector values is used}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00049}00049 \textcolor{comment}{    /// within the vectors passed to the oomph-\/lib}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00050}00050 \textcolor{comment}{    /// preconditioner. If this is true none of the vector rebuild methods can}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00051}00051 \textcolor{comment}{    /// be called.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00052}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_ac32c701f4fb54f65e2701b984f41ada3}{00052}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_ac32c701f4fb54f65e2701b984f41ada3}{OomphLibPreconditionerEpetraOperator}}(\mbox{\hyperlink{classoomph_1_1Preconditioner}{Preconditioner}}* preconditioner\_pt,}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00053}00053                                          \textcolor{keywordtype}{bool} use\_epetra\_values = \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00054}00054 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00055}00055       : \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a319c368461dabf218b9589dfc8d47f14}{Operator\_comm}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00056}00056           preconditioner\_pt-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_a2760847d45ab334f6d902efc2620b615}{communicator\_pt}}()-\/>mpi\_comm()),}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00057}00057         \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a47942736149f13371582896aedf80f24}{Use\_epetra\_values}}(use\_epetra\_values)}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00058}00058 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00059}00059       : \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a319c368461dabf218b9589dfc8d47f14}{Operator\_comm}}(), \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a47942736149f13371582896aedf80f24}{Use\_epetra\_values}}(use\_epetra\_values)}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00060}00060 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00061}00061     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00062}00062       \textcolor{comment}{// set the ooomph-\/lib preconditioner}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00063}00063       \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}} = preconditioner\_pt;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00064}00064 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00065}00065       \textcolor{comment}{// set the preconditioner label}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00066}00066       \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a9f1c739fe5868b1d9dcaee080d63cb5b}{Preconditioner\_label}} = \textcolor{stringliteral}{"{}oomph-\/lib Preconditioner"{}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00068}00068       \textcolor{comment}{// setup the Epetra\_map}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00069}00069       \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_af111fc1ede49a86c5ed37ad1f5573e2e}{Operator\_map\_pt}} = \mbox{\hyperlink{namespaceoomph_1_1TrilinosEpetraHelpers_a5ccd0dec0ba044834119416b0ed06a2f}{TrilinosEpetraHelpers::create\_epetra\_map}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00070}00070         \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}());}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00071}00071     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00072}00072 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00073}00073 \textcolor{comment}{    /// Destructor -\/ deletes the Epetra\_map and My\_global\_rows vector}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00074}00074 \textcolor{comment}{    /// (if MPI)}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00075}00075 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator}{\string~OomphLibPreconditionerEpetraOperator}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00076}00076     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00077}00077       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_af111fc1ede49a86c5ed37ad1f5573e2e}{Operator\_map\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00078}00078       \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_af111fc1ede49a86c5ed37ad1f5573e2e}{Operator\_map\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00079}00079     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00080}00080 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00081}00081 \textcolor{comment}{    /// Broken copy constructor}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00082}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a42dda35e58da55e29cea6f6ecebc4119}{00082}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a42dda35e58da55e29cea6f6ecebc4119}{OomphLibPreconditionerEpetraOperator}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00083}00083       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator}{OomphLibPreconditionerEpetraOperator}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00084}00084 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00085}00085 \textcolor{comment}{    /// Broken assignment operator.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00086}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a9acb2f803a0cec47dd802b9b5648984a}{00086}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a9acb2f803a0cec47dd802b9b5648984a}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator}{OomphLibPreconditionerEpetraOperator}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00087}00087 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00088}00088 \textcolor{comment}{    /// Broken Epetra\_Operator member -\/ SetUseTranspose}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00089}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_acfeb8c93b3361cc68def1051ccc8525a}{00089}} \textcolor{comment}{}    \textcolor{keywordtype}{int} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_acfeb8c93b3361cc68def1051ccc8525a}{SetUseTranspose}}(\textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_aa70ab70fe3188e78fc623d3240f7af19}{UseTranspose}})}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00090}00090     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00091}00091       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00092}00092       error\_message << \textcolor{stringliteral}{"{}SetUseTranspose() is a pure virtual Epetra\_Operator "{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00093}00093                     << \textcolor{stringliteral}{"{}member that is not required for a Preconditioner"{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00094}00094                     << std::endl;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00095}00095       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00096}00096         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00097}00097     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00098}00098 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00099}00099 \textcolor{comment}{    /// Broken Epetra\_Operator member -\/ Apply}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00100}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_ade98cb5d53423f32f31a152f9dcc2ce6}{00100}} \textcolor{comment}{}    \textcolor{keywordtype}{int} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_ade98cb5d53423f32f31a152f9dcc2ce6}{Apply}}(\textcolor{keyword}{const} Epetra\_MultiVector\& X, Epetra\_MultiVector\& Y)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00101}00101 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00102}00102       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00103}00103       error\_message << \textcolor{stringliteral}{"{}Apply() is a pure virtual Epetra\_Operator member"{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00104}00104                     << \textcolor{stringliteral}{"{}that is not required for a Preconditioner"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00105}00105       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00106}00106         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00107}00107     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00109}00109 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00110}00110 \textcolor{comment}{    /// applies the oomph-\/lib preconditioner. Converts the Epetra vector}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00111}00111 \textcolor{comment}{    /// applys the preconditioner by calling the oomph-\/lib preconditioner's}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00112}00112 \textcolor{comment}{    /// preconditioner\_solve functionality.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00113}00113 \textcolor{comment}{    /// NOTE : the oomph-\/lib preconditioner is setup prior to being passed to}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00114}00114 \textcolor{comment}{    /// this class}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00115}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a6272811acfd9ad5b70e1d30447e0742b}{00115}} \textcolor{comment}{}    \textcolor{keywordtype}{int} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a6272811acfd9ad5b70e1d30447e0742b}{ApplyInverse}}(\textcolor{keyword}{const} Epetra\_MultiVector\& epetra\_r,}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00116}00116                      Epetra\_MultiVector\& epetra\_z)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00117}00117 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00118}00118       \textcolor{comment}{// the oomph-\/lib vector for r}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00119}00119       \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} oomph\_r;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00120}00120 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00121}00121       \textcolor{comment}{// copy the Epetra\_MultiVector r into an oomph-\/lib vector}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00122}00122       \textcolor{keywordtype}{double}** r\_pt;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00123}00123       epetra\_r.ExtractView(\&r\_pt);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00124}00124       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a47942736149f13371582896aedf80f24}{Use\_epetra\_values}})}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00125}00125       \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00126}00126         oomph\_r.\mbox{\hyperlink{classoomph_1_1DoubleVector_a4715c8cf47f9fc56d95889343d1a3b82}{set\_external\_values}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00127}00127           \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}(), *r\_pt, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00128}00128       \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00129}00129       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00130}00130       \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00131}00131         oomph\_r.\mbox{\hyperlink{classoomph_1_1DoubleVector_a7bcc94c157d6853a0f0502e8a76ed380}{build}}(\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}(), 0.0);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00132}00132         \textcolor{keywordtype}{unsigned} nrow\_local =}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00133}00133           \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_ac9310de740f9c3a61f8d5dab9bef88ca}{nrow\_local}}();}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00134}00134         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nrow\_local; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00135}00135         \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00136}00136           oomph\_r[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = r\_pt[0][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00137}00137         \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00138}00138       \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00140}00140       \textcolor{comment}{// oomph-\/lib vector for Y}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00141}00141       \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} oomph\_z;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00142}00142       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a47942736149f13371582896aedf80f24}{Use\_epetra\_values}})}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00143}00143       \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00144}00144         \textcolor{keywordtype}{double}** z\_pt;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00145}00145         epetra\_z.ExtractView(\&z\_pt);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00146}00146         \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}} oomph\_z;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00147}00147         oomph\_z.\mbox{\hyperlink{classoomph_1_1DoubleVector_a4715c8cf47f9fc56d95889343d1a3b82}{set\_external\_values}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00148}00148           \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}(), *z\_pt, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00149}00149       \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00150}00150       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00151}00151       \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00152}00152         oomph\_z.\mbox{\hyperlink{classoomph_1_1DoubleVector_a7bcc94c157d6853a0f0502e8a76ed380}{build}}(\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}(), 0.0);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00153}00153       \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00154}00154 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00155}00155       \textcolor{comment}{// apply the preconditioner}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00156}00156       \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1Preconditioner_ace1199369e4465cd2b9a34884bb64ec8}{preconditioner\_solve}}(oomph\_r, oomph\_z);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00158}00158       \textcolor{comment}{// if not using external data copy the oomph-\/lib vector oomph\_Y back to Y}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00159}00159       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a47942736149f13371582896aedf80f24}{Use\_epetra\_values}})}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00160}00160       \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00161}00161         \textcolor{keywordtype}{unsigned} nrow\_local =}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00162}00162           \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1DistributableLinearAlgebraObject_abfa9cf25494c796d62b15bad586fab47}{distribution\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1LinearAlgebraDistribution_ac9310de740f9c3a61f8d5dab9bef88ca}{nrow\_local}}();}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00163}00163         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nrow\_local; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00164}00164         \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00165}00165           epetra\_z.ReplaceMyValue(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, 0, oomph\_z[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00166}00166         \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00167}00167       \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00169}00169       \textcolor{comment}{// return 0 to indicate success}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00170}00170       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00171}00171     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00172}00172 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00173}00173 \textcolor{comment}{    /// Broken Epetra\_Operator member -\/ NormInf}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00174}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_ac08f2645cbfbaf4b566fe4089c8fae22}{00174}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_ac08f2645cbfbaf4b566fe4089c8fae22}{NormInf}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00175}00175 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00176}00176       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00177}00177       error\_message << \textcolor{stringliteral}{"{}NormInf() is a pure virtual Epetra\_Operator member"{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00178}00178                     << \textcolor{stringliteral}{"{}that is not required for a Preconditioner"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00179}00179       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00180}00180         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00181}00181     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00182}00182 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00183}00183 \textcolor{comment}{    /// Epetra\_Operator::Label -\/ returns a string describing the operator}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00184}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a82464d4b372ba6e97ecc47bb8596fbbf}{00184}} \textcolor{comment}{}    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a82464d4b372ba6e97ecc47bb8596fbbf}{Label}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00185}00185 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00186}00186       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a9f1c739fe5868b1d9dcaee080d63cb5b}{Preconditioner\_label}}.c\_str();}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00187}00187     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00188}00188 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00189}00189 \textcolor{comment}{    /// Broken Epetra\_Operator member -\/ UseTranspose}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00190}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_aa70ab70fe3188e78fc623d3240f7af19}{00190}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_aa70ab70fe3188e78fc623d3240f7af19}{UseTranspose}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00191}00191 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00192}00192       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00193}00193       error\_message}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00194}00194         << \textcolor{stringliteral}{"{}UseTranspose() is a pure virtual Epetra\_Operator member "{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00195}00195         << \textcolor{stringliteral}{"{}that is not required for a Preconditioner"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00196}00196       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00197}00197         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00198}00198     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00199}00199 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00200}00200 \textcolor{comment}{    /// Broken Epetra\_Operator member -\/ HasNormInf}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00201}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a584ad443e96d730d6abbcf6291298545}{00201}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a584ad443e96d730d6abbcf6291298545}{HasNormInf}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00202}00202 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00203}00203       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00204}00204       error\_message << \textcolor{stringliteral}{"{}HasNormInf() is a pure virtual Epetra\_Operator member "{}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00205}00205                     << \textcolor{stringliteral}{"{}that is not required for a Preconditioner"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00206}00206       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00207}00207         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00208}00208     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00209}00209 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00210}00210 \textcolor{comment}{    /// Returns the Epetra MPI\_Comm object}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00211}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_abf80be4bf09e7f17d7c9f14019a3213f}{00211}} \textcolor{comment}{}    \textcolor{keyword}{const} Epetra\_Comm\& \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_abf80be4bf09e7f17d7c9f14019a3213f}{Comm}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00212}00212 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00213}00213       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a319c368461dabf218b9589dfc8d47f14}{Operator\_comm}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00214}00214     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00215}00215 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00216}00216 \textcolor{comment}{    /// Epetra\_Operator member -\/ OperatorDomainMap}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00217}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_ac52c527076aececb4df71c1e7ebdf3cc}{00217}} \textcolor{comment}{}    \textcolor{keyword}{const} Epetra\_Map\& \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_ac52c527076aececb4df71c1e7ebdf3cc}{OperatorDomainMap}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00218}00218 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00219}00219       \textcolor{keywordflow}{return} *\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_af111fc1ede49a86c5ed37ad1f5573e2e}{Operator\_map\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00220}00220     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00221}00221 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00222}00222 \textcolor{comment}{    /// Epetra\_Operator member -\/ OperatorRangeMap}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00223}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_aee7a1f7477be8cb9a59daa8f0d91ba72}{00223}} \textcolor{comment}{}    \textcolor{keyword}{const} Epetra\_Map\& \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_aee7a1f7477be8cb9a59daa8f0d91ba72}{OperatorRangeMap}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00224}00224 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00225}00225       \textcolor{keywordflow}{return} *\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_af111fc1ede49a86c5ed37ad1f5573e2e}{Operator\_map\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00226}00226     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00227}00227 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00229}00229   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00230}00230 \textcolor{comment}{    /// A pointer to the oomph-\/lib preconditioner}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00231}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{00231}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Preconditioner}{Preconditioner}}* \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a19407c48b77a021c8e714232d296ecd0}{Oomph\_lib\_preconditioner\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00232}00232 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00233}00233 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00234}00234 \textcolor{comment}{    /// An Epetra MPI Comm object}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00235}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a319c368461dabf218b9589dfc8d47f14}{00235}} \textcolor{comment}{}    Epetra\_MpiComm \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a319c368461dabf218b9589dfc8d47f14}{Operator\_comm}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00236}00236 \textcolor{preprocessor}{\#else}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00237}00237 \textcolor{comment}{    /// An Epetra Serial Comm object}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00238}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a093d431cfa9ad601e1ead0dd324b3d49}{00238}} \textcolor{comment}{}    Epetra\_SerialComm \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a093d431cfa9ad601e1ead0dd324b3d49}{Operator\_comm}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00239}00239 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00240}00240 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00241}00241 \textcolor{comment}{    /// Use the epetra data within the vectors passed to the oomph-\/lib}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00242}00242 \textcolor{comment}{    /// preconditioner. If this is true none of the vector rebuild methods can}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00243}00243 \textcolor{comment}{    /// be called.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00244}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a47942736149f13371582896aedf80f24}{00244}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a47942736149f13371582896aedf80f24}{Use\_epetra\_values}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00245}00245 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00246}00246 \textcolor{comment}{    /// A pointer to an Epetra\_Map object -\/ describes distribution of the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00247}00247 \textcolor{comment}{    /// preconditioner, in this instance it is primarily used to prescribe the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00248}00248 \textcolor{comment}{    /// distribution}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00249}00249 \textcolor{comment}{    /// of the residual and solution vector}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00250}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_af111fc1ede49a86c5ed37ad1f5573e2e}{00250}} \textcolor{comment}{}    Epetra\_Map* \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_af111fc1ede49a86c5ed37ad1f5573e2e}{Operator\_map\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00251}00251 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00252}00252 \textcolor{comment}{    /// a label for the preconditioner ( for Epetra\_Operator::Label() )}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00253}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a9f1c739fe5868b1d9dcaee080d63cb5b}{00253}} \textcolor{comment}{}    \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} \mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator_a9f1c739fe5868b1d9dcaee080d63cb5b}{Preconditioner\_label}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00254}00254   \};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00256}00256 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00257}00257   \textcolor{comment}{//=============================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00258}00258 \textcolor{comment}{  /// An interface to the Trilinos AztecOO classes allowing it to be used}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00259}00259 \textcolor{comment}{  /// as an Oomph-\/lib LinearSolver.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00260}00260 \textcolor{comment}{  /// The AztecOO solver is a Krylov Subspace solver; the solver type (either}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00261}00261 \textcolor{comment}{  /// CG, GMRES or BiCGStab) can be set using solver\_type(). This solver can be}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00262}00262 \textcolor{comment}{  /// preconditioned with Trilinos Preconditioners (derived from}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00263}00263 \textcolor{comment}{  /// TrilinosPreconditionerBase) or Oomph-\/lib preconditioners (derived from}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00264}00264 \textcolor{comment}{  /// Preconditioner). Preconditioners are set using preconditioner\_pt().}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00265}00265 \textcolor{comment}{}  \textcolor{comment}{//=============================================================================}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00266}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver}{00266}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver}{TrilinosAztecOOSolver}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1IterativeLinearSolver}{IterativeLinearSolver}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00267}00267   \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00268}00268   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00269}00269 \textcolor{comment}{    /// Constructor.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00270}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a2abd3c0ee288fdaceefbde6f4e854e2c}{00270}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a2abd3c0ee288fdaceefbde6f4e854e2c}{TrilinosAztecOOSolver}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00271}00271     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00272}00272       \textcolor{comment}{// By default use workaround for creating of epetra matrix that}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00273}00273       \textcolor{comment}{// respects aztecoo's ordering requirements}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00274}00274       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aead1067bb965649abddcf0af0e2d47f7}{Use\_aztecoo\_workaround\_for\_epetra\_matrix\_setup}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00276}00276       \textcolor{comment}{// set pointer to Null}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00277}00277       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ad71b280c5af25e35e0f9da8cd68228cf}{AztecOO\_solver\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00278}00278 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00279}00279       \textcolor{comment}{// initially assume not problem based solve}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00280}00280       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a015ad0b4207515558d270ef08a213125}{Using\_problem\_based\_solve}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00281}00281 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00282}00282       \textcolor{comment}{// if a problem based solve is performed then it should generate a}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00283}00283       \textcolor{comment}{// serial matrix}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00284}00284       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a3bfc11cd816eee847f102327ae4315aa}{Assemble\_serial\_jacobian}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00286}00286       \textcolor{comment}{// by default we do not use external values in the oomph-\/lib}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00287}00287       \textcolor{comment}{// preconditioner}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00288}00288       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a028992b1b3fe1a501590aa71d4a879e8}{If\_oomphlib\_preconditioner\_use\_epetra\_values}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00289}00289 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00290}00290       \textcolor{comment}{// null the pts}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00291}00291       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_abc6a63eb67694f7ac5dfc8505a8b9a5f}{Problem\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00292}00292       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a2d0905cb4a63b119e784a5caee458691}{Epetra\_matrix\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00293}00293       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7a419b3a461f998608dcc9b868fb0a89}{Epetra\_preconditioner\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00295}00295       \textcolor{comment}{// set solver defaults}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00296}00296       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aaa1ffdf657c54fbd5cfa097cc962050c}{Solver\_type}} = \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8a9d76e6cfa1594b150de04413c0f958a1729a0500bca95c117f5795d06b83bb4}{GMRES}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00297}00297       \mbox{\hyperlink{classoomph_1_1IterativeLinearSolver_a46dd6b0243c734a77afce3c44cf4597d}{Tolerance}} = 10\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}-\/10;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00299}00299       \textcolor{comment}{// don't delete the matrix}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00300}00300       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a6cd6d4719412c7ebf01bfb6cb4fddfcc}{Delete\_matrix}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00301}00301     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00302}00302 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00303}00303 \textcolor{comment}{    /// Destructor -\/ delete the solver and the matrices}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00304}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7b06c1e69e25f407083453f98cfdb144}{00304}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7b06c1e69e25f407083453f98cfdb144}{\string~TrilinosAztecOOSolver}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00305}00305     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00306}00306       \textcolor{comment}{// delete}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00307}00307       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a365a39ae1dec32eb78aa160b70426f59}{clean\_up\_memory}}();}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00308}00308 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00309}00309       \textcolor{comment}{// if Problem\_based solve then the oomph matrix was generated by this}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00310}00310       \textcolor{comment}{// class and should be deleted}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00311}00311       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a015ad0b4207515558d270ef08a213125}{Using\_problem\_based\_solve}})}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00312}00312       \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00313}00313         \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a71d7437b0502f3be59f64258e0af458e}{Oomph\_matrix\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00314}00314         \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a71d7437b0502f3be59f64258e0af458e}{Oomph\_matrix\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00315}00315       \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00316}00316     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00317}00317 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00318}00318 \textcolor{comment}{    /// Broken copy constructor.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00319}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aa29c842b4a8abe16e50c9e371557b2f8}{00319}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aa29c842b4a8abe16e50c9e371557b2f8}{TrilinosAztecOOSolver}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver}{TrilinosAztecOOSolver}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00320}00320 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00321}00321 \textcolor{comment}{    /// Broken assignment operator.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00322}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ae78dde00323507932c4103723dec10fa}{00322}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ae78dde00323507932c4103723dec10fa}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver}{TrilinosAztecOOSolver}}\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00323}00323 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00324}00324 \textcolor{comment}{    /// Enable workaround for creating of epetra matrix that respects}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00325}00325 \textcolor{comment}{    /// aztecoo's ordering requirements}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00326}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aa3cd029cc48f36cc41d75e8c83faa037}{00326}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aa3cd029cc48f36cc41d75e8c83faa037}{enable\_aztecoo\_workaround\_for\_epetra\_matrix\_setup}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00327}00327     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00328}00328       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aead1067bb965649abddcf0af0e2d47f7}{Use\_aztecoo\_workaround\_for\_epetra\_matrix\_setup}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00329}00329     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00330}00330 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00331}00331 \textcolor{comment}{    /// Disable workaround for creating of epetra matrix that respects}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00332}00332 \textcolor{comment}{    /// aztecoo's ordering requirements}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00333}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a25ba106bb6f1cd4b99dd1af343aeeb7c}{00333}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a25ba106bb6f1cd4b99dd1af343aeeb7c}{disable\_aztecoo\_workaround\_for\_epetra\_matrix\_setup}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00334}00334     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00335}00335       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aead1067bb965649abddcf0af0e2d47f7}{Use\_aztecoo\_workaround\_for\_epetra\_matrix\_setup}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00336}00336     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00337}00337 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00338}00338 \textcolor{comment}{    /// Is workaround for creating of epetra matrix that respects}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00339}00339 \textcolor{comment}{    /// aztecoo's ordering requirements enabled?}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00340}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ac17e7d21595ce4b9b854f0207f3b04be}{00340}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ac17e7d21595ce4b9b854f0207f3b04be}{is\_aztecoo\_workaround\_for\_epetra\_matrix\_setup\_enabled}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00341}00341     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00342}00342       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aead1067bb965649abddcf0af0e2d47f7}{Use\_aztecoo\_workaround\_for\_epetra\_matrix\_setup}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00343}00343     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00344}00344 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00345}00345 \textcolor{comment}{    /// Clean up method -\/ deletes the solver, the matrices and the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00346}00346 \textcolor{comment}{    /// preconditioner}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00347}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a365a39ae1dec32eb78aa160b70426f59}{00347}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a365a39ae1dec32eb78aa160b70426f59}{clean\_up\_memory}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00348}00348     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00349}00349       \textcolor{comment}{// delete the solver}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00350}00350       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ad71b280c5af25e35e0f9da8cd68228cf}{AztecOO\_solver\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00351}00351       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ad71b280c5af25e35e0f9da8cd68228cf}{AztecOO\_solver\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00353}00353       \textcolor{comment}{// delete the Epetra\_Operator preconditioner (only if it is a wrapper to}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00354}00354       \textcolor{comment}{// an oomphlib preconditioner in which case only the wrapper is deleted}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00355}00355       \textcolor{comment}{// and not the actual preconditioner). if the preconditioner is Trilinos}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00356}00356       \textcolor{comment}{// preconditioner then the Epetra\_Operator is deleted when that}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00357}00357       \textcolor{comment}{// preconditioner is deleted}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00358}00358       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7a419b3a461f998608dcc9b868fb0a89}{Epetra\_preconditioner\_pt}} != 0)}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00359}00359       \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00360}00360         \textcolor{keywordflow}{if} (\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1OomphLibPreconditionerEpetraOperator}{OomphLibPreconditionerEpetraOperator}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00361}00361               \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7a419b3a461f998608dcc9b868fb0a89}{Epetra\_preconditioner\_pt}}) != 0)}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00362}00362         \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00363}00363           \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7a419b3a461f998608dcc9b868fb0a89}{Epetra\_preconditioner\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00364}00364           \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7a419b3a461f998608dcc9b868fb0a89}{Epetra\_preconditioner\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00365}00365         \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00366}00366       \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00367}00367 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00368}00368       \textcolor{comment}{// don't delete the preconditioner but call its clean up memory method}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00369}00369       \textcolor{keywordflow}{if} (this-\/>\mbox{\hyperlink{classoomph_1_1IterativeLinearSolver_ad4ae617ce8304f17bd42f4dc39813e22}{preconditioner\_pt}}() != 0)}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00370}00370       \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00371}00371         this-\/>\mbox{\hyperlink{classoomph_1_1IterativeLinearSolver_ad4ae617ce8304f17bd42f4dc39813e22}{preconditioner\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Preconditioner_a46c31c416829bedcd9db238431262027}{clean\_up\_memory}}();}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00372}00372       \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00375}00375       \textcolor{comment}{// delete the matrices}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00376}00376       \textcolor{comment}{// This must now happen after the preconditioner delete because the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00377}00377       \textcolor{comment}{// ML preconditioner (and maybe others) use the communicator from the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00378}00378       \textcolor{comment}{// matrix in the destructor}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00379}00379       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a2d0905cb4a63b119e784a5caee458691}{Epetra\_matrix\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00380}00380       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a2d0905cb4a63b119e784a5caee458691}{Epetra\_matrix\_pt}} = 0;}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00381}00381     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00382}00382 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00383}00383 \textcolor{comment}{    /// Function which uses problem\_pt's get\_jacobian(...) function to}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00384}00384 \textcolor{comment}{    /// generate a linear system which is then solved. This function deletes}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00385}00385 \textcolor{comment}{    /// any existing internal data and then generates a new AztecOO solver.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00386}00386 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7dc1ae7f05e8a50416b8df700f832eb9}{solve}}(\mbox{\hyperlink{classoomph_1_1Problem}{Problem}}* \textcolor{keyword}{const}\& problem\_pt, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& solution);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00387}00387 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00388}00388 \textcolor{comment}{    /// Function to solve the linear system defined by matrix\_pt and rhs.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00389}00389 \textcolor{comment}{    /// \(\backslash\)b NOTE 1. The matrix has to be of type CRDoubleMatrix or}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00390}00390 \textcolor{comment}{    /// DistributedCRDoubleMatrix.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00391}00391 \textcolor{comment}{    /// \(\backslash\)b NOTE 2. This function will delete any existing internal data and}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00392}00392 \textcolor{comment}{    /// generate a new AztecOO solver.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00393}00393 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7dc1ae7f05e8a50416b8df700f832eb9}{solve}}(\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}}* \textcolor{keyword}{const}\& matrix\_pt,}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00394}00394                \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& rhs,}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00395}00395                \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& solution);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00396}00396 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00397}00397 \textcolor{comment}{    /// Function to resolve a linear system using the existing solver}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00398}00398 \textcolor{comment}{    /// data, allowing a solve with a new right hand side vector. This}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00399}00399 \textcolor{comment}{    /// function must be used after a call to solve(...) with}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00400}00400 \textcolor{comment}{    /// enable\_resolve set to true.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00401}00401 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a022f537f95c0bf352bab739f2f58bd7f}{resolve}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& rhs, \mbox{\hyperlink{classoomph_1_1DoubleVector}{DoubleVector}}\& solution);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00402}00402 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00403}00403 \textcolor{comment}{    /// Disable resolve function (overloads the LinearSolver}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00404}00404 \textcolor{comment}{    /// disable\_resolve function).}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00405}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7d9c9d9beddb2d18abea55529db534e4}{00405}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7d9c9d9beddb2d18abea55529db534e4}{disable\_resolve}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00406}00406     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00407}00407       \mbox{\hyperlink{classoomph_1_1LinearSolver_a5f5e7e7a44ff0897b0e4cd9524000edc}{Enable\_resolve}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00408}00408       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a365a39ae1dec32eb78aa160b70426f59}{clean\_up\_memory}}();}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00409}00409     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00410}00410 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00411}00411 \textcolor{comment}{    /// Call if the matrix can be deleted}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00412}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ad48df1a369de8dabe6c2cdb00e05ff87}{00412}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ad48df1a369de8dabe6c2cdb00e05ff87}{enable\_delete\_matrix}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00413}00413     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00414}00414       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a6cd6d4719412c7ebf01bfb6cb4fddfcc}{Delete\_matrix}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00415}00415     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00416}00416 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00417}00417 \textcolor{comment}{    /// Call if the matrix can not be deleted (default)}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00418}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a6df71e8dd3967f17d39142696f71aef6}{00418}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a6df71e8dd3967f17d39142696f71aef6}{disable\_delete\_matrix}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00419}00419     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00420}00420       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a6cd6d4719412c7ebf01bfb6cb4fddfcc}{Delete\_matrix}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00421}00421     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00422}00422 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00423}00423 \textcolor{comment}{    /// Access function to Max\_iter}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00424}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8e3fbb5d980b5764a7934cc7e901bd56}{00424}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8e3fbb5d980b5764a7934cc7e901bd56}{max\_iter}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00425}00425     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00426}00426       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1IterativeLinearSolver_a9bdc42768d009b093fd7bc23647dc989}{Max\_iter}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00427}00427     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00428}00428 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00429}00429 \textcolor{comment}{    /// Acess function to Iterations}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00430}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aaa90619b05f448d7bd610f474a9f750d}{00430}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aaa90619b05f448d7bd610f474a9f750d}{iterations}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00431}00431 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00432}00432       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a26a9366d3ec0f11e7e907587c0439ea7}{Iterations}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00433}00433     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00434}00434 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00435}00435 \textcolor{comment}{    /// Access function to Tolerance}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00436}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a0b7b6b0431efdc7fd6276552349610bb}{00436}} \textcolor{comment}{}    \textcolor{keywordtype}{double}\& \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a0b7b6b0431efdc7fd6276552349610bb}{tolerance}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00437}00437     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00438}00438       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1IterativeLinearSolver_a46dd6b0243c734a77afce3c44cf4597d}{Tolerance}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00439}00439     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00440}00440 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00441}00441 \textcolor{comment}{    /// Access function to Solver\_type}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00442}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7c81cd1f21720d2c05db9d499dc8f2bc}{00442}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7c81cd1f21720d2c05db9d499dc8f2bc}{solver\_type}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00443}00443     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00444}00444       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aaa1ffdf657c54fbd5cfa097cc962050c}{Solver\_type}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00445}00445     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00446}00446 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00447}00447 \textcolor{comment}{    /// Function to return Jacobian\_setup\_time;}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00448}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a3b7cf9349909686e3638aced9b29303f}{00448}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a3b7cf9349909686e3638aced9b29303f}{jacobian\_setup\_time}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00449}00449     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00450}00450       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_afec53c52f4fcab981eb0ed7244d750de}{Jacobian\_setup\_time}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00451}00451     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00452}00452 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00453}00453 \textcolor{comment}{    /// Function to return Linear\_solver\_solution\_time}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00454}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a88cf6614457b404e38c6aed2e5d41257}{00454}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a88cf6614457b404e38c6aed2e5d41257}{linear\_solver\_solution\_time}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00455}00455     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00456}00456       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ab2373a8cdd5c27d2ac099ad8444dfbb7}{Linear\_solver\_solution\_time}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00457}00457     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00458}00458 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00459}00459 \textcolor{comment}{    /// Set the assembly of the serial jacobian}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00460}00460 \textcolor{comment}{    /// when performing a problem-\/based solve}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00461}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a80de34d99eff7b2ad41af3e04229a55b}{00461}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a80de34d99eff7b2ad41af3e04229a55b}{enable\_assemble\_serial\_jacobian}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00462}00462     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00463}00463       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a3bfc11cd816eee847f102327ae4315aa}{Assemble\_serial\_jacobian}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00464}00464     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00465}00465 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00466}00466 \textcolor{comment}{    /// Unset the assembly of the serial jacobian}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00467}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a9f79dc6d711d4052ee61cb305da226db}{00467}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a9f79dc6d711d4052ee61cb305da226db}{disable\_assemble\_serial\_jacobian}}()}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00468}00468     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00469}00469       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a3bfc11cd816eee847f102327ae4315aa}{Assemble\_serial\_jacobian}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00470}00470     \}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00471}00471 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00472}00472 \textcolor{comment}{    /// if this solver is using an oomph-\/lib preconditioner then the vectors}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00473}00473 \textcolor{comment}{    /// passed to preconditioner\_solve(...) should be using the values in the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00474}00474 \textcolor{comment}{    /// epetra vector as external data. If the vectors are using external}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00475}00475 \textcolor{comment}{    /// data then rebuild(...) methods cannot be used be used in the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00476}00476 \textcolor{comment}{    /// preconditioner.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00477}00477 \textcolor{comment}{}    \textcolor{comment}{// bool\& if\_oomphlib\_preconditioner\_use\_epetra\_values()}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00478}00478     \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00479}00479     \textcolor{comment}{//  return If\_oomphlib\_preconditioner\_use\_epetra\_values;}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00480}00480     \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00481}00481 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00482}00482 \textcolor{comment}{    /// Enumerated list to define which AztecOO solver is used}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00483}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8a9d76e6cfa1594b150de04413c0f958}{00483}} \textcolor{comment}{}    \textcolor{keyword}{enum} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8a9d76e6cfa1594b150de04413c0f958}{AztecOO\_solver\_types}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00484}00484     \{}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00485}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8a9d76e6cfa1594b150de04413c0f958a444cf8d677f36a05433c69812a4d1e20}{00485}}       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8a9d76e6cfa1594b150de04413c0f958a444cf8d677f36a05433c69812a4d1e20}{CG}},}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00486}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8a9d76e6cfa1594b150de04413c0f958a1729a0500bca95c117f5795d06b83bb4}{00486}}       \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8a9d76e6cfa1594b150de04413c0f958a1729a0500bca95c117f5795d06b83bb4}{GMRES}},}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00487}00487       \mbox{\hyperlink{classoomph_1_1BiCGStab}{BiCGStab}}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00488}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a8a9d76e6cfa1594b150de04413c0f958ac6422728788cf5c341d1e3e988b4fc7d}{00488}}     \};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00489}00489 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00490}00490   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00491}00491 \textcolor{comment}{    /// Helper function performs the actual solve once the AztecOO}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00492}00492 \textcolor{comment}{    /// solver is set up}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00493}00493 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a419638218c26238bab55674304c5fc98}{solve\_using\_AztecOO}}(Epetra\_Vector*\& rhs\_pt, Epetra\_Vector*\& soln\_pt);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00494}00494 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00495}00495 \textcolor{comment}{    /// Helper function for setting up the solver. Converts the oomph-\/lib}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00496}00496 \textcolor{comment}{    /// matrices to Epetra matrices, sets up the preconditioner, creates the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00497}00497 \textcolor{comment}{    /// Trilinos Aztec00 solver and passes in the matrix, preconditioner and}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00498}00498 \textcolor{comment}{    /// parameters.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00499}00499 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a1d5e7dfc9fe3c890569465a167c2f2fc}{solver\_setup}}(\mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}}* \textcolor{keyword}{const}\& matrix\_pt);}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00500}00500 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00501}00501 \textcolor{comment}{    /// Use workaround for creating of epetra matrix that respects}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00502}00502 \textcolor{comment}{    /// aztecoo's ordering requirements}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00503}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aead1067bb965649abddcf0af0e2d47f7}{00503}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aead1067bb965649abddcf0af0e2d47f7}{Use\_aztecoo\_workaround\_for\_epetra\_matrix\_setup}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00504}00504 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00505}00505 \textcolor{comment}{    /// Stores number of iterations used}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00506}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a26a9366d3ec0f11e7e907587c0439ea7}{00506}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a26a9366d3ec0f11e7e907587c0439ea7}{Iterations}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00507}00507 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00508}00508 \textcolor{comment}{    /// Pointer to the AztecOO solver}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00509}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ad71b280c5af25e35e0f9da8cd68228cf}{00509}} \textcolor{comment}{}    AztecOO* \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ad71b280c5af25e35e0f9da8cd68228cf}{AztecOO\_solver\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00510}00510 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00511}00511 \textcolor{comment}{    /// Stores set up time for Jacobian}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00512}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_afec53c52f4fcab981eb0ed7244d750de}{00512}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_afec53c52f4fcab981eb0ed7244d750de}{Jacobian\_setup\_time}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00513}00513 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00514}00514 \textcolor{comment}{    /// Stores time for the solution (excludes time to set up preconditioner)}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00515}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ab2373a8cdd5c27d2ac099ad8444dfbb7}{00515}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_ab2373a8cdd5c27d2ac099ad8444dfbb7}{Linear\_solver\_solution\_time}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00516}00516 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00517}00517 \textcolor{comment}{    /// Trilinos copies matrix data from oomph-\/lib's own CRDoubleMatrix}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00518}00518 \textcolor{comment}{    /// or DistributedCRDoubleMatrix to Trilinos's Epetra format -\/ the Trilinos}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00519}00519 \textcolor{comment}{    /// solver no longer requires the oomph-\/lib matrices and therefore they}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00520}00520 \textcolor{comment}{    /// could be deleted to save memory. This must be requested explicitly by}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00521}00521 \textcolor{comment}{    /// setting this flag to TRUE. \(\backslash\)b NOTE: The matrix is deleted after the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00522}00522 \textcolor{comment}{    /// preconditioner is setup.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00523}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a6cd6d4719412c7ebf01bfb6cb4fddfcc}{00523}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a6cd6d4719412c7ebf01bfb6cb4fddfcc}{Delete\_matrix}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00524}00524 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00525}00525 \textcolor{comment}{    /// If true, when performing a problem based solve a serial matrix}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00526}00526 \textcolor{comment}{    /// will be requested from Problem::get\_jacobian(...). Defaults to true}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00527}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a3bfc11cd816eee847f102327ae4315aa}{00527}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a3bfc11cd816eee847f102327ae4315aa}{Assemble\_serial\_jacobian}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00528}00528 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00529}00529 \textcolor{comment}{    /// Defines which solver is set up -\/ available types are}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00530}00530 \textcolor{comment}{    /// defined in AztecOO\_solver\_types}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00531}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aaa1ffdf657c54fbd5cfa097cc962050c}{00531}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_aaa1ffdf657c54fbd5cfa097cc962050c}{Solver\_type}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00532}00532 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00533}00533 \textcolor{comment}{    /// Helper flag keeping track of whether we called the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00534}00534 \textcolor{comment}{    /// linear algebra or problem-\/based solve function.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00535}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a015ad0b4207515558d270ef08a213125}{00535}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a015ad0b4207515558d270ef08a213125}{Using\_problem\_based\_solve}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00536}00536 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00537}00537 \textcolor{comment}{    /// A pointer for the linear system matrix in Epetra\_CrsMatrix format}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00538}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a2d0905cb4a63b119e784a5caee458691}{00538}} \textcolor{comment}{}    Epetra\_CrsMatrix* \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a2d0905cb4a63b119e784a5caee458691}{Epetra\_matrix\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00539}00539 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00540}00540 \textcolor{comment}{    /// A pointer to the Epetra\_Operator for the preconditioner. This is}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00541}00541 \textcolor{comment}{    /// only used if the preconditioner NOT a Trilinos preconditioner.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00542}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7a419b3a461f998608dcc9b868fb0a89}{00542}} \textcolor{comment}{}    Epetra\_Operator* \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a7a419b3a461f998608dcc9b868fb0a89}{Epetra\_preconditioner\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00543}00543 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00544}00544 \textcolor{comment}{    /// Oomph lib matrix pointer}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00545}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a71d7437b0502f3be59f64258e0af458e}{00545}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1DoubleMatrixBase}{DoubleMatrixBase}}* \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a71d7437b0502f3be59f64258e0af458e}{Oomph\_matrix\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00546}00546 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00547}00547 \textcolor{comment}{    /// A pointer to the underlying problem (NULL if MATRIX based solve)}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00548}00548 \textcolor{comment}{    /// The problem\_pt is stored here in a problem based solve for the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00549}00549 \textcolor{comment}{    /// preconditioner}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00550}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_abc6a63eb67694f7ac5dfc8505a8b9a5f}{00550}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Problem}{Problem}}* \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_abc6a63eb67694f7ac5dfc8505a8b9a5f}{Problem\_pt}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00551}00551 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00552}00552 \textcolor{comment}{    /// if this solver is using an oomph-\/lib preconditioner then the vectors}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00553}00553 \textcolor{comment}{    /// passed to preconditioner\_solve(...) should be using the values in the}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00554}00554 \textcolor{comment}{    /// epetra vector as external data. If the vectors are using external}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00555}00555 \textcolor{comment}{    /// data then rebuild(...) methods cannot be used.}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00556}\mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a028992b1b3fe1a501590aa71d4a879e8}{00556}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1TrilinosAztecOOSolver_a028992b1b3fe1a501590aa71d4a879e8}{If\_oomphlib\_preconditioner\_use\_epetra\_values}};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00557}00557   \};}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00558}00558 }
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00559}00559 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{trilinos__solver_8h_source_l00560}00560 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

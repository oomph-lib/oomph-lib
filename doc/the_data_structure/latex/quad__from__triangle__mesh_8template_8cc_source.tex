\hypertarget{quad__from__triangle__mesh_8template_8cc_source}{}\doxysection{quad\+\_\+from\+\_\+triangle\+\_\+mesh.\+template.\+cc}
\label{quad__from__triangle__mesh_8template_8cc_source}\index{quad\_from\_triangle\_mesh.template.cc@{quad\_from\_triangle\_mesh.template.cc}}
\mbox{\hyperlink{quad__from__triangle__mesh_8template_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00026}00026 \textcolor{comment}{// Driver for 2D moving block}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00027}00027 \textcolor{preprocessor}{\#ifndef OOMPH\_QUAD\_FROM\_TRIANGLE\_MESH\_TEMPLATE\_CC}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00028}00028 \textcolor{preprocessor}{\#define OOMPH\_QUAD\_FROM\_TRIANGLE\_MESH\_TEMPLATE\_CC}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00030}00030 \textcolor{comment}{// The mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00031}00031 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{quad__from__triangle__mesh_8template_8h}{quad\_from\_triangle\_mesh.template.h}}"{}}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00033}00033 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00034}00034 \textcolor{keyword}{using namespace }\mbox{\hyperlink{namespaceoomph}{oomph}};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00036}00036 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00037}00037 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00038}00038 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00039}00039 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00040}00040 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00042}00042 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00043}00043 \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00044}00044   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00045}00045 \textcolor{comment}{  /// Build the full mesh with the help of the scaffold mesh coming}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00046}00046 \textcolor{comment}{  /// from the triangle mesh generator, Triangle. To build this quad}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00047}00047 \textcolor{comment}{  /// element based mesh we make use of the fact that a triangle element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00048}00048 \textcolor{comment}{  /// can be split as shown in the diagram below:}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00049}00049 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00050}00050 \textcolor{comment}{  ///                  N2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00051}00051 \textcolor{comment}{  ///                 | |                 N0 : 1st scaffold element node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00052}00052 \textcolor{comment}{  ///                |   |                N1 : 2nd scaffold element node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00053}00053 \textcolor{comment}{  ///               |     |               N2 : 3rd scaffold element node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00054}00054 \textcolor{comment}{  ///              |       |}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00055}00055 \textcolor{comment}{  ///           C |   Q\_2   | B           Edge 0 : N0 -\/-\/> N1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00056}00056 \textcolor{comment}{  ///            | |       | |            Edge 1 : N1 -\/-\/> N2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00057}00057 \textcolor{comment}{  ///           |   |     |   |           Edge 2 : N2 -\/-\/> N0}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00058}00058 \textcolor{comment}{  ///          |     |   |     |}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00059}00059 \textcolor{comment}{  ///         |       | |       |         A : Midpoint of edge 0}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00060}00060 \textcolor{comment}{  ///        |   Q\_0   |   Q\_1   |        B : Midpoint of edge 1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00061}00061 \textcolor{comment}{  ///       |          |          |       C : Midpoint of edge 2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00062}00062 \textcolor{comment}{  ///      |           |           |}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00063}00063 \textcolor{comment}{  ///     N0 \_\_\_\_\_\_\_\_\_\_|\_\_\_\_\_\_\_\_\_\_ N1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00064}00064 \textcolor{comment}{  ///                  A}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00065}00065 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00066}00066 \textcolor{comment}{  /// The intersection of all three quad elements is the centroid. Using}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00067}00067 \textcolor{comment}{  /// this splitting, the subsequent mesh will consist of quadrilaterals}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00068}00068 \textcolor{comment}{  /// whose shape which depend on the structure of the underlying mesh.}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00069}00069 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00070}00070   \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00071}\mbox{\hyperlink{classoomph_1_1QuadFromTriangleMesh_ae4146d9e92cce365c292f92fcdc88c47}{00071}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1QuadFromTriangleMesh_ae4146d9e92cce365c292f92fcdc88c47}{QuadFromTriangleMesh<ELEMENT>::build\_from\_scaffold}}(}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00072}00072     \mbox{\hyperlink{classoomph_1_1TriangleScaffoldMesh}{TriangleScaffoldMesh}}* tmp\_mesh\_pt,}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00073}00073     \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00074}00074     \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& use\_attributes)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00075}00075   \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00076}00076     \textcolor{comment}{// Create space for elements}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00077}00077     \textcolor{keywordtype}{unsigned} nelem = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00079}00079     \textcolor{comment}{// We will have 3 quad elements per scaffold element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00080}00080     Element\_pt.resize(3 * nelem);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00082}00082     \textcolor{comment}{// Set number of boundaries}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00083}00083     \textcolor{keywordtype}{unsigned} nbound = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00085}00085     \textcolor{comment}{// Resize the boundary information (the number of boundaries doesn't}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00086}00086     \textcolor{comment}{// change)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00087}00087     set\_nboundary(nbound);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00089}00089     \textcolor{comment}{// Stores each element attached to a boundary and the index of the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00090}00090     \textcolor{comment}{// face of the given element attached to the boundary}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00091}00091     Boundary\_element\_pt.resize(nbound);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00092}00092     Face\_index\_at\_boundary.resize(nbound);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00093}00093 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00094}00094     \textcolor{comment}{// Create a quad element for nodal data}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00095}00095     ELEMENT* temp\_el\_pt = \textcolor{keyword}{new} ELEMENT;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00097}00097     \textcolor{comment}{// Get the number of nodes in a quad element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00098}00098     \textcolor{keywordtype}{unsigned} nnode\_el = temp\_el\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00099}00099 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00100}00100     \textcolor{comment}{// Find the number of nodes along one edge of a quad element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00101}00101     \textcolor{keywordtype}{unsigned} nnode\_1d = temp\_el\_pt-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00103}00103     \textcolor{comment}{// Calculate the number of nodes that will lie along an edge of a}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00104}00104     \textcolor{comment}{// triangle element in the scaffold mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00105}00105     \textcolor{keywordtype}{unsigned} nnode\_edge = 2 * nnode\_1d -\/ 1;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00106}00106 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00107}00107     \textcolor{comment}{// Delete the element pointer}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00108}00108     \textcolor{keyword}{delete} temp\_el\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00109}00109 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00110}00110     \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00111}00111     temp\_el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00112}00112 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00113}00113     \textcolor{comment}{// Create dummy linear quad for geometry}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00114}00114     \mbox{\hyperlink{classoomph_1_1QElement}{QElement<2, 2>}} dummy\_element;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00116}00116     \textcolor{comment}{// The dimension of the element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00117}00117     \textcolor{keywordtype}{unsigned} n\_dim = 2;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00119}00119     \textcolor{comment}{// The position type}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00120}00120     \textcolor{keywordtype}{unsigned} n\_position\_type = 1;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00121}00121 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00122}00122     \textcolor{comment}{// Don't assign memory for any values}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00123}00123     \textcolor{keywordtype}{unsigned} initial\_n\_value = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00125}00125     \textcolor{comment}{// Loop over the nodes of the element and make them}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00126}00126     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 4; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00127}00127     \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00128}00128       dummy\_element.node\_pt(j) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00129}00129         \textcolor{keyword}{new} Node(n\_dim, n\_position\_type, initial\_n\_value);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00130}00130     \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00132}00132     \textcolor{comment}{// Local node number of each quad element corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00133}00133     \textcolor{keywordtype}{unsigned} corner\_0 = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00134}00134     \textcolor{keywordtype}{unsigned} corner\_1 = nnode\_1d -\/ 1;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00135}00135     \textcolor{keywordtype}{unsigned} corner\_2 = nnode\_el -\/ nnode\_1d;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00136}00136     \textcolor{keywordtype}{unsigned} corner\_3 = nnode\_el -\/ 1;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00138}00138     \textcolor{comment}{// Create a map to return a vector of pointers to nnode\_1d nodes where}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00139}00139     \textcolor{comment}{// the input is an edge. If the edge hasn't been set up then this will}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00140}00140     \textcolor{comment}{// return a null pointer. Note: all node pointers on an edge will be}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00141}00141     \textcolor{comment}{// stored in clockwise ordering. Therefore, to copy the data of an}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00142}00142     \textcolor{comment}{// edge into the adjoining element we must proceed through the vector}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00143}00143     \textcolor{comment}{// backwards (as progressing through an edge of an element in a clockwise}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00144}00144     \textcolor{comment}{// manner is equivalent to proceeding through the edge of the neighbouring}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00145}00145     \textcolor{comment}{// element in an anti-\/clockwise manner)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00146}00146     std::map<Edge, Vector<Node*>> edge\_nodes\_map;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00148}00148     \textcolor{comment}{// Set up a map to check if the scaffold mesh node has been set up in the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00149}00149     \textcolor{comment}{// quad mesh. If the node has been set up this map will return a pointer}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00150}00150     \textcolor{comment}{// to it otherwise it will return a null pointer}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00151}00151     std::map<Node*, Node*> scaffold\_to\_quad\_mesh\_node;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00152}00152 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00153}00153     \textcolor{comment}{// Loop over elements in scaffold mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00154}00154     \textcolor{keywordtype}{unsigned} new\_el\_count = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00156}00156     \textcolor{comment}{// Create storage for the coordinates of the centroid}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00157}00157     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} centroid(2);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00158}00158 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00159}00159     \textcolor{comment}{// Create storage for the coordinates of the vertices of the triangle}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00160}00160     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> triangle\_vertex(3);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00162}00162     \textcolor{comment}{// Loop over all of the elements in the scaffold mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00163}00163     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00164}00164     \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00165}00165       \textcolor{comment}{// Initialise centroid values for the e-\/th triangle element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00166}00166       centroid[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00167}00167       centroid[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00169}00169       \textcolor{comment}{// Loop over the scaffold element nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00170}00170       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00171}00171       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00172}00172         \textcolor{comment}{// Resize the j-\/th triangle\_vertex entry to contain the x and}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00173}00173         \textcolor{comment}{// y-\/coordinate}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00174}00174         triangle\_vertex[j].resize(2);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00176}00176         \textcolor{comment}{// Get the coordinates}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00177}00177         \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}} = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>x(0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00178}00178         \textcolor{keywordtype}{double} y = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>x(1);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00179}00179 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00180}00180         \textcolor{comment}{// Increment the centroid coordinates}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00181}00181         centroid[0] += \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00182}00182         centroid[1] += y;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00183}00183 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00184}00184         \textcolor{comment}{// Assign the triangle\_vertex coordinates}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00185}00185         triangle\_vertex[j][0] = \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00186}00186         triangle\_vertex[j][1] = y;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00187}00187       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00188}00188 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00189}00189       \textcolor{comment}{// Divide the centroid entries by 3 to get the centroid coordinates}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00190}00190       centroid[0] /= 3.0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00191}00191       centroid[1] /= 3.0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00192}00192 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00193}00193       \textcolor{comment}{// Create element pointers and assign them to a vector}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00194}00194       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00195}00195       \textcolor{comment}{// Make new quad elements of the type specified by the template parameter}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00196}00196       ELEMENT* el0\_pt = \textcolor{keyword}{new} ELEMENT;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00197}00197       ELEMENT* el1\_pt = \textcolor{keyword}{new} ELEMENT;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00198}00198       ELEMENT* el2\_pt = \textcolor{keyword}{new} ELEMENT;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00200}00200       \textcolor{comment}{// Create a vector of ELEMENTs to store el0\_pt, el1\_pt and el2\_pt}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00201}00201       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<ELEMENT*>}} el\_vector\_pt(3, 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00203}00203       \textcolor{comment}{// Assign the entries to el\_vector\_pt}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00204}00204       el\_vector\_pt[0] = el0\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00205}00205       el\_vector\_pt[1] = el1\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00206}00206       el\_vector\_pt[2] = el2\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00208}00208 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00209}00209       \textcolor{comment}{// Create the first node in each quad element and store in Node\_pt.}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00210}00210       \textcolor{comment}{// These correspond to the nodes of the simplex triangle stored in}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00211}00211       \textcolor{comment}{// Tmp\_mesh\_pt. If they have already been set up then we do nothing:}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00212}00212       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00213}00213       \textcolor{comment}{// Loop over the scaffold element nodes and check to see if they have}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00214}00214       \textcolor{comment}{// been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00215}00215       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00216}00216       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00217}00217         \textcolor{comment}{// Pointer to node in the scaffold mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00218}00218         Node* scaffold\_node\_pt = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00219}00219 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00220}00220         \textcolor{comment}{// Check if the node has been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00221}00221         Node* qmesh\_node\_pt = scaffold\_to\_quad\_mesh\_node[scaffold\_node\_pt];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00222}00222 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00223}00223         \textcolor{comment}{// Haven't done this one yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00224}00224         \textcolor{keywordflow}{if} (qmesh\_node\_pt == 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00225}00225         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00226}00226           \textcolor{comment}{// Get pointer to set of mesh boundaries that this}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00227}00227           \textcolor{comment}{// scaffold node occupies; NULL if the node is not on any boundary}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00228}00228           std::set<unsigned>* boundaries\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00229}00229           scaffold\_node\_pt-\/>get\_boundaries\_pt(boundaries\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00230}00230 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00231}00231           \textcolor{comment}{// Check to see if it's on any boundaries}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00232}00232           \textcolor{keywordflow}{if} (boundaries\_pt != 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00233}00233           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00234}00234             \textcolor{comment}{// Create new boundary node. The scaffold element nodes are the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00235}00235             \textcolor{comment}{// corners of a simplex triangle and thus always correspond to the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00236}00236             \textcolor{comment}{// first node in each quad element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00237}00237             qmesh\_node\_pt = el\_vector\_pt[j]-\/>construct\_boundary\_node(}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00238}00238               corner\_0, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00240}00240             \textcolor{comment}{// Add to boundaries}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00241}00241             \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries\_pt-\/>begin();}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00242}00242                  it != boundaries\_pt-\/>end();}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00243}00243                  ++it)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00244}00244             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00245}00245               add\_boundary\_node(*it, qmesh\_node\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00246}00246             \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00247}00247           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00248}00248           \textcolor{comment}{// Build normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00249}00249           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00250}00250           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00251}00251             \textcolor{comment}{// Create new normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00252}00252             qmesh\_node\_pt =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00253}00253               el\_vector\_pt[j]-\/>construct\_node(corner\_0, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00254}00254           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00256}00256           \textcolor{comment}{// Add the mapping from the scaffold mesh node to the quad mesh node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00257}00257           scaffold\_to\_quad\_mesh\_node[scaffold\_node\_pt] = qmesh\_node\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00258}00258 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00259}00259           \textcolor{comment}{// Copy new node, created using the NEW element's construct\_node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00260}00260           \textcolor{comment}{// function into global storage, using the same global}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00261}00261           \textcolor{comment}{// node number that we've just associated with the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00262}00262           \textcolor{comment}{// corresponding node in the scaffold mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00263}00263           Node\_pt.push\_back(qmesh\_node\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00264}00264         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00265}00265         \textcolor{comment}{// If this node has already been done we need to copy the data across}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00266}00266         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00267}00267         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00268}00268           el\_vector\_pt[j]-\/>node\_pt(corner\_0) = qmesh\_node\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00269}00269         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00271}00271 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00272}00272         \textcolor{comment}{// Set global coordinate}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00273}00273         el\_vector\_pt[j]-\/>node\_pt(corner\_0)-\/>x(0) = triangle\_vertex[j][0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00274}00274         el\_vector\_pt[j]-\/>node\_pt(corner\_0)-\/>x(1) = triangle\_vertex[j][1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00275}00275       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00276}00276 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00277}00277 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00278}00278       \textcolor{comment}{// Create the edges of the scaffold element and check to see if}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00279}00279       \textcolor{comment}{// they've been set up yet or not. If they haven't:}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00280}00280       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00281}00281       \textcolor{comment}{// Make the three edges of the triangle}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00282}00282       \mbox{\hyperlink{classoomph_1_1Edge}{Edge}} edge0(tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0),}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00283}00283                  tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(1));}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00284}00284       \mbox{\hyperlink{classoomph_1_1Edge}{Edge}} edge1(tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(1),}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00285}00285                  tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(2));}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00286}00286       \mbox{\hyperlink{classoomph_1_1Edge}{Edge}} edge2(tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(2),}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00287}00287                  tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0));}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00288}00288 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00289}00289       \textcolor{comment}{// Check if the edges have been set up (each will have size nnode\_1d).}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00290}00290       \textcolor{comment}{// If they have not been set up yet, this will}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00291}00291       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} edge0\_vector\_pt = edge\_nodes\_map[edge0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00292}00292       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} edge1\_vector\_pt = edge\_nodes\_map[edge1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00293}00293       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} edge2\_vector\_pt = edge\_nodes\_map[edge2];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00295}00295       \textcolor{comment}{// Bools to indicate whether or not the edges have been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00296}00296       \textcolor{keywordtype}{bool} edge0\_setup = (edge0\_vector\_pt.size() != 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00297}00297       \textcolor{keywordtype}{bool} edge1\_setup = (edge1\_vector\_pt.size() != 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00298}00298       \textcolor{keywordtype}{bool} edge2\_setup = (edge2\_vector\_pt.size() != 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00299}00299 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00300}00300       \textcolor{comment}{// If edge 0 hasn't been set up (node 0 to node 1)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00301}00301       \textcolor{keywordflow}{if} (!edge0\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00302}00302       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00303}00303         \textcolor{comment}{// Resize the vector to have length nnode\_1d}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00304}00304         edge0\_vector\_pt.resize(nnode\_edge, 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00305}00305 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00306}00306         \textcolor{comment}{// First node along edge 0 is the first node of element 0}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00307}00307         edge0\_vector\_pt[0] = el\_vector\_pt[0]-\/>node\_pt(0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00308}00308 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00309}00309         \textcolor{comment}{// Last node along edge 0 is the first node of element 1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00310}00310         edge0\_vector\_pt[nnode\_edge -\/ 1] = el\_vector\_pt[1]-\/>node\_pt(0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00311}00311       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00313}00313       \textcolor{comment}{// If edge 1 hasn't been set up (node 1 to node 2)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00314}00314       \textcolor{keywordflow}{if} (!edge1\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00315}00315       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00316}00316         \textcolor{comment}{// Resize the vector to have length nnode\_1d}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00317}00317         edge1\_vector\_pt.resize(nnode\_edge, 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00318}00318 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00319}00319         \textcolor{comment}{// First node along edge 1 is the first node of element 1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00320}00320         edge1\_vector\_pt[0] = el\_vector\_pt[1]-\/>node\_pt(0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00321}00321 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00322}00322         \textcolor{comment}{// Last node along edge 1 is the first node of element 2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00323}00323         edge1\_vector\_pt[nnode\_edge -\/ 1] = el\_vector\_pt[2]-\/>node\_pt(0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00324}00324       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00325}00325 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00326}00326       \textcolor{comment}{// If edge 2 hasn't been set up (node 2 to node 0)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00327}00327       \textcolor{keywordflow}{if} (!edge2\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00328}00328       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00329}00329         \textcolor{comment}{// Resize the vector to have length nnode\_1d}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00330}00330         edge2\_vector\_pt.resize(nnode\_edge, 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00331}00331 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00332}00332         \textcolor{comment}{// First node along edge 2 is the first node of element 2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00333}00333         edge2\_vector\_pt[0] = el\_vector\_pt[2]-\/>node\_pt(0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00334}00334 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00335}00335         \textcolor{comment}{// Last node along edge 2 is the first node of element 0}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00336}00336         edge2\_vector\_pt[nnode\_edge -\/ 1] = el\_vector\_pt[0]-\/>node\_pt(0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00337}00337       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00338}00338 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00339}00339 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00340}00340 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00341}00341       \textcolor{comment}{// If any of the edges have been set up, make sure that that the endpoints}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00342}00342       \textcolor{comment}{// in the returned vectors have the same address as those on the vertices}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00343}00343 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00344}00344       \textcolor{comment}{// Come back and finish this off.}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00345}00345       \textcolor{comment}{// To check:}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00346}00346       \textcolor{comment}{//    -\/ If two edges which have been set up have the same node in the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00347}00347       \textcolor{comment}{//    middle}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00348}00348       \textcolor{comment}{//    -\/ If an edge has already been set up then the map will return the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00349}00349       \textcolor{comment}{//      same node as in the vector}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00350}00350 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00352}00352       \textcolor{comment}{// Boundary IDs for bottom and left edge of quad}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00353}00353       \textcolor{comment}{// from scaffold mesh (if these remain zero the edges}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00354}00354       \textcolor{comment}{// are not on a boundary)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00355}00355       \textcolor{keywordtype}{unsigned} q0\_lower\_boundary\_id = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00356}00356       \textcolor{keywordtype}{unsigned} q0\_left\_boundary\_id = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00357}00357       \textcolor{keywordtype}{unsigned} q1\_lower\_boundary\_id = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00358}00358       \textcolor{keywordtype}{unsigned} q1\_left\_boundary\_id = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00359}00359       \textcolor{keywordtype}{unsigned} q2\_lower\_boundary\_id = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00360}00360       \textcolor{keywordtype}{unsigned} q2\_left\_boundary\_id = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00362}00362       \textcolor{comment}{// Lower/left boundary IDs for quad 0; the lower edge in quad 0 is on}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00363}00363       \textcolor{comment}{// edge 0 of the scaffold triangle and the left edge in quad is on edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00364}00364       \textcolor{comment}{// 2 in scaffold triangle}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00365}00365       q0\_lower\_boundary\_id = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TriangleScaffoldMesh_abf7347ae13ede0f3b7b7510e86a82bf5}{edge\_boundary}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}, 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00366}00366       q0\_left\_boundary\_id = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TriangleScaffoldMesh_abf7347ae13ede0f3b7b7510e86a82bf5}{edge\_boundary}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}, 2);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00367}00367 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00368}00368       \textcolor{comment}{// Lower/left boundary IDs for quad 1; the lower edge in quad 1 is on}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00369}00369       \textcolor{comment}{// edge 1 of the scaffold triangle and the left edge in quad is on edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00370}00370       \textcolor{comment}{// 0 of the scaffold triangle}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00371}00371       q1\_lower\_boundary\_id = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TriangleScaffoldMesh_abf7347ae13ede0f3b7b7510e86a82bf5}{edge\_boundary}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}, 1);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00372}00372       q1\_left\_boundary\_id = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TriangleScaffoldMesh_abf7347ae13ede0f3b7b7510e86a82bf5}{edge\_boundary}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}, 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00374}00374       \textcolor{comment}{// Lower/left boundary IDs for quad 2; the lower edge in quad 2 is on}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00375}00375       \textcolor{comment}{// edge 2 of the scaffold triangle and the left edge in quad is on edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00376}00376       \textcolor{comment}{// 1 of the scaffold triangle}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00377}00377       q2\_lower\_boundary\_id = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TriangleScaffoldMesh_abf7347ae13ede0f3b7b7510e86a82bf5}{edge\_boundary}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}, 2);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00378}00378       q2\_left\_boundary\_id = tmp\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TriangleScaffoldMesh_abf7347ae13ede0f3b7b7510e86a82bf5}{edge\_boundary}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}, 1);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00379}00379 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00380}00380       \textcolor{comment}{// Store the boundary IDs as a vector; allows us to loop over them easily}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00381}00381       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} boundary\_id\_vector(6, 0);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00382}00382       boundary\_id\_vector[0] = q0\_lower\_boundary\_id;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00383}00383       boundary\_id\_vector[1] = q0\_left\_boundary\_id;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00384}00384       boundary\_id\_vector[2] = q1\_lower\_boundary\_id;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00385}00385       boundary\_id\_vector[3] = q1\_left\_boundary\_id;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00386}00386       boundary\_id\_vector[4] = q2\_lower\_boundary\_id;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00387}00387       boundary\_id\_vector[5] = q2\_left\_boundary\_id;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00388}00388 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00389}00389       \textcolor{comment}{// Loop over the quad elements and store the boundary elements in the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00390}00390       \textcolor{comment}{// vector Boundary\_element\_pt}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00391}00391       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00392}00392       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00393}00393         \textcolor{comment}{// Loop over the lower and the left boundary ID in the j'th element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00394}00394         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < 2; k++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00395}00395         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00396}00396           \textcolor{comment}{// The quad element lies on a boundary of the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00397}00397           \textcolor{keywordflow}{if} (boundary\_id\_vector[2 * j + k] > 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00398}00398           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00399}00399             \textcolor{comment}{// Since the j'th quad element lies on a boundary of the mesh we add}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00400}00400             \textcolor{comment}{// a pointer to the element to the appropriate entry of}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00401}00401             \textcolor{comment}{// Boundary\_element\_pt}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00402}00402             Boundary\_element\_pt[boundary\_id\_vector[2 * j + k] -\/ 1].push\_back(}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00403}00403               el\_vector\_pt[j]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00405}00405             \textcolor{comment}{// If k=0 then the lower boundary of the quad element lies on}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00406}00406             \textcolor{comment}{// the boundary of the mesh and if k=1 then the left boundary}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00407}00407             \textcolor{comment}{// of the quad element lies on the mesh boundary. For quad elements}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00408}00408             \textcolor{comment}{// the indices are as follows:}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00409}00409             \textcolor{comment}{//       North face: 2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00410}00410             \textcolor{comment}{//       East face: 1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00411}00411             \textcolor{comment}{//       South face: -\/2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00412}00412             \textcolor{comment}{//       West face: -\/1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00413}00413             \textcolor{keywordflow}{if} (k == 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00414}00414             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00415}00415               Face\_index\_at\_boundary[boundary\_id\_vector[2 * j + k] -\/ 1]}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00416}00416                 .push\_back(-\/2);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00417}00417             \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00418}00418             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00419}00419             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00420}00420               Face\_index\_at\_boundary[boundary\_id\_vector[2 * j + k] -\/ 1]}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00421}00421                 .push\_back(-\/1);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00422}00422             \} \textcolor{comment}{// if (k==0)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00423}00423           \} \textcolor{comment}{// if (boundary\_id\_vector[2*j+k]>0)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00424}00424         \} \textcolor{comment}{// for (unsigned k=0;k<2;k++)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00425}00425       \} \textcolor{comment}{// for (unsigned j=0;j<3;j++)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00426}00426 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00428}00428       \textcolor{comment}{// The upper right node is always the centroid. Note: The 'corner\_3' node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00429}00429       \textcolor{comment}{// lies within each of the three quad elements so we simply share the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00430}00430       \textcolor{comment}{// pointer to it with each element:}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00431}00431       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00432}00432       \textcolor{comment}{// Construct the centroid node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00433}00433       Node* nod\_pt = el0\_pt-\/>construct\_node(corner\_3, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00434}00434 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00435}00435       \textcolor{comment}{// Add the pointer to the vector of nodal pointers}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00436}00436       Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00437}00437 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00438}00438       \textcolor{comment}{// Quad 0}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00439}00439       el0\_pt-\/>node\_pt(corner\_3)-\/>x(0) = centroid[0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00440}00440       el0\_pt-\/>node\_pt(corner\_3)-\/>x(1) = centroid[1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00441}00441 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00442}00442       \textcolor{comment}{// Quad 1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00443}00443       el1\_pt-\/>node\_pt(corner\_3) = el0\_pt-\/>node\_pt(corner\_3);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00444}00444 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00445}00445       \textcolor{comment}{// Quad 2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00446}00446       el2\_pt-\/>node\_pt(corner\_3) = el0\_pt-\/>node\_pt(corner\_3);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00447}00447 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00448}00448 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00449}00449       \textcolor{comment}{// Set the nodal positions of the dummy element to emulate the FIRST}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00450}00450       \textcolor{comment}{// quad element (this allows for simple linear interpolation later):}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00451}00451       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00452}00452       \textcolor{comment}{// Bottom-\/left corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00453}00453       dummy\_element.node\_pt(0)-\/>x(0) = triangle\_vertex[0][0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00454}00454       dummy\_element.node\_pt(0)-\/>x(1) = triangle\_vertex[0][1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00455}00455 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00456}00456       \textcolor{comment}{// Bottom-\/right corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00457}00457       dummy\_element.node\_pt(1)-\/>x(0) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00458}00458         0.5 * (triangle\_vertex[0][0] + triangle\_vertex[1][0]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00459}00459       dummy\_element.node\_pt(1)-\/>x(1) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00460}00460         0.5 * (triangle\_vertex[0][1] + triangle\_vertex[1][1]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00462}00462       \textcolor{comment}{// Top-\/left corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00463}00463       dummy\_element.node\_pt(2)-\/>x(0) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00464}00464         0.5 * (triangle\_vertex[0][0] + triangle\_vertex[2][0]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00465}00465       dummy\_element.node\_pt(2)-\/>x(1) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00466}00466         0.5 * (triangle\_vertex[0][1] + triangle\_vertex[2][1]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00467}00467 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00468}00468       \textcolor{comment}{// Top-\/right corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00469}00469       dummy\_element.node\_pt(3)-\/>x(0) = centroid[0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00470}00470       dummy\_element.node\_pt(3)-\/>x(1) = centroid[1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00471}00471 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00472}00472 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00473}00473       \textcolor{comment}{// Set up all of the nodes in the first quad element (Q0):}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00474}00474       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00475}00475       \textcolor{comment}{// Local and global coordinate vectors for the nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00476}00476       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00477}00477       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}(2);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00479}00479       \textcolor{comment}{// Loop over all of nodes in Q0 noting that the lower left corner node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00480}00480       \textcolor{comment}{// (node 0) and the upper right corner node (centroid) have already}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00481}00481       \textcolor{comment}{// been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00482}00482       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 1; j < corner\_3; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00483}00483       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00484}00484         \textcolor{comment}{// Indicates whether or not the node has been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00485}00485         \textcolor{keywordtype}{bool} done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00486}00486 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00487}00487         \textcolor{comment}{// On the lower edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00488}00488         \textcolor{keywordflow}{if} (j < nnode\_1d)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00489}00489         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00490}00490           \textcolor{comment}{// If the lower edge has already been set up then we already know the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00491}00491           \textcolor{comment}{// nodes along this edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00492}00492           \textcolor{keywordflow}{if} (edge0\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00493}00493           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00494}00494             \textcolor{comment}{// The j'th node along this edge is the (nnode\_1d-\/j)'th node in the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00495}00495             \textcolor{comment}{// vector (remembering that the ordering is backwards since it has}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00496}00496             \textcolor{comment}{// already been set up)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00497}00497             el0\_pt-\/>node\_pt(j) = edge0\_vector\_pt[(nnode\_edge -\/ 1) -\/ j];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00499}00499             \textcolor{comment}{// Since the node has already been set up we do not need to sort}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00500}00500             \textcolor{comment}{// out its global coordinate data so skip to the next node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00501}00501             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00502}00502           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00503}00503           \textcolor{comment}{// If the edge hasn't been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00504}00504           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00505}00505           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00506}00506             \textcolor{comment}{// If the node lies on a boundary too then we need to construct a}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00507}00507             \textcolor{comment}{// boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00508}00508             \textcolor{keywordflow}{if} (q0\_lower\_boundary\_id > 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00509}00509             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00510}00510               \textcolor{comment}{// Construct a boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00511}00511               Node* nod\_pt =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00512}00512                 el0\_pt-\/>construct\_boundary\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00514}00514               \textcolor{comment}{// Add it to the list of boundary nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00515}00515               add\_boundary\_node(q0\_lower\_boundary\_id -\/ 1, nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00516}00516 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00517}00517               \textcolor{comment}{// Add the node into the vector of nodes on edge 0}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00518}00518               edge0\_vector\_pt[j] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00519}00519 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00520}00520               \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00521}00521               Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00522}00522 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00523}00523               \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00524}00524               done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00525}00525             \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00526}00526           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00528}00528           \textcolor{comment}{// Node is not on a mesh boundary but on the lower edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00529}00529           \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00530}00530           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00531}00531             \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00532}00532             Node* nod\_pt = el0\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00533}00533 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00534}00534             \textcolor{comment}{// Add the node into the vector of nodes on edge 0}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00535}00535             edge0\_vector\_pt[j] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00537}00537             \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00538}00538             Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00539}00539 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00540}00540             \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00541}00541             done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00542}00542           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00543}00543         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00544}00544         \textcolor{comment}{// On the left edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00545}00545         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j \% nnode\_1d == 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00546}00546         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00547}00547           \textcolor{comment}{// If the left edge has already been set up then we already know the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00548}00548           \textcolor{comment}{// nodes along this edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00549}00549           \textcolor{keywordflow}{if} (edge2\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00550}00550           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00551}00551             \textcolor{comment}{// The j'th node is the (j/nnode\_1d)'th node along this edge and}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00552}00552             \textcolor{comment}{// thus the (j/nnode\_1d)'th entry in the edge vector}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00553}00553             el0\_pt-\/>node\_pt(j) = edge2\_vector\_pt[j / nnode\_1d];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00554}00554 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00555}00555             \textcolor{comment}{// Since the node has already been set up we do not need to sort}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00556}00556             \textcolor{comment}{// out its global coordinate data}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00557}00557             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00558}00558           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00559}00559           \textcolor{comment}{// If the edge hasn't been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00560}00560           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00561}00561           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00562}00562             \textcolor{keywordflow}{if} (q0\_left\_boundary\_id > 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00563}00563             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00564}00564               \textcolor{comment}{// Construct a boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00565}00565               Node* nod\_pt =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00566}00566                 el0\_pt-\/>construct\_boundary\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00567}00567 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00568}00568               \textcolor{comment}{// Add it to the list of boundary nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00569}00569               add\_boundary\_node(q0\_left\_boundary\_id -\/ 1, nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00570}00570 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00571}00571               \textcolor{comment}{// Add the node into the vector of nodes on edge 2 in clockwise}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00572}00572               \textcolor{comment}{// order}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00573}00573               edge2\_vector\_pt[(nnode\_edge -\/ 1) -\/ (j / nnode\_1d)] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00574}00574 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00575}00575               \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00576}00576               Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00577}00577 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00578}00578               \textcolor{comment}{// Indicate that the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00579}00579               done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00580}00580             \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00581}00581           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00582}00582 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00583}00583           \textcolor{comment}{// Node is not on a mesh boundary but on the left edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00584}00584           \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00585}00585           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00586}00586             \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00587}00587             Node* nod\_pt = el0\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00588}00588 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00589}00589             \textcolor{comment}{// Add the node into the vector of nodes on edge 2 in clockwise}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00590}00590             \textcolor{comment}{// order}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00591}00591             edge2\_vector\_pt[(nnode\_edge -\/ 1) -\/ (j / nnode\_1d)] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00592}00592 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00593}00593             \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00594}00594             Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00595}00595 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00596}00596             \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00597}00597             done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00598}00598           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00599}00599         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00600}00600 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00601}00601         \textcolor{comment}{// Node is not on a mesh boundary or on the edge of the scaffold element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00602}00602         \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00603}00603         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00604}00604           \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00605}00605           Node* nod\_pt = el0\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00606}00606 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00607}00607           \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00608}00608           Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00609}00609         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00610}00610 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00611}00611         \textcolor{comment}{// Get local coordinate}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00612}00612         el0\_pt-\/>local\_coordinate\_of\_node(j, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00613}00613 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00614}00614         \textcolor{comment}{// Interpolate position linearly between vertex nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00615}00615         dummy\_element.interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}});}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00616}00616         el0\_pt-\/>node\_pt(j)-\/>x(0) = \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00617}00617         el0\_pt-\/>node\_pt(j)-\/>x(1) = \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00618}00618       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00619}00619 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00620}00620 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00621}00621       \textcolor{comment}{// Set the nodal positions of the dummy element to now emulate the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00622}00622       \textcolor{comment}{// SECOND quad element:}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00623}00623       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00624}00624       \textcolor{comment}{// Note: we do not need to change the top-\/right corner since it always}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00625}00625       \textcolor{comment}{// coincides with the centroid of the triangle element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00626}00626 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00627}00627       \textcolor{comment}{// Bottom-\/left corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00628}00628       dummy\_element.node\_pt(0)-\/>x(0) = triangle\_vertex[1][0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00629}00629       dummy\_element.node\_pt(0)-\/>x(1) = triangle\_vertex[1][1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00630}00630 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00631}00631       \textcolor{comment}{// Bottom-\/right corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00632}00632       dummy\_element.node\_pt(1)-\/>x(0) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00633}00633         0.5 * (triangle\_vertex[1][0] + triangle\_vertex[2][0]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00634}00634       dummy\_element.node\_pt(1)-\/>x(1) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00635}00635         0.5 * (triangle\_vertex[1][1] + triangle\_vertex[2][1]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00637}00637       \textcolor{comment}{// Top-\/left corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00638}00638       dummy\_element.node\_pt(2)-\/>x(0) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00639}00639         0.5 * (triangle\_vertex[0][0] + triangle\_vertex[1][0]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00640}00640       dummy\_element.node\_pt(2)-\/>x(1) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00641}00641         0.5 * (triangle\_vertex[0][1] + triangle\_vertex[1][1]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00642}00642 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00643}00643 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00644}00644       \textcolor{comment}{// Set up all of the nodes in the second quad element (Q1):}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00645}00645       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00646}00646       \textcolor{comment}{// Here we need to notice that we have already set up the final nnode\_1d}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00647}00647       \textcolor{comment}{// nodes (the upper edge of Q1 coincides with the right edge of Q0)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00648}00648 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00649}00649       \textcolor{comment}{// Loop over nodes 1 to (corner\_2-\/1) in Q1 noting that the lower left}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00650}00650       \textcolor{comment}{// corner node (node 0) and the upper edge of Q1 contains nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00651}00651       \textcolor{comment}{// corner\_2 to corner\_3}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00652}00652       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 1; j < corner\_2; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00653}00653       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00654}00654         \textcolor{comment}{// Indicates whether or not the node has been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00655}00655         \textcolor{keywordtype}{bool} done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00656}00656 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00657}00657         \textcolor{comment}{// On the lower edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00658}00658         \textcolor{keywordflow}{if} (j < nnode\_1d)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00659}00659         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00660}00660           \textcolor{comment}{// If the lower edge has already been set up then we already know the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00661}00661           \textcolor{comment}{// nodes along this edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00662}00662           \textcolor{keywordflow}{if} (edge1\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00663}00663           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00664}00664             \textcolor{comment}{// The j'th node along this edge is the (nnode\_1d-\/j)'th node in the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00665}00665             \textcolor{comment}{// vector (remembering that the ordering is backwards if it has}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00666}00666             \textcolor{comment}{// already been set up)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00667}00667             el1\_pt-\/>node\_pt(j) = edge1\_vector\_pt[(nnode\_edge -\/ 1) -\/ j];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00668}00668 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00669}00669             \textcolor{comment}{// Since the node has already been set up we do not need to sort}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00670}00670             \textcolor{comment}{// out its global coordinate data}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00671}00671             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00672}00672           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00673}00673           \textcolor{comment}{// If the edge hasn't been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00674}00674           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00675}00675           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00676}00676             \textcolor{comment}{// If the node lies on a boundary too then we need to construct a}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00677}00677             \textcolor{comment}{// boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00678}00678             \textcolor{keywordflow}{if} (q1\_lower\_boundary\_id > 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00679}00679             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00680}00680               \textcolor{comment}{// Construct a boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00681}00681               Node* nod\_pt =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00682}00682                 el1\_pt-\/>construct\_boundary\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00683}00683 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00684}00684               \textcolor{comment}{// Add it to the list of boundary nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00685}00685               add\_boundary\_node(q1\_lower\_boundary\_id -\/ 1, nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00686}00686 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00687}00687               \textcolor{comment}{// Add the node into the vector of nodes on edge 1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00688}00688               edge1\_vector\_pt[j] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00690}00690               \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00691}00691               Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00692}00692 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00693}00693               \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00694}00694               done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00695}00695             \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00696}00696           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00697}00697 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00698}00698           \textcolor{comment}{// Node is not on a mesh boundary but on the lower edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00699}00699           \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00700}00700           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00701}00701             \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00702}00702             Node* nod\_pt = el1\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00703}00703 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00704}00704             \textcolor{comment}{// Add the node into the vector of nodes on edge 1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00705}00705             edge1\_vector\_pt[j] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00706}00706 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00707}00707             \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00708}00708             Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00709}00709 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00710}00710             \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00711}00711             done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00712}00712           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00713}00713         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00714}00714         \textcolor{comment}{// On the left edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00715}00715         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j \% nnode\_1d == 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00716}00716         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00717}00717           \textcolor{comment}{// If the left edge has already been set up then we already know the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00718}00718           \textcolor{comment}{// nodes along this edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00719}00719           \textcolor{keywordflow}{if} (edge0\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00720}00720           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00721}00721             \textcolor{comment}{// The j'th node along this edge is the (j/nnode\_1d)'th node in the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00722}00722             \textcolor{comment}{// vector}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00723}00723             el1\_pt-\/>node\_pt(j) = edge0\_vector\_pt[j / nnode\_1d];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00724}00724 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00725}00725             \textcolor{comment}{// Since the node has already been set up we do not need to sort}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00726}00726             \textcolor{comment}{// out its global coordinate data}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00727}00727             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00728}00728           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00729}00729           \textcolor{comment}{// If the edge hasn't been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00730}00730           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00731}00731           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00732}00732             \textcolor{keywordflow}{if} (q1\_left\_boundary\_id > 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00733}00733             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00734}00734               \textcolor{comment}{// Construct a boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00735}00735               Node* nod\_pt =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00736}00736                 el1\_pt-\/>construct\_boundary\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00737}00737 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00738}00738               \textcolor{comment}{// Add it to the list of boundary nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00739}00739               add\_boundary\_node(q1\_left\_boundary\_id -\/ 1, nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00740}00740 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00741}00741               \textcolor{comment}{// Add the node into the vector of nodes on edge 0 in clockwise}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00742}00742               \textcolor{comment}{// order}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00743}00743               edge0\_vector\_pt[(nnode\_edge -\/ 1) -\/ (j / nnode\_1d)] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00744}00744 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00745}00745               \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00746}00746               Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00747}00747 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00748}00748               \textcolor{comment}{// Indicate that the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00749}00749               done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00750}00750             \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00751}00751           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00752}00752 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00753}00753           \textcolor{comment}{// Node is not on a mesh boundary but on the left edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00754}00754           \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00755}00755           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00756}00756             \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00757}00757             Node* nod\_pt = el1\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00758}00758 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00759}00759             \textcolor{comment}{// Add the node into the vector of nodes on edge 0 in clockwise}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00760}00760             \textcolor{comment}{// order}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00761}00761             edge0\_vector\_pt[(nnode\_edge -\/ 1) -\/ (j / nnode\_1d)] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00762}00762 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00763}00763             \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00764}00764             Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00765}00765 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00766}00766             \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00767}00767             done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00768}00768           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00769}00769         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00770}00770 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00771}00771         \textcolor{comment}{// Node is not on a mesh boundary or the scaffold element boundary}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00772}00772         \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00773}00773         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00774}00774           \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00775}00775           Node* nod\_pt = el1\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00776}00776 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00777}00777           \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00778}00778           Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00779}00779         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00780}00780 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00781}00781         \textcolor{comment}{// Get local coordinate}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00782}00782         el1\_pt-\/>local\_coordinate\_of\_node(j, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00783}00783 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00784}00784         \textcolor{comment}{// Interpolate position linearly between vertex nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00785}00785         dummy\_element.interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}});}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00786}00786         el1\_pt-\/>node\_pt(j)-\/>x(0) = \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00787}00787         el1\_pt-\/>node\_pt(j)-\/>x(1) = \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00788}00788       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00789}00789 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00790}00790 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00791}00791       \textcolor{comment}{// We now need to loop over nodes corner\_2 to (corner\_3-\/1) and copy the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00792}00792       \textcolor{comment}{// given information from Q0. We do not need to set up the (corner\_3)'th}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00793}00793       \textcolor{comment}{// node since it coincides with the centroid which has already been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00794}00794       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = corner\_2; j < corner\_3; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00795}00795       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00796}00796         \textcolor{comment}{// The nodes along the upper edge of Q1 go from corner\_2 to corner\_3-\/1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00797}00797         \textcolor{comment}{// while the nodes along the right edge of Q0 go from corner\_1 to}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00798}00798         \textcolor{comment}{// (corner\_3-\/nnode\_1d) in increments of nnode\_1d}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00799}00799         el1\_pt-\/>node\_pt(j) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00800}00800           el0\_pt-\/>node\_pt(corner\_1 + (j -\/ corner\_2) * nnode\_1d);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00801}00801       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00802}00802 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00803}00803 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00804}00804       \textcolor{comment}{// Set the nodal positions of the dummy element to now emulate the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00805}00805       \textcolor{comment}{// THIRD quad element:}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00806}00806       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00807}00807       \textcolor{comment}{// Note: we do not need to change the top-\/right corner since it always}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00808}00808       \textcolor{comment}{// coincides with the centroid of the triangle element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00809}00809 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00810}00810       \textcolor{comment}{// Bottom-\/left corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00811}00811       dummy\_element.node\_pt(0)-\/>x(0) = triangle\_vertex[2][0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00812}00812       dummy\_element.node\_pt(0)-\/>x(1) = triangle\_vertex[2][1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00813}00813 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00814}00814       \textcolor{comment}{// Bottom-\/right corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00815}00815       dummy\_element.node\_pt(1)-\/>x(0) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00816}00816         0.5 * (triangle\_vertex[0][0] + triangle\_vertex[2][0]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00817}00817       dummy\_element.node\_pt(1)-\/>x(1) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00818}00818         0.5 * (triangle\_vertex[0][1] + triangle\_vertex[2][1]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00819}00819 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00820}00820       \textcolor{comment}{// Top-\/left corner}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00821}00821       dummy\_element.node\_pt(2)-\/>x(0) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00822}00822         0.5 * (triangle\_vertex[1][0] + triangle\_vertex[2][0]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00823}00823       dummy\_element.node\_pt(2)-\/>x(1) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00824}00824         0.5 * (triangle\_vertex[1][1] + triangle\_vertex[2][1]);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00825}00825 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00826}00826 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00827}00827       \textcolor{comment}{// Set up all of the nodes in the third quad element (Q2):}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00828}00828       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00829}00829       \textcolor{comment}{// Here we need to notice that we have already set up the final nnode\_1d}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00830}00830       \textcolor{comment}{// nodes (the upper edge of Q2 coincides with the right edge of Q1).}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00831}00831       \textcolor{comment}{// We have also already set up the nodes on the right edge of Q2 (the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00832}00832       \textcolor{comment}{// right edge of Q2 coincides with the upper edge of Q0)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00833}00833 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00834}00834       \textcolor{comment}{// Loop over nodes 1 to (corner\_2-\/1)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00835}00835       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 1; j < corner\_2; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00836}00836       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00837}00837         \textcolor{comment}{// Indicates whether or not the node has been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00838}00838         \textcolor{keywordtype}{bool} done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00839}00839 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00840}00840         \textcolor{comment}{// On the lower edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00841}00841         \textcolor{keywordflow}{if} (j < nnode\_1d -\/ 1)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00842}00842         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00843}00843           \textcolor{comment}{// If the lower edge has already been set up then we already know the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00844}00844           \textcolor{comment}{// nodes along this edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00845}00845           \textcolor{keywordflow}{if} (edge2\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00846}00846           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00847}00847             \textcolor{comment}{// The j'th node along this edge is the (nnode\_1d-\/j)'th node in the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00848}00848             \textcolor{comment}{// vector (remembering that the ordering is backwards if it has}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00849}00849             \textcolor{comment}{// already been set up)}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00850}00850             el2\_pt-\/>node\_pt(j) = edge2\_vector\_pt[(nnode\_edge -\/ 1) -\/ j];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00851}00851 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00852}00852             \textcolor{comment}{// Since the node has already been set up we do not need to sort}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00853}00853             \textcolor{comment}{// out its global coordinate data}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00854}00854             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00855}00855           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00856}00856           \textcolor{comment}{// If the edge hasn't been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00857}00857           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00858}00858           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00859}00859             \textcolor{comment}{// If the node lies on a boundary too then we need to construct a}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00860}00860             \textcolor{comment}{// boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00861}00861             \textcolor{keywordflow}{if} (q2\_lower\_boundary\_id > 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00862}00862             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00863}00863               \textcolor{comment}{// Construct a boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00864}00864               Node* nod\_pt =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00865}00865                 el2\_pt-\/>construct\_boundary\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00866}00866 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00867}00867               \textcolor{comment}{// Add it to the list of boundary nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00868}00868               add\_boundary\_node(q2\_lower\_boundary\_id -\/ 1, nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00869}00869 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00870}00870               \textcolor{comment}{// Add the node into the vector of nodes on edge 2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00871}00871               edge2\_vector\_pt[j] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00872}00872 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00873}00873               \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00874}00874               Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00875}00875 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00876}00876               \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00877}00877               done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00878}00878             \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00879}00879           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00880}00880 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00881}00881           \textcolor{comment}{// Node is not on a mesh boundary but on the lower edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00882}00882           \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00883}00883           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00884}00884             \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00885}00885             Node* nod\_pt = el2\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00886}00886 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00887}00887             \textcolor{comment}{// Add the node into the vector of nodes on edge 2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00888}00888             edge2\_vector\_pt[j] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00889}00889 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00890}00890             \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00891}00891             Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00892}00892 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00893}00893             \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00894}00894             done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00895}00895           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00896}00896         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00897}00897         \textcolor{comment}{// On the right edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00898}00898         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((j + 1) \% nnode\_1d == 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00899}00899         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00900}00900           \textcolor{comment}{// Copy the data from the top edge of element 0 to element 2}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00901}00901           el2\_pt-\/>node\_pt(j) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00902}00902             el0\_pt-\/>node\_pt((corner\_2 -\/ 1) + (j + 1) / nnode\_1d);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00903}00903 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00904}00904           \textcolor{comment}{// We don't need to set up the global coordinate data so just}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00905}00905           \textcolor{comment}{// skip to the next node in the element}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00906}00906           \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00907}00907         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00908}00908         \textcolor{comment}{// On the left edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00909}00909         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (j \% nnode\_1d == 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00910}00910         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00911}00911           \textcolor{comment}{// If the left edge has already been set up then we already know the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00912}00912           \textcolor{comment}{// nodes along this edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00913}00913           \textcolor{keywordflow}{if} (edge1\_setup)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00914}00914           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00915}00915             \textcolor{comment}{// The j'th node along this edge is the (j/nnode\_1d)'th node in the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00916}00916             \textcolor{comment}{// vector}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00917}00917             el2\_pt-\/>node\_pt(j) = edge1\_vector\_pt[j / nnode\_1d];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00918}00918 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00919}00919             \textcolor{comment}{// Since the node has already been set up we do not need to sort}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00920}00920             \textcolor{comment}{// out its global coordinate data}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00921}00921             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00922}00922           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00923}00923           \textcolor{comment}{// If the edge hasn't been set up yet}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00924}00924           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00925}00925           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00926}00926             \textcolor{keywordflow}{if} (q2\_left\_boundary\_id > 0)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00927}00927             \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00928}00928               \textcolor{comment}{// Construct a boundary node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00929}00929               Node* nod\_pt =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00930}00930                 el2\_pt-\/>construct\_boundary\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00931}00931 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00932}00932               \textcolor{comment}{// Add it to the list of boundary nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00933}00933               add\_boundary\_node(q2\_left\_boundary\_id -\/ 1, nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00934}00934 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00935}00935               \textcolor{comment}{// Add the node into the vector of nodes on edge 1 in clockwise}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00936}00936               \textcolor{comment}{// order}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00937}00937               edge1\_vector\_pt[(nnode\_edge -\/ 1) -\/ (j / nnode\_1d)] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00938}00938 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00939}00939               \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00940}00940               Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00941}00941 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00942}00942               \textcolor{comment}{// Indicate that the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00943}00943               done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00944}00944             \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00945}00945           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00946}00946 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00947}00947           \textcolor{comment}{// Node is not on a mesh boundary but on the left edge}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00948}00948           \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00949}00949           \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00950}00950             \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00951}00951             Node* nod\_pt = el2\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00952}00952 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00953}00953             \textcolor{comment}{// Add the node into the vector of nodes on edge 1 in clockwise}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00954}00954             \textcolor{comment}{// order}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00955}00955             edge1\_vector\_pt[(nnode\_edge -\/ 1) -\/ (j / nnode\_1d)] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00956}00956 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00957}00957             \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00958}00958             Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00959}00959 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00960}00960             \textcolor{comment}{// Indicate the j'th node has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00961}00961             done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00962}00962           \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00963}00963         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00964}00964 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00965}00965         \textcolor{comment}{// Node is not on a mesh boundary}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00966}00966         \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00967}00967         \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00968}00968           \textcolor{comment}{// Construct a normal node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00969}00969           Node* nod\_pt = el2\_pt-\/>construct\_node(j, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00970}00970 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00971}00971           \textcolor{comment}{// Add it to the list of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00972}00972           Node\_pt.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00973}00973         \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00974}00974 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00975}00975         \textcolor{comment}{// Get local coordinate}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00976}00976         el2\_pt-\/>local\_coordinate\_of\_node(j, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00977}00977 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00978}00978         \textcolor{comment}{// Interpolate position linearly between vertex nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00979}00979         dummy\_element.interpolated\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}});}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00980}00980         el2\_pt-\/>node\_pt(j)-\/>x(0) = \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[0];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00981}00981         el2\_pt-\/>node\_pt(j)-\/>x(1) = \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}[1];}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00982}00982       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00983}00983 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00984}00984       \textcolor{comment}{// We now need to loop over nodes corner\_2 to (corner\_3-\/1) and copy the}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00985}00985       \textcolor{comment}{// given information from Q1. We do not need to set up the (corner\_3)'th}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00986}00986       \textcolor{comment}{// node since it coincides with the centroid which has already been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00987}00987       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = corner\_2; j < corner\_3; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00988}00988       \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00989}00989         \textcolor{comment}{// The nodes along the upper edge of Q2 go from corner\_2 to corner\_3-\/1}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00990}00990         \textcolor{comment}{// while the nodes along the right edge of Q1 go from corner\_1 to}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00991}00991         \textcolor{comment}{// (corner\_3-\/nnode\_1d) in increments of nnode\_1d}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00992}00992         el2\_pt-\/>node\_pt(j) =}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00993}00993           el1\_pt-\/>node\_pt(corner\_1 + (j -\/ corner\_2) * nnode\_1d);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00994}00994       \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00995}00995 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00996}00996       \textcolor{comment}{// Add the element pointers to Element\_pt and then increment the counter}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00997}00997       Element\_pt[new\_el\_count] = el0\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00998}00998       Element\_pt[new\_el\_count + 1] = el1\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l00999}00999       Element\_pt[new\_el\_count + 2] = el2\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01000}01000       new\_el\_count += 3;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01001}01001 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01002}01002       \textcolor{comment}{// Assign the edges to the edge map}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01003}01003       edge\_nodes\_map[edge0] = edge0\_vector\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01004}01004       edge\_nodes\_map[edge1] = edge1\_vector\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01005}01005       edge\_nodes\_map[edge2] = edge2\_vector\_pt;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01006}01006     \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01007}01007 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01008}01008     \textcolor{comment}{// Indicate that the look up scheme has been set up}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01009}01009     Lookup\_for\_elements\_next\_boundary\_is\_setup = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01010}01010 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01011}01011     \textcolor{comment}{// Clean the dummy element nodes}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01012}01012     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 4; j++)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01013}01013     \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01014}01014       \textcolor{comment}{// Delete the j-\/th dummy element node}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01015}01015       \textcolor{keyword}{delete} dummy\_element.node\_pt(j);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01016}01016 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01017}01017       \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01018}01018       dummy\_element.node\_pt(j) = 0;}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01019}01019     \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01020}01020   \}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01021}01021 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01022}01022 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01023}01023 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01024}01024 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01025}01025 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01026}01026 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01027}01027 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01028}01028   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01029}01029 \textcolor{comment}{  /// Adapt problem based on specified elemental error estimates}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01030}01030 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01031}01031   \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01032}\mbox{\hyperlink{classoomph_1_1RefineableQuadFromTriangleMesh_a7d2efa292dd5dd4930e661fd32e42eec}{01032}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableQuadFromTriangleMesh_a7d2efa292dd5dd4930e661fd32e42eec}{RefineableQuadFromTriangleMesh<ELEMENT>::adapt}}(}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01033}01033     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& elem\_error)}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01034}01034   \{}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01035}01035     \textcolor{comment}{// Call the adapt function from the TreeBasedRefineableMeshBase base class}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01036}01036     \mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_ac98d4120b99d5c6cbcf7225a9ee5648d}{TreeBasedRefineableMeshBase::adapt}}(elem\_error);}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01037}01037 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01038}01038 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_TRIANGLE\_LIB}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01039}01039     \textcolor{comment}{// Move the nodes on the new boundary onto the old curvilinear}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01040}01040     \textcolor{comment}{// boundary. If the boundary is straight this will do precisely}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01041}01041     \textcolor{comment}{// nothing but will be somewhat inefficient}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01042}01042     this-\/>snap\_nodes\_onto\_geometric\_objects();}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01043}01043 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01044}01044   \} \textcolor{comment}{// End of adapt}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01045}01045 \} \textcolor{comment}{// End of namespace oomph}}
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01046}01046 }
\DoxyCodeLine{\Hypertarget{quad__from__triangle__mesh_8template_8cc_source_l01047}01047 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// OOMPH\_QUAD\_FROM\_TRIANGLE\_MESH\_TEMPLATE\_CC}}

\end{DoxyCode}

\hypertarget{hp__refineable__elements_8cc_source}{}\doxysection{hp\+\_\+refineable\+\_\+elements.\+cc}
\label{hp__refineable__elements_8cc_source}\index{hp\_refineable\_elements.cc@{hp\_refineable\_elements.cc}}
\mbox{\hyperlink{hp__refineable__elements_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00026}00026 \textcolor{comment}{// Non-\/inline member functions for hp-\/refineable elements}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00028}00028 \textcolor{comment}{// oomph-\/lib includes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00029}00029 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{algebraic__elements_8h}{algebraic\_elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00030}00030 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{macro__element__node__update__element_8h}{macro\_element\_node\_update\_element.h}}"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00031}00031 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{hp__refineable__elements_8h}{hp\_refineable\_elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00032}00032 \textcolor{comment}{//\#include "{}shape.h"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00034}00034 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00035}00035 \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00036}00036 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00037}00037 \textcolor{comment}{}  \textcolor{comment}{//       1D PRefineableQElements}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00038}00038 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00039}00039 \textcolor{comment}{}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00040}00040 \textcolor{comment}{  /// Get local coordinates of node j in the element; vector sets its own size}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00041}00041 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00042}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_af418e512d22efb2f5f70b9b8df74dff4}{00042}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::local\_coordinate\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00043}00043     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00044}00044 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00045}00045     \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}.resize(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00047}00047     \textcolor{keywordflow}{switch} (this-\/>nnode\_1d())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00048}00048     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00049}00049       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00050}00050         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00051}00051         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00052}00052         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00053}00053       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00054}00054         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00055}00055         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00056}00056         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00057}00057       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00058}00058         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00059}00059         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00060}00060         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00061}00061       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00062}00062         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00063}00063         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00064}00064         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00065}00065       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00066}00066         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00067}00067         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00068}00068         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00069}00069       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00070}00070         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00071}00071         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00072}00072         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00073}00073       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00074}00074         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n ERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00075}00075         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n        shape functions."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00076}00076         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00077}00077     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00078}00078   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00079}00079 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00080}00080 \textcolor{comment}{  /// Get the local fractino of node j in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00081}00081 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00082}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a356f8d8fbe63009336b1c77787f419b7}{00082}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::local\_fraction\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00083}00083     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00084}00084   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00085}00085     this-\/>local\_coordinate\_of\_node(n, s\_fraction);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00086}00086     s\_fraction[0] = 0.5 * (s\_fraction[0] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00087}00087   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00089}00089   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00090}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a0e1f2721aee7d97a66a8380f4d0b23a6}{00090}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::local\_one\_d\_fraction\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00091}00091     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n1d, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00092}00092   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00093}00093     \textcolor{keywordflow}{switch} (this-\/>nnode\_1d())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00094}00094     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00095}00095       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00096}00096         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00097}00097         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00098}00098                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00099}00099       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00100}00100         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00101}00101         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00102}00102                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00103}00103       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00104}00104         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00105}00105         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00106}00106                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00107}00107       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00108}00108         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00109}00109         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00110}00110                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00111}00111       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00112}00112         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00113}00113         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00114}00114                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00115}00115       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00116}00116         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00117}00117         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00118}00118                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00119}00119       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00120}00120         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00121}00121         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00122}00122         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00123}00123         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00124}00124                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00125}00125                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00126}00126         \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00127}00127     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00128}00128   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00131}00131   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00132}00132 \textcolor{comment}{  /// Return the node at the specified local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00133}00133 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00134}00134   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00135}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a01b2cc99002e2f6f4bd12383831ad0b7}{00135}}   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::get\_node\_at\_local\_coordinate}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00136}00136     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00137}00137 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00138}00138     \textcolor{comment}{// Load the tolerance into a local variable}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00139}00139     \textcolor{keywordtype}{double} tol = \mbox{\hyperlink{classoomph_1_1FiniteElement_a56eb1d0614eb76ba1591285e3efed268}{FiniteElement::Node\_location\_tolerance}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00140}00140     \textcolor{comment}{// There is one possible index.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00141}00141     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} index(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00143}00143     \textcolor{comment}{// Determine the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00144}00144     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00146}00146     \textcolor{comment}{// If we are at the lower limit, the index is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00147}00147     \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] + 1.0) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00148}00148     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00149}00149       index[0] = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00150}00150     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00151}00151     \textcolor{comment}{// If we are at the upper limit, the index is the number of nodes minus 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00152}00152     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] -\/ 1.0) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00153}00153     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00154}00154       index[0] = this-\/>nnode\_1d() -\/ 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00155}00155     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00156}00156     \textcolor{comment}{// Otherwise, we have to calculate the index in general}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00157}00157     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00158}00158     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00159}00159       \textcolor{comment}{// Compute Gauss-\/Lobatto-\/Legendre node positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00160}00160       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} z;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00161}00161       \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(this-\/>nnode\_1d(), z);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00162}00162       \textcolor{comment}{// Loop over possible internal nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00163}00163       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 1; n < this-\/>nnode\_1d() -\/ 1; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00164}00164       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00165}00165         \textcolor{keywordflow}{if} (std::fabs(z[n] -\/ \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00166}00166         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00167}00167           index[0] = n;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00168}00168           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00169}00169         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00170}00170       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00171}00171       \textcolor{comment}{// No matching nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00172}00172       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00173}00173     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00174}00174     \textcolor{comment}{// If we've got here we have a node, so let's return a pointer to it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00175}00175     \textcolor{keywordflow}{return} this-\/>node\_pt(index[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00176}00176   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00178}00178   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00179}00179 \textcolor{comment}{  /// If a neighbouring element's son has already created a node at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00180}00180 \textcolor{comment}{  /// a position corresponding to the local fractional position within the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00181}00181 \textcolor{comment}{  /// present element, s\_fraction, return}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00182}00182 \textcolor{comment}{  /// a pointer to that node. If not, return NULL (0). If the node is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00183}00183 \textcolor{comment}{  /// periodic the flag is\_periodic will be true}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00184}00184 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00185}00185   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00186}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_af3075981884efbba63063b3adb1c2535}{00186}}   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00187}00187 \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{    node\_created\_by\_son\_of\_neighbour}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00188}00188                                      \textcolor{keywordtype}{bool}\& is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00189}00189   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00190}00190     \textcolor{comment}{// Not possible in 1D case, so return null pointer}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00191}00191     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00192}00192   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00193}00193 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00194}00194   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00195}00195 \textcolor{comment}{  /// Set the correct p-\/order of the element based on that of its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00196}00196 \textcolor{comment}{  /// father. Then construct an integration scheme of the correct order.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00197}00197 \textcolor{comment}{  /// If an adopted father is specified, information from this is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00198}00198 \textcolor{comment}{  /// used instead of using the father found from the tree.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00199}00199 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00200}00200   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00201}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a630acfb3aa4851428f80c53be78346fd}{00201}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::initial\_setup}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00202}00202     \mbox{\hyperlink{classoomph_1_1Tree}{Tree}}* \textcolor{keyword}{const}\& adopted\_father\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& initial\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00203}00203   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00204}00204     \textcolor{comment}{// Storage for pointer to my father (in binarytree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00205}00205     \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* father\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00206}00206 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00207}00207     \textcolor{comment}{// Check if an adopted father has been specified}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00208}00208     \textcolor{keywordflow}{if} (adopted\_father\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00209}00209     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00210}00210       \textcolor{comment}{// Get pointer to my father (in binarytree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00211}00211       father\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}*\textcolor{keyword}{>}(adopted\_father\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00212}00212     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00213}00213     \textcolor{comment}{// Check if element is in a tree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00214}00214     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Tree\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00215}00215     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00216}00216       \textcolor{comment}{// Get pointer to my father (in binarytree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00217}00217       father\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}*\textcolor{keyword}{>}(binary\_tree\_pt()-\/>father\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00218}00218     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00219}00219     \textcolor{comment}{// else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00220}00220     \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00221}00221     \textcolor{comment}{//  throw OomphLibError(}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00222}00222     \textcolor{comment}{//         "{}Element not in a tree, and no adopted father has been}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00223}00223     \textcolor{comment}{//         specified!"{}, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00224}00224     \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00225}00225 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00226}00226     \textcolor{comment}{// Check if element has father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00227}00227     \textcolor{keywordflow}{if} (father\_pt != 0 || initial\_p\_order != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00228}00228     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00229}00229       \textcolor{keywordflow}{if} (father\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00230}00230       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00231}00231         \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<1, INITIAL\_NNODE\_1D>}}* father\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00232}00232           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<1, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00233}00233             father\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00234}00234         \textcolor{keywordflow}{if} (father\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00235}00235         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00236}00236           \textcolor{keywordtype}{unsigned} father\_p\_order = father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00237}00237           \textcolor{comment}{// Set p-\/order to that of father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00238}00238           P\_order = father\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00239}00239         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00240}00240       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00241}00241       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00242}00242       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00243}00243         P\_order = initial\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00244}00244       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00245}00245 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00246}00246       \textcolor{comment}{// Now sort out the element...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00247}00247       \textcolor{comment}{// (has p nodes)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00248}00248       \textcolor{keywordtype}{unsigned} new\_n\_node = P\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00249}00249 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00250}00250       \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00251}00251       this-\/>set\_n\_node(new\_n\_node);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00253}00253       \textcolor{comment}{// Set integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00254}00254       \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00255}00255       \textcolor{keywordflow}{switch} (P\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00256}00256       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00257}00257         \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00258}00258           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00259}00259           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00260}00260         \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00261}00261           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00262}00262           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00263}00263         \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00264}00264           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00265}00265           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00266}00266         \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00267}00267           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00268}00268           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00269}00269         \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00270}00270           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00271}00271           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00272}00272         \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00273}00273           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00274}00274           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00275}00275         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00276}00276           std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00277}00277           error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00278}00278           error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00279}00279           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00280}00280                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00281}00281                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00282}00282       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00283}00283     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00284}00284   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00286}00286   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00287}00287 \textcolor{comment}{  /// Check the father element for any required nodes which}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00288}00288 \textcolor{comment}{  /// already exist}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00289}00289 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00290}00290   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00291}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a6e5bf5063c1d80fc32a23b48c1547626}{00291}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::pre\_build}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00292}00292     \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}\& new\_node\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00293}00293   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00294}00294     \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00295}00295 \textcolor{comment}{      //Pointer to my father (in binarytree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00296}00296 \textcolor{comment}{      BinaryTree* father\_pt =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00297}00297 \textcolor{comment}{      dynamic\_cast<BinaryTree*>(binary\_tree\_pt()-\/>father\_pt());}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00298}00298 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00299}00299 \textcolor{comment}{      // Check if element has father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00300}00300 \textcolor{comment}{      if (father\_pt!=0)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00301}00301 \textcolor{comment}{      \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00302}00302 \textcolor{comment}{      PRefineableQElement<1>* father\_el\_pt =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00303}00303 \textcolor{comment}{      dynamic\_cast<PRefineableQElement<1>*>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00304}00304 \textcolor{comment}{      (this-\/>tree\_pt()-\/>father\_pt()-\/>object\_pt());}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00305}00305 \textcolor{comment}{      if (father\_el\_pt!=0)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00306}00306 \textcolor{comment}{      \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00307}00307 \textcolor{comment}{      // Pre-\/build actions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00308}00308 \textcolor{comment}{      //??}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00309}00309 \textcolor{comment}{      \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00310}00310 \textcolor{comment}{      else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00311}00311 \textcolor{comment}{      \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00312}00312 \textcolor{comment}{      std::ostringstream error\_message;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00313}00313 \textcolor{comment}{      error\_message <<"{}\(\backslash\)nERROR: Dynamic cast failed!\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00314}00314 \textcolor{comment}{      throw OomphLibError(error\_message.str(),}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00315}00315 \textcolor{comment}{      OOMPH\_CURRENT\_FUNCTION,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00316}00316 \textcolor{comment}{      OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00317}00317 \textcolor{comment}{      \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00318}00318 \textcolor{comment}{      \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00319}00319 \textcolor{comment}{    */}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00320}00320   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00321}00321 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00322}00322   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00323}00323 \textcolor{comment}{  /// p-\/refine the element inc times. (If inc<0 then p-\/unrefinement}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00324}00324 \textcolor{comment}{  /// is performed.)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00325}00325 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00326}00326   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00327}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_ab3210a40d15dd21dd3befee2220eca95}{00327}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::p\_refine}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00328}00328     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& inc, \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt, \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& clone\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00329}00329   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00330}00330     \textcolor{comment}{// Cast clone to correct type}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00331}00331     \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<1, INITIAL\_NNODE\_1D>}}* clone\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00332}00332       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<1, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(clone\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00333}00333 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00334}00334     \textcolor{comment}{// Check if we can use it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00335}00335     \textcolor{keywordflow}{if} (clone\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00336}00336     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00337}00337       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00338}00338         \textcolor{stringliteral}{"{}Cloned copy must be a PRefineableQElement<1,INITIAL\_NNODE\_1D>!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00339}00339         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00340}00340         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00341}00341     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00342}00342 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00343}00343     \textcolor{comment}{// Clone exists, so check that it is infact a copy of me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00344}00344     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00345}00345     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00346}00346       \textcolor{comment}{// Flag to keep track of check}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00347}00347       \textcolor{keywordtype}{bool} clone\_is\_ok = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00349}00349       \textcolor{comment}{// Does the clone have the correct p-\/order?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00350}00350       clone\_is\_ok = clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}() == this-\/>p\_order());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00352}00352       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00353}00353       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00354}00354         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00355}00355         err\_stream << \textcolor{stringliteral}{"{}Clone element has a different p-\/order from me,"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00356}00356                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00357}00357                    << \textcolor{stringliteral}{"{}but it is supposed to be a copy!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00358}00358 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00359}00359         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00360}00360           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00361}00361       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00362}00362 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00363}00363       \textcolor{comment}{// Does the clone have the same number of nodes as me?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00364}00364       clone\_is\_ok = clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}() == this-\/>nnode());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00365}00365 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00366}00366       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00367}00367       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00368}00368         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00369}00369         err\_stream << \textcolor{stringliteral}{"{}Clone element has a different number of nodes from me,"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00370}00370                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00371}00371                    << \textcolor{stringliteral}{"{}but it is supposed to be a copy!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00372}00372 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00373}00373         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00374}00374           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00375}00375       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00377}00377       \textcolor{comment}{// Does the clone have the same nodes as me?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00378}00378       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < this-\/>nnode(); n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00379}00379       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00380}00380         clone\_is\_ok =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00381}00381           clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(n) == this-\/>node\_pt(n));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00382}00382       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00383}00383 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00384}00384       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00385}00385       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00386}00386         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00387}00387         err\_stream << \textcolor{stringliteral}{"{}The nodes belonging to the clone element are different"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00388}00388                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00389}00389                    << \textcolor{stringliteral}{"{}from mine, but it is supposed to be a copy!"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00390}00390                    << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00391}00391 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00392}00392         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00393}00393           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00394}00394       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00395}00395 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00396}00396       \textcolor{comment}{// If we get to here then the clone has all the information we require}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00397}00397     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00398}00398 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00399}00399 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00400}00400     \textcolor{comment}{// Currently we can't handle the case of generalised coordinates}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00401}00401     \textcolor{comment}{// since we haven't established how they should be interpolated.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00402}00402     \textcolor{comment}{// Buffer this case:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00403}00403     \textcolor{keywordflow}{if} (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1Node_aee6f2b7a46fc9d875c6736895d7fc095}{nposition\_type}}() != 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00404}00404     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00405}00405       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Can't handle generalised nodal positions (yet)."{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00406}00406                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00407}00407                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00408}00408     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00410}00410     \textcolor{comment}{// Timestepper should be the same for all nodes -\/-\/ use it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00411}00411     \textcolor{comment}{// to create timesteppers for new nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00412}00412     \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = this-\/>node\_pt(0)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00413}00413 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00414}00414     \textcolor{comment}{// Get number of history values (incl. present)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00415}00415     \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00416}00416 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00417}00417     \textcolor{comment}{// Increment p-\/order of the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00418}00418     P\_order += inc;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00419}00419 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00420}00420     \textcolor{comment}{// Change integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00421}00421     \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00422}00422     \textcolor{keywordflow}{switch} (P\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00423}00423     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00424}00424       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00425}00425         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00426}00426         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00427}00427       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00428}00428         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00429}00429         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00430}00430       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00431}00431         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00432}00432         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00433}00433       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00434}00434         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00435}00435         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00436}00436       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00437}00437         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00438}00438         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00439}00439       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00440}00440         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00441}00441         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00442}00442       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00443}00443         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00444}00444         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00445}00445         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00446}00446         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00447}00447                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00448}00448                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00449}00449     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00450}00450 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00451}00451     \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00452}00452     this-\/>set\_n\_node(P\_order);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00453}00453 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00454}00454     \textcolor{comment}{// Copy vertex nodes and create new internal nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00455}00455     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00456}00456 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00457}00457     \textcolor{comment}{// Setup vertex coordinates in element:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00458}00458     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00459}00459     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_left(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00460}00460     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_right(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00461}00461     s\_left[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00462}00462     s\_right[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00463}00463 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00464}00464     \textcolor{comment}{// Local coordinate in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00465}00465     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00466}00466 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00467}00467     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00468}00468     \textcolor{comment}{// Loop over all nodes in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00469}00469     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < P\_order; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00470}00470     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00471}00471       \textcolor{comment}{// Get the fractional position (in the current element) of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00472}00472       \textcolor{comment}{// in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00473}00473       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(n, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00475}00475       \textcolor{comment}{// Evaluate the local coordinate of the node in the father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00476}00476       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_left[0] + (s\_right[0] -\/ s\_left[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00477}00477 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00478}00478       \textcolor{comment}{// Initialise flag: So far, this node hasn't been built or copied yet}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00479}00479       \textcolor{keywordtype}{bool} node\_done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00480}00480 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00481}00481       \textcolor{comment}{// Get the pointer to the node in this element (or rather, its clone),}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00482}00482       \textcolor{comment}{// returns NULL if there is not node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00483}00483       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* created\_node\_pt = clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a01b2cc99002e2f6f4bd12383831ad0b7}{get\_node\_at\_local\_coordinate}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00484}00484 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00485}00485       \textcolor{comment}{// Does this node already exist in this element?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00486}00486       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00487}00487       \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00488}00488       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00489}00489         \textcolor{comment}{// Copy node across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00490}00490         this-\/>node\_pt(n) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00491}00491 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00492}00492         \textcolor{comment}{// Make sure that we update the values at the node so that they}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00493}00493         \textcolor{comment}{// are consistent with the present representation. This is only}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00494}00494         \textcolor{comment}{// needed for mixed interpolation where the value at the father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00495}00495         \textcolor{comment}{// could now become active.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00496}00496 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00497}00497         \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00498}00498         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00499}00499         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00500}00500           \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00501}00501           \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00502}00502           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00503}00503           clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00504}00504           \textcolor{comment}{// Find the minimum number of values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00505}00505           \textcolor{comment}{//(either those stored at the node, or those returned by}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00506}00506           \textcolor{comment}{// the function)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00507}00507           \textcolor{keywordtype}{unsigned} n\_val\_at\_node = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00508}00508           \textcolor{keywordtype}{unsigned} n\_val\_from\_function = prev\_values.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00509}00509           \textcolor{comment}{// Use the ternary conditional operator here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00510}00510           \textcolor{keywordtype}{unsigned} n\_var = n\_val\_at\_node < n\_val\_from\_function ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00511}00511                              n\_val\_at\_node :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00512}00512                              n\_val\_from\_function;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00513}00513           \textcolor{comment}{// Assign the values that we can}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00514}00514           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_var; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00515}00515           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00516}00516             created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00517}00517           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00518}00518         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00519}00519 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00520}00520         \textcolor{comment}{// Indicate that node has been created by copy}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00521}00521         node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00522}00522       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00523}00523 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00524}00524       \textcolor{comment}{// Node does not exist in this element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00525}00525       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00526}00526 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00527}00527       \textcolor{comment}{// If the node has not been built anywhere -\/-\/-\/> build it here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00528}00528       \textcolor{keywordflow}{if} (!node\_done)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00529}00529       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00530}00530         \textcolor{comment}{// In a 1D mesh any node which lies on the boundary must exist in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00531}00531         \textcolor{comment}{// the initial (coarse) mesh, so any newly-\/built nodes cannot be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00532}00532         \textcolor{comment}{// boundary nodes. Therefore we always create a normal "{}bulk"{} node.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00533}00533 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00534}00534         \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00535}00535         created\_node\_pt = this-\/>construct\_node(n, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00537}00537         \textcolor{comment}{// Now we set the position and values at the newly created node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00538}00538 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00539}00539         \textcolor{comment}{// Now we set the position and values at the newly created node.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00540}00540         \textcolor{comment}{// In the first instance use macro element or FE representation}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00541}00541         \textcolor{comment}{// to create past and present nodal positions.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00542}00542         \textcolor{comment}{// (THIS STEP SHOULD NOT BE SKIPPED FOR ALGEBRAIC ELEMENTS AS NOT}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00543}00543         \textcolor{comment}{// ALL OF THEM NECESSARILY IMPLEMENT NONTRIVIAL NODE UPDATE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00544}00544         \textcolor{comment}{// FUNCTIONS. CALLING THE NODE UPDATE FOR SUCH ELEMENTS/NODES WILL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00545}00545         \textcolor{comment}{// LEAVE THEIR NODAL POSITIONS WHERE THEY WERE (THIS IS APPROPRIATE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00546}00546         \textcolor{comment}{// ONCE THEY HAVE BEEN GIVEN POSITIONS) BUT WILL NOT ASSIGN SENSIBLE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00547}00547         \textcolor{comment}{// INITIAL POSITIONS!)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00548}00548 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00549}00549         \textcolor{comment}{// Loop over history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00550}00550         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00551}00551         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00552}00552           \textcolor{comment}{// Allocate storage for the previous position of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00553}00553           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00554}00554 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00555}00555           \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00556}00556           \textcolor{comment}{// element representation if appropriate.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00557}00557           clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00558}00558 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00559}00559           \textcolor{comment}{// Set the previous position of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00560}00560           created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, 0) = x\_prev[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00561}00561 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00562}00562           \textcolor{comment}{// Allocate storage for the previous values at the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00563}00563           \textcolor{comment}{// NOTE: the size of this vector is equal to the number of values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00564}00564           \textcolor{comment}{// (e.g. 3 velocity components and 1 pressure, say)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00565}00565           \textcolor{comment}{// associated with each node and NOT the number of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00566}00566           \textcolor{comment}{// which the node stores!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00567}00567           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00569}00569           \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00570}00570           \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00571}00571           clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00572}00572 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00573}00573           \textcolor{comment}{// Determine the number of values at the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00574}00574           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00575}00575 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00576}00576           \textcolor{comment}{// Loop over all values and set the previous values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00577}00577           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_value; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00578}00578           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00579}00579             created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, v, prev\_values[v]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00580}00580           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00581}00581         \} \textcolor{comment}{// End of loop over history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00582}00582 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00583}00583         \textcolor{comment}{// Add new node to mesh (if requested)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00584}00584         \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00585}00585         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00586}00586           mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00587}00587         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00588}00588 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00589}00589         \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00590}00590           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00591}00591 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00592}00592         \textcolor{comment}{// If we do have an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00593}00593         \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00594}00594         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00595}00595           \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message = \textcolor{stringliteral}{"{}Have not implemented p-\/refinement for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00596}00596           error\_message += \textcolor{stringliteral}{"{}Algebraic p-\/refineable elements yet\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00597}00597 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00598}00598           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00599}00599             error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00600}00600             \textcolor{stringliteral}{"{}PRefineableQElement<1,INITIAL\_NNODE\_1D>::p\_refine()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00601}00601             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00602}00602         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00603}00603 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00604}00604       \} \textcolor{comment}{// End of case where we build the node ourselves}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00605}00605 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00606}00606       \textcolor{comment}{// Check if the element is an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00607}00607       \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00608}00608         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00609}00609 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00610}00610       \textcolor{comment}{// If the element is an algebraic element, setup}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00611}00611       \textcolor{comment}{// node position (past and present) from algebraic node update}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00612}00612       \textcolor{comment}{// function. This over-\/writes previous assingments that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00613}00613       \textcolor{comment}{// were made based on the macro-\/element/FE representation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00614}00614       \textcolor{comment}{// NOTE: YES, THIS NEEDS TO BE CALLED REPEATEDLY IF THE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00615}00615       \textcolor{comment}{// NODE IS MEMBER OF MULTIPLE ELEMENTS: THEY ALL ASSIGN}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00616}00616       \textcolor{comment}{// THE SAME NODAL POSITIONS BUT WE NEED TO ADD THE REMESH}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00617}00617       \textcolor{comment}{// INFO FOR *ALL* ROOT ELEMENTS!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00618}00618       \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00619}00619       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00620}00620         \textcolor{comment}{// Build algebraic node update info for new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00621}00621         \textcolor{comment}{// This sets up the node update data for all node update}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00622}00622         \textcolor{comment}{// functions that are shared by all nodes in the father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00623}00623         \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00624}00624         alg\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase_ab9ada27015d5cb28ae00b086ace3600f}{setup\_algebraic\_node\_update}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00625}00625           this-\/>node\_pt(n), \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00626}00626       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00627}00627 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00628}00628     \} \textcolor{comment}{// End of loop over all nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00629}00629 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00630}00630 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00631}00631     \textcolor{comment}{// If the element is a MacroElementNodeUpdateElement, set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00632}00632     \textcolor{comment}{// the update parameters for the current element's nodes -\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00633}00633     \textcolor{comment}{// all this needs is the vector of (pointers to the)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00634}00634     \textcolor{comment}{// geometric objects that affect the MacroElement-\/based}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00635}00635     \textcolor{comment}{// node update -\/-\/ this needs to be done to set the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00636}00636     \textcolor{comment}{// update info for newly created nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00637}00637     \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* clone\_m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00638}00638       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00639}00639     \textcolor{keywordflow}{if} (clone\_m\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00640}00640     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00641}00641       \textcolor{comment}{// Get vector of geometric objects from father (construct vector}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00642}00642       \textcolor{comment}{// via copy operation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00643}00643       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_pt(clone\_m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00644}00644 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00645}00645       \textcolor{comment}{// Cast current element to MacroElementNodeUpdateElement:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00646}00646       \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00647}00647         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00648}00648 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00649}00649 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00650}00650       \textcolor{keywordflow}{if} (m\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00651}00651       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00652}00652         \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00653}00653           \textcolor{stringliteral}{"{}Failed to cast to MacroElementNodeUpdateElementBase*\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00654}00654         error\_message +=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00655}00655           \textcolor{stringliteral}{"{}Strange -\/-\/ if my clone is a MacroElementNodeUpdateElement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00656}00656         error\_message += \textcolor{stringliteral}{"{}then I should be too....\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00657}00657 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00658}00658         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00659}00659           error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00660}00660       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00661}00661 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00662}00662       \textcolor{comment}{// Build update info by passing vector of geometric objects:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00663}00663       \textcolor{comment}{// This sets the current element to be the update element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00664}00664       \textcolor{comment}{// for all of the element's nodes -\/-\/ this is reversed}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00665}00665       \textcolor{comment}{// if the element is ever un-\/refined in the father element's}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00666}00666       \textcolor{comment}{// rebuild\_from\_sons() function which overwrites this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00667}00667       \textcolor{comment}{// assignment to avoid nasty segmentation faults that occur}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00668}00668       \textcolor{comment}{// when a node tries to update itself via an element that no}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00669}00669       \textcolor{comment}{// longer exists...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00670}00670       m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_aa2408d8463e8cecc2ad12a93e10390b1}{set\_node\_update\_info}}(geom\_object\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00671}00671     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00672}00672 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00673}00673 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00674}00674     \textcolor{comment}{// Loop over all nodes in element again, to re-\/set the positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00675}00675     \textcolor{comment}{// This must be done using the new element's macro-\/element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00676}00676     \textcolor{comment}{// representation, rather than the old version which may be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00677}00677     \textcolor{comment}{// of a different p-\/order!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00678}00678     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < P\_order; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00679}00679     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00680}00680       \textcolor{comment}{// Get the fractional position of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00681}00681       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(n, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00682}00682       \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00683}00683       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_left[0] + (s\_right[0] -\/ s\_left[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00684}00684 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00685}00685       \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00686}00686       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00687}00687       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00688}00688         \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00689}00689         \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00690}00690         \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00691}00691         \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00692}00692         \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00693}00693         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00694}00694         this-\/>get\_x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00695}00695 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00696}00696         \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00697}00697         this-\/>node\_pt(n)-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, 0) = x\_prev[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00698}00698       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00699}00699     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00700}00700 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00701}00701     \textcolor{comment}{// Not necessary to delete the old nodes since all original nodes are in the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00702}00702     \textcolor{comment}{// current mesh and so will be pruned as part of the mesh adaption process.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00703}00703 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00704}00704     \textcolor{comment}{// Do any further-\/build required}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00705}00705     this-\/>further\_build();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00706}00706   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00707}00707 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00708}00708   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00709}00709 \textcolor{comment}{  /// Shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00710}00710 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00711}00711   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00712}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a3b9d39b32b0f3720991ba2e690c0c563}{00712}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1OneDimLagrange_a117f8b892dc89989ecdad99ff261e120}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::shape}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00713}00713                                                        \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00714}00714 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00715}00715     \textcolor{keywordflow}{switch} (p\_order())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00716}00716     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00717}00717       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00718}00718       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00719}00719         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00720}00720         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00721}00721         \textcolor{comment}{// Create one-\/dim shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00722}00722         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<2>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00723}00723         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00724}00724         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00725}00725         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00726}00726         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00727}00727           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00728}00728         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00729}00729         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00730}00730       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00731}00731       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00732}00732       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00733}00733         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00734}00734         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00735}00735         \textcolor{comment}{// Create one-\/dim shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00736}00736         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<3>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00737}00737         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00738}00738         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00739}00739         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00740}00740         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00741}00741           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00742}00742         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00743}00743         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00744}00744       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00745}00745       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00746}00746       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00747}00747         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00748}00748         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00749}00749         \textcolor{comment}{// Create one-\/dim shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00750}00750         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<4>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00751}00751         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00752}00752         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00753}00753         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00754}00754         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00755}00755           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00756}00756         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00757}00757         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00758}00758       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00759}00759       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00760}00760       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00761}00761         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00762}00762         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00763}00763         \textcolor{comment}{// Create one-\/dim shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00764}00764         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<5>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00765}00765         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00766}00766         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00767}00767         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00768}00768         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00769}00769           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00770}00770         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00771}00771         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00772}00772       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00773}00773       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00774}00774       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00775}00775         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00776}00776         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00777}00777         \textcolor{comment}{// Create one-\/dim shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00778}00778         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<6>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00779}00779         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00780}00780         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00781}00781         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00782}00782         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00783}00783           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00784}00784         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00785}00785         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00786}00786       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00787}00787       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00788}00788       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00789}00789         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00790}00790         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00791}00791         \textcolor{comment}{// Create one-\/dim shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00792}00792         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<7>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00793}00793         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00794}00794         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00795}00795         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00796}00796         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00797}00797           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00798}00798         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00799}00799         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00800}00800       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00801}00801       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00802}00802         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n ERROR: PRefineableQElement::shape() exceeded maximum"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00803}00803         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n        polynomial order for shape functions."{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00804}00804                    << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00805}00805     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00806}00806   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00807}00807 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00808}00808   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00809}00809 \textcolor{comment}{  /// Derivatives of shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00810}00810 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00811}00811   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00812}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_aebf69d287fafae0e38ad61d8e3007c29}{00812}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::dshape\_local}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00813}00813     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsi)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00814}00814 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00815}00815     \textcolor{keywordflow}{switch} (p\_order())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00816}00816     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00817}00817       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00818}00818       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00819}00819         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00820}00820         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00821}00821         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00822}00822         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<2>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00823}00823         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<2>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00824}00824         \textcolor{comment}{// Loop over shapes and copy across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00825}00825         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00826}00826         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00827}00827           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00828}00828           dpsi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, 0) = dpsi1ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00829}00829         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00830}00830 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00831}00831         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00832}00832       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00833}00833       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00834}00834       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00835}00835         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00836}00836         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00837}00837         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00838}00838         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<3>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00839}00839         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<3>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00840}00840         \textcolor{comment}{// Loop over shapes and copy across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00841}00841         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00842}00842         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00843}00843           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00844}00844           dpsi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, 0) = dpsi1ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00845}00845         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00846}00846         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00847}00847       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00848}00848       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00849}00849       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00850}00850         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00851}00851         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00852}00852         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00853}00853         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<4>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00854}00854         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<4>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00855}00855         \textcolor{comment}{// Loop over shapes and copy across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00856}00856         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00857}00857         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00858}00858           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00859}00859           dpsi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, 0) = dpsi1ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00860}00860         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00861}00861         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00862}00862       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00863}00863       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00864}00864       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00865}00865         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00866}00866         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00867}00867         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00868}00868         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<5>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00869}00869         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<5>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00870}00870         \textcolor{comment}{// Loop over shapes and copy across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00871}00871         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00872}00872         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00873}00873           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00874}00874           dpsi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, 0) = dpsi1ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00875}00875         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00876}00876         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00877}00877       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00878}00878       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00879}00879       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00880}00880         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00881}00881         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00882}00882         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00883}00883         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<6>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00884}00884         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<6>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00885}00885         \textcolor{comment}{// Loop over shapes and copy across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00886}00886         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00887}00887         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00888}00888           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00889}00889           dpsi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, 0) = dpsi1ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00890}00890         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00891}00891         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00892}00892       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00893}00893       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00894}00894       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00895}00895         \textcolor{comment}{// Calculate nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00896}00896         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00897}00897         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00898}00898         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<7>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00899}00899         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<7>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00900}00900         \textcolor{comment}{// Loop over shapes and copy across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00901}00901         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < p\_order(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00902}00902         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00903}00903           psi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = psi1[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00904}00904           dpsi(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, 0) = dpsi1ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00905}00905         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00906}00906         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00907}00907       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00908}00908       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00909}00909         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00910}00910           << \textcolor{stringliteral}{"{}\(\backslash\)n ERROR: PRefineableQElement::dshape\_local() exceeded maximum"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00911}00911         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n        polynomial order for shape functions."{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00912}00912                    << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00913}00913     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00914}00914   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00915}00915 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00916}00916   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00917}00917 \textcolor{comment}{  /// Second derivatives of shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00918}00918 \textcolor{comment}{  ///  d2psids(i,0) = \(\backslash\)f\$ d\string^2 \(\backslash\)psi\_j / d s\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00919}00919 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00920}00920   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00921}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a4672dbd02067a8087a4a2e2c0188f8ec}{00921}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::d2shape\_local}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00922}00922     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsids, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& d2psids)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00923}00923 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00924}00924     std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00925}00925     error\_message}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00926}00926       << \textcolor{stringliteral}{"{}\(\backslash\)nd2shape\_local currently not implemented for this element\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00927}00927     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00928}00928       error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00929}00929   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00930}00930 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00931}00931   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00932}00932 \textcolor{comment}{  /// Internal function to set up the hanging nodes on a particular}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00933}00933 \textcolor{comment}{  /// edge of the element. (Not required in 1D.)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00934}00934 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00935}00935   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00936}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a4f18083f934ad30fe8a4d6731267adda}{00936}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::binary\_hang\_helper}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00937}00937     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& my\_edge, std::ofstream\& output\_hangfile)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00938}00938   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00939}00939   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00940}00940 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00941}00941   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00942}00942 \textcolor{comment}{  /// Rebuild the element from nodes found in its sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00943}00943 \textcolor{comment}{  /// Adjusts its p-\/order to be the maximum of its sons' p-\/orders}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00944}00944 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00945}00945   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00946}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a6c2918a2f7a1aa009ae2378132cea6f1}{00946}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::rebuild\_from\_sons}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00947}00947     \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00948}00948   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00949}00949     \textcolor{comment}{// Get p-\/orders of sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00950}00950     \textcolor{keywordtype}{unsigned} n\_sons = this-\/>tree\_pt()-\/>nsons();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00951}00951     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} son\_p\_order(n\_sons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00952}00952     \textcolor{keywordtype}{unsigned} max\_son\_p\_order = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00953}00953     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ison = 0; ison < n\_sons; ison++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00954}00954     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00955}00955       \mbox{\hyperlink{classoomph_1_1PRefineableElement}{PRefineableElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableElement}{PRefineableElement}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00956}00956         this-\/>tree\_pt()-\/>son\_pt(ison)-\/>object\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00957}00957       son\_p\_order[ison] = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00958}00958       \textcolor{keywordflow}{if} (son\_p\_order[ison] > max\_son\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00959}00959         max\_son\_p\_order = son\_p\_order[ison];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00960}00960     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00961}00961 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00962}00962     \textcolor{keywordtype}{unsigned} old\_Nnode = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00963}00963     \textcolor{keywordtype}{unsigned} old\_P\_order = this-\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00964}00964     \textcolor{comment}{// Set p-\/order of the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00965}00965     this-\/>p\_order() = max\_son\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00966}00966 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00967}00967     \textcolor{comment}{// Change integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00968}00968     \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00969}00969     \textcolor{keywordflow}{switch} (this-\/>p\_order())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00970}00970     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00971}00971       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00972}00972         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00973}00973         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00974}00974       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00975}00975         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00976}00976         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00977}00977       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00978}00978         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00979}00979         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00980}00980       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00981}00981         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00982}00982         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00983}00983       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00984}00984         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00985}00985         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00986}00986       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00987}00987         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<1, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00988}00988         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00989}00989       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00990}00990         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00991}00991         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00992}00992         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00993}00993         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00994}00994                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00995}00995                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00996}00996     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00997}00997 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00998}00998     \textcolor{comment}{// Back up pointers to old nodes before they are lost}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l00999}00999     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} old\_node\_pt(old\_Nnode);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01000}01000     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < old\_Nnode; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01001}01001     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01002}01002       old\_node\_pt[n] = this-\/>node\_pt(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01003}01003     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01004}01004 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01005}01005     \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01006}01006     this-\/>set\_n\_node(this-\/>p\_order());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01007}01007 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01008}01008     \textcolor{comment}{// Copy vertex nodes and create new edge and internal nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01009}01009     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01010}01010 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01011}01011     \textcolor{comment}{// Copy vertex nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01012}01012     this-\/>node\_pt(0) = old\_node\_pt[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01013}01013     this-\/>node\_pt(this-\/>p\_order() -\/ 1) = old\_node\_pt[old\_P\_order -\/ 1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01014}01014 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01015}01015 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01016}01016     \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01017}01017     \textcolor{comment}{// Below this line is copied from RefineableQSpectralElement<2>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01018}01018 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01019}01019     \textcolor{comment}{// The timestepper should be the same for all nodes and node 0 should}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01020}01020     \textcolor{comment}{// never be deleted.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01021}01021     \textcolor{keywordflow}{if} (this-\/>node\_pt(0) == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01022}01022     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01023}01023       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}The vertex node (0) does not exist"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01024}01024                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01025}01025                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01026}01026     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01027}01027 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01028}01028     \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = this-\/>node\_pt(0)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01029}01029 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01030}01030     \textcolor{comment}{// Determine number of history values stored}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01031}01031     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01032}01032 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01033}01033     \textcolor{comment}{// Allocate storage for local coordinates}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01034}01034     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(1), \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01035}01035 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01036}01036     \textcolor{comment}{// Determine the number of nodes in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01037}01037     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01038}01038 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01039}01039     \textcolor{comment}{// Loop over the nodes in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01040}01040     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01041}01041     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01042}01042       \textcolor{comment}{// Get the fractional position of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01043}01043       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(n, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01044}01044 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01045}01045       \textcolor{comment}{// Determine the local coordinate in the father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01046}01046       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0 + 2.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01047}01047 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01048}01048       \textcolor{comment}{// If the node has not been built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01049}01049       \textcolor{keywordflow}{if} (this-\/>node\_pt(n) == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01050}01050       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01051}01051         \textcolor{comment}{// Has the node been created by one of its neighbours?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01052}01052         \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01053}01053         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01054}01054           this-\/>node\_created\_by\_neighbour(s\_fraction, is\_periodic);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01055}01055 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01056}01056         \textcolor{comment}{// If it has, set the pointer}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01057}01057         \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01058}01058         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01059}01059           \textcolor{comment}{// If the node is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01060}01060           \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01061}01061           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01062}01062             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Cannot handle periodic nodes yet"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01063}01063                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01064}01064                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01065}01065           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01066}01066           \textcolor{comment}{// Non-\/periodic case, just set the pointer}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01067}01067           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01068}01068           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01069}01069             this-\/>node\_pt(n) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01070}01070           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01071}01071         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01072}01072         \textcolor{comment}{// Otherwise, we need to build it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01073}01073         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01074}01074         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01075}01075           \textcolor{comment}{// First, find the son element in which the node should live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01076}01076 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01077}01077           \textcolor{comment}{// Find coordinate in the son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01078}01078           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_son(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01079}01079           \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01080}01080           \textcolor{keywordtype}{int} son = -\/10;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01081}01081           \textcolor{comment}{// If s\_fraction is between 0 and 0.5, we are in the left son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01082}01082           \textcolor{keywordflow}{if} (s\_fraction[0] < 0.5)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01083}01083           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01084}01084             son = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01085}01085             s\_in\_son[0] = -\/1.0 + 4.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01086}01086           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01087}01087           \textcolor{comment}{// Otherwise we are in the right son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01088}01088           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01089}01089           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01090}01090             son = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01091}01091             s\_in\_son[0] = -\/1.0 + 4.0 * (s\_fraction[0] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01092}01092           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01093}01093 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01094}01094           \textcolor{comment}{// Get the pointer to the son element in which the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01095}01095           \textcolor{comment}{// would live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01096}01096           \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<1, INITIAL\_NNODE\_1D>}}* son\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01097}01097             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<1, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01098}01098               this-\/>tree\_pt()-\/>son\_pt(son)-\/>object\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01099}01099 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01100}01100           \textcolor{comment}{// In 1D we should never be rebuilding an element's vertex nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01101}01101           \textcolor{comment}{// (since they will never be deleted), so throw an error if we}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01102}01102           \textcolor{comment}{// appear to be doing so}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01103}01103 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01104}01104           \textcolor{keywordflow}{if} (n == 0 || n == n\_node -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01105}01105           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01106}01106             \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01107}01107               \textcolor{stringliteral}{"{}I am trying to rebuild one of the (two) vertex nodes in\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01108}01108             error\_message +=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01109}01109               \textcolor{stringliteral}{"{}this 1D element. It should not have been possible to delete\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01110}01110             error\_message += \textcolor{stringliteral}{"{}either of these!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01111}01111 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01112}01112             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01113}01113               error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01114}01114           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01115}01115 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01116}01116 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01117}01117           \textcolor{comment}{// With this in mind we will always be creating normal "{}bulk"{} nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01118}01118           this-\/>node\_pt(n) = this-\/>construct\_node(n, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01119}01119 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01120}01120           \textcolor{comment}{// Now we set the position and values at the newly created node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01121}01121 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01122}01122           \textcolor{comment}{// In the first instance use macro element or FE representation}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01123}01123           \textcolor{comment}{// to create past and present nodal positions.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01124}01124           \textcolor{comment}{// (THIS STEP SHOULD NOT BE SKIPPED FOR ALGEBRAIC ELEMENTS AS NOT}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01125}01125           \textcolor{comment}{// ALL OF THEM NECESSARILY IMPLEMENT NONTRIVIAL NODE UPDATE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01126}01126           \textcolor{comment}{// FUNCTIONS. CALLING THE NODE UPDATE FOR SUCH ELEMENTS/NODES WILL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01127}01127           \textcolor{comment}{// LEAVE THEIR NODAL POSITIONS WHERE THEY WERE (THIS IS APPROPRIATE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01128}01128           \textcolor{comment}{// ONCE THEY HAVE BEEN GIVEN POSITIONS) BUT WILL NOT ASSIGN SENSIBLE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01129}01129           \textcolor{comment}{// INITIAL POSITIONS!)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01130}01130 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01131}01131           \textcolor{comment}{// Loop over history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01132}01132           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01133}01133           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01134}01134             \textcolor{comment}{// Allocate storage for the previous position of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01135}01135             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01136}01136 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01137}01137             \textcolor{comment}{// Get position from son element -\/-\/ this uses the macro element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01138}01138             \textcolor{comment}{// representation if appropriate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01139}01139             son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_son, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01140}01140 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01141}01141             \textcolor{comment}{// Set the previous position of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01142}01142             this-\/>node\_pt(n)-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, 0) = x\_prev[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01143}01143 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01144}01144             \textcolor{comment}{// Allocate storage for the previous values at the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01145}01145             \textcolor{comment}{// NOTE: the size of this vector is equal to the number of values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01146}01146             \textcolor{comment}{// (e.g. 3 velocity components and 1 pressure, say)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01147}01147             \textcolor{comment}{// associated with each node and NOT the number of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01148}01148             \textcolor{comment}{// which the node stores!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01149}01149             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01150}01150 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01151}01151             \textcolor{comment}{// Get values from son element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01152}01152             \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01153}01153             son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_son, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01154}01154 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01155}01155             \textcolor{comment}{// Determine the number of values at the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01156}01156             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = this-\/>node\_pt(n)-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01157}01157 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01158}01158             \textcolor{comment}{// Loop over all values and set the previous values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01159}01159             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_value; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01160}01160             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01161}01161               this-\/>node\_pt(n)-\/>set\_value(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, v, prev\_values[v]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01162}01162             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01163}01163           \} \textcolor{comment}{// End of loop over history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01164}01164 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01165}01165           \textcolor{comment}{// Add new node to mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01166}01166           mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(this-\/>node\_pt(n));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01167}01167 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01168}01168         \} \textcolor{comment}{// End of case where we build the node ourselves}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01169}01169 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01170}01170       \} \textcolor{comment}{// End of if this node has not been built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01171}01171     \} \textcolor{comment}{// End of loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01172}01172 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01173}01173     \textcolor{comment}{// Check if the element is an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01174}01174     \textcolor{comment}{// This is done on all nodes in the element after reconstruction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01175}01175     \textcolor{comment}{// rather than as the nodes are built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01176}01176     \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01177}01177 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01178}01178     \textcolor{comment}{// If so, throw error}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01179}01179     \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01180}01180     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01181}01181       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01182}01182         \textcolor{stringliteral}{"{}Have not implemented rebuilding from sons for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01183}01183       error\_message += \textcolor{stringliteral}{"{}Algebraic p-\/refineable elements yet\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01184}01184 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01185}01185       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01186}01186         error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01187}01187         \textcolor{stringliteral}{"{}PRefineableQElement<1,INITIAL\_NNODE\_1D>::rebuild\_from\_sons()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01188}01188         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01189}01189     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01190}01190   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01191}01191 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01192}01192   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01193}01193 \textcolor{comment}{  /// Check inter-\/element continuity of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01194}01194 \textcolor{comment}{  /// -\/ nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01195}01195 \textcolor{comment}{  /// -\/ (nodally) interpolated function values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01196}01196 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01197}01197   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01198}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_011_00_01INITIAL__NNODE__1D_01_4_a639085069bcf2e9415c28385880bd2bd}{01198}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, INITIAL\_NNODE\_1D>::check\_integrity}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01199}01199     \textcolor{keywordtype}{double}\& max\_error)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01200}01200   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01201}01201     \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<1>::check\_integrity}}(max\_error);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01202}01202   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01203}01203 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01204}01204 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01205}01205 \textcolor{comment}{}  \textcolor{comment}{//       2D PRefineableQElements}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01206}01206 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01207}01207 \textcolor{comment}{}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01208}01208 \textcolor{comment}{  /// Get local coordinates of node j in the element; vector sets its own size}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01209}01209 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01210}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a30e312b39ead5fbea0839bd5b9a8dea3}{01210}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::local\_coordinate\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01211}01211     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01212}01212 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01213}01213     \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}.resize(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01214}01214     \textcolor{keywordtype}{unsigned} Nnode\_1d = this-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01215}01215     \textcolor{keywordtype}{unsigned} n0 = n \% Nnode\_1d;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01216}01216     \textcolor{keywordtype}{unsigned} n1 = n / Nnode\_1d;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01217}01217 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01218}01218     \textcolor{keywordflow}{switch} (Nnode\_1d)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01219}01219     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01220}01220       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01221}01221         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01222}01222         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01223}01223         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01224}01224         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01225}01225       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01226}01226         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01227}01227         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01228}01228         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01229}01229         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01230}01230       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01231}01231         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01232}01232         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01233}01233         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01234}01234         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01235}01235       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01236}01236         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01237}01237         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01238}01238         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01239}01239         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01240}01240       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01241}01241         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01242}01242         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01243}01243         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01244}01244         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01245}01245       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01246}01246         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01247}01247         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01248}01248         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01249}01249         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01250}01250       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01251}01251         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01252}01252         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01253}01253         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01254}01254         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01255}01255                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01256}01256                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01257}01257         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01258}01258     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01259}01259   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01260}01260 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01261}01261 \textcolor{comment}{  /// Get the local fractino of node j in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01262}01262 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01263}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a2ba8be38964ccde650ff649a78a49a34}{01263}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::local\_fraction\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01264}01264     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01265}01265   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01266}01266     this-\/>local\_coordinate\_of\_node(n, s\_fraction);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01267}01267     s\_fraction[0] = 0.5 * (s\_fraction[0] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01268}01268     s\_fraction[1] = 0.5 * (s\_fraction[1] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01269}01269   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01270}01270 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01271}01271   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01272}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_af8b496db53a5d54b058f58f320e803f4}{01272}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::local\_one\_d\_fraction\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01273}01273     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n1d, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01274}01274   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01275}01275     \textcolor{keywordflow}{switch} (this-\/>nnode\_1d())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01276}01276     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01277}01277       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01278}01278         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01279}01279         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01280}01280                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01281}01281       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01282}01282         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01283}01283         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01284}01284                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01285}01285       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01286}01286         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01287}01287         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01288}01288                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01289}01289       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01290}01290         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01291}01291         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01292}01292                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01293}01293       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01294}01294         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01295}01295         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01296}01296                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01297}01297       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01298}01298         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01299}01299         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01300}01300                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01301}01301       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01302}01302         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01303}01303         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01304}01304         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01305}01305         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01306}01306                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01307}01307                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01308}01308         \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01309}01309     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01310}01310   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01311}01311 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01312}01312 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01313}01313   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01314}01314 \textcolor{comment}{  /// Return the node at the specified local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01315}01315 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01316}01316   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01317}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a50a41c20cf1ab02ed17e1b74f571fd22}{01317}}   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::get\_node\_at\_local\_coordinate}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01318}01318     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01319}01319 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01320}01320     \textcolor{keywordtype}{unsigned} Nnode\_1d = this-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01321}01321     \textcolor{comment}{// Load the tolerance into a local variable}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01322}01322     \textcolor{keywordtype}{double} tol = \mbox{\hyperlink{classoomph_1_1FiniteElement_a56eb1d0614eb76ba1591285e3efed268}{FiniteElement::Node\_location\_tolerance}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01323}01323     \textcolor{comment}{// There are two possible indices.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01324}01324     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} index(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01325}01325 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01326}01326     \textcolor{comment}{// Loop over indices}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01327}01327     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01328}01328     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01329}01329       \textcolor{comment}{// Determine the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01330}01330       \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01331}01331 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01332}01332       \textcolor{keywordtype}{bool} is\_found = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01333}01333 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01334}01334       \textcolor{comment}{// If we are at the lower limit, the index is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01335}01335       \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + 1.0) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01336}01336       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01337}01337         index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01338}01338         is\_found = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01339}01339       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01340}01340       \textcolor{comment}{// If we are at the upper limit, the index is the number of nodes minus 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01341}01341       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ 1.0) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01342}01342       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01343}01343         index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = Nnode\_1d -\/ 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01344}01344         is\_found = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01345}01345       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01346}01346       \textcolor{comment}{// Otherwise, we have to calculate the index in general}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01347}01347       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01348}01348       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01349}01349         \textcolor{comment}{// Compute Gauss-\/Lobatto-\/Legendre node positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01350}01350         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} z;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01351}01351         \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(Nnode\_1d, z);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01352}01352         \textcolor{comment}{// Loop over possible internal nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01353}01353         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 1; n < Nnode\_1d -\/ 1; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01354}01354         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01355}01355           \textcolor{keywordflow}{if} (std::fabs(z[n] -\/ \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01356}01356           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01357}01357             index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = n;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01358}01358             is\_found = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01359}01359             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01360}01360           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01361}01361         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01362}01362       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01363}01363 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01364}01364       \textcolor{keywordflow}{if} (!is\_found)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01365}01365       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01366}01366         \textcolor{comment}{// No matching nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01367}01367         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01368}01368       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01369}01369     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01370}01370     \textcolor{comment}{// If we've got here we have a node, so let's return a pointer to it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01371}01371     \textcolor{keywordflow}{return} this-\/>node\_pt(index[0] + Nnode\_1d * index[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01372}01372   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01373}01373 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01374}01374   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01375}01375 \textcolor{comment}{  /// If a neighbouring element has already created a node at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01376}01376 \textcolor{comment}{  /// a position corresponding to the local fractional position within the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01377}01377 \textcolor{comment}{  /// present element, s\_fraction, return}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01378}01378 \textcolor{comment}{  /// a pointer to that node. If not, return NULL (0). If the node is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01379}01379 \textcolor{comment}{  /// periodic the flag is\_periodic will be true}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01380}01380 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01381}01381   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01382}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_aaaef5f28edec53e201f87c3c9f2c0f61}{01382}}   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::node\_created\_by\_neighbour}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01383}01383     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction, \textcolor{keywordtype}{bool}\& is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01384}01384   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01385}01385     \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01386}01386 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01387}01387     \textcolor{comment}{// Calculate the edges on which the node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01388}01388     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} edges;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01389}01389     \textcolor{keywordflow}{if} (s\_fraction[0] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01390}01390     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01391}01391       edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01392}01392     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01393}01393     \textcolor{keywordflow}{if} (s\_fraction[0] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01394}01394     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01395}01395       edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01396}01396     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01397}01397     \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01398}01398     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01399}01399       edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{S}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01400}01400     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01401}01401     \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01402}01402     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01403}01403       edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01404}01404     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01405}01405 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01406}01406     \textcolor{comment}{// Find the number of edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01407}01407     \textcolor{keywordtype}{unsigned} n\_size = edges.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01408}01408     \textcolor{comment}{// If there are no edges, then there is no neighbour, return 0}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01409}01409     \textcolor{keywordflow}{if} (n\_size == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01410}01410     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01411}01411       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01412}01412     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01413}01413 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01414}01414     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} translate\_s(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01415}01415     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01416}01416     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01417}01417     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01418}01418 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01419}01419     \textcolor{keywordtype}{int} neigh\_edge, diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01420}01420     \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01421}01421 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01422}01422     \textcolor{comment}{// Loop over the edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01423}01423     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_size; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01424}01424     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01425}01425       \textcolor{comment}{// Find pointer to neighbouring element along edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01426}01426       \mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01427}01427       neigh\_pt = quadtree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1QuadTree_ab8cf08ddd68ec671c111bc55f9b37e70}{gteq\_edge\_neighbour}}(edges[j],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01428}01428                                                     translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01429}01429                                                     s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01430}01430                                                     s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01431}01431                                                     neigh\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01432}01432                                                     diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01433}01433                                                     in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01434}01434 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01435}01435       \textcolor{comment}{// Neighbour exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01436}01436       \textcolor{keywordflow}{if} (neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01437}01437       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01438}01438         \textcolor{comment}{// Have any of its vertex nodes been created yet?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01439}01439         \textcolor{comment}{// (Must look in incomplete neighbours because after the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01440}01440         \textcolor{comment}{// pre-\/build they may contain pointers to the required nodes. e.g.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01441}01441         \textcolor{comment}{// h-\/refinement of neighbouring linear and quadratic elements)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01442}01442         \textcolor{keywordtype}{bool} a\_vertex\_node\_is\_built = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01443}01443         \mbox{\hyperlink{classoomph_1_1QElement}{QElement<2, INITIAL\_NNODE\_1D>}}* neigh\_obj\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01444}01444           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1QElement}{QElement<2, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01445}01445         \textcolor{keywordflow}{if} (neigh\_obj\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01446}01446         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01447}01447           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Not a quad element!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01448}01448                               \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::node\_"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01449}01449                               \textcolor{stringliteral}{"{}created\_by\_neighbour()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01450}01450                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01451}01451         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01452}01452         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} vnode = 0; vnode < neigh\_obj\_pt-\/>nvertex\_node(); vnode++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01453}01453         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01454}01454           \textcolor{keywordflow}{if} (neigh\_obj\_pt-\/>vertex\_node\_pt(vnode) != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01455}01455             a\_vertex\_node\_is\_built = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01456}01456           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01457}01457         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01458}01458         \textcolor{keywordflow}{if} (a\_vertex\_node\_is\_built)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01459}01459         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01460}01460           \textcolor{comment}{// We now need to translate the nodal location}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01461}01461           \textcolor{comment}{// as defined in terms of the fractional coordinates of the present}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01462}01462           \textcolor{comment}{// element into those of its neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01463}01463 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01464}01464           \textcolor{comment}{// Calculate the local coordinate in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01465}01465           \textcolor{comment}{// Note that we need to use the translation scheme in case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01466}01466           \textcolor{comment}{// the local coordinates are swapped in the neighbour.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01467}01467           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01468}01468           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01469}01469             \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01470}01470                    s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] * (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01471}01471           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01472}01472 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01473}01473           \textcolor{comment}{// Find the node in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01474}01474           \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01475}01475             neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{get\_node\_at\_local\_coordinate}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01476}01476 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01477}01477           \textcolor{comment}{// If there is a node, return it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01478}01478           \textcolor{keywordflow}{if} (neighbour\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01479}01479           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01480}01480             \textcolor{comment}{// Now work out whether it's a periodic boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01481}01481             \textcolor{comment}{// only possible if we have moved into a neighbouring tree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01482}01482             \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01483}01483             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01484}01484               \textcolor{comment}{// Return whether the neighbour is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01485}01485               is\_periodic =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01486}01486                 quadtree\_pt()-\/>root\_pt()-\/>is\_neighbour\_periodic(edges[j]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01487}01487             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01488}01488             \textcolor{comment}{// Return the pointer to the neighbouring node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01489}01489             \textcolor{keywordflow}{return} neighbour\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01490}01490           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01491}01491         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01492}01492       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01493}01493     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01494}01494     \textcolor{comment}{// Node not found, return null}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01495}01495     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01496}01496   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01497}01497 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01498}01498   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01499}01499 \textcolor{comment}{  /// If a neighbouring element's son has already created a node at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01500}01500 \textcolor{comment}{  /// a position corresponding to the local fractional position within the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01501}01501 \textcolor{comment}{  /// present element, s\_fraction, return}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01502}01502 \textcolor{comment}{  /// a pointer to that node. If not, return NULL (0). If the node is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01503}01503 \textcolor{comment}{  /// periodic the flag is\_periodic will be true}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01504}01504 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01505}01505   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01506}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_abe1f777a74c6996aaa3cfbdb2dee1c72}{01506}}   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01507}01507 \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{    node\_created\_by\_son\_of\_neighbour}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01508}01508                                      \textcolor{keywordtype}{bool}\& is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01509}01509   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01510}01510     \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01511}01511 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01512}01512     \textcolor{comment}{// Calculate the edges on which the node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01513}01513     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} edges;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01514}01514     \textcolor{keywordflow}{if} (s\_fraction[0] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01515}01515     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01516}01516       edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01517}01517     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01518}01518     \textcolor{keywordflow}{if} (s\_fraction[0] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01519}01519     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01520}01520       edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01521}01521     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01522}01522     \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01523}01523     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01524}01524       edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{S}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01525}01525     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01526}01526     \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01527}01527     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01528}01528       edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01529}01529     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01530}01530 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01531}01531     \textcolor{comment}{// Find the number of edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01532}01532     \textcolor{keywordtype}{unsigned} n\_size = edges.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01533}01533     \textcolor{comment}{// If there are no edges, then there is no neighbour, return 0}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01534}01534     \textcolor{keywordflow}{if} (n\_size == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01535}01535     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01536}01536       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01537}01537     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01538}01538 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01539}01539     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} translate\_s(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01540}01540     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01541}01541     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01542}01542     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01543}01543 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01544}01544     \textcolor{keywordtype}{int} neigh\_edge, diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01545}01545     \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01546}01546 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01547}01547     \textcolor{comment}{// Loop over the edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01548}01548     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_size; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01549}01549     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01550}01550       \textcolor{comment}{// Find pointer to neighbouring element along edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01551}01551       \mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01552}01552       neigh\_pt = quadtree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1QuadTree_ab8cf08ddd68ec671c111bc55f9b37e70}{gteq\_edge\_neighbour}}(edges[j],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01553}01553                                                     translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01554}01554                                                     s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01555}01555                                                     s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01556}01556                                                     neigh\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01557}01557                                                     diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01558}01558                                                     in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01559}01559 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01560}01560       \textcolor{comment}{// Neighbour exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01561}01561       \textcolor{keywordflow}{if} (neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01562}01562       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01563}01563         \textcolor{comment}{// Have its nodes been created yet?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01564}01564         \textcolor{comment}{// (Must look in sons of unfinished neighbours too!!!)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01565}01565         \textcolor{keywordflow}{if} (1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01566}01566         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01567}01567           \textcolor{comment}{// We now need to translate the nodal location}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01568}01568           \textcolor{comment}{// as defined in terms of the fractional coordinates of the present}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01569}01569           \textcolor{comment}{// element into those of its neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01570}01570 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01571}01571           \textcolor{comment}{// Calculate the local coordinate in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01572}01572           \textcolor{comment}{// Note that we need to use the translation scheme in case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01573}01573           \textcolor{comment}{// the local coordinates are swapped in the neighbour.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01574}01574           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01575}01575           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01576}01576             \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01577}01577                    s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] * (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01578}01578           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01579}01579 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01580}01580           \textcolor{comment}{// Check if the element has sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01581}01581           \textcolor{keywordflow}{if} (neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a31e4123b40f6fb52d180a154c9123e85}{nsons}}() != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01582}01582           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01583}01583             \textcolor{comment}{// First, find the son element in which the node should live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01584}01584 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01585}01585             \textcolor{comment}{// Find coordinates in the sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01586}01586             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_son(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01587}01587             \textcolor{keywordtype}{int} son = -\/10;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01588}01588             \textcolor{comment}{// If negative on the west side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01589}01589             \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01590}01590             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01591}01591               \textcolor{comment}{// On the south side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01592}01592               \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01593}01593               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01594}01594                 \textcolor{comment}{// It's the southwest son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01595}01595                 son = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dab02ffb52d34a25323447061474613d81}{SW}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01596}01596                 s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01597}01597                 s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01598}01598               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01599}01599               \textcolor{comment}{// On the north side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01600}01600               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01601}01601               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01602}01602                 \textcolor{comment}{// It's the northwest son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01603}01603                 son = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa01c8378aad2e474250e6ebefb9fa942}{NW}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01604}01604                 s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01605}01605                 s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01606}01606               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01607}01607             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01608}01608             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01609}01609             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01610}01610               \textcolor{comment}{// On the south side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01611}01611               \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01612}01612               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01613}01613                 \textcolor{comment}{// It's the southeast son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01614}01614                 son = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da03479dd620c853ccd3c767125d6f29a4}{SE}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01615}01615                 s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01616}01616                 s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01617}01617               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01618}01618               \textcolor{comment}{// On the north side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01619}01619               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01620}01620               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01621}01621                 \textcolor{comment}{// It's the northeast son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01622}01622                 son = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa66bca2eb077ff943b39305b1965826f}{NE}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01623}01623                 s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01624}01624                 s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01625}01625               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01626}01626             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01627}01627 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01628}01628             \textcolor{comment}{// Find the node in the neighbour's son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01629}01629             \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_son\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01630}01630               neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a9851a9dd06212b6891ce9a8bc832d4cf}{son\_pt}}(son)-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{get\_node\_at\_local\_coordinate}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01631}01631                 s\_in\_son);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01632}01632 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01633}01633             \textcolor{comment}{// If there is a node, return it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01634}01634             \textcolor{keywordflow}{if} (neighbour\_son\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01635}01635             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01636}01636               \textcolor{comment}{// Now work out whether it's a periodic boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01637}01637               \textcolor{comment}{// only possible if we have moved into a neighbouring tree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01638}01638               \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01639}01639               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01640}01640                 \textcolor{comment}{// Return whether the neighbour is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01641}01641                 is\_periodic =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01642}01642                   quadtree\_pt()-\/>root\_pt()-\/>is\_neighbour\_periodic(edges[j]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01643}01643               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01644}01644               \textcolor{comment}{// Return the pointer to the neighbouring node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01645}01645               \textcolor{keywordflow}{return} neighbour\_son\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01646}01646             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01647}01647           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01648}01648           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01649}01649           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01650}01650             \textcolor{comment}{// No sons to search in, so no node can be found}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01651}01651             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01652}01652           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01653}01653         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01654}01654       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01655}01655     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01656}01656     \textcolor{comment}{// Node not found, return null}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01657}01657     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01658}01658   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01659}01659 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01660}01660   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01661}01661 \textcolor{comment}{  /// Set the correct p-\/order of the element based on that of its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01662}01662 \textcolor{comment}{  /// father. Then construct an integration scheme of the correct order.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01663}01663 \textcolor{comment}{  /// If an adopted father is specified, information from this is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01664}01664 \textcolor{comment}{  /// used instead of using the father found from the tree.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01665}01665 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01666}01666   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01667}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a8f5e49dc263238c79f8f924fdb6d035d}{01667}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::initial\_setup}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01668}01668     \mbox{\hyperlink{classoomph_1_1Tree}{Tree}}* \textcolor{keyword}{const}\& adopted\_father\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& initial\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01669}01669   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01670}01670     \textcolor{comment}{// Storage for pointer to my father (in quadtree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01671}01671     \mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}* father\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01672}01672 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01673}01673     \textcolor{comment}{// Check if an adopted father has been specified}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01674}01674     \textcolor{keywordflow}{if} (adopted\_father\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01675}01675     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01676}01676       \textcolor{comment}{// Get pointer to my father (in quadtree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01677}01677       father\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}*\textcolor{keyword}{>}(adopted\_father\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01678}01678     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01679}01679     \textcolor{comment}{// Check if element is in a tree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01680}01680     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Tree\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01681}01681     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01682}01682       \textcolor{comment}{// Get pointer to my father (in quadtree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01683}01683       father\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}*\textcolor{keyword}{>}(quadtree\_pt()-\/>father\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01684}01684     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01685}01685     \textcolor{comment}{// else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01686}01686     \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01687}01687     \textcolor{comment}{//  throw OomphLibError(}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01688}01688     \textcolor{comment}{//         "{}Element not in a tree, and no adopted father has been}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01689}01689     \textcolor{comment}{//         specified!"{}, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01690}01690     \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01691}01691 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01692}01692     \textcolor{comment}{// Check if we found a father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01693}01693     \textcolor{keywordflow}{if} (father\_pt != 0 || initial\_p\_order != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01694}01694     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01695}01695       \textcolor{keywordflow}{if} (father\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01696}01696       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01697}01697         \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}* father\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01698}01698           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01699}01699             father\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01700}01700         \textcolor{keywordflow}{if} (father\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01701}01701         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01702}01702           \textcolor{keywordtype}{unsigned} father\_p\_order = father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01703}01703           \textcolor{comment}{// Set p-\/order to that of father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01704}01704           P\_order = father\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01705}01705         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01706}01706       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01707}01707       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01708}01708       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01709}01709         P\_order = initial\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01710}01710       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01711}01711 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01712}01712       \textcolor{comment}{// Now sort out the element...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01713}01713       \textcolor{comment}{// (has p\string^2 nodes)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01714}01714       \textcolor{keywordtype}{unsigned} new\_n\_node = P\_order * P\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01715}01715 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01716}01716       \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01717}01717       this-\/>set\_n\_node(new\_n\_node);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01718}01718 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01719}01719       \textcolor{comment}{// Set integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01720}01720       \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01721}01721       \textcolor{keywordflow}{switch} (P\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01722}01722       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01723}01723         \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01724}01724           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01725}01725           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01726}01726         \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01727}01727           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01728}01728           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01729}01729         \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01730}01730           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01731}01731           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01732}01732         \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01733}01733           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01734}01734           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01735}01735         \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01736}01736           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01737}01737           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01738}01738         \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01739}01739           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01740}01740           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01741}01741         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01742}01742           std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01743}01743           error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01744}01744           error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01745}01745           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01746}01746                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01747}01747                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01748}01748       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01749}01749     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01750}01750   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01751}01751 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01752}01752   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01753}01753 \textcolor{comment}{  /// Check the father element for any required nodes which}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01754}01754 \textcolor{comment}{  /// already exist}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01755}01755 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01756}01756   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01757}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a1bb8bcd4562fcdfbac80f4db0f38ed76}{01757}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::pre\_build}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01758}01758     \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}\& new\_node\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01759}01759   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01760}01760     \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01761}01761 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01762}01762     \textcolor{comment}{// Get the number of 1d nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01763}01763     \textcolor{keywordtype}{unsigned} n\_p = nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01764}01764 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01765}01765     \textcolor{comment}{// Check whether static father\_bound needs to be created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01766}01766     \textcolor{keywordflow}{if} (Father\_bound[n\_p].nrow() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01767}01767     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01768}01768       setup\_father\_bounds();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01769}01769     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01770}01770 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01771}01771     \textcolor{comment}{// Pointer to my father (in quadtree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01772}01772     \mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}* father\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}*\textcolor{keyword}{>}(quadtree\_pt()-\/>father\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01773}01773 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01774}01774     \textcolor{comment}{// What type of son am I? Ask my quadtree representation...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01775}01775     \textcolor{keywordtype}{int} son\_type = Tree\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7537f8fe7c896d2220eb2da03567b34d}{son\_type}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01776}01776 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01777}01777     \textcolor{comment}{// Has somebody build me already? (If any nodes have not been built)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01778}01778     \textcolor{keywordflow}{if} (!nodes\_built())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01779}01779     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01780}01780 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01781}01781       \textcolor{keywordflow}{if} (father\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01782}01782       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01783}01783         \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01784}01784           \textcolor{stringliteral}{"{}Something fishy here: I have no father and yet \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01785}01785         error\_message += \textcolor{stringliteral}{"{}I have no nodes. Who has created me then?!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01786}01786 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01787}01787         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01788}01788           error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01789}01789       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01790}01790 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01791}01791 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01792}01792       \textcolor{comment}{// Return pointer to father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01793}01793       \mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4}{RefineableQElement<2>}}* father\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01794}01794         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4}{RefineableQElement<2>}}*\textcolor{keyword}{>}(father\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01795}01795 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01796}01796       \textcolor{comment}{// Timestepper should be the same for all nodes in father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01797}01797       \textcolor{comment}{// element -\/-\/ use it create timesteppers for new nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01798}01798       \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01799}01799         father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1Data_a065d7bffcec82bf4d4bd7b41f9aa80b3}{time\_stepper\_pt}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01800}01800 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01801}01801       \textcolor{comment}{// Number of history values (incl. present)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01802}01802       \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>ntstorage();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01803}01803 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01804}01804       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01805}01805       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01806}01806       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01807}01807       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01808}01808 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01809}01809       \textcolor{comment}{// Setup vertex coordinates in father element:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01810}01810       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01811}01811       \textcolor{keywordflow}{switch} (son\_type)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01812}01812       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01813}01813         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dab02ffb52d34a25323447061474613d81}{SW}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01814}01814           s\_lo[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01815}01815           s\_hi[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01816}01816           s\_lo[1] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01817}01817           s\_hi[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01818}01818           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01819}01819 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01820}01820         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da03479dd620c853ccd3c767125d6f29a4}{SE}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01821}01821           s\_lo[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01822}01822           s\_hi[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01823}01823           s\_lo[1] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01824}01824           s\_hi[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01825}01825           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01826}01826 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01827}01827         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa66bca2eb077ff943b39305b1965826f}{NE}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01828}01828           s\_lo[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01829}01829           s\_hi[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01830}01830           s\_lo[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01831}01831           s\_hi[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01832}01832           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01833}01833 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01834}01834         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa01c8378aad2e474250e6ebefb9fa942}{NW}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01835}01835           s\_lo[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01836}01836           s\_hi[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01837}01837           s\_lo[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01838}01838           s\_hi[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01839}01839           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01840}01840       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01841}01841 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01842}01842       \textcolor{comment}{// Pass macro element pointer on to sons and}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01843}01843       \textcolor{comment}{// set coordinates in macro element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01844}01844       \textcolor{comment}{// hierher why can I see this?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01845}01845       \textcolor{keywordflow}{if} (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a801bbe89619c28e181afa8fa3e9ac836}{macro\_elem\_pt}}() != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01846}01846       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01847}01847         set\_macro\_elem\_pt(father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a801bbe89619c28e181afa8fa3e9ac836}{macro\_elem\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01848}01848         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01849}01849         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01850}01850           s\_macro\_ll(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01851}01851             father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01852}01852             0.5 * (s\_lo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + 1.0) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01853}01853               (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a0e02d2c0be2b93967700723d77891cb2}{s\_macro\_ur}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01854}01854           s\_macro\_ur(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01855}01855             father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01856}01856             0.5 * (s\_hi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + 1.0) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01857}01857               (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a0e02d2c0be2b93967700723d77891cb2}{s\_macro\_ur}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01858}01858         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01859}01859       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01860}01860 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01861}01861 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01862}01862       \textcolor{comment}{// If the father element hasn't been generated yet, we're stuck...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01863}01863       \textcolor{keywordflow}{if} (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0) == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01864}01864       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01865}01865         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01866}01866           \textcolor{stringliteral}{"{}Trouble: father\_el\_pt-\/>node\_pt(0)==0\(\backslash\)n Can't build son element!\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01867}01867           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01868}01868           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01869}01869       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01870}01870       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01871}01871       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01872}01872         \textcolor{keywordtype}{unsigned} jnod = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01873}01873         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_small(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01874}01874         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_large(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01875}01875 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01876}01876         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01877}01877         \textcolor{comment}{// Loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01878}01878         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01879}01879         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01880}01880           \textcolor{comment}{// Get the fractional position of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01881}01881           s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01882}01882           \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01883}01883           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_lo[0] + (s\_hi[0] -\/ s\_lo[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01884}01884 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01885}01885           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < n\_p; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01886}01886           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01887}01887             \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01888}01888             s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01889}01889             \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01890}01890             \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = s\_lo[1] + (s\_hi[1] -\/ s\_lo[1]) * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01891}01891 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01892}01892             \textcolor{comment}{// Local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01893}01893             jnod = i0 + n\_p * i1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01894}01894 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01895}01895             \textcolor{comment}{// Check whether the father's node is periodic if so, complain}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01896}01896             \textcolor{comment}{/* \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01897}01897 \textcolor{comment}{              Node* father\_node\_pt = father\_el\_pt-\/>node\_pt(jnod);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01898}01898 \textcolor{comment}{              if((father\_node\_pt-\/>is\_a\_copy()) ||}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01899}01899 \textcolor{comment}{              (father\_node\_pt-\/>position\_is\_a\_copy()))}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01900}01900 \textcolor{comment}{              \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01901}01901 \textcolor{comment}{              throw OomphLibError(}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01902}01902 \textcolor{comment}{              "{}Can't handle periodic nodes (yet)."{},}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01903}01903 \textcolor{comment}{              OOMPH\_CURRENT\_FUNCTION,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01904}01904 \textcolor{comment}{              OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01905}01905 \textcolor{comment}{              \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01906}01906 \textcolor{comment}{              \}*/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01907}01907 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01908}01908             \textcolor{comment}{// Initialise flag: So far, this node hasn't been built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01909}01909             \textcolor{comment}{// or copied yet}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01910}01910             \textcolor{comment}{// bool node\_done=false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01911}01911 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01912}01912             \textcolor{comment}{// Get the pointer to the node in the father, returns NULL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01913}01913             \textcolor{comment}{// if there is not node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01914}01914             \mbox{\hyperlink{classoomph_1_1Node}{Node}}* created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01915}01915               father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{get\_node\_at\_local\_coordinate}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01916}01916 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01917}01917             \textcolor{comment}{// Does this node already exist in father element?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01918}01918             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01919}01919             \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01920}01920             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01921}01921               \textcolor{comment}{// Copy node across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01922}01922               this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01923}01923 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01924}01924               \textcolor{comment}{// Make sure that we update the values at the node so that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01925}01925               \textcolor{comment}{// they are consistent with the present representation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01926}01926               \textcolor{comment}{// This is only need for mixed interpolation where the value}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01927}01927               \textcolor{comment}{// at the father could now become active.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01928}01928 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01929}01929               \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01930}01930               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01931}01931               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01932}01932                 \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01933}01933                 \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01934}01934                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01935}01935                 father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01936}01936                 \textcolor{comment}{// Find the minimum number of values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01937}01937                 \textcolor{comment}{//(either those stored at the node, or those returned by}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01938}01938                 \textcolor{comment}{// the function)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01939}01939                 \textcolor{keywordtype}{unsigned} n\_val\_at\_node = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01940}01940                 \textcolor{keywordtype}{unsigned} n\_val\_from\_function = prev\_values.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01941}01941                 \textcolor{comment}{// Use the ternary conditional operator here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01942}01942                 \textcolor{keywordtype}{unsigned} n\_var = n\_val\_at\_node < n\_val\_from\_function ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01943}01943                                    n\_val\_at\_node :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01944}01944                                    n\_val\_from\_function;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01945}01945                 \textcolor{comment}{// Assign the values that we can}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01946}01946                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_var; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01947}01947                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01948}01948                   created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01949}01949                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01950}01950               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01951}01951 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01952}01952               \textcolor{comment}{// Node has been created by copy}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01953}01953               \textcolor{comment}{// node\_done=true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01954}01954             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01955}01955           \} \textcolor{comment}{// End of vertical loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01956}01956         \} \textcolor{comment}{// End of horizontal loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01957}01957       \} \textcolor{comment}{// Sanity check: Father element has been generated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01958}01958 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01959}01959     \} \textcolor{comment}{// End of nodes not built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01960}01960     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01961}01961     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01962}01962       \textcolor{comment}{// If this is element updates by macro element node update then we need}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01963}01963       \textcolor{comment}{// to set the correct info in the nodes here since this won't get done}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01964}01964       \textcolor{comment}{// later in build() because we already have all our nodes created.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01965}01965       \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01966}01966         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01967}01967       \textcolor{keywordflow}{if} (m\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01968}01968       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01969}01969         \textcolor{comment}{// Get vector of geometric objects}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01970}01970         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_pt = m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01971}01971 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01972}01972 \textcolor{comment}{        /// / Build update info by passing vector of geometric objects:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01973}01973 \textcolor{comment}{        /// / This sets the current element to be the update element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01974}01974 \textcolor{comment}{        /// / for all of the element's nodes -\/-\/ this is reversed}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01975}01975 \textcolor{comment}{        /// / if the element is ever un-\/refined in the father element's}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01976}01976 \textcolor{comment}{        /// / rebuild\_from\_sons() function which overwrites this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01977}01977 \textcolor{comment}{        /// / assignment to avoid nasty segmentation faults that occur}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01978}01978 \textcolor{comment}{        /// / when a node tries to update itself via an element that no}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01979}01979 \textcolor{comment}{        /// / longer exists...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01980}01980 \textcolor{comment}{}        m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_aa2408d8463e8cecc2ad12a93e10390b1}{set\_node\_update\_info}}(geom\_object\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01981}01981       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01982}01982     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01983}01983   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01984}01984 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01985}01985   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01986}01986 \textcolor{comment}{  /// p-\/refine the element inc times. (If inc<0 then p-\/unrefinement}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01987}01987 \textcolor{comment}{  /// is performed.)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01988}01988 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01989}01989   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01990}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_aa74bd994a95736da7c0c92297959b026}{01990}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::p\_refine}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01991}01991     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& inc, \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt, \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& clone\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01992}01992   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01993}01993     \textcolor{comment}{// Cast clone to correct type}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01994}01994     \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}* clone\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01995}01995       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(clone\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01996}01996 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01997}01997     \textcolor{comment}{// If it is a MacroElement then we need to copy the geometric data too.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01998}01998     \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l01999}01999       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02000}02000     \textcolor{keywordflow}{if} (m\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02001}02001     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02002}02002       \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* clone\_m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02003}02003         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(clone\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02004}02004 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02005}02005       \textcolor{comment}{// Store local copy of geom object vector, so it can be passed on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02006}02006       \textcolor{comment}{// to son elements (and their nodes) during refinement}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02007}02007       \textcolor{keywordtype}{unsigned} ngeom\_object = m\_el\_pt-\/>ngeom\_object();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02008}02008       clone\_m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}().resize(ngeom\_object);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02009}02009       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ngeom\_object; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02010}02010       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02011}02011         clone\_m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}()[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = m\_el\_pt-\/>geom\_object\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02012}02012       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02013}02013 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02014}02014       \textcolor{comment}{// clone\_m\_el\_pt-\/>set\_node\_update\_info(m\_el\_pt-\/>geom\_object\_pt());}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02015}02015     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02016}02016 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02017}02017     \textcolor{comment}{// Check if we can use it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02018}02018     \textcolor{keywordflow}{if} (clone\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02019}02019     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02020}02020       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02021}02021         \textcolor{stringliteral}{"{}Cloned copy must be a PRefineableQElement<2,INITIAL\_NNODE\_1D>!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02022}02022         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02023}02023         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02024}02024     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02025}02025 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02026}02026     \textcolor{comment}{// Clone exists, so check that it is infact a copy of me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02027}02027     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02028}02028     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02029}02029       \textcolor{comment}{// Flag to keep track of check}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02030}02030       \textcolor{keywordtype}{bool} clone\_is\_ok = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02031}02031 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02032}02032       \textcolor{comment}{// Does the clone have the correct p-\/order?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02033}02033       clone\_is\_ok = clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}() == this-\/>p\_order());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02034}02034 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02035}02035       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02036}02036       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02037}02037         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02038}02038         err\_stream << \textcolor{stringliteral}{"{}Clone element has a different p-\/order from me,"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02039}02039                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02040}02040                    << \textcolor{stringliteral}{"{}but it is supposed to be a copy!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02041}02041 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02042}02042         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02043}02043           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02044}02044       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02045}02045 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02046}02046       \textcolor{comment}{// Does the clone have the same number of nodes as me?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02047}02047       clone\_is\_ok = clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}() == this-\/>nnode());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02048}02048 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02049}02049       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02050}02050       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02051}02051         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02052}02052         err\_stream << \textcolor{stringliteral}{"{}Clone element has a different number of nodes from me,"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02053}02053                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02054}02054                    << \textcolor{stringliteral}{"{}but it is supposed to be a copy!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02055}02055 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02056}02056         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02057}02057           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02058}02058       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02059}02059 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02060}02060       \textcolor{comment}{// Does the clone have the same nodes as me?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02061}02061       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < this-\/>nnode(); n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02062}02062       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02063}02063         clone\_is\_ok =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02064}02064           clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(n) == this-\/>node\_pt(n));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02065}02065       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02066}02066 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02067}02067       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02068}02068       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02069}02069         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02070}02070         err\_stream << \textcolor{stringliteral}{"{}The nodes belonging to the clone element are different"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02071}02071                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02072}02072                    << \textcolor{stringliteral}{"{}from mine, but it is supposed to be a copy!"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02073}02073                    << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02074}02074 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02075}02075         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02076}02076           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02077}02077       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02078}02078 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02079}02079       \textcolor{comment}{// Is this a macro element?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02080}02080       \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02081}02081         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02082}02082       \textcolor{keywordflow}{if} (m\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02083}02083       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02084}02084         \textcolor{comment}{// Get macro element version of clone}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02085}02085         \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* clone\_m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02086}02086           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02087}02087 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02088}02088         \textcolor{comment}{// Does the clone have the same geometric objects?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02089}02089         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} clone\_geom\_object\_pt(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02090}02090           clone\_m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02091}02091         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_pt(m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02092}02092 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02093}02093         clone\_is\_ok =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02094}02094           clone\_is\_ok \&\& (geom\_object\_pt.size() == clone\_geom\_object\_pt.size());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02095}02095         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02096}02096              n < std::min(geom\_object\_pt.size(), clone\_geom\_object\_pt.size());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02097}02097              n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02098}02098         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02099}02099           clone\_is\_ok =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02100}02100             clone\_is\_ok \&\& (clone\_geom\_object\_pt[n] == geom\_object\_pt[n]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02101}02101         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02102}02102 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02103}02103         \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02104}02104         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02105}02105           std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02106}02106           err\_stream << \textcolor{stringliteral}{"{}The clone element has different geometric objects"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02107}02107                      << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02108}02108                      << \textcolor{stringliteral}{"{}from mine, but it is supposed to be a copy!"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02109}02109                      << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02110}02110 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02111}02111           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02112}02112             err\_stream.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02113}02113             \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::p\_refine()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02114}02114             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02115}02115         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02116}02116       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02117}02117 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02118}02118       \textcolor{comment}{// If we get to here then the clone has all the information we require}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02119}02119     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02120}02120 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02121}02121 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02122}02122     \textcolor{comment}{// Currently we can't handle the case of generalised coordinates}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02123}02123     \textcolor{comment}{// since we haven't established how they should be interpolated.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02124}02124     \textcolor{comment}{// Buffer this case:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02125}02125     \textcolor{keywordflow}{if} (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1Node_aee6f2b7a46fc9d875c6736895d7fc095}{nposition\_type}}() != 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02126}02126     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02127}02127       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Can't handle generalised nodal positions (yet)."{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02128}02128                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02129}02129                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02130}02130     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02131}02131 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02132}02132     \textcolor{comment}{// Timestepper should be the same for all nodes -\/-\/ use it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02133}02133     \textcolor{comment}{// to create timesteppers for new nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02134}02134     \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = this-\/>node\_pt(0)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02135}02135 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02136}02136     \textcolor{comment}{// Get number of history values (incl. present)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02137}02137     \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02138}02138 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02139}02139     \textcolor{comment}{// Increment p-\/order of the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02140}02140     P\_order += inc;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02141}02141 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02142}02142     \textcolor{comment}{// Change integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02143}02143     \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02144}02144     \textcolor{keywordflow}{switch} (P\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02145}02145     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02146}02146       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02147}02147         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02148}02148         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02149}02149       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02150}02150         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02151}02151         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02152}02152       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02153}02153         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02154}02154         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02155}02155       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02156}02156         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02157}02157         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02158}02158       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02159}02159         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02160}02160         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02161}02161       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02162}02162         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02163}02163         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02164}02164       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02165}02165         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02166}02166         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02167}02167         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02168}02168         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02169}02169                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02170}02170                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02171}02171     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02172}02172 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02173}02173     \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02174}02174     this-\/>set\_n\_node(P\_order * P\_order);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02175}02175 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02176}02176     \textcolor{comment}{// Copy vertex nodes and create new edge and internal nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02177}02177     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02178}02178 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02179}02179     \textcolor{comment}{// Setup vertex coordinates in element:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02180}02180     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02181}02181     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02182}02182     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02183}02183     s\_lo[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02184}02184     s\_hi[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02185}02185     s\_lo[1] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02186}02186     s\_hi[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02187}02187 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02188}02188     \textcolor{comment}{// Local coordinate in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02189}02189     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02190}02190 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02191}02191     \textcolor{keywordtype}{unsigned} jnod = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02192}02192 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02193}02193     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02194}02194     \textcolor{comment}{// Loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02195}02195     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < P\_order; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02196}02196     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02197}02197       \textcolor{comment}{// Get the fractional position of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02198}02198       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02199}02199       \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02200}02200       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_lo[0] + (s\_hi[0] -\/ s\_lo[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02201}02201 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02202}02202       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < P\_order; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02203}02203       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02204}02204         \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02205}02205         s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02206}02206         \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02207}02207         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = s\_lo[1] + (s\_hi[1] -\/ s\_lo[1]) * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02208}02208 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02209}02209         \textcolor{comment}{// Local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02210}02210         jnod = i0 + P\_order * i1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02211}02211 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02212}02212         \textcolor{comment}{// Initialise flag: So far, this node hasn't been built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02213}02213         \textcolor{comment}{// or copied yet}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02214}02214         \textcolor{keywordtype}{bool} node\_done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02215}02215 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02216}02216         \textcolor{comment}{// Get the pointer to the node in this element (or rather, its clone),}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02217}02217         \textcolor{comment}{// returns NULL if there is not node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02218}02218         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* created\_node\_pt = clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a50a41c20cf1ab02ed17e1b74f571fd22}{get\_node\_at\_local\_coordinate}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02219}02219 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02220}02220         \textcolor{comment}{// Does this node already exist in this element?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02221}02221         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02222}02222         \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02223}02223         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02224}02224           \textcolor{comment}{// Copy node across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02225}02225           this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02226}02226 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02227}02227           \textcolor{comment}{// Make sure that we update the values at the node so that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02228}02228           \textcolor{comment}{// they are consistent with the present representation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02229}02229           \textcolor{comment}{// This is only need for mixed interpolation where the value}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02230}02230           \textcolor{comment}{// at the father could now become active.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02231}02231 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02232}02232           \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02233}02233           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02234}02234           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02235}02235             \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02236}02236             \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02237}02237             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02238}02238             clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02239}02239             \textcolor{comment}{// Find the minimum number of values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02240}02240             \textcolor{comment}{//(either those stored at the node, or those returned by}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02241}02241             \textcolor{comment}{// the function)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02242}02242             \textcolor{keywordtype}{unsigned} n\_val\_at\_node = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02243}02243             \textcolor{keywordtype}{unsigned} n\_val\_from\_function = prev\_values.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02244}02244             \textcolor{comment}{// Use the ternary conditional operator here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02245}02245             \textcolor{keywordtype}{unsigned} n\_var = n\_val\_at\_node < n\_val\_from\_function ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02246}02246                                n\_val\_at\_node :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02247}02247                                n\_val\_from\_function;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02248}02248             \textcolor{comment}{// Assign the values that we can}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02249}02249             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_var; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02250}02250             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02251}02251               created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02252}02252             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02253}02253           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02254}02254 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02255}02255           \textcolor{comment}{// Node has been created by copy}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02256}02256           node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02257}02257         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02258}02258         \textcolor{comment}{// Node does not exist in this element but might already}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02259}02259         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02260}02260         \textcolor{comment}{// have been created by neighbouring elements}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02261}02261         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02262}02262         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02263}02263         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02264}02264           \textcolor{comment}{// Was the node created by one of its neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02265}02265           \textcolor{comment}{// Whether or not the node lies on an edge can be calculated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02266}02266           \textcolor{comment}{// by from the fractional position}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02267}02267           \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02268}02268           created\_node\_pt = node\_created\_by\_neighbour(s\_fraction, is\_periodic);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02269}02269 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02270}02270           \textcolor{comment}{// If the node was so created, assign the pointers}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02271}02271           \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02272}02272           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02273}02273             \textcolor{comment}{// If the node is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02274}02274             \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02275}02275             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02276}02276               \textcolor{comment}{// Now the node must be on a boundary, but we don't know which}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02277}02277               \textcolor{comment}{// one}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02278}02278               \textcolor{comment}{// The returned created\_node\_pt is actually the neighbouring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02279}02279               \textcolor{comment}{// periodic node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02280}02280               \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02281}02281 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02282}02282               \textcolor{comment}{// Determine the edge on which the new node will live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02283}02283               \textcolor{comment}{//(cannot be a vertex node)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02284}02284               \textcolor{keywordtype}{int} my\_bound = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02285}02285               \textcolor{keywordflow}{if} (s\_fraction[0] == 0.0) my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{QuadTreeNames::W}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02286}02286               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[0] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02287}02287                 my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{QuadTreeNames::E}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02288}02288               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02289}02289                 my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{QuadTreeNames::S}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02290}02290               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02291}02291                 my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{QuadTreeNames::N}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02292}02292 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02293}02293               \textcolor{comment}{// Storage for the set of Mesh boundaries on which the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02294}02294               \textcolor{comment}{// appropriate edge lives.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02295}02295               \textcolor{comment}{// [New nodes should always be mid-\/edge nodes and therefore}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02296}02296               \textcolor{comment}{// only live on one boundary but just to play it safe...]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02297}02297               std::set<unsigned> boundaries;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02298}02298               \textcolor{comment}{// Only get the boundaries if we are at the edge of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02299}02299               \textcolor{comment}{// an element. Nodes in the centre of an element cannot be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02300}02300               \textcolor{comment}{// on Mesh boundaries}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02301}02301               \textcolor{keywordflow}{if} (my\_bound != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02302}02302               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02303}02303                 clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_a739ecb3d2eff4c9d08efa79a39d387b0}{get\_boundaries}}(my\_bound, boundaries);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02304}02304               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02305}02305 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02306}02306 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02307}02307               \textcolor{comment}{// Case where a new node lives on more than one boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02308}02308               \textcolor{comment}{// seems fishy enough to flag}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02309}02309               \textcolor{keywordflow}{if} (boundaries.size() > 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02310}02310               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02311}02311                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02312}02312                   \textcolor{stringliteral}{"{}boundaries.size()!=1 seems a bit strange..\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02313}02313                   OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02314}02314                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02315}02315               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02316}02316 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02317}02317               \textcolor{comment}{// Case when there are no boundaries, we are in big trouble}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02318}02318               \textcolor{keywordflow}{if} (boundaries.size() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02319}02319               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02320}02320                 std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02321}02321                 error\_stream << \textcolor{stringliteral}{"{}Periodic node is not on a boundary...\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02322}02322                              << \textcolor{stringliteral}{"{}Coordinates: "{}} << created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02323}02323                              << created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02324}02324                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02325}02325                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02326}02326                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02327}02327               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02328}02328 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02329}02329 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02330}02330               \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02331}02331               created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02332}02332                 this-\/>construct\_boundary\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02333}02333               \textcolor{comment}{// Make the node periodic from the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02334}02334               created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_aeb07848c19b83fd8b9690b8fcc200d56}{make\_periodic}}(neighbour\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02335}02335 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02336}02336               \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02337}02337               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02338}02338               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02339}02339                 \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02340}02340                 \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02341}02341                 \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02342}02342                 \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02343}02343                 \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02344}02344                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02345}02345                 clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02346}02346                 \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02347}02347                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02348}02348                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02349}02349                   created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02350}02350                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02351}02351               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02352}02352 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02353}02353               \textcolor{comment}{// Check if we need to add nodes to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02354}02354               \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02355}02355               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02356}02356                 \textcolor{comment}{// Next, we Update the boundary lookup schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02357}02357                 \textcolor{comment}{// Loop over the boundaries stored in the set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02358}02358                 \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries.begin();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02359}02359                      it != boundaries.end();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02360}02360                      ++it)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02361}02361                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02362}02362                   \textcolor{comment}{// Add the node to the boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02363}02363                   mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(*it, created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02364}02364 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02365}02365                   \textcolor{comment}{// If we have set an intrinsic coordinate on this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02366}02366                   \textcolor{comment}{// mesh boundary then it must also be interpolated on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02367}02367                   \textcolor{comment}{// the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02368}02368                   \textcolor{comment}{// Now interpolate the intrinsic boundary coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02369}02369                   \textcolor{keywordflow}{if} (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad1b124a959628aba00162b89617b3a62}{boundary\_coordinate\_exists}}(*it) == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02370}02370                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02371}02371                     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02372}02372                     clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_af7796513af01efa2ad009876e81abe3b}{interpolated\_zeta\_on\_edge}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02373}02373                       *it, my\_bound, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02374}02374 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02375}02375                     created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a94c19e165ab4e88aabbfa27443c530b7}{set\_coordinates\_on\_boundary}}(*it, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02376}02376                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02377}02377                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02378}02378 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02379}02379                 \textcolor{comment}{// Make sure that we add the node to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02380}02380                 mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02381}02381               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02382}02382             \} \textcolor{comment}{// End of periodic case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02383}02383             \textcolor{comment}{// Otherwise the node is not periodic, so just set the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02384}02384             \textcolor{comment}{// pointer to the neighbours node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02385}02385             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02386}02386             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02387}02387               this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02388}02388             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02389}02389             \textcolor{comment}{// Node has been created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02390}02390             node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02391}02391           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02392}02392           \textcolor{comment}{// Node does not exist in neighbour element but might already}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02393}02393           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02394}02394           \textcolor{comment}{// have been created by a son of a neighbouring element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02395}02395           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02396}02396           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02397}02397           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02398}02398             \textcolor{comment}{// Was the node created by one of its neighbours' sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02399}02399             \textcolor{comment}{// Whether or not the node lies on an edge can be calculated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02400}02400             \textcolor{comment}{// by from the fractional position}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02401}02401             \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02402}02402             created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02403}02403               node\_created\_by\_son\_of\_neighbour(s\_fraction, is\_periodic);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02404}02404 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02405}02405             \textcolor{comment}{// If the node was so created, assign the pointers}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02406}02406             \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02407}02407             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02408}02408               \textcolor{comment}{// If the node is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02409}02409               \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02410}02410               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02411}02411                 \textcolor{comment}{// Now the node must be on a boundary, but we don't know which}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02412}02412                 \textcolor{comment}{// one}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02413}02413                 \textcolor{comment}{// The returned created\_node\_pt is actually the neighbouring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02414}02414                 \textcolor{comment}{// periodic node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02415}02415                 \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02416}02416 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02417}02417                 \textcolor{comment}{// Determine the edge on which the new node will live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02418}02418                 \textcolor{comment}{//(cannot be a vertex node)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02419}02419                 \textcolor{keywordtype}{int} my\_bound = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02420}02420                 \textcolor{keywordflow}{if} (s\_fraction[0] == 0.0) my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{QuadTreeNames::W}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02421}02421                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[0] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02422}02422                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{QuadTreeNames::E}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02423}02423                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02424}02424                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{QuadTreeNames::S}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02425}02425                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02426}02426                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{QuadTreeNames::N}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02427}02427 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02428}02428                 \textcolor{comment}{// Storage for the set of Mesh boundaries on which the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02429}02429                 \textcolor{comment}{// appropriate edge lives.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02430}02430                 \textcolor{comment}{// [New nodes should always be mid-\/edge nodes and therefore}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02431}02431                 \textcolor{comment}{// only live on one boundary but just to play it safe...]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02432}02432                 std::set<unsigned> boundaries;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02433}02433                 \textcolor{comment}{// Only get the boundaries if we are at the edge of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02434}02434                 \textcolor{comment}{// an element. Nodes in the centre of an element cannot be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02435}02435                 \textcolor{comment}{// on Mesh boundaries}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02436}02436                 \textcolor{keywordflow}{if} (my\_bound != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02437}02437                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02438}02438                   clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_a739ecb3d2eff4c9d08efa79a39d387b0}{get\_boundaries}}(my\_bound, boundaries);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02439}02439                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02440}02440 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02441}02441 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02442}02442                 \textcolor{comment}{// Case where a new node lives on more than one boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02443}02443                 \textcolor{comment}{// seems fishy enough to flag}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02444}02444                 \textcolor{keywordflow}{if} (boundaries.size() > 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02445}02445                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02446}02446                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02447}02447                     \textcolor{stringliteral}{"{}boundaries.size()!=1 seems a bit strange..\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02448}02448                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02449}02449                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02450}02450                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02451}02451 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02452}02452                 \textcolor{comment}{// Case when there are no boundaries, we are in big trouble}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02453}02453                 \textcolor{keywordflow}{if} (boundaries.size() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02454}02454                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02455}02455                   std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02456}02456                   error\_stream << \textcolor{stringliteral}{"{}Periodic node is not on a boundary...\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02457}02457                                << \textcolor{stringliteral}{"{}Coordinates: "{}} << created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02458}02458                                << \textcolor{stringliteral}{"{} "{}} << created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02459}02459                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02460}02460                                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02461}02461                                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02462}02462                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02463}02463 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02464}02464 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02465}02465                 \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02466}02466                 created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02467}02467                   this-\/>construct\_boundary\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02468}02468                 \textcolor{comment}{// Make the node periodic from the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02469}02469                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_aeb07848c19b83fd8b9690b8fcc200d56}{make\_periodic}}(neighbour\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02470}02470 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02471}02471                 \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02472}02472                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02473}02473                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02474}02474                   \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02475}02475                   \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02476}02476                   \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02477}02477                   \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02478}02478                   \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02479}02479                   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02480}02480                   clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02481}02481                   \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02482}02482                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02483}02483                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02484}02484                     created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02485}02485                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02486}02486                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02487}02487 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02488}02488                 \textcolor{comment}{// Check if we need to add nodes to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02489}02489                 \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02490}02490                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02491}02491                   \textcolor{comment}{// Next, we Update the boundary lookup schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02492}02492                   \textcolor{comment}{// Loop over the boundaries stored in the set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02493}02493                   \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries.begin();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02494}02494                        it != boundaries.end();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02495}02495                        ++it)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02496}02496                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02497}02497                     \textcolor{comment}{// Add the node to the boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02498}02498                     mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(*it, created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02499}02499 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02500}02500                     \textcolor{comment}{// If we have set an intrinsic coordinate on this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02501}02501                     \textcolor{comment}{// mesh boundary then it must also be interpolated on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02502}02502                     \textcolor{comment}{// the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02503}02503                     \textcolor{comment}{// Now interpolate the intrinsic boundary coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02504}02504                     \textcolor{keywordflow}{if} (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad1b124a959628aba00162b89617b3a62}{boundary\_coordinate\_exists}}(*it) == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02505}02505                     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02506}02506                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02507}02507                       clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_af7796513af01efa2ad009876e81abe3b}{interpolated\_zeta\_on\_edge}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02508}02508                         *it, my\_bound, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02509}02509 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02510}02510                       created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a94c19e165ab4e88aabbfa27443c530b7}{set\_coordinates\_on\_boundary}}(*it, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02511}02511                     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02512}02512                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02513}02513 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02514}02514                   \textcolor{comment}{// Make sure that we add the node to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02515}02515                   mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02516}02516                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02517}02517               \} \textcolor{comment}{// End of periodic case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02518}02518               \textcolor{comment}{// Otherwise the node is not periodic, so just set the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02519}02519               \textcolor{comment}{// pointer to the neighbours node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02520}02520               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02521}02521               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02522}02522                 this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02523}02523               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02524}02524               \textcolor{comment}{// Node has been created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02525}02525               node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02526}02526             \} \textcolor{comment}{// Node does not exist in son of neighbouring element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02527}02527           \} \textcolor{comment}{// Node does not exist in neighbouring element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02528}02528         \} \textcolor{comment}{// Node does not exist in this element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02529}02529 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02530}02530         \textcolor{comment}{// Node has not been built anywhere -\/-\/-\/> build it here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02531}02531         \textcolor{keywordflow}{if} (!node\_done)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02532}02532         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02533}02533           \textcolor{comment}{// Firstly, we need to determine whether or not a node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02534}02534           \textcolor{comment}{// on the boundary before building it, because}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02535}02535           \textcolor{comment}{// we actually assign a different type of node on boundaries.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02536}02536 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02537}02537           \textcolor{comment}{// Determine the edge on which the new node will live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02538}02538           \textcolor{comment}{//(cannot be a vertex node)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02539}02539           \textcolor{keywordtype}{int} my\_bound = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02540}02540           \textcolor{keywordflow}{if} (s\_fraction[0] == 0.0) my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{QuadTreeNames::W}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02541}02541           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[0] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02542}02542             my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{QuadTreeNames::E}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02543}02543           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02544}02544             my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{QuadTreeNames::S}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02545}02545           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02546}02546             my\_bound = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{QuadTreeNames::N}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02547}02547 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02548}02548           \textcolor{comment}{// Storage for the set of Mesh boundaries on which the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02549}02549           \textcolor{comment}{// appropriate edge lives.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02550}02550           \textcolor{comment}{// [New nodes should always be mid-\/edge nodes and therefore}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02551}02551           \textcolor{comment}{// only live on one boundary but just to play it safe...]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02552}02552           std::set<unsigned> boundaries;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02553}02553           \textcolor{comment}{// Only get the boundaries if we are at the edge of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02554}02554           \textcolor{comment}{// an element. Nodes in the centre of an element cannot be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02555}02555           \textcolor{comment}{// on Mesh boundaries}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02556}02556           \textcolor{keywordflow}{if} (my\_bound != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02557}02557           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02558}02558             clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_a739ecb3d2eff4c9d08efa79a39d387b0}{get\_boundaries}}(my\_bound, boundaries);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02559}02559           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02560}02560 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02561}02561 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02562}02562           \textcolor{comment}{// Case where a new node lives on more than one boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02563}02563           \textcolor{comment}{// seems fishy enough to flag}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02564}02564           \textcolor{keywordflow}{if} (boundaries.size() > 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02565}02565           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02566}02566             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}boundaries.size()!=1 seems a bit strange..\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02567}02567                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02568}02568                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02569}02569           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02570}02570 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02571}02571 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02572}02572           \textcolor{comment}{// If the node lives on a mesh boundary,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02573}02573           \textcolor{comment}{// then we need to create a boundary node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02574}02574           \textcolor{keywordflow}{if} (boundaries.size() > 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02575}02575           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02576}02576             \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02577}02577             created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02578}02578               this-\/>construct\_boundary\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02579}02579 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02580}02580             \textcolor{comment}{// Now we need to work out whether to pin the values at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02581}02581             \textcolor{comment}{// the new node based on the boundary conditions applied at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02582}02582             \textcolor{comment}{// its Mesh boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02583}02583 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02584}02584             \textcolor{comment}{// Get the boundary conditions from the father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02585}02585             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} bound\_cons(this-\/>ncont\_interpolated\_values());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02586}02586             clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_a7aaf952d8dfdcf6ed85f42bc0e7bbef2}{get\_bcs}}(my\_bound, bound\_cons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02587}02587 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02588}02588             \textcolor{comment}{// Loop over the values and pin, if necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02589}02589             \textcolor{keywordtype}{unsigned} n\_value = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02590}02590             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_value; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02591}02591             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02592}02592               \textcolor{keywordflow}{if} (bound\_cons[k])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02593}02593               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02594}02594                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a422231c58e423f0b43822827aa334d79}{pin}}(k);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02595}02595               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02596}02596             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02597}02597 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02598}02598             \textcolor{comment}{// Solid node? If so, deal with the positional boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02599}02599             \textcolor{comment}{// conditions:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02600}02600             \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02601}02601               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02602}02602             \textcolor{keywordflow}{if} (solid\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02603}02603             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02604}02604               \textcolor{comment}{// Get the positional boundary conditions from the father:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02605}02605               \textcolor{keywordtype}{unsigned} n\_dim = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a786c96a8e46eb27a03b2b31f629d41b3}{ndim}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02606}02606               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} solid\_bound\_cons(n\_dim);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02607}02607               \mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_012_01_4}{RefineableSolidQElement<2>}}* clone\_solid\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02608}02608                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_012_01_4}{RefineableSolidQElement<2>}}*\textcolor{keyword}{>}(clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02609}02609 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02610}02610               \textcolor{keywordflow}{if} (clone\_solid\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02611}02611               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02612}02612                 \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02613}02613                   \textcolor{stringliteral}{"{}We have a SolidNode outside a refineable SolidElement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02614}02614                 error\_message +=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02615}02615                   \textcolor{stringliteral}{"{}during mesh refinement -\/-\/ this doesn't make sense"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02616}02616 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02617}02617                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02618}02618                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02619}02619                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02620}02620               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02621}02621 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02622}02622               clone\_solid\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_012_01_4_a5a06e687e147c9416ad56c166e55d27b}{get\_solid\_bcs}}(my\_bound, solid\_bound\_cons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02623}02623 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02624}02624               \textcolor{comment}{// Loop over the positions and pin, if necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02625}02625               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dim; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02626}02626               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02627}02627                 \textcolor{keywordflow}{if} (solid\_bound\_cons[k])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02628}02628                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02629}02629                   solid\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_aa283a553b0141e859dd7b4f80bb88e6d}{pin\_position}}(k);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02630}02630                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02631}02631               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02632}02632             \} \textcolor{comment}{// End of if solid\_node\_pt}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02633}02633 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02634}02634 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02635}02635             \textcolor{comment}{// Check if we need to add nodes to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02636}02636             \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02637}02637             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02638}02638               \textcolor{comment}{// Next, we Update the boundary lookup schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02639}02639               \textcolor{comment}{// Loop over the boundaries stored in the set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02640}02640               \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries.begin();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02641}02641                    it != boundaries.end();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02642}02642                    ++it)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02643}02643               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02644}02644                 \textcolor{comment}{// Add the node to the boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02645}02645                 mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(*it, created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02646}02646 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02647}02647                 \textcolor{comment}{// If we have set an intrinsic coordinate on this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02648}02648                 \textcolor{comment}{// mesh boundary then it must also be interpolated on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02649}02649                 \textcolor{comment}{// the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02650}02650                 \textcolor{comment}{// Now interpolate the intrinsic boundary coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02651}02651                 \textcolor{keywordflow}{if} (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad1b124a959628aba00162b89617b3a62}{boundary\_coordinate\_exists}}(*it) == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02652}02652                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02653}02653                   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02654}02654                   clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_af7796513af01efa2ad009876e81abe3b}{interpolated\_zeta\_on\_edge}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02655}02655                     *it, my\_bound, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02656}02656 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02657}02657                   created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a94c19e165ab4e88aabbfa27443c530b7}{set\_coordinates\_on\_boundary}}(*it, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02658}02658                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02659}02659               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02660}02660             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02661}02661           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02662}02662           \textcolor{comment}{// Otherwise the node is not on a Mesh boundary and}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02663}02663           \textcolor{comment}{// we create a normal "{}bulk"{} node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02664}02664           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02665}02665           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02666}02666             \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02667}02667             created\_node\_pt = this-\/>construct\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02668}02668           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02669}02669 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02670}02670           \textcolor{comment}{// Now we set the position and values at the newly created node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02671}02671 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02672}02672           \textcolor{comment}{// In the first instance use macro element or FE representation}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02673}02673           \textcolor{comment}{// to create past and present nodal positions.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02674}02674           \textcolor{comment}{// (THIS STEP SHOULD NOT BE SKIPPED FOR ALGEBRAIC}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02675}02675           \textcolor{comment}{// ELEMENTS AS NOT ALL OF THEM NECESSARILY IMPLEMENT}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02676}02676           \textcolor{comment}{// NONTRIVIAL NODE UPDATE FUNCTIONS. CALLING}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02677}02677           \textcolor{comment}{// THE NODE UPDATE FOR SUCH ELEMENTS/NODES WILL LEAVE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02678}02678           \textcolor{comment}{// THEIR NODAL POSITIONS WHERE THEY WERE (THIS IS APPROPRIATE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02679}02679           \textcolor{comment}{// ONCE THEY HAVE BEEN GIVEN POSITIONS) BUT WILL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02680}02680           \textcolor{comment}{// NOT ASSIGN SENSIBLE INITIAL POSITONS!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02681}02681 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02682}02682           \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02683}02683           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02684}02684           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02685}02685             \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02686}02686             \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02687}02687             \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02688}02688             \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02689}02689             \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02690}02690             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02691}02691             clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02692}02692 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02693}02693             \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02694}02694             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02695}02695             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02696}02696               created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02697}02697             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02698}02698           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02699}02699 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02700}02700           \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02701}02701           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02702}02702           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02703}02703             \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02704}02704             \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02705}02705             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02706}02706             clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02707}02707             \textcolor{comment}{// Initialise the values at the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02708}02708             \textcolor{keywordtype}{unsigned} n\_value = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02709}02709             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_value; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02710}02710             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02711}02711               created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02712}02712             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02713}02713           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02714}02714 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02715}02715           \textcolor{comment}{// Add new node to mesh (if requested)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02716}02716           \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02717}02717           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02718}02718             mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02719}02719           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02720}02720 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02721}02721           \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02722}02722             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02723}02723 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02724}02724           \textcolor{comment}{// If we do have an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02725}02725           \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02726}02726           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02727}02727             \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message = \textcolor{stringliteral}{"{}Have not implemented p-\/refinement for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02728}02728             error\_message += \textcolor{stringliteral}{"{}Algebraic p-\/refineable elements yet\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02729}02729 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02730}02730             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02731}02731               error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02732}02732               \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::p\_refine()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02733}02733               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02734}02734           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02735}02735 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02736}02736         \} \textcolor{comment}{// End of case when we build the node ourselves}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02737}02737 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02738}02738         \textcolor{comment}{// Check if the element is an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02739}02739         \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02740}02740           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02741}02741 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02742}02742         \textcolor{comment}{// If the element is an algebraic element, setup}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02743}02743         \textcolor{comment}{// node position (past and present) from algebraic node update}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02744}02744         \textcolor{comment}{// function. This over-\/writes previous assingments that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02745}02745         \textcolor{comment}{// were made based on the macro-\/element/FE representation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02746}02746         \textcolor{comment}{// NOTE: YES, THIS NEEDS TO BE CALLED REPEATEDLY IF THE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02747}02747         \textcolor{comment}{// NODE IS MEMBER OF MULTIPLE ELEMENTS: THEY ALL ASSIGN}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02748}02748         \textcolor{comment}{// THE SAME NODAL POSITIONS BUT WE NEED TO ADD THE REMESH}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02749}02749         \textcolor{comment}{// INFO FOR *ALL* ROOT ELEMENTS!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02750}02750         \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02751}02751         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02752}02752           \textcolor{comment}{// Build algebraic node update info for new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02753}02753           \textcolor{comment}{// This sets up the node update data for all node update}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02754}02754           \textcolor{comment}{// functions that are shared by all nodes in the father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02755}02755           \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02756}02756           alg\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase_ab9ada27015d5cb28ae00b086ace3600f}{setup\_algebraic\_node\_update}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02757}02757             this-\/>node\_pt(jnod), \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02758}02758         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02759}02759 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02760}02760       \} \textcolor{comment}{// End of vertical loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02761}02761 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02762}02762     \} \textcolor{comment}{// End of horizontal loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02763}02763 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02764}02764 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02765}02765     \textcolor{comment}{// If the element is a MacroElementNodeUpdateElement, set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02766}02766     \textcolor{comment}{// the update parameters for the current element's nodes -\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02767}02767     \textcolor{comment}{// all this needs is the vector of (pointers to the)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02768}02768     \textcolor{comment}{// geometric objects that affect the MacroElement-\/based}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02769}02769     \textcolor{comment}{// node update -\/-\/ this needs to be done to set the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02770}02770     \textcolor{comment}{// update info for newly created nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02771}02771     \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* clone\_m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02772}02772       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02773}02773     \textcolor{keywordflow}{if} (clone\_m\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02774}02774     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02775}02775       \textcolor{comment}{// Get vector of geometric objects from father (construct vector}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02776}02776       \textcolor{comment}{// via copy operation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02777}02777       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_pt(clone\_m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02778}02778 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02779}02779       \textcolor{comment}{// Cast current element to MacroElementNodeUpdateElement:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02780}02780       \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02781}02781         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02782}02782 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02783}02783 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02784}02784       \textcolor{keywordflow}{if} (m\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02785}02785       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02786}02786         \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02787}02787           \textcolor{stringliteral}{"{}Failed to cast to MacroElementNodeUpdateElementBase*\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02788}02788         error\_message +=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02789}02789           \textcolor{stringliteral}{"{}Strange -\/-\/ if my clone is a MacroElementNodeUpdateElement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02790}02790         error\_message += \textcolor{stringliteral}{"{}then I should be too....\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02791}02791 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02792}02792         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02793}02793           error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02794}02794       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02795}02795 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02796}02796       \textcolor{comment}{// Build update info by passing vector of geometric objects:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02797}02797       \textcolor{comment}{// This sets the current element to be the update element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02798}02798       \textcolor{comment}{// for all of the element's nodes -\/-\/ this is reversed}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02799}02799       \textcolor{comment}{// if the element is ever un-\/refined in the father element's}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02800}02800       \textcolor{comment}{// rebuild\_from\_sons() function which overwrites this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02801}02801       \textcolor{comment}{// assignment to avoid nasty segmentation faults that occur}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02802}02802       \textcolor{comment}{// when a node tries to update itself via an element that no}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02803}02803       \textcolor{comment}{// longer exists...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02804}02804       m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_aa2408d8463e8cecc2ad12a93e10390b1}{set\_node\_update\_info}}(geom\_object\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02805}02805 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02806}02806 \textcolor{comment}{      /// / Now loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02807}02807 \textcolor{comment}{}      \textcolor{comment}{// unsigned n\_node = this-\/>nnode();}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02808}02808       \textcolor{comment}{// for (unsigned j=0;j<n\_node;j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02809}02809       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02810}02810       \textcolor{comment}{//  // Get local coordinate in element (Vector sets its own size)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02811}02811       \textcolor{comment}{//  Vector<double> s\_in\_node\_update\_element;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02812}02812       \textcolor{comment}{//  this-\/>local\_coordinate\_of\_node(j,s\_in\_node\_update\_element);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02813}02813       \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02814}02814       \textcolor{comment}{//  // Pass the lot to the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02815}02815       \textcolor{comment}{//  static\_cast<MacroElementNodeUpdateNode*>(this-\/>node\_pt(j))-\/>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02816}02816       \textcolor{comment}{//   set\_node\_update\_info(this,s\_in\_node\_update\_element,m\_el\_pt-\/>geom\_object\_pt());}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02817}02817       \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02818}02818 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02819}02819 \textcolor{comment}{      /// /BENFLAG:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02820}02820 \textcolor{comment}{}      \textcolor{comment}{// std::cout << "{}Checking that all the nodes have this as their update}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02821}02821       \textcolor{comment}{// element..."{} << std::endl;}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02822}02822 \textcolor{comment}{      /// /std::cout << "{}this = "{} << this << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02823}02823 \textcolor{comment}{}      \textcolor{comment}{// for(unsigned j=0; j<this-\/>nnode(); j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02824}02824       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02825}02825       \textcolor{comment}{//  //std::cout << this-\/>node\_pt(j) << "{}:   ["{} << this-\/>node\_pt(j)-\/>x(0)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02826}02826       \textcolor{comment}{//  << "{},"{} << this-\/>node\_pt(j)-\/>x(1) << "{}]   update element: "{} <<}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02827}02827       \textcolor{comment}{//  dynamic\_cast<MacroElementNodeUpdateNode*>(this-\/>node\_pt(j))-\/>node\_update\_element\_pt()}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02828}02828       \textcolor{comment}{//  << std::endl; MacroElementNodeUpdateNode* mac\_nod\_pt =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02829}02829       \textcolor{comment}{//  dynamic\_cast<MacroElementNodeUpdateNode*>(this-\/>node\_pt(j));}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02830}02830       \textcolor{comment}{//  if(mac\_nod\_pt-\/>node\_update\_element\_pt()!=this)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02831}02831       \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02832}02832       \textcolor{comment}{//    std::cout << "{}Something's not right! Update element is wrong..."{} <<}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02833}02833       \textcolor{comment}{//    std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02834}02834       \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02835}02835       \textcolor{comment}{//  FiniteElement* up\_el\_pt =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02836}02836       \textcolor{comment}{//  dynamic\_cast<FiniteElement*>(mac\_nod\_pt-\/>node\_update\_element\_pt());}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02837}02837       \textcolor{comment}{//  bool not\_good = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02838}02838       \textcolor{comment}{//  for(unsigned l=0; l<up\_el\_pt-\/>nnode(); l++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02839}02839       \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02840}02840       \textcolor{comment}{//    if(up\_el\_pt-\/>node\_pt(l)==mac\_nod\_pt)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02841}02841       \textcolor{comment}{//     \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02842}02842       \textcolor{comment}{//      not\_good = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02843}02843       \textcolor{comment}{//      break;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02844}02844       \textcolor{comment}{//     \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02845}02845       \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02846}02846       \textcolor{comment}{//  if(not\_good==true)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02847}02847       \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02848}02848       \textcolor{comment}{//    std::cout << "{}Macro node doesn't belong to its update element!"{} <<}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02849}02849       \textcolor{comment}{//    std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02850}02850       \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02851}02851       \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02852}02852 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02853}02853 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02854}02854       \textcolor{comment}{// Loop over all nodes in element again, to re-\/set the positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02855}02855       \textcolor{comment}{// This must be done using the new element's macro-\/element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02856}02856       \textcolor{comment}{// representation, rather than the old version which may be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02857}02857       \textcolor{comment}{// of a different p-\/order!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02858}02858       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < P\_order; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02859}02859       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02860}02860         \textcolor{comment}{// Get the fractional position of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02861}02861         s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02862}02862         \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02863}02863         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_lo[0] + (s\_hi[0] -\/ s\_lo[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02864}02864 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02865}02865         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < P\_order; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02866}02866         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02867}02867           \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02868}02868           s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02869}02869           \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02870}02870           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = s\_lo[1] + (s\_hi[1] -\/ s\_lo[1]) * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02871}02871 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02872}02872           \textcolor{comment}{// Local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02873}02873           jnod = i0 + P\_order * i1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02874}02874 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02875}02875           \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02876}02876           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02877}02877           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02878}02878             \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02879}02879             \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02880}02880             \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02881}02881             \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02882}02882             \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02883}02883             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02884}02884             this-\/>get\_x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02885}02885 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02886}02886             \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02887}02887             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02888}02888             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02889}02889               this-\/>node\_pt(jnod)-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02890}02890             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02891}02891           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02892}02892         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02893}02893       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02894}02894     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02895}02895 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02896}02896     \textcolor{comment}{// Not necessary to delete the old nodes since all original nodes are in the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02897}02897     \textcolor{comment}{// current mesh and so will be pruned as part of the mesh adaption process.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02898}02898 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02899}02899     \textcolor{comment}{// Do any further-\/build required}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02900}02900     this-\/>further\_build();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02901}02901   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02902}02902 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02903}02903   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02904}02904 \textcolor{comment}{  /// Shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02905}02905 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02906}02906   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02907}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a2ec50a2b731e5e8b969f116606cab6ca}{02907}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1OneDimLagrange_a117f8b892dc89989ecdad99ff261e120}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::shape}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02908}02908                                                        \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02909}02909 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02910}02910     \textcolor{keywordflow}{switch} (p\_order())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02911}02911     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02912}02912       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02913}02913       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02914}02914         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02915}02915         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02916}02916         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<2>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02917}02917 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02918}02918         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02919}02919         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02920}02920         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02921}02921         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02922}02922           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02923}02923           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02924}02924             psi(2 * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02925}02925           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02926}02926         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02927}02927         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02928}02928       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02929}02929       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02930}02930       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02931}02931         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02932}02932         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02933}02933         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<3>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02934}02934 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02935}02935         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02936}02936         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02937}02937         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02938}02938         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02939}02939           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02940}02940           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02941}02941             psi(3 * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02942}02942           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02943}02943         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02944}02944         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02945}02945       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02946}02946       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02947}02947       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02948}02948         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02949}02949         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02950}02950         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<4>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02951}02951 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02952}02952         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02953}02953         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02954}02954         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 4; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02955}02955         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02956}02956           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 4; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02957}02957           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02958}02958             psi(4 * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02959}02959           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02960}02960         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02961}02961         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02962}02962       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02963}02963       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02964}02964       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02965}02965         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02966}02966         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02967}02967         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<5>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02968}02968 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02969}02969         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02970}02970         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02971}02971         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 5; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02972}02972         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02973}02973           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 5; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02974}02974           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02975}02975             psi(5 * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02976}02976           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02977}02977         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02978}02978         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02979}02979       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02980}02980       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02981}02981       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02982}02982         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02983}02983         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02984}02984         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<6>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02985}02985 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02986}02986         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02987}02987         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02988}02988         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 6; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02989}02989         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02990}02990           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 6; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02991}02991           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02992}02992             psi(6 * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02993}02993           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02994}02994         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02995}02995         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02996}02996       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02997}02997       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02998}02998       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l02999}02999         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03000}03000         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03001}03001         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<7>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03002}03002 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03003}03003         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03004}03004         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03005}03005         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 7; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03006}03006         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03007}03007           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 7; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03008}03008           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03009}03009             psi(7 * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + j) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03010}03010           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03011}03011         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03012}03012         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03013}03013       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03014}03014       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03015}03015         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03016}03016         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03017}03017         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       polynomial order for shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03018}03018         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03019}03019                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03020}03020                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03021}03021     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03022}03022   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03023}03023 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03024}03024   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03025}03025 \textcolor{comment}{  /// Derivatives of shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03026}03026 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03027}03027   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03028}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a068e2fc2edfe459b07c373d8d1546c51}{03028}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::dshape\_local}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03029}03029     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsids)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03030}03030 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03031}03031     \textcolor{keywordflow}{switch} (p\_order())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03032}03032     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03033}03033       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03034}03034       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03035}03035         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03036}03036         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03037}03037         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<2>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03038}03038         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<2>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03039}03039 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03040}03040         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03041}03041         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03042}03042         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03043}03043         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03044}03044         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03045}03045           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 2; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03046}03046           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03047}03047             \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03048}03048             dpsids(index, 0) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi1ds[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03049}03049             dpsids(index, 1) = dpsi2ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03050}03050             psi[index] = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03051}03051             \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03052}03052             ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03053}03053           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03054}03054         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03055}03055         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03056}03056       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03057}03057       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03058}03058       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03059}03059         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03060}03060         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03061}03061         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<3>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03062}03062         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<3>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03063}03063 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03064}03064         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03065}03065         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03066}03066         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03067}03067         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03068}03068         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03069}03069           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 3; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03070}03070           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03071}03071             \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03072}03072             dpsids(index, 0) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi1ds[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03073}03073             dpsids(index, 1) = dpsi2ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03074}03074             psi[index] = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03075}03075             \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03076}03076             ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03077}03077           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03078}03078         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03079}03079         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03080}03080       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03081}03081       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03082}03082       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03083}03083         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03084}03084         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03085}03085         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<4>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03086}03086         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<4>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03087}03087 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03088}03088         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03089}03089         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03090}03090         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03091}03091         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 4; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03092}03092         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03093}03093           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 4; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03094}03094           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03095}03095             \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03096}03096             dpsids(index, 0) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi1ds[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03097}03097             dpsids(index, 1) = dpsi2ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03098}03098             psi[index] = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03099}03099             \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03100}03100             ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03101}03101           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03102}03102         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03103}03103         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03104}03104       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03105}03105       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03106}03106       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03107}03107         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03108}03108         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03109}03109         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<5>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03110}03110         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<5>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03111}03111 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03112}03112         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03113}03113         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03114}03114         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03115}03115         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 5; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03116}03116         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03117}03117           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 5; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03118}03118           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03119}03119             \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03120}03120             dpsids(index, 0) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi1ds[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03121}03121             dpsids(index, 1) = dpsi2ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03122}03122             psi[index] = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03123}03123             \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03124}03124             ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03125}03125           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03126}03126         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03127}03127         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03128}03128       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03129}03129       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03130}03130       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03131}03131         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03132}03132         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03133}03133         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<6>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03134}03134         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<6>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03135}03135 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03136}03136         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03137}03137         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03138}03138         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03139}03139         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 6; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03140}03140         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03141}03141           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 6; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03142}03142           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03143}03143             \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03144}03144             dpsids(index, 0) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi1ds[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03145}03145             dpsids(index, 1) = dpsi2ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03146}03146             psi[index] = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03147}03147             \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03148}03148             ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03149}03149           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03150}03150         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03151}03151         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03152}03152       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03153}03153       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03154}03154       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03155}03155         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03156}03156         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03157}03157         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<7>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03158}03158         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<7>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03159}03159 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03160}03160         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03161}03161         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03162}03162         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03163}03163         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 7; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03164}03164         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03165}03165           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 7; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03166}03166           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03167}03167             \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03168}03168             dpsids(index, 0) = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi1ds[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03169}03169             dpsids(index, 1) = dpsi2ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03170}03170             psi[index] = psi2[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi1[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03171}03171             \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03172}03172             ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03173}03173           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03174}03174         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03175}03175         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03176}03176       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03177}03177       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03178}03178         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03179}03179         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03180}03180         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       polynomial order for shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03181}03181         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03182}03182                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03183}03183                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03184}03184     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03185}03185   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03186}03186 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03187}03187   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03188}03188 \textcolor{comment}{  /// Second derivatives of shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03189}03189 \textcolor{comment}{  ///  d2psids(i,0) = \(\backslash\)f\$ d\string^2 \(\backslash\)psi\_j / d s\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03190}03190 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03191}03191   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03192}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a4960e6e81844b8387096c3f1679055ef}{03192}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::d2shape\_local}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03193}03193     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsids, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& d2psids)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03194}03194 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03195}03195     std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03196}03196     error\_message}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03197}03197       << \textcolor{stringliteral}{"{}\(\backslash\)nd2shape\_local currently not implemented for this element\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03198}03198     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03199}03199       error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03200}03200   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03201}03201 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03202}03202   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03203}03203 \textcolor{comment}{  /// Rebuild the element from nodes found in its sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03204}03204 \textcolor{comment}{  /// Adjusts its p-\/order to be the maximum of its sons' p-\/orders}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03205}03205 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03206}03206   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03207}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a53d48e7e3310a02a315562ed628bd4b5}{03207}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::rebuild\_from\_sons}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03208}03208     \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03209}03209   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03210}03210     \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03211}03211 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03212}03212     \textcolor{comment}{// Get p-\/orders of sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03213}03213     \textcolor{keywordtype}{unsigned} n\_sons = this-\/>tree\_pt()-\/>nsons();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03214}03214     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} son\_p\_order(n\_sons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03215}03215     \textcolor{keywordtype}{unsigned} max\_son\_p\_order = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03216}03216     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ison = 0; ison < n\_sons; ison++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03217}03217     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03218}03218       \mbox{\hyperlink{classoomph_1_1PRefineableElement}{PRefineableElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableElement}{PRefineableElement}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03219}03219         this-\/>tree\_pt()-\/>son\_pt(ison)-\/>object\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03220}03220       son\_p\_order[ison] = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03221}03221       \textcolor{keywordflow}{if} (son\_p\_order[ison] > max\_son\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03222}03222         max\_son\_p\_order = son\_p\_order[ison];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03223}03223     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03224}03224 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03225}03225     \textcolor{keywordtype}{unsigned} old\_Nnode = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03226}03226     \textcolor{keywordtype}{unsigned} old\_P\_order = this-\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03227}03227     \textcolor{comment}{// Set p-\/order of the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03228}03228     this-\/>p\_order() = max\_son\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03229}03229 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03230}03230     \textcolor{comment}{// Change integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03231}03231     \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03232}03232     \textcolor{keywordflow}{switch} (this-\/>p\_order())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03233}03233     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03234}03234       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03235}03235         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03236}03236         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03237}03237       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03238}03238         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03239}03239         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03240}03240       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03241}03241         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03242}03242         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03243}03243       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03244}03244         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03245}03245         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03246}03246       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03247}03247         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03248}03248         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03249}03249       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03250}03250         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<2, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03251}03251         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03252}03252       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03253}03253         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03254}03254         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03255}03255         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03256}03256         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03257}03257                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03258}03258                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03259}03259     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03260}03260 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03261}03261     \textcolor{comment}{// Back up pointers to old nodes before they are lost}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03262}03262     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} old\_node\_pt(old\_Nnode);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03263}03263     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < old\_Nnode; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03264}03264     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03265}03265       old\_node\_pt[n] = this-\/>node\_pt(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03266}03266     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03267}03267 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03268}03268     \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03269}03269     this-\/>set\_n\_node(this-\/>p\_order() * this-\/>p\_order());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03270}03270 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03271}03271     \textcolor{comment}{// Copy vertex nodes which were populated in the pre-\/build}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03272}03272     this-\/>node\_pt(0) = old\_node\_pt[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03273}03273     this-\/>node\_pt(this-\/>p\_order() -\/ 1) = old\_node\_pt[old\_P\_order -\/ 1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03274}03274     this-\/>node\_pt(this-\/>p\_order() * (this-\/>p\_order() -\/ 1)) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03275}03275       old\_node\_pt[(old\_P\_order) * (old\_P\_order -\/ 1)];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03276}03276     this-\/>node\_pt(this-\/>p\_order() * this-\/>p\_order() -\/ 1) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03277}03277       old\_node\_pt[(old\_P\_order) * (old\_P\_order)-\/1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03278}03278 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03279}03279     \textcolor{comment}{// Copy midpoint nodes from sons if new p-\/order is odd}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03280}03280     \textcolor{keywordflow}{if} (this-\/>p\_order() \% 2 == 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03281}03281     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03282}03282       \textcolor{comment}{// Work out which is midpoint node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03283}03283       \textcolor{keywordtype}{unsigned} midpoint = (this-\/>p\_order() -\/ 1) / 2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03284}03284 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03285}03285       \textcolor{comment}{// Bottom edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03286}03286       this-\/>node\_pt(midpoint) = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4}{RefineableQElement<2>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03287}03287                                   quadtree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dab02ffb52d34a25323447061474613d81}{SW}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03288}03288                                   -\/>vertex\_node\_pt(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03289}03289       \textcolor{comment}{// Left edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03290}03290       this-\/>node\_pt(midpoint * this-\/>p\_order()) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03291}03291         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4}{RefineableQElement<2>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03292}03292           quadtree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dab02ffb52d34a25323447061474613d81}{SW}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03293}03293           -\/>vertex\_node\_pt(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03294}03294       \textcolor{comment}{// Top edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03295}03295       this-\/>node\_pt((this-\/>p\_order() -\/ 1) * this-\/>p\_order() + midpoint) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03296}03296         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4}{RefineableQElement<2>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03297}03297           quadtree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa66bca2eb077ff943b39305b1965826f}{NE}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03298}03298           -\/>vertex\_node\_pt(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03299}03299       \textcolor{comment}{// Right edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03300}03300       this-\/>node\_pt((midpoint + 1) * this-\/>p\_order() -\/ 1) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03301}03301         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4}{RefineableQElement<2>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03302}03302           quadtree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa66bca2eb077ff943b39305b1965826f}{NE}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03303}03303           -\/>vertex\_node\_pt(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03304}03304     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03305}03305 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03306}03306 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03307}03307     \textcolor{comment}{// The timestepper should be the same for all nodes and node 0 should}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03308}03308     \textcolor{comment}{// never be deleted.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03309}03309     \textcolor{keywordflow}{if} (this-\/>node\_pt(0) == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03310}03310     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03311}03311       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}The Corner node (0) does not exist"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03312}03312                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03313}03313                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03314}03314     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03315}03315 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03316}03316     \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = this-\/>node\_pt(0)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03317}03317     \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03318}03318 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03319}03319     \textcolor{keywordtype}{unsigned} jnod = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03320}03320     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(2), \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03321}03321     \textcolor{comment}{// Loop over the nodes in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03322}03322     \textcolor{keywordtype}{unsigned} n\_p = this-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03323}03323     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03324}03324     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03325}03325       \textcolor{comment}{// Get the fractional position of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03326}03326       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03327}03327       \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03328}03328       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0 + 2.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03329}03329 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03330}03330       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < n\_p; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03331}03331       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03332}03332         \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03333}03333         s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03334}03334         \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03335}03335         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = -\/1.0 + 2.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03336}03336 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03337}03337         \textcolor{comment}{// Set the local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03338}03338         jnod = i0 + n\_p * i1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03339}03339 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03340}03340         \textcolor{comment}{// Initialise flag: So far, this node hasn't been built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03341}03341         \textcolor{comment}{// or copied yet}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03342}03342         \textcolor{keywordtype}{bool} node\_done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03343}03343 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03344}03344         \textcolor{comment}{// Get the pointer to the node in this element, returns NULL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03345}03345         \textcolor{comment}{// if there is not node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03346}03346         \mbox{\hyperlink{classoomph_1_1Node}{Node}}* created\_node\_pt = this-\/>get\_node\_at\_local\_coordinate(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03347}03347 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03348}03348         \textcolor{comment}{// Does this node already exist in this element?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03349}03349         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03350}03350         \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03351}03351         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03352}03352           \textcolor{comment}{// Copy node across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03353}03353           this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03354}03354 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03355}03355           \textcolor{comment}{// Node has been created by copy}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03356}03356           node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03357}03357         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03358}03358         \textcolor{comment}{// Node does not exist in this element but might already}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03359}03359         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03360}03360         \textcolor{comment}{// have been created by neighbouring elements}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03361}03361         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03362}03362         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03363}03363         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03364}03364           \textcolor{comment}{// Was the node created by one of its neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03365}03365           \textcolor{comment}{// Whether or not the node lies on an edge can be calculated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03366}03366           \textcolor{comment}{// by from the fractional position}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03367}03367           \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03368}03368           created\_node\_pt = node\_created\_by\_neighbour(s\_fraction, is\_periodic);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03369}03369 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03370}03370           \textcolor{comment}{// If the node was so created, assign the pointers}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03371}03371           \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03372}03372           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03373}03373             \textcolor{comment}{// If the node is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03374}03374             \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03375}03375             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03376}03376               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Cannot handle periodic nodes yet"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03377}03377                                   OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03378}03378                                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03379}03379             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03380}03380             \textcolor{comment}{// Non-\/periodic case, just set the pointer}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03381}03381             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03382}03382             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03383}03383               this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03384}03384             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03385}03385             \textcolor{comment}{// Node has been created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03386}03386             node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03387}03387           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03388}03388         \} \textcolor{comment}{// Node does not exist in this element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03389}03389 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03390}03390         \textcolor{comment}{// Node has not been built anywhere -\/-\/-\/> build it here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03391}03391         \textcolor{keywordflow}{if} (!node\_done)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03392}03392         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03393}03393           \textcolor{comment}{// First, find the son element in which the node should live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03394}03394 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03395}03395           \textcolor{comment}{// Find coordinates in the sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03396}03396           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_son(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03397}03397           \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03398}03398           \textcolor{keywordtype}{int} son = -\/10;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03399}03399           \textcolor{comment}{// If negative on the west side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03400}03400           \textcolor{keywordflow}{if} (s\_fraction[0] < 0.5)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03401}03401           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03402}03402             \textcolor{comment}{// On the south side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03403}03403             \textcolor{keywordflow}{if} (s\_fraction[1] < 0.5)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03404}03404             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03405}03405               \textcolor{comment}{// It's the southwest son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03406}03406               son = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dab02ffb52d34a25323447061474613d81}{SW}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03407}03407               s\_in\_son[0] = -\/1.0 + 4.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03408}03408               s\_in\_son[1] = -\/1.0 + 4.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03409}03409             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03410}03410             \textcolor{comment}{// On the north side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03411}03411             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03412}03412             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03413}03413               \textcolor{comment}{// It's the northwest son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03414}03414               son = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa01c8378aad2e474250e6ebefb9fa942}{NW}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03415}03415               s\_in\_son[0] = -\/1.0 + 4.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03416}03416               s\_in\_son[1] = -\/1.0 + 4.0 * (s\_fraction[1] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03417}03417             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03418}03418           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03419}03419           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03420}03420           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03421}03421             \textcolor{comment}{// On the south side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03422}03422             \textcolor{keywordflow}{if} (s\_fraction[1] < 0.5)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03423}03423             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03424}03424               \textcolor{comment}{// It's the southeast son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03425}03425               son = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da03479dd620c853ccd3c767125d6f29a4}{SE}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03426}03426               s\_in\_son[0] = -\/1.0 + 4.0 * (s\_fraction[0] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03427}03427               s\_in\_son[1] = -\/1.0 + 4.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03428}03428             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03429}03429             \textcolor{comment}{// On the north side}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03430}03430             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03431}03431             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03432}03432               \textcolor{comment}{// It's the northeast son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03433}03433               son = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa66bca2eb077ff943b39305b1965826f}{NE}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03434}03434               s\_in\_son[0] = -\/1.0 + 4.0 * (s\_fraction[0] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03435}03435               s\_in\_son[1] = -\/1.0 + 4.0 * (s\_fraction[1] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03436}03436             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03437}03437           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03438}03438 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03439}03439           \textcolor{comment}{// Get the pointer to the son element in which the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03440}03440           \textcolor{comment}{// would live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03441}03441           \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}* son\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03442}03442             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03443}03443               this-\/>tree\_pt()-\/>son\_pt(son)-\/>object\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03444}03444 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03445}03445           \textcolor{comment}{// If we are rebuilding, then worry about the boundary conditions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03446}03446           \textcolor{comment}{// Find the boundary of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03447}03447           \textcolor{comment}{// Initially none}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03448}03448           \textcolor{keywordtype}{int} boundary = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03449}03449           \textcolor{comment}{// If we are on the western boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03450}03450           \textcolor{keywordflow}{if} (i0 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03451}03451           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03452}03452             boundary = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03453}03453           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03454}03454           \textcolor{comment}{// If we are on the eastern boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03455}03455           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i0 == n\_p -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03456}03456           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03457}03457             boundary = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03458}03458           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03459}03459 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03460}03460           \textcolor{comment}{// If we are on the southern boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03461}03461           \textcolor{keywordflow}{if} (i1 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03462}03462           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03463}03463             \textcolor{comment}{// If we already have already set the boundary, we're on a corner}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03464}03464             \textcolor{keywordflow}{switch} (boundary)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03465}03465             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03466}03466               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03467}03467                 boundary = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dab02ffb52d34a25323447061474613d81}{SW}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03468}03468                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03469}03469               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03470}03470                 boundary = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da03479dd620c853ccd3c767125d6f29a4}{SE}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03471}03471                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03472}03472               \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03473}03473               \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03474}03474                 boundary = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{S}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03475}03475                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03476}03476             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03477}03477           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03478}03478           \textcolor{comment}{// If we are the northern bounadry}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03479}03479           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i1 == n\_p -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03480}03480           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03481}03481             \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03482}03482             \textcolor{keywordflow}{switch} (boundary)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03483}03483             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03484}03484               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03485}03485                 boundary = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa01c8378aad2e474250e6ebefb9fa942}{NW}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03486}03486                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03487}03487               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03488}03488                 boundary = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daa66bca2eb077ff943b39305b1965826f}{NE}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03489}03489                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03490}03490               \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03491}03491                 boundary = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03492}03492                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03493}03493             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03494}03494           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03495}03495 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03496}03496           \textcolor{comment}{// set of boundaries that this edge in the son lives on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03497}03497           std::set<unsigned> boundaries;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03498}03498 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03499}03499           \textcolor{comment}{// Now get the boundary conditions from the son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03500}03500           \textcolor{comment}{// The boundaries will be common to the son because there can be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03501}03501           \textcolor{comment}{// no rotations here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03502}03502           \textcolor{keywordflow}{if} (boundary != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03503}03503           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03504}03504             son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_a739ecb3d2eff4c9d08efa79a39d387b0}{get\_boundaries}}(boundary, boundaries);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03505}03505           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03506}03506 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03507}03507           \textcolor{comment}{// If the node lives on a boundary:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03508}03508           \textcolor{comment}{// Construct a boundary node,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03509}03509           \textcolor{comment}{// Get boundary conditions and}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03510}03510           \textcolor{comment}{// update all lookup schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03511}03511           \textcolor{keywordflow}{if} (boundaries.size() > 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03512}03512           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03513}03513             \textcolor{comment}{// Construct the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03514}03514             created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03515}03515               this-\/>construct\_boundary\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03516}03516 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03517}03517             \textcolor{comment}{// Get the boundary conditions from the son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03518}03518             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} bound\_cons(this-\/>ncont\_interpolated\_values());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03519}03519             son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_a7aaf952d8dfdcf6ed85f42bc0e7bbef2}{get\_bcs}}(boundary, bound\_cons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03520}03520 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03521}03521             \textcolor{comment}{// Loop over the values and pin if necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03522}03522             \textcolor{keywordtype}{unsigned} nval = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03523}03523             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < nval; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03524}03524             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03525}03525               \textcolor{keywordflow}{if} (bound\_cons[k])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03526}03526               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03527}03527                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a422231c58e423f0b43822827aa334d79}{pin}}(k);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03528}03528               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03529}03529             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03530}03530 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03531}03531             \textcolor{comment}{// Solid node? If so, deal with the positional boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03532}03532             \textcolor{comment}{// conditions:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03533}03533             \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03534}03534               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03535}03535             \textcolor{keywordflow}{if} (solid\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03536}03536             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03537}03537               \textcolor{comment}{// Get the positional boundary conditions from the father:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03538}03538               \textcolor{keywordtype}{unsigned} n\_dim = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a786c96a8e46eb27a03b2b31f629d41b3}{ndim}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03539}03539               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} solid\_bound\_cons(n\_dim);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03540}03540               \mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_012_01_4}{RefineableSolidQElement<2>}}* son\_solid\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03541}03541                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_012_01_4}{RefineableSolidQElement<2>}}*\textcolor{keyword}{>}(son\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03542}03542 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03543}03543               \textcolor{keywordflow}{if} (son\_solid\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03544}03544               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03545}03545                 \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03546}03546                   \textcolor{stringliteral}{"{}We have a SolidNode outside a refineable SolidElement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03547}03547                 error\_message +=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03548}03548                   \textcolor{stringliteral}{"{}during mesh refinement -\/-\/ this doesn't make sense\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03549}03549 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03550}03550                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03551}03551                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03552}03552                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03553}03553               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03554}03554 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03555}03555               son\_solid\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_012_01_4_a5a06e687e147c9416ad56c166e55d27b}{get\_solid\_bcs}}(boundary, solid\_bound\_cons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03556}03556 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03557}03557               \textcolor{comment}{// Loop over the positions and pin, if necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03558}03558               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dim; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03559}03559               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03560}03560                 \textcolor{keywordflow}{if} (solid\_bound\_cons[k])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03561}03561                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03562}03562                   solid\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_aa283a553b0141e859dd7b4f80bb88e6d}{pin\_position}}(k);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03563}03563                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03564}03564               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03565}03565             \} \textcolor{comment}{// End of if solid\_node\_pt}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03566}03566 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03567}03567 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03568}03568             \textcolor{comment}{// Next we update the boundary look-\/up schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03569}03569             \textcolor{comment}{// Loop over the boundaries stored in the set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03570}03570             \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries.begin();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03571}03571                  it != boundaries.end();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03572}03572                  ++it)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03573}03573             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03574}03574               \textcolor{comment}{// Add the node to the boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03575}03575               mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(*it, created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03576}03576 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03577}03577               \textcolor{comment}{// If we have set an intrinsic coordinate on this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03578}03578               \textcolor{comment}{// mesh boundary then it must also be interpolated on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03579}03579               \textcolor{comment}{// the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03580}03580               \textcolor{comment}{// Now interpolate the intrinsic boundary coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03581}03581               \textcolor{keywordflow}{if} (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad1b124a959628aba00162b89617b3a62}{boundary\_coordinate\_exists}}(*it) == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03582}03582               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03583}03583                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03584}03584                 son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_012_01_4_af7796513af01efa2ad009876e81abe3b}{interpolated\_zeta\_on\_edge}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03585}03585                   *it, boundary, s\_in\_son, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03586}03586 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03587}03587                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a94c19e165ab4e88aabbfa27443c530b7}{set\_coordinates\_on\_boundary}}(*it, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03588}03588               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03589}03589             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03590}03590           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03591}03591           \textcolor{comment}{// Otherwise the node is not on a Mesh boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03592}03592           \textcolor{comment}{// and we create a normal "{}bulk"{} node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03593}03593           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03594}03594           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03595}03595             \textcolor{comment}{// Construct the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03596}03596             created\_node\_pt = this-\/>construct\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03597}03597           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03598}03598 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03599}03599           \textcolor{comment}{// Now we set the position and values at the newly created node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03600}03600 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03601}03601           \textcolor{comment}{// In the first instance use macro element or FE representation}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03602}03602           \textcolor{comment}{// to create past and present nodal positions.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03603}03603           \textcolor{comment}{// (THIS STEP SHOULD NOT BE SKIPPED FOR ALGEBRAIC}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03604}03604           \textcolor{comment}{// ELEMENTS AS NOT ALL OF THEM NECESSARILY IMPLEMENT}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03605}03605           \textcolor{comment}{// NONTRIVIAL NODE UPDATE FUNCTIONS. CALLING}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03606}03606           \textcolor{comment}{// THE NODE UPDATE FOR SUCH ELEMENTS/NODES WILL LEAVE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03607}03607           \textcolor{comment}{// THEIR NODAL POSITIONS WHERE THEY WERE (THIS IS APPROPRIATE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03608}03608           \textcolor{comment}{// ONCE THEY HAVE BEEN GIVEN POSITIONS) BUT WILL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03609}03609           \textcolor{comment}{// NOT ASSIGN SENSIBLE INITIAL POSITONS!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03610}03610 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03611}03611           \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03612}03612           \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03613}03613           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03614}03614           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03615}03615             \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03616}03616             \textcolor{comment}{// Get the position from the son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03617}03617             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03618}03618 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03619}03619             \textcolor{comment}{// Now let's fill in the value}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03620}03620             son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_son, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03621}03621             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03622}03622             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03623}03623               created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03624}03624             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03625}03625           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03626}03626 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03627}03627           \textcolor{comment}{// Now set up the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03628}03628           \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03629}03629           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03630}03630           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03631}03631             \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03632}03632             \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03633}03633             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03634}03634             son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_son, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03635}03635 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03636}03636             \textcolor{comment}{// Initialise the values at the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03637}03637             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}(); k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03638}03638             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03639}03639               created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03640}03640             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03641}03641           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03642}03642 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03643}03643           \textcolor{comment}{// Add the node to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03644}03644           mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03645}03645 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03646}03646           \textcolor{comment}{// Check if the element is an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03647}03647           \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03648}03648             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03649}03649 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03650}03650           \textcolor{comment}{// If we do have an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03651}03651           \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03652}03652           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03653}03653             \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03654}03654               \textcolor{stringliteral}{"{}Have not implemented rebuilding from sons for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03655}03655             error\_message += \textcolor{stringliteral}{"{}Algebraic p-\/refineable elements yet\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03656}03656 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03657}03657             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03658}03658               error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03659}03659               \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::rebuild\_from\_sons()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03660}03660               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03661}03661           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03662}03662 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03663}03663         \} \textcolor{comment}{// End of the case when we build the node ourselves}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03664}03664       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03665}03665     \} \textcolor{comment}{// End of loop over all nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03666}03666 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03667}03667 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03668}03668     \textcolor{comment}{// If the element is a MacroElementNodeUpdateElement, set the update}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03669}03669     \textcolor{comment}{// parameters for the current element's nodes. These need to be reset}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03670}03670     \textcolor{comment}{// (as in MacroElementNodeUpdateElement<ELEMENT>::rebuild\_from\_sons())}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03671}03671     \textcolor{comment}{// because the nodes in this element have changed}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03672}03672     \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03673}03673       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03674}03674     \textcolor{keywordflow}{if} (m\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03675}03675     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03676}03676       \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03677}03677       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < this-\/>nnode(); j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03678}03678       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03679}03679         \textcolor{comment}{// Get local coordinate in element (Vector sets its own size)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03680}03680         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_node\_update\_element;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03681}03681         this-\/>local\_coordinate\_of\_node(j, s\_in\_node\_update\_element);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03682}03682 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03683}03683         \textcolor{comment}{// Get vector of geometric objects}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03684}03684         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_pt(m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03685}03685 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03686}03686         \textcolor{comment}{// Pass the lot to the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03687}03687         \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateNode}{MacroElementNodeUpdateNode}}*\textcolor{keyword}{>}(this-\/>node\_pt(j))}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03688}03688           -\/>set\_node\_update\_info(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03689}03689             \textcolor{keyword}{this}, s\_in\_node\_update\_element, geom\_object\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03690}03690       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03691}03691     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03692}03692 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03693}03693     \textcolor{comment}{// MacroElementNodeUpdateElementBase* m\_el\_pt=dynamic\_cast<}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03694}03694     \textcolor{comment}{// MacroElementNodeUpdateElementBase*>(this);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03695}03695     \textcolor{comment}{// if(m\_el\_pt!=0)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03696}03696     \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03697}03697     \textcolor{comment}{// Loop over all nodes in element again, to re-\/set the positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03698}03698     \textcolor{comment}{// This must be done using the new element's macro-\/element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03699}03699     \textcolor{comment}{// representation, rather than the old version which may be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03700}03700     \textcolor{comment}{// of a different p-\/order!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03701}03701     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03702}03702     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03703}03703       \textcolor{comment}{// Get the fractional position of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03704}03704       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03705}03705       \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03706}03706       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0 + 2.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03707}03707 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03708}03708       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < n\_p; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03709}03709       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03710}03710         \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03711}03711         s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03712}03712         \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03713}03713         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = -\/1.0 + 2.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03714}03714 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03715}03715         \textcolor{comment}{// Set the local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03716}03716         jnod = i0 + n\_p * i1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03717}03717 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03718}03718         \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03719}03719         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03720}03720         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03721}03721           \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03722}03722           \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03723}03723           \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03724}03724           \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03725}03725           \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03726}03726           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03727}03727           this-\/>get\_x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03728}03728 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03729}03729           \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03730}03730           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03731}03731           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03732}03732             this-\/>node\_pt(jnod)-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03733}03733           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03734}03734         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03735}03735       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03736}03736     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03737}03737     \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03738}03738   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03739}03739 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03740}03740   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03741}03741 \textcolor{comment}{  /// Check inter-\/element continuity of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03742}03742 \textcolor{comment}{  /// -\/ nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03743}03743 \textcolor{comment}{  /// -\/ (nodally) interpolated function values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03744}03744 \textcolor{comment}{  /// Overloaded to not check differences in the value. Mortaring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03745}03745 \textcolor{comment}{  /// doesn't enforce strong continuity between elements.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03746}03746 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03747}03747   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03748}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_a1ceeaf2697c7924870a7e606240ada38}{03748}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::check\_integrity}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03749}03749     \textcolor{keywordtype}{double}\& max\_error)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03750}03750   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03751}03751     \textcolor{comment}{// Overloaded to *not* check for continuity in value of interpolated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03752}03752     \textcolor{comment}{// variables. This is necessary because mortaring does not ensure continuity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03753}03753     \textcolor{comment}{// across element boundaries. It therefore makes no sense to test for this.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03754}03754 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03755}03755     \textcolor{comment}{// Dummy set max\_error to 0}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03756}03756     max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03757}03757 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03758}03758     \textcolor{comment}{// With macro-\/elements, (strong) continuity in position is nolonger}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03759}03759     \textcolor{comment}{// guaranteed either, so we don't check for this either. In fact, we do}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03760}03760     \textcolor{comment}{// nothing at all.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03761}03761     \textcolor{keywordflow}{if} (this-\/>macro\_elem\_pt() != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03762}03762     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03763}03763       \textcolor{comment}{// We have a macro element, so do nothing!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03764}03764       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03765}03765     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03766}03766 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03767}03767     \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03768}03768 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03769}03769     \textcolor{comment}{// Number of nodes along edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03770}03770     \textcolor{keywordtype}{unsigned} n\_p = nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03771}03771 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03772}03772     \textcolor{comment}{// Number of timesteps (incl. present) for which continuity is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03773}03773     \textcolor{comment}{// to be checked.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03774}03774     \textcolor{keywordtype}{unsigned} n\_time = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03775}03775 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03776}03776     \textcolor{comment}{// Initialise errors}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03777}03777     max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03778}03778     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} max\_error\_x(2, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03779}03779     \textcolor{keywordtype}{double} max\_error\_val = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03780}03780 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03781}03781     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} edges(4);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03782}03782     edges[0] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{S}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03783}03783     edges[1] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03784}03784     edges[2] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03785}03785     edges[3] = \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03786}03786 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03787}03787     \textcolor{comment}{// Loop over the edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03788}03788     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} edge\_counter = 0; edge\_counter < 4; edge\_counter++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03789}03789     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03790}03790       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} translate\_s(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03791}03791       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2), s\_lo\_neigh(2), s\_hi\_neigh(2), s\_fraction(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03792}03792       \textcolor{keywordtype}{int} neigh\_edge, diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03793}03793       \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03794}03794 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03795}03795       \textcolor{comment}{// Find pointer to neighbour in this direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03796}03796       \mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03797}03797       neigh\_pt = quadtree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1QuadTree_ab8cf08ddd68ec671c111bc55f9b37e70}{gteq\_edge\_neighbour}}(edges[edge\_counter],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03798}03798                                                     translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03799}03799                                                     s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03800}03800                                                     s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03801}03801                                                     neigh\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03802}03802                                                     diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03803}03803                                                     in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03804}03804 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03805}03805       \textcolor{comment}{// Neighbour exists and has existing nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03806}03806       \textcolor{keywordflow}{if} ((neigh\_pt != 0) \&\& (neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a50758228db823d72ea8da23dbb000901}{nodes\_built}}()))}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03807}03807       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03808}03808         \textcolor{comment}{// Need to exclude periodic nodes from this check}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03809}03809         \textcolor{comment}{// There are only periodic nodes if we are in a neighbouring tree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03810}03810         \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03811}03811         \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03812}03812         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03813}03813           \textcolor{comment}{// Is it periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03814}03814           is\_periodic = this-\/>tree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1Tree_a33b9926754cddfaafd9869af3fe266e7}{root\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1TreeRoot_a7be347e54e34f924c008c302f5146064}{is\_neighbour\_periodic}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03815}03815             edges[edge\_counter]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03816}03816         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03817}03817 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03818}03818         \textcolor{comment}{// We also need to exclude edges which may have hanging nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03819}03819         \textcolor{comment}{// because mortaring does not guarantee (strong) continuity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03820}03820         \textcolor{comment}{// in position or in value at nonconforming element boundaries}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03821}03821         \textcolor{keywordtype}{bool} exclude\_this\_edge = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03822}03822         \textcolor{keywordflow}{if} (diff\_level != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03823}03823         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03824}03824           \textcolor{comment}{// h-\/type nonconformity (dependent)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03825}03825           exclude\_this\_edge = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03826}03826         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03827}03827         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a31e4123b40f6fb52d180a154c9123e85}{nsons}}() != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03828}03828         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03829}03829           \textcolor{comment}{// h-\/type nonconformity (master)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03830}03830           exclude\_this\_edge = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03831}03831         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03832}03832         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03833}03833         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03834}03834           \textcolor{keywordtype}{unsigned} my\_p\_order = this-\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03835}03835           \textcolor{keywordtype}{unsigned} neigh\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03836}03836             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement}}*\textcolor{keyword}{>}(neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03837}03837               -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03838}03838           \textcolor{keywordflow}{if} (my\_p\_order != neigh\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03839}03839           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03840}03840             \textcolor{comment}{// p-\/type nonconformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03841}03841             exclude\_this\_edge = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03842}03842           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03843}03843         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03844}03844 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03845}03845         \textcolor{comment}{// With macro-\/elements, (strong) continuity in position is nolonger}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03846}03846         \textcolor{comment}{// guaranteed either, so we don't check for this either. In fact, we do}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03847}03847         \textcolor{comment}{// nothing at all.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03848}03848         \textcolor{keywordflow}{if} (\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03849}03849               -\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a801bbe89619c28e181afa8fa3e9ac836}{macro\_elem\_pt}}() != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03850}03850         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03851}03851           \textcolor{comment}{// We have a macro element, so do nothing!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03852}03852           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03853}03853         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03854}03854 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03855}03855         \textcolor{comment}{// Check conforming edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03856}03856         \textcolor{keywordflow}{if} (!exclude\_this\_edge)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03857}03857         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03858}03858           \textcolor{comment}{// Loop over nodes along the edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03859}03859           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03860}03860           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03861}03861             \textcolor{comment}{// Storage for pointer to the local node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03862}03862             \mbox{\hyperlink{classoomph_1_1Node}{Node}}* local\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03863}03863 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03864}03864             \textcolor{keywordflow}{switch} (edge\_counter)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03865}03865             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03866}03866               \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03867}03867                 \textcolor{comment}{// Local fraction of node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03868}03868                 s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03869}03869                 s\_fraction[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03870}03870                 \textcolor{comment}{// Get pointer to local node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03871}03871                 local\_node\_pt = this-\/>node\_pt(i0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03872}03872                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03873}03873 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03874}03874               \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03875}03875                 \textcolor{comment}{// Local fraction of node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03876}03876                 s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03877}03877                 s\_fraction[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03878}03878                 \textcolor{comment}{// Get pointer to local node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03879}03879                 local\_node\_pt = this-\/>node\_pt(i0 + n\_p * (n\_p -\/ 1));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03880}03880                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03881}03881 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03882}03882               \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03883}03883                 \textcolor{comment}{// Local fraction of node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03884}03884                 s\_fraction[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03885}03885                 s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03886}03886                 \textcolor{comment}{// Get pointer to local node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03887}03887                 local\_node\_pt = this-\/>node\_pt(n\_p * i0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03888}03888                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03889}03889 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03890}03890               \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03891}03891                 \textcolor{comment}{// Local fraction of node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03892}03892                 s\_fraction[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03893}03893                 s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03894}03894                 \textcolor{comment}{// Get pointer to local node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03895}03895                 local\_node\_pt = this-\/>node\_pt(n\_p -\/ 1 + n\_p * i0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03896}03896                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03897}03897             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03898}03898 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03899}03899             \textcolor{comment}{// Calculate the local coordinate and the local coordinate as viewed}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03900}03900             \textcolor{comment}{// from the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03901}03901             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neighb(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03902}03902             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03903}03903             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03904}03904               \textcolor{comment}{// Local coordinate in this element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03905}03905               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = -\/1.0 + 2.0 * s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03906}03906               \textcolor{comment}{// Local coordinate in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03907}03907               s\_in\_neighb[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03908}03908                 s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03909}03909                 s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] * (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03910}03910             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03911}03911 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03912}03912             \textcolor{comment}{// Loop over timesteps}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03913}03913             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_time; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03914}03914             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03915}03915               \textcolor{comment}{// Get the nodal position from neighbour element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03916}03916               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_in\_neighb(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03917}03917               neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5a9c1ead9819cd17603096e63087020f}{interpolated\_x}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03918}03918                 \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_neighb, x\_in\_neighb);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03919}03919 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03920}03920               \textcolor{comment}{// Check error only if the node is NOT periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03921}03921               \textcolor{keywordflow}{if} (is\_periodic == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03922}03922               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03923}03923                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03924}03924                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03925}03925                   \textcolor{comment}{// Find the spatial error}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03926}03926                   \textcolor{keywordtype}{double} err =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03927}03927                     std::fabs(local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) -\/ x\_in\_neighb[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03928}03928 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03929}03929                   \textcolor{comment}{// If it's bigger than our tolerance, say so}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03930}03930                   \textcolor{keywordflow}{if} (err > 1\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}-\/9)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03931}03931                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03932}03932                     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}errx "{}} << err << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03933}03933                                << local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03934}03934                                << x\_in\_neighb[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03935}03935 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03936}03936                     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}at "{}} << local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03937}03937                                << local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03938}03938                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03939}03939 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03940}03940                   \textcolor{comment}{// If it's bigger than the previous max error, it is the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03941}03941                   \textcolor{comment}{// new max error!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03942}03942                   \textcolor{keywordflow}{if} (err > max\_error\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03943}03943                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03944}03944                     max\_error\_x[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = err;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03945}03945                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03946}03946                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03947}03947               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03948}03948 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03949}03949               \textcolor{comment}{// Get the values from neighbour element. Note: \# of values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03950}03950               \textcolor{comment}{// gets set by routine (because in general we don't know}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03951}03951               \textcolor{comment}{// how many interpolated values a certain element has}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03952}03952               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} values\_in\_neighb;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03953}03953               neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03954}03954                 \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_neighb, values\_in\_neighb);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03955}03955 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03956}03956               \textcolor{comment}{// Get the values in current element.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03957}03957               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03958}03958               this-\/>get\_interpolated\_values(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03959}03959 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03960}03960               \textcolor{comment}{// Now figure out how many continuously interpolated values there}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03961}03961               \textcolor{comment}{// are}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03962}03962               \textcolor{keywordtype}{unsigned} num\_val =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03963}03963                 neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a53e171a18c9f43f1db90a6876516a073}{ncont\_interpolated\_values}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03964}03964 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03965}03965               \textcolor{comment}{// Check error}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03966}03966               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ival = 0; ival < num\_val; ival++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03967}03967               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03968}03968                 \textcolor{keywordtype}{double} err = std::fabs(values[ival] -\/ values\_in\_neighb[ival]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03969}03969 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03970}03970                 \textcolor{keywordflow}{if} (err > 1.0e-\/10)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03971}03971                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03972}03972                   \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03973}03973                              << local\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{} \(\backslash\)n\# "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03974}03974                              << \textcolor{stringliteral}{"{}erru (S)"{}} << err << \textcolor{stringliteral}{"{} "{}} << ival << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03975}03975                              << this-\/>get\_node\_number(local\_node\_pt) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03976}03976                              << values[ival] << \textcolor{stringliteral}{"{} "{}} << values\_in\_neighb[ival]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03977}03977                              << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03978}03978                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03979}03979 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03980}03980                 \textcolor{keywordflow}{if} (err > max\_error\_val)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03981}03981                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03982}03982                   max\_error\_val = err;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03983}03983                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03984}03984               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03985}03985             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03986}03986           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03987}03987         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03988}03988       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03989}03989     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03990}03990 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03991}03991     max\_error = max\_error\_x[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03992}03992     \textcolor{keywordflow}{if} (max\_error\_x[1] > max\_error) max\_error = max\_error\_x[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03993}03993     \textcolor{keywordflow}{if} (max\_error\_val > max\_error) max\_error = max\_error\_val;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03994}03994 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03995}03995     \textcolor{keywordflow}{if} (max\_error > 1\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}-\/9)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03996}03996     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03997}03997       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ \(\backslash\)n\#Max error "{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03998}03998       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << max\_error\_x[0] << \textcolor{stringliteral}{"{} "{}} << max\_error\_x[1] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l03999}03999                  << max\_error\_val << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04000}04000       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ \(\backslash\)n "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04001}04001     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04002}04002   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04003}04003 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04004}04004   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04005}04005 \textcolor{comment}{  /// Internal function to set up the hanging nodes on a particular}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04006}04006 \textcolor{comment}{  /// edge of the element.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04007}04007 \textcolor{comment}{  /// Implements the mortarting method to enforce continuity weakly}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04008}04008 \textcolor{comment}{  /// across non-\/conforming element boundaries \(\backslash\)f\$\(\backslash\)Gamma\(\backslash\)f\$ using an}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04009}04009 \textcolor{comment}{  /// integral matching condition}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04010}04010 \textcolor{comment}{  /// \(\backslash\)f[ \(\backslash\)int\_\(\backslash\)Gamma (u\_\{\(\backslash\)mbox\{S\}\} -\/ u\_\{\(\backslash\)mbox\{M\}\}) \(\backslash\)psi \(\backslash\)mbox\{d\} s = 0 \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04011}04011 \textcolor{comment}{  /// for all polynomials \(\backslash\)f\$\(\backslash\)psi\(\backslash\)f\$ on \(\backslash\)f\$\(\backslash\)Gamma\(\backslash\)f\$ of degree at most}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04012}04012 \textcolor{comment}{  /// p-\/2 (where p is the spectral-\/order of the dependent element) and a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04013}04013 \textcolor{comment}{  /// vertex matching condition}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04014}04014 \textcolor{comment}{  /// \(\backslash\)f[ (u\_\{\(\backslash\)mbox\{S\}\} -\/ u\_\{\(\backslash\)mbox\{M\}\})\(\backslash\)big\(\backslash\)vert\_\{\(\backslash\)partial\(\backslash\)Gamma\} = 0.\(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04015}04015 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04016}04016 \textcolor{comment}{  /// The algorithm works as follows:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04017}04017 \textcolor{comment}{  ///  -\/ First the element determines if its edge my\_edge is on the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04018}04018 \textcolor{comment}{  ///    master or dependent side of the non-\/conformity.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04019}04019 \textcolor{comment}{  /// At h-\/type non-\/conformities}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04020}04020 \textcolor{comment}{  ///    we choose long edges to be masters, and at p-\/type nonconformities the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04021}04021 \textcolor{comment}{  ///    edge with lower p-\/order is the master.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04022}04022 \textcolor{comment}{  ///  -\/ Mortaring is performed by the dependent side.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04023}04023 \textcolor{comment}{  ///  -\/ If a vertex node of the mortar is shared between master and dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04024}04024 \textcolor{comment}{  ///    element then the vertex matching condition is enforced automatically.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04025}04025 \textcolor{comment}{  ///    Otherwise it must be imposed by constraining its value to that at on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04026}04026 \textcolor{comment}{  ///    the master side.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04027}04027 \textcolor{comment}{  ///  -\/ The integral matching condition is discretised and the mortar test}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04028}04028 \textcolor{comment}{  ///    functions \(\backslash\)f\$ \(\backslash\)psi \(\backslash\)f\$ are chosen to be derivatives of Legendre}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04029}04029 \textcolor{comment}{  ///    polynomials of degree p-\/1.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04030}04030 \textcolor{comment}{  ///  -\/ The mortar mass matrix M is constructed. Its entries are the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04031}04031 \textcolor{comment}{  ///    mortar test functions evaluated at the dependent nodal positions,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04032}04032 \textcolor{comment}{  ///    so it is diagonal.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04033}04033 \textcolor{comment}{  ///  -\/ The local projection matrix is constructed for the master element by}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04034}04034 \textcolor{comment}{  ///    applying the discretised integral matching condition along the mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04035}04035 \textcolor{comment}{  ///    using the appropriate quadrature order.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04036}04036 \textcolor{comment}{  ///  -\/ The global projection matrix is then assembled by subtracting}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04037}04037 \textcolor{comment}{  ///    contributions from the mortar vertex nodes.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04038}04038 \textcolor{comment}{  ///  -\/ The mortar system \(\backslash\)f\$ M\(\backslash\)xi\string^s = P\(\backslash\)hat\{\(\backslash\)xi\string^m\} \(\backslash\)f\$ is constructed,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04039}04039 \textcolor{comment}{  ///    where \(\backslash\)f\$ \(\backslash\)xi\string^m \(\backslash\)f\$ and \(\backslash\)f\$ \(\backslash\)xi\string^s \(\backslash\)f\$ are the nodal values at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04040}04040 \textcolor{comment}{  ///    the master and dependent nodes respectively.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04041}04041 \textcolor{comment}{  ///  -\/ The conformity matrix \(\backslash\)f\$ C = M\string^\{-\/1\}P \(\backslash\)f\$ is computed. This is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04042}04042 \textcolor{comment}{  ///    straightforward since the mass matrix is diagonal.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04043}04043 \textcolor{comment}{  ///  -\/ Finally, the master nodes and weights for each dependent node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04044}04044 \textcolor{comment}{  ///    are read from}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04045}04045 \textcolor{comment}{  ///    the conformity matrix and stored in the dependents' hanging schemes.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04046}04046 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04047}04047 \textcolor{comment}{  /// The positions of the dependent nodes are set to be consistent with their}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04048}04048 \textcolor{comment}{  /// hanging schemes.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04049}04049 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04050}04050   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04051}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4_abf33572d0ba9cd9bf06ca137256c422d}{04051}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, INITIAL\_NNODE\_1D>::quad\_hang\_helper}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04052}04052     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& my\_edge, std::ofstream\& output\_hangfile)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04053}04053   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04054}04054     \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04055}04055 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04056}04056     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} translate\_s(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04057}04057     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04058}04058     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04059}04059     \textcolor{keywordtype}{int} neigh\_edge, diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04060}04060     \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04061}04061 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04062}04062     \textcolor{comment}{// Find pointer to neighbour in this direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04063}04063     \mbox{\hyperlink{classoomph_1_1QuadTree}{QuadTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04064}04064     neigh\_pt = this-\/>quadtree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1QuadTree_ab8cf08ddd68ec671c111bc55f9b37e70}{gteq\_edge\_neighbour}}(my\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04065}04065                                                         translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04066}04066                                                         s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04067}04067                                                         s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04068}04068                                                         neigh\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04069}04069                                                         diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04070}04070                                                         in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04071}04071 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04072}04072     \textcolor{comment}{// Work out master/dependent edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04073}04073     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04074}04074 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04075}04075     \textcolor{comment}{// Set up booleans}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04076}04076     \textcolor{comment}{// bool h\_type\_master = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04077}04077     \textcolor{keywordtype}{bool} h\_type\_dependent = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04078}04078     \textcolor{comment}{// bool p\_type\_master = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04079}04079     \textcolor{keywordtype}{bool} p\_type\_dependent = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04080}04080 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04081}04081     \textcolor{comment}{// Neighbour exists and all nodes have been created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04082}04082     \textcolor{keywordflow}{if} (neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04083}04083     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04084}04084       \textcolor{comment}{// Check if neighbour is bigger than me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04085}04085       \textcolor{keywordflow}{if} (diff\_level != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04086}04086       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04087}04087         \textcolor{comment}{// Dependent at h-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04088}04088         h\_type\_dependent = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04089}04089       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04090}04090       \textcolor{comment}{// Check if neighbour is the same size as me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04091}04091       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a31e4123b40f6fb52d180a154c9123e85}{nsons}}() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04092}04092       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04093}04093         \textcolor{comment}{// Neighbour is same size as me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04094}04094         \textcolor{comment}{// Find p-\/orders of each element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04095}04095         \textcolor{keywordtype}{unsigned} my\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04096}04096           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(\textcolor{keyword}{this})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04097}04097             -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04098}04098         \textcolor{keywordtype}{unsigned} neigh\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04099}04099           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04100}04100             neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04101}04101             -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04102}04102 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04103}04103         \textcolor{comment}{// Check for p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04104}04104         \textcolor{keywordflow}{if} (neigh\_p\_order == my\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04105}04105         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04106}04106           \textcolor{comment}{// At a conforming interface}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04107}04107         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04108}04108         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (neigh\_p\_order < my\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04109}04109         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04110}04110           \textcolor{comment}{// Dependent at p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04111}04111           p\_type\_dependent = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04112}04112         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04113}04113         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04114}04114         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04115}04115           \textcolor{comment}{// Master at p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04116}04116           \textcolor{comment}{// p\_type\_master = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04117}04117         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04118}04118       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04119}04119       \textcolor{comment}{// Neighbour must be smaller than me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04120}04120       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04121}04121       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04122}04122         \textcolor{comment}{// Master at h-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04123}04123         \textcolor{comment}{// h\_type\_master = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04124}04124       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04125}04125     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04126}04126     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04127}04127     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04128}04128       \textcolor{comment}{// Edge is on a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04129}04129     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04130}04130 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04131}04131     \textcolor{comment}{// Now do the mortaring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04132}04132     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04133}04133     \textcolor{keywordflow}{if} (h\_type\_dependent || p\_type\_dependent)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04134}04134     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04135}04135       \textcolor{comment}{// Compute the active coordinate index along the this side of mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04136}04136       \textcolor{keywordtype}{unsigned} active\_coord\_index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04137}04137       \textcolor{keywordflow}{if} (my\_edge == \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}} || my\_edge == \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{S}}) active\_coord\_index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04138}04138       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (my\_edge == \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}} || my\_edge == \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04139}04139         active\_coord\_index = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04140}04140       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04141}04141       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04142}04142         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Cannot transform coordinates"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04143}04143                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04144}04144                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04145}04145       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04146}04146 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04147}04147       \textcolor{comment}{// Get pointer to neighbouring master element (in p-\/refineable form)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04148}04148       \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}* neigh\_obj\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04149}04149       neigh\_obj\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_012_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<2, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04150}04150         neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04151}04151 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04152}04152       \textcolor{comment}{// Create vector of master and dependent nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04153}04153       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04154}04154       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} master\_node\_pt, dependent\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04155}04155       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} master\_node\_number, dependent\_node\_number;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04156}04156       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> dependent\_node\_s\_fraction;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04157}04157 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04158}04158       \textcolor{comment}{// Number of nodes in one dimension}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04159}04159       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} my\_n\_p = this-\/>ninterpolating\_node\_1d(value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04160}04160       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} neigh\_n\_p = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a850180084aaf164550b4f4978b42cda7}{ninterpolating\_node\_1d}}(value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04161}04161 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04162}04162       \textcolor{comment}{// Test for the periodic node case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04163}04163       \textcolor{comment}{// Are we crossing a periodic boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04164}04164       \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04165}04165       \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04166}04166       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04167}04167         is\_periodic =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04168}04168           this-\/>tree\_pt()-\/>root\_pt()-\/>is\_neighbour\_periodic(my\_edge);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04169}04169       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04170}04170 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04171}04171       \textcolor{comment}{// If it is periodic we actually need to get the node in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04172}04172       \textcolor{comment}{// the neighbour of the neighbour (which will be a parent of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04173}04173       \textcolor{comment}{// the present element) so that the "{}fixed"{} coordinate is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04174}04174       \textcolor{comment}{// correctly calculated.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04175}04175       \textcolor{comment}{// The idea is to replace the neigh\_pt and associated data}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04176}04176       \textcolor{comment}{// with those of the neighbour of the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04177}04177       \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04178}04178       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04179}04179         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04180}04180           \textcolor{stringliteral}{"{}Cannot do mortaring with periodic hanging nodes yet! (Fix me!)"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04181}04181           \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04182}04182           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04183}04183       \} \textcolor{comment}{// End of special treatment for periodic hanging nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04184}04184 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04185}04185       \textcolor{comment}{// Storage for pointers to the nodes and their numbers along the master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04186}04186       \textcolor{comment}{// edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04187}04187       \textcolor{keywordtype}{unsigned} neighbour\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04188}04188       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04189}04189 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04190}04190       \textcolor{comment}{// Loop over nodes along the edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04191}04191       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < neigh\_n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04192}04192       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04193}04193         \textcolor{comment}{// Find the neighbour's node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04194}04194         \textcolor{keywordflow}{switch} (neigh\_edge)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04195}04195         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04196}04196           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04197}04197             neighbour\_node\_number = i0 + neigh\_n\_p * (neigh\_n\_p -\/ 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04198}04198             neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04199}04199               neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04200}04200             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04201}04201 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04202}04202           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{S}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04203}04203             neighbour\_node\_number = i0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04204}04204             neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04205}04205               neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04206}04206             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04207}04207 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04208}04208           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04209}04209             neighbour\_node\_number = neigh\_n\_p -\/ 1 + neigh\_n\_p * i0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04210}04210             neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04211}04211               neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04212}04212             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04213}04213 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04214}04214           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04215}04215             neighbour\_node\_number = neigh\_n\_p * i0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04216}04216             neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04217}04217               neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04218}04218             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04219}04219 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04220}04220           \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04221}04221             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}my\_edge not N, S, W, E\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04222}04222                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04223}04223                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04224}04224         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04225}04225 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04226}04226         \textcolor{comment}{// Set node as master node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04227}04227         master\_node\_number.push\_back(neighbour\_node\_number);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04228}04228         master\_node\_pt.push\_back(neighbour\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04229}04229       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04230}04230 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04231}04231       \textcolor{comment}{// Storage for pointers to the local nodes and their numbers along my edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04232}04232       \textcolor{keywordtype}{unsigned} local\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04233}04233       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* local\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04234}04234 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04235}04235       \textcolor{comment}{// Loop over the nodes along my edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04236}04236       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < my\_n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04237}04237       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04238}04238         \textcolor{comment}{// Storage for the fractional position of the node in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04239}04239         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04240}04240 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04241}04241         \textcolor{comment}{// Find the local node and the fractional position of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04242}04242         \textcolor{comment}{// which depends on the edge, of course}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04243}04243         \textcolor{keywordflow}{switch} (my\_edge)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04244}04244         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04245}04245           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7dabc60bec4cc294aa2adf92726c6d6823a}{N}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04246}04246             s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04247}04247               local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04248}04248             s\_fraction[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04249}04249             local\_node\_number = i0 + my\_n\_p * (my\_n\_p -\/ 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04250}04250             local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04251}04251               this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04252}04252             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04253}04253 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04254}04254           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da85b07d6c087e0cb66bac32a0b6a45198}{S}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04255}04255             s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04256}04256               local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04257}04257             s\_fraction[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04258}04258             local\_node\_number = i0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04259}04259             local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04260}04260               this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04261}04261             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04262}04262 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04263}04263           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7da585070bd0e3801c3bbed287ef3c4a265}{E}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04264}04264             s\_fraction[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04265}04265             s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04266}04266               local\_one\_d\_fraction\_of\_interpolating\_node(i0, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04267}04267             local\_node\_number = my\_n\_p -\/ 1 + my\_n\_p * i0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04268}04268             local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04269}04269               this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04270}04270             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04271}04271 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04272}04272           \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1QuadTreeNames_a8954a5947b19986b8c4b755bc7639f7daabab2a070c062503375f8264f1b6d7d6}{W}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04273}04273             s\_fraction[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04274}04274             s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04275}04275               local\_one\_d\_fraction\_of\_interpolating\_node(i0, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04276}04276             local\_node\_number = my\_n\_p * i0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04277}04277             local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04278}04278               this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04279}04279             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04280}04280 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04281}04281           \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04282}04282             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}my\_edge not N, S, W, E\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04283}04283                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04284}04284                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04285}04285         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04286}04286 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04287}04287         \textcolor{comment}{// Add node to vector of dependent element nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04288}04288         dependent\_node\_number.push\_back(local\_node\_number);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04289}04289         dependent\_node\_pt.push\_back(local\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04290}04290 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04291}04291         \textcolor{comment}{// Store node's local fraction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04292}04292         dependent\_node\_s\_fraction.push\_back(s\_fraction);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04293}04293       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04294}04294 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04295}04295       \textcolor{comment}{// Store the number of dependent and master nodes for use later}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04296}04296       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dependent\_nodes = dependent\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04297}04297       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_master\_nodes = master\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04298}04298       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} dependent\_element\_nnode\_1d = my\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04299}04299       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} master\_element\_nnode\_1d = neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04300}04300 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04301}04301       \textcolor{comment}{// Storage for master shapes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04302}04302       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} master\_shapes(neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8b1b5031b55141567ba24913a21534f4}{ninterpolating\_node}}(value\_id));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04303}04303 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04304}04304       \textcolor{comment}{// Get master and dependent nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04305}04305       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04306}04306       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} dependent\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04307}04307       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} dependent\_weight(dependent\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04308}04308       \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04309}04309         dependent\_element\_nnode\_1d, dependent\_nodal\_position, dependent\_weight);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04310}04310       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} master\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04311}04311       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} master\_weight(master\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04312}04312       \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04313}04313         master\_element\_nnode\_1d, master\_nodal\_position, master\_weight);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04314}04314 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04315}04315       \textcolor{comment}{// Apply the vertex matching condition}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04316}04316       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04317}04317       \textcolor{comment}{// Vertiex matching is ensured automatically in cases where there is a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04318}04318       \textcolor{comment}{// node at each end of the mortar that is shared between the master and}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04319}04319       \textcolor{comment}{// dependent elements. Where this is not the case, the vertex matching}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04320}04320       \textcolor{comment}{// condition must be enforced by constraining the value of the unknown at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04321}04321       \textcolor{comment}{// the node on the dependent side to be the same as the value at that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04322}04322       \textcolor{comment}{// location in the master.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04323}04323 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04324}04324       \textcolor{comment}{// Store positions of the mortar vertex/non-\/vertex nodes in the dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04325}04325       \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04326}04326       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_mortar\_vertices = 2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04327}04327       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} vertex\_pos(n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04328}04328       vertex\_pos[0] = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04329}04329       vertex\_pos[1] = this-\/>ninterpolating\_node\_1d(value\_id) -\/ 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04330}04330       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} non\_vertex\_pos(my\_n\_p -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04331}04331       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < my\_n\_p -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04332}04332       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04333}04333         non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04334}04334       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04335}04335 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04336}04336       \textcolor{comment}{// Check if the mortar vertices are shared}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04337}04337       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_mortar\_vertices; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04338}04338       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04339}04339         \textcolor{comment}{// Search master node storage for the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04340}04340         \textcolor{keywordtype}{bool} node\_is\_shared = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04341}04341         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < master\_node\_pt.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04342}04342         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04343}04343           \textcolor{keywordflow}{if} (dependent\_node\_pt[vertex\_pos[v]] == master\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04344}04344           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04345}04345             node\_is\_shared = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04346}04346             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04347}04347           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04348}04348         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04349}04349 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04350}04350         \textcolor{comment}{// If the node is not shared then we must constrain its value by setting}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04351}04351         \textcolor{comment}{// up a hanging scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04352}04352         \textcolor{keywordflow}{if} (!node\_is\_shared)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04353}04353         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04354}04354           \textcolor{comment}{// Calculate weights. These are just the master shapes evaluated at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04355}04355           \textcolor{comment}{// this dependent node's position}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04356}04356 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04357}04357           \textcolor{comment}{// Work out this node's location in the master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04358}04358           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04359}04359           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04360}04360           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04361}04361             s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04362}04362               s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04363}04363               dependent\_node\_s\_fraction[vertex\_pos[v]][translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04364}04364                 (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04365}04365           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04366}04366 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04367}04367           \textcolor{comment}{// Get master shapes at dependent nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04368}04368           neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8ca420443c28708e5c6315a80f520137}{interpolating\_basis}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04369}04369             s\_in\_neigh, master\_shapes, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04370}04370 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04371}04371           \textcolor{comment}{// Remove any existing hanging node info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04372}04372           \textcolor{comment}{// (This may be a bit wasteful, but guarantees correctness)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04373}04373           dependent\_node\_pt[vertex\_pos[v]]-\/>set\_nonhanging();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04374}04374 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04375}04375           \textcolor{comment}{// Set up hanging scheme for this node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04376}04376           \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* explicit\_hang\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}(n\_master\_nodes);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04377}04377           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master\_nodes; m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04378}04378           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04379}04379             explicit\_hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_afe4042d5805342d5e12b6a28e376885a}{set\_master\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04380}04380               m, master\_node\_pt[m], master\_shapes[master\_node\_number[m]]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04381}04381           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04382}04382 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04383}04383           \textcolor{comment}{// Make node hang}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04384}04384           dependent\_node\_pt[vertex\_pos[v]]-\/>set\_hanging\_pt(explicit\_hang\_pt,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04385}04385                                                            -\/1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04386}04386         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04387}04387       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04388}04388 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04389}04389       \textcolor{comment}{// Check that there are actually dependent nodes for which we still need}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04390}04390       \textcolor{comment}{// to construct a hanging scheme. If not then there is nothing more to do.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04391}04391       \textcolor{keywordflow}{if} (n\_dependent\_nodes -\/ n\_mortar\_vertices > 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04392}04392       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04393}04393         \textcolor{comment}{// Assemble mass matrix for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04394}04394         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04395}04395         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} psi(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04396}04396         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} diag\_M(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04397}04397         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> shared\_node\_M(n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04398}04398         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < shared\_node\_M.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04399}04399         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04400}04400           shared\_node\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04401}04401         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04402}04402 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04403}04403         \textcolor{comment}{// Fill in part corresponding to dependent nodal positions (unknown)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04404}04404         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04405}04405         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04406}04406           \textcolor{comment}{// Use L'Hosptal's rule:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04407}04407           psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04408}04408             pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04409}04409             -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04410}04410                                   dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04411}04411           \textcolor{comment}{// Put in contribution}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04412}04412           diag\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dependent\_weight[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04413}04413         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04414}04414 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04415}04415         \textcolor{comment}{// Fill in part corresponding to dependent element vertices (known)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04416}04416         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < shared\_node\_M.size(); v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04417}04417         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04418}04418           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04419}04419           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04420}04420             \textcolor{comment}{// Check if denominator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04421}04421             \textcolor{keywordflow}{if} (std::fabs(dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04422}04422                           dependent\_nodal\_position[vertex\_pos[v]]) >= 1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04423}04423             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04424}04424               \textcolor{comment}{// We're ok}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04425}04425               psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04426}04426                 pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04427}04427                 \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04428}04428                                     dependent\_nodal\_position[vertex\_pos[v]]) /}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04429}04429                 (dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04430}04430                  dependent\_nodal\_position[vertex\_pos[v]]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04431}04431             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04432}04432             \textcolor{comment}{// Check if numerator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04433}04433             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04434}04434                        dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04435}04435                        dependent\_nodal\_position[vertex\_pos[v]])) < 1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04436}04436             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04437}04437               \textcolor{comment}{// We can use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04438}04438               psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04439}04439                 pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04440}04440                 -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04441}04441                   dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04442}04442                   dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04443}04443             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04444}04444             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04445}04445             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04446}04446               \textcolor{comment}{// We can't use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04447}04447               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04448}04448                 \textcolor{stringliteral}{"{}Cannot use l'Hopital's rule. Dividing by zero is not allowed!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04449}04449                 \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04450}04450                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04451}04451             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04452}04452             \textcolor{comment}{// Put in contribution}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04453}04453             shared\_node\_M[v][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dependent\_weight[vertex\_pos[v]];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04454}04454           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04455}04455         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04456}04456 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04457}04457         \textcolor{comment}{// Assemble local projection matrix for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04458}04458         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04459}04459 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04460}04460         \textcolor{comment}{// Have only one local projection matrix because there is just one}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04461}04461         \textcolor{comment}{// master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04462}04462         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> P(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04463}04463         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04464}04464         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04465}04465           P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(n\_master\_nodes, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04466}04466         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04467}04467 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04468}04468         \textcolor{comment}{// Storage for local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04469}04469         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04470}04470 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04471}04471         \textcolor{comment}{// Sum contributions from master element shapes (quadrature).}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04472}04472         \textcolor{comment}{// The order of quadrature must be high enough to evaluate a polynomial}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04473}04473         \textcolor{comment}{// of order N\_s + N\_m -\/ 3 exactly, where N\_s = n\_dependent\_nodes, N\_m =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04474}04474         \textcolor{comment}{// n\_master\_nodes.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04475}04475         \textcolor{comment}{// (Use pointers for the quadrature knots and weights so that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04476}04476         \textcolor{comment}{// data is not unnecessarily copied)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04477}04477         \textcolor{comment}{// unsigned quadrature\_order =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04478}04478         \textcolor{comment}{// std::max(dependent\_element\_nnode\_1d,master\_element\_nnode\_1d);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04479}04479         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}*quadrature\_knot, *quadrature\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04480}04480         \textcolor{keywordflow}{if} (dependent\_element\_nnode\_1d >= master\_element\_nnode\_1d)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04481}04481         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04482}04482           \textcolor{comment}{// Use the same quadrature order as the dependent element (me)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04483}04483           quadrature\_knot = \&dependent\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04484}04484           quadrature\_weight = \&dependent\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04485}04485         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04486}04486         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04487}04487         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04488}04488           \textcolor{comment}{// Use the same quadrature order as the master element (neighbour)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04489}04489           quadrature\_knot = \&master\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04490}04490           quadrature\_weight = \&master\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04491}04491         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04492}04492 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04493}04493         \textcolor{comment}{// Quadrature loop}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04494}04494         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < (*quadrature\_weight).size(); q++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04495}04495         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04496}04496           \textcolor{comment}{// Evaluate mortar test functions at the quadrature knots in the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04497}04497           \textcolor{comment}{// dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04498}04498           \textcolor{comment}{// s[active\_coord\_index] = (*quadrature\_knot)[q];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04499}04499           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_on\_mortar(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04500}04500           s\_on\_mortar[0] = (*quadrature\_knot)[q];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04501}04501 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04502}04502           \textcolor{comment}{// Get psi}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04503}04503           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dependent\_nodes -\/ n\_mortar\_vertices; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04504}04504           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04505}04505             \textcolor{comment}{// Check if denominator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04506}04506             \textcolor{keywordflow}{if} (std::fabs(dependent\_nodal\_position[non\_vertex\_pos[k]] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04507}04507                           s\_on\_mortar[0]) >= 1.0e-\/08)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04508}04508             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04509}04509               \textcolor{comment}{// We're ok}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04510}04510               psi[k] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04511}04511                 pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ k -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04512}04512                 \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04513}04513                                     s\_on\_mortar[0]) /}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04514}04514                 (dependent\_nodal\_position[non\_vertex\_pos[k]] -\/ s\_on\_mortar[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04515}04515             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04516}04516             \textcolor{comment}{// Check if numerator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04517}04517             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04518}04518                        dependent\_element\_nnode\_1d -\/ 1, s\_on\_mortar[0])) <}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04519}04519                      1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04520}04520             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04521}04521               \textcolor{comment}{// We can use l'Hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04522}04522               psi[k] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04523}04523                 pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ k -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04524}04524                 -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04525}04525                                       s\_on\_mortar[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04526}04526             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04527}04527             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04528}04528             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04529}04529               \textcolor{comment}{// We can't use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04530}04530               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04531}04531                 \textcolor{stringliteral}{"{}Cannot use l'Hopital's rule. Dividing by zero is not allowed!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04532}04532                 \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04533}04533                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04534}04534             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04535}04535           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04536}04536 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04537}04537           \textcolor{comment}{// Convert coordinate on mortar to local fraction in dependent element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04538}04538           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04539}04539           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04540}04540           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04541}04541             s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == active\_coord\_index) ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04542}04542                               0.5 * (s\_on\_mortar[0] + 1.0) :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04543}04543                               dependent\_node\_s\_fraction[vertex\_pos[0]][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04544}04544           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04545}04545 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04546}04546           \textcolor{comment}{// Project active coordinate into master element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04547}04547           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04548}04548           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04549}04549           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04550}04550             s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04551}04551                                               (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04552}04552           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04553}04553 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04554}04554           \textcolor{comment}{// Evaluate master shapes at projections of local quadrature knots}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04555}04555           neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8ca420443c28708e5c6315a80f520137}{interpolating\_basis}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04556}04556             s\_in\_neigh, master\_shapes, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04557}04557 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04558}04558           \textcolor{comment}{// Populate local projection matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04559}04559           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04560}04560           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04561}04561             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_master\_nodes; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04562}04562             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04563}04563               P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] += master\_shapes[master\_node\_number[j]] * psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04564}04564                          (*quadrature\_weight)[q];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04565}04565             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04566}04566           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04567}04567         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04568}04568 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04569}04569         \textcolor{comment}{// Assemble global projection matrices for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04570}04570         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04571}04571         \textcolor{comment}{// Need to subtract contributions from the "{}known unknowns"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04572}04572         \textcolor{comment}{// corresponding to the nodes at the vertices of the mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04573}04573 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04574}04574         \textcolor{comment}{// Assemble contributions from mortar vertex nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04575}04575         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_mortar\_vertices; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04576}04576         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04577}04577           \textcolor{comment}{// Convert coordinate on mortar to local fraction in dependent element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04578}04578           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04579}04579           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04580}04580           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04581}04581             s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04582}04582               (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == active\_coord\_index) ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04583}04583                 0.5 * (dependent\_nodal\_position[vertex\_pos[v]] + 1.0) :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04584}04584                 dependent\_node\_s\_fraction[vertex\_pos[0]][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04585}04585           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04586}04586 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04587}04587           \textcolor{comment}{// Project active coordinate into master element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04588}04588           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04589}04589           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04590}04590           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04591}04591             s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04592}04592                                               (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04593}04593           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04594}04594 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04595}04595           \textcolor{comment}{// Get master shapes at dependent nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04596}04596           neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8ca420443c28708e5c6315a80f520137}{interpolating\_basis}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04597}04597             s\_in\_neigh, master\_shapes, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04598}04598 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04599}04599           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04600}04600           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04601}04601             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_master\_nodes; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04602}04602             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04603}04603               P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][k] -\/=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04604}04604                 master\_shapes[master\_node\_number[k]] * shared\_node\_M[v][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04605}04605             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04606}04606           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04607}04607         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04608}04608 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04609}04609         \textcolor{comment}{// Solve mortar system}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04610}04610         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04611}04611         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04612}04612         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04613}04613           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_master\_nodes; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04614}04614           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04615}04615             P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] /= diag\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04616}04616           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04617}04617         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04618}04618 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04619}04619         \textcolor{comment}{// Create structures to hold the hanging info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04620}04620         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04621}04621         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<HangInfo*>}} hang\_info\_pt(n\_dependent\_nodes);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04622}04622         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04623}04623         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04624}04624           hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}(n\_master\_nodes);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04625}04625         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04626}04626 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04627}04627         \textcolor{comment}{// Copy information to hanging nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04628}04628         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04629}04629         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04630}04630         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04631}04631           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_master\_nodes; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04632}04632           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04633}04633             hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>set\_master\_node\_pt(j, master\_node\_pt[j], P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04634}04634           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04635}04635         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04636}04636 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04637}04637         \textcolor{comment}{// Set pointers to hanging info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04638}04638         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04639}04639         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04640}04640         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04641}04641           \textcolor{comment}{// Check that the node shoule actually hang.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04642}04642           \textcolor{comment}{// That is, if the polynomial orders of the elements at a p-\/type}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04643}04643           \textcolor{comment}{// non-\/conormity are both odd then the middle node on the edge is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04644}04644           \textcolor{comment}{// shared but a hanging scheme has been constructed for it.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04645}04645           \textcolor{keywordtype}{bool} node\_is\_really\_shared = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04646}04646           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>nmaster(); m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04647}04647           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04648}04648             \textcolor{comment}{// We can simply check if the hanging scheme lists itself as a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04649}04649             \textcolor{comment}{// master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04650}04650             \textcolor{keywordflow}{if} (hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>master\_node\_pt(m) ==}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04651}04651                 dependent\_node\_pt[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04652}04652             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04653}04653               node\_is\_really\_shared = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04654}04654 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04655}04655 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04656}04656               \textcolor{comment}{// Also check the corresponding weight: it should be 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04657}04657               \textcolor{keywordflow}{if} (std::fabs(hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>master\_weight(m) -\/ 1.0) > 1.0e-\/06)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04658}04658               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04659}04659                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04660}04660                   \textcolor{stringliteral}{"{}Something fishy here -\/-\/ with shared node at a mortar vertex"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04661}04661                   \textcolor{stringliteral}{"{}PRefineableQElemen<2,INITIAL\_NNODE\_1D>t::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04662}04662                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04663}04663               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04664}04664 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04665}04665             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04666}04666           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04667}04667 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04668}04668           \textcolor{comment}{// Now we can make the node hang, if it isn't a shared node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04669}04669           \textcolor{keywordflow}{if} (!node\_is\_really\_shared)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04670}04670           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04671}04671             dependent\_node\_pt[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]]-\/>set\_hanging\_pt(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04672}04672               hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}], -\/1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04673}04673           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04674}04674         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04675}04675 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04676}04676       \} \textcolor{comment}{// End of case where there are still dependent nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04677}04677 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04678}04678 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04679}04679       \textcolor{comment}{// Check all dependent nodes, hanging or otherwise}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04680}04680       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04681}04681       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04682}04682         \textcolor{comment}{// Check that weights sum to 1 for those that hang}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04683}04683         \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04684}04684         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04685}04685           \textcolor{comment}{// Check that weights sum to 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04686}04686           \textcolor{keywordtype}{double} weight\_sum = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04687}04687           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04688}04688                m < dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04689}04689                m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04690}04690           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04691}04691             weight\_sum += dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_weight(m);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04692}04692           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04693}04693 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04694}04694           \textcolor{comment}{// Warn if not}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04695}04695           \textcolor{keywordflow}{if} (std::fabs(weight\_sum -\/ 1.0) > 1.0e-\/08)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04696}04696           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04697}04697             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Sum of master weights: "{}} << weight\_sum << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04698}04698             \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04699}04699               \textcolor{stringliteral}{"{}Weights in hanging scheme do not sum to 1"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04700}04700               \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04701}04701               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04702}04702           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04703}04703         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04704}04704         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04705}04705         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04706}04706           \textcolor{comment}{// Check that this node is shared with the master element if it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04707}04707           \textcolor{comment}{// isn't hanging}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04708}04708           \textcolor{keywordtype}{bool} is\_master = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04709}04709           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_master\_nodes; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04710}04710           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04711}04711             \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] == master\_node\_pt[n])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04712}04712             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04713}04713               \textcolor{comment}{// Node is a master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04714}04714               is\_master = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04715}04715               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04716}04716             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04717}04717           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04718}04718 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04719}04719           \textcolor{keywordflow}{if} (!is\_master)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04720}04720           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04721}04721             \textcolor{comment}{// Throw error}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04722}04722             std::ostringstream error\_string;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04723}04723             error\_string << \textcolor{stringliteral}{"{}This node in the dependent element is neither"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04724}04724                          << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04725}04725                          << \textcolor{stringliteral}{"{}hanging or shared with a master element."{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04726}04726                          << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04727}04727 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04728}04728             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04729}04729               error\_string.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04730}04730               \textcolor{stringliteral}{"{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04731}04731               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04732}04732           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04733}04733         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04734}04734       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04735}04735 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04736}04736 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04737}04737       \textcolor{comment}{// Finally, Loop over all dependent nodes and fine-\/tune their positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04738}04738       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04739}04739       \textcolor{comment}{// Here we simply set the node's positions to be consistent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04740}04740       \textcolor{comment}{// with the hanging scheme. This is not strictly necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04741}04741       \textcolor{comment}{// because it is done in the mesh adaptation before the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04742}04742       \textcolor{comment}{// becomes non-\/hanging later on. We make no attempt to ensure}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04743}04743       \textcolor{comment}{// (strong) continuity in the position across the mortar.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04744}04744       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04745}04745       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04746}04746         \textcolor{comment}{// Only fine-\/tune hanging nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04747}04747         \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04748}04748         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04749}04749           \textcolor{comment}{// If we are doing the position, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04750}04750           \textcolor{keywordflow}{if} (value\_id == -\/1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04751}04751           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04752}04752             \textcolor{comment}{// Get the local coordinate of this dependent node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04753}04753             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_local(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04754}04754             this-\/>local\_coordinate\_of\_node(dependent\_node\_number[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}], s\_local);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04755}04755 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04756}04756             \textcolor{comment}{// Get the position from interpolation in this element via}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04757}04757             \textcolor{comment}{// the hanging scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04758}04758             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_in\_neighb(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04759}04759             this-\/>interpolated\_x(s\_local, x\_in\_neighb);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04760}04760 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04761}04761             \textcolor{comment}{// Fine adjust the coordinates (macro map will pick up boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04762}04762             \textcolor{comment}{// accurately but will lead to different element edges)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04763}04763             dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(0) = x\_in\_neighb[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04764}04764             dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(1) = x\_in\_neighb[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04765}04765           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04766}04766         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04767}04767       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04768}04768     \} \textcolor{comment}{// End of case where this interface is to be mortared}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04769}04769   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04770}04770 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04771}04771 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04772}04772 \textcolor{comment}{}  \textcolor{comment}{//       3D PRefineableQElements}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04773}04773 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04774}04774 \textcolor{comment}{}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04775}04775 \textcolor{comment}{  /// Get local coordinates of node j in the element; vector sets its own size}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04776}04776 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04777}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a4106472f372c70ec71b97c84b892ad7c}{04777}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::local\_coordinate\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04778}04778     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04779}04779 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04780}04780     \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}.resize(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04781}04781     \textcolor{keywordtype}{unsigned} Nnode\_1d = this-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04782}04782     \textcolor{keywordtype}{unsigned} n0 = n \% Nnode\_1d;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04783}04783     \textcolor{keywordtype}{unsigned} n1 = unsigned(\textcolor{keywordtype}{double}(n) / \textcolor{keywordtype}{double}(Nnode\_1d)) \% Nnode\_1d;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04784}04784     \textcolor{keywordtype}{unsigned} n2 = unsigned(\textcolor{keywordtype}{double}(n) / \textcolor{keywordtype}{double}(Nnode\_1d * Nnode\_1d));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04785}04785 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04786}04786     \textcolor{keywordflow}{switch} (Nnode\_1d)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04787}04787     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04788}04788       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04789}04789         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04790}04790         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04791}04791         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04792}04792         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04793}04793         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04794}04794       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04795}04795         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04796}04796         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04797}04797         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04798}04798         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04799}04799         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04800}04800       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04801}04801         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04802}04802         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04803}04803         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04804}04804         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04805}04805         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04806}04806       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04807}04807         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04808}04808         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04809}04809         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04810}04810         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04811}04811         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04812}04812       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04813}04813         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04814}04814         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04815}04815         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04816}04816         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04817}04817         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04818}04818       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04819}04819         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04820}04820         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04821}04821         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04822}04822         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04823}04823         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04824}04824       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04825}04825         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04826}04826         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04827}04827         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04828}04828         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04829}04829                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04830}04830                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04831}04831         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04832}04832     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04833}04833   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04834}04834 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04835}04835 \textcolor{comment}{  /// Get the local fractino of node j in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04836}04836 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04837}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a01c4b27c53fcf94e34985b17ab7c309d}{04837}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::local\_fraction\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04838}04838     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04839}04839   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04840}04840     this-\/>local\_coordinate\_of\_node(n, s\_fraction);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04841}04841     s\_fraction[0] = 0.5 * (s\_fraction[0] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04842}04842     s\_fraction[1] = 0.5 * (s\_fraction[1] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04843}04843     s\_fraction[2] = 0.5 * (s\_fraction[2] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04844}04844   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04845}04845 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04846}04846   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04847}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a7d01711b7996dbb88e14af17c7d35100}{04847}}   \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::local\_one\_d\_fraction\_of\_node}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04848}04848     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n1d, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04849}04849   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04850}04850     \textcolor{keywordflow}{switch} (this-\/>nnode\_1d())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04851}04851     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04852}04852       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04853}04853         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04854}04854         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04855}04855                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<2>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04856}04856       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04857}04857         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04858}04858         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04859}04859                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<3>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04860}04860       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04861}04861         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04862}04862         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04863}04863                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<4>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04864}04864       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04865}04865         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04866}04866         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04867}04867                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<5>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04868}04868       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04869}04869         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04870}04870         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04871}04871                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<6>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04872}04872       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04873}04873         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04874}04874         \textcolor{keywordflow}{return} 0.5 *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04875}04875                (\mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_a5e68d68ec3373a97a96d8843b6631dba}{OneDimensionalLegendreShape<7>::nodal\_position}}(n1d) + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04876}04876       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04877}04877         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04878}04878         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04879}04879         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04880}04880         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04881}04881                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04882}04882                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04883}04883         \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04884}04884     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04885}04885   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04886}04886 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04887}04887   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04888}04888 \textcolor{comment}{  /// Return the node at the specified local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04889}04889 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04890}04890   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04891}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_ad641bd9cd4e858dfa97a8d59eebea354}{04891}}   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::get\_node\_at\_local\_coordinate}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04892}04892     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04893}04893 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04894}04894     \textcolor{keywordtype}{unsigned} Nnode\_1d = this-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04895}04895     \textcolor{comment}{// Load the tolerance into a local variable}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04896}04896     \textcolor{keywordtype}{double} tol = \mbox{\hyperlink{classoomph_1_1FiniteElement_a56eb1d0614eb76ba1591285e3efed268}{FiniteElement::Node\_location\_tolerance}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04897}04897     \textcolor{comment}{// There are two possible indices.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04898}04898     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} index(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04899}04899 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04900}04900     \textcolor{comment}{// Loop over indices}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04901}04901     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04902}04902     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04903}04903       \textcolor{comment}{// Determine the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04904}04904       \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04905}04905 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04906}04906       \textcolor{keywordtype}{bool} is\_found = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04907}04907 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04908}04908       \textcolor{comment}{// If we are at the lower limit, the index is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04909}04909       \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + 1.0) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04910}04910       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04911}04911         index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04912}04912         is\_found = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04913}04913       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04914}04914       \textcolor{comment}{// If we are at the upper limit, the index is the number of nodes minus 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04915}04915       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ 1.0) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04916}04916       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04917}04917         index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = Nnode\_1d -\/ 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04918}04918         is\_found = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04919}04919       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04920}04920       \textcolor{comment}{// Otherwise, we have to calculate the index in general}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04921}04921       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04922}04922       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04923}04923         \textcolor{comment}{// Compute Gauss-\/Lobatto-\/Legendre node positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04924}04924         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} z;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04925}04925         \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(Nnode\_1d, z);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04926}04926         \textcolor{comment}{// Loop over possible internal nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04927}04927         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 1; n < Nnode\_1d -\/ 1; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04928}04928         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04929}04929           \textcolor{keywordflow}{if} (std::fabs(z[n] -\/ \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) < tol)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04930}04930           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04931}04931             index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = n;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04932}04932             is\_found = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04933}04933             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04934}04934           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04935}04935         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04936}04936       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04937}04937 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04938}04938       \textcolor{keywordflow}{if} (!is\_found)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04939}04939       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04940}04940         \textcolor{comment}{// No matching nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04941}04941         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04942}04942       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04943}04943     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04944}04944     \textcolor{comment}{// If we've got here we have a node, so let's return a pointer to it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04945}04945     \textcolor{keywordflow}{return} this-\/>node\_pt(index[0] + Nnode\_1d * index[1] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04946}04946                          Nnode\_1d * Nnode\_1d * index[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04947}04947   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04948}04948 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04949}04949   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04950}04950 \textcolor{comment}{  /// If a neighbouring element has already created a node at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04951}04951 \textcolor{comment}{  /// a position corresponding to the local fractional position within the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04952}04952 \textcolor{comment}{  /// present element, s\_fraction, return}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04953}04953 \textcolor{comment}{  /// a pointer to that node. If not, return NULL (0).}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04954}04954 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04955}04955   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04956}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a13ade2af2bf8726c4174a4451f4227b2}{04956}}   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::node\_created\_by\_neighbour}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04957}04957     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction, \textcolor{keywordtype}{bool}\& is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04958}04958   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04959}04959     \textcolor{keyword}{using namespace }OcTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04960}04960 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04961}04961     \textcolor{comment}{// Calculate the faces/edges on which the node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04962}04962     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} faces;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04963}04963     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} edges;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04964}04964 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04965}04965     \textcolor{keywordflow}{if} (s\_fraction[0] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04966}04966     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04967}04967       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04968}04968       \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04969}04969       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04970}04970         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{LD}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04971}04971       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04972}04972       \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04973}04973       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04974}04974         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{LB}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04975}04975       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04976}04976       \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04977}04977       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04978}04978         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{LU}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04979}04979       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04980}04980       \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04981}04981       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04982}04982         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{LF}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04983}04983       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04984}04984     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04985}04985 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04986}04986     \textcolor{keywordflow}{if} (s\_fraction[0] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04987}04987     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04988}04988       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04989}04989       \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04990}04990       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04991}04991         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{RD}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04992}04992       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04993}04993       \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04994}04994       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04995}04995         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{RB}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04996}04996       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04997}04997       \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04998}04998       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l04999}04999         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{RU}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05000}05000       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05001}05001       \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05002}05002       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05003}05003         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{RF}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05004}05004       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05005}05005     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05006}05006 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05007}05007     \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05008}05008     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05009}05009       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05010}05010       \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05011}05011       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05012}05012         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{DB}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05013}05013       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05014}05014       \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05015}05015       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05016}05016         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{DF}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05017}05017       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05018}05018     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05019}05019 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05020}05020     \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05021}05021     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05022}05022       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05023}05023       \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05024}05024       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05025}05025         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{UB}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05026}05026       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05027}05027       \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05028}05028       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05029}05029         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{UF}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05030}05030       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05031}05031     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05032}05032 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05033}05033     \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05034}05034     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05035}05035       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05036}05036     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05037}05037 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05038}05038     \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05039}05039     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05040}05040       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05041}05041     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05042}05042 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05043}05043     \textcolor{comment}{// Find the number of faces}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05044}05044     \textcolor{keywordtype}{unsigned} n\_face = faces.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05045}05045 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05046}05046     \textcolor{comment}{// Find the number of edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05047}05047     \textcolor{keywordtype}{unsigned} n\_edge = edges.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05048}05048 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05049}05049     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} translate\_s(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05050}05050     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05051}05051     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05052}05052     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05053}05053 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05054}05054     \textcolor{keywordtype}{int} neigh\_face, diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05055}05055     \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05056}05056 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05057}05057     \textcolor{comment}{// Loop over the faces on which the node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05058}05058     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05059}05059     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_face; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05060}05060     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05061}05061       \textcolor{comment}{// Find pointer to neighbouring element along face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05062}05062       \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05063}05063       neigh\_pt = octree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1OcTree_a690c4fbbca73bd48c0bc3b2913a9b39c}{gteq\_face\_neighbour}}(faces[j],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05064}05064                                                   translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05065}05065                                                   s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05066}05066                                                   s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05067}05067                                                   neigh\_face,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05068}05068                                                   diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05069}05069                                                   in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05070}05070 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05071}05071       \textcolor{comment}{// Neighbour exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05072}05072       \textcolor{keywordflow}{if} (neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05073}05073       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05074}05074         \textcolor{comment}{// Have any of its vertex nodes been created yet?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05075}05075         \textcolor{comment}{// (Must look in incomplete neighbours because after the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05076}05076         \textcolor{comment}{// pre-\/build they may contain pointers to the required nodes. e.g.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05077}05077         \textcolor{comment}{// h-\/refinement of neighbouring linear and quadratic elements)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05078}05078         \textcolor{keywordtype}{bool} a\_vertex\_node\_is\_built = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05079}05079         \mbox{\hyperlink{classoomph_1_1QElement}{QElement<3, INITIAL\_NNODE\_1D>}}* neigh\_obj\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05080}05080           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1QElement}{QElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05081}05081         \textcolor{keywordflow}{if} (neigh\_obj\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05082}05082         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05083}05083           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Not a quad element!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05084}05084                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05085}05085                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05086}05086         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05087}05087         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} vnode = 0; vnode < neigh\_obj\_pt-\/>nvertex\_node(); vnode++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05088}05088         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05089}05089           \textcolor{keywordflow}{if} (neigh\_obj\_pt-\/>vertex\_node\_pt(vnode) != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05090}05090             a\_vertex\_node\_is\_built = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05091}05091           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05092}05092         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05093}05093         \textcolor{keywordflow}{if} (a\_vertex\_node\_is\_built)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05094}05094         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05095}05095           \textcolor{comment}{// We now need to translate the nodal location, defined in terms}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05096}05096           \textcolor{comment}{// of the fractional coordinates of the present element into}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05097}05097           \textcolor{comment}{// those of its neighbour. For this we use the information returned}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05098}05098           \textcolor{comment}{// to use from the octree function.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05099}05099 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05100}05100           \textcolor{comment}{// Calculate the local coordinate in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05101}05101           \textcolor{comment}{// Note that we need to use the translation scheme in case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05102}05102           \textcolor{comment}{// the local coordinates are swapped in the neighbour.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05103}05103           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05104}05104           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05105}05105             \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05106}05106                    s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] * (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05107}05107           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05108}05108 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05109}05109           \textcolor{comment}{// Find the node in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05110}05110           \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05111}05111             neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{get\_node\_at\_local\_coordinate}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05112}05112 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05113}05113           \textcolor{comment}{// If there is a node, return it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05114}05114           \textcolor{keywordflow}{if} (neighbour\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05115}05115           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05116}05116             \textcolor{comment}{// Now work out whether it's a periodic boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05117}05117             \textcolor{comment}{// only possible if we have moved into a neighbouring tree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05118}05118             \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05119}05119             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05120}05120               \textcolor{comment}{// Return whether the neighbour is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05121}05121               is\_periodic =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05122}05122                 octree\_pt()-\/>root\_pt()-\/>is\_neighbour\_periodic(faces[j]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05123}05123             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05124}05124 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05125}05125             \textcolor{keywordflow}{return} neighbour\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05126}05126           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05127}05127         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05128}05128       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05129}05129     \} \textcolor{comment}{// End of loop over faces}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05130}05130 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05131}05131 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05132}05132     \textcolor{comment}{// Loop over the edges on which the node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05133}05133     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05134}05134     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_edge; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05135}05135     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05136}05136       \textcolor{comment}{// Even if we restrict ourselves to true edge neighbours (i.e.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05137}05137       \textcolor{comment}{// elements that are not also face neighbours) there may be multiple}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05138}05138       \textcolor{comment}{// edge neighbours across the edges between multiple root octrees.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05139}05139       \textcolor{comment}{// When making the first call to OcTree::gteq\_true\_edge\_neighbour(...)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05140}05140       \textcolor{comment}{// we simply return the first one of these multiple edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05141}05141       \textcolor{comment}{// (if there are any at all, of course) and also return the total number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05142}05142       \textcolor{comment}{// of true edge neighbours. If the node in question already exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05143}05143       \textcolor{comment}{// on the first edge neighbour we're done. If it doesn't it may exist}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05144}05144       \textcolor{comment}{// on other edge neighbours so we repeat the process over all}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05145}05145       \textcolor{comment}{// other edge neighbours (bailing out if a node is found, of course).}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05146}05146 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05147}05147       \textcolor{comment}{// Initially return the zero-\/th true edge neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05148}05148       \textcolor{keywordtype}{unsigned} i\_root\_edge\_neighbour = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05149}05149 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05150}05150       \textcolor{comment}{// Initialise the total number of true edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05151}05151       \textcolor{keywordtype}{unsigned} nroot\_edge\_neighbour = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05152}05152 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05153}05153       \textcolor{comment}{// Keep searching until we've found the node or until we've checked}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05154}05154       \textcolor{comment}{// all available edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05155}05155       \textcolor{keywordtype}{bool} keep\_searching = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05156}05156       \textcolor{keywordflow}{while} (keep\_searching)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05157}05157       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05158}05158         \textcolor{comment}{// Find pointer to neighbouring element along edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05159}05159         \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05160}05160         neigh\_pt = octree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1OcTree_ab5a26409cd49a430095915c76060f476}{gteq\_true\_edge\_neighbour}}(edges[j],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05161}05161                                                          i\_root\_edge\_neighbour,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05162}05162                                                          nroot\_edge\_neighbour,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05163}05163                                                          translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05164}05164                                                          s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05165}05165                                                          s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05166}05166                                                          neigh\_face,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05167}05167                                                          diff\_level);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05168}05168 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05169}05169         \textcolor{comment}{// Neighbour exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05170}05170         \textcolor{keywordflow}{if} (neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05171}05171         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05172}05172           \textcolor{comment}{// Have any of its vertex nodes been created yet?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05173}05173           \textcolor{comment}{// (Must look in incomplete neighbours because after the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05174}05174           \textcolor{comment}{// pre-\/build they may contain pointers to the required nodes. e.g.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05175}05175           \textcolor{comment}{// h-\/refinement of neighbouring linear and quadratic elements)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05176}05176           \textcolor{keywordtype}{bool} a\_vertex\_node\_is\_built = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05177}05177           \mbox{\hyperlink{classoomph_1_1QElement}{QElement<3, INITIAL\_NNODE\_1D>}}* neigh\_obj\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05178}05178             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1QElement}{QElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05179}05179           \textcolor{keywordflow}{if} (neigh\_obj\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05180}05180           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05181}05181             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Not a quad element!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05182}05182                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05183}05183                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05184}05184           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05185}05185           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} vnode = 0; vnode < neigh\_obj\_pt-\/>nvertex\_node();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05186}05186                vnode++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05187}05187           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05188}05188             \textcolor{keywordflow}{if} (neigh\_obj\_pt-\/>vertex\_node\_pt(vnode) != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05189}05189               a\_vertex\_node\_is\_built = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05190}05190             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05191}05191           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05192}05192           \textcolor{keywordflow}{if} (a\_vertex\_node\_is\_built)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05193}05193           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05194}05194             \textcolor{comment}{// We now need to translate the nodal location, defined in terms}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05195}05195             \textcolor{comment}{// of the fractional coordinates of the present element into}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05196}05196             \textcolor{comment}{// those of its neighbour. For this we use the information returned}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05197}05197             \textcolor{comment}{// to use from the octree function.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05198}05198 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05199}05199             \textcolor{comment}{// Calculate the local coordinate in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05200}05200             \textcolor{comment}{// Note that we need to use the translation scheme in case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05201}05201             \textcolor{comment}{// the local coordinates are swapped in the neighbour.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05202}05202             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05203}05203             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05204}05204               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05205}05205                                        (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05206}05206             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05207}05207 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05208}05208             \textcolor{comment}{// Find the node in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05209}05209             \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05210}05210               neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{get\_node\_at\_local\_coordinate}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05211}05211 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05212}05212             \textcolor{comment}{// If there is a node, return it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05213}05213             \textcolor{keywordflow}{if} (neighbour\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05214}05214             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05215}05215               \textcolor{comment}{// Get the faces on which the edge lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05216}05216               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} faces\_attached\_to\_edge =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05217}05217                 \mbox{\hyperlink{classoomph_1_1OcTree_a29d019becbc07f9ea2811a0ff0881d9a}{OcTree::faces\_of\_common\_edge}}(edges[j]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05218}05218 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05219}05219               \textcolor{comment}{// Get the number of entries in the vector}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05220}05220               \textcolor{keywordtype}{unsigned} n\_faces\_attached\_to\_edge = faces\_attached\_to\_edge.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05221}05221 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05222}05222               \textcolor{comment}{// Loop over the faces}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05223}05223               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_face = 0; i\_face < n\_faces\_attached\_to\_edge;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05224}05224                    i\_face++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05225}05225               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05226}05226                 \textcolor{comment}{// Is the node periodic in the face direction?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05227}05227                 is\_periodic = octree\_pt()-\/>root\_pt()-\/>is\_neighbour\_periodic(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05228}05228                   faces\_attached\_to\_edge[i\_face]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05229}05229 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05230}05230                 \textcolor{comment}{// Check if the edge is periodic in the i\_face-\/th face direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05231}05231                 \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05232}05232                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05233}05233                   \textcolor{comment}{// We're done!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05234}05234                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05235}05235                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05236}05236               \} \textcolor{comment}{// for (unsigned}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05237}05237                 \textcolor{comment}{// i\_face=0;i\_face<n\_faces\_attached\_to\_edge;i\_face++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05238}05238 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05239}05239               \textcolor{keywordflow}{return} neighbour\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05240}05240             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05241}05241           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05242}05242         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05243}05243 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05244}05244         \textcolor{comment}{// Keep searching, but only if there are further edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05245}05245         \textcolor{comment}{// Try next root edge neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05246}05246         i\_root\_edge\_neighbour++;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05247}05247 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05248}05248         \textcolor{comment}{// Have we exhausted the search}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05249}05249         \textcolor{keywordflow}{if} (i\_root\_edge\_neighbour >= nroot\_edge\_neighbour)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05250}05250         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05251}05251           keep\_searching = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05252}05252         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05253}05253 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05254}05254       \} \textcolor{comment}{// End of while keep searching over all true edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05255}05255 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05256}05256     \} \textcolor{comment}{// End of loop over edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05257}05257 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05258}05258     \textcolor{comment}{// Node not found, return null}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05259}05259     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05260}05260   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05261}05261 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05262}05262   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05263}05263 \textcolor{comment}{  /// If a neighbouring element's son has already created a node at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05264}05264 \textcolor{comment}{  /// a position corresponding to the local fractional position within the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05265}05265 \textcolor{comment}{  /// present element, s\_fraction, return}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05266}05266 \textcolor{comment}{  /// a pointer to that node. If not, return NULL (0). If the node is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05267}05267 \textcolor{comment}{  /// periodic the flag is\_periodic will be true}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05268}05268 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05269}05269   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05270}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_ad83214afad85f049cdab21a5756e962d}{05270}}   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05271}05271 \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{    node\_created\_by\_son\_of\_neighbour}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05272}05272                                      \textcolor{keywordtype}{bool}\& is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05273}05273   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05274}05274     \textcolor{keyword}{using namespace }OcTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05275}05275 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05276}05276     \textcolor{comment}{// Calculate the faces/edges on which the node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05277}05277     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} faces;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05278}05278     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} edges;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05279}05279 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05280}05280     \textcolor{keywordflow}{if} (s\_fraction[0] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05281}05281     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05282}05282       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05283}05283       \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05284}05284       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05285}05285         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{LD}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05286}05286       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05287}05287       \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05288}05288       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05289}05289         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{LB}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05290}05290       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05291}05291       \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05292}05292       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05293}05293         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{LU}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05294}05294       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05295}05295       \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05296}05296       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05297}05297         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{LF}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05298}05298       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05299}05299     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05300}05300 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05301}05301     \textcolor{keywordflow}{if} (s\_fraction[0] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05302}05302     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05303}05303       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05304}05304       \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05305}05305       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05306}05306         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{RD}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05307}05307       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05308}05308       \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05309}05309       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05310}05310         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{RB}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05311}05311       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05312}05312       \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05313}05313       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05314}05314         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{RU}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05315}05315       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05316}05316       \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05317}05317       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05318}05318         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{RF}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05319}05319       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05320}05320     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05321}05321 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05322}05322     \textcolor{keywordflow}{if} (s\_fraction[1] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05323}05323     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05324}05324       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05325}05325       \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05326}05326       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05327}05327         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{DB}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05328}05328       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05329}05329       \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05330}05330       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05331}05331         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{DF}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05332}05332       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05333}05333     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05334}05334 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05335}05335     \textcolor{keywordflow}{if} (s\_fraction[1] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05336}05336     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05337}05337       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05338}05338       \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05339}05339       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05340}05340         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{UB}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05341}05341       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05342}05342       \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05343}05343       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05344}05344         edges.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{UF}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05345}05345       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05346}05346     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05347}05347 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05348}05348     \textcolor{keywordflow}{if} (s\_fraction[2] == 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05349}05349     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05350}05350       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05351}05351     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05352}05352 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05353}05353     \textcolor{keywordflow}{if} (s\_fraction[2] == 1.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05354}05354     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05355}05355       faces.push\_back(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05356}05356     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05357}05357 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05358}05358     \textcolor{comment}{// Find the number of faces}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05359}05359     \textcolor{keywordtype}{unsigned} n\_face = faces.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05360}05360 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05361}05361     \textcolor{comment}{// Find the number of edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05362}05362     \textcolor{keywordtype}{unsigned} n\_edge = edges.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05363}05363 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05364}05364     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} translate\_s(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05365}05365     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05366}05366     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05367}05367     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05368}05368 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05369}05369     \textcolor{keywordtype}{int} neigh\_face, diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05370}05370     \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05371}05371 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05372}05372     \textcolor{comment}{// Loop over the faces on which the node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05373}05373     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05374}05374     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_face; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05375}05375     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05376}05376       \textcolor{comment}{// Find pointer to neighbouring element along face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05377}05377       \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05378}05378       neigh\_pt = octree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1OcTree_a690c4fbbca73bd48c0bc3b2913a9b39c}{gteq\_face\_neighbour}}(faces[j],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05379}05379                                                   translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05380}05380                                                   s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05381}05381                                                   s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05382}05382                                                   neigh\_face,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05383}05383                                                   diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05384}05384                                                   in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05385}05385 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05386}05386       \textcolor{comment}{// Neighbour exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05387}05387       \textcolor{keywordflow}{if} (neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05388}05388       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05389}05389         \textcolor{comment}{// Have its nodes been created yet?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05390}05390         \textcolor{comment}{// (Must look in sons of unfinished neighbours too!!!)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05391}05391         \textcolor{keywordflow}{if} (\textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05392}05392         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05393}05393           \textcolor{comment}{// We now need to translate the nodal location, defined in terms}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05394}05394           \textcolor{comment}{// of the fractional coordinates of the present element into}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05395}05395           \textcolor{comment}{// those of its neighbour. For this we use the information returned}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05396}05396           \textcolor{comment}{// to use from the octree function.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05397}05397 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05398}05398           \textcolor{comment}{// Calculate the local coordinate in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05399}05399           \textcolor{comment}{// Note that we need to use the translation scheme in case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05400}05400           \textcolor{comment}{// the local coordinates are swapped in the neighbour.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05401}05401           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05402}05402           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05403}05403             \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05404}05404                    s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] * (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05405}05405           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05406}05406 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05407}05407           \textcolor{comment}{// Check if the element has sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05408}05408           \textcolor{keywordflow}{if} (neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a31e4123b40f6fb52d180a154c9123e85}{nsons}}() != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05409}05409           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05410}05410             \textcolor{comment}{// First, find the son element in which the node should live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05411}05411 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05412}05412             \textcolor{comment}{// Find coordinates in the sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05413}05413             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_son(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05414}05414             \textcolor{keywordtype}{int} son = -\/10;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05415}05415             \textcolor{comment}{// On the left}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05416}05416             \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05417}05417             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05418}05418               \textcolor{comment}{// On the bottom}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05419}05419               \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05420}05420               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05421}05421                 \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05422}05422                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05423}05423                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05424}05424                   \textcolor{comment}{// It's the LDB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05425}05425                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05426}05426                   s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05427}05427                   s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05428}05428                   s\_in\_son[2] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05429}05429                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05430}05430                 \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05431}05431                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05432}05432                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05433}05433                   \textcolor{comment}{// It's the LDF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05434}05434                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05435}05435                   s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05436}05436                   s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05437}05437                   s\_in\_son[2] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05438}05438                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05439}05439               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05440}05440               \textcolor{comment}{// On the top}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05441}05441               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05442}05442               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05443}05443                 \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05444}05444                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05445}05445                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05446}05446                   \textcolor{comment}{// It's the LUB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05447}05447                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05448}05448                   s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05449}05449                   s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05450}05450                   s\_in\_son[2] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05451}05451                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05452}05452                 \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05453}05453                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05454}05454                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05455}05455                   \textcolor{comment}{// It's the LUF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05456}05456                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05457}05457                   s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05458}05458                   s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05459}05459                   s\_in\_son[2] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05460}05460                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05461}05461               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05462}05462             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05463}05463             \textcolor{comment}{// On the right}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05464}05464             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05465}05465             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05466}05466               \textcolor{comment}{// On the bottom}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05467}05467               \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05468}05468               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05469}05469                 \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05470}05470                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05471}05471                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05472}05472                   \textcolor{comment}{// It's the RDB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05473}05473                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05474}05474                   s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05475}05475                   s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05476}05476                   s\_in\_son[2] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05477}05477                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05478}05478                 \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05479}05479                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05480}05480                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05481}05481                   \textcolor{comment}{// It's the RDF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05482}05482                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05483}05483                   s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05484}05484                   s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05485}05485                   s\_in\_son[2] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05486}05486                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05487}05487               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05488}05488               \textcolor{comment}{// On the top}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05489}05489               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05490}05490               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05491}05491                 \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05492}05492                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05493}05493                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05494}05494                   \textcolor{comment}{// It's the RUB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05495}05495                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05496}05496                   s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05497}05497                   s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05498}05498                   s\_in\_son[2] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05499}05499                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05500}05500                 \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05501}05501                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05502}05502                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05503}05503                   \textcolor{comment}{// It's the RUF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05504}05504                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05505}05505                   s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05506}05506                   s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05507}05507                   s\_in\_son[2] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05508}05508                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05509}05509               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05510}05510             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05511}05511 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05512}05512             \textcolor{comment}{// Find the node in the neighbour's son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05513}05513             \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_son\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05514}05514               neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a9851a9dd06212b6891ce9a8bc832d4cf}{son\_pt}}(son)-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{get\_node\_at\_local\_coordinate}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05515}05515                 s\_in\_son);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05516}05516 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05517}05517             \textcolor{comment}{// If there is a node, return it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05518}05518             \textcolor{keywordflow}{if} (neighbour\_son\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05519}05519             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05520}05520               \textcolor{comment}{// Now work out whether it's a periodic boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05521}05521               \textcolor{comment}{// only possible if we have moved into a neighbouring tree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05522}05522               \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05523}05523               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05524}05524                 \textcolor{comment}{// Return whether the neighbour is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05525}05525                 is\_periodic =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05526}05526                   octree\_pt()-\/>root\_pt()-\/>is\_neighbour\_periodic(faces[j]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05527}05527               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05528}05528 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05529}05529               \textcolor{comment}{// Return the pointer to the neighbouring node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05530}05530               \textcolor{keywordflow}{return} neighbour\_son\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05531}05531             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05532}05532           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05533}05533         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05534}05534       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05535}05535     \} \textcolor{comment}{// End of loop over faces}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05536}05536 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05537}05537 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05538}05538     \textcolor{comment}{// Loop over the edges on which the node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05539}05539     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05540}05540     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_edge; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05541}05541     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05542}05542       \textcolor{comment}{// Even if we restrict ourselves to true edge neighbours (i.e.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05543}05543       \textcolor{comment}{// elements that are not also face neighbours) there may be multiple}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05544}05544       \textcolor{comment}{// edge neighbours across the edges between multiple root octrees.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05545}05545       \textcolor{comment}{// When making the first call to OcTree::gteq\_true\_edge\_neighbour(...)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05546}05546       \textcolor{comment}{// we simply return the first one of these multiple edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05547}05547       \textcolor{comment}{// (if there are any at all, of course) and also return the total number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05548}05548       \textcolor{comment}{// of true edge neighbours. If the node in question already exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05549}05549       \textcolor{comment}{// on the first edge neighbour we're done. If it doesn't it may exist}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05550}05550       \textcolor{comment}{// on other edge neighbours so we repeat the process over all}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05551}05551       \textcolor{comment}{// other edge neighbours (bailing out if a node is found, of course).}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05552}05552 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05553}05553       \textcolor{comment}{// Initially return the zero-\/th true edge neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05554}05554       \textcolor{keywordtype}{unsigned} i\_root\_edge\_neighbour = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05555}05555 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05556}05556       \textcolor{comment}{// Initialise the total number of true edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05557}05557       \textcolor{keywordtype}{unsigned} nroot\_edge\_neighbour = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05558}05558 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05559}05559       \textcolor{comment}{// Keep searching until we've found the node or until we've checked}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05560}05560       \textcolor{comment}{// all available edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05561}05561       \textcolor{keywordtype}{bool} keep\_searching = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05562}05562       \textcolor{keywordflow}{while} (keep\_searching)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05563}05563       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05564}05564         \textcolor{comment}{// Find pointer to neighbouring element along edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05565}05565         \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05566}05566         neigh\_pt = octree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1OcTree_ab5a26409cd49a430095915c76060f476}{gteq\_true\_edge\_neighbour}}(edges[j],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05567}05567                                                          i\_root\_edge\_neighbour,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05568}05568                                                          nroot\_edge\_neighbour,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05569}05569                                                          translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05570}05570                                                          s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05571}05571                                                          s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05572}05572                                                          neigh\_face,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05573}05573                                                          diff\_level);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05574}05574 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05575}05575         \textcolor{comment}{// Neighbour exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05576}05576         \textcolor{keywordflow}{if} (neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05577}05577         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05578}05578           \textcolor{comment}{// Have its nodes been created yet?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05579}05579           \textcolor{comment}{// (Must look in sons of unfinished neighbours too!!!)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05580}05580           \textcolor{keywordflow}{if} (\textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05581}05581           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05582}05582             \textcolor{comment}{// We now need to translate the nodal location, defined in terms}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05583}05583             \textcolor{comment}{// of the fractional coordinates of the present element into}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05584}05584             \textcolor{comment}{// those of its neighbour. For this we use the information returned}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05585}05585             \textcolor{comment}{// to use from the octree function.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05586}05586 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05587}05587             \textcolor{comment}{// Calculate the local coordinate in the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05588}05588             \textcolor{comment}{// Note that we need to use the translation scheme in case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05589}05589             \textcolor{comment}{// the local coordinates are swapped in the neighbour.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05590}05590             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05591}05591             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05592}05592               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05593}05593                                        (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05594}05594             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05595}05595 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05596}05596             \textcolor{comment}{// Check if the element has sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05597}05597             \textcolor{keywordflow}{if} (neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a31e4123b40f6fb52d180a154c9123e85}{nsons}}() != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05598}05598             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05599}05599               \textcolor{comment}{// First, find the son element in which the node should live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05600}05600 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05601}05601               \textcolor{comment}{// Find coordinates in the sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05602}05602               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_son(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05603}05603               \textcolor{keywordtype}{int} son = -\/10;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05604}05604               \textcolor{comment}{// On the left}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05605}05605               \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05606}05606               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05607}05607                 \textcolor{comment}{// On the bottom}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05608}05608                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05609}05609                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05610}05610                   \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05611}05611                   \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05612}05612                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05613}05613                     \textcolor{comment}{// It's the LDB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05614}05614                     son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05615}05615                     s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05616}05616                     s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05617}05617                     s\_in\_son[2] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05618}05618                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05619}05619                   \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05620}05620                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05621}05621                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05622}05622                     \textcolor{comment}{// It's the LDF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05623}05623                     son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05624}05624                     s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05625}05625                     s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05626}05626                     s\_in\_son[2] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05627}05627                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05628}05628                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05629}05629                 \textcolor{comment}{// On the top}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05630}05630                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05631}05631                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05632}05632                   \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05633}05633                   \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05634}05634                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05635}05635                     \textcolor{comment}{// It's the LUB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05636}05636                     son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05637}05637                     s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05638}05638                     s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05639}05639                     s\_in\_son[2] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05640}05640                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05641}05641                   \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05642}05642                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05643}05643                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05644}05644                     \textcolor{comment}{// It's the LUF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05645}05645                     son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05646}05646                     s\_in\_son[0] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05647}05647                     s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05648}05648                     s\_in\_son[2] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05649}05649                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05650}05650                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05651}05651               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05652}05652               \textcolor{comment}{// On the right}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05653}05653               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05654}05654               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05655}05655                 \textcolor{comment}{// On the bottom}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05656}05656                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05657}05657                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05658}05658                   \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05659}05659                   \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05660}05660                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05661}05661                     \textcolor{comment}{// It's the RDB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05662}05662                     son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05663}05663                     s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05664}05664                     s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05665}05665                     s\_in\_son[2] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05666}05666                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05667}05667                   \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05668}05668                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05669}05669                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05670}05670                     \textcolor{comment}{// It's the RDF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05671}05671                     son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05672}05672                     s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05673}05673                     s\_in\_son[1] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05674}05674                     s\_in\_son[2] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05675}05675                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05676}05676                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05677}05677                 \textcolor{comment}{// On the top}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05678}05678                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05679}05679                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05680}05680                   \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05681}05681                   \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05682}05682                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05683}05683                     \textcolor{comment}{// It's the RUB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05684}05684                     son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05685}05685                     s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05686}05686                     s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05687}05687                     s\_in\_son[2] = 1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05688}05688                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05689}05689                   \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05690}05690                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05691}05691                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05692}05692                     \textcolor{comment}{// It's the RUF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05693}05693                     son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05694}05694                     s\_in\_son[0] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05695}05695                     s\_in\_son[1] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05696}05696                     s\_in\_son[2] = -\/1.0 + 2.0 * \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05697}05697                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05698}05698                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05699}05699               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05700}05700 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05701}05701               \textcolor{comment}{// Find the node in the neighbour's son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05702}05702               \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_son\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05703}05703                 neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a9851a9dd06212b6891ce9a8bc832d4cf}{son\_pt}}(son)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05704}05704                   -\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05705}05705                   -\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{get\_node\_at\_local\_coordinate}}(s\_in\_son);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05706}05706 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05707}05707               \textcolor{comment}{// If there is a node, return it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05708}05708               \textcolor{keywordflow}{if} (neighbour\_son\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05709}05709               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05710}05710                 \textcolor{comment}{// Get the faces on which the edge lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05711}05711                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} faces\_attached\_to\_edge =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05712}05712                   \mbox{\hyperlink{classoomph_1_1OcTree_a29d019becbc07f9ea2811a0ff0881d9a}{OcTree::faces\_of\_common\_edge}}(edges[j]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05713}05713 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05714}05714                 \textcolor{comment}{// Get the number of entries in the vector}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05715}05715                 \textcolor{keywordtype}{unsigned} n\_faces\_attached\_to\_edge =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05716}05716                   faces\_attached\_to\_edge.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05717}05717 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05718}05718                 \textcolor{comment}{// Loop over the faces}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05719}05719                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_face = 0; i\_face < n\_faces\_attached\_to\_edge;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05720}05720                      i\_face++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05721}05721                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05722}05722                   \textcolor{comment}{// Is the node periodic in the face direction?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05723}05723                   is\_periodic = octree\_pt()-\/>root\_pt()-\/>is\_neighbour\_periodic(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05724}05724                     faces\_attached\_to\_edge[i\_face]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05725}05725 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05726}05726                   \textcolor{comment}{// Check if the edge is periodic in the i\_face-\/th face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05727}05727                   \textcolor{comment}{// direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05728}05728                   \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05729}05729                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05730}05730                     \textcolor{comment}{// We're done!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05731}05731                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05732}05732                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05733}05733                 \} \textcolor{comment}{// for (unsigned}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05734}05734                   \textcolor{comment}{// i\_face=0;i\_face<n\_faces\_attached\_to\_edge;i\_face++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05735}05735 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05736}05736                 \textcolor{comment}{// Return the pointer to the neighbouring node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05737}05737                 \textcolor{keywordflow}{return} neighbour\_son\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05738}05738               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05739}05739             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05740}05740           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05741}05741         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05742}05742 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05743}05743         \textcolor{comment}{// Keep searching, but only if there are further edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05744}05744         \textcolor{comment}{// Try next root edge neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05745}05745         i\_root\_edge\_neighbour++;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05746}05746 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05747}05747         \textcolor{comment}{// Have we exhausted the search}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05748}05748         \textcolor{keywordflow}{if} (i\_root\_edge\_neighbour >= nroot\_edge\_neighbour)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05749}05749         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05750}05750           keep\_searching = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05751}05751         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05752}05752 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05753}05753       \} \textcolor{comment}{// End of while keep searching over all true edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05754}05754 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05755}05755     \} \textcolor{comment}{// End of loop over edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05756}05756 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05757}05757     \textcolor{comment}{// Node not found, return null}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05758}05758     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05759}05759   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05760}05760 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05761}05761   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05762}05762 \textcolor{comment}{  /// Set the correct p-\/order of the element based on that of its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05763}05763 \textcolor{comment}{  /// father. Then construct an integration scheme of the correct order.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05764}05764 \textcolor{comment}{  /// If an adopted father is specified, information from this is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05765}05765 \textcolor{comment}{  /// used instead of using the father found from the tree.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05766}05766 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05767}05767   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05768}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a46ecfac0c9c6f00bd70d8cacf8afc395}{05768}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::initial\_setup}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05769}05769     \mbox{\hyperlink{classoomph_1_1Tree}{Tree}}* \textcolor{keyword}{const}\& adopted\_father\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& initial\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05770}05770   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05771}05771     \textcolor{comment}{// Storage for pointer to my father (in octree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05772}05772     \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* father\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05773}05773 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05774}05774     \textcolor{comment}{// Check if an adopted father has been specified}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05775}05775     \textcolor{keywordflow}{if} (adopted\_father\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05776}05776     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05777}05777       \textcolor{comment}{// Get pointer to my father (in octree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05778}05778       father\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}*\textcolor{keyword}{>}(adopted\_father\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05779}05779     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05780}05780     \textcolor{comment}{// Check if element is in a tree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05781}05781     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Tree\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05782}05782     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05783}05783       \textcolor{comment}{// Get pointer to my father (in octree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05784}05784       father\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}*\textcolor{keyword}{>}(octree\_pt()-\/>father\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05785}05785     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05786}05786     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05787}05787     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05788}05788       \textcolor{comment}{// throw OomphLibError(}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05789}05789       \textcolor{comment}{//       "{}Element not in a tree, and no adopted father has been}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05790}05790       \textcolor{comment}{//       specified!"{},}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05791}05791       \textcolor{comment}{//       "{}PRefineableQElement<2,INITIAL\_NNODE\_1D>::initial\_setup()"{},}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05792}05792       \textcolor{comment}{//       OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05793}05793     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05794}05794 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05795}05795     \textcolor{comment}{// Check if element has father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05796}05796     \textcolor{keywordflow}{if} (father\_pt != 0 || initial\_p\_order != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05797}05797     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05798}05798       \textcolor{keywordflow}{if} (father\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05799}05799       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05800}05800         \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}* father\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05801}05801           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05802}05802             father\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05803}05803         \textcolor{keywordflow}{if} (father\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05804}05804         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05805}05805           \textcolor{keywordtype}{unsigned} father\_p\_order = father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05806}05806           \textcolor{comment}{// Set p-\/order to that of father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05807}05807           P\_order = father\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05808}05808         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05809}05809       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05810}05810       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05811}05811       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05812}05812         P\_order = initial\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05813}05813       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05814}05814 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05815}05815       \textcolor{comment}{// Now sort out the element...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05816}05816       \textcolor{comment}{// (has p\string^3 nodes)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05817}05817       \textcolor{keywordtype}{unsigned} new\_n\_node = P\_order * P\_order * P\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05818}05818 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05819}05819       \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05820}05820       this-\/>set\_n\_node(new\_n\_node);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05821}05821 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05822}05822       \textcolor{comment}{// Set integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05823}05823       \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05824}05824       \textcolor{keywordflow}{switch} (P\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05825}05825       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05826}05826         \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05827}05827           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05828}05828           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05829}05829         \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05830}05830           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05831}05831           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05832}05832         \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05833}05833           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05834}05834           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05835}05835         \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05836}05836           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05837}05837           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05838}05838         \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05839}05839           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05840}05840           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05841}05841         \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05842}05842           this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05843}05843           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05844}05844         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05845}05845           std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05846}05846           error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05847}05847           error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05848}05848           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05849}05849                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05850}05850                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05851}05851       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05852}05852     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05853}05853   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05854}05854 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05855}05855   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05856}05856 \textcolor{comment}{  /// Check the father element for any required nodes which}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05857}05857 \textcolor{comment}{  /// already exist}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05858}05858 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05859}05859   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05860}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a0a33f7ff9512b1adce3cbd22fcf7468c}{05860}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::pre\_build}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05861}05861     \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}\& new\_node\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05862}05862   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05863}05863     \textcolor{keyword}{using namespace }OcTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05864}05864 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05865}05865     \textcolor{comment}{// Get the number of 1d nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05866}05866     \textcolor{keywordtype}{unsigned} n\_p = nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05867}05867 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05868}05868     \textcolor{comment}{// Check whether static father\_bound needs to be created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05869}05869     \textcolor{keywordflow}{if} (Father\_bound[n\_p].nrow() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05870}05870     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05871}05871       setup\_father\_bounds();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05872}05872     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05873}05873 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05874}05874     \textcolor{comment}{// Pointer to my father (in quadtree impersonation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05875}05875     \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* father\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}*\textcolor{keyword}{>}(octree\_pt()-\/>father\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05876}05876 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05877}05877     \textcolor{comment}{// What type of son am I? Ask my quadtree representation...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05878}05878     \textcolor{keywordtype}{int} son\_type = Tree\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7537f8fe7c896d2220eb2da03567b34d}{son\_type}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05879}05879 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05880}05880     \textcolor{comment}{// Has somebody build me already? (If any nodes have not been built)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05881}05881     \textcolor{keywordflow}{if} (!nodes\_built())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05882}05882     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05883}05883 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05884}05884       \textcolor{keywordflow}{if} (father\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05885}05885       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05886}05886         \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05887}05887           \textcolor{stringliteral}{"{}Something fishy here: I have no father and yet \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05888}05888         error\_message += \textcolor{stringliteral}{"{}I have no nodes. Who has created me then?!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05889}05889 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05890}05890         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05891}05891           error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05892}05892           \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::pre\_build()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05893}05893           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05894}05894       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05895}05895 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05896}05896 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05897}05897       \textcolor{comment}{// Return pointer to father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05898}05898       \mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}* father\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05899}05899         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(father\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05900}05900 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05901}05901       \textcolor{comment}{// Timestepper should be the same for all nodes in father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05902}05902       \textcolor{comment}{// element -\/-\/ use it create timesteppers for new nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05903}05903       \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05904}05904         father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1Data_a065d7bffcec82bf4d4bd7b41f9aa80b3}{time\_stepper\_pt}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05905}05905 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05906}05906       \textcolor{comment}{// Number of history values (incl. present)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05907}05907       \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>ntstorage();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05908}05908 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05909}05909 \textcolor{comment}{      /// / Pass pointer to time object:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05910}05910 \textcolor{comment}{}      \textcolor{comment}{// this-\/>time\_pt()=father\_el\_pt-\/>time\_pt();}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05911}05911 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05912}05912       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05913}05913       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05914}05914       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05915}05915       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05916}05916 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05917}05917       \textcolor{comment}{// Setup vertex coordinates in father element:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05918}05918       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05919}05919       \textcolor{keywordflow}{switch} (son\_type)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05920}05920       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05921}05921         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{LDB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05922}05922           s\_lo[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05923}05923           s\_hi[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05924}05924           s\_lo[1] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05925}05925           s\_hi[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05926}05926           s\_lo[2] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05927}05927           s\_hi[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05928}05928           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05929}05929 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05930}05930         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{LDF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05931}05931           s\_lo[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05932}05932           s\_hi[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05933}05933           s\_lo[1] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05934}05934           s\_hi[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05935}05935           s\_lo[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05936}05936           s\_hi[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05937}05937           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05938}05938 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05939}05939         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{LUB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05940}05940           s\_lo[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05941}05941           s\_hi[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05942}05942           s\_lo[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05943}05943           s\_hi[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05944}05944           s\_lo[2] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05945}05945           s\_hi[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05946}05946           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05947}05947 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05948}05948         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{LUF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05949}05949           s\_lo[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05950}05950           s\_hi[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05951}05951           s\_lo[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05952}05952           s\_hi[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05953}05953           s\_lo[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05954}05954           s\_hi[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05955}05955           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05956}05956 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05957}05957         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{RDB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05958}05958           s\_lo[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05959}05959           s\_hi[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05960}05960           s\_lo[1] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05961}05961           s\_hi[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05962}05962           s\_lo[2] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05963}05963           s\_hi[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05964}05964           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05965}05965 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05966}05966         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{RDF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05967}05967           s\_lo[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05968}05968           s\_hi[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05969}05969           s\_lo[1] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05970}05970           s\_hi[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05971}05971           s\_lo[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05972}05972           s\_hi[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05973}05973           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05974}05974 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05975}05975         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{RUB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05976}05976           s\_lo[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05977}05977           s\_hi[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05978}05978           s\_lo[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05979}05979           s\_hi[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05980}05980           s\_lo[2] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05981}05981           s\_hi[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05982}05982           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05983}05983 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05984}05984         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{RUF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05985}05985           s\_lo[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05986}05986           s\_hi[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05987}05987           s\_lo[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05988}05988           s\_hi[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05989}05989           s\_lo[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05990}05990           s\_hi[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05991}05991           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05992}05992       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05993}05993 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05994}05994 \textcolor{comment}{      /// / Pass macro element pointer on to sons and}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05995}05995 \textcolor{comment}{      /// / set coordinates in macro element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05996}05996 \textcolor{comment}{      /// / hierher why can I see this?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05997}05997 \textcolor{comment}{}      \textcolor{comment}{// if(father\_el\_pt-\/>macro\_elem\_pt()!=0)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05998}05998       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l05999}05999       \textcolor{comment}{//  set\_macro\_elem\_pt(father\_el\_pt-\/>macro\_elem\_pt());}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06000}06000       \textcolor{comment}{//  for(unsigned i=0;i<2;i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06001}06001       \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06002}06002       \textcolor{comment}{//    s\_macro\_ll(i)=      father\_el\_pt-\/>s\_macro\_ll(i)+}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06003}06003       \textcolor{comment}{//     0.5*(s\_lo[i]+1.0)*(father\_el\_pt-\/>s\_macro\_ur(i)-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06004}06004       \textcolor{comment}{//                        father\_el\_pt-\/>s\_macro\_ll(i));}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06005}06005       \textcolor{comment}{//    s\_macro\_ur(i)=      father\_el\_pt-\/>s\_macro\_ll(i)+}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06006}06006       \textcolor{comment}{//     0.5*(s\_hi[i]+1.0)*(father\_el\_pt-\/>s\_macro\_ur(i)-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06007}06007       \textcolor{comment}{//                        father\_el\_pt-\/>s\_macro\_ll(i));}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06008}06008       \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06009}06009       \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06010}06010 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06011}06011 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06012}06012       \textcolor{comment}{// If the father element hasn't been generated yet, we're stuck...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06013}06013       \textcolor{keywordflow}{if} (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0) == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06014}06014       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06015}06015         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06016}06016           \textcolor{stringliteral}{"{}Trouble: father\_el\_pt-\/>node\_pt(0)==0\(\backslash\)n Can't build son element!\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06017}06017           \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::pre\_build()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06018}06018           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06019}06019       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06020}06020       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06021}06021       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06022}06022         \textcolor{keywordtype}{unsigned} jnod = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06023}06023 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06024}06024         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06025}06025         \textcolor{comment}{// Loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06026}06026         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06027}06027         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06028}06028           \textcolor{comment}{// Get the fractional position of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06029}06029           s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06030}06030           \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06031}06031           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_lo[0] + (s\_hi[0] -\/ s\_lo[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06032}06032 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06033}06033           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < n\_p; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06034}06034           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06035}06035             \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06036}06036             s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06037}06037             \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06038}06038             \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = s\_lo[1] + (s\_hi[1] -\/ s\_lo[1]) * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06039}06039 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06040}06040             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i2 = 0; i2 < n\_p; i2++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06041}06041             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06042}06042               \textcolor{comment}{// Get the fractional position of the node in the direction of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06043}06043               \textcolor{comment}{// s[2]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06044}06044               s\_fraction[2] = this-\/>local\_one\_d\_fraction\_of\_node(i2, 2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06045}06045               \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06046}06046               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = s\_lo[2] + (s\_hi[2] -\/ s\_lo[2]) * s\_fraction[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06047}06047 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06048}06048               \textcolor{comment}{// Local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06049}06049               jnod = i0 + n\_p * i1 + n\_p * n\_p * i2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06050}06050 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06051}06051               \textcolor{comment}{// Get the pointer to the node in the father, returns NULL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06052}06052               \textcolor{comment}{// if there is not node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06053}06053               \mbox{\hyperlink{classoomph_1_1Node}{Node}}* created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06054}06054                 father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ddbb05c5f8bb35b64bec287d653105c}{get\_node\_at\_local\_coordinate}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06055}06055 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06056}06056               \textcolor{comment}{// Does this node already exist in father element?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06057}06057               \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06058}06058               \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06059}06059               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06060}06060                 \textcolor{comment}{// Copy node across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06061}06061                 this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06062}06062 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06063}06063                 \textcolor{comment}{// Make sure that we update the values at the node so that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06064}06064                 \textcolor{comment}{// they are consistent with the present representation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06065}06065                 \textcolor{comment}{// This is only need for mixed interpolation where the value}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06066}06066                 \textcolor{comment}{// at the father could now become active.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06067}06067 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06068}06068                 \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06069}06069                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06070}06070                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06071}06071                   \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06072}06072                   \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06073}06073                   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06074}06074                   father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06075}06075                   \textcolor{comment}{// Find the minimum number of values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06076}06076                   \textcolor{comment}{//(either those stored at the node, or those returned by}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06077}06077                   \textcolor{comment}{// the function)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06078}06078                   \textcolor{keywordtype}{unsigned} n\_val\_at\_node = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06079}06079                   \textcolor{keywordtype}{unsigned} n\_val\_from\_function = prev\_values.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06080}06080                   \textcolor{comment}{// Use the ternary conditional operator here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06081}06081                   \textcolor{keywordtype}{unsigned} n\_var = n\_val\_at\_node < n\_val\_from\_function ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06082}06082                                      n\_val\_at\_node :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06083}06083                                      n\_val\_from\_function;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06084}06084                   \textcolor{comment}{// Assign the values that we can}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06085}06085                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_var; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06086}06086                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06087}06087                     created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06088}06088                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06089}06089                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06090}06090               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06091}06091             \} \textcolor{comment}{// End of loop i2}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06092}06092           \} \textcolor{comment}{// End of loop i1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06093}06093         \} \textcolor{comment}{// End of loop i0}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06094}06094       \} \textcolor{comment}{// Sanity check: Father element has been generated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06095}06095 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06096}06096     \} \textcolor{comment}{// End of nodes not built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06097}06097   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06098}06098 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06099}06099   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06100}06100 \textcolor{comment}{  /// p-\/refine the element inc times. (If inc<0 then p-\/unrefinement}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06101}06101 \textcolor{comment}{  /// is performed.)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06102}06102 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06103}06103   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06104}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a27dcd49d1188203b52a0c482a5466ba6}{06104}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::p\_refine}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06105}06105     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& inc, \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}* \textcolor{keyword}{const}\& mesh\_pt, \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const}\& clone\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06106}06106   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06107}06107     \textcolor{comment}{// Number of dimensions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06108}06108     \textcolor{keywordtype}{unsigned} n\_dim = 3;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06109}06109 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06110}06110     \textcolor{comment}{// Cast clone to correct type}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06111}06111     \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}* clone\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06112}06112       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(clone\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06113}06113 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06114}06114     \textcolor{comment}{// Check if we can use it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06115}06115     \textcolor{keywordflow}{if} (clone\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06116}06116     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06117}06117       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06118}06118         \textcolor{stringliteral}{"{}Cloned copy must be a PRefineableQElement<3,INITIAL\_NNODE\_1D>!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06119}06119         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06120}06120         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06121}06121     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06122}06122 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06123}06123     \textcolor{comment}{// Clone exists, so check that it is infact a copy of me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06124}06124     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06125}06125     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06126}06126       \textcolor{comment}{// Flag to keep track of check}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06127}06127       \textcolor{keywordtype}{bool} clone\_is\_ok = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06128}06128 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06129}06129       \textcolor{comment}{// Does the clone have the correct p-\/order?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06130}06130       clone\_is\_ok = clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}() == this-\/>p\_order());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06131}06131 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06132}06132       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06133}06133       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06134}06134         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06135}06135         err\_stream << \textcolor{stringliteral}{"{}Clone element has a different p-\/order from me,"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06136}06136                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06137}06137                    << \textcolor{stringliteral}{"{}but it is supposed to be a copy!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06138}06138 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06139}06139         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06140}06140           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06141}06141       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06142}06142 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06143}06143       \textcolor{comment}{// Does the clone have the same number of nodes as me?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06144}06144       clone\_is\_ok = clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}() == this-\/>nnode());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06145}06145 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06146}06146       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06147}06147       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06148}06148         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06149}06149         err\_stream << \textcolor{stringliteral}{"{}Clone element has a different number of nodes from me,"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06150}06150                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06151}06151                    << \textcolor{stringliteral}{"{}but it is supposed to be a copy!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06152}06152 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06153}06153         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06154}06154           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06155}06155       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06156}06156 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06157}06157       \textcolor{comment}{// Does the clone have the same nodes as me?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06158}06158       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < this-\/>nnode(); n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06159}06159       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06160}06160         clone\_is\_ok =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06161}06161           clone\_is\_ok \&\& (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(n) == this-\/>node\_pt(n));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06162}06162       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06163}06163 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06164}06164       \textcolor{keywordflow}{if} (!clone\_is\_ok)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06165}06165       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06166}06166         std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06167}06167         err\_stream << \textcolor{stringliteral}{"{}The nodes belonging to the clone element are different"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06168}06168                    << std::endl}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06169}06169                    << \textcolor{stringliteral}{"{}from mine, but it is supposed to be a copy!"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06170}06170                    << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06171}06171 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06172}06172         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06173}06173           err\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06174}06174       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06175}06175 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06176}06176       \textcolor{comment}{// If we get to here then the clone has all the information we require}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06177}06177     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06178}06178 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06179}06179 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06180}06180     \textcolor{comment}{// Currently we can't handle the case of generalised coordinates}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06181}06181     \textcolor{comment}{// since we haven't established how they should be interpolated.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06182}06182     \textcolor{comment}{// Buffer this case:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06183}06183     \textcolor{keywordflow}{if} (clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1Node_aee6f2b7a46fc9d875c6736895d7fc095}{nposition\_type}}() != 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06184}06184     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06185}06185       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Can't handle generalised nodal positions (yet)."{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06186}06186                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06187}06187                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06188}06188     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06189}06189 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06190}06190     \textcolor{comment}{// Timestepper should be the same for all nodes -\/-\/ use it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06191}06191     \textcolor{comment}{// to create timesteppers for new nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06192}06192     \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = this-\/>node\_pt(0)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06193}06193 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06194}06194     \textcolor{comment}{// Get number of history values (incl. present)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06195}06195     \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06196}06196 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06197}06197     \textcolor{comment}{// Increment p-\/order of the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06198}06198     this-\/>P\_order += inc;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06199}06199 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06200}06200     \textcolor{comment}{// Change integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06201}06201     \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06202}06202     \textcolor{keywordflow}{switch} (this-\/>P\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06203}06203     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06204}06204       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06205}06205         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06206}06206         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06207}06207       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06208}06208         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06209}06209         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06210}06210       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06211}06211         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06212}06212         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06213}06213       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06214}06214         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06215}06215         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06216}06216       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06217}06217         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06218}06218         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06219}06219       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06220}06220         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06221}06221         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06222}06222       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06223}06223         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06224}06224         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06225}06225         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06226}06226         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06227}06227                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06228}06228                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06229}06229     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06230}06230 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06231}06231     \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06232}06232     this-\/>set\_n\_node(this-\/>P\_order * this-\/>P\_order * this-\/>P\_order);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06233}06233 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06234}06234     \textcolor{comment}{// Copy vertex nodes and create new edge and internal nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06235}06235     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06236}06236 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06237}06237     \textcolor{comment}{// Setup vertex coordinates in element:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06238}06238     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06239}06239     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06240}06240     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06241}06241     s\_lo[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06242}06242     s\_hi[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06243}06243     s\_lo[1] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06244}06244     s\_hi[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06245}06245     s\_lo[2] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06246}06246     s\_hi[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06247}06247 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06248}06248     \textcolor{comment}{// Local coordinate in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06249}06249     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06250}06250 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06251}06251     \textcolor{keywordtype}{unsigned} jnod = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06252}06252 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06253}06253     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06254}06254     \textcolor{comment}{// Loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06255}06255     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < this-\/>P\_order; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06256}06256     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06257}06257       \textcolor{comment}{// Get the fractional position of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06258}06258       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06259}06259       \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06260}06260       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_lo[0] + (s\_hi[0] -\/ s\_lo[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06261}06261 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06262}06262       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < this-\/>P\_order; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06263}06263       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06264}06264         \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06265}06265         s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06266}06266         \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06267}06267         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = s\_lo[1] + (s\_hi[1] -\/ s\_lo[1]) * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06268}06268 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06269}06269         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i2 = 0; i2 < this-\/>P\_order; i2++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06270}06270         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06271}06271           \textcolor{comment}{// Get the fractional position of the node in the direction of s[2]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06272}06272           s\_fraction[2] = this-\/>local\_one\_d\_fraction\_of\_node(i2, 2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06273}06273           \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06274}06274           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = s\_lo[2] + (s\_hi[2] -\/ s\_lo[2]) * s\_fraction[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06275}06275 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06276}06276           \textcolor{comment}{// Local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06277}06277           jnod = i0 + this-\/>P\_order * i1 + this-\/>P\_order * this-\/>P\_order * i2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06278}06278 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06279}06279           \textcolor{comment}{// Initialise flag: So far, this node hasn't been built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06280}06280           \textcolor{comment}{// or copied yet}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06281}06281           \textcolor{keywordtype}{bool} node\_done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06282}06282 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06283}06283           \textcolor{comment}{// Get the pointer to the node in this element (or rather, its clone),}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06284}06284           \textcolor{comment}{// returns NULL if there is not node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06285}06285           \mbox{\hyperlink{classoomph_1_1Node}{Node}}* created\_node\_pt = clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_ad641bd9cd4e858dfa97a8d59eebea354}{get\_node\_at\_local\_coordinate}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06286}06286           \textcolor{comment}{// created\_node\_pt = 0;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06287}06287 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06288}06288           \textcolor{comment}{// Does this node already exist in this element?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06289}06289           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06290}06290           \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06291}06291           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06292}06292             \textcolor{comment}{// Copy node across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06293}06293             this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06294}06294 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06295}06295             \textcolor{comment}{// Make sure that we update the values at the node so that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06296}06296             \textcolor{comment}{// they are consistent with the present representation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06297}06297             \textcolor{comment}{// This is only need for mixed interpolation where the value}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06298}06298             \textcolor{comment}{// at the father could now become active.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06299}06299 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06300}06300             \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06301}06301             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06302}06302             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06303}06303               \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06304}06304               \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06305}06305               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06306}06306               clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06307}06307               \textcolor{comment}{// Find the minimum number of values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06308}06308               \textcolor{comment}{//(either those stored at the node, or those returned by}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06309}06309               \textcolor{comment}{// the function)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06310}06310               \textcolor{keywordtype}{unsigned} n\_val\_at\_node = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06311}06311               \textcolor{keywordtype}{unsigned} n\_val\_from\_function = prev\_values.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06312}06312               \textcolor{comment}{// Use the ternary conditional operator here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06313}06313               \textcolor{keywordtype}{unsigned} n\_var = n\_val\_at\_node < n\_val\_from\_function ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06314}06314                                  n\_val\_at\_node :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06315}06315                                  n\_val\_from\_function;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06316}06316               \textcolor{comment}{// Assign the values that we can}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06317}06317               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_var; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06318}06318               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06319}06319                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06320}06320               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06321}06321             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06322}06322 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06323}06323             \textcolor{comment}{// Node has been created by copy}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06324}06324             node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06325}06325           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06326}06326           \textcolor{comment}{// Node does not exist in this element but might already}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06327}06327           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06328}06328           \textcolor{comment}{// have been created by neighbouring elements}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06329}06329           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06330}06330           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06331}06331           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06332}06332             \textcolor{comment}{// Was the node created by one of its neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06333}06333             \textcolor{comment}{// Whether or not the node lies on an edge can be calculated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06334}06334             \textcolor{comment}{// by from the fractional position}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06335}06335             \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06336}06336             created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06337}06337               this-\/>node\_created\_by\_neighbour(s\_fraction, is\_periodic);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06338}06338 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06339}06339             \textcolor{comment}{// If the node was so created, assign the pointers}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06340}06340             \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06341}06341             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06342}06342               \textcolor{comment}{// If the node is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06343}06343               \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06344}06344               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06345}06345                 \textcolor{comment}{// Now the node must be on a boundary, but we don't know which}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06346}06346                 \textcolor{comment}{// one}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06347}06347                 \textcolor{comment}{// The returned created\_node\_pt is actually the neighbouring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06348}06348                 \textcolor{comment}{// periodic node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06349}06349                 \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06350}06350 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06351}06351                 \textcolor{comment}{// Determine the edge on which the new node will live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06352}06352                 \textcolor{comment}{//(cannot be a vertex node)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06353}06353                 \textcolor{keywordtype}{int} my\_bound = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06354}06354                 \textcolor{comment}{// If we are on the left face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06355}06355                 \textcolor{keywordflow}{if} (i0 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06356}06356                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06357}06357                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06358}06358                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06359}06359                 \textcolor{comment}{// If we are on the right face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06360}06360                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i0 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06361}06361                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06362}06362                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06363}06363                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06364}06364 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06365}06365                 \textcolor{comment}{// If we are on the bottom face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06366}06366                 \textcolor{keywordflow}{if} (i1 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06367}06367                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06368}06368                   \textcolor{comment}{// If we already have already set the boundary, we're on an}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06369}06369                   \textcolor{comment}{// edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06370}06370                   \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06371}06371                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06372}06372                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06373}06373                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06374}06374                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06375}06375                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06376}06376                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06377}06377                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06378}06378                     \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06379}06379                     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06380}06380                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06381}06381                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06382}06382                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06383}06383                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06384}06384                 \textcolor{comment}{// If we are the top face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06385}06385                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i1 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06386}06386                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06387}06387                   \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06388}06388                   \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06389}06389                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06390}06390                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06391}06391                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06392}06392                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06393}06393                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06394}06394                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06395}06395                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06396}06396                     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06397}06397                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06398}06398                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06399}06399                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06400}06400                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06401}06401 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06402}06402                 \textcolor{comment}{// If we are on the back face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06403}06403                 \textcolor{keywordflow}{if} (i2 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06404}06404                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06405}06405                   \textcolor{comment}{// If we already have already set the boundary, we're on an}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06406}06406                   \textcolor{comment}{// edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06407}06407                   \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06408}06408                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06409}06409                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06410}06410                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{OcTreeNames::LB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06411}06411                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06412}06412                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06413}06413                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06414}06414                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06415}06415                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06416}06416                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06417}06417                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06418}06418                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06419}06419                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{OcTreeNames::RB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06420}06420                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06421}06421                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06422}06422                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06423}06423                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06424}06424                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06425}06425                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06426}06426                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06427}06427                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06428}06428                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{OcTreeNames::DB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06429}06429                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06430}06430                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06431}06431                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{OcTreeNames::UB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06432}06432                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06433}06433                     \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06434}06434                     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06435}06435                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{OcTreeNames::B}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06436}06436                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06437}06437                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06438}06438                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06439}06439                 \textcolor{comment}{// If we are the front face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06440}06440                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i2 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06441}06441                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06442}06442                   \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06443}06443                   \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06444}06444                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06445}06445                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06446}06446                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{OcTreeNames::LF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06447}06447                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06448}06448                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06449}06449                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06450}06450                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06451}06451                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06452}06452                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06453}06453                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06454}06454                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06455}06455                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{OcTreeNames::RF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06456}06456                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06457}06457                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06458}06458                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06459}06459                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06460}06460                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06461}06461                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06462}06462                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06463}06463                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06464}06464                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{OcTreeNames::DF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06465}06465                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06466}06466                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06467}06467                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{OcTreeNames::UF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06468}06468                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06469}06469                     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06470}06470                       my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{OcTreeNames::F}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06471}06471                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06472}06472                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06473}06473                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06474}06474 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06475}06475                 \textcolor{comment}{// Storage for the set of Mesh boundaries on which the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06476}06476                 \textcolor{comment}{// appropriate edge lives.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06477}06477                 \textcolor{comment}{// [New nodes should always be mid-\/edge nodes and therefore}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06478}06478                 \textcolor{comment}{// only live on one boundary but just to play it safe...]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06479}06479                 std::set<unsigned> boundaries;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06480}06480                 \textcolor{comment}{// Only get the boundaries if we are at the edge of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06481}06481                 \textcolor{comment}{// an element. Nodes in the centre of an element cannot be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06482}06482                 \textcolor{comment}{// on Mesh boundaries}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06483}06483                 \textcolor{keywordflow}{if} (my\_bound != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06484}06484                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06485}06485                   clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_ac61083ce6abe6338ec5d7795d9f1e051}{get\_boundaries}}(my\_bound, boundaries);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06486}06486                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06487}06487 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06488}06488 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06489}06489                 \textcolor{comment}{// Case where a new node lives on more than one boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06490}06490                 \textcolor{comment}{// seems fishy enough to flag}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06491}06491                 \textcolor{keywordflow}{if} (boundaries.size() > 2)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06492}06492                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06493}06493                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06494}06494                     \textcolor{stringliteral}{"{}boundaries.size()>2 seems a bit strange..\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06495}06495                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06496}06496                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06497}06497                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06498}06498 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06499}06499                 \textcolor{comment}{// Case when there are no boundaries, we are in big trouble}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06500}06500                 \textcolor{keywordflow}{if} (boundaries.size() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06501}06501                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06502}06502                   std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06503}06503                   error\_stream << \textcolor{stringliteral}{"{}Periodic node is not on a boundary...\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06504}06504                                << \textcolor{stringliteral}{"{}Coordinates: "{}} << created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06505}06505                                << \textcolor{stringliteral}{"{} "{}} << created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06506}06506                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06507}06507                                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06508}06508                                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06509}06509                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06510}06510 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06511}06511 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06512}06512                 \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06513}06513                 created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06514}06514                   this-\/>construct\_boundary\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06515}06515                 \textcolor{comment}{// Make the node periodic from the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06516}06516                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_aeb07848c19b83fd8b9690b8fcc200d56}{make\_periodic}}(neighbour\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06517}06517 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06518}06518                 \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06519}06519                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06520}06520                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06521}06521                   \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06522}06522                   \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06523}06523                   \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06524}06524                   \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06525}06525                   \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06526}06526                   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(n\_dim, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06527}06527                   clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06528}06528                   \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06529}06529                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06530}06530                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06531}06531                     created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06532}06532                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06533}06533                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06534}06534 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06535}06535                 \textcolor{comment}{// Check if we need to add nodes to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06536}06536                 \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06537}06537                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06538}06538                   \textcolor{comment}{// Next, we Update the boundary lookup schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06539}06539                   \textcolor{comment}{// Loop over the boundaries stored in the set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06540}06540                   \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries.begin();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06541}06541                        it != boundaries.end();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06542}06542                        ++it)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06543}06543                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06544}06544                     \textcolor{comment}{// Add the node to the boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06545}06545                     mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(*it, created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06546}06546 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06547}06547                     \textcolor{comment}{// If we have set an intrinsic coordinate on this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06548}06548                     \textcolor{comment}{// mesh boundary then it must also be interpolated on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06549}06549                     \textcolor{comment}{// the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06550}06550                     \textcolor{comment}{// Now interpolate the intrinsic boundary coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06551}06551                     \textcolor{keywordflow}{if} (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad1b124a959628aba00162b89617b3a62}{boundary\_coordinate\_exists}}(*it) == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06552}06552                     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06553}06553                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(2, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06554}06554                       clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_aa0feadb4fbbe8861366a77373b122293}{interpolated\_zeta\_on\_face}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06555}06555                         *it, my\_bound, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06556}06556 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06557}06557                       created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a94c19e165ab4e88aabbfa27443c530b7}{set\_coordinates\_on\_boundary}}(*it, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06558}06558                     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06559}06559                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06560}06560 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06561}06561                   \textcolor{comment}{// Make sure that we add the node to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06562}06562                   mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06563}06563                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06564}06564               \} \textcolor{comment}{// End of periodic case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06565}06565               \textcolor{comment}{// Otherwise the node is not periodic, so just set the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06566}06566               \textcolor{comment}{// pointer to the neighbours node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06567}06567               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06568}06568               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06569}06569                 this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06570}06570               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06571}06571               \textcolor{comment}{// Node has been created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06572}06572               node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06573}06573             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06574}06574             \textcolor{comment}{// Node does not exist in neighbour element but might already}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06575}06575             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06576}06576             \textcolor{comment}{// have been created by a son of a neighbouring element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06577}06577             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06578}06578             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06579}06579             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06580}06580               \textcolor{comment}{// Was the node created by one of its neighbours' sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06581}06581               \textcolor{comment}{// Whether or not the node lies on an edge can be calculated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06582}06582               \textcolor{comment}{// by from the fractional position}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06583}06583               \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06584}06584               created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06585}06585                 this-\/>node\_created\_by\_son\_of\_neighbour(s\_fraction, is\_periodic);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06586}06586 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06587}06587               \textcolor{comment}{// If the node was so created, assign the pointers}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06588}06588               \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06589}06589               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06590}06590                 \textcolor{comment}{// If the node is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06591}06591                 \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06592}06592                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06593}06593                   \textcolor{comment}{// Now the node must be on a boundary, but we don't know which}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06594}06594                   \textcolor{comment}{// one}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06595}06595                   \textcolor{comment}{// The returned created\_node\_pt is actually the neighbouring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06596}06596                   \textcolor{comment}{// periodic node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06597}06597                   \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06598}06598 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06599}06599                   \textcolor{comment}{// Determine the edge on which the new node will live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06600}06600                   \textcolor{comment}{//(cannot be a vertex node)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06601}06601                   \textcolor{keywordtype}{int} my\_bound = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06602}06602                   \textcolor{comment}{// If we are on the left face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06603}06603                   \textcolor{keywordflow}{if} (i0 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06604}06604                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06605}06605                     my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06606}06606                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06607}06607                   \textcolor{comment}{// If we are on the right face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06608}06608                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i0 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06609}06609                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06610}06610                     my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06611}06611                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06612}06612 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06613}06613                   \textcolor{comment}{// If we are on the bottom face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06614}06614                   \textcolor{keywordflow}{if} (i1 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06615}06615                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06616}06616                     \textcolor{comment}{// If we already have already set the boundary, we're on an}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06617}06617                     \textcolor{comment}{// edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06618}06618                     \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06619}06619                     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06620}06620                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06621}06621                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06622}06622                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06623}06623                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06624}06624                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06625}06625                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06626}06626                       \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06627}06627                       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06628}06628                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06629}06629                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06630}06630                     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06631}06631                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06632}06632                   \textcolor{comment}{// If we are the top face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06633}06633                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i1 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06634}06634                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06635}06635                     \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06636}06636                     \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06637}06637                     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06638}06638                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06639}06639                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06640}06640                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06641}06641                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06642}06642                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06643}06643                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06644}06644                       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06645}06645                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06646}06646                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06647}06647                     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06648}06648                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06649}06649 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06650}06650                   \textcolor{comment}{// If we are on the back face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06651}06651                   \textcolor{keywordflow}{if} (i2 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06652}06652                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06653}06653                     \textcolor{comment}{// If we already have already set the boundary, we're on an}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06654}06654                     \textcolor{comment}{// edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06655}06655                     \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06656}06656                     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06657}06657                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06658}06658                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{OcTreeNames::LB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06659}06659                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06660}06660                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06661}06661                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06662}06662                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06663}06663                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06664}06664                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06665}06665                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06666}06666                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06667}06667                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{OcTreeNames::RB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06668}06668                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06669}06669                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06670}06670                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06671}06671                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06672}06672                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06673}06673                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06674}06674                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06675}06675                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06676}06676                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{OcTreeNames::DB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06677}06677                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06678}06678                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06679}06679                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{OcTreeNames::UB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06680}06680                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06681}06681                       \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06682}06682                       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06683}06683                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{OcTreeNames::B}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06684}06684                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06685}06685                     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06686}06686                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06687}06687                   \textcolor{comment}{// If we are the front face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06688}06688                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i2 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06689}06689                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06690}06690                     \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06691}06691                     \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06692}06692                     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06693}06693                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06694}06694                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{OcTreeNames::LF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06695}06695                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06696}06696                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06697}06697                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06698}06698                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06699}06699                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06700}06700                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06701}06701                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06702}06702                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06703}06703                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{OcTreeNames::RF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06704}06704                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06705}06705                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06706}06706                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06707}06707                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06708}06708                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06709}06709                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06710}06710                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06711}06711                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06712}06712                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{OcTreeNames::DF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06713}06713                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06714}06714                       \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06715}06715                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{OcTreeNames::UF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06716}06716                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06717}06717                       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06718}06718                         my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{OcTreeNames::F}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06719}06719                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06720}06720                     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06721}06721                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06722}06722 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06723}06723                   \textcolor{comment}{// Storage for the set of Mesh boundaries on which the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06724}06724                   \textcolor{comment}{// appropriate edge lives.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06725}06725                   \textcolor{comment}{// [New nodes should always be mid-\/edge nodes and therefore}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06726}06726                   \textcolor{comment}{// only live on one boundary but just to play it safe...]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06727}06727                   std::set<unsigned> boundaries;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06728}06728                   \textcolor{comment}{// Only get the boundaries if we are at the edge of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06729}06729                   \textcolor{comment}{// an element. Nodes in the centre of an element cannot be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06730}06730                   \textcolor{comment}{// on Mesh boundaries}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06731}06731                   \textcolor{keywordflow}{if} (my\_bound != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06732}06732                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06733}06733                     clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_ac61083ce6abe6338ec5d7795d9f1e051}{get\_boundaries}}(my\_bound, boundaries);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06734}06734                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06735}06735 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06736}06736 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06737}06737                   \textcolor{comment}{// Case where a new node lives on more than one boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06738}06738                   \textcolor{comment}{// seems fishy enough to flag}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06739}06739                   \textcolor{keywordflow}{if} (boundaries.size() > 2)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06740}06740                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06741}06741                     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06742}06742                       \textcolor{stringliteral}{"{}boundaries.size()>2 seems a bit strange..\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06743}06743                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06744}06744                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06745}06745                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06746}06746 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06747}06747                   \textcolor{comment}{// Case when there are no boundaries, we are in big trouble}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06748}06748                   \textcolor{keywordflow}{if} (boundaries.size() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06749}06749                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06750}06750                     std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06751}06751                     error\_stream << \textcolor{stringliteral}{"{}Periodic node is not on a boundary...\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06752}06752                                  << \textcolor{stringliteral}{"{}Coordinates: "{}} << created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06753}06753                                  << \textcolor{stringliteral}{"{} "{}} << created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06754}06754                     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06755}06755                                         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06756}06756                                         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06757}06757                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06758}06758 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06759}06759 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06760}06760                   \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06761}06761                   created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06762}06762                     this-\/>construct\_boundary\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06763}06763                   \textcolor{comment}{// Make the node periodic from the neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06764}06764                   created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_aeb07848c19b83fd8b9690b8fcc200d56}{make\_periodic}}(neighbour\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06765}06765 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06766}06766                   \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06767}06767                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06768}06768                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06769}06769                     \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06770}06770                     \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06771}06771                     \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06772}06772                     \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06773}06773                     \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06774}06774                     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(n\_dim);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06775}06775                     clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06776}06776                     \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06777}06777                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06778}06778                     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06779}06779                       created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06780}06780                     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06781}06781                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06782}06782 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06783}06783                   \textcolor{comment}{// Check if we need to add nodes to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06784}06784                   \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06785}06785                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06786}06786                     \textcolor{comment}{// Next, we Update the boundary lookup schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06787}06787                     \textcolor{comment}{// Loop over the boundaries stored in the set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06788}06788                     \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries.begin();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06789}06789                          it != boundaries.end();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06790}06790                          ++it)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06791}06791                     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06792}06792                       \textcolor{comment}{// Add the node to the boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06793}06793                       mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(*it, created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06794}06794 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06795}06795                       \textcolor{comment}{// If we have set an intrinsic coordinate on this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06796}06796                       \textcolor{comment}{// mesh boundary then it must also be interpolated on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06797}06797                       \textcolor{comment}{// the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06798}06798                       \textcolor{comment}{// Now interpolate the intrinsic boundary coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06799}06799                       \textcolor{keywordflow}{if} (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad1b124a959628aba00162b89617b3a62}{boundary\_coordinate\_exists}}(*it) == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06800}06800                       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06801}06801                         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(2, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06802}06802                         clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_aa0feadb4fbbe8861366a77373b122293}{interpolated\_zeta\_on\_face}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06803}06803                           *it, my\_bound, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06804}06804 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06805}06805                         created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a94c19e165ab4e88aabbfa27443c530b7}{set\_coordinates\_on\_boundary}}(*it, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06806}06806                       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06807}06807                     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06808}06808 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06809}06809                     \textcolor{comment}{// Make sure that we add the node to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06810}06810                     mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06811}06811                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06812}06812                 \} \textcolor{comment}{// End of periodic case}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06813}06813                 \textcolor{comment}{// Otherwise the node is not periodic, so just set the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06814}06814                 \textcolor{comment}{// pointer to the neighbours node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06815}06815                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06816}06816                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06817}06817                   this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06818}06818                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06819}06819                 \textcolor{comment}{// Node has been created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06820}06820                 node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06821}06821               \} \textcolor{comment}{// Node does not exist in son of neighbouring element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06822}06822             \} \textcolor{comment}{// Node does not exist in neighbouring element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06823}06823           \} \textcolor{comment}{// Node does not exist in this element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06824}06824 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06825}06825           \textcolor{comment}{// Node has not been built anywhere -\/-\/-\/> build it here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06826}06826           \textcolor{keywordflow}{if} (!node\_done)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06827}06827           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06828}06828             \textcolor{comment}{// Firstly, we need to determine whether or not a node lies}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06829}06829             \textcolor{comment}{// on the boundary before building it, because}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06830}06830             \textcolor{comment}{// we actually assign a different type of node on boundaries.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06831}06831 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06832}06832             \textcolor{comment}{// Initially none}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06833}06833             \textcolor{keywordtype}{int} my\_bound = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06834}06834             \textcolor{comment}{// If we are on the left face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06835}06835             \textcolor{keywordflow}{if} (i0 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06836}06836             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06837}06837               my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06838}06838             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06839}06839             \textcolor{comment}{// If we are on the right face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06840}06840             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i0 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06841}06841             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06842}06842               my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06843}06843             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06844}06844 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06845}06845             \textcolor{comment}{// If we are on the bottom face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06846}06846             \textcolor{keywordflow}{if} (i1 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06847}06847             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06848}06848               \textcolor{comment}{// If we already have already set the boundary, we're on an edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06849}06849               \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06850}06850               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06851}06851                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06852}06852                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06853}06853                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06854}06854                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06855}06855                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06856}06856                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06857}06857                 \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06858}06858                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06859}06859                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06860}06860                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06861}06861               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06862}06862             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06863}06863             \textcolor{comment}{// If we are the top face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06864}06864             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i1 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06865}06865             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06866}06866               \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06867}06867               \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06868}06868               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06869}06869                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06870}06870                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06871}06871                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06872}06872                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06873}06873                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06874}06874                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06875}06875                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06876}06876                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06877}06877                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06878}06878               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06879}06879             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06880}06880 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06881}06881             \textcolor{comment}{// If we are on the back face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06882}06882             \textcolor{keywordflow}{if} (i2 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06883}06883             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06884}06884               \textcolor{comment}{// If we already have already set the boundary, we're on an edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06885}06885               \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06886}06886               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06887}06887                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06888}06888                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{OcTreeNames::LB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06889}06889                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06890}06890                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06891}06891                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06892}06892                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06893}06893                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06894}06894                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06895}06895                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06896}06896                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06897}06897                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{OcTreeNames::RB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06898}06898                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06899}06899                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06900}06900                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06901}06901                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06902}06902                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06903}06903                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06904}06904                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06905}06905                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06906}06906                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{OcTreeNames::DB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06907}06907                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06908}06908                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06909}06909                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{OcTreeNames::UB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06910}06910                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06911}06911                 \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06912}06912                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06913}06913                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{OcTreeNames::B}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06914}06914                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06915}06915               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06916}06916             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06917}06917             \textcolor{comment}{// If we are the front face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06918}06918             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i2 == this-\/>P\_order -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06919}06919             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06920}06920               \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06921}06921               \textcolor{keywordflow}{switch} (my\_bound)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06922}06922               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06923}06923                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06924}06924                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{OcTreeNames::LF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06925}06925                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06926}06926                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06927}06927                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06928}06928                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06929}06929                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06930}06930                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06931}06931                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06932}06932                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06933}06933                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{OcTreeNames::RF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06934}06934                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06935}06935                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06936}06936                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06937}06937                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06938}06938                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06939}06939                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06940}06940                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06941}06941                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06942}06942                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{OcTreeNames::DF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06943}06943                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06944}06944                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06945}06945                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{OcTreeNames::UF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06946}06946                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06947}06947                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06948}06948                   my\_bound = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{OcTreeNames::F}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06949}06949                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06950}06950               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06951}06951             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06952}06952 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06953}06953             \textcolor{comment}{// Storage for the set of Mesh boundaries on which the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06954}06954             \textcolor{comment}{// appropriate edge lives.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06955}06955             \textcolor{comment}{// [New nodes should always be mid-\/edge nodes and therefore}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06956}06956             \textcolor{comment}{// only live on one boundary but just to play it safe...]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06957}06957             std::set<unsigned> boundaries;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06958}06958             \textcolor{comment}{// Only get the boundaries if we are at the edge of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06959}06959             \textcolor{comment}{// an element. Nodes in the centre of an element cannot be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06960}06960             \textcolor{comment}{// on Mesh boundaries}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06961}06961             \textcolor{keywordflow}{if} (my\_bound != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06962}06962               clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_ac61083ce6abe6338ec5d7795d9f1e051}{get\_boundaries}}(my\_bound, boundaries);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06963}06963 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06964}06964 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06965}06965             \textcolor{comment}{// Case where a new node lives on more than two boundaries}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06966}06966             \textcolor{comment}{// seems fishy enough to flag}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06967}06967             \textcolor{keywordflow}{if} (boundaries.size() > 2)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06968}06968             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06969}06969               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06970}06970                 \textcolor{stringliteral}{"{}boundaries.size()>2 seems a bit strange..\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06971}06971                 \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::p\_refine()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06972}06972                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06973}06973             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06974}06974 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06975}06975 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06976}06976             \textcolor{comment}{// If the node lives on a mesh boundary,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06977}06977             \textcolor{comment}{// then we need to create a boundary node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06978}06978             \textcolor{keywordflow}{if} (boundaries.size() > 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06979}06979             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06980}06980               \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06981}06981               created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06982}06982                 this-\/>construct\_boundary\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06983}06983 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06984}06984               \textcolor{comment}{// Now we need to work out whether to pin the values at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06985}06985               \textcolor{comment}{// the new node based on the boundary conditions applied at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06986}06986               \textcolor{comment}{// its Mesh boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06987}06987 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06988}06988               \textcolor{comment}{// Get the boundary conditions from the father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06989}06989               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} bound\_cons(this-\/>ncont\_interpolated\_values());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06990}06990               clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_aac2601ff8f740680675e5e6ba5c35e9d}{get\_bcs}}(my\_bound, bound\_cons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06991}06991 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06992}06992               \textcolor{comment}{// Loop over the values and pin, if necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06993}06993               \textcolor{keywordtype}{unsigned} n\_value = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06994}06994               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_value; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06995}06995               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06996}06996                 \textcolor{keywordflow}{if} (bound\_cons[k])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06997}06997                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06998}06998                   created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a422231c58e423f0b43822827aa334d79}{pin}}(k);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l06999}06999                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07000}07000               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07001}07001 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07002}07002               \textcolor{comment}{// Solid node? If so, deal with the positional boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07003}07003               \textcolor{comment}{// conditions:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07004}07004               \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07005}07005                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07006}07006               \textcolor{keywordflow}{if} (solid\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07007}07007               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07008}07008                 \textcolor{comment}{// Get the positional boundary conditions from the father:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07009}07009                 \textcolor{keywordtype}{unsigned} n\_dim = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a786c96a8e46eb27a03b2b31f629d41b3}{ndim}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07010}07010                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} solid\_bound\_cons(n\_dim);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07011}07011                 \mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_013_01_4}{RefineableSolidQElement<3>}}* clone\_solid\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07012}07012                   \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_013_01_4}{RefineableSolidQElement<3>}}*\textcolor{keyword}{>}(clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07013}07013 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07014}07014                 \textcolor{keywordflow}{if} (clone\_solid\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07015}07015                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07016}07016                   \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07017}07017                     \textcolor{stringliteral}{"{}We have a SolidNode outside a refineable SolidElement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07018}07018                   error\_message +=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07019}07019                     \textcolor{stringliteral}{"{}during mesh refinement -\/-\/ this doesn't make sense"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07020}07020 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07021}07021                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07022}07022                     error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07023}07023                     \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::p\_refine()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07024}07024                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07025}07025                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07026}07026 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07027}07027                 clone\_solid\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_013_01_4_a57590ae1b7cb21cc362a371eef096217}{get\_solid\_bcs}}(my\_bound, solid\_bound\_cons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07028}07028 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07029}07029                 \textcolor{comment}{// Loop over the positions and pin, if necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07030}07030                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dim; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07031}07031                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07032}07032                   \textcolor{keywordflow}{if} (solid\_bound\_cons[k])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07033}07033                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07034}07034                     solid\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_aa283a553b0141e859dd7b4f80bb88e6d}{pin\_position}}(k);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07035}07035                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07036}07036                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07037}07037               \} \textcolor{comment}{// End of if solid\_node\_pt}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07038}07038 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07039}07039               \textcolor{comment}{// Next, we Update the boundary lookup schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07040}07040 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07041}07041               \textcolor{comment}{// Check if we need to add nodes to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07042}07042               \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07043}07043               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07044}07044                 \textcolor{comment}{// Loop over the boundaries stored in the set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07045}07045                 \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries.begin();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07046}07046                      it != boundaries.end();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07047}07047                      ++it)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07048}07048                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07049}07049                   \textcolor{comment}{// Add the node to the boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07050}07050                   mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(*it, created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07051}07051 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07052}07052                   \textcolor{comment}{// If we have set an intrinsic coordinate on this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07053}07053                   \textcolor{comment}{// mesh boundary then it must also be interpolated on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07054}07054                   \textcolor{comment}{// the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07055}07055                   \textcolor{comment}{// Now interpolate the intrinsic boundary coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07056}07056                   \textcolor{keywordflow}{if} (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad1b124a959628aba00162b89617b3a62}{boundary\_coordinate\_exists}}(*it) == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07057}07057                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07058}07058                     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07059}07059                     clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_aa0feadb4fbbe8861366a77373b122293}{interpolated\_zeta\_on\_face}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07060}07060                       *it, my\_bound, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07061}07061 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07062}07062                     created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a94c19e165ab4e88aabbfa27443c530b7}{set\_coordinates\_on\_boundary}}(*it, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07063}07063                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07064}07064                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07065}07065               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07066}07066             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07067}07067             \textcolor{comment}{// Otherwise the node is not on a Mesh boundary and}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07068}07068             \textcolor{comment}{// we create a normal "{}bulk"{} node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07069}07069             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07070}07070             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07071}07071               \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07072}07072               created\_node\_pt = this-\/>construct\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07073}07073             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07074}07074 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07075}07075             \textcolor{comment}{// Now we set the position and values at the newly created node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07076}07076 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07077}07077             \textcolor{comment}{// In the first instance use macro element or FE representation}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07078}07078             \textcolor{comment}{// to create past and present nodal positions.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07079}07079             \textcolor{comment}{// (THIS STEP SHOULD NOT BE SKIPPED FOR ALGEBRAIC}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07080}07080             \textcolor{comment}{// ELEMENTS AS NOT ALL OF THEM NECESSARILY IMPLEMENT}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07081}07081             \textcolor{comment}{// NONTRIVIAL NODE UPDATE FUNCTIONS. CALLING}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07082}07082             \textcolor{comment}{// THE NODE UPDATE FOR SUCH ELEMENTS/NODES WILL LEAVE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07083}07083             \textcolor{comment}{// THEIR NODAL POSITIONS WHERE THEY WERE (THIS IS APPROPRIATE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07084}07084             \textcolor{comment}{// ONCE THEY HAVE BEEN GIVEN POSITIONS) BUT WILL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07085}07085             \textcolor{comment}{// NOT ASSIGN SENSIBLE INITIAL POSITONS!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07086}07086 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07087}07087             \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07088}07088             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07089}07089             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07090}07090               \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07091}07091               \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07092}07092               \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07093}07093               \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07094}07094               \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07095}07095               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07096}07096               clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07097}07097 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07098}07098               \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07099}07099               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07100}07100               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07101}07101                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07102}07102               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07103}07103             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07104}07104 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07105}07105             \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07106}07106             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07107}07107             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07108}07108               \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07109}07109               \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07110}07110               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07111}07111               clone\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07112}07112 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07113}07113               \textcolor{comment}{// Initialise the values at the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07114}07114               \textcolor{keywordtype}{unsigned} n\_value = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07115}07115               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_value; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07116}07116               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07117}07117                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07118}07118               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07119}07119             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07120}07120 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07121}07121             \textcolor{comment}{// Add new node to mesh (if requested)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07122}07122             \textcolor{keywordflow}{if} (mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07123}07123             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07124}07124               mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07125}07125             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07126}07126 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07127}07127             \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07128}07128               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07129}07129 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07130}07130             \textcolor{comment}{// If we do have an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07131}07131             \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07132}07132             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07133}07133               \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07134}07134                 \textcolor{stringliteral}{"{}Have not implemented p-\/refinement for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07135}07135               error\_message += \textcolor{stringliteral}{"{}Algebraic p-\/refineable elements yet\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07136}07136 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07137}07137               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07138}07138                 error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07139}07139                 \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::p\_refine()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07140}07140                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07141}07141             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07142}07142 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07143}07143           \} \textcolor{comment}{// End of case when we build the node ourselves}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07144}07144 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07145}07145           \textcolor{comment}{// Check if the element is an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07146}07146           \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07147}07147             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07148}07148 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07149}07149           \textcolor{comment}{// If the element is an algebraic element, setup}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07150}07150           \textcolor{comment}{// node position (past and present) from algebraic node update}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07151}07151           \textcolor{comment}{// function. This over-\/writes previous assingments that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07152}07152           \textcolor{comment}{// were made based on the macro-\/element/FE representation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07153}07153           \textcolor{comment}{// NOTE: YES, THIS NEEDS TO BE CALLED REPEATEDLY IF THE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07154}07154           \textcolor{comment}{// NODE IS MEMBER OF MULTIPLE ELEMENTS: THEY ALL ASSIGN}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07155}07155           \textcolor{comment}{// THE SAME NODAL POSITIONS BUT WE NEED TO ADD THE REMESH}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07156}07156           \textcolor{comment}{// INFO FOR *ALL* ROOT ELEMENTS!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07157}07157           \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07158}07158           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07159}07159             \textcolor{comment}{// Build algebraic node update info for new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07160}07160             \textcolor{comment}{// This sets up the node update data for all node update}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07161}07161             \textcolor{comment}{// functions that are shared by all nodes in the father}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07162}07162             \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07163}07163             alg\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase_ab9ada27015d5cb28ae00b086ace3600f}{setup\_algebraic\_node\_update}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07164}07164               this-\/>node\_pt(jnod), \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07165}07165           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07166}07166 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07167}07167         \} \textcolor{comment}{// End of vertical loop over nodes in element (i2)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07168}07168 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07169}07169       \} \textcolor{comment}{// End of horizontal loop over nodes in element (i1)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07170}07170 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07171}07171     \} \textcolor{comment}{// End of horizontal loop over nodes in element (i0)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07172}07172 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07173}07173 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07174}07174     \textcolor{comment}{// Loop over all nodes in element again, to re-\/set the positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07175}07175     \textcolor{comment}{// This must be done using the new element's macro-\/element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07176}07176     \textcolor{comment}{// representation, rather than the old version which may be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07177}07177     \textcolor{comment}{// of a different p-\/order!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07178}07178     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < this-\/>P\_order; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07179}07179     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07180}07180       \textcolor{comment}{// Get the fractional position of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07181}07181       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07182}07182       \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07183}07183       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_lo[0] + (s\_hi[0] -\/ s\_lo[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07184}07184 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07185}07185       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < this-\/>P\_order; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07186}07186       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07187}07187         \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07188}07188         s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07189}07189         \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07190}07190         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = s\_lo[1] + (s\_hi[1] -\/ s\_lo[1]) * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07191}07191 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07192}07192         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i2 = 0; i2 < this-\/>P\_order; i2++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07193}07193         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07194}07194           \textcolor{comment}{// Get the fractional position of the node in the direction of s[2]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07195}07195           s\_fraction[2] = this-\/>local\_one\_d\_fraction\_of\_node(i2, 2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07196}07196           \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07197}07197           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = s\_lo[2] + (s\_hi[2] -\/ s\_lo[2]) * s\_fraction[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07198}07198 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07199}07199           \textcolor{comment}{// Local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07200}07200           jnod = i0 + this-\/>P\_order * i1 + this-\/>P\_order * this-\/>P\_order * i2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07201}07201 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07202}07202           \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07203}07203           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07204}07204           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07205}07205             \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07206}07206             \textcolor{comment}{// element representation if appropriate. If the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07207}07207             \textcolor{comment}{// turns out to be a hanging node later on, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07208}07208             \textcolor{comment}{// its position gets adjusted in line with its}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07209}07209             \textcolor{comment}{// hanging node interpolation.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07210}07210             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07211}07211             this-\/>get\_x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07212}07212 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07213}07213             \textcolor{comment}{// Set previous positions of the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07214}07214             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07215}07215             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07216}07216               this-\/>node\_pt(jnod)-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07217}07217             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07218}07218           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07219}07219         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07220}07220       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07221}07221     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07222}07222 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07223}07223 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07224}07224     \textcolor{comment}{// If the element is a MacroElementNodeUpdateElement, set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07225}07225     \textcolor{comment}{// the update parameters for the current element's nodes -\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07226}07226     \textcolor{comment}{// all this needs is the vector of (pointers to the)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07227}07227     \textcolor{comment}{// geometric objects that affect the MacroElement-\/based}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07228}07228     \textcolor{comment}{// node update -\/-\/ this needs to be done to set the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07229}07229     \textcolor{comment}{// update info for newly created nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07230}07230     \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* clone\_m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07231}07231       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(clone\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07232}07232     \textcolor{keywordflow}{if} (clone\_m\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07233}07233     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07234}07234       \textcolor{comment}{// Get vector of geometric objects from father (construct vector}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07235}07235       \textcolor{comment}{// via copy operation)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07236}07236       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_pt(clone\_m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07237}07237 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07238}07238       \textcolor{comment}{// Cast current element to MacroElementNodeUpdateElement:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07239}07239       \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07240}07240         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07241}07241 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07242}07242 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07243}07243       \textcolor{keywordflow}{if} (m\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07244}07244       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07245}07245         \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07246}07246           \textcolor{stringliteral}{"{}Failed to cast to MacroElementNodeUpdateElementBase*\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07247}07247         error\_message +=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07248}07248           \textcolor{stringliteral}{"{}Strange -\/-\/ if my clone is a MacroElementNodeUpdateElement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07249}07249         error\_message += \textcolor{stringliteral}{"{}then I should be too....\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07250}07250 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07251}07251         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07252}07252           error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07253}07253           \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::p\_refine()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07254}07254           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07255}07255       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07256}07256 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07257}07257       \textcolor{comment}{// Build update info by passing vector of geometric objects:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07258}07258       \textcolor{comment}{// This sets the current element to be the update element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07259}07259       \textcolor{comment}{// for all of the element's nodes -\/-\/ this is reversed}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07260}07260       \textcolor{comment}{// if the element is ever un-\/refined in the father element's}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07261}07261       \textcolor{comment}{// rebuild\_from\_sons() function which overwrites this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07262}07262       \textcolor{comment}{// assignment to avoid nasty segmentation faults that occur}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07263}07263       \textcolor{comment}{// when a node tries to update itself via an element that no}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07264}07264       \textcolor{comment}{// longer exists...}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07265}07265       m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_aa2408d8463e8cecc2ad12a93e10390b1}{set\_node\_update\_info}}(geom\_object\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07266}07266     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07267}07267 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07268}07268     \textcolor{comment}{// Not necessary to delete the old nodes since all original nodes are in the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07269}07269     \textcolor{comment}{// current mesh and so will be pruned as part of the mesh adaption process.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07270}07270 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07271}07271     \textcolor{comment}{// Do any further-\/build required}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07272}07272     this-\/>further\_build();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07273}07273   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07274}07274 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07275}07275   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07276}07276 \textcolor{comment}{  /// Shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07277}07277 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07278}07278   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07279}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a834f8845f48fbfe51d1ad0e7b061af44}{07279}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1OneDimLagrange_a117f8b892dc89989ecdad99ff261e120}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::shape}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07280}07280                                                        \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07281}07281 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07282}07282     \textcolor{keywordflow}{switch} (P\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07283}07283     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07284}07284       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07285}07285       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07286}07286         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07287}07287         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07288}07288         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<2>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07289}07289 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07290}07290         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07291}07291         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07292}07292         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07293}07293         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07294}07294           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07295}07295           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07296}07296             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07297}07297             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07298}07298               psi(P\_order * P\_order * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + P\_order * j + k) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07299}07299                 psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07300}07300             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07301}07301           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07302}07302         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07303}07303         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07304}07304       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07305}07305       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07306}07306       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07307}07307         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07308}07308         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07309}07309         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<3>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07310}07310 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07311}07311         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07312}07312         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07313}07313         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07314}07314         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07315}07315           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07316}07316           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07317}07317             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07318}07318             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07319}07319               psi(P\_order * P\_order * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + P\_order * j + k) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07320}07320                 psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07321}07321             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07322}07322           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07323}07323         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07324}07324         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07325}07325       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07326}07326       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07327}07327       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07328}07328         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07329}07329         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07330}07330         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<4>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07331}07331 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07332}07332         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07333}07333         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07334}07334         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07335}07335         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07336}07336           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07337}07337           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07338}07338             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07339}07339             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07340}07340               psi(P\_order * P\_order * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + P\_order * j + k) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07341}07341                 psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07342}07342             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07343}07343           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07344}07344         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07345}07345         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07346}07346       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07347}07347       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07348}07348       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07349}07349         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07350}07350         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07351}07351         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<5>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07352}07352 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07353}07353         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07354}07354         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07355}07355         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07356}07356         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07357}07357           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07358}07358           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07359}07359             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07360}07360             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07361}07361               psi(P\_order * P\_order * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + P\_order * j + k) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07362}07362                 psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07363}07363             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07364}07364           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07365}07365         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07366}07366         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07367}07367       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07368}07368       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07369}07369       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07370}07370         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07371}07371         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07372}07372         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<6>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07373}07373 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07374}07374         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07375}07375         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07376}07376         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07377}07377         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07378}07378           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07379}07379           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07380}07380             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07381}07381             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07382}07382               psi(P\_order * P\_order * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + P\_order * j + k) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07383}07383                 psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07384}07384             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07385}07385           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07386}07386         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07387}07387         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07388}07388       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07389}07389       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07390}07390       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07391}07391         \textcolor{comment}{// Call the OneDimensional Shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07392}07392         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07393}07393         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<7>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07394}07394 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07395}07395         \textcolor{comment}{// Now let's loop over the nodal points in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07396}07396         \textcolor{comment}{// and copy the values back in}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07397}07397         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07398}07398         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07399}07399           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07400}07400           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07401}07401             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07402}07402             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07403}07403               psi(P\_order * P\_order * \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + P\_order * j + k) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07404}07404                 psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07405}07405             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07406}07406           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07407}07407         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07408}07408         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07409}07409       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07410}07410       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07411}07411         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07412}07412         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07413}07413         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       polynomial order for shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07414}07414         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07415}07415                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07416}07416                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07417}07417     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07418}07418   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07419}07419 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07420}07420   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07421}07421 \textcolor{comment}{  /// Derivatives of shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07422}07422 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07423}07423   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07424}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_adfa591eb8f4ebd20615713d1e721aa7f}{07424}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::dshape\_local}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07425}07425     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsids)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07426}07426 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07427}07427     \textcolor{keywordflow}{switch} (P\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07428}07428     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07429}07429       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07430}07430       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07431}07431         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07432}07432         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<2>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07433}07433         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<2>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07434}07434         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<2>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07435}07435           dpsi3ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07436}07436 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07437}07437         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07438}07438         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07439}07439         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07440}07440         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07441}07441         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07442}07442           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07443}07443           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07444}07444             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07445}07445             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07446}07446               \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07447}07447               dpsids(index, 0) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * dpsi1ds[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07448}07448               dpsids(index, 1) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi2ds[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07449}07449               dpsids(index, 2) = dpsi3ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07450}07450               psi[index] = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07451}07451               \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07452}07452               ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07453}07453             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07454}07454           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07455}07455         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07456}07456         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07457}07457       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07458}07458       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07459}07459       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07460}07460         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07461}07461         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<3>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07462}07462         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<3>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07463}07463         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<3>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07464}07464           dpsi3ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07465}07465 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07466}07466         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07467}07467         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07468}07468         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07469}07469         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07470}07470         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07471}07471           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07472}07472           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07473}07473             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07474}07474             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07475}07475               \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07476}07476               dpsids(index, 0) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * dpsi1ds[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07477}07477               dpsids(index, 1) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi2ds[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07478}07478               dpsids(index, 2) = dpsi3ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07479}07479               psi[index] = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07480}07480               \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07481}07481               ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07482}07482             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07483}07483           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07484}07484         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07485}07485         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07486}07486       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07487}07487       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07488}07488       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07489}07489         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07490}07490         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<4>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07491}07491         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<4>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07492}07492         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<4>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07493}07493           dpsi3ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07494}07494 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07495}07495         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07496}07496         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07497}07497         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07498}07498         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07499}07499         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07500}07500           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07501}07501           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07502}07502             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07503}07503             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07504}07504               \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07505}07505               dpsids(index, 0) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * dpsi1ds[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07506}07506               dpsids(index, 1) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi2ds[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07507}07507               dpsids(index, 2) = dpsi3ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07508}07508               psi[index] = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07509}07509               \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07510}07510               ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07511}07511             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07512}07512           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07513}07513         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07514}07514         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07515}07515       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07516}07516       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07517}07517       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07518}07518         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07519}07519         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<5>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07520}07520         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<5>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07521}07521         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<5>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07522}07522           dpsi3ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07523}07523 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07524}07524         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07525}07525         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07526}07526         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07527}07527         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07528}07528         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07529}07529           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07530}07530           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07531}07531             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07532}07532             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07533}07533               \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07534}07534               dpsids(index, 0) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * dpsi1ds[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07535}07535               dpsids(index, 1) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi2ds[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07536}07536               dpsids(index, 2) = dpsi3ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07537}07537               psi[index] = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07538}07538               \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07539}07539               ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07540}07540             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07541}07541           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07542}07542         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07543}07543         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07544}07544       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07545}07545       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07546}07546       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07547}07547         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07548}07548         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<6>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07549}07549         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<6>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07550}07550         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<6>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07551}07551           dpsi3ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07552}07552 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07553}07553         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07554}07554         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07555}07555         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07556}07556         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07557}07557         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07558}07558           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07559}07559           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07560}07560             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07561}07561             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07562}07562               \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07563}07563               dpsids(index, 0) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * dpsi1ds[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07564}07564               dpsids(index, 1) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi2ds[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07565}07565               dpsids(index, 2) = dpsi3ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07566}07566               psi[index] = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07567}07567               \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07568}07568               ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07569}07569             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07570}07570           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07571}07571         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07572}07572         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07573}07573       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07574}07574       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07575}07575       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07576}07576         \textcolor{comment}{// Call the shape functions and derivatives}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07577}07577         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape_ae33d86bf57e03bdb3dffcd248ed881cd}{OneDimensionalLegendreShape<7>::calculate\_nodal\_positions}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07578}07578         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreShape}{OneDimensionalLegendreShape<7>}} psi1(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), psi2(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]), psi3(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07579}07579         \mbox{\hyperlink{classoomph_1_1OneDimensionalLegendreDShape}{OneDimensionalLegendreDShape<7>}} dpsi1ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0]), dpsi2ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1]),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07580}07580           dpsi3ds(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07581}07581 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07582}07582         \textcolor{comment}{// Index for the shape functions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07583}07583         \textcolor{keywordtype}{unsigned} index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07584}07584         \textcolor{comment}{// Loop over shape functions in element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07585}07585         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P\_order; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07586}07586         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07587}07587           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < P\_order; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07588}07588           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07589}07589             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < P\_order; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07590}07590             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07591}07591               \textcolor{comment}{// Assign the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07592}07592               dpsids(index, 0) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * dpsi1ds[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07593}07593               dpsids(index, 1) = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dpsi2ds[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07594}07594               dpsids(index, 2) = dpsi3ds[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07595}07595               psi[index] = psi3[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi2[j] * psi1[k];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07596}07596               \textcolor{comment}{// Increment the index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07597}07597               ++index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07598}07598             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07599}07599           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07600}07600         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07601}07601         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07602}07602       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07603}07603       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07604}07604         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07605}07605         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07606}07606         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       polynomial order for shape functions.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07607}07607         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07608}07608                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07609}07609                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07610}07610     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07611}07611   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07612}07612 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07613}07613   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07614}07614 \textcolor{comment}{  /// Second derivatives of shape functions for PRefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07615}07615 \textcolor{comment}{  ///  d2psids(i,0) = \(\backslash\)f\$ d\string^2 \(\backslash\)psi\_j / d s\string^2 \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07616}07616 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07617}07617   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07618}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_a72ca434f5b7bba948f3a8f280c53a857}{07618}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::d2shape\_local}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07619}07619     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, \mbox{\hyperlink{classoomph_1_1Shape}{Shape}}\& psi, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& dpsids, \mbox{\hyperlink{classoomph_1_1DShape}{DShape}}\& d2psids)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07620}07620 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07621}07621     std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07622}07622     error\_message}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07623}07623       << \textcolor{stringliteral}{"{}\(\backslash\)nd2shape\_local currently not implemented for this element\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07624}07624     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07625}07625       error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07626}07626   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07627}07627 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07628}07628   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07629}07629 \textcolor{comment}{  /// Rebuild the element from nodes found in its sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07630}07630 \textcolor{comment}{  /// Adjusts its p-\/order to be the maximum of its sons' p-\/orders}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07631}07631 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07632}07632   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07633}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_ae4014ced0f6a6cdb14b9ae53efcd5fb8}{07633}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::rebuild\_from\_sons}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07634}07634     \mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07635}07635   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07636}07636     \textcolor{comment}{// Get p-\/orders of sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07637}07637     \textcolor{keywordtype}{unsigned} n\_sons = this-\/>tree\_pt()-\/>nsons();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07638}07638     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} son\_p\_order(n\_sons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07639}07639     \textcolor{keywordtype}{unsigned} max\_son\_p\_order = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07640}07640     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ison = 0; ison < n\_sons; ison++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07641}07641     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07642}07642       \mbox{\hyperlink{classoomph_1_1PRefineableElement}{PRefineableElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableElement}{PRefineableElement}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07643}07643         this-\/>tree\_pt()-\/>son\_pt(ison)-\/>object\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07644}07644       son\_p\_order[ison] = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1PRefineableElement_a83b9554e28ce574cc7759e88388575b0}{p\_order}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07645}07645       \textcolor{keywordflow}{if} (son\_p\_order[ison] > max\_son\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07646}07646         max\_son\_p\_order = son\_p\_order[ison];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07647}07647     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07648}07648 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07649}07649     \textcolor{keywordtype}{unsigned} old\_Nnode = this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07650}07650     \textcolor{keywordtype}{unsigned} old\_P\_order = this-\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07651}07651     \textcolor{comment}{// Set p-\/order of the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07652}07652     this-\/>p\_order() = max\_son\_p\_order;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07653}07653 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07654}07654     \textcolor{comment}{// Change integration scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07655}07655     \textcolor{keyword}{delete} this-\/>integral\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07656}07656     \textcolor{keywordflow}{switch} (this-\/>p\_order())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07657}07657     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07658}07658       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07659}07659         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 2>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07660}07660         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07661}07661       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07662}07662         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 3>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07663}07663         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07664}07664       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07665}07665         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 4>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07666}07666         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07667}07667       \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07668}07668         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 5>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07669}07669         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07670}07670       \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07671}07671         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 6>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07672}07672         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07673}07673       \textcolor{keywordflow}{case} 7:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07674}07674         this-\/>set\_integration\_scheme(\textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1GaussLobattoLegendre}{GaussLobattoLegendre<3, 7>}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07675}07675         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07676}07676       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07677}07677         std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07678}07678         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)nERROR: Exceeded maximum polynomial order for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07679}07679         error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n       integration scheme.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07680}07680         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07681}07681           error\_message.str(),}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07682}07682           \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::rebuild\_from\_sons()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07683}07683           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07684}07684     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07685}07685 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07686}07686     \textcolor{comment}{// Back up pointers to old nodes before they are lost}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07687}07687     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} old\_node\_pt(old\_Nnode);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07688}07688     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < old\_Nnode; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07689}07689     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07690}07690       old\_node\_pt[n] = this-\/>node\_pt(n);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07691}07691     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07692}07692 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07693}07693     \textcolor{comment}{// Allocate new space for Nodes (at the element level)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07694}07694     this-\/>set\_n\_node(this-\/>p\_order() * this-\/>p\_order() * this-\/>p\_order());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07695}07695 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07696}07696     \textcolor{comment}{// Copy vertex nodes which were populated in the pre-\/build}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07697}07697     this-\/>node\_pt(0) = old\_node\_pt[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07698}07698     this-\/>node\_pt(this-\/>p\_order() -\/ 1) = old\_node\_pt[old\_P\_order -\/ 1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07699}07699     this-\/>node\_pt(this-\/>p\_order() * (this-\/>p\_order() -\/ 1)) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07700}07700       old\_node\_pt[(old\_P\_order) * (old\_P\_order -\/ 1)];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07701}07701     this-\/>node\_pt(this-\/>p\_order() * this-\/>p\_order() -\/ 1) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07702}07702       old\_node\_pt[(old\_P\_order) * (old\_P\_order)-\/1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07703}07703     this-\/>node\_pt(this-\/>p\_order() * this-\/>p\_order() * (this-\/>p\_order() -\/ 1)) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07704}07704       old\_node\_pt[old\_P\_order * old\_P\_order * (old\_P\_order -\/ 1)];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07705}07705     this-\/>node\_pt((this-\/>p\_order() * this-\/>p\_order() + 1) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07706}07706                   (this-\/>p\_order() -\/ 1)) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07707}07707       old\_node\_pt[(old\_P\_order * old\_P\_order + 1) * (old\_P\_order -\/ 1)];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07708}07708     this-\/>node\_pt(this-\/>p\_order() * (this-\/>p\_order() + 1) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07709}07709                   (this-\/>p\_order() -\/ 1)) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07710}07710       old\_node\_pt[old\_P\_order * (old\_P\_order + 1) * (old\_P\_order -\/ 1)];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07711}07711     this-\/>node\_pt(this-\/>p\_order() * this-\/>p\_order() * this-\/>p\_order() -\/ 1) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07712}07712       old\_node\_pt[old\_P\_order * old\_P\_order * old\_P\_order -\/ 1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07713}07713 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07714}07714     \textcolor{comment}{// Copy midpoint nodes from sons if new p-\/order is odd}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07715}07715     \textcolor{keywordflow}{if} (this-\/>p\_order() \% 2 == 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07716}07716     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07717}07717       \textcolor{comment}{// Work out which is midpoint node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07718}07718       \textcolor{keywordtype}{unsigned} n\_p = this-\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07719}07719       \textcolor{keywordtype}{unsigned} m = (n\_p -\/ 1) / 2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07720}07720 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07721}07721       \textcolor{keywordtype}{unsigned} s0space = m;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07722}07722       \textcolor{keywordtype}{unsigned} s1space = m * n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07723}07723       \textcolor{keywordtype}{unsigned} s2space = m * n\_p * n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07724}07724 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07725}07725       \textcolor{comment}{// Back face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07726}07726       \textcolor{comment}{// DB edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07727}07727       this-\/>node\_pt(1 * s0space + 0 * s1space + 0 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07728}07728         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07729}07729           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07730}07730           -\/>vertex\_node\_pt(0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07731}07731       \textcolor{comment}{// LB edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07732}07732       this-\/>node\_pt(0 * s0space + 1 * s1space + 0 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07733}07733         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07734}07734           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07735}07735           -\/>vertex\_node\_pt(0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07736}07736       \textcolor{comment}{// B centre}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07737}07737       this-\/>node\_pt(1 * s0space + 1 * s1space + 0 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07738}07738         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07739}07739           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07740}07740           -\/>vertex\_node\_pt(0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07741}07741       \textcolor{comment}{// RB edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07742}07742       this-\/>node\_pt(2 * s0space + 1 * s1space + 0 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07743}07743         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07744}07744           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07745}07745           -\/>vertex\_node\_pt(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07746}07746       \textcolor{comment}{// UB edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07747}07747       this-\/>node\_pt(1 * s0space + 2 * s1space + 0 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07748}07748         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07749}07749           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07750}07750           -\/>vertex\_node\_pt(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07751}07751 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07752}07752       \textcolor{comment}{// Mid-\/way between between back and front faces}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07753}07753       \textcolor{comment}{// LD edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07754}07754       this-\/>node\_pt(0 * s0space + 0 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07755}07755         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07756}07756           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07757}07757           -\/>vertex\_node\_pt(0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07758}07758       \textcolor{comment}{// D centre}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07759}07759       this-\/>node\_pt(1 * s0space + 0 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07760}07760         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07761}07761           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07762}07762           -\/>vertex\_node\_pt(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07763}07763       \textcolor{comment}{// RD edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07764}07764       this-\/>node\_pt(2 * s0space + 0 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07765}07765         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07766}07766           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07767}07767           -\/>vertex\_node\_pt(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07768}07768       \textcolor{comment}{// L centre}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07769}07769       this-\/>node\_pt(0 * s0space + 1 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07770}07770         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07771}07771           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07772}07772           -\/>vertex\_node\_pt(0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07773}07773       \textcolor{comment}{// Centre}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07774}07774       this-\/>node\_pt(1 * s0space + 1 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07775}07775         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07776}07776           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07777}07777           -\/>vertex\_node\_pt(0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07778}07778       \textcolor{comment}{// R centre}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07779}07779       this-\/>node\_pt(2 * s0space + 1 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07780}07780         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07781}07781           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07782}07782           -\/>vertex\_node\_pt(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07783}07783       \textcolor{comment}{// LU edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07784}07784       this-\/>node\_pt(0 * s0space + 2 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07785}07785         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07786}07786           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07787}07787           -\/>vertex\_node\_pt(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07788}07788       \textcolor{comment}{// U center}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07789}07789       this-\/>node\_pt(1 * s0space + 2 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07790}07790         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07791}07791           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07792}07792           -\/>vertex\_node\_pt(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07793}07793       \textcolor{comment}{// RU edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07794}07794       this-\/>node\_pt(2 * s0space + 2 * s1space + 1 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07795}07795         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07796}07796           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07797}07797           -\/>vertex\_node\_pt(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07798}07798 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07799}07799       \textcolor{comment}{// Front face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07800}07800       \textcolor{comment}{// DF edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07801}07801       this-\/>node\_pt(1 * s0space + 0 * s1space + 2 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07802}07802         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07803}07803           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07804}07804           -\/>vertex\_node\_pt(5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07805}07805       \textcolor{comment}{// LF edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07806}07806       this-\/>node\_pt(0 * s0space + 1 * s1space + 2 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07807}07807         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07808}07808           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07809}07809           -\/>vertex\_node\_pt(4);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07810}07810       \textcolor{comment}{// F centre}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07811}07811       this-\/>node\_pt(1 * s0space + 1 * s1space + 2 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07812}07812         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07813}07813           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07814}07814           -\/>vertex\_node\_pt(4);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07815}07815       \textcolor{comment}{// RF edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07816}07816       this-\/>node\_pt(2 * s0space + 1 * s1space + 2 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07817}07817         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07818}07818           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07819}07819           -\/>vertex\_node\_pt(5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07820}07820       \textcolor{comment}{// UF edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07821}07821       this-\/>node\_pt(1 * s0space + 2 * s1space + 2 * s2space) =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07822}07822         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4}{RefineableQElement<3>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07823}07823           octree\_pt()-\/>son\_pt(\mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}})-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07824}07824           -\/>vertex\_node\_pt(6);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07825}07825     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07826}07826 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07827}07827     \textcolor{comment}{// The timestepper should be the same for all nodes and node 0 should}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07828}07828     \textcolor{comment}{// never be deleted.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07829}07829     \textcolor{keywordflow}{if} (this-\/>node\_pt(0) == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07830}07830     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07831}07831       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07832}07832         \textcolor{stringliteral}{"{}The Corner node (0) does not exist"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07833}07833         \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::rebuild\_from\_sons()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07834}07834         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07835}07835     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07836}07836 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07837}07837     \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt = this-\/>node\_pt(0)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07838}07838     \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>\mbox{\hyperlink{classoomph_1_1TimeStepper_a3939b77ec3578e4bd5b453c85649d631}{ntstorage}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07839}07839 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07840}07840     \textcolor{keywordtype}{unsigned} jnod = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07841}07841     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(3), \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07842}07842     \textcolor{comment}{// Loop over the nodes in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07843}07843     \textcolor{keywordtype}{unsigned} n\_p = this-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07844}07844     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07845}07845     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07846}07846       \textcolor{comment}{// Get the fractional position of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07847}07847       s\_fraction[0] = this-\/>local\_one\_d\_fraction\_of\_node(i0, 0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07848}07848       \textcolor{comment}{// Local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07849}07849       \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0 + 2.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07850}07850 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07851}07851       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < n\_p; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07852}07852       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07853}07853         \textcolor{comment}{// Get the fractional position of the node in the direction of s[1]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07854}07854         s\_fraction[1] = this-\/>local\_one\_d\_fraction\_of\_node(i1, 1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07855}07855         \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07856}07856         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] = -\/1.0 + 2.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07857}07857 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07858}07858         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i2 = 0; i2 < n\_p; i2++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07859}07859         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07860}07860           \textcolor{comment}{// Get the fractional position of the node in the direction of s[2]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07861}07861           s\_fraction[2] = this-\/>local\_one\_d\_fraction\_of\_node(i2, 2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07862}07862           \textcolor{comment}{// Local coordinate in father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07863}07863           \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] = -\/1.0 + 2.0 * s\_fraction[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07864}07864 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07865}07865           \textcolor{comment}{// Set the local node number}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07866}07866           jnod = i0 + n\_p * i1 + n\_p * n\_p * i2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07867}07867 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07868}07868           \textcolor{comment}{// Initialise flag: So far, this node hasn't been built}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07869}07869           \textcolor{comment}{// or copied yet}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07870}07870           \textcolor{keywordtype}{bool} node\_done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07871}07871 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07872}07872           \textcolor{comment}{// Get the pointer to the node in this element, returns NULL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07873}07873           \textcolor{comment}{// if there is not node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07874}07874           \mbox{\hyperlink{classoomph_1_1Node}{Node}}* created\_node\_pt = this-\/>get\_node\_at\_local\_coordinate(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07875}07875 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07876}07876           \textcolor{comment}{// Does this node already exist in this element?}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07877}07877           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07878}07878           \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07879}07879           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07880}07880             \textcolor{comment}{// Copy node across}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07881}07881             this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07882}07882 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07883}07883             \textcolor{comment}{// Node has been created by copy}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07884}07884             node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07885}07885           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07886}07886           \textcolor{comment}{// Node does not exist in this element but might already}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07887}07887           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07888}07888           \textcolor{comment}{// have been created by neighbouring elements}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07889}07889           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07890}07890           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07891}07891           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07892}07892             \textcolor{comment}{// Was the node created by one of its neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07893}07893             \textcolor{comment}{// Whether or not the node lies on an edge can be calculated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07894}07894             \textcolor{comment}{// by from the fractional position}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07895}07895             \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07896}07896             created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07897}07897               node\_created\_by\_neighbour(s\_fraction, is\_periodic);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07898}07898 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07899}07899             \textcolor{comment}{// If the node was so created, assign the pointers}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07900}07900             \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07901}07901             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07902}07902               \textcolor{comment}{// If the node is periodic}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07903}07903               \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07904}07904               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07905}07905                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Cannot handle periodic nodes yet"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07906}07906                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07907}07907                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07908}07908               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07909}07909               \textcolor{comment}{// Non-\/periodic case, just set the pointer}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07910}07910               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07911}07911               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07912}07912                 this-\/>node\_pt(jnod) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07913}07913               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07914}07914               \textcolor{comment}{// Node has been created}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07915}07915               node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07916}07916             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07917}07917           \} \textcolor{comment}{// Node does not exist in this element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07918}07918 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07919}07919           \textcolor{comment}{// Node has not been built anywhere -\/-\/-\/> build it here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07920}07920           \textcolor{keywordflow}{if} (!node\_done)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07921}07921           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07922}07922             \textcolor{comment}{// First, find the son element in which the node should live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07923}07923 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07924}07924             \textcolor{comment}{// Find coordinates in the sons}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07925}07925             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_son(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07926}07926             \textcolor{comment}{// using namespace OcTreeNames;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07927}07927             \textcolor{keywordtype}{int} son = -\/10;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07928}07928             \textcolor{comment}{// On the left}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07929}07929             \textcolor{keywordflow}{if} (s\_fraction[0] < 0.5)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07930}07930             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07931}07931               \textcolor{comment}{// On the bottom}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07932}07932               \textcolor{keywordflow}{if} (s\_fraction[1] < 0.5)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07933}07933               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07934}07934                 \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07935}07935                 \textcolor{keywordflow}{if} (s\_fraction[2] < 0.5)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07936}07936                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07937}07937                   \textcolor{comment}{// It's the LDB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07938}07938                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07939}07939                   s\_in\_son[0] = -\/1.0 + 4.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07940}07940                   s\_in\_son[1] = -\/1.0 + 4.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07941}07941                   s\_in\_son[2] = -\/1.0 + 4.0 * s\_fraction[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07942}07942                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07943}07943                 \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07944}07944                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07945}07945                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07946}07946                   \textcolor{comment}{// It's the LDF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07947}07947                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07948}07948                   s\_in\_son[0] = -\/1.0 + 4.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07949}07949                   s\_in\_son[1] = -\/1.0 + 4.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07950}07950                   s\_in\_son[2] = -\/1.0 + 4.0 * (s\_fraction[2] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07951}07951                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07952}07952               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07953}07953               \textcolor{comment}{// On the top}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07954}07954               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07955}07955               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07956}07956                 \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07957}07957                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07958}07958                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07959}07959                   \textcolor{comment}{// It's the LUB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07960}07960                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07961}07961                   s\_in\_son[0] = -\/1.0 + 4.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07962}07962                   s\_in\_son[1] = -\/1.0 + 4.0 * (s\_fraction[1] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07963}07963                   s\_in\_son[2] = -\/1.0 + 4.0 * s\_fraction[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07964}07964                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07965}07965                 \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07966}07966                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07967}07967                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07968}07968                   \textcolor{comment}{// It's the LUF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07969}07969                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07970}07970                   s\_in\_son[0] = -\/1.0 + 4.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07971}07971                   s\_in\_son[1] = -\/1.0 + 4.0 * (s\_fraction[1] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07972}07972                   s\_in\_son[2] = -\/1.0 + 4.0 * (s\_fraction[2] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07973}07973                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07974}07974               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07975}07975             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07976}07976             \textcolor{comment}{// On the right}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07977}07977             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07978}07978             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07979}07979               \textcolor{comment}{// On the bottom}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07980}07980               \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[1] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07981}07981               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07982}07982                 \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07983}07983                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07984}07984                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07985}07985                   \textcolor{comment}{// It's the RDB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07986}07986                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07987}07987                   s\_in\_son[0] = -\/1.0 + 4.0 * (s\_fraction[0] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07988}07988                   s\_in\_son[1] = -\/1.0 + 4.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07989}07989                   s\_in\_son[2] = -\/1.0 + 4.0 * s\_fraction[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07990}07990                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07991}07991                 \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07992}07992                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07993}07993                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07994}07994                   \textcolor{comment}{// It's the RDF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07995}07995                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07996}07996                   s\_in\_son[0] = -\/1.0 + 4.0 * (s\_fraction[0] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07997}07997                   s\_in\_son[1] = -\/1.0 + 4.0 * s\_fraction[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07998}07998                   s\_in\_son[2] = -\/1.0 + 4.0 * (s\_fraction[2] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l07999}07999                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08000}08000               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08001}08001               \textcolor{comment}{// On the top}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08002}08002               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08003}08003               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08004}08004                 \textcolor{comment}{// On the back}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08005}08005                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[2] < 0.0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08006}08006                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08007}08007                   \textcolor{comment}{// It's the RUB son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08008}08008                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08009}08009                   s\_in\_son[0] = -\/1.0 + 4.0 * (s\_fraction[0] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08010}08010                   s\_in\_son[1] = -\/1.0 + 4.0 * (s\_fraction[1] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08011}08011                   s\_in\_son[2] = -\/1.0 + 4.0 * s\_fraction[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08012}08012                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08013}08013                 \textcolor{comment}{// On the front}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08014}08014                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08015}08015                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08016}08016                   \textcolor{comment}{// It's the RUF son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08017}08017                   son = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08018}08018                   s\_in\_son[0] = -\/1.0 + 4.0 * (s\_fraction[0] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08019}08019                   s\_in\_son[1] = -\/1.0 + 4.0 * (s\_fraction[1] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08020}08020                   s\_in\_son[2] = -\/1.0 + 4.0 * (s\_fraction[2] -\/ 0.5);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08021}08021                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08022}08022               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08023}08023             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08024}08024 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08025}08025             \textcolor{comment}{// Get the pointer to the son element in which the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08026}08026             \textcolor{comment}{// would live}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08027}08027             \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}* son\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08028}08028               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08029}08029                 this-\/>tree\_pt()-\/>son\_pt(son)-\/>object\_pt());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08030}08030 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08031}08031             \textcolor{comment}{// If we are rebuilding, then worry about the boundary conditions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08032}08032             \textcolor{comment}{// Find the boundary of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08033}08033             \textcolor{comment}{// Initially none}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08034}08034             \textcolor{keywordtype}{int} boundary = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08035}08035             \textcolor{comment}{// If we are on the left face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08036}08036             \textcolor{keywordflow}{if} (i0 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08037}08037             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08038}08038               boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08039}08039             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08040}08040             \textcolor{comment}{// If we are on the right face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08041}08041             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i0 == n\_p -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08042}08042             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08043}08043               boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08044}08044             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08045}08045 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08046}08046             \textcolor{comment}{// If we are on the bottom face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08047}08047             \textcolor{keywordflow}{if} (i1 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08048}08048             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08049}08049               \textcolor{comment}{// If we already have already set the boundary, we're on an edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08050}08050               \textcolor{keywordflow}{switch} (boundary)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08051}08051               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08052}08052                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08053}08053                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08054}08054                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08055}08055                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08056}08056                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08057}08057                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08058}08058                 \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08059}08059                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08060}08060                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08061}08061                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08062}08062               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08063}08063             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08064}08064             \textcolor{comment}{// If we are the top face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08065}08065             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i1 == n\_p -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08066}08066             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08067}08067               \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08068}08068               \textcolor{keywordflow}{switch} (boundary)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08069}08069               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08070}08070                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08071}08071                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08072}08072                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08073}08073                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08074}08074                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08075}08075                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08076}08076                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08077}08077                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08078}08078                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08079}08079               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08080}08080             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08081}08081 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08082}08082             \textcolor{comment}{// If we are on the back face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08083}08083             \textcolor{keywordflow}{if} (i2 == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08084}08084             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08085}08085               \textcolor{comment}{// If we already have already set the boundary, we're on an edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08086}08086               \textcolor{keywordflow}{switch} (boundary)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08087}08087               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08088}08088                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08089}08089                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{OcTreeNames::LB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08090}08090                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08091}08091                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08092}08092                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40abed39d2cabdadba8a0746381691ccf77}{OcTreeNames::LDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08093}08093                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08094}08094                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08095}08095                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9717fc1b8f4e28fe7271b90dba57802d}{OcTreeNames::LUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08096}08096                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08097}08097                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08098}08098                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{OcTreeNames::RB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08099}08099                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08100}08100                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08101}08101                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a8f4fba3e9fa2aa0c76ec6bb85fe89e1b}{OcTreeNames::RDB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08102}08102                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08103}08103                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08104}08104                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a4876386f3bfaed6e524e2a251945b57d}{OcTreeNames::RUB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08105}08105                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08106}08106                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08107}08107                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{OcTreeNames::DB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08108}08108                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08109}08109                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08110}08110                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{OcTreeNames::UB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08111}08111                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08112}08112                 \textcolor{comment}{// Boundary not set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08113}08113                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08114}08114                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{OcTreeNames::B}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08115}08115                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08116}08116               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08117}08117             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08118}08118             \textcolor{comment}{// If we are the front face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08119}08119             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (i2 == n\_p -\/ 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08120}08120             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08121}08121               \textcolor{comment}{// If we already have a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08122}08122               \textcolor{keywordflow}{switch} (boundary)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08123}08123               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08124}08124                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a56b1e55e65e346693677249c84b86176}{OcTreeNames::L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08125}08125                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{OcTreeNames::LF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08126}08126                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08127}08127                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{OcTreeNames::LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08128}08128                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a7bf18855ab002d44e301413456917d9c}{OcTreeNames::LDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08129}08129                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08130}08130                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{OcTreeNames::LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08131}08131                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a6357637fc339bbb6745b6b5ce101b45a}{OcTreeNames::LUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08132}08132                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08133}08133                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5e03c0a30df340df04d44883d52b425d}{OcTreeNames::R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08134}08134                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{OcTreeNames::RF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08135}08135                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08136}08136                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{OcTreeNames::RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08137}08137                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a172055f90c2c767808f297a31c9844be}{OcTreeNames::RDF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08138}08138                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08139}08139                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{OcTreeNames::RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08140}08140                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9db7ad20ea4f76808cd9cf026229bcdc}{OcTreeNames::RUF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08141}08141                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08142}08142                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{OcTreeNames::D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08143}08143                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{OcTreeNames::DF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08144}08144                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08145}08145                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{OcTreeNames::U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08146}08146                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{OcTreeNames::UF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08147}08147                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08148}08148                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08149}08149                   boundary = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{OcTreeNames::F}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08150}08150                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08151}08151               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08152}08152             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08153}08153 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08154}08154             \textcolor{comment}{// set of boundaries that this edge in the son lives on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08155}08155             std::set<unsigned> boundaries;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08156}08156 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08157}08157             \textcolor{comment}{// Now get the boundary conditions from the son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08158}08158             \textcolor{comment}{// The boundaries will be common to the son because there can be}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08159}08159             \textcolor{comment}{// no rotations here}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08160}08160             \textcolor{keywordflow}{if} (boundary != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08161}08161             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08162}08162               son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_ac61083ce6abe6338ec5d7795d9f1e051}{get\_boundaries}}(boundary, boundaries);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08163}08163             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08164}08164 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08165}08165             \textcolor{comment}{// If the node lives on a boundary:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08166}08166             \textcolor{comment}{// Construct a boundary node,}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08167}08167             \textcolor{comment}{// Get boundary conditions and}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08168}08168             \textcolor{comment}{// update all lookup schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08169}08169             \textcolor{keywordflow}{if} (boundaries.size() > 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08170}08170             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08171}08171               \textcolor{comment}{// Construct the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08172}08172               created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08173}08173                 this-\/>construct\_boundary\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08174}08174 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08175}08175               \textcolor{comment}{// Get the boundary conditions from the son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08176}08176               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} bound\_cons(this-\/>ncont\_interpolated\_values());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08177}08177               son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_aac2601ff8f740680675e5e6ba5c35e9d}{get\_bcs}}(boundary, bound\_cons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08178}08178 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08179}08179               \textcolor{comment}{// Loop over the values and pin if necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08180}08180               \textcolor{keywordtype}{unsigned} nval = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08181}08181               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < nval; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08182}08182               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08183}08183                 \textcolor{keywordflow}{if} (bound\_cons[k])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08184}08184                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08185}08185                   created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a422231c58e423f0b43822827aa334d79}{pin}}(k);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08186}08186                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08187}08187               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08188}08188 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08189}08189               \textcolor{comment}{// Solid node? If so, deal with the positional boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08190}08190               \textcolor{comment}{// conditions:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08191}08191               \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08192}08192                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08193}08193               \textcolor{keywordflow}{if} (solid\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08194}08194               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08195}08195                 \textcolor{comment}{// Get the positional boundary conditions from the father:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08196}08196                 \textcolor{keywordtype}{unsigned} n\_dim = created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a786c96a8e46eb27a03b2b31f629d41b3}{ndim}}();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08197}08197                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} solid\_bound\_cons(n\_dim);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08198}08198                 \mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_013_01_4}{RefineableSolidQElement<3>}}* son\_solid\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08199}08199                   \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_013_01_4}{RefineableSolidQElement<3>}}*\textcolor{keyword}{>}(son\_el\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08200}08200 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08201}08201                 \textcolor{keywordflow}{if} (son\_solid\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08202}08202                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08203}08203                   \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08204}08204                     \textcolor{stringliteral}{"{}We have a SolidNode outside a refineable SolidElement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08205}08205                   error\_message +=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08206}08206                     \textcolor{stringliteral}{"{}during mesh refinement -\/-\/ this doesn't make sense\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08207}08207 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08208}08208                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08209}08209                                       \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>:"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08210}08210                                       \textcolor{stringliteral}{"{}:rebuild\_from\_sons()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08211}08211                                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08212}08212                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08213}08213 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08214}08214                 son\_solid\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableSolidQElement_3_013_01_4_a57590ae1b7cb21cc362a371eef096217}{get\_solid\_bcs}}(boundary, solid\_bound\_cons);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08215}08215 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08216}08216                 \textcolor{comment}{// Loop over the positions and pin, if necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08217}08217                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dim; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08218}08218                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08219}08219                   \textcolor{keywordflow}{if} (solid\_bound\_cons[k])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08220}08220                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08221}08221                     solid\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_aa283a553b0141e859dd7b4f80bb88e6d}{pin\_position}}(k);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08222}08222                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08223}08223                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08224}08224               \} \textcolor{comment}{// End of if solid\_node\_pt}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08225}08225 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08226}08226 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08227}08227               \textcolor{comment}{// Next we update the boundary look-\/up schemes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08228}08228               \textcolor{comment}{// Loop over the boundaries stored in the set}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08229}08229               \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = boundaries.begin();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08230}08230                    it != boundaries.end();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08231}08231                    ++it)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08232}08232               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08233}08233                 \textcolor{comment}{// Add the node to the boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08234}08234                 mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{add\_boundary\_node}}(*it, created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08235}08235 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08236}08236                 \textcolor{comment}{// If we have set an intrinsic coordinate on this}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08237}08237                 \textcolor{comment}{// mesh boundary then it must also be interpolated on}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08238}08238                 \textcolor{comment}{// the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08239}08239                 \textcolor{comment}{// Now interpolate the intrinsic boundary coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08240}08240                 \textcolor{keywordflow}{if} (mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad1b124a959628aba00162b89617b3a62}{boundary\_coordinate\_exists}}(*it) == \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08241}08241                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08242}08242                   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} zeta(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08243}08243                   son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_013_01_4_aa0feadb4fbbe8861366a77373b122293}{interpolated\_zeta\_on\_face}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08244}08244                     *it, boundary, s\_in\_son, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08245}08245 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08246}08246                   created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_a94c19e165ab4e88aabbfa27443c530b7}{set\_coordinates\_on\_boundary}}(*it, zeta);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08247}08247                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08248}08248               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08249}08249             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08250}08250             \textcolor{comment}{// Otherwise the node is not on a Mesh boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08251}08251             \textcolor{comment}{// and we create a normal "{}bulk"{} node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08252}08252             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08253}08253             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08254}08254               \textcolor{comment}{// Construct the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08255}08255               created\_node\_pt = this-\/>construct\_node(jnod, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08256}08256             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08257}08257 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08258}08258             \textcolor{comment}{// Now we set the position and values at the newly created node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08259}08259 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08260}08260             \textcolor{comment}{// In the first instance use macro element or FE representation}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08261}08261             \textcolor{comment}{// to create past and present nodal positions.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08262}08262             \textcolor{comment}{// (THIS STEP SHOULD NOT BE SKIPPED FOR ALGEBRAIC}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08263}08263             \textcolor{comment}{// ELEMENTS AS NOT ALL OF THEM NECESSARILY IMPLEMENT}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08264}08264             \textcolor{comment}{// NONTRIVIAL NODE UPDATE FUNCTIONS. CALLING}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08265}08265             \textcolor{comment}{// THE NODE UPDATE FOR SUCH ELEMENTS/NODES WILL LEAVE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08266}08266             \textcolor{comment}{// THEIR NODAL POSITIONS WHERE THEY WERE (THIS IS APPROPRIATE}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08267}08267             \textcolor{comment}{// ONCE THEY HAVE BEEN GIVEN POSITIONS) BUT WILL}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08268}08268             \textcolor{comment}{// NOT ASSIGN SENSIBLE INITIAL POSITONS!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08269}08269 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08270}08270             \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08271}08271             \textcolor{comment}{// Loop over \# of history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08272}08272             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08273}08273             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08274}08274               \textcolor{keyword}{using namespace }QuadTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08275}08275               \textcolor{comment}{// Get the position from the son}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08276}08276               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08277}08277 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08278}08278               \textcolor{comment}{// Now let's fill in the value}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08279}08279               son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_son, x\_prev);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08280}08280               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08281}08281               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08282}08282                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = x\_prev[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08283}08283               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08284}08284             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08285}08285 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08286}08286             \textcolor{comment}{// Now set up the values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08287}08287             \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08288}08288             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08289}08289             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08290}08290               \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08291}08291               \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08292}08292               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08293}08293               son\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_son, prev\_values);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08294}08294 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08295}08295               \textcolor{comment}{// Initialise the values at the new node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08296}08296               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7e67fc78a2e8a2fd6eb75bd292d42ff8}{nvalue}}(); k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08297}08297               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08298}08298                 created\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1Data_a7289ca322725c6fd493970a19474b382}{set\_value}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08299}08299               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08300}08300             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08301}08301 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08302}08302             \textcolor{comment}{// Add the node to the mesh}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08303}08303             mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08304}08304 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08305}08305             \textcolor{comment}{// Check if the element is an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08306}08306             \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08307}08307               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08308}08308 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08309}08309             \textcolor{comment}{// If we do have an algebraic element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08310}08310             \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08311}08311             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08312}08312               \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08313}08313                 \textcolor{stringliteral}{"{}Have not implemented rebuilding from sons for"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08314}08314               error\_message += \textcolor{stringliteral}{"{}Algebraic p-\/refineable elements yet\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08315}08315 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08316}08316               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08317}08317                 error\_message,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08318}08318                 \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::rebuild\_from\_sons()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08319}08319                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08320}08320             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08321}08321 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08322}08322           \} \textcolor{comment}{// End of the case when we build the node ourselves}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08323}08323         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08324}08324       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08325}08325     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08326}08326   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08327}08327 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08328}08328   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08329}08329 \textcolor{comment}{  /// Check inter-\/element continuity of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08330}08330 \textcolor{comment}{  /// -\/ nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08331}08331 \textcolor{comment}{  /// -\/ (nodally) interpolated function values}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08332}08332 \textcolor{comment}{  /// Overloaded to not check differences in the value. Mortaring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08333}08333 \textcolor{comment}{  /// doesn't enforce strong continuity between elements.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08334}08334 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08335}08335   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08336}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_af7340470f3d3734c7a327119d4a88fc4}{08336}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::check\_integrity}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08337}08337     \textcolor{keywordtype}{double}\& max\_error)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08338}08338   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08339}08339     \textcolor{comment}{// Not yet implemented -\/-\/ doing nothing for now.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08340}08340 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08341}08341     \textcolor{comment}{// Dummy set max\_error to 0}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08342}08342     max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08343}08343     \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08344}08344   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08345}08345 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08346}08346   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08347}08347 \textcolor{comment}{  /// Internal function to set up the hanging nodes on a particular}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08348}08348 \textcolor{comment}{  /// edge of the element. Implements the mortar method.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08349}08349 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08350}08350   \textcolor{keyword}{template}<\textcolor{keywordtype}{unsigned} INITIAL\_NNODE\_1D>}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08351}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4_ae291430b43e01a7d20c411ef4ac79e45}{08351}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, INITIAL\_NNODE\_1D>::oc\_hang\_helper}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08352}08352     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value\_id, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& my\_face, std::ofstream\& output\_hangfile)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08353}08353   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08354}08354     \textcolor{keyword}{using namespace }OcTreeNames;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08355}08355 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08356}08356     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} translate\_s(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08357}08357     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_lo\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08358}08358     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_hi\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08359}08359     \textcolor{keywordtype}{int} neigh\_face, diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08360}08360     \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08361}08361 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08362}08362     \textcolor{comment}{// Find pointer to neighbour in this direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08363}08363     \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08364}08364     neigh\_pt = this-\/>octree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1OcTree_a690c4fbbca73bd48c0bc3b2913a9b39c}{gteq\_face\_neighbour}}(my\_face,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08365}08365                                                       translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08366}08366                                                       s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08367}08367                                                       s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08368}08368                                                       neigh\_face,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08369}08369                                                       diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08370}08370                                                       in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08371}08371 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08372}08372     \textcolor{comment}{// Work out master/dependent faces}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08373}08373     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08374}08374 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08375}08375     \textcolor{comment}{// Set up booleans}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08376}08376     \textcolor{comment}{// bool h\_type\_master = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08377}08377     \textcolor{keywordtype}{bool} h\_type\_dependent = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08378}08378     \textcolor{comment}{// bool p\_type\_master = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08379}08379     \textcolor{keywordtype}{bool} p\_type\_dependent = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08380}08380 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08381}08381     \textcolor{comment}{// Neighbour exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08382}08382     \textcolor{keywordflow}{if} (neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08383}08383     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08384}08384       \textcolor{comment}{// Check if neighbour is bigger than me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08385}08385       \textcolor{keywordflow}{if} (diff\_level != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08386}08386       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08387}08387         \textcolor{comment}{// Dependent at h-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08388}08388         h\_type\_dependent = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08389}08389       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08390}08390       \textcolor{comment}{// Check if neighbour is the same size as me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08391}08391       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a31e4123b40f6fb52d180a154c9123e85}{nsons}}() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08392}08392       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08393}08393         \textcolor{comment}{// Neighbour is same size as me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08394}08394         \textcolor{comment}{// Find p-\/orders of each element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08395}08395         \textcolor{keywordtype}{unsigned} my\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08396}08396           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(\textcolor{keyword}{this})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08397}08397             -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08398}08398         \textcolor{keywordtype}{unsigned} neigh\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08399}08399           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08400}08400             neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08401}08401             -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08402}08402 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08403}08403         \textcolor{comment}{// Check for p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08404}08404         \textcolor{keywordflow}{if} (neigh\_p\_order == my\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08405}08405         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08406}08406           \textcolor{comment}{// At a conforming interface}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08407}08407         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08408}08408         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (neigh\_p\_order < my\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08409}08409         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08410}08410           \textcolor{comment}{// Dependent at p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08411}08411           p\_type\_dependent = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08412}08412         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08413}08413         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08414}08414         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08415}08415           \textcolor{comment}{// Master at p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08416}08416           \textcolor{comment}{// p\_type\_master = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08417}08417         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08418}08418       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08419}08419       \textcolor{comment}{// Neighbour must be smaller than me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08420}08420       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08421}08421       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08422}08422         \textcolor{comment}{// Master at h-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08423}08423         \textcolor{comment}{// h\_type\_master = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08424}08424       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08425}08425     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08426}08426     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08427}08427     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08428}08428       \textcolor{comment}{// Face is on a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08429}08429     \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08430}08430 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08431}08431     \textcolor{comment}{// Work out master/dependent edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08432}08432     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08433}08433     \textcolor{keywordflow}{if} (h\_type\_dependent || p\_type\_dependent || \textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08434}08434     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08435}08435       \textcolor{comment}{// Get edges of face and the face that shares that edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08436}08436       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} face\_edge(4), face\_edge\_other\_face(4);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08437}08437       \textcolor{keywordflow}{switch} (my\_face)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08438}08438       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08439}08439         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08440}08440           face\_edge[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{LB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08441}08441           face\_edge\_other\_face[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08442}08442           face\_edge[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{LF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08443}08443           face\_edge\_other\_face[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08444}08444           face\_edge[2] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{LD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08445}08445           face\_edge\_other\_face[2] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08446}08446           face\_edge[3] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{LU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08447}08447           face\_edge\_other\_face[3] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08448}08448           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08449}08449         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08450}08450           face\_edge[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{RB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08451}08451           face\_edge\_other\_face[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08452}08452           face\_edge[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{RF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08453}08453           face\_edge\_other\_face[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08454}08454           face\_edge[2] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{RD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08455}08455           face\_edge\_other\_face[2] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08456}08456           face\_edge[3] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{RU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08457}08457           face\_edge\_other\_face[3] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08458}08458           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08459}08459         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08460}08460           face\_edge[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{UB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08461}08461           face\_edge\_other\_face[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08462}08462           face\_edge[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{UF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08463}08463           face\_edge\_other\_face[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08464}08464           face\_edge[2] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{LU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08465}08465           face\_edge\_other\_face[2] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08466}08466           face\_edge[3] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{RU}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08467}08467           face\_edge\_other\_face[3] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08468}08468           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08469}08469         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08470}08470           face\_edge[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{DB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08471}08471           face\_edge\_other\_face[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08472}08472           face\_edge[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{DF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08473}08473           face\_edge\_other\_face[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08474}08474           face\_edge[2] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{LD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08475}08475           face\_edge\_other\_face[2] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08476}08476           face\_edge[3] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{RD}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08477}08477           face\_edge\_other\_face[3] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08478}08478           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08479}08479         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08480}08480           face\_edge[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{DB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08481}08481           face\_edge\_other\_face[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08482}08482           face\_edge[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{UB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08483}08483           face\_edge\_other\_face[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08484}08484           face\_edge[2] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{LB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08485}08485           face\_edge\_other\_face[2] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08486}08486           face\_edge[3] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{RB}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08487}08487           face\_edge\_other\_face[3] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08488}08488           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08489}08489         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08490}08490           face\_edge[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{DF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08491}08491           face\_edge\_other\_face[0] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08492}08492           face\_edge[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{UF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08493}08493           face\_edge\_other\_face[1] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08494}08494           face\_edge[2] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{LF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08495}08495           face\_edge\_other\_face[2] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08496}08496           face\_edge[3] = \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{RF}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08497}08497           face\_edge\_other\_face[3] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08498}08498           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08499}08499         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08500}08500           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08501}08501             \textcolor{stringliteral}{"{}my\_face not L, R, D, U, B, F\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08502}08502             \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08503}08503             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08504}08504       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08505}08505 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08506}08506       \textcolor{comment}{// Loop over edges of face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08507}08507       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 4; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08508}08508       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08509}08509         \textcolor{comment}{// Get edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08510}08510         \textcolor{keywordtype}{unsigned} my\_edge = face\_edge[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08511}08511 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08512}08512         \textcolor{comment}{// Separate storage for edge mortaring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08513}08513         \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* edge\_neigh\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08514}08514         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} edge\_translate\_s(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08515}08515         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} edge\_s\_lo\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08516}08516         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} edge\_s\_hi\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08517}08517         \textcolor{keywordtype}{int} neigh\_edge = 0, edge\_diff\_level = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08518}08518         \textcolor{keywordtype}{unsigned} edge\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08519}08519           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(\textcolor{keyword}{this})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08520}08520             -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08521}08521 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08522}08522         \textcolor{comment}{// Temporary storage to keep track of master edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08523}08523         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} tmp\_edge\_translate\_s(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08524}08524         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} tmp\_edge\_s\_lo\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08525}08525         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} tmp\_edge\_s\_hi\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08526}08526         \textcolor{keywordtype}{int} tmp\_neigh\_edge, tmp\_edge\_diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08527}08527 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08528}08528         \textcolor{comment}{// Initially return the zero-\/th true edge neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08529}08529         \textcolor{keywordtype}{unsigned} i\_root\_edge\_neighbour = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08530}08530 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08531}08531         \textcolor{comment}{// Initialise the total number of true edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08532}08532         \textcolor{keywordtype}{unsigned} nroot\_edge\_neighbour = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08533}08533 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08534}08534         \textcolor{comment}{// Flag to keep track of master status of my\_edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08535}08535         \textcolor{keywordtype}{bool} my\_edge\_is\_master = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08536}08536         \textcolor{comment}{// unsigned master\_edge\_index=0;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08537}08537 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08538}08538         \textcolor{comment}{// Keep searching until we've found the node or until we've checked}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08539}08539         \textcolor{comment}{// all available edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08540}08540         \textcolor{keywordtype}{bool} keep\_searching = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08541}08541         \textcolor{keywordtype}{bool} search\_faces = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08542}08542         \textcolor{keywordtype}{bool} first\_face\_searched = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08543}08543         \textcolor{comment}{// unsigned index=0;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08544}08544         \textcolor{keywordflow}{while} (keep\_searching)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08545}08545         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08546}08546           \textcolor{comment}{// Pointer to edge neighbouring OcTree}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08547}08547           \mbox{\hyperlink{classoomph_1_1OcTree}{OcTree}}* tmp\_edge\_neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08548}08548 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08549}08549           \textcolor{comment}{// Looking in edge neighbours that are also face neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08550}08550           \textcolor{comment}{// if(index==0 || index==1)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08551}08551           \textcolor{keywordflow}{if} (search\_faces)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08552}08552           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08553}08553             \textcolor{keywordflow}{if} (!first\_face\_searched)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08554}08554             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08555}08555               \textcolor{comment}{// Find pointer to neighbour in this direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08556}08556               tmp\_edge\_neigh\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08557}08557                 this-\/>octree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1OcTree_a690c4fbbca73bd48c0bc3b2913a9b39c}{gteq\_face\_neighbour}}(my\_face,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08558}08558                                                        tmp\_edge\_translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08559}08559                                                        tmp\_edge\_s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08560}08560                                                        tmp\_edge\_s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08561}08561                                                        tmp\_neigh\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08562}08562                                                        tmp\_edge\_diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08563}08563                                                        in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08564}08564 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08565}08565               \textcolor{comment}{// Mark first face as searched}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08566}08566               first\_face\_searched = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08567}08567             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08568}08568             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08569}08569             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08570}08570               \textcolor{comment}{// Find pointer to neighbour in this direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08571}08571               tmp\_edge\_neigh\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08572}08572                 this-\/>octree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1OcTree_a690c4fbbca73bd48c0bc3b2913a9b39c}{gteq\_face\_neighbour}}(face\_edge\_other\_face[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08573}08573                                                        tmp\_edge\_translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08574}08574                                                        tmp\_edge\_s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08575}08575                                                        tmp\_edge\_s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08576}08576                                                        tmp\_neigh\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08577}08577                                                        tmp\_edge\_diff\_level,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08578}08578                                                        in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08579}08579 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08580}08580               \textcolor{comment}{// Search is finally exhausted}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08581}08581               keep\_searching = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08582}08582             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08583}08583           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08584}08584           \textcolor{comment}{// Looking in a true edge neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08585}08585           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08586}08586           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08587}08587             \textcolor{comment}{// Find pointer to neighbour in this direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08588}08588             tmp\_edge\_neigh\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08589}08589               this-\/>octree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1OcTree_ab5a26409cd49a430095915c76060f476}{gteq\_true\_edge\_neighbour}}(my\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08590}08590                                                           i\_root\_edge\_neighbour,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08591}08591                                                           nroot\_edge\_neighbour,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08592}08592                                                           tmp\_edge\_translate\_s,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08593}08593                                                           tmp\_edge\_s\_lo\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08594}08594                                                           tmp\_edge\_s\_hi\_neigh,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08595}08595                                                           tmp\_neigh\_edge,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08596}08596                                                           tmp\_edge\_diff\_level);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08597}08597           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08598}08598 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08599}08599           \textcolor{comment}{// Set up booleans}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08600}08600           \textcolor{comment}{// bool h\_type\_edge\_master = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08601}08601           \textcolor{comment}{// bool h\_type\_edge\_dependent  = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08602}08602           \textcolor{comment}{// bool p\_type\_edge\_master = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08603}08603           \textcolor{comment}{// bool p\_type\_edge\_dependent  = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08604}08604 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08605}08605           \textcolor{comment}{// Flag to check if we have a new edge master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08606}08606           \textcolor{keywordtype}{bool} new\_edge\_master = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08607}08607 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08608}08608           \textcolor{comment}{// Edge neighbour exists}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08609}08609           \textcolor{keywordflow}{if} (tmp\_edge\_neigh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08610}08610           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08611}08611             \textcolor{comment}{// Check if neighbour is bigger than my biggest neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08612}08612             \textcolor{keywordflow}{if} (tmp\_edge\_diff\_level < edge\_diff\_level)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08613}08613             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08614}08614               \textcolor{comment}{// Dependent at h-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08615}08615               \textcolor{comment}{// h\_type\_edge\_dependent = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08616}08616               new\_edge\_master = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08617}08617               \textcolor{comment}{// Update edge\_diff\_level and p-\/order}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08618}08618               edge\_diff\_level = tmp\_edge\_diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08619}08619               edge\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08620}08620                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08621}08621                   tmp\_edge\_neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08622}08622                   -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08623}08623             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08624}08624             \textcolor{comment}{// Check if neighbour is the same size as my biggest neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08625}08625             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tmp\_edge\_diff\_level == edge\_diff\_level \&\&}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08626}08626                      tmp\_edge\_neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a31e4123b40f6fb52d180a154c9123e85}{nsons}}() == 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08627}08627             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08628}08628               \textcolor{comment}{// Neighbour is same size as me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08629}08629               \textcolor{comment}{// Find p-\/orders of each element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08630}08630               \textcolor{comment}{// unsigned my\_p\_order =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08631}08631               \textcolor{comment}{// dynamic\_cast<PRefineableQElement<3,INITIAL\_NNODE\_1D>*>}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08632}08632               \textcolor{comment}{//  (this)-\/>p\_order();}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08633}08633               \textcolor{keywordtype}{unsigned} tmp\_edge\_neigh\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08634}08634                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08635}08635                   tmp\_edge\_neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08636}08636                   -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08637}08637 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08638}08638               \textcolor{comment}{// Check for p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08639}08639               \textcolor{keywordflow}{if} (tmp\_edge\_neigh\_p\_order == edge\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08640}08640               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08641}08641                 \textcolor{comment}{// At a conforming interface}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08642}08642               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08643}08643               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (tmp\_edge\_neigh\_p\_order < edge\_p\_order)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08644}08644               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08645}08645                 \textcolor{comment}{// Dependent at p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08646}08646                 \textcolor{comment}{// p\_type\_edge\_dependent = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08647}08647                 new\_edge\_master = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08648}08648                 \textcolor{comment}{// Update edge\_diff\_level and p-\/order}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08649}08649                 edge\_diff\_level = tmp\_edge\_diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08650}08650                 edge\_p\_order =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08651}08651                   \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08652}08652                     tmp\_edge\_neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08653}08653                     -\/>p\_order();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08654}08654               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08655}08655               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08656}08656               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08657}08657                 \textcolor{comment}{// Master at p-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08658}08658                 \textcolor{comment}{// p\_type\_edge\_master = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08659}08659               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08660}08660             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08661}08661             \textcolor{comment}{// Neighbour must be smaller than me}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08662}08662             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08663}08663             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08664}08664               \textcolor{comment}{// Master at h-\/type non-\/conformity}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08665}08665               \textcolor{comment}{// h\_type\_edge\_master = true;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08666}08666             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08667}08667           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08668}08668           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08669}08669           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08670}08670             \textcolor{comment}{// Edge is on a boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08671}08671           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08672}08672 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08673}08673           \textcolor{comment}{// Update master neighbour information}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08674}08674           \textcolor{keywordflow}{if} (new\_edge\_master)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08675}08675           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08676}08676             \textcolor{comment}{// Store new master edge information}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08677}08677             edge\_neigh\_pt = tmp\_edge\_neigh\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08678}08678             edge\_translate\_s = tmp\_edge\_translate\_s;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08679}08679             edge\_s\_lo\_neigh = tmp\_edge\_s\_lo\_neigh;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08680}08680             edge\_s\_hi\_neigh = tmp\_edge\_s\_hi\_neigh;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08681}08681             neigh\_edge = tmp\_neigh\_edge;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08682}08682             edge\_diff\_level = tmp\_edge\_diff\_level;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08683}08683 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08684}08684             \textcolor{comment}{// Set this edge as dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08685}08685             my\_edge\_is\_master = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08686}08686           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08687}08687 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08688}08688           \textcolor{comment}{// Keep searching, but only if there are further edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08689}08689           \textcolor{comment}{// Try next root edge neighbour}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08690}08690           i\_root\_edge\_neighbour++;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08691}08691 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08692}08692           \textcolor{comment}{// Increment counter}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08693}08693           \textcolor{comment}{// index++;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08694}08694 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08695}08695           \textcolor{comment}{// Have we exhausted the search over true edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08696}08696           \textcolor{comment}{// if (index>2 \&\& i\_root\_edge\_neighbour>=nroot\_edge\_neighbour)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08697}08697           \textcolor{keywordflow}{if} (i\_root\_edge\_neighbour >= nroot\_edge\_neighbour)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08698}08698           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08699}08699             \textcolor{comment}{// keep\_searching = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08700}08700             \textcolor{comment}{// Extend search to face neighours (these are edge neighbours too)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08701}08701             search\_faces = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08702}08702           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08703}08703 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08704}08704         \} \textcolor{comment}{// End of while keep searching over all face and true edge neighbours}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08705}08705 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08706}08706         \textcolor{comment}{// Now do edge mortaring to enforce the mortar vertex matching condition}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08707}08707         \textcolor{keywordflow}{if} (!my\_edge\_is\_master)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08708}08708         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08709}08709           \textcolor{comment}{// Compute the active coordinate index along the this side of mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08710}08710           \textcolor{keywordtype}{unsigned} active\_coord\_index;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08711}08711           \textcolor{keywordflow}{switch} (my\_edge)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08712}08712           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08713}08713             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{DB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08714}08714             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{DF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08715}08715             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{UB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08716}08716             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{UF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08717}08717               active\_coord\_index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08718}08718               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08719}08719             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{LB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08720}08720             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{RB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08721}08721             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{LF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08722}08722             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{RF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08723}08723               active\_coord\_index = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08724}08724               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08725}08725             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08726}08726             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08727}08727             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08728}08728             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08729}08729               active\_coord\_index = 2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08730}08730               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08731}08731             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08732}08732               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08733}08733                 \textcolor{stringliteral}{"{}Cannot transform coordinates"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08734}08734                 \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08735}08735                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08736}08736           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08737}08737 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08738}08738           \textcolor{comment}{// Get pointer to neighbouring master element (in p-\/refineable form)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08739}08739           \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}* edge\_neigh\_obj\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08740}08740           edge\_neigh\_obj\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08741}08741             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08742}08742               edge\_neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08743}08743 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08744}08744           \textcolor{comment}{// Create vector of master and dependent nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08745}08745           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08746}08746           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} master\_node\_pt, dependent\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08747}08747           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} master\_node\_number, dependent\_node\_number;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08748}08748           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> dependent\_node\_s\_fraction;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08749}08749 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08750}08750           \textcolor{comment}{// Number of nodes in one dimension}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08751}08751           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} my\_n\_p = this-\/>ninterpolating\_node\_1d(value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08752}08752           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} neigh\_n\_p =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08753}08753             edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a850180084aaf164550b4f4978b42cda7}{ninterpolating\_node\_1d}}(value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08754}08754 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08755}08755           \textcolor{comment}{// Storage for pointers to the nodes and their numbers along the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08756}08756           \textcolor{comment}{// master edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08757}08757           \textcolor{keywordtype}{unsigned} neighbour\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08758}08758           \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08759}08759 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08760}08760           \textcolor{comment}{// Loop over nodes along the edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08761}08761           \textcolor{keywordtype}{bool} master\_is\_not\_edge = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08762}08762           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < neigh\_n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08763}08763           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08764}08764             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s0space = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08765}08765             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s1space = neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08766}08766             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s2space = neigh\_n\_p * neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08767}08767 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08768}08768             \textcolor{comment}{// Find the neighbour's node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08769}08769             \textcolor{keywordflow}{switch} (neigh\_edge)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08770}08770             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08771}08771               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{DB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08772}08772                 neighbour\_node\_number = i0 * s0space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08773}08773                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08774}08774                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08775}08775                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08776}08776               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{UB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08777}08777                 neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08778}08778                   (neigh\_n\_p -\/ 1) * s1space + i0 * s0space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08779}08779                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08780}08780                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08781}08781                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08782}08782               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{DF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08783}08783                 neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08784}08784                   (neigh\_n\_p -\/ 1) * s2space + i0 * s0space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08785}08785                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08786}08786                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08787}08787                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08788}08788               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{UF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08789}08789                 neighbour\_node\_number = (neigh\_n\_p -\/ 1) * s1space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08790}08790                                         (neigh\_n\_p -\/ 1) * s2space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08791}08791                                         i0 * s0space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08792}08792                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08793}08793                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08794}08794                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08795}08795 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08796}08796               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{LB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08797}08797                 neighbour\_node\_number = i0 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08798}08798                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08799}08799                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08800}08800                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08801}08801               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{RB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08802}08802                 neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08803}08803                   (neigh\_n\_p -\/ 1) * s0space + i0 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08804}08804                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08805}08805                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08806}08806                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08807}08807               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{LF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08808}08808                 neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08809}08809                   (neigh\_n\_p -\/ 1) * s2space + i0 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08810}08810                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08811}08811                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08812}08812                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08813}08813               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{RF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08814}08814                 neighbour\_node\_number = (neigh\_n\_p -\/ 1) * s0space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08815}08815                                         (neigh\_n\_p -\/ 1) * s2space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08816}08816                                         i0 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08817}08817                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08818}08818                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08819}08819                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08820}08820 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08821}08821               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08822}08822                 neighbour\_node\_number = i0 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08823}08823                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08824}08824                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08825}08825                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08826}08826               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08827}08827                 neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08828}08828                   (neigh\_n\_p -\/ 1) * s0space + i0 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08829}08829                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08830}08830                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08831}08831                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08832}08832               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08833}08833                 neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08834}08834                   (neigh\_n\_p -\/ 1) * s1space + i0 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08835}08835                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08836}08836                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08837}08837                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08838}08838               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08839}08839                 neighbour\_node\_number = (neigh\_n\_p -\/ 1) * s0space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08840}08840                                         (neigh\_n\_p -\/ 1) * s1space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08841}08841                                         i0 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08842}08842                 neighbour\_node\_pt = edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08843}08843                   neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08844}08844                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08845}08845 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08846}08846               \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08847}08847                 \textcolor{comment}{// Master 'edge' may be a face instead, so no need to throw an}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08848}08848                 \textcolor{comment}{// error}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08849}08849                 master\_is\_not\_edge = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08850}08850             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08851}08851 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08852}08852             \textcolor{keywordflow}{if} (master\_is\_not\_edge) \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08853}08853 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08854}08854             \textcolor{comment}{// Set node as master node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08855}08855             master\_node\_number.push\_back(neighbour\_node\_number);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08856}08856             master\_node\_pt.push\_back(neighbour\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08857}08857           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08858}08858 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08859}08859           \textcolor{comment}{// Now if edge is really a face (from an edge neighbour that isn't}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08860}08860           \textcolor{comment}{// a true edge neighbour) each node on the face is (potentially) a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08861}08861           \textcolor{comment}{// master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08862}08862           \textcolor{keywordflow}{if} (master\_is\_not\_edge)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08863}08863           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08864}08864             \textcolor{comment}{// Loop over nodes along the face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08865}08865             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < neigh\_n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08866}08866             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08867}08867               \textcolor{comment}{// Loop over nodes along the face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08868}08868               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < neigh\_n\_p; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08869}08869               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08870}08870                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s0space = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08871}08871                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s1space = neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08872}08872                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s2space = neigh\_n\_p * neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08873}08873 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08874}08874                 \textcolor{comment}{// Find the neighbour's node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08875}08875                 \textcolor{keywordflow}{switch} (neigh\_edge)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08876}08876                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08877}08877                   \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08878}08878                     neighbour\_node\_number = i0 * s0space + i1 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08879}08879                     neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08880}08880                       edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08881}08881                         neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08882}08882                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08883}08883                   \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08884}08884                     neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08885}08885                       (neigh\_n\_p -\/ 1) * s2space + i0 * s0space + i1 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08886}08886                     neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08887}08887                       edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08888}08888                         neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08889}08889                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08890}08890                   \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08891}08891                     neighbour\_node\_number = i0 * s0space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08892}08892                     neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08893}08893                       edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08894}08894                         neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08895}08895                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08896}08896                   \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08897}08897                     neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08898}08898                       (neigh\_n\_p -\/ 1) * s1space + i0 * s0space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08899}08899                     neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08900}08900                       edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08901}08901                         neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08902}08902                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08903}08903                   \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08904}08904                     neighbour\_node\_number = i0 * s1space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08905}08905                     neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08906}08906                       edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08907}08907                         neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08908}08908                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08909}08909                   \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08910}08910                     neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08911}08911                       (neigh\_n\_p -\/ 1) * s0space + i0 * s1space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08912}08912                     neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08913}08913                       edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08914}08914                         neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08915}08915                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08916}08916 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08917}08917                   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08918}08918                     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}neigh\_edge not recognised\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08919}08919                                         \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08920}08920                                         \textcolor{stringliteral}{"{}1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08921}08921                                         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08922}08922                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08923}08923 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08924}08924                 \textcolor{comment}{// Set node as master node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08925}08925                 master\_node\_number.push\_back(neighbour\_node\_number);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08926}08926                 master\_node\_pt.push\_back(neighbour\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08927}08927               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08928}08928             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08929}08929           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08930}08930 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08931}08931           \textcolor{comment}{// Storage for pointers to the local nodes and their numbers along my}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08932}08932           \textcolor{comment}{// edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08933}08933           \textcolor{keywordtype}{unsigned} local\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08934}08934           \mbox{\hyperlink{classoomph_1_1Node}{Node}}* local\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08935}08935 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08936}08936           \textcolor{comment}{// Loop over the nodes along my edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08937}08937           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < my\_n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08938}08938           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08939}08939             \textcolor{comment}{// Storage for the fractional position of the node in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08940}08940             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08941}08941 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08942}08942             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s0space = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08943}08943             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s1space = my\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08944}08944             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s2space = my\_n\_p * my\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08945}08945 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08946}08946             \textcolor{comment}{// Find the local node and the fractional position of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08947}08947             \textcolor{comment}{// which depends on the edge, of course}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08948}08948             \textcolor{keywordflow}{switch} (my\_edge)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08949}08949             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08950}08950               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aeb944d7232b126b9034678f074c3078e}{DB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08951}08951                 s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08952}08952                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08953}08953                 s\_fraction[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08954}08954                 s\_fraction[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08955}08955                 local\_node\_number = i0 * s0space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08956}08956                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08957}08957                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08958}08958                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08959}08959               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40afd5ae3a92102eb1faf7e8e77c6742831}{UB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08960}08960                 s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08961}08961                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08962}08962                 s\_fraction[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08963}08963                 s\_fraction[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08964}08964                 local\_node\_number = (my\_n\_p -\/ 1) * s1space + i0 * s0space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08965}08965                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08966}08966                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08967}08967                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08968}08968               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a1dd915e02b2435707c33bc9f24b0d5c8}{DF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08969}08969                 s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08970}08970                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08971}08971                 s\_fraction[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08972}08972                 s\_fraction[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08973}08973                 local\_node\_number = (my\_n\_p -\/ 1) * s2space + i0 * s0space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08974}08974                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08975}08975                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08976}08976                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08977}08977               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a5f1bfb03fbc606141a391b7a2f9d4ea7}{UF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08978}08978                 s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08979}08979                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08980}08980                 s\_fraction[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08981}08981                 s\_fraction[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08982}08982                 local\_node\_number = (my\_n\_p -\/ 1) * s1space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08983}08983                                     (my\_n\_p -\/ 1) * s2space + i0 * s0space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08984}08984                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08985}08985                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08986}08986                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08987}08987 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08988}08988               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aff75a49d684424436ad419a818d0f480}{LB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08989}08989                 s\_fraction[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08990}08990                 s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08991}08991                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08992}08992                 s\_fraction[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08993}08993                 local\_node\_number = i0 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08994}08994                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08995}08995                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08996}08996                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08997}08997               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a593ad5f0759943d367efb7f308deabc4}{RB}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08998}08998                 s\_fraction[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l08999}08999                 s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09000}09000                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09001}09001                 s\_fraction[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09002}09002                 local\_node\_number = (my\_n\_p -\/ 1) * s0space + i0 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09003}09003                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09004}09004                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09005}09005                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09006}09006               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a854222a7a6f7470d6803ffb8d11180bc}{LF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09007}09007                 s\_fraction[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09008}09008                 s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09009}09009                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09010}09010                 s\_fraction[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09011}09011                 local\_node\_number = (my\_n\_p -\/ 1) * s2space + i0 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09012}09012                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09013}09013                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09014}09014                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09015}09015               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40aa2aad9af9821c9f410b188efa95908d1}{RF}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09016}09016                 s\_fraction[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09017}09017                 s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09018}09018                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09019}09019                 s\_fraction[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09020}09020                 local\_node\_number = (my\_n\_p -\/ 1) * s0space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09021}09021                                     (my\_n\_p -\/ 1) * s2space + i0 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09022}09022                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09023}09023                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09024}09024                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09025}09025 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09026}09026               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a91fa3c9ccf834f81f50238be7bcc5269}{LD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09027}09027                 s\_fraction[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09028}09028                 s\_fraction[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09029}09029                 s\_fraction[2] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09030}09030                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 2, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09031}09031                 local\_node\_number = i0 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09032}09032                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09033}09033                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09034}09034                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09035}09035               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a37246039cac1119e55029efcae57ef85}{RD}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09036}09036                 s\_fraction[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09037}09037                 s\_fraction[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09038}09038                 s\_fraction[2] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09039}09039                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 2, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09040}09040                 local\_node\_number = (my\_n\_p -\/ 1) * s0space + i0 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09041}09041                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09042}09042                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09043}09043                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09044}09044               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40ae7245a89994ff850f2a88ea7bff7e7f8}{LU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09045}09045                 s\_fraction[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09046}09046                 s\_fraction[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09047}09047                 s\_fraction[2] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09048}09048                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 2, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09049}09049                 local\_node\_number = (my\_n\_p -\/ 1) * s1space + i0 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09050}09050                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09051}09051                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09052}09052                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09053}09053               \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a72d8c5c6b2d5fa77e57930951a567546}{RU}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09054}09054                 s\_fraction[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09055}09055                 s\_fraction[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09056}09056                 s\_fraction[2] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09057}09057                   local\_one\_d\_fraction\_of\_interpolating\_node(i0, 2, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09058}09058                 local\_node\_number = (my\_n\_p -\/ 1) * s0space +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09059}09059                                     (my\_n\_p -\/ 1) * s1space + i0 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09060}09060                 local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09061}09061                   this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09062}09062                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09063}09063 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09064}09064               \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09065}09065                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09066}09066                   \textcolor{stringliteral}{"{}my\_edge not recognised\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09067}09067                   \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09068}09068                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09069}09069             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09070}09070 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09071}09071             \textcolor{comment}{// Add node to vector of dependent element nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09072}09072             dependent\_node\_number.push\_back(local\_node\_number);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09073}09073             dependent\_node\_pt.push\_back(local\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09074}09074 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09075}09075             \textcolor{comment}{// Store node's local fraction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09076}09076             dependent\_node\_s\_fraction.push\_back(s\_fraction);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09077}09077           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09078}09078 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09079}09079           \textcolor{comment}{// Store the number of dependent and master nodes for use later}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09080}09080           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dependent\_nodes = dependent\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09081}09081           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_master\_nodes = master\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09082}09082           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} dependent\_element\_nnode\_1d = my\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09083}09083           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} master\_element\_nnode\_1d = neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09084}09084 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09085}09085           \textcolor{comment}{// Storage for master shapes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09086}09086           \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} master\_shapes(edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8b1b5031b55141567ba24913a21534f4}{ninterpolating\_node}}(value\_id));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09087}09087 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09088}09088           \textcolor{comment}{// Get master and dependent nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09089}09089           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09090}09090           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} dependent\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09091}09091           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} dependent\_weight(dependent\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09092}09092           \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(dependent\_element\_nnode\_1d,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09093}09093                               dependent\_nodal\_position,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09094}09094                               dependent\_weight);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09095}09095           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} master\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09096}09096           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} master\_weight(master\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09097}09097           \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09098}09098             master\_element\_nnode\_1d, master\_nodal\_position, master\_weight);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09099}09099 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09100}09100           \textcolor{comment}{// Apply the (1D) vertex matching condition}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09101}09101           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09102}09102           \textcolor{comment}{// Vertiex matching is ensured automatically in cases where there is a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09103}09103           \textcolor{comment}{// node at each end of the mortar that is shared between the master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09104}09104           \textcolor{comment}{// and dependent elements. Where this is not the case, the vertex}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09105}09105           \textcolor{comment}{// matching condition must be enforced by constraining the value of}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09106}09106           \textcolor{comment}{// the unknown at the node on the dependent side to be the same as the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09107}09107           \textcolor{comment}{// value at that location in the master.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09108}09108 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09109}09109           \textcolor{comment}{// Store positions of the mortar vertex/non-\/vertex nodes in the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09110}09110           \textcolor{comment}{// dependent element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09111}09111           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_mortar\_vertices = 2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09112}09112           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} vertex\_pos(n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09113}09113           vertex\_pos[0] = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09114}09114           vertex\_pos[1] = this-\/>ninterpolating\_node\_1d(value\_id) -\/ 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09115}09115           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} non\_vertex\_pos(my\_n\_p -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09116}09116           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < my\_n\_p -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09117}09117           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09118}09118             non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09119}09119           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09120}09120 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09121}09121           \textcolor{comment}{// If the node is on a master edge, we may be setting the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09122}09122           \textcolor{comment}{// hanging info incorrectly. Hanging schemes (if they are}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09123}09123           \textcolor{comment}{// required) for such nodes are instead computed by the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09124}09124           \textcolor{comment}{// dependent edge. We dont't want to overwrite them here!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09125}09125           std::vector<bool> mortar\_vertex\_on\_master\_edge(n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09126}09126           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_mortar\_vertices; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09127}09127           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09128}09128             \textcolor{comment}{// Check if each node is on the master edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09129}09129             mortar\_vertex\_on\_master\_edge[v] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09130}09130             \textcolor{keywordtype}{unsigned} non\_extreme\_coordinate = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09131}09131             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09132}09132             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09133}09133             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09134}09134               \textcolor{comment}{// Work out this node's location in the master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09135}09135               s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09136}09136                 edge\_s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09137}09137                 dependent\_node\_s\_fraction[vertex\_pos[v]][edge\_translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09138}09138                   (edge\_s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ edge\_s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09139}09139 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09140}09140               \textcolor{comment}{// Check if local coordinate in master element takes non-\/extreme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09141}09141               \textcolor{comment}{// value}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09142}09142               \textcolor{keywordflow}{if} (std::fabs(std::fabs(s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) -\/ 1.0) > 1.0e-\/14)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09143}09143               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09144}09144                 non\_extreme\_coordinate++;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09145}09145                 \textcolor{keywordflow}{if} (non\_extreme\_coordinate > 1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09146}09146                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09147}09147                   mortar\_vertex\_on\_master\_edge[v] = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09148}09148                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09149}09149                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09150}09150               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09151}09151             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09152}09152           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09153}09153 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09154}09154           \textcolor{comment}{// Now work out if my edge coincides with the master edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09155}09155           \textcolor{keywordtype}{bool} my\_edge\_coincides\_with\_master = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09156}09156           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_mortar\_vertices; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09157}09157           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09158}09158             my\_edge\_coincides\_with\_master =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09159}09159               my\_edge\_coincides\_with\_master \&\& mortar\_vertex\_on\_master\_edge[v];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09160}09160           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09161}09161 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09162}09162           \textcolor{comment}{// Check if we need to apply the (1D) vertex matching condition at the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09163}09163           \textcolor{comment}{// mortar vertices. This is trivially satisfied if the node is shared}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09164}09164           \textcolor{comment}{// with the master, but if not then we need to constrain it.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09165}09165           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_mortar\_vertices; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09166}09166           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09167}09167             \textcolor{comment}{// Don't make hanging node if my edge doesn't coincide with}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09168}09168             \textcolor{comment}{// the master edge *and* this node is on the master edge!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09169}09169             \textcolor{comment}{// (We are not in a position to determine its hanging status.)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09170}09170             \textcolor{keywordflow}{if} ((!my\_edge\_coincides\_with\_master) \&\&}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09171}09171                 mortar\_vertex\_on\_master\_edge[v])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09172}09172               \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09173}09173 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09174}09174             \textcolor{comment}{// Search master node storage for the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09175}09175             \textcolor{keywordtype}{bool} node\_is\_shared = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09176}09176             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < master\_node\_pt.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09177}09177             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09178}09178               \textcolor{keywordflow}{if} (dependent\_node\_pt[vertex\_pos[v]] == master\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09179}09179               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09180}09180                 node\_is\_shared = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09181}09181                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09182}09182               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09183}09183             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09184}09184 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09185}09185             \textcolor{comment}{// If the node is not shared then we must constrain its value by}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09186}09186             \textcolor{comment}{// setting up a hanging scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09187}09187             \textcolor{keywordflow}{if} (!node\_is\_shared)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09188}09188             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09189}09189               \textcolor{comment}{// Calculate weights. These are just the master shapes evaluated}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09190}09190               \textcolor{comment}{// at this dependent node's position}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09191}09191 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09192}09192               \textcolor{comment}{// Work out this node's location in the master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09193}09193               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09194}09194               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09195}09195               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09196}09196                 s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = edge\_s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09197}09197                                 dependent\_node\_s\_fraction[vertex\_pos[v]]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09198}09198                                                          [edge\_translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09199}09199                                   (edge\_s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ edge\_s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09200}09200               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09201}09201 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09202}09202               \textcolor{comment}{// Get master shapes at dependent nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09203}09203               edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8ca420443c28708e5c6315a80f520137}{interpolating\_basis}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09204}09204                 s\_in\_neigh, master\_shapes, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09205}09205 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09206}09206               \textcolor{comment}{// Remove any existing hanging node info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09207}09207               \textcolor{comment}{// (This may be a bit wasteful, but guarantees correctness)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09208}09208               dependent\_node\_pt[vertex\_pos[v]]-\/>set\_nonhanging();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09209}09209 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09210}09210               \textcolor{comment}{// Don't include master nodes with zero weights}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09211}09211               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} master\_node\_zero\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09212}09212               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master\_nodes; m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09213}09213               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09214}09214                 \textcolor{comment}{// Compare weights to some (small) tolerance}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09215}09215                 \textcolor{keywordflow}{if} (std::fabs(master\_shapes[master\_node\_number[m]]) < 1.0e-\/14)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09216}09216                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09217}09217                   \textcolor{comment}{// Store}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09218}09218                   master\_node\_zero\_weight.push\_back(m);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09219}09219                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09220}09220               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09221}09221 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09222}09222               \textcolor{comment}{// Set up hanging scheme for this node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09223}09223               \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* explicit\_hang\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09224}09224                 \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}(n\_master\_nodes -\/ master\_node\_zero\_weight.size());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09225}09225               \textcolor{keywordtype}{unsigned} mindex = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09226}09226               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master\_nodes; m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09227}09227               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09228}09228                 \textcolor{comment}{// Check that master doesn't have zero weight}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09229}09229                 \textcolor{keywordtype}{bool} skip = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09230}09230                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < master\_node\_zero\_weight.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09231}09231                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09232}09232                   \textcolor{keywordflow}{if} (m == master\_node\_zero\_weight[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) skip = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09233}09233                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09234}09234 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09235}09235                 \textcolor{comment}{// Add pointer and weight to hang info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09236}09236                 \textcolor{keywordflow}{if} (!skip)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09237}09237                   explicit\_hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_afe4042d5805342d5e12b6a28e376885a}{set\_master\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09238}09238                     mindex++,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09239}09239                     master\_node\_pt[m],}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09240}09240                     master\_shapes[master\_node\_number[m]]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09241}09241               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09242}09242 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09243}09243 \textcolor{comment}{              /// / Set up hanging scheme for this node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09244}09244 \textcolor{comment}{}              \textcolor{comment}{// HangInfo* explicit\_hang\_pt = new HangInfo(n\_master\_nodes);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09245}09245               \textcolor{comment}{// for(unsigned m=0; m<n\_master\_nodes; m++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09246}09246               \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09247}09247               \textcolor{comment}{//  explicit\_hang\_pt-\/>set\_master\_node\_pt(m,master\_node\_pt[m],master\_shapes[master\_node\_number[m]]);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09248}09248               \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09249}09249 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09250}09250               \textcolor{comment}{// Make node hang}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09251}09251               dependent\_node\_pt[vertex\_pos[v]]-\/>set\_hanging\_pt(explicit\_hang\_pt,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09252}09252                                                                -\/1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09253}09253 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09254}09254 \textcolor{comment}{              /// / Print out hanging scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09255}09255 \textcolor{comment}{}              \textcolor{comment}{// std::cout << "{}Hanging node: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09256}09256               \textcolor{comment}{//          << dependent\_node\_pt[vertex\_pos[v]]-\/>x(0) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09257}09257               \textcolor{comment}{//          << dependent\_node\_pt[vertex\_pos[v]]-\/>x(1) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09258}09258               \textcolor{comment}{//          << dependent\_node\_pt[vertex\_pos[v]]-\/>x(2) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09259}09259               \textcolor{comment}{//          << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09260}09260               \textcolor{comment}{// for(unsigned m=0; m<explicit\_hang\_pt-\/>nmaster(); m++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09261}09261               \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09262}09262               \textcolor{comment}{//  std::cout << "{}   m = "{} << m << "{}: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09263}09263               \textcolor{comment}{//            << explicit\_hang\_pt-\/>master\_node\_pt(m)-\/>x(0) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09264}09264               \textcolor{comment}{//            << explicit\_hang\_pt-\/>master\_node\_pt(m)-\/>x(1) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09265}09265               \textcolor{comment}{//            << explicit\_hang\_pt-\/>master\_node\_pt(m)-\/>x(2) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09266}09266               \textcolor{comment}{//            << "{}w = "{} << explicit\_hang\_pt-\/>master\_weight(m) << "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09267}09267               \textcolor{comment}{//            "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09268}09268               \textcolor{comment}{//            << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09269}09269               \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09270}09270 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09271}09271               \textcolor{comment}{// Check there are no zero weights at this stage}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09272}09272               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < explicit\_hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}(); m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09273}09273               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09274}09274                 \textcolor{keywordflow}{if} (std::fabs(explicit\_hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_ac49ebdd8957a658fe4a2420108d2dcee}{master\_weight}}(m)) < 1.0e-\/14)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09275}09275                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09276}09276                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09277}09277                     \textcolor{stringliteral}{"{}Master has zero weight!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09278}09278                     \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09279}09279                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09280}09280                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09281}09281               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09282}09282             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09283}09283           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09284}09284 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09285}09285           \textcolor{comment}{// Check that there are actually dependent nodes for which we still}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09286}09286           \textcolor{comment}{// need to construct a hanging scheme. If not then there is nothing}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09287}09287           \textcolor{comment}{// more to do.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09288}09288           \textcolor{keywordflow}{if} (n\_dependent\_nodes -\/ n\_mortar\_vertices > 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09289}09289           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09290}09290             \textcolor{comment}{// Assemble mass matrix for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09291}09291             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09292}09292             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} psi(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09293}09293             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} diag\_M(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09294}09294             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> shared\_node\_M(n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09295}09295             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < shared\_node\_M.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09296}09296             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09297}09297               shared\_node\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09298}09298             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09299}09299 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09300}09300             \textcolor{comment}{// Fill in part corresponding to dependent nodal positions (unknown)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09301}09301             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09302}09302             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09303}09303               \textcolor{comment}{// Use L'Hosptal's rule:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09304}09304               psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09305}09305                 pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09306}09306                 -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09307}09307                   dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09308}09308                   dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09309}09309               \textcolor{comment}{// Put in contribution}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09310}09310               diag\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dependent\_weight[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09311}09311             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09312}09312 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09313}09313             \textcolor{comment}{// Fill in part corresponding to dependent element vertices (known)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09314}09314             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < shared\_node\_M.size(); v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09315}09315             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09316}09316               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09317}09317                    \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09318}09318               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09319}09319                 \textcolor{comment}{// Check if denominator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09320}09320                 \textcolor{keywordflow}{if} (std::fabs(dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09321}09321                               dependent\_nodal\_position[vertex\_pos[v]]) >=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09322}09322                     1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09323}09323                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09324}09324                   \textcolor{comment}{// We're ok}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09325}09325                   psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09326}09326                     pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09327}09327                     \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09328}09328                       dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09329}09329                       dependent\_nodal\_position[vertex\_pos[v]]) /}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09330}09330                     (dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09331}09331                      dependent\_nodal\_position[vertex\_pos[v]]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09332}09332                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09333}09333                 \textcolor{comment}{// Check if numerator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09334}09334                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09335}09335                            dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09336}09336                            dependent\_nodal\_position[vertex\_pos[v]])) < 1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09337}09337                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09338}09338                   \textcolor{comment}{// We can use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09339}09339                   psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09340}09340                     pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09341}09341                     -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09342}09342                       dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09343}09343                       dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09344}09344                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09345}09345                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09346}09346                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09347}09347                   \textcolor{comment}{// We can't use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09348}09348                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09349}09349                     \textcolor{stringliteral}{"{}Cannot use l'Hopital's rule. Dividing by zero is not "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09350}09350                     \textcolor{stringliteral}{"{}allowed!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09351}09351                     \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09352}09352                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09353}09353                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09354}09354                 \textcolor{comment}{// Put in contribution}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09355}09355                 shared\_node\_M[v][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dependent\_weight[vertex\_pos[v]];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09356}09356               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09357}09357             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09358}09358 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09359}09359             \textcolor{comment}{// Assemble local projection matrix for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09360}09360             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09361}09361 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09362}09362             \textcolor{comment}{// Have only one local projection matrix because there is just one}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09363}09363             \textcolor{comment}{// master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09364}09364             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> P(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09365}09365             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09366}09366             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09367}09367               P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(n\_master\_nodes, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09368}09368             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09369}09369 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09370}09370             \textcolor{comment}{// Storage for local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09371}09371             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09372}09372 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09373}09373             \textcolor{comment}{// Sum contributions from master element shapes (quadrature).}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09374}09374             \textcolor{comment}{// The order of quadrature must be high enough to evaluate a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09375}09375             \textcolor{comment}{// polynomial of order N\_s + N\_m -\/ 3 exactly, where N\_s =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09376}09376             \textcolor{comment}{// n\_dependent\_nodes, N\_m = n\_master\_nodes. (Use pointers for the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09377}09377             \textcolor{comment}{// quadrature knots and weights so that data is not unnecessarily}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09378}09378             \textcolor{comment}{// copied)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09379}09379             \textcolor{comment}{// unsigned quadrature\_order =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09380}09380             \textcolor{comment}{// std::max(dependent\_element\_nnode\_1d,master\_element\_nnode\_1d);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09381}09381             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}*quadrature\_knot, *quadrature\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09382}09382             \textcolor{keywordflow}{if} (dependent\_element\_nnode\_1d >= master\_element\_nnode\_1d)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09383}09383             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09384}09384               \textcolor{comment}{// Use the same quadrature order as the dependent element (me)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09385}09385               quadrature\_knot = \&dependent\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09386}09386               quadrature\_weight = \&dependent\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09387}09387             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09388}09388             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09389}09389             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09390}09390               \textcolor{comment}{// Use the same quadrature order as the master element (neighbour)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09391}09391               quadrature\_knot = \&master\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09392}09392               quadrature\_weight = \&master\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09393}09393             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09394}09394 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09395}09395             \textcolor{comment}{// Quadrature loop}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09396}09396             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < (*quadrature\_weight).size(); q++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09397}09397             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09398}09398               \textcolor{comment}{// Evaluate mortar test functions at the quadrature knots in the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09399}09399               \textcolor{comment}{// dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09400}09400               \textcolor{comment}{// s[active\_coord\_index] = (*quadrature\_knot)[q];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09401}09401               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_on\_mortar(1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09402}09402               s\_on\_mortar[0] = (*quadrature\_knot)[q];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09403}09403 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09404}09404               \textcolor{comment}{// Get psi}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09405}09405               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dependent\_nodes -\/ n\_mortar\_vertices;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09406}09406                    k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09407}09407               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09408}09408                 \textcolor{comment}{// Check if denominator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09409}09409                 \textcolor{keywordflow}{if} (std::fabs(dependent\_nodal\_position[non\_vertex\_pos[k]] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09410}09410                               s\_on\_mortar[0]) >= 1.0e-\/08)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09411}09411                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09412}09412                   \textcolor{comment}{// We're ok}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09413}09413                   psi[k] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09414}09414                     pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ k -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09415}09415                     \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09416}09416                                         s\_on\_mortar[0]) /}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09417}09417                     (dependent\_nodal\_position[non\_vertex\_pos[k]] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09418}09418                      s\_on\_mortar[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09419}09419                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09420}09420                 \textcolor{comment}{// Check if numerator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09421}09421                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09422}09422                            dependent\_element\_nnode\_1d -\/ 1, s\_on\_mortar[0])) <}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09423}09423                          1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09424}09424                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09425}09425                   \textcolor{comment}{// We can use l'Hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09426}09426                   psi[k] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09427}09427                     pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ k -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09428}09428                     -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09429}09429                                           s\_on\_mortar[0]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09430}09430                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09431}09431                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09432}09432                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09433}09433                   \textcolor{comment}{// We can't use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09434}09434                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09435}09435                     \textcolor{stringliteral}{"{}Cannot use l'Hopital's rule. Dividing by zero is not "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09436}09436                     \textcolor{stringliteral}{"{}allowed!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09437}09437                     \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09438}09438                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09439}09439                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09440}09440               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09441}09441 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09442}09442               \textcolor{comment}{// Convert coordinate on mortar to local fraction in dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09443}09443               \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09444}09444               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09445}09445               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09446}09446               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09447}09447                 s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == active\_coord\_index) ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09448}09448                                   0.5 * (s\_on\_mortar[0] + 1.0) :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09449}09449                                   dependent\_node\_s\_fraction[vertex\_pos[0]][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09450}09450               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09451}09451 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09452}09452               \textcolor{comment}{// Project active coordinate into master element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09453}09453               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09454}09454               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09455}09455               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09456}09456                 s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = edge\_s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09457}09457                                 s\_fraction[edge\_translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09458}09458                                   (edge\_s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ edge\_s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09459}09459               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09460}09460 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09461}09461               \textcolor{comment}{// Evaluate master shapes at projections of local quadrature knots}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09462}09462               edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8ca420443c28708e5c6315a80f520137}{interpolating\_basis}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09463}09463                 s\_in\_neigh, master\_shapes, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09464}09464 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09465}09465               \textcolor{comment}{// Populate local projection matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09466}09466               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09467}09467                    \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09468}09468               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09469}09469                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_master\_nodes; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09470}09470                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09471}09471                   P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] += master\_shapes[master\_node\_number[j]] * psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09472}09472                              (*quadrature\_weight)[q];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09473}09473                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09474}09474               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09475}09475             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09476}09476 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09477}09477 \textcolor{comment}{            /// / Print out local projection matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09478}09478 \textcolor{comment}{}            \textcolor{comment}{// std::cout << "{}P\_e:"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09479}09479             \textcolor{comment}{// for(unsigned i=0; i<P.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09480}09480             \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09481}09481             \textcolor{comment}{//  for(unsigned j=0; j<P[i].size(); j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09482}09482             \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09483}09483             \textcolor{comment}{//    std::cout << "{}  "{} << P[i][j];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09484}09484             \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09485}09485             \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09486}09486             \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09487}09487 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09488}09488             \textcolor{comment}{// Assemble global projection matrices for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09489}09489             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09490}09490             \textcolor{comment}{// Need to subtract contributions from the "{}known unknowns"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09491}09491             \textcolor{comment}{// corresponding to the nodes at the vertices of the mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09492}09492 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09493}09493             \textcolor{comment}{// Assemble contributions from mortar vertex nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09494}09494             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_mortar\_vertices; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09495}09495             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09496}09496               \textcolor{comment}{// Convert coordinate on mortar to local fraction in dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09497}09497               \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09498}09498               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09499}09499               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09500}09500               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09501}09501                 s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09502}09502                   (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == active\_coord\_index) ?}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09503}09503                     0.5 * (dependent\_nodal\_position[vertex\_pos[v]] + 1.0) :}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09504}09504                     dependent\_node\_s\_fraction[vertex\_pos[0]][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09505}09505               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09506}09506 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09507}09507               \textcolor{comment}{// Project active coordinate into master element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09508}09508               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09509}09509               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09510}09510               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09511}09511                 s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = edge\_s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] +}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09512}09512                                 s\_fraction[edge\_translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09513}09513                                   (edge\_s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ edge\_s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09514}09514               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09515}09515 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09516}09516               \textcolor{comment}{// Get master shapes at dependent nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09517}09517               edge\_neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8ca420443c28708e5c6315a80f520137}{interpolating\_basis}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09518}09518                 s\_in\_neigh, master\_shapes, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09519}09519 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09520}09520               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09521}09521                    \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09522}09522               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09523}09523                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_master\_nodes; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09524}09524                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09525}09525                   P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][k] -\/=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09526}09526                     master\_shapes[master\_node\_number[k]] * shared\_node\_M[v][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09527}09527                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09528}09528               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09529}09529             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09530}09530 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09531}09531 \textcolor{comment}{            /// / Print out global projection matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09532}09532 \textcolor{comment}{}            \textcolor{comment}{// std::cout << "{}P:"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09533}09533             \textcolor{comment}{// for(unsigned i=0; i<P.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09534}09534             \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09535}09535             \textcolor{comment}{//  for(unsigned j=0; j<P[i].size(); j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09536}09536             \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09537}09537             \textcolor{comment}{//    std::cout << "{}  "{} << P[i][j];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09538}09538             \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09539}09539             \textcolor{comment}{//  std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09540}09540             \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09541}09541             \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09542}09542 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09543}09543             \textcolor{comment}{// Solve mortar system}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09544}09544             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09545}09545             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09546}09546             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09547}09547               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_master\_nodes; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09548}09548               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09549}09549                 P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] /= diag\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09550}09550               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09551}09551             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09552}09552 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09553}09553 \textcolor{comment}{            /// / Print out solved global projection matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09554}09554 \textcolor{comment}{}            \textcolor{comment}{// std::cout << "{}solved P:"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09555}09555             \textcolor{comment}{// for(unsigned i=0; i<P.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09556}09556             \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09557}09557             \textcolor{comment}{//  for(unsigned j=0; j<P[i].size(); j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09558}09558             \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09559}09559             \textcolor{comment}{//    std::cout << "{}  "{} << P[i][j];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09560}09560             \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09561}09561             \textcolor{comment}{//  std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09562}09562             \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09563}09563             \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09564}09564 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09565}09565             \textcolor{comment}{// Create and populate structures to hold the hanging info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09566}09566             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09567}09567             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<HangInfo*>}} hang\_info\_pt(n\_dependent\_nodes);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09568}09568             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09569}09569             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09570}09570               \textcolor{comment}{// Don't include master nodes with zero weights}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09571}09571               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} master\_node\_zero\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09572}09572               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master\_nodes; m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09573}09573               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09574}09574                 \textcolor{comment}{// Compare weights to some (small) tolerance}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09575}09575                 \textcolor{keywordflow}{if} (std::fabs(P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][m]) < 1.0e-\/14)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09576}09576                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09577}09577                   \textcolor{comment}{// Store}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09578}09578                   master\_node\_zero\_weight.push\_back(m);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09579}09579                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09580}09580               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09581}09581 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09582}09582               \textcolor{comment}{// Set up hanging scheme for this node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09583}09583               hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09584}09584                 \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}(n\_master\_nodes -\/ master\_node\_zero\_weight.size());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09585}09585               \textcolor{keywordtype}{unsigned} mindex = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09586}09586               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < n\_master\_nodes; m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09587}09587               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09588}09588                 \textcolor{comment}{// Check that master doesn't have zero weight}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09589}09589                 \textcolor{keywordtype}{bool} skip = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09590}09590                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < master\_node\_zero\_weight.size(); k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09591}09591                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09592}09592                   \textcolor{keywordflow}{if} (m == master\_node\_zero\_weight[k]) skip = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09593}09593                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09594}09594 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09595}09595                 \textcolor{comment}{// Add pointer and weight to hang info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09596}09596                 \textcolor{keywordflow}{if} (!skip)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09597}09597                   hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>set\_master\_node\_pt(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09598}09598                     mindex++, master\_node\_pt[m], P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][m]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09599}09599               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09600}09600             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09601}09601 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09602}09602 \textcolor{comment}{            /// / Create structures to hold the hanging info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09603}09603 \textcolor{comment}{            /// /-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09604}09604 \textcolor{comment}{}            \textcolor{comment}{// Vector<HangInfo*> hang\_info\_pt(n\_dependent\_nodes);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09605}09605             \textcolor{comment}{// for (unsigned i=0; i<n\_dependent\_nodes-\/n\_mortar\_vertices; i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09606}09606             \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09607}09607             \textcolor{comment}{//  hang\_info\_pt[i] = new HangInfo(n\_master\_nodes);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09608}09608             \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09609}09609             \textcolor{comment}{//}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09610}09610 \textcolor{comment}{            /// / Copy information to hanging nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09611}09611 \textcolor{comment}{            /// /-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09612}09612 \textcolor{comment}{}            \textcolor{comment}{// for(unsigned i=0; i<n\_dependent\_nodes-\/n\_mortar\_vertices; i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09613}09613             \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09614}09614             \textcolor{comment}{//  for(unsigned j=0; j<n\_master\_nodes; j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09615}09615             \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09616}09616             \textcolor{comment}{//    hang\_info\_pt[i]-\/>set\_master\_node\_pt(j,master\_node\_pt[j],P[i][j]);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09617}09617             \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09618}09618             \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09619}09619 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09620}09620             \textcolor{comment}{// Set pointers to hanging info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09621}09621             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09622}09622             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09623}09623             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09624}09624               \textcolor{comment}{// Check that the node shoule actually hang.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09625}09625               \textcolor{comment}{// That is, if the polynomial orders of the elements at a p-\/type}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09626}09626               \textcolor{comment}{// non-\/conormity are both odd then the middle node on the edge is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09627}09627               \textcolor{comment}{// shared but a hanging scheme has been constructed for it.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09628}09628               \textcolor{keywordtype}{bool} node\_is\_really\_shared = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09629}09629               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>nmaster(); m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09630}09630               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09631}09631                 \textcolor{comment}{// We can simply check if the hanging scheme lists itself as a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09632}09632                 \textcolor{comment}{// master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09633}09633                 \textcolor{keywordflow}{if} (hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>master\_node\_pt(m) ==}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09634}09634                     dependent\_node\_pt[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09635}09635                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09636}09636                   node\_is\_really\_shared = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09637}09637 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09638}09638 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09639}09639                   \textcolor{comment}{// Also check the corresponding weight: it should be 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09640}09640                   \textcolor{keywordflow}{if} (std::fabs(hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>master\_weight(m) -\/ 1.0) >}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09641}09641                       1.0e-\/06)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09642}09642                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09643}09643                     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Something fishy here -\/-\/ with shared "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09644}09644                                         \textcolor{stringliteral}{"{}node at a mortar vertex"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09645}09645                                         \textcolor{stringliteral}{"{}PRefineableQElemen<2,INITIAL\_NNODE\_1D>"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09646}09646                                         \textcolor{stringliteral}{"{}t::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09647}09647                                         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09648}09648                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09649}09649 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09650}09650                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09651}09651               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09652}09652 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09653}09653               \textcolor{comment}{// Now we can make the node hang, if it isn't a shared node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09654}09654               \textcolor{keywordflow}{if} (!node\_is\_really\_shared)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09655}09655               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09656}09656                 dependent\_node\_pt[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]]-\/>set\_hanging\_pt(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09657}09657                   hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}], -\/1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09658}09658 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09659}09659 \textcolor{comment}{                /// / Print out hanging scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09660}09660 \textcolor{comment}{}                \textcolor{comment}{// std::cout << "{}Hanging node: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09661}09661                 \textcolor{comment}{//          << dependent\_node\_pt[non\_vertex\_pos[i]]-\/>x(0) << "{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09662}09662                 \textcolor{comment}{//          << dependent\_node\_pt[non\_vertex\_pos[i]]-\/>x(1) << "{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09663}09663                 \textcolor{comment}{//          << dependent\_node\_pt[non\_vertex\_pos[i]]-\/>x(2) << "{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09664}09664                 \textcolor{comment}{//          << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09665}09665                 \textcolor{comment}{// for(unsigned m=0; m<hang\_info\_pt[i]-\/>nmaster(); m++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09666}09666                 \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09667}09667                 \textcolor{comment}{//  std::cout << "{}   m = "{} << m << "{}: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09668}09668                 \textcolor{comment}{//            << hang\_info\_pt[i]-\/>master\_node\_pt(m)-\/>x(0) << "{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09669}09669                 \textcolor{comment}{//            << hang\_info\_pt[i]-\/>master\_node\_pt(m)-\/>x(1) << "{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09670}09670                 \textcolor{comment}{//            << hang\_info\_pt[i]-\/>master\_node\_pt(m)-\/>x(2) << "{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09671}09671                 \textcolor{comment}{//            << "{}w = "{} << hang\_info\_pt[i]-\/>master\_weight(m) <<}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09672}09672                 \textcolor{comment}{//            "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09673}09673                 \textcolor{comment}{//            << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09674}09674                 \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09675}09675               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09676}09676             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09677}09677 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09678}09678           \} \textcolor{comment}{// End of case where there are still dependent nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09679}09679 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09680}09680         \} \textcolor{comment}{// End of edge is dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09681}09681 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09682}09682       \} \textcolor{comment}{// End of loop over face edges}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09683}09683 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09684}09684     \} \textcolor{comment}{// End of if face is dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09685}09685 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09686}09686     \textcolor{comment}{// Now do the mortaring}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09687}09687     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09688}09688     \textcolor{keywordflow}{if} (h\_type\_dependent || p\_type\_dependent)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09689}09689     \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09690}09690       \textcolor{comment}{// Compute the active coordinate indices along the this side of mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09691}09691       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} active\_coord\_index(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09692}09692       \textcolor{keywordflow}{if} (my\_face == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}} || my\_face == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09693}09693       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09694}09694         active\_coord\_index[0] = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09695}09695         active\_coord\_index[1] = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09696}09696       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09697}09697       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (my\_face == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}} || my\_face == \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09698}09698       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09699}09699         active\_coord\_index[0] = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09700}09700         active\_coord\_index[1] = 2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09701}09701       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09702}09702       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (my\_face == \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}} || my\_face == \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}})}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09703}09703       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09704}09704         active\_coord\_index[0] = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09705}09705         active\_coord\_index[1] = 2;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09706}09706       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09707}09707       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09708}09708       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09709}09709         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09710}09710           \textcolor{stringliteral}{"{}Cannot transform coordinates"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09711}09711           \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09712}09712           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09713}09713       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09714}09714 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09715}09715       \textcolor{comment}{// Get pointer to neighbouring master element (in p-\/refineable form)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09716}09716       \mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}* neigh\_obj\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09717}09717       neigh\_obj\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1PRefineableQElement_3_013_00_01INITIAL__NNODE__1D_01_4}{PRefineableQElement<3, INITIAL\_NNODE\_1D>}}*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09718}09718         neigh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09719}09719 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09720}09720       \textcolor{comment}{// Create vector of master and dependent nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09721}09721       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09722}09722       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} master\_node\_pt, dependent\_node\_pt;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09723}09723       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} master\_node\_number, dependent\_node\_number;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09724}09724       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> dependent\_node\_s\_fraction;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09725}09725 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09726}09726       \textcolor{comment}{// Number of nodes in one dimension}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09727}09727       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} my\_n\_p = this-\/>ninterpolating\_node\_1d(value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09728}09728       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} neigh\_n\_p = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a850180084aaf164550b4f4978b42cda7}{ninterpolating\_node\_1d}}(value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09729}09729 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09730}09730       \textcolor{comment}{// Storage for pointers to the nodes and their numbers along the master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09731}09731       \textcolor{comment}{// edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09732}09732       \textcolor{keywordtype}{unsigned} neighbour\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09733}09733       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* neighbour\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09734}09734 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09735}09735       \textcolor{comment}{// Loop over nodes on the face}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09736}09736       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < neigh\_n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09737}09737       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09738}09738         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < neigh\_n\_p; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09739}09739         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09740}09740           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s0space = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09741}09741           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s1space = neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09742}09742           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s2space = neigh\_n\_p * neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09743}09743 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09744}09744           \textcolor{comment}{// Find the neighbour's node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09745}09745           \textcolor{keywordflow}{switch} (neigh\_face)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09746}09746           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09747}09747             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09748}09748               neighbour\_node\_number = i0 * s0space + i1 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09749}09749               neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09750}09750                 neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09751}09751               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09752}09752 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09753}09753             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09754}09754               neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09755}09755                 (neigh\_n\_p -\/ 1) * s2space + i0 * s0space + i1 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09756}09756               neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09757}09757                 neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09758}09758               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09759}09759 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09760}09760             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09761}09761               neighbour\_node\_number = i0 * s0space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09762}09762               neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09763}09763                 neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09764}09764               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09765}09765 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09766}09766             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09767}09767               neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09768}09768                 (neigh\_n\_p -\/ 1) * s1space + i0 * s0space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09769}09769               neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09770}09770                 neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09771}09771               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09772}09772 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09773}09773             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09774}09774               neighbour\_node\_number = i0 * s1space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09775}09775               neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09776}09776                 neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09777}09777               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09778}09778 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09779}09779             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09780}09780               neighbour\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09781}09781                 (neigh\_n\_p -\/ 1) * s0space + i0 * s1space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09782}09782               neighbour\_node\_pt = neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a7ce034d6dff9963f1620f878ca714052}{interpolating\_node\_pt}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09783}09783                 neighbour\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09784}09784               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09785}09785 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09786}09786             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09787}09787               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09788}09788                 \textcolor{stringliteral}{"{}my\_face not L, R, D, U, B, F\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09789}09789                 \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09790}09790                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09791}09791           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09792}09792 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09793}09793           \textcolor{comment}{// Set node as master node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09794}09794           master\_node\_number.push\_back(neighbour\_node\_number);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09795}09795           master\_node\_pt.push\_back(neighbour\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09796}09796         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09797}09797       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09798}09798 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09799}09799       \textcolor{comment}{// Storage for pointers to the local nodes and their numbers along my edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09800}09800       \textcolor{keywordtype}{unsigned} local\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09801}09801       \mbox{\hyperlink{classoomph_1_1Node}{Node}}* local\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09802}09802 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09803}09803       \textcolor{comment}{// Loop over the nodes along my edge}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09804}09804       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i0 = 0; i0 < my\_n\_p; i0++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09805}09805       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09806}09806         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i1 = 0; i1 < my\_n\_p; i1++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09807}09807         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09808}09808           \textcolor{comment}{// Storage for the fractional position of the node in the element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09809}09809           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09810}09810 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09811}09811           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s0space = 1;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09812}09812           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s1space = my\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09813}09813           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} s2space = my\_n\_p * my\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09814}09814 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09815}09815           \textcolor{comment}{// Find the local node and the fractional position of the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09816}09816           \textcolor{comment}{// which depends on the edge, of course}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09817}09817           \textcolor{keywordflow}{switch} (my\_face)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09818}09818           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09819}09819             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a43c804e2bcf9862a4bf629d5f01761e8}{B}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09820}09820               s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09821}09821                 local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09822}09822               s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09823}09823                 local\_one\_d\_fraction\_of\_interpolating\_node(i1, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09824}09824               s\_fraction[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09825}09825               local\_node\_number = i0 * s0space + i1 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09826}09826               local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09827}09827                 this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09828}09828               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09829}09829 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09830}09830             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a755807a4724a0f4d96f0817559c0a927}{F}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09831}09831               s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09832}09832                 local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09833}09833               s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09834}09834                 local\_one\_d\_fraction\_of\_interpolating\_node(i1, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09835}09835               s\_fraction[2] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09836}09836               local\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09837}09837                 (my\_n\_p -\/ 1) * s2space + i0 * s0space + i1 * s1space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09838}09838               local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09839}09839                 this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09840}09840               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09841}09841 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09842}09842             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a51292b8e4d96f2bb9f0d6bb0340d1620}{D}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09843}09843               s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09844}09844                 local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09845}09845               s\_fraction[1] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09846}09846               s\_fraction[2] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09847}09847                 local\_one\_d\_fraction\_of\_interpolating\_node(i1, 2, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09848}09848               local\_node\_number = i0 * s0space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09849}09849               local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09850}09850                 this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09851}09851               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09852}09852 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09853}09853             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1OcTreeNames_ae7e7e58298b85825061eeff362656c40a9d5dc3f8f9d04ae80237132101f4258f}{U}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09854}09854               s\_fraction[0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09855}09855                 local\_one\_d\_fraction\_of\_interpolating\_node(i0, 0, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09856}09856               s\_fraction[1] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09857}09857               s\_fraction[2] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09858}09858                 local\_one\_d\_fraction\_of\_interpolating\_node(i1, 2, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09859}09859               local\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09860}09860                 (my\_n\_p -\/ 1) * s1space + i0 * s0space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09861}09861               local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09862}09862                 this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09863}09863               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09864}09864 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09865}09865             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09866}09866               s\_fraction[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09867}09867               s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09868}09868                 local\_one\_d\_fraction\_of\_interpolating\_node(i0, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09869}09869               s\_fraction[2] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09870}09870                 local\_one\_d\_fraction\_of\_interpolating\_node(i1, 2, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09871}09871               local\_node\_number = i0 * s1space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09872}09872               local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09873}09873                 this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09874}09874               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09875}09875 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09876}09876             \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09877}09877               s\_fraction[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09878}09878               s\_fraction[1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09879}09879                 local\_one\_d\_fraction\_of\_interpolating\_node(i0, 1, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09880}09880               s\_fraction[2] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09881}09881                 local\_one\_d\_fraction\_of\_interpolating\_node(i1, 2, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09882}09882               local\_node\_number =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09883}09883                 (my\_n\_p -\/ 1) * s0space + i0 * s1space + i1 * s2space;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09884}09884               local\_node\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09885}09885                 this-\/>interpolating\_node\_pt(local\_node\_number, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09886}09886               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09887}09887 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09888}09888             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09889}09889               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09890}09890                 \textcolor{stringliteral}{"{}my\_face not L, R, D, U, B, F\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09891}09891                 \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09892}09892                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09893}09893           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09894}09894 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09895}09895           \textcolor{comment}{// Add node to vector of dependent element nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09896}09896           dependent\_node\_number.push\_back(local\_node\_number);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09897}09897           dependent\_node\_pt.push\_back(local\_node\_pt);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09898}09898 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09899}09899           \textcolor{comment}{// Store node's local fraction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09900}09900           dependent\_node\_s\_fraction.push\_back(s\_fraction);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09901}09901         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09902}09902       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09903}09903 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09904}09904       \textcolor{comment}{// Store the number of dependent and master nodes for use later}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09905}09905       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dependent\_nodes = dependent\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09906}09906       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_master\_nodes = master\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09907}09907       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} dependent\_element\_nnode\_1d = my\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09908}09908       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} master\_element\_nnode\_1d = neigh\_n\_p;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09909}09909 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09910}09910 \textcolor{comment}{      /// / Print out dependent and master node coords}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09911}09911 \textcolor{comment}{}      \textcolor{comment}{// std::cout << "{}Dependent nodes on face: "{} <<}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09912}09912       \textcolor{comment}{// OcTree::Direct\_string[my\_face] << std::endl; for(unsigned i=0;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09913}09913       \textcolor{comment}{// i<dependent\_node\_pt.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09914}09914       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09915}09915       \textcolor{comment}{//  std::cout << i << "{}: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09916}09916       \textcolor{comment}{//            << dependent\_node\_pt[i]-\/>x(0) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09917}09917       \textcolor{comment}{//            << dependent\_node\_pt[i]-\/>x(1) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09918}09918       \textcolor{comment}{//            << dependent\_node\_pt[i]-\/>x(2) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09919}09919       \textcolor{comment}{//            << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09920}09920       \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09921}09921       \textcolor{comment}{// std::cout << "{}Master nodes on face: "{} << OcTree::Direct\_string[my\_face]}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09922}09922       \textcolor{comment}{// << std::endl; for(unsigned i=0; i<master\_node\_pt.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09923}09923       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09924}09924       \textcolor{comment}{//  std::cout << i << "{}: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09925}09925       \textcolor{comment}{//            << master\_node\_pt[i]-\/>x(0) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09926}09926       \textcolor{comment}{//            << master\_node\_pt[i]-\/>x(1) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09927}09927       \textcolor{comment}{//            << master\_node\_pt[i]-\/>x(2) << "{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09928}09928       \textcolor{comment}{//            << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09929}09929       \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09930}09930 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09931}09931       \textcolor{comment}{// Storage for master shapes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09932}09932       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} master\_shapes(neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8b1b5031b55141567ba24913a21534f4}{ninterpolating\_node}}(value\_id));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09933}09933 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09934}09934       \textcolor{comment}{// Get master and dependent nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09935}09935       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09936}09936       \textcolor{comment}{// Get in 1D}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09937}09937       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} dependent\_nodal\_position\_1d;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09938}09938       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} dependent\_weight\_1d(dependent\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09939}09939       \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(dependent\_element\_nnode\_1d,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09940}09940                           dependent\_nodal\_position\_1d,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09941}09941                           dependent\_weight\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09942}09942       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} master\_nodal\_position\_1d;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09943}09943       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} master\_weight\_1d(master\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09944}09944       \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_ab6f86bfb7e2a8832560862c47fc60db5}{Orthpoly::gll\_nodes}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09945}09945         master\_element\_nnode\_1d, master\_nodal\_position\_1d, master\_weight\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09946}09946 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09947}09947       \textcolor{comment}{// Storage for 2D}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09948}09948       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> dependent\_nodal\_position(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09949}09949         dependent\_element\_nnode\_1d * dependent\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09950}09950       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dependent\_nodal\_position.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09951}09951       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09952}09952         dependent\_nodal\_position[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09953}09953       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09954}09954       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} dependent\_weight(dependent\_element\_nnode\_1d *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09955}09955                                       dependent\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09956}09956       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> master\_nodal\_position(master\_element\_nnode\_1d *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09957}09957                                                    master\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09958}09958       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < master\_nodal\_position.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09959}09959       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09960}09960         master\_nodal\_position[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09961}09961       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09962}09962       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} master\_weight(master\_element\_nnode\_1d *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09963}09963                                    master\_element\_nnode\_1d);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09964}09964 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09965}09965       \textcolor{comment}{// Fill in coordinates and weights in 2D}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09966}09966       \textcolor{keywordtype}{unsigned} dependent\_index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09967}09967       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dependent\_element\_nnode\_1d; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09968}09968       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09969}09969         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < dependent\_element\_nnode\_1d; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09970}09970         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09971}09971           dependent\_nodal\_position[dependent\_index][0] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09972}09972             dependent\_nodal\_position\_1d[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09973}09973           dependent\_nodal\_position[dependent\_index][1] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09974}09974             dependent\_nodal\_position\_1d[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09975}09975           dependent\_weight[dependent\_index] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09976}09976             dependent\_weight\_1d[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dependent\_weight\_1d[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09977}09977           dependent\_index++;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09978}09978         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09979}09979       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09980}09980       \textcolor{keywordtype}{unsigned} master\_index = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09981}09981       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < master\_element\_nnode\_1d; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09982}09982       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09983}09983         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < master\_element\_nnode\_1d; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09984}09984         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09985}09985           master\_nodal\_position[master\_index][0] = master\_nodal\_position\_1d[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09986}09986           master\_nodal\_position[master\_index][1] = master\_nodal\_position\_1d[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09987}09987           master\_weight[master\_index] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09988}09988             master\_weight\_1d[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * master\_weight\_1d[j];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09989}09989           master\_index++;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09990}09990         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09991}09991       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09992}09992 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09993}09993       \textcolor{comment}{// Apply the vertex matching condition}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09994}09994       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09995}09995       \textcolor{comment}{// Vertiex matching is ensured automatically in cases where there is a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09996}09996       \textcolor{comment}{// node at each end of the mortar that is shared between the master and}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09997}09997       \textcolor{comment}{// dependent elements. Where this is not the case, the vertex matching}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09998}09998       \textcolor{comment}{// condition must be enforced by constraining the value of the unknown at}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l09999}09999       \textcolor{comment}{// the node on the dependent side to be the same as the value at that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10000}10000       \textcolor{comment}{// location in the master.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10001}10001 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10002}10002       \textcolor{comment}{// Store positions of the mortar vertex/non-\/vertex nodes in the dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10003}10003       \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10004}10004       \textcolor{comment}{// const unsigned n\_mortar\_vertices = 4;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10005}10005       \textcolor{comment}{// Vector<unsigned> vertex\_pos(n\_mortar\_vertices);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10006}10006       \textcolor{comment}{// vertex\_pos[0] = 0;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10007}10007       \textcolor{comment}{// vertex\_pos[1] = my\_n\_p-\/1;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10008}10008       \textcolor{comment}{// vertex\_pos[2] = my\_n\_p*(my\_n\_p-\/1);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10009}10009       \textcolor{comment}{// vertex\_pos[3] = my\_n\_p*my\_n\_p-\/1;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10010}10010       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} non\_vertex\_pos((dependent\_element\_nnode\_1d -\/ 2) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10011}10011                                       (dependent\_element\_nnode\_1d -\/ 2));}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10012}10012       \textcolor{keywordtype}{unsigned} nvindex = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10013}10013       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dependent\_element\_nnode\_1d -\/ 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10014}10014       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10015}10015         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 1; j < dependent\_element\_nnode\_1d -\/ 1; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10016}10016         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10017}10017           non\_vertex\_pos[nvindex++] = \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} * dependent\_element\_nnode\_1d + j;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10018}10018         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10019}10019       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10020}10020       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} vertex\_pos;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10021}10021       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10022}10022       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10023}10023         \textcolor{comment}{// Check if node number is in the non-\/vertex storage}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10024}10024         \textcolor{keywordtype}{bool} node\_is\_vertex = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10025}10025         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < non\_vertex\_pos.size(); j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10026}10026         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10027}10027           \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == non\_vertex\_pos[j])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10028}10028           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10029}10029             \textcolor{comment}{// Node is not a vertex}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10030}10030             node\_is\_vertex = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10031}10031             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10032}10032           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10033}10033         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10034}10034         \textcolor{comment}{// If we get here and the node is a vertex then add it's index}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10035}10035         \textcolor{keywordflow}{if} (node\_is\_vertex)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10036}10036         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10037}10037           vertex\_pos.push\_back(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10038}10038         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10039}10039       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10040}10040       \textcolor{comment}{// Store number of mortar vertices}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10041}10041       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_mortar\_vertices = vertex\_pos.size();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10042}10042 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10043}10043       \textcolor{comment}{// Check that there are actually dependent nodes for which we still need}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10044}10044       \textcolor{comment}{// to construct a hanging scheme. If not then there is nothing more to do.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10045}10045       \textcolor{keywordflow}{if} (n\_dependent\_nodes -\/ n\_mortar\_vertices > 0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10046}10046       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10047}10047         \textcolor{comment}{// Assemble mass matrix for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10048}10048         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10049}10049         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} psi(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10050}10050         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} diag\_M(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10051}10051         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> shared\_node\_M(n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10052}10052         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < shared\_node\_M.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10053}10053         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10054}10054           shared\_node\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10055}10055         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10056}10056 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10057}10057         \textcolor{comment}{// Fill in part corresponding to dependent nodal positions (unknown)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10058}10058         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10059}10059         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10060}10060           \textcolor{comment}{// Mortar test functions in 2D are just the cross product of the 1D}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10061}10061           \textcolor{comment}{// test functions Initialise to 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10062}10062           psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10063}10063           \textcolor{comment}{// Take product in each direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10064}10064           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} dir = 0; dir < 2; dir++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10065}10065           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10066}10066             \textcolor{keywordtype}{unsigned} index1d =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10067}10067               (dir == 0) ? \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} : \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} \% (dependent\_element\_nnode\_1d -\/ 2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10068}10068             \textcolor{comment}{// Use L'Hosptal's rule:}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10069}10069             psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] *=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10070}10070               pow(-\/1.0, \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ index1d -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10071}10071               -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10072}10072                 dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10073}10073                 dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]][dir]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10074}10074           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10075}10075           \textcolor{comment}{// Put in contribution}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10076}10076           diag\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dependent\_weight[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10077}10077         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10078}10078 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10079}10079 \textcolor{comment}{        /// / Print out diag(M)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10080}10080 \textcolor{comment}{}        \textcolor{comment}{// std::cout << "{}diag(M):"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10081}10081         \textcolor{comment}{// for(unsigned i=0; i<diag\_M.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10082}10082         \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10083}10083         \textcolor{comment}{//  std::cout << "{}  "{} << diag\_M[i];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10084}10084         \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10085}10085         \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10086}10086 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10087}10087         \textcolor{comment}{// Fill in part corresponding to dependent element vertices (known)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10088}10088         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < shared\_node\_M.size(); v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10089}10089         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10090}10090           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10091}10091           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10092}10092             \textcolor{comment}{// Mortar test functions in 2D are just the cross product of the 1D}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10093}10093             \textcolor{comment}{// test functions Initialise to 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10094}10094             psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10095}10095             \textcolor{comment}{// Take product in each direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10096}10096             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} dir = 0; dir < 2; dir++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10097}10097             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10098}10098               \textcolor{keywordtype}{unsigned} index1d =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10099}10099                 (dir == 0) ? \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} : \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} \% (dependent\_element\_nnode\_1d -\/ 2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10100}10100               \textcolor{comment}{// Check if denominator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10101}10101               \textcolor{keywordflow}{if} (std::fabs(dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]][dir] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10102}10102                             dependent\_nodal\_position[vertex\_pos[v]][dir]) >=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10103}10103                   1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10104}10104               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10105}10105                 \textcolor{comment}{// We're ok}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10106}10106                 psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] *=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10107}10107                   pow(-\/1.0,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10108}10108                       \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ index1d -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10109}10109                   \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10110}10110                     dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10111}10111                     dependent\_nodal\_position[vertex\_pos[v]][dir]) /}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10112}10112                   (dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]][dir] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10113}10113                    dependent\_nodal\_position[vertex\_pos[v]][dir]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10114}10114               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10115}10115               \textcolor{comment}{// Check if numerator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10116}10116               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10117}10117                          dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10118}10118                          dependent\_nodal\_position[vertex\_pos[v]][dir])) <}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10119}10119                        1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10120}10120               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10121}10121                 \textcolor{comment}{// We can use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10122}10122                 psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] *=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10123}10123                   pow(-\/1.0,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10124}10124                       \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ index1d -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10125}10125                   -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10126}10126                     dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10127}10127                     dependent\_nodal\_position[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]][dir]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10128}10128               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10129}10129               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10130}10130               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10131}10131                 \textcolor{comment}{// We can't use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10132}10132                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10133}10133                   \textcolor{stringliteral}{"{}Cannot use l'Hopital's rule. Dividing by zero is not "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10134}10134                   \textcolor{stringliteral}{"{}allowed!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10135}10135                   \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10136}10136                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10137}10137               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10138}10138             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10139}10139             \textcolor{comment}{// Put in contribution}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10140}10140             shared\_node\_M[v][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * dependent\_weight[vertex\_pos[v]];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10141}10141           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10142}10142         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10143}10143 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10144}10144 \textcolor{comment}{        /// / Print out diag(M)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10145}10145 \textcolor{comment}{}        \textcolor{comment}{// std::cout << "{}shared node M:"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10146}10146         \textcolor{comment}{// for(unsigned i=0; i<shared\_node\_M.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10147}10147         \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10148}10148         \textcolor{comment}{//  for(unsigned j=0; j<shared\_node\_M[i].size(); j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10149}10149         \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10150}10150         \textcolor{comment}{//    std::cout << "{}  "{} << shared\_node\_M[i][j];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10151}10151         \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10152}10152         \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10153}10153         \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10154}10154 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10155}10155         \textcolor{comment}{// Assemble local projection matrix for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10156}10156         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10157}10157 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10158}10158         \textcolor{comment}{// Have only one local projection matrix because there is just one}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10159}10159         \textcolor{comment}{// master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10160}10160         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}> P(n\_dependent\_nodes -\/ n\_mortar\_vertices);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10161}10161         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < P.size(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10162}10162         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10163}10163           P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].resize(n\_master\_nodes, 0.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10164}10164         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10165}10165 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10166}10166         \textcolor{comment}{// Storage for local coordinate}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10167}10167         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10168}10168 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10169}10169         \textcolor{comment}{// Sum contributions from master element shapes (quadrature).}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10170}10170         \textcolor{comment}{// The order of quadrature must be high enough to evaluate a polynomial}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10171}10171         \textcolor{comment}{// of order N\_s + N\_m -\/ 3 exactly, where N\_s = n\_dependent\_nodes, N\_m =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10172}10172         \textcolor{comment}{// n\_master\_nodes.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10173}10173         \textcolor{comment}{// (Use pointers for the quadrature knots and weights so that}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10174}10174         \textcolor{comment}{// data is not unnecessarily copied)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10175}10175         \textcolor{comment}{// unsigned quadrature\_order =}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10176}10176         \textcolor{comment}{// std::max(dependent\_element\_nnode\_1d,master\_element\_nnode\_1d);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10177}10177         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<double>}}>* quadrature\_knot;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10178}10178         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}* quadrature\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10179}10179         \textcolor{keywordflow}{if} (dependent\_element\_nnode\_1d >= master\_element\_nnode\_1d)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10180}10180         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10181}10181           \textcolor{comment}{// Use the same quadrature order as the dependent element (me)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10182}10182           quadrature\_knot = \&dependent\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10183}10183           quadrature\_weight = \&dependent\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10184}10184         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10185}10185         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10186}10186         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10187}10187           \textcolor{comment}{// Use the same quadrature order as the master element (neighbour)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10188}10188           quadrature\_knot = \&master\_nodal\_position;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10189}10189           quadrature\_weight = \&master\_weight;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10190}10190         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10191}10191 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10192}10192         \textcolor{comment}{// Quadrature loop}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10193}10193         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} q = 0; q < (*quadrature\_weight).size(); q++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10194}10194         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10195}10195           \textcolor{comment}{// Evaluate mortar test functions at the quadrature knots in the}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10196}10196           \textcolor{comment}{// dependent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10197}10197           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_on\_mortar(2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10198}10198           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 2; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10199}10199           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10200}10200             s\_on\_mortar[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = (*quadrature\_knot)[q][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10201}10201           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10202}10202 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10203}10203           \textcolor{comment}{// Get psi}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10204}10204           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_dependent\_nodes -\/ n\_mortar\_vertices; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10205}10205           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10206}10206             \textcolor{comment}{// Mortar test functions in 2D are just the cross product of the 1D}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10207}10207             \textcolor{comment}{// test functions Initialise to 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10208}10208             psi[k] = 1.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10209}10209             \textcolor{comment}{// Take product in each direction}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10210}10210             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} dir = 0; dir < 2; dir++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10211}10211             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10212}10212               \textcolor{keywordtype}{unsigned} index1d =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10213}10213                 (dir == 0) ? k : k \% (dependent\_element\_nnode\_1d -\/ 2);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10214}10214               \textcolor{comment}{// Check if denominator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10215}10215               \textcolor{keywordflow}{if} (std::fabs(dependent\_nodal\_position[non\_vertex\_pos[k]][dir] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10216}10216                             s\_on\_mortar[dir]) >= 1.0e-\/08)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10217}10217               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10218}10218                 \textcolor{comment}{// We're ok}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10219}10219                 psi[k] *=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10220}10220                   pow(-\/1.0,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10221}10221                       \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ index1d -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10222}10222                   \mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10223}10223                                       s\_on\_mortar[dir]) /}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10224}10224                   (dependent\_nodal\_position[non\_vertex\_pos[k]][dir] -\/}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10225}10225                    s\_on\_mortar[dir]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10226}10226               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10227}10227               \textcolor{comment}{// Check if numerator is zero}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10228}10228               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a4062725a9af419d3c0a24927725e5435}{Orthpoly::dlegendre}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10229}10229                          dependent\_element\_nnode\_1d -\/ 1, s\_on\_mortar[dir])) <}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10230}10230                        1.0e-\/8)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10231}10231               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10232}10232                 \textcolor{comment}{// We can use l'Hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10233}10233                 psi[k] *=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10234}10234                   pow(-\/1.0,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10235}10235                       \textcolor{keywordtype}{int}((dependent\_element\_nnode\_1d -\/ 1) -\/ index1d -\/ 1)) *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10236}10236                   -\/\mbox{\hyperlink{namespaceoomph_1_1Orthpoly_a560de3e87ebd12628426d853d8b4d5b3}{Orthpoly::ddlegendre}}(dependent\_element\_nnode\_1d -\/ 1,}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10237}10237                                         s\_on\_mortar[dir]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10238}10238               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10239}10239               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10240}10240               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10241}10241                 \textcolor{comment}{// We can't use l'hopital's rule}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10242}10242                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10243}10243                   \textcolor{stringliteral}{"{}Cannot use l'Hopital's rule. Dividing by zero is not "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10244}10244                   \textcolor{stringliteral}{"{}allowed!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10245}10245                   \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10246}10246                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10247}10247               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10248}10248             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10249}10249           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10250}10250 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10251}10251           \textcolor{comment}{// Convert coordinate on mortar to local fraction in dependent element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10252}10252           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10253}10253           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10254}10254           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10255}10255             \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == active\_coord\_index[0])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10256}10256             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10257}10257               s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.5 * (s\_on\_mortar[0] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10258}10258             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10259}10259             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == active\_coord\_index[1])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10260}10260             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10261}10261               s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = 0.5 * (s\_on\_mortar[1] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10262}10262             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10263}10263             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10264}10264             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10265}10265               s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = dependent\_node\_s\_fraction[vertex\_pos[0]][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10266}10266             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10267}10267           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10268}10268 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10269}10269           \textcolor{comment}{// Project active coordinate into master element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10270}10270           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10271}10271           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10272}10272           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10273}10273             s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10274}10274                                               (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10275}10275           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10276}10276 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10277}10277           \textcolor{comment}{// Evaluate master shapes at projections of local quadrature knots}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10278}10278           neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8ca420443c28708e5c6315a80f520137}{interpolating\_basis}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10279}10279             s\_in\_neigh, master\_shapes, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10280}10280 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10281}10281           \textcolor{comment}{// Populate local projection matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10282}10282           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10283}10283           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10284}10284             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_master\_nodes; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10285}10285             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10286}10286               P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] += master\_shapes[master\_node\_number[j]] * psi[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10287}10287                          (*quadrature\_weight)[q];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10288}10288             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10289}10289           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10290}10290         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10291}10291 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10292}10292 \textcolor{comment}{        /// / Print out local projection matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10293}10293 \textcolor{comment}{}        \textcolor{comment}{// std::cout << "{}P\_e:"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10294}10294         \textcolor{comment}{// for(unsigned i=0; i<P.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10295}10295         \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10296}10296         \textcolor{comment}{//  for(unsigned j=0; j<P[i].size(); j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10297}10297         \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10298}10298         \textcolor{comment}{//    std::cout << "{}  "{} << P[i][j];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10299}10299         \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10300}10300         \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10301}10301         \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10302}10302 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10303}10303         \textcolor{comment}{// Assemble global projection matrices for mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10304}10304         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10305}10305         \textcolor{comment}{// Need to subtract contributions from the "{}known unknowns"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10306}10306         \textcolor{comment}{// corresponding to the nodes at the vertices of the mortar}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10307}10307 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10308}10308         \textcolor{comment}{// Assemble contributions from mortar vertex nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10309}10309         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_mortar\_vertices; v++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10310}10310         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10311}10311           \textcolor{comment}{// Convert coordinate on mortar to local fraction in dependent element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10312}10312           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10313}10313           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10314}10314           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10315}10315             \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == active\_coord\_index[0])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10316}10316             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10317}10317               s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10318}10318                 0.5 * (dependent\_nodal\_position[vertex\_pos[v]][0] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10319}10319             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10320}10320             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == active\_coord\_index[1])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10321}10321             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10322}10322               s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10323}10323                 0.5 * (dependent\_nodal\_position[vertex\_pos[v]][1] + 1.0);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10324}10324             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10325}10325             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10326}10326             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10327}10327               s\_fraction[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = dependent\_node\_s\_fraction[vertex\_pos[0]][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10328}10328             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10329}10329           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10330}10330 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10331}10331           \textcolor{comment}{// Project active coordinate into master element}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10332}10332           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neigh(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10333}10333           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10334}10334           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10335}10335             s\_in\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] + s\_fraction[translate\_s[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]] *}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10336}10336                                               (s\_hi\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ s\_lo\_neigh[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10337}10337           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10338}10338 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10339}10339           \textcolor{comment}{// Get master shapes at dependent nodal positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10340}10340           neigh\_obj\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a8ca420443c28708e5c6315a80f520137}{interpolating\_basis}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10341}10341             s\_in\_neigh, master\_shapes, value\_id);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10342}10342 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10343}10343           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10344}10344           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10345}10345             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_master\_nodes; k++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10346}10346             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10347}10347               P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][k] -\/=}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10348}10348                 master\_shapes[master\_node\_number[k]] * shared\_node\_M[v][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10349}10349             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10350}10350           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10351}10351         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10352}10352 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10353}10353 \textcolor{comment}{        /// / Print out global projection matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10354}10354 \textcolor{comment}{}        \textcolor{comment}{// std::cout << "{}P:"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10355}10355         \textcolor{comment}{// for(unsigned i=0; i<P.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10356}10356         \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10357}10357         \textcolor{comment}{//  for(unsigned j=0; j<P[i].size(); j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10358}10358         \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10359}10359         \textcolor{comment}{//    std::cout << "{}  "{} << P[i][j];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10360}10360         \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10361}10361         \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10362}10362         \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10363}10363 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10364}10364         \textcolor{comment}{// Solve mortar system}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10365}10365         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10366}10366         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10367}10367         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10368}10368           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_master\_nodes; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10369}10369           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10370}10370             P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j] /= diag\_M[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10371}10371           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10372}10372         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10373}10373 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10374}10374 \textcolor{comment}{        /// / Print out solved matrix}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10375}10375 \textcolor{comment}{}        \textcolor{comment}{// std::cout << "{}solved P:"{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10376}10376         \textcolor{comment}{// for(unsigned i=0; i<P.size(); i++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10377}10377         \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10378}10378         \textcolor{comment}{//  for(unsigned j=0; j<P[i].size(); j++)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10379}10379         \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10380}10380         \textcolor{comment}{//    std::cout << "{}  "{} << P[i][j];}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10381}10381         \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10382}10382         \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10383}10383         \textcolor{comment}{// std::cout << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10384}10384 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10385}10385         \textcolor{comment}{// Create structures to hold the hanging info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10386}10386         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10387}10387         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<HangInfo*>}} hang\_info\_pt(n\_dependent\_nodes);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10388}10388         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10389}10389         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10390}10390           hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}(n\_master\_nodes);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10391}10391         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10392}10392 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10393}10393         \textcolor{comment}{// Copy information to hanging nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10394}10394         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10395}10395         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10396}10396         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10397}10397           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_master\_nodes; j++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10398}10398           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10399}10399             hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>set\_master\_node\_pt(j, master\_node\_pt[j], P[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}][j]);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10400}10400           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10401}10401         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10402}10402 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10403}10403         \textcolor{comment}{// Set pointers to hanging info}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10404}10404         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10405}10405         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes -\/ n\_mortar\_vertices; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10406}10406         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10407}10407           \textcolor{comment}{// Check that the node shoule actually hang.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10408}10408           \textcolor{comment}{// That is, if the polynomial orders of the elements at a p-\/type}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10409}10409           \textcolor{comment}{// non-\/conormity are both odd then the middle node on the edge is}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10410}10410           \textcolor{comment}{// shared but a hanging scheme has been constructed for it.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10411}10411           \textcolor{keywordtype}{bool} node\_is\_really\_shared = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10412}10412           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>nmaster(); m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10413}10413           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10414}10414             \textcolor{comment}{// We can simply check if the hanging scheme lists itself as a}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10415}10415             \textcolor{comment}{// master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10416}10416             \textcolor{keywordflow}{if} (hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>master\_node\_pt(m) ==}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10417}10417                 dependent\_node\_pt[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10418}10418             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10419}10419               node\_is\_really\_shared = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10420}10420 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10421}10421 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10422}10422               \textcolor{comment}{// Also check the corresponding weight: it should be 1}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10423}10423               \textcolor{keywordflow}{if} (std::fabs(hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>master\_weight(m) -\/ 1.0) > 1.0e-\/06)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10424}10424               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10425}10425                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10426}10426                   \textcolor{stringliteral}{"{}Something fishy here -\/-\/ with shared node at a mortar vertex"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10427}10427                   \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10428}10428                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10429}10429               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10430}10430 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10431}10431             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10432}10432           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10433}10433 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10434}10434           \textcolor{comment}{// Now we can make the node hang, if it isn't a shared node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10435}10435           \textcolor{keywordflow}{if} (!node\_is\_really\_shared)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10436}10436           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10437}10437             dependent\_node\_pt[non\_vertex\_pos[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]]-\/>set\_hanging\_pt(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10438}10438               hang\_info\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}], -\/1);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10439}10439           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10440}10440         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10441}10441 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10442}10442       \} \textcolor{comment}{// End of case where there are still dependent nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10443}10443 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10444}10444 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10445}10445       \textcolor{comment}{// Check all dependent nodes, hanging or otherwise}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10446}10446       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10447}10447       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10448}10448         \textcolor{comment}{// Check that weights sum to 1 for those that hang}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10449}10449         \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10450}10450         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10451}10451           \textcolor{comment}{// Check that weights sum to 1 and no zero weights}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10452}10452           \textcolor{keywordtype}{double} weight\_sum = 0.0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10453}10453           \textcolor{keywordtype}{bool} zero\_weight = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10454}10454           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10455}10455                m < dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10456}10456                m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10457}10457           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10458}10458             weight\_sum += dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_weight(m);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10459}10459             \textcolor{keywordflow}{if} (std::fabs(dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_weight(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10460}10460                   m)) < 1.0e-\/14)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10461}10461             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10462}10462               zero\_weight = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10463}10463               \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}In the hanging scheme for dependent node "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10464}10464                          << \textcolor{stringliteral}{"{}, master node "{}} << m << \textcolor{stringliteral}{"{} has weight "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10465}10465                          << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_weight(m)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10466}10466                          << \textcolor{stringliteral}{"{} < 1.0e-\/14"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10467}10467             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10468}10468           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10469}10469 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10470}10470           \textcolor{comment}{// Warn if not}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10471}10471           \textcolor{keywordflow}{if} (std::fabs(weight\_sum -\/ 1.0) > 1.0e-\/08)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10472}10472           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10473}10473             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Sum of master weights: "{}} << weight\_sum << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10474}10474             \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10475}10475               \textcolor{stringliteral}{"{}Weights in hanging scheme do not sum to 1"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10476}10476               \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10477}10477               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10478}10478           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10479}10479           \textcolor{keywordflow}{if} (zero\_weight)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10480}10480           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10481}10481             \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10482}10482               \textcolor{stringliteral}{"{}Zero weights present in hanging schemes"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10483}10483               \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10484}10484               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10485}10485           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10486}10486 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10487}10487           \textcolor{comment}{// Also check that dependent nodes do not have themselves as masters}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10488}10488           \textcolor{comment}{// bool dependent\_should\_not\_be\_hanging = false;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10489}10489           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10490}10490                m < dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10491}10491                m++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10492}10492           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10493}10493             \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] ==}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10494}10494                 dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_node\_pt(m))}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10495}10495             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10496}10496               \textcolor{comment}{// This shouldn't happen!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10497}10497               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10498}10498                 \textcolor{stringliteral}{"{}Dependent node has itself as a master!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10499}10499                 \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10500}10500                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10501}10501             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10502}10502             \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10503}10503                   -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10504}10504                   -\/>master\_node\_pt(m)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10505}10505                   -\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10506}10506             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10507}10507               \textcolor{comment}{// Check if node is master of master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10508}10508               \mbox{\hyperlink{classoomph_1_1Node}{Node}}* new\_nod\_pt =}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10509}10509                 dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_node\_pt(m);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10510}10510               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} mm = 0; mm < new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10511}10511                    mm++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10512}10512               \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10513}10513                 \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] ==}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10514}10514                     new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(mm))}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10515}10515                 \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10516}10516                   std::cout << \textcolor{stringliteral}{"{}++++++++++++++++++++++++++++++++++++++++"{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10517}10517                             << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10518}10518                   std::cout}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10519}10519                     << \textcolor{stringliteral}{"{}          Dependent node: "{}} << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10520}10520                     << \textcolor{stringliteral}{"{} = "{}} << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(0) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10521}10521                     << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(1) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10522}10522                     << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(2) << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10523}10523                   std::cout}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10524}10524                     << \textcolor{stringliteral}{"{}         Master node: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10525}10525                     << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_node\_pt(m)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10526}10526                     << \textcolor{stringliteral}{"{} = "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10527}10527                     << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_node\_pt(m)-\/>x(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10528}10528                          0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10529}10529                     << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10530}10530                     << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_node\_pt(m)-\/>x(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10531}10531                          1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10532}10532                     << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10533}10533                     << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_node\_pt(m)-\/>x(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10534}10534                          2)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10535}10535                     << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10536}10536                   std::cout << \textcolor{stringliteral}{"{}Master's master node: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10537}10537                             << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10538}10538                                  -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10539}10539                                  -\/>master\_node\_pt(m)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10540}10540                                  -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10541}10541                                  -\/>master\_node\_pt(mm)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10542}10542                             << \textcolor{stringliteral}{"{} = "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10543}10543                             << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10544}10544                                  -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10545}10545                                  -\/>master\_node\_pt(m)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10546}10546                                  -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10547}10547                                  -\/>master\_node\_pt(mm)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10548}10548                                  -\/>x(0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10549}10549                             << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10550}10550                             << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10551}10551                                  -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10552}10552                                  -\/>master\_node\_pt(m)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10553}10553                                  -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10554}10554                                  -\/>master\_node\_pt(mm)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10555}10555                                  -\/>x(1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10556}10556                             << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10557}10557                             << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10558}10558                                  -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10559}10559                                  -\/>master\_node\_pt(m)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10560}10560                                  -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10561}10561                                  -\/>master\_node\_pt(mm)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10562}10562                                  -\/>x(2)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10563}10563                             << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10564}10564 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10565}10565 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10566}10566                   \textcolor{comment}{// Print out hanging scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10567}10567                   std::cout << \textcolor{stringliteral}{"{}Hanging node: "{}} << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10568}10568                             << \textcolor{stringliteral}{"{}  "{}} << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(1) << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10569}10569                             << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(2) << \textcolor{stringliteral}{"{}  "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10570}10570                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m\_tmp = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10571}10571                        m\_tmp < dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10572}10572                        m\_tmp++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10573}10573                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10574}10574                     std::cout}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10575}10575                       << \textcolor{stringliteral}{"{}   m = "{}} << m\_tmp << \textcolor{stringliteral}{"{}: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10576}10576                       << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10577}10577                            -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10578}10578                            -\/>master\_node\_pt(m\_tmp)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10579}10579                            -\/>x(0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10580}10580                       << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10581}10581                       << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10582}10582                            -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10583}10583                            -\/>master\_node\_pt(m\_tmp)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10584}10584                            -\/>x(1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10585}10585                       << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10586}10586                       << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10587}10587                            -\/>hanging\_pt()}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10588}10588                            -\/>master\_node\_pt(m\_tmp)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10589}10589                            -\/>x(2)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10590}10590                       << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10591}10591                       << \textcolor{stringliteral}{"{}w = "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10592}10592                       << dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>hanging\_pt()-\/>master\_weight(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10593}10593                            m\_tmp)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10594}10594                       << \textcolor{stringliteral}{"{}  "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10595}10595                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10596}10596 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10597}10597                   \textcolor{comment}{// Print out hanging scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10598}10598                   std::cout << \textcolor{stringliteral}{"{}Master node "{}} << m}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10599}10599                             << \textcolor{stringliteral}{"{} of Hanging node: "{}} << new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0) << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10600}10600                             << new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1) << \textcolor{stringliteral}{"{}  "{}} << new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(2)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10601}10601                             << \textcolor{stringliteral}{"{}  "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10602}10602                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} mm\_tmp = 0;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10603}10603                        mm\_tmp < new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10604}10604                        mm\_tmp++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10605}10605                   \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10606}10606                     std::cout}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10607}10607                       << \textcolor{stringliteral}{"{}   mm = "{}} << mm\_tmp << \textcolor{stringliteral}{"{}: "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10608}10608                       << new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(mm\_tmp)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(0)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10609}10609                       << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10610}10610                       << new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(mm\_tmp)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10611}10611                       << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10612}10612                       << new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(mm\_tmp)-\/>\mbox{\hyperlink{classoomph_1_1Node_ab76b4773a65b349f143539e07b6e15e2}{x}}(2)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10613}10613                       << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10614}10614                       << \textcolor{stringliteral}{"{}w = "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10615}10615                       << new\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1Node_afefa22db8b28e783b8647e3577ee01d9}{hanging\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_ac49ebdd8957a658fe4a2420108d2dcee}{master\_weight}}(mm\_tmp) << \textcolor{stringliteral}{"{}  "{}}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10616}10616                       << std::endl;}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10617}10617                   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10618}10618 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10619}10619                   \textcolor{comment}{// This shouldn't happen!}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10620}10620                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10621}10621                     \textcolor{stringliteral}{"{}Dependent node has itself as a master of a master!"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10622}10622                     \textcolor{stringliteral}{"{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::oc\_hang\_helper()"{}},}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10623}10623                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10624}10624                 \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10625}10625               \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10626}10626             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10627}10627           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10628}10628         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10629}10629         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10630}10630         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10631}10631           \textcolor{comment}{// Check that this node is shared with the master element if it}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10632}10632           \textcolor{comment}{// isn't hanging}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10633}10633           \textcolor{keywordtype}{bool} is\_master = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10634}10634           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_master\_nodes; n++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10635}10635           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10636}10636             \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] == master\_node\_pt[n])}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10637}10637             \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10638}10638               \textcolor{comment}{// Node is a master}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10639}10639               is\_master = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10640}10640               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10641}10641             \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10642}10642           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10643}10643 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10644}10644           \textcolor{keywordflow}{if} (!is\_master)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10645}10645           \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10646}10646 \textcolor{comment}{            /// / Throw error}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10647}10647 \textcolor{comment}{}            \textcolor{comment}{// std::ostringstream error\_string;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10648}10648             \textcolor{comment}{// error\_string}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10649}10649             \textcolor{comment}{// << "{}This node in the dependent element is neither"{} << std::endl}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10650}10650             \textcolor{comment}{// << "{}hanging or shared with a master element."{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10651}10651             \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10652}10652             \textcolor{comment}{// throw OomphLibError(}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10653}10653             \textcolor{comment}{//       error\_string.str(),}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10654}10654             \textcolor{comment}{//       "{}PRefineableQElement<3,INITIAL\_NNODE\_1D>::quad\_hang\_helper()"{},}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10655}10655             \textcolor{comment}{//       OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10656}10656           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10657}10657         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10658}10658       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10659}10659 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10660}10660 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10661}10661       \textcolor{comment}{// Finally, Loop over all dependent nodes and fine-\/tune their positions}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10662}10662       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10663}10663       \textcolor{comment}{// Here we simply set the node's positions to be consistent}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10664}10664       \textcolor{comment}{// with the hanging scheme. This is not strictly necessary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10665}10665       \textcolor{comment}{// because it is done in the mesh adaptation before the node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10666}10666       \textcolor{comment}{// becomes non-\/hanging later on. We make no attempt to ensure}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10667}10667       \textcolor{comment}{// (strong) continuity in the position across the mortar.}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10668}10668       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dependent\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10669}10669       \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10670}10670         \textcolor{comment}{// Only fine-\/tune hanging nodes}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10671}10671         \textcolor{keywordflow}{if} (dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10672}10672         \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10673}10673           \textcolor{comment}{// If we are doing the position, then}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10674}10674           \textcolor{keywordflow}{if} (value\_id == -\/1)}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10675}10675           \{}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10676}10676             \textcolor{comment}{// Get the local coordinate of this dependent node}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10677}10677             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_local(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10678}10678             this-\/>local\_coordinate\_of\_node(dependent\_node\_number[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}], s\_local);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10679}10679 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10680}10680             \textcolor{comment}{// Get the position from interpolation in this element via}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10681}10681             \textcolor{comment}{// the hanging scheme}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10682}10682             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_in\_neighb(3);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10683}10683             this-\/>interpolated\_x(s\_local, x\_in\_neighb);}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10684}10684 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10685}10685             \textcolor{comment}{// Fine adjust the coordinates (macro map will pick up boundary}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10686}10686             \textcolor{comment}{// accurately but will lead to different element edges)}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10687}10687             dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(0) = x\_in\_neighb[0];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10688}10688             dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(1) = x\_in\_neighb[1];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10689}10689             dependent\_node\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>x(2) = x\_in\_neighb[2];}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10690}10690           \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10691}10691         \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10692}10692       \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10693}10693     \} \textcolor{comment}{// End of case where this interface is to be mortared}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10694}10694   \}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10695}10695 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10696}10696   \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10697}10697   \textcolor{comment}{// Build required templates}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10698}10698   \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10699}10699   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, 2>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10700}10700   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, 3>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10701}10701   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<1, 4>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10702}10702 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10703}10703   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, 2>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10704}10704   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, 3>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10705}10705   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<2, 4>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10706}10706 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10707}10707   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, 2>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10708}10708   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, 3>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10709}10709   \textcolor{keyword}{template} \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1PRefineableQElement}{PRefineableQElement<3, 4>}};}
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10710}10710 }
\DoxyCodeLine{\Hypertarget{hp__refineable__elements_8cc_source_l10711}10711 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

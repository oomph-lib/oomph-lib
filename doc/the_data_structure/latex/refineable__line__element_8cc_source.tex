\hypertarget{refineable__line__element_8cc_source}{}\doxysection{refineable\+\_\+line\+\_\+element.\+cc}
\label{refineable__line__element_8cc_source}\index{refineable\_line\_element.cc@{refineable\_line\_element.cc}}
\mbox{\hyperlink{refineable__line__element_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00026}00026 \textcolor{comment}{// Non-\/inline and non-\/templated functions for RefineableQElement<1> class}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00028}00028 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00030}00030 \textcolor{comment}{// oomph-\/lib headers}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00031}00031 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mesh_8h}{mesh.h}}"{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00032}00032 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{algebraic__elements_8h}{algebraic\_elements.h}}"{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00033}00033 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{macro__element__node__update__element_8h}{macro\_element\_node\_update\_element.h}}"{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00034}00034 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{refineable__line__element_8h}{refineable\_line\_element.h}}"{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00036}00036 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00037}00037 \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00038}00038   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00039}00039 \textcolor{comment}{  /// Setup static matrix for coincidence between son nodal points and father}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00040}00040 \textcolor{comment}{  /// boundaries:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00041}00041 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00042}00042 \textcolor{comment}{  /// Father\_bound[nnode\_1d](nnode\_son,son\_type) = \{L/R/OMEGA\}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00043}00043 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00044}00044 \textcolor{comment}{  /// so that node nnode\_son in element of type son\_type lies on boundary/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00045}00045 \textcolor{comment}{  /// vertex Father\_bound[nnode\_1d](nnode\_son,son\_type) in its father}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00046}00046 \textcolor{comment}{  /// element. If the node doesn't lie on a boundary the value is OMEGA.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00047}00047 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00048}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4_af45c2d218e992dc0d516015762e6db69}{00048}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<1>::setup\_father\_bounds}}()}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00049}00049   \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00050}00050     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00052}00052     \textcolor{comment}{// Find the number of nodes along a 1D edge (which is the number of nodes}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00053}00053     \textcolor{comment}{// in the element for a 1D element!)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00054}00054     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = nnode\_1d();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00056}00056     \textcolor{comment}{// Allocate space for the boundary information}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00057}00057     Father\_bound[n\_node].resize(n\_node, 2);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00058}00058 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00059}00059     \textcolor{comment}{// Initialise: By default points are not on the boundary}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00060}00060     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00061}00061     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00062}00062       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ison = 0; ison < 2; ison++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00063}00063       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00064}00064         Father\_bound[n\_node](n, ison) = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00065}00065       \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00066}00066     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00068}00068     \textcolor{comment}{// Left-\/hand son:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00069}00069     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00071}00071     \textcolor{comment}{// L node (0) is the L node of the parent}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00072}00072     Father\_bound[n\_node](0, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}) = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00074}00074     \textcolor{comment}{// Other boundary is in the interior}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00076}00076     \textcolor{comment}{// Right-\/hand son:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00077}00077     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00079}00079     \textcolor{comment}{// R node (n\_node-\/1) is the R node of the parent}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00080}00080     Father\_bound[n\_node](n\_node -\/ 1, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}) = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00082}00082     \textcolor{comment}{// Other boundary is in the interior}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00083}00083   \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00085}00085   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00086}00086 \textcolor{comment}{  /// If a neighbouring element has already created a node at a position}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00087}00087 \textcolor{comment}{  /// corresponding to the local fractional position within the present}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00088}00088 \textcolor{comment}{  /// element, s\_fraction, return a pointer to that node. If not, return}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00089}00089 \textcolor{comment}{  /// NULL (0). If the node is periodic the flag is\_periodic will be true.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00090}00090 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00091}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4_ad415f7f3dffe9e990dc690deed3a0666}{00091}}   Node* \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<1>::node\_created\_by\_neighbour}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00092}00092     \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_fraction, \textcolor{keywordtype}{bool}\& is\_periodic)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00093}00093   \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00094}00094     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00096}00096     \textcolor{comment}{// Initialise edge of current element on which node lies}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00097}00097     \textcolor{keywordtype}{int} edge\_in\_current = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895afbb1d921b86ded476b8bee384d9059e1}{OMEGA}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00098}00098 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00099}00099     \textcolor{comment}{// Determine the edge of the current element on which the node lies}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00100}00100     \textcolor{keywordflow}{if} (s\_fraction[0] == 0.0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00101}00101     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00102}00102       edge\_in\_current = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00103}00103     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00104}00104     \textcolor{keywordflow}{if} (s\_fraction[0] == 1.0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00105}00105     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00106}00106       edge\_in\_current = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00107}00107     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00109}00109     \textcolor{comment}{// If the node does not lie on an edge then there is no neighbour:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00110}00110     \textcolor{comment}{// return NULL}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00111}00111     \textcolor{keywordflow}{if} (edge\_in\_current == \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895afbb1d921b86ded476b8bee384d9059e1}{OMEGA}})}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00112}00112     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00113}00113       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00114}00114     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00116}00116     \textcolor{comment}{// Allocate storage for edge in neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00117}00117     \textcolor{keywordtype}{int} edge\_in\_neighbour;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00119}00119     \textcolor{comment}{// Allocate storage for difference in size between current and}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00120}00120     \textcolor{comment}{// neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00121}00121     \textcolor{keywordtype}{int} diff\_level;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00122}00122 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00123}00123     \textcolor{comment}{// Allocate storage for local coordinate of node in neighbouring tree}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00124}00124     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neighbour(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00125}00125 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00126}00126     \textcolor{comment}{// Allocate storage for flag indicating if the node is not in the same}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00127}00127     \textcolor{comment}{// binary tree}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00128}00128     \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00130}00130     \textcolor{comment}{// Allocate storage for the pointer to the neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00131}00131     \textcolor{comment}{// (using its binary tree representation)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00132}00132     \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* neighbour\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00134}00134     \textcolor{comment}{// Find pointer to neighbouring element along the edge in question and}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00135}00135     \textcolor{comment}{// calculate the local coordinate of the node within that element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00136}00136     \textcolor{comment}{// s\_in\_neighbour}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00137}00137     neighbour\_pt = binary\_tree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1BinaryTree_aba768160bad3531d0f62033788619f56}{gteq\_edge\_neighbour}}(edge\_in\_current,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00138}00138                                                          s\_in\_neighbour,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00139}00139                                                          edge\_in\_neighbour,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00140}00140                                                          diff\_level,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00141}00141                                                          in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00143}00143     \textcolor{comment}{// If a neighbour exists...}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00144}00144     \textcolor{keywordflow}{if} (neighbour\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00145}00145     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00146}00146       \textcolor{comment}{// ...check whether its nodes have been created yet}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00147}00147       \textcolor{keywordflow}{if} (neighbour\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a50758228db823d72ea8da23dbb000901}{nodes\_built}}())}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00148}00148       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00149}00149         \textcolor{comment}{// If they have, find the node in question in the neighbour}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00150}00150         Node* neighbour\_node\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00151}00151           neighbour\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_adf4424f1040fb5c4b6abfbd1c2bf65fc}{get\_node\_at\_local\_coordinate}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00152}00152             s\_in\_neighbour);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00153}00153 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00154}00154         \textcolor{comment}{// If there is no node at this position, there is a problem, since in}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00155}00155         \textcolor{comment}{// a 1D element (whose nodes have already been built) there should}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00156}00156         \textcolor{comment}{// ALWAYS be a node at each edge of the element.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00157}00157         \textcolor{keywordflow}{if} (neighbour\_node\_pt == 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00158}00158         \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00159}00159           \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00160}00160             \textcolor{stringliteral}{"{}Problem: an element claims to have had its nodes built, yet\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00161}00161           error\_message += \textcolor{stringliteral}{"{}it is missing (a least) a node at its edge.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00162}00162           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00163}00163             error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00164}00164         \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00165}00165         \textcolor{comment}{// Otherwise, carry on}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00166}00166         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00167}00167         \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00168}00168           \textcolor{comment}{// Now work out whether it's a periodic boundary (this is only}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00169}00169           \textcolor{comment}{// (possible if we have moved into a neighbouring tree)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00170}00170           \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00171}00171           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00172}00172             \textcolor{comment}{// Return whether the neighbour is periodic}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00173}00173             is\_periodic = binary\_tree\_pt()-\/>root\_pt()-\/>is\_neighbour\_periodic(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00174}00174               edge\_in\_current);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00175}00175           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00176}00176           \textcolor{comment}{// Return the pointer to the neighbouring node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00177}00177           \textcolor{keywordflow}{return} neighbour\_node\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00178}00178         \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00179}00179       \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00180}00180     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00181}00181     \textcolor{comment}{// Node not found, return null}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00182}00182     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00183}00183   \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00184}00184 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00185}00185   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00186}00186 \textcolor{comment}{  /// Build the element by doing the following:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00187}00187 \textcolor{comment}{  /// -\/ Give it nodal positions (by establishing the pointers to its nodes).}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00188}00188 \textcolor{comment}{  ///   In the process create new nodes where required (i.e. if they don't}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00189}00189 \textcolor{comment}{  ///   already exist in the father element and have not already been created}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00190}00190 \textcolor{comment}{  ///   whilst building new neighbouring elements). Node building involves}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00191}00191 \textcolor{comment}{  ///   the following steps:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00192}00192 \textcolor{comment}{  ///   -\/ Get the nodal position from the father element.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00193}00193 \textcolor{comment}{  ///   -\/ Establish the time-\/history of the newly created nodal point}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00194}00194 \textcolor{comment}{  ///     (its coordinates and previous values) consistent with the father's}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00195}00195 \textcolor{comment}{  ///     history.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00196}00196 \textcolor{comment}{  ///   -\/ Add the new node to the mesh itself.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00197}00197 \textcolor{comment}{  ///   -\/ Doc newly created nodes in "{}new\_nodes.dat"{} stored in the directory}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00198}00198 \textcolor{comment}{  ///     of the DocInfo object (only if it's open!).}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00199}00199 \textcolor{comment}{  ///   -\/ NOTE: Unlike in higher-\/dimensional elements, in 1D it is impossible}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00200}00200 \textcolor{comment}{  ///     for newly-\/created nodes to be on a mesh boundary, since any boundary}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00201}00201 \textcolor{comment}{  ///     nodes must exist in the initial (coarse) mesh. Therefore it is not}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00202}00202 \textcolor{comment}{  ///     necessary to add any nodes to the mesh's boundary node storage}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00203}00203 \textcolor{comment}{  ///     schemes, and we always create normal "{}bulk"{} nodes.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00204}00204 \textcolor{comment}{  /// -\/ Once the element has a full complement of nodes, excute the element-\/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00205}00205 \textcolor{comment}{  ///   specific further\_build() (empty by default -\/-\/ must be overloaded for}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00206}00206 \textcolor{comment}{  ///   specific elements). This deals with any build operations that are not}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00207}00207 \textcolor{comment}{  ///   included in the generic process outlined above. For instance, in}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00208}00208 \textcolor{comment}{  ///   Crouzeix Raviart elements we need to initialise the internal pressure}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00209}00209 \textcolor{comment}{  ///   pressure values in a manner consistent with the pressure distribution}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00210}00210 \textcolor{comment}{  ///   in the father element.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00211}00211 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00212}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4_a32262f8b505be28cd71022fc27746a03}{00212}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<1>::build}}(\mbox{\hyperlink{classoomph_1_1Mesh}{Mesh}}*\& mesh\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00213}00213                                     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}\& new\_node\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00214}00214                                     \textcolor{keywordtype}{bool}\& was\_already\_built,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00215}00215                                     std::ofstream\& new\_nodes\_file)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00216}00216   \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00217}00217     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00218}00218 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00219}00219     \textcolor{comment}{// Find the number of nodes along a 1D edge (which is the number of nodes}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00220}00220     \textcolor{comment}{// in the element for a 1D element!)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00221}00221     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = nnode\_1d();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00222}00222 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00223}00223     \textcolor{comment}{// Check whether static father\_bound needs to be created}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00224}00224     \textcolor{keywordflow}{if} (Father\_bound[n\_node].nrow() == 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00225}00225     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00226}00226       setup\_father\_bounds();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00227}00227     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00229}00229     \textcolor{comment}{// Pointer to the current element's father (in binary tree impersonation)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00230}00230     \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* father\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00231}00231       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}*\textcolor{keyword}{>}(binary\_tree\_pt()-\/>father\_pt());}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00232}00232 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00233}00233     \textcolor{comment}{// What type of son is the current element?}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00234}00234     \textcolor{comment}{// Ask its binary tree representation...}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00235}00235     \textcolor{keyword}{const} \textcolor{keywordtype}{int} son\_type = Tree\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7537f8fe7c896d2220eb2da03567b34d}{son\_type}}();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00236}00236 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00237}00237     \textcolor{comment}{// Has somebody built the current element already?}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00238}00238     \textcolor{comment}{// Check this by determining whether or not the first node has been built}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00240}00240     \textcolor{comment}{// If this element has not already been built...}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00241}00241     \textcolor{keywordflow}{if} (!nodes\_built())}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00242}00242     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00243}00243 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00244}00244       \textcolor{keywordflow}{if} (father\_pt == 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00245}00245       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00246}00246         \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00247}00247           \textcolor{stringliteral}{"{}Something fishy here: I have no father and yet \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00248}00248         error\_message += \textcolor{stringliteral}{"{}I have no nodes. Who has created me then?!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00249}00249 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00250}00250         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00251}00251           error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00252}00252       \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00253}00253 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00254}00254 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00255}00255       \textcolor{comment}{// Indicate status}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00256}00256       was\_already\_built = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00257}00257 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00258}00258       \textcolor{comment}{// Return pointer to father element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00259}00259       \mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4}{RefineableQElement<1>}}* father\_el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00260}00260         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4}{RefineableQElement<1>}}*\textcolor{keyword}{>}(father\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00261}00261 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00262}00262       \textcolor{comment}{// Timestepper should be the same for all nodes in father element.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00263}00263       \textcolor{comment}{// Use it create timesteppers for new nodes.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00264}00264       \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* time\_stepper\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00265}00265         father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>time\_stepper\_pt();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00266}00266 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00267}00267       \textcolor{comment}{// Determine number of history values (including present)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00268}00268       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} ntstorage = time\_stepper\_pt-\/>ntstorage();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00269}00269 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00270}00270       \textcolor{comment}{// Currently we can't handle the case of generalised coordinates}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00271}00271       \textcolor{comment}{// since we haven't established how they should be interpolated.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00272}00272       \textcolor{comment}{// Buffer this case:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00273}00273       \textcolor{keywordflow}{if} (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>nposition\_type() != 1)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00274}00274       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00275}00275         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Can't handle generalised nodal positions (yet)."{}},}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00276}00276                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00277}00277                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00278}00278       \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00279}00279 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00280}00280       \textcolor{comment}{// Set up vertex coordinates in the father element:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00281}00281       \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00282}00282 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00283}00283       \textcolor{comment}{// Allocate storage for the vertex coordinates s\_left and s\_right of}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00284}00284       \textcolor{comment}{// the current element as viewed by this element's father (i.e. s\_left[0]}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00285}00285       \textcolor{comment}{// stores the local coordinate within the father element at which the}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00286}00286       \textcolor{comment}{// node on the current element's left-\/hand edge is located. Likewise,}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00287}00287       \textcolor{comment}{// s\_right[0] stores the local coordinate within the father element at}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00288}00288       \textcolor{comment}{// which the node on the current element's right-\/hand edge is located).}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00289}00289       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_left(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00290}00290       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_right(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00292}00292       \textcolor{comment}{// In order to set up the vertex coordinates we need to know which}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00293}00293       \textcolor{comment}{// type of son the current element is}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00294}00294       \textcolor{keywordflow}{switch} (son\_type)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00295}00295       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00296}00296         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}:}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00297}00297           s\_left[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00298}00298           s\_right[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00299}00299           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00300}00300 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00301}00301         \textcolor{keywordflow}{case} \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}:}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00302}00302           s\_left[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00303}00303           s\_right[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00304}00304           \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00305}00305       \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00306}00306 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00307}00307       \textcolor{comment}{// Pass macro element pointer on to sons and set coordinates in}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00308}00308       \textcolor{comment}{// macro element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00309}00309       \textcolor{comment}{// hierher why can I see this?}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00310}00310       \textcolor{keywordflow}{if} (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5facfd17bf738c5632d4692f0433ca52}{Macro\_elem\_pt}} != 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00311}00311       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00312}00312         set\_macro\_elem\_pt(father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5facfd17bf738c5632d4692f0433ca52}{Macro\_elem\_pt}});}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00313}00313 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00314}00314         s\_macro\_ll(0) =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00315}00315           father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(0) +}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00316}00316           0.5 * (s\_left[0] + 1.0) *}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00317}00317             (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a0e02d2c0be2b93967700723d77891cb2}{s\_macro\_ur}}(0) -\/ father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(0));}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00318}00318         s\_macro\_ur(0) =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00319}00319           father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(0) +}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00320}00320           0.5 * (s\_right[0] + 1.0) *}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00321}00321             (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a0e02d2c0be2b93967700723d77891cb2}{s\_macro\_ur}}(0) -\/ father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1QElementBase_a6c5743d593aa67f9dbfcde9556a9bdd7}{s\_macro\_ll}}(0));}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00322}00322       \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00324}00324       \textcolor{comment}{// If the father element hasn't been generated yet, we're stuck...}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00325}00325       \textcolor{keywordflow}{if} (father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0) == 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00326}00326       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00327}00327         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00328}00328           \textcolor{stringliteral}{"{}Trouble: father\_el\_pt-\/>node\_pt(0)==0\(\backslash\)n Can't build son element!\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00329}00329           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00330}00330           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00331}00331       \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00332}00332       \textcolor{comment}{// Otherwise, carry on}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00333}00333       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00334}00334       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00335}00335         \textcolor{comment}{// Allocate storage for the location of a node in terms of the local}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00336}00336         \textcolor{comment}{// coordinate of the father element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00337}00337         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_father(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00338}00338 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00339}00339         \textcolor{comment}{// Allocate storage for the fractional position (in the current}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00340}00340         \textcolor{comment}{// element) of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00341}00341         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00342}00342 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00343}00343         \textcolor{comment}{// Loop over all nodes in the element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00344}00344         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00345}00345         \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00346}00346           \textcolor{comment}{// Get the fractional position (in the current element) of the node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00347}00347           \textcolor{comment}{// in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00348}00348           s\_fraction[0] = local\_one\_d\_fraction\_of\_node(n, 0);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00349}00349 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00350}00350           \textcolor{comment}{// Evaluate the local coordinate of the node in the father element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00351}00351           s\_in\_father[0] = s\_left[0] + (s\_right[0] -\/ s\_left[0]) * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00353}00353           \textcolor{comment}{// Initialise flag: So far, this node hasn't been built or copied yet}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00354}00354           \textcolor{keywordtype}{bool} node\_done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00356}00356           \textcolor{comment}{// Get the pointer to the node in the father (returns NULL if there}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00357}00357           \textcolor{comment}{// is no node at this position)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00358}00358           Node* created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00359}00359             father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_adf4424f1040fb5c4b6abfbd1c2bf65fc}{get\_node\_at\_local\_coordinate}}(s\_in\_father);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00360}00360 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00361}00361           \textcolor{comment}{// Does this node already exist in father element?}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00362}00362           \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00364}00364           \textcolor{comment}{// If it does...}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00365}00365           \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00366}00366           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00367}00367             \textcolor{comment}{// ...copy node across}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00368}00368             node\_pt(n) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00369}00369 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00370}00370             \textcolor{comment}{// Make sure that we update the values at the node so that they}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00371}00371             \textcolor{comment}{// are consistent with the present representation. This is only}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00372}00372             \textcolor{comment}{// needed for mixed interpolation where the value at the father}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00373}00373             \textcolor{comment}{// could now become active.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00375}00375             \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00376}00376             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00377}00377             \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00378}00378               \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00379}00379               \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00380}00380               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00381}00381               father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00382}00382                 \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_father, prev\_values);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00383}00383 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00384}00384               \textcolor{comment}{// Find the minimum number of values (either those stored at the}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00385}00385               \textcolor{comment}{// node, or those returned by the function)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00386}00386               \textcolor{keywordtype}{unsigned} n\_val\_at\_node = created\_node\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00387}00387               \textcolor{keywordtype}{unsigned} n\_val\_from\_function = prev\_values.size();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00388}00388 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00389}00389               \textcolor{comment}{// Use the ternary conditional operator here}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00390}00390               \textcolor{keywordtype}{unsigned} n\_var = n\_val\_at\_node < n\_val\_from\_function ?}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00391}00391                                  n\_val\_at\_node :}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00392}00392                                  n\_val\_from\_function;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00393}00393 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00394}00394               \textcolor{comment}{// Assign the values that we can}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00395}00395               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_var; k++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00396}00396               \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00397}00397                 created\_node\_pt-\/>set\_value(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, k, prev\_values[k]);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00398}00398               \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00399}00399             \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00400}00400 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00401}00401             \textcolor{comment}{// Indicate that node has been created by copy}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00402}00402             node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00403}00403           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00405}00405           \textcolor{comment}{// Node does not exist in father element but might already}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00406}00406           \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00407}00407           \textcolor{comment}{// have been created by neighbouring elements}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00408}00408           \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00410}00410           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00411}00411           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00412}00412             \textcolor{comment}{// Was the node created by one of its neighbours? Whether or not}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00413}00413             \textcolor{comment}{// the node lies on an edge can be calculated from the fractional}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00414}00414             \textcolor{comment}{// position.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00415}00415             \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00416}00416             created\_node\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00417}00417               node\_created\_by\_neighbour(s\_fraction, is\_periodic);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00418}00418 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00419}00419             \textcolor{comment}{// If the node was so created...}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00420}00420             \textcolor{keywordflow}{if} (created\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00421}00421             \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00422}00422               \textcolor{comment}{// ...assign the pointer}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00423}00423               node\_pt(n) = created\_node\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00424}00424 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00425}00425               \textcolor{comment}{// Indicate that node has been created by copy}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00426}00426               node\_done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00427}00427 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00428}00428               \textcolor{comment}{// In a 1D mesh there is no way that a periodic node (which must}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00429}00429               \textcolor{comment}{// be on a boundary) can exist without being part of the initial}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00430}00430               \textcolor{comment}{// (coarse) mesh. Therefore issue an error message if}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00431}00431               \textcolor{comment}{// node\_created\_by\_neighbour(...) returns `is\_periodic==true'.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00432}00432 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00433}00433               \textcolor{keywordflow}{if} (is\_periodic)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00434}00434               \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00435}00435                 \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00436}00436                   \textcolor{stringliteral}{"{}node\_created\_by\_neighbour returns a node which claims\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00437}00437                 error\_message += \textcolor{stringliteral}{"{}to be periodic. In a 1D mesh any periodic "{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00438}00438                                  \textcolor{stringliteral}{"{}nodes must exist\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00439}00439                 error\_message += \textcolor{stringliteral}{"{}in the initial (coarse) mesh."{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00440}00440 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00441}00441                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00442}00442                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00443}00443                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00444}00444               \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00445}00445 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00446}00446             \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00447}00447           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00448}00448 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00449}00449           \textcolor{comment}{// Node does not exist in father element or neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00450}00450           \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00451}00451 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00452}00452           \textcolor{comment}{// If the node has not been built anywhere -\/-\/-\/> build it here}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00453}00453           \textcolor{keywordflow}{if} (!node\_done)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00454}00454           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00455}00455             \textcolor{comment}{// In a 1D mesh any node which lies on the boundary must exist in}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00456}00456             \textcolor{comment}{// the initial (coarse) mesh, so any newly-\/built nodes cannot be}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00457}00457             \textcolor{comment}{// boundary nodes. Therefore we always create a normal "{}bulk"{} node.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00458}00458 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00459}00459             \textcolor{comment}{// Create node and set the pointer to it from the element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00460}00460             created\_node\_pt = construct\_node(n, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00462}00462             \textcolor{comment}{// Add to vector of new nodes}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00463}00463             new\_node\_pt.push\_back(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00464}00464 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00465}00465             \textcolor{comment}{// Now we set the position and values at the newly created node.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00466}00466             \textcolor{comment}{// In the first instance use macro element or FE representation}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00467}00467             \textcolor{comment}{// to create past and present nodal positions.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00468}00468             \textcolor{comment}{// (THIS STEP SHOULD NOT BE SKIPPED FOR ALGEBRAIC ELEMENTS AS NOT}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00469}00469             \textcolor{comment}{// ALL OF THEM NECESSARILY IMPLEMENT NONTRIVIAL NODE UPDATE}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00470}00470             \textcolor{comment}{// FUNCTIONS. CALLING THE NODE UPDATE FOR SUCH ELEMENTS/NODES WILL}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00471}00471             \textcolor{comment}{// LEAVE THEIR NODAL POSITIONS WHERE THEY WERE (THIS IS APPROPRIATE}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00472}00472             \textcolor{comment}{// ONCE THEY HAVE BEEN GIVEN POSITIONS) BUT WILL NOT ASSIGN SENSIBLE}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00473}00473             \textcolor{comment}{// INITIAL POSITIONS!)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00475}00475             \textcolor{comment}{// Loop over history values}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00476}00476             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < ntstorage; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00477}00477             \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00478}00478               \textcolor{comment}{// Allocate storage for the previous position of the node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00479}00479               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_prev(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00480}00480 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00481}00481               \textcolor{comment}{// Get position from father element -\/-\/ this uses the macro}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00482}00482               \textcolor{comment}{// element representation if appropriate.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00483}00483               father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_father, x\_prev);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00484}00484 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00485}00485               \textcolor{comment}{// Set the previous position of the new node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00486}00486               created\_node\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, 0) = x\_prev[0];}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00487}00487 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00488}00488               \textcolor{comment}{// Allocate storage for the previous values at the node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00489}00489               \textcolor{comment}{// NOTE: the size of this vector is equal to the number of values}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00490}00490               \textcolor{comment}{// (e.g. 3 velocity components and 1 pressure, say)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00491}00491               \textcolor{comment}{// associated with each node and NOT the number of history values}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00492}00492               \textcolor{comment}{// which the node stores!}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00493}00493               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} prev\_values;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00494}00494 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00495}00495               \textcolor{comment}{// Get values from father element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00496}00496               \textcolor{comment}{// Note: get\_interpolated\_values() sets Vector size itself.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00497}00497               father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00498}00498                 \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_father, prev\_values);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00499}00499 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00500}00500               \textcolor{comment}{// Determine the number of values at the new node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00501}00501               \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_value = created\_node\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00502}00502 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00503}00503               \textcolor{comment}{// Loop over all values and set the previous values}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00504}00504               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} v = 0; v < n\_value; v++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00505}00505               \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00506}00506                 created\_node\_pt-\/>set\_value(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, v, prev\_values[v]);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00507}00507               \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00508}00508             \} \textcolor{comment}{// End of loop over history values}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00509}00509 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00510}00510             \textcolor{comment}{// Add new node to mesh}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00511}00511             mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(created\_node\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00512}00512 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00513}00513           \} \textcolor{comment}{// End of case where we build the node ourselves}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00514}00514 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00515}00515           \textcolor{comment}{// Check if the element is an algebraic element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00516}00516           \mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}* alg\_el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00517}00517             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase}{AlgebraicElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00518}00518 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00519}00519           \textcolor{comment}{// If it is, set up node position (past and present) from algebraic}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00520}00520           \textcolor{comment}{// node position (past and present) from algebraic node update}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00521}00521           \textcolor{comment}{// node update function. This over-\/writes previous assingments that}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00522}00522           \textcolor{comment}{// were made based on the macro-\/element/FE representation.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00523}00523           \textcolor{comment}{// NOTE: YES, THIS NEEDS TO BE CALLED REPEATEDLY IF THE NODE IS A}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00524}00524           \textcolor{comment}{// MEMBER OF MULTIPLE ELEMENTS: THEY ALL ASSIGN THE SAME NODAL}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00525}00525           \textcolor{comment}{// POSITIONS BUT WE NEED TO ADD THE REMESH INFO FOR *ALL* ROOT}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00526}00526           \textcolor{comment}{// ELEMENTS!}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00527}00527           \textcolor{keywordflow}{if} (alg\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00528}00528           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00529}00529             \textcolor{comment}{// Build algebraic node update info for new node. This sets up}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00530}00530             \textcolor{comment}{// the node update data for all node update functions that are}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00531}00531             \textcolor{comment}{// shared by all nodes in the father element.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00532}00532             alg\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicElementBase_ab9ada27015d5cb28ae00b086ace3600f}{setup\_algebraic\_node\_update}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00533}00533               node\_pt(n), s\_in\_father, father\_el\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00534}00534           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00535}00535 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00536}00536           \textcolor{comment}{// If we have built the node and we are documenting our progress,}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00537}00537           \textcolor{comment}{// write the (hopefully consistent position) to the outputfile}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00538}00538           \textcolor{keywordflow}{if} ((!node\_done) \&\& (new\_nodes\_file.is\_open()))}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00539}00539           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00540}00540             new\_nodes\_file << node\_pt(n)-\/>x(0) << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00541}00541           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00542}00542         \} \textcolor{comment}{// End of loop over all nodes in element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00543}00543 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00544}00544 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00545}00545         \textcolor{comment}{// If the element is a MacroElementNodeUpdateElement, set the update}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00546}00546         \textcolor{comment}{// parameters for the current element's nodes -\/-\/ all this needs is}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00547}00547         \textcolor{comment}{// the vector of (pointers to the) geometric objects that affect the}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00548}00548         \textcolor{comment}{// MacroElement-\/based node update. This is the same as that in the}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00549}00549         \textcolor{comment}{// father element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00550}00550         \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* father\_m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00551}00551           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(father\_el\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00552}00552         \textcolor{keywordflow}{if} (father\_m\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00553}00553         \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00554}00554           \textcolor{comment}{// Get Vector of geometric objects from father (construct Vector}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00555}00555           \textcolor{comment}{// via copy operation)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00556}00556           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeomObject*>}} geom\_object\_pt(father\_m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_afcffd290cc0292a571e7a443bc23728b}{geom\_object\_pt}}());}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00557}00557 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00558}00558           \textcolor{comment}{// Cast current element to MacroElementNodeUpdateElement:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00559}00559           \mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}* m\_el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00560}00560             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase}{MacroElementNodeUpdateElementBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00561}00561 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00562}00562 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00563}00563           \textcolor{keywordflow}{if} (m\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00564}00564           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00565}00565             \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00566}00566               \textcolor{stringliteral}{"{}Failed to cast to MacroElementNodeUpdateElementBase*\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00567}00567             error\_message +=}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00568}00568               \textcolor{stringliteral}{"{}Strange -\/-\/ if the father is a MacroElementNodeUpdateElement\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00569}00569             error\_message += \textcolor{stringliteral}{"{}the son should be too....\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00570}00570 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00571}00571             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00572}00572               error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00573}00573           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00574}00574 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00575}00575           \textcolor{comment}{// Build update info by passing Vector of geometric objects:}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00576}00576           \textcolor{comment}{// This sets the current element to be the update element for all}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00577}00577           \textcolor{comment}{// of the element's nodes. This is reversed if the element is}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00578}00578           \textcolor{comment}{// ever un-\/refined in the father element's rebuild\_from\_sons()}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00579}00579           \textcolor{comment}{// function which overwrites this assignment to avoid nasty}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00580}00580           \textcolor{comment}{// segmentation faults that occur when a node tries to update}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00581}00581           \textcolor{comment}{// itself via an element that no longer exists...}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00582}00582           m\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1MacroElementNodeUpdateElementBase_aa2408d8463e8cecc2ad12a93e10390b1}{set\_node\_update\_info}}(geom\_object\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00583}00583         \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00584}00584 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00585}00585 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00586}00586         \textcolor{comment}{// Pass on non-\/halo proc ID}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00587}00587         Non\_halo\_proc\_ID =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00588}00588           tree\_pt()-\/>father\_pt()-\/>object\_pt()-\/>non\_halo\_proc\_ID();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00589}00589 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00590}00590 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00591}00591         \textcolor{comment}{// Is the new element an ElementWithMovingNodes?}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00592}00592         \mbox{\hyperlink{classoomph_1_1ElementWithMovingNodes}{ElementWithMovingNodes}}* aux\_el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00593}00593           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1ElementWithMovingNodes}{ElementWithMovingNodes}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00594}00594 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00595}00595         \textcolor{comment}{// Pass down the information re the method for the evaluation}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00596}00596         \textcolor{comment}{// of the shape derivatives}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00597}00597         \textcolor{keywordflow}{if} (aux\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00598}00598         \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00599}00599           \mbox{\hyperlink{classoomph_1_1ElementWithMovingNodes}{ElementWithMovingNodes}}* aux\_father\_el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00600}00600             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1ElementWithMovingNodes}{ElementWithMovingNodes}}*\textcolor{keyword}{>}(father\_el\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00601}00601 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00602}00602 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00603}00603           \textcolor{keywordflow}{if} (aux\_father\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00604}00604           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00605}00605             \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00606}00606               \textcolor{stringliteral}{"{}Failed to cast to ElementWithMovingNodes*\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00607}00607             error\_message +=}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00608}00608               \textcolor{stringliteral}{"{}Strange -\/-\/ if the son is a ElementWithMovingNodes\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00609}00609             error\_message += \textcolor{stringliteral}{"{}the father should be too....\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00610}00610 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00611}00611             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00612}00612               error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00613}00613           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00614}00614 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00615}00615 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00616}00616           \textcolor{comment}{// If evaluating the residuals by finite differences in the father}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00617}00617           \textcolor{comment}{// continue to do so in the child}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00618}00618           \textcolor{keywordflow}{if} (aux\_father\_el\_pt}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00619}00619                 -\/>are\_dresidual\_dnodal\_coordinates\_always\_evaluated\_by\_fd())}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00620}00620           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00621}00621             aux\_el\_pt}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00622}00622               -\/>\mbox{\hyperlink{classoomph_1_1ElementWithMovingNodes_af3b9389f9b34d941ca1b9a058ce4cc2c}{enable\_always\_evaluate\_dresidual\_dnodal\_coordinates\_by\_fd}}();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00623}00623           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00624}00624 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00625}00625           aux\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1ElementWithMovingNodes_aa3559717ddcceb96109cc5dafbc11de2}{method\_for\_shape\_derivs}}() =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00626}00626             aux\_father\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1ElementWithMovingNodes_aa3559717ddcceb96109cc5dafbc11de2}{method\_for\_shape\_derivs}}();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00627}00627 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00628}00628           \textcolor{comment}{// If bypassing the evaluation of fill\_in\_jacobian\_from\_geometric\_data}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00629}00629           \textcolor{comment}{// continue to do so}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00630}00630           \textcolor{keywordflow}{if} (aux\_father\_el\_pt}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00631}00631                 -\/>is\_fill\_in\_jacobian\_from\_geometric\_data\_bypassed())}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00632}00632           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00633}00633             aux\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1ElementWithMovingNodes_a580ecb70417536ceb1121afd3bea0d54}{enable\_bypass\_fill\_in\_jacobian\_from\_geometric\_data}}();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00634}00634           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00635}00635         \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00637}00637 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00638}00638         \textcolor{comment}{// Now do further build (if any)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00639}00639         further\_build();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00640}00640 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00641}00641       \} \textcolor{comment}{// Sanity check: Father element has been generated}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00642}00642 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00643}00643     \} \textcolor{comment}{// End of if element has not already been built}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00644}00644 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00645}00645     \textcolor{comment}{// If element has already been built, say so}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00646}00646     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00647}00647     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00648}00648       was\_already\_built = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00649}00649     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00650}00650   \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00651}00651 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00652}00652   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00653}00653 \textcolor{comment}{  ///  Print corner nodes, use colour (default "{}BLACK"{})}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00654}00654 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00655}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4_aa1ec4cdf297f9061f41c6e6cccb087e9}{00655}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<1>::output\_corners}}(std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00656}00656                                              \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}}\& \mbox{\hyperlink{namespaceoomph_1_1TecplotNames_a628a7d88afc7542861c9afd2f4ea498c}{colour}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00657}00657 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00658}00658     \textcolor{comment}{// Allocate storage for local coordinate s}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00659}00659     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00660}00660 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00661}00661     \textcolor{comment}{// Allocate storage for global coordinate of element vertex}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00662}00662     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} vertex(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00663}00663 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00664}00664     outfile << \textcolor{stringliteral}{"{}ZONE I=2,J=2, C="{}} << \mbox{\hyperlink{namespaceoomph_1_1TecplotNames_a628a7d88afc7542861c9afd2f4ea498c}{colour}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00665}00665 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00666}00666     \textcolor{comment}{// Left-\/hand vertex}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00667}00667     \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00668}00668     get\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, vertex);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00669}00669     outfile << vertex[0] << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{namespaceoomph_1_1Global__unsigned_aa0b4579f7ee228aaf16302f4b39e0fdf}{Number}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00670}00670 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00671}00671     \textcolor{comment}{// Right-\/hand vertex}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00672}00672     \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00673}00673     get\_x(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, vertex);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00674}00674     outfile << vertex[0] << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{namespaceoomph_1_1Global__unsigned_aa0b4579f7ee228aaf16302f4b39e0fdf}{Number}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00675}00675 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00676}00676     outfile << \textcolor{stringliteral}{"{}TEXT  CS = GRID, X = "{}} << vertex[0]}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00677}00677             << \textcolor{stringliteral}{"{}, HU = GRID, H = 0.01, AN = MIDCENTER, T =\(\backslash\)"{}"{}} << \mbox{\hyperlink{namespaceoomph_1_1Global__unsigned_aa0b4579f7ee228aaf16302f4b39e0fdf}{Number}} << \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00678}00678             << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00679}00679   \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00680}00680 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00681}00681   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00682}00682 \textcolor{comment}{  /// Check inter-\/element continuity of}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00683}00683 \textcolor{comment}{  /// -\/ nodal positions}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00684}00684 \textcolor{comment}{  /// -\/ (nodally) interpolated function values}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00685}00685 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00686}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4_a64d91c3deb6f1c7532b77f9e673bb150}{00686}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<1>::check\_integrity}}(\textcolor{keywordtype}{double}\& max\_error)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00687}00687   \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00688}00688     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00690}00690     \textcolor{comment}{// Calculate number of nodes}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00691}00691     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = nnode\_1d();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00692}00692 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00693}00693     \textcolor{comment}{// Number of timesteps (including present) for which continuity is}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00694}00694     \textcolor{comment}{// to be checked}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00695}00695     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_time = 1;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00696}00696 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00697}00697     \textcolor{comment}{// Initialise errors}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00698}00698     max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00699}00699     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} max\_error\_x(1, 0.0);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00700}00700     \textcolor{keywordtype}{double} max\_error\_val = 0.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00701}00701 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00702}00702     \textcolor{comment}{// Initialise vector of element edges in the current element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00703}00703     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} edge\_in\_current(2);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00704}00704     edge\_in\_current[0] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00705}00705     edge\_in\_current[1] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00706}00706 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00707}00707     \textcolor{comment}{// Loop over both edges}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00708}00708     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} edge\_counter = 0; edge\_counter < 2; edge\_counter++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00709}00709     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00710}00710       \textcolor{comment}{// Allocate storage for the fractional position (in the current}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00711}00711       \textcolor{comment}{// element) of the node in the direction of s[0]}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00712}00712       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_fraction(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00713}00713 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00714}00714       \textcolor{comment}{// Allocate storage for the location of a node in terms of the local}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00715}00715       \textcolor{comment}{// coordinate of the current element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00716}00716       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_current(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00717}00717 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00718}00718       \textcolor{comment}{// Allocate storage for the location of a node in terms of the local}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00719}00719       \textcolor{comment}{// coordinate of the neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00720}00720       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neighbour(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00721}00721 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00722}00722       \textcolor{comment}{// Allocate storage for edge in neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00723}00723       \textcolor{keywordtype}{int} edge\_in\_neighbour;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00724}00724 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00725}00725       \textcolor{comment}{// Allocate storage for difference in size between current and}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00726}00726       \textcolor{comment}{// neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00727}00727       \textcolor{keywordtype}{int} diff\_level;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00728}00728 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00729}00729       \textcolor{comment}{// Allocate storage for flag indicating if the node is not in the same}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00730}00730       \textcolor{comment}{// binary tree}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00731}00731       \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00732}00732 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00733}00733       \textcolor{comment}{// Calculate the local coordinate and the local coordinate as viewed}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00734}00734       \textcolor{comment}{// from the neighbour}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00735}00735 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00736}00736       \textcolor{comment}{// Allocate storage for the pointer to the neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00737}00737       \textcolor{comment}{// (using its binary tree representation)}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00738}00738       \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* neighbour\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00739}00739 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00740}00740       \textcolor{comment}{// Find pointer to neighbouring element along the edge in question and}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00741}00741       \textcolor{comment}{// calculate the local coordinate of the node within that element,}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00742}00742       \textcolor{comment}{// s\_in\_neighbour}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00743}00743       neighbour\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00744}00744         binary\_tree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1BinaryTree_aba768160bad3531d0f62033788619f56}{gteq\_edge\_neighbour}}(edge\_in\_current[edge\_counter],}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00745}00745                                               s\_in\_neighbour,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00746}00746                                               edge\_in\_neighbour,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00747}00747                                               diff\_level,}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00748}00748                                               in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00749}00749 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00750}00750       \textcolor{comment}{// If neighbour exists and has existing nodes}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00751}00751       \textcolor{keywordflow}{if} ((neighbour\_pt != 0) \&\& (neighbour\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a50758228db823d72ea8da23dbb000901}{nodes\_built}}()))}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00752}00752       \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00753}00753         \textcolor{comment}{// Need to exclude periodic nodes from this check.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00754}00754         \textcolor{comment}{// There are only periodic nodes if we are in a neighbouring tree...}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00755}00755         \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00756}00756         \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00757}00757         \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00758}00758           \textcolor{comment}{// Is it periodic?}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00759}00759           is\_periodic = tree\_pt()-\/>\mbox{\hyperlink{classoomph_1_1Tree_a33b9926754cddfaafd9869af3fe266e7}{root\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1TreeRoot_a7be347e54e34f924c008c302f5146064}{is\_neighbour\_periodic}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00760}00760             edge\_in\_current[edge\_counter]);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00761}00761         \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00762}00762 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00763}00763         \textcolor{comment}{// Allocate storage for pointer to the local node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00764}00764         Node* local\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00765}00765 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00766}00766         \textcolor{keywordflow}{switch} (edge\_counter)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00767}00767         \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00768}00768           \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00769}00769             \textcolor{comment}{// Local fraction of node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00770}00770             s\_fraction[0] = 0.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00771}00771             \textcolor{comment}{// Get pointer to local node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00772}00772             local\_node\_pt = node\_pt(0);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00773}00773             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00774}00774 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00775}00775           \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00776}00776             \textcolor{comment}{// Local fraction of node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00777}00777             s\_fraction[0] = 1.0;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00778}00778             \textcolor{comment}{// Get pointer to local node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00779}00779             local\_node\_pt = node\_pt(n\_node -\/ 1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00780}00780             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00781}00781         \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00782}00782 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00783}00783         \textcolor{comment}{// Evaluate the local coordinate of the node in the current element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00784}00784         s\_in\_current[0] = -\/1.0 + 2.0 * s\_fraction[0];}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00785}00785 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00786}00786         \textcolor{comment}{// NOTE: We have already calculated the local coordinate of the node}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00787}00787         \textcolor{comment}{// in the neighbouring element above when calling gteq\_edge\_neighbour()}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00788}00788 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00789}00789         \textcolor{comment}{// Loop over timesteps}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00790}00790         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < n\_time; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00791}00791         \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00792}00792           \textcolor{comment}{// Allocate storage for the nodal position in the neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00793}00793           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_in\_neighbour(1);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00794}00794 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00795}00795           \textcolor{comment}{// Get the nodal position from the neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00796}00796           neighbour\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a40b7ab54112a2c6100da99ac801f7a06}{interpolated\_x}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00797}00797             \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_neighbour, x\_in\_neighbour);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00798}00798 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00799}00799           \textcolor{comment}{// Check error only if the node is NOT periodic}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00800}00800           \textcolor{keywordflow}{if} (is\_periodic == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00801}00801           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00802}00802             \textcolor{comment}{// Find the spatial error}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00803}00803             \textcolor{keywordtype}{double} err = std::fabs(local\_node\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, 0) -\/ x\_in\_neighbour[0]);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00804}00804 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00805}00805             \textcolor{comment}{// If it's bigger than our tolerance, say so}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00806}00806             \textcolor{keywordflow}{if} (err > 1\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}-\/9)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00807}00807             \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00808}00808               \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}errx "{}} << err << \textcolor{stringliteral}{"{} "{}} << \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00809}00809                          << local\_node\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, 0) << \textcolor{stringliteral}{"{} "{}} << x\_in\_neighbour[0]}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00810}00810                          << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00811}00811 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00812}00812               \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}at "{}} << local\_node\_pt-\/>x(0) << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00813}00813             \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00814}00814 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00815}00815             \textcolor{comment}{// If it's bigger than the previous max error, it is the}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00816}00816             \textcolor{comment}{// new max error!}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00817}00817             \textcolor{keywordflow}{if} (err > max\_error\_x[0])}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00818}00818             \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00819}00819               max\_error\_x[0] = err;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00820}00820             \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00821}00821           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00822}00822           \textcolor{comment}{// Allocate storage for the nodal values in the neighbouring element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00823}00823           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} values\_in\_neighbour;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00824}00824 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00825}00825           \textcolor{comment}{// Get the values from neighbouring element. NOTE: Number of values}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00826}00826           \textcolor{comment}{// gets set by routine (because in general we don't know how many}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00827}00827           \textcolor{comment}{// interpolated values a certain element has.}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00828}00828           neighbour\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_ad9a4f92880668a2373326d8306365c43}{get\_interpolated\_values}}(}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00829}00829             \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_neighbour, values\_in\_neighbour);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00830}00830 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00831}00831           \textcolor{comment}{// Allocate storage for the nodal values in the current element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00832}00832           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} values\_in\_current;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00833}00833 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00834}00834           \textcolor{comment}{// Get the values in current element}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00835}00835           get\_interpolated\_values(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, s\_in\_current, values\_in\_current);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00836}00836 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00837}00837           \textcolor{comment}{// Now figure out how many continuously interpolated values there are}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00838}00838           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} num\_val =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00839}00839             neighbour\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a53e171a18c9f43f1db90a6876516a073}{ncont\_interpolated\_values}}();}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00840}00840 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00841}00841           \textcolor{comment}{// Check error}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00842}00842           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ival = 0; ival < num\_val; ival++)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00843}00843           \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00844}00844             \textcolor{comment}{// Find the spatial error}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00845}00845             \textcolor{keywordtype}{double} err =}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00846}00846               std::fabs(values\_in\_current[ival] -\/ values\_in\_neighbour[ival]);}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00847}00847 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00848}00848             \textcolor{comment}{// If it's bigger than our tolerance, say so}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00849}00849             \textcolor{keywordflow}{if} (err > 1.0e-\/10)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00850}00850             \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00851}00851               \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << local\_node\_pt-\/>x(0) << \textcolor{stringliteral}{"{}\(\backslash\)n\# "{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00852}00852                          << \textcolor{stringliteral}{"{}erru "{}} << err << \textcolor{stringliteral}{"{} "{}} << ival << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00853}00853                          << get\_node\_number(local\_node\_pt) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00854}00854                          << values\_in\_current[ival] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00855}00855                          << values\_in\_neighbour[ival] << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00856}00856             \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00857}00857 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00858}00858             \textcolor{comment}{// If it's bigger than the previous max error, it is the}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00859}00859             \textcolor{comment}{// new max error!}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00860}00860             \textcolor{keywordflow}{if} (err > max\_error\_val)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00861}00861             \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00862}00862               max\_error\_val = err;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00863}00863             \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00864}00864           \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00865}00865         \} \textcolor{comment}{// End of loop over timesteps}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00866}00866       \} \textcolor{comment}{// End of if neighbour exists and has existing nodes}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00867}00867     \} \textcolor{comment}{// End of loop over edges}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00868}00868 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00869}00869     \textcolor{comment}{// Update max\_error if necessary}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00870}00870     max\_error = max\_error\_x[0];}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00871}00871     \textcolor{keywordflow}{if} (max\_error\_val > max\_error)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00872}00872     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00873}00873       max\_error = max\_error\_val;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00874}00874     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00875}00875 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00876}00876     \textcolor{comment}{// Output max\_error information}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00877}00877     \textcolor{keywordflow}{if} (max\_error > 1\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}-\/9)}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00878}00878     \{}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00879}00879       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ \(\backslash\)n\#Max error "{}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00880}00880       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << max\_error\_x[0] << \textcolor{stringliteral}{"{} "{}} << max\_error\_val << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00881}00881       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\#-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ \(\backslash\)n "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00882}00882     \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00883}00883   \}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00884}00884 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00885}00885   \textcolor{comment}{//==========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00886}00886 \textcolor{comment}{  /// Static matrix for coincidence between son nodal points and father}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00887}00887 \textcolor{comment}{  /// boundaries}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00888}00888 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00889}00889   std::map<unsigned, DenseMatrix<int>> \mbox{\hyperlink{classoomph_1_1RefineableQElement}{RefineableQElement<1>::Father\_bound}};}
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00890}00890 }
\DoxyCodeLine{\Hypertarget{refineable__line__element_8cc_source_l00891}00891 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

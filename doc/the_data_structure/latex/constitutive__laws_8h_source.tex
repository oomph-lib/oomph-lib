\hypertarget{constitutive__laws_8h_source}{}\doxysection{constitutive\+\_\+laws.\+h}
\label{constitutive__laws_8h_source}\index{constitutive\_laws.h@{constitutive\_laws.h}}
\mbox{\hyperlink{constitutive__laws_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00026}00026 \textcolor{comment}{// Header file for ConstitutiveLaw objects that will be used in all}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00027}00027 \textcolor{comment}{// elasticity-\/type elements}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00029}00029 \textcolor{preprocessor}{\#ifndef OOMPH\_CONSTITUTIVE\_LAWS\_HEADER}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00030}00030 \textcolor{preprocessor}{\#define OOMPH\_CONSTITUTIVE\_LAWS\_HEADER}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00032}00032 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00033}00033 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00034}00034 \textcolor{preprocessor}{\#include <oomph-\/lib-\/config.h>}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00035}00035 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00037}00037 \textcolor{comment}{// OOMPH-\/LIB includes}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00038}00038 \textcolor{preprocessor}{\#include "{}../generic/oomph\_utilities.h"{}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00039}00039 \textcolor{preprocessor}{\#include "{}../generic/matrices.h"{}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00040}00040 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00041}00041 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00042}00042 \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00043}00043   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00044}00044 \textcolor{comment}{  /// Base class for strain energy functions to be used in solid}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00045}00045 \textcolor{comment}{  /// mechanics computations.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00046}00046 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00047}\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{00047}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{StrainEnergyFunction}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00048}00048   \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00049}00049   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00050}00050 \textcolor{comment}{    /// Constructor takes no arguments}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00051}\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a027b9babcedcefb3fd06a6deace8f6b6}{00051}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a027b9babcedcefb3fd06a6deace8f6b6}{StrainEnergyFunction}}() \{\}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00052}00052 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00053}00053 \textcolor{comment}{    /// Empty virtual destructor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00054}\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a755d306f96fc59147c6cb148456e364e}{00054}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a755d306f96fc59147c6cb148456e364e}{\string~StrainEnergyFunction}}() \{\}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00056}00056 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00057}00057 \textcolor{comment}{    /// Return the strain energy in terms of the strain tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00058}\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a76cadaefaa89b93793c893f1302bd68a}{00058}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a76cadaefaa89b93793c893f1302bd68a}{W}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& gamma)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00059}00059     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00060}00060       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00061}00061         \textcolor{stringliteral}{"{}The strain-\/energy function as a function of the strain-\/tensor,\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00062}00062       error\_message +=}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00063}00063         \textcolor{stringliteral}{"{}gamma, is not implemented for this strain energy function.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00064}00064 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00065}00065       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00066}00066         error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00067}00067       \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00068}00068     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00070}00070 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00071}00071 \textcolor{comment}{    /// Return the strain energy in terms of the strain invariants}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00072}\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a99df34610d4542568f65c568ae3a908f}{00072}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a99df34610d4542568f65c568ae3a908f}{W}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}})}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00073}00073     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00074}00074       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message =}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00075}00075         \textcolor{stringliteral}{"{}The strain-\/energy function as a function of the strain\(\backslash\)n "{}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00076}00076       error\_message +=}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00077}00077         \textcolor{stringliteral}{"{}invariants, I1, I2, I3, is not implemented for this strain\(\backslash\)n "{}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00078}00078       error\_message += \textcolor{stringliteral}{"{}energy function\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00079}00079 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00080}00080       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00081}00081         error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00082}00082       \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00083}00083     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00085}00085 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00086}00086 \textcolor{comment}{    /// Return the derivatives of the strain energy function with}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00087}00087 \textcolor{comment}{    /// respect to the components of the strain tensor (default is to use}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00088}00088 \textcolor{comment}{    /// finite differences).}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00089}\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a467a3b01986940aba8c8aff2715bf086}{00089}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a467a3b01986940aba8c8aff2715bf086}{derivative}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& gamma,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00090}00090                             \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& dWdgamma)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00091}00091     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00092}00092       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00093}00093         \textcolor{stringliteral}{"{}Sorry, the FD setup of dW/dgamma hasn't been implemented yet"{}},}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00094}00094         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00095}00095         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00096}00096     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00098}00098 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00099}00099 \textcolor{comment}{    /// Return the derivatives of the strain energy function with}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00100}00100 \textcolor{comment}{    /// respect to the strain invariants. Default version is to use finite}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00101}00101 \textcolor{comment}{    /// differences}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00102}\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a81ca7bb14cce217ffac9d308dba39756}{00102}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a81ca7bb14cce217ffac9d308dba39756}{derivatives}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& dWdI)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00103}00103     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00104}00104       \textcolor{comment}{// Calculate the derivatives of the strain-\/energy-\/function wrt the strain}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00105}00105       \textcolor{comment}{// invariants}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00106}00106       \textcolor{keywordtype}{double} FD\_Jstep = 1.0e-\/8; \textcolor{comment}{// Usual comments about global stuff}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00107}00107       \textcolor{keywordtype}{double} energy = \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a76cadaefaa89b93793c893f1302bd68a}{W}}(\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}});}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00109}00109       \textcolor{comment}{// Loop over the strain invariants}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00110}00110       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < 3; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00111}00111       \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00112}00112         \textcolor{comment}{// Store old value}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00113}00113         \textcolor{keywordtype}{double} I\_prev = \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00114}00114         \textcolor{comment}{// Increase ith strain invariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00115}00115         \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += FD\_Jstep;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00116}00116         \textcolor{comment}{// Get the new value of the strain energy}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00117}00117         \textcolor{keywordtype}{double} energy\_new = \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a76cadaefaa89b93793c893f1302bd68a}{W}}(\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}});}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00118}00118         \textcolor{comment}{// Calculate the value of the derivative}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00119}00119         dWdI[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = (energy\_new -\/ energy) / FD\_Jstep;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00120}00120         \textcolor{comment}{// Reset value of ith strain invariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00121}00121         \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = I\_prev;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00122}00122       \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00123}00123     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00124}00124 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00125}00125 \textcolor{comment}{    /// Pure virtual function in which the user must declare if the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00126}00126 \textcolor{comment}{    /// constitutive equation requires an incompressible formulation}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00127}00127 \textcolor{comment}{    /// in which the volume constraint is enforced explicitly.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00128}00128 \textcolor{comment}{    /// Used as a sanity check in PARANOID mode.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00129}\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a312fe03c070f5c45a99ae4e186936147}{00129}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a312fe03c070f5c45a99ae4e186936147}{requires\_incompressibility\_constraint}}() = 0;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00130}00130   \};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00131}00131 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00132}00132 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00133}00133 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00134}00134 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00135}00135 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00136}00136 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00138}00138   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00139}00139 \textcolor{comment}{  /// MooneyRivlin strain-\/energy function.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00140}00140 \textcolor{comment}{  /// with constitutive parameters C1 and C2:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00141}00141 \textcolor{comment}{  /// \(\backslash\)f[ W = C\_1 (I\_0 -\/ 3) + C\_2 (I\_1 -\/ 3) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00142}00142 \textcolor{comment}{  /// where incompressibility (\(\backslash\)f\$ I\_2 \(\backslash\)equiv 1\(\backslash\)f\$) is assumed.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00143}00143 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00144}\mbox{\hyperlink{classoomph_1_1MooneyRivlin}{00144}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1MooneyRivlin}{MooneyRivlin}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{StrainEnergyFunction}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00145}00145   \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00146}00146   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00147}00147 \textcolor{comment}{    /// Constructor takes the pointer to the value of the constants}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00148}\mbox{\hyperlink{classoomph_1_1MooneyRivlin_ac67b8747413e5e7cca8f0d4c42b8ecdc}{00148}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1MooneyRivlin_ac67b8747413e5e7cca8f0d4c42b8ecdc}{MooneyRivlin}}(\textcolor{keywordtype}{double}* c1\_pt, \textcolor{keywordtype}{double}* c2\_pt)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00149}00149       : \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{StrainEnergyFunction}}(), \mbox{\hyperlink{classoomph_1_1MooneyRivlin_abbaf1eefb4ccf8a51224bd18e903449b}{C1\_pt}}(c1\_pt), \mbox{\hyperlink{classoomph_1_1MooneyRivlin_a44b67554972b5659b5017598951be5fa}{C2\_pt}}(c2\_pt)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00150}00150     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00151}00151     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00152}00152 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00153}00153 \textcolor{comment}{    /// Empty Virtual destructor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00154}\mbox{\hyperlink{classoomph_1_1MooneyRivlin_a8ac6843acd4229d6b53af7a06b0d7363}{00154}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1MooneyRivlin_a8ac6843acd4229d6b53af7a06b0d7363}{\string~MooneyRivlin}}() \{\}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00155}00155 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00156}00156 \textcolor{comment}{    /// Return the strain energy in terms of strain tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00157}\mbox{\hyperlink{classoomph_1_1MooneyRivlin_a9411c5fbb920d071e83a9e52fb8b60d1}{00157}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1MooneyRivlin_a9411c5fbb920d071e83a9e52fb8b60d1}{W}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& gamma)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00158}00158     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00159}00159       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a76cadaefaa89b93793c893f1302bd68a}{StrainEnergyFunction::W}}(gamma);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00160}00160     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00161}00161 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00162}00162 \textcolor{comment}{    /// Return the strain energy in terms of the strain invariants}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00163}\mbox{\hyperlink{classoomph_1_1MooneyRivlin_aa610beb4e7b06dc3aa57bbc552ca0b80}{00163}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1MooneyRivlin_aa610beb4e7b06dc3aa57bbc552ca0b80}{W}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}})}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00164}00164     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00165}00165       \textcolor{keywordflow}{return} (*\mbox{\hyperlink{classoomph_1_1MooneyRivlin_abbaf1eefb4ccf8a51224bd18e903449b}{C1\_pt}}) * (\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[0] -\/ 3.0) + (*\mbox{\hyperlink{classoomph_1_1MooneyRivlin_a44b67554972b5659b5017598951be5fa}{C2\_pt}}) * (\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[1] -\/ 3.0);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00166}00166     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00167}00167 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00168}00168 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00169}00169 \textcolor{comment}{    /// Return the derivatives of the strain energy function with}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00170}00170 \textcolor{comment}{    /// respect to the strain invariants}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00171}\mbox{\hyperlink{classoomph_1_1MooneyRivlin_a01ff4e87c76813d6a9e528bd896a2bae}{00171}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1MooneyRivlin_a01ff4e87c76813d6a9e528bd896a2bae}{derivatives}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& dWdI)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00172}00172     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00173}00173       dWdI[0] = (*C1\_pt);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00174}00174       dWdI[1] = (*C2\_pt);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00175}00175       dWdI[2] = 0.0;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00176}00176     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00177}00177 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00178}00178 \textcolor{comment}{    /// Pure virtual function in which the user must declare if the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00179}00179 \textcolor{comment}{    /// constitutive equation requires an incompressible formulation}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00180}00180 \textcolor{comment}{    /// in which the volume constraint is enforced explicitly.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00181}00181 \textcolor{comment}{    /// Used as a sanity check in PARANOID mode. True}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00182}\mbox{\hyperlink{classoomph_1_1MooneyRivlin_ad5cd489e1bc8f4cfe1f147135ffe21af}{00182}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1MooneyRivlin_ad5cd489e1bc8f4cfe1f147135ffe21af}{requires\_incompressibility\_constraint}}()}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00183}00183     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00184}00184       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00185}00185     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00187}00187 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00188}00188   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00189}00189 \textcolor{comment}{    /// Pointer to first Mooney Rivlin constant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00190}\mbox{\hyperlink{classoomph_1_1MooneyRivlin_abbaf1eefb4ccf8a51224bd18e903449b}{00190}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1MooneyRivlin_abbaf1eefb4ccf8a51224bd18e903449b}{C1\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00191}00191 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00192}00192 \textcolor{comment}{    /// Pointer to second Mooney Rivlin constant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00193}\mbox{\hyperlink{classoomph_1_1MooneyRivlin_a44b67554972b5659b5017598951be5fa}{00193}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1MooneyRivlin_a44b67554972b5659b5017598951be5fa}{C2\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00194}00194   \};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00196}00196 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00197}00197 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00198}00198 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00199}00199 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00200}00200 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00201}00201 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00202}00202   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00203}00203 \textcolor{comment}{  /// Generalisation of Mooney Rivlin constitutive law to compressible}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00204}00204 \textcolor{comment}{  /// media as suggested on p. 553 of Fung, Y.C. \& Tong, P. "{}Classical and}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00205}00205 \textcolor{comment}{  /// Computational Solid Mechanics"{} World Scientific (2001).}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00206}00206 \textcolor{comment}{  /// Input parameters are Young's modulus E, Poisson ratio nu and}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00207}00207 \textcolor{comment}{  /// the Mooney-\/Rivlin constant C1. In the small-\/deformation-\/limit}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00208}00208 \textcolor{comment}{  /// the behaviour becomes equivalent to that of linear elasticity}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00209}00209 \textcolor{comment}{  /// with the same E and nu.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00210}00210 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00211}00211 \textcolor{comment}{  /// Note that there's a factor of 2 difference between C1 and the Mooney}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00212}00212 \textcolor{comment}{  /// Rivlin C1!}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00213}00213 \textcolor{comment}{}  \textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00214}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin}{00214}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin}{GeneralisedMooneyRivlin}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{StrainEnergyFunction}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00215}00215   \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00216}00216   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00217}00217 \textcolor{comment}{    /// Constructor takes the pointers to the constitutive parameters:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00218}00218 \textcolor{comment}{    /// Poisson's ratio, the Mooney-\/Rivlin parameter. Young's modulus is set}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00219}00219 \textcolor{comment}{    /// to 1, implying that it has been used to scale the stresses}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00220}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a04bdac757114843e1b758b64a552c23b}{00220}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a04bdac757114843e1b758b64a552c23b}{GeneralisedMooneyRivlin}}(\textcolor{keywordtype}{double}* nu\_pt, \textcolor{keywordtype}{double}* c1\_pt)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00221}00221       : \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{StrainEnergyFunction}}(),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00222}00222         \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_ae66d1130fccc98fc68d810f1f3e6b281}{Nu\_pt}}(nu\_pt),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00223}00223         \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_aebb4709747e2855ddaa8b455d50d0174}{C1\_pt}}(c1\_pt),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00224}00224         \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a4844de8de168e51c24c5508ef195ae7a}{E\_pt}}(new double(1.0)),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00225}00225         \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a38d89cd3412cac1adb945713168a5c86}{Must\_delete\_e}}(true)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00226}00226     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00227}00227     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00228}00228 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00229}00229 \textcolor{comment}{    /// Constructor takes the pointers to the constitutive parameters:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00230}00230 \textcolor{comment}{    /// Poisson's ratio, the Mooney-\/Rivlin parameter and Young's modulus}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00231}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a4c709851b0ed6e9a975d69c1b2146429}{00231}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a4c709851b0ed6e9a975d69c1b2146429}{GeneralisedMooneyRivlin}}(\textcolor{keywordtype}{double}* nu\_pt, \textcolor{keywordtype}{double}* c1\_pt, \textcolor{keywordtype}{double}* e\_pt)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00232}00232       : \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{StrainEnergyFunction}}(),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00233}00233         \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_ae66d1130fccc98fc68d810f1f3e6b281}{Nu\_pt}}(nu\_pt),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00234}00234         \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_aebb4709747e2855ddaa8b455d50d0174}{C1\_pt}}(c1\_pt),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00235}00235         \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a4844de8de168e51c24c5508ef195ae7a}{E\_pt}}(e\_pt),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00236}00236         \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a38d89cd3412cac1adb945713168a5c86}{Must\_delete\_e}}(false)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00237}00237     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00238}00238     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00240}00240 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00241}00241 \textcolor{comment}{    /// Virtual destructor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00242}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a855599e1cbdfbb9eb5aad3c5931e4f03}{00242}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a855599e1cbdfbb9eb5aad3c5931e4f03}{\string~GeneralisedMooneyRivlin}}()}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00243}00243     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00244}00244       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a38d89cd3412cac1adb945713168a5c86}{Must\_delete\_e}}) \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a4844de8de168e51c24c5508ef195ae7a}{E\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00245}00245     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00246}00246 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00247}00247 \textcolor{comment}{    /// Return the strain energy in terms of strain tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00248}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a91ff4fa7c19304c98f9a0017c22747a9}{00248}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a91ff4fa7c19304c98f9a0017c22747a9}{W}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& gamma)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00249}00249     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00250}00250       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a76cadaefaa89b93793c893f1302bd68a}{StrainEnergyFunction::W}}(gamma);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00251}00251     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00253}00253 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00254}00254 \textcolor{comment}{    /// Return the strain energy in terms of the strain invariants}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00255}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a2edff387e97632febd90938b27a30a14}{00255}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a2edff387e97632febd90938b27a30a14}{W}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}})}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00256}00256     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00257}00257       \textcolor{keywordtype}{double} G = (*E\_pt) / (2.0 * (1.0 + (*Nu\_pt)));}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00258}00258       \textcolor{keywordflow}{return} 0.5 * ((*C1\_pt) * (\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[0] -\/ 3.0) + (G -\/ (*\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_aebb4709747e2855ddaa8b455d50d0174}{C1\_pt}})) * (\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[1] -\/ 3.0) +}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00259}00259                     ((*C1\_pt) -\/ 2.0 * G) * (\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[2] -\/ 1.0) +}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00260}00260                     (1.0 -\/ (*Nu\_pt)) * G * (\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[2] -\/ 1.0) * (\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[2] -\/ 1.0) /}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00261}00261                       (2.0 * (1.0 -\/ 2.0 * (*\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_ae66d1130fccc98fc68d810f1f3e6b281}{Nu\_pt}}))));}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00262}00262     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00264}00264 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00265}00265 \textcolor{comment}{    /// Return the derivatives of the strain energy function with}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00266}00266 \textcolor{comment}{    /// respect to the strain invariants}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00267}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_aa0ca6d085deb4758119ff68222a27a8b}{00267}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_aa0ca6d085deb4758119ff68222a27a8b}{derivatives}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& \mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& dWdI)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00268}00268     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00269}00269       \textcolor{keywordtype}{double} G = (*E\_pt) / (2.0 * (1.0 + (*Nu\_pt)));}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00270}00270       dWdI[0] = 0.5 * (*C1\_pt);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00271}00271       dWdI[1] = 0.5 * (G -\/ (*C1\_pt));}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00272}00272       dWdI[2] = 0.5 * ((*C1\_pt) -\/ 2.0 * G +}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00273}00273                        2.0 * (1.0 -\/ (*Nu\_pt)) * G * (\mbox{\hyperlink{namespaceoomph_1_1MathematicalConstants_a609ab3b897b174e49ddf7a19fd95f2ef}{I}}[2] -\/ 1.0) /}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00274}00274                          (2.0 * (1.0 -\/ 2.0 * (*Nu\_pt))));}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00275}00275     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00276}00276 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00277}00277 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00278}00278 \textcolor{comment}{    /// Pure virtual function in which the user must declare if the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00279}00279 \textcolor{comment}{    /// constitutive equation requires an incompressible formulation}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00280}00280 \textcolor{comment}{    /// in which the volume constraint is enforced explicitly.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00281}00281 \textcolor{comment}{    /// Used as a sanity check in PARANOID mode. False.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00282}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a2b41a132a90707ee2901787d398f45f8}{00282}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a2b41a132a90707ee2901787d398f45f8}{requires\_incompressibility\_constraint}}()}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00283}00283     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00284}00284       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00285}00285     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00286}00286 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00287}00287   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00288}00288 \textcolor{comment}{    /// Poisson's ratio}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00289}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_ae66d1130fccc98fc68d810f1f3e6b281}{00289}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_ae66d1130fccc98fc68d810f1f3e6b281}{Nu\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00290}00290 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00291}00291 \textcolor{comment}{    /// Mooney-\/Rivlin parameter}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00292}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_aebb4709747e2855ddaa8b455d50d0174}{00292}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_aebb4709747e2855ddaa8b455d50d0174}{C1\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00293}00293 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00294}00294 \textcolor{comment}{    /// Young's modulus}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00295}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a4844de8de168e51c24c5508ef195ae7a}{00295}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a4844de8de168e51c24c5508ef195ae7a}{E\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00296}00296 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00297}00297 \textcolor{comment}{    /// Boolean flag to indicate if storage for elastic modulus}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00298}00298 \textcolor{comment}{    /// must be deleted in destructor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00299}\mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a38d89cd3412cac1adb945713168a5c86}{00299}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1GeneralisedMooneyRivlin_a38d89cd3412cac1adb945713168a5c86}{Must\_delete\_e}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00300}00300   \};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00301}00301 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00302}00302 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00303}00303 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00304}00304 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00305}00305 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00306}00306 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00307}00307 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00308}00308   \textcolor{comment}{//===========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00309}00309 \textcolor{comment}{  /// A class for constitutive laws for elements that solve}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00310}00310 \textcolor{comment}{  /// the equations of solid mechanics based upon the principle of virtual}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00311}00311 \textcolor{comment}{  /// displacements. In that formulation, the information required from a}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00312}00312 \textcolor{comment}{  /// constitutive law is the (2nd Piola-\/Kirchhoff) stress tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00313}00313 \textcolor{comment}{  /// \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} \(\backslash\)f\$ as a function of the (Green) strain}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00314}00314 \textcolor{comment}{  /// \(\backslash\)f\$ \(\backslash\)gamma\string^\{ij\} \(\backslash\)f\$:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00315}00315 \textcolor{comment}{  /// \(\backslash\)f[ \(\backslash\)sigma\string^\{ij\} = \(\backslash\)sigma\string^\{ij\}(\(\backslash\)gamma\_\{ij\}). \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00316}00316 \textcolor{comment}{  /// The Green strain is defined as}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00317}00317 \textcolor{comment}{  /// \(\backslash\)f[ \(\backslash\)gamma\_\{ij\} = \(\backslash\)frac\{1\}\{2\} (G\_\{ij\} -\/ g\_\{ij\}), \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) (1) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00318}00318 \textcolor{comment}{  /// where \(\backslash\)f\$G\_\{ij\} \(\backslash\)f\$ and \(\backslash\)f\$ g\_\{ij\}\(\backslash\)f\$ are the metric tensors}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00319}00319 \textcolor{comment}{  /// in the deformed and undeformed (stress-\/free) configurations, respectively.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00320}00320 \textcolor{comment}{  /// A specific ConstitutiveLaw needs to be implement the pure}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00321}00321 \textcolor{comment}{  /// virtual function}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00322}00322 \textcolor{comment}{  /// \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00323}00323 \textcolor{comment}{  /// ConstitutiveLaw::calculate\_second\_piola\_kirchhoff\_stress(...)}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00324}00324 \textcolor{comment}{  /// \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00325}00325 \textcolor{comment}{  /// Equation (1) shows that the strain may be calculated from the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00326}00326 \textcolor{comment}{  /// undeformed and deformed metric tensors.  Frequently, these tensors are}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00327}00327 \textcolor{comment}{  /// also required in the constitutive law itself.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00328}00328 \textcolor{comment}{  /// To avoid unnecessary re-\/computation of these quantities, we}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00329}00329 \textcolor{comment}{  /// pass the deformed and undeformed metric tensor to}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00330}00330 \textcolor{comment}{  /// \(\backslash\)c calculate\_second\_piola\_kirchhoff\_stress(...)}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00331}00331 \textcolor{comment}{  /// rather than the strain tensor itself.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00332}00332 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00333}00333 \textcolor{comment}{  /// The functional form of the constitutive equation is different}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00334}00334 \textcolor{comment}{  /// for compressible/incompressible/near-\/incompressible behaviour}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00335}00335 \textcolor{comment}{  /// and we provide interfaces that are appropriate for all of these cases.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00336}00336 \textcolor{comment}{  /// -\/\# \(\backslash\)b Compressible \(\backslash\)b Behaviour: \(\backslash\)n If the material is compressible,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00337}00337 \textcolor{comment}{  ///    the stress can be computed from the deformed and undeformed}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00338}00338 \textcolor{comment}{  ///    metric tensors,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00339}00339 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00340}00340 \textcolor{comment}{  /// \(\backslash\)f[ \(\backslash\)sigma\string^\{ij\} = \(\backslash\)sigma\string^\{ij\}(\(\backslash\)gamma\_\{ij\}) = \(\backslash\)sigma\string^\{ij\}\(\backslash\)bigg( \(\backslash\)frac\{1\}\{2\} (G\_\{ij\} -\/ g\_\{ij\})\(\backslash\)bigg), \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00341}00341 \textcolor{comment}{  ///   using the interface}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00342}00342 \textcolor{comment}{  ///   \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00343}00343 \textcolor{comment}{  ///   // 2nd Piola Kirchhoff stress tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00344}00344 \textcolor{comment}{  ///   DenseMatrix<double> sigma(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00345}00345 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00346}00346 \textcolor{comment}{  ///   // Metric tensor in the undeformed (stress-\/free) configuration}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00347}00347 \textcolor{comment}{  ///   DenseMatrix<double> g(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00348}00348 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00349}00349 \textcolor{comment}{  ///   // Metric tensor in the deformed  configuration}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00350}00350 \textcolor{comment}{  ///   DenseMatrix<double> G(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00351}00351 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00352}00352 \textcolor{comment}{  ///   // Compute stress from the two metric tensors:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00353}00353 \textcolor{comment}{  ///   calculate\_second\_piola\_kirchhoff\_stress(g,G,sigma);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00354}00354 \textcolor{comment}{  ///   \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00355}00355 \textcolor{comment}{  ///   \(\backslash\)n \(\backslash\)n  \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00356}00356 \textcolor{comment}{  /// -\/\# \(\backslash\)b Incompressible \(\backslash\)b Behaviour: \(\backslash\)n If the material is incompressible,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00357}00357 \textcolor{comment}{  ///    its deformation is constrained by the condition that}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00358}00358 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00359}00359 \textcolor{comment}{  /// \(\backslash\)f[ \(\backslash\)det G\_\{ij\} -\/ \(\backslash\)det g\_\{ij\}= 0 \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) (2) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00360}00360 \textcolor{comment}{  ///    which ensures that the volume of infinitesimal material}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00361}00361 \textcolor{comment}{  ///    elements remains constant during the deformation. This}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00362}00362 \textcolor{comment}{  ///    condition is typically enforced by a Lagrange multiplier which}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00363}00363 \textcolor{comment}{  ///    plays the role of a pressure. In such cases, the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00364}00364 \textcolor{comment}{  ///    stress tensor has form}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00365}00365 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00366}00366 \textcolor{comment}{  /// \(\backslash\)f[ \(\backslash\)sigma\string^\{ij\} = -\/p G\string^\{ij\} + \(\backslash\)overline\{\(\backslash\)sigma\}\string^\{ij\}\(\backslash\)big(\(\backslash\)gamma\_\{kl\}\(\backslash\)big), \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) (3) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00367}00367 \textcolor{comment}{  ///    where only the deviatoric part of the stress tensor,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00368}00368 \textcolor{comment}{  ///    \(\backslash\)f\$ \(\backslash\)overline\{\(\backslash\)sigma\}\string^\{ij\}, \(\backslash\)f\$ depends directly on the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00369}00369 \textcolor{comment}{  ///    strain. The pressure \(\backslash\)f\$ p \(\backslash\)f\$ needs to be determined}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00370}00370 \textcolor{comment}{  ///    independently from (2).}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00371}00371 \textcolor{comment}{  ///    Given the deformed and undeformed metric tensors,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00372}00372 \textcolor{comment}{  ///    the computation of the stress tensor \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00373}00373 \textcolor{comment}{  ///    for an incompressible}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00374}00374 \textcolor{comment}{  ///    material therefore requires the computation of the following}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00375}00375 \textcolor{comment}{  ///    quantities:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00376}00376 \textcolor{comment}{  ///    -\/ The deviatoric stress \(\backslash\)f\$ \(\backslash\)overline\{\(\backslash\)sigma\}\string^\{ij\} \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00377}00377 \textcolor{comment}{  ///    -\/ The contravariant deformed metric tensor  \(\backslash\)f\$ G\string^\{ij\} \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00378}00378 \textcolor{comment}{  ///    -\/ The determinant of the deformed}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00379}00379 \textcolor{comment}{  ///      metric tensors, \(\backslash\)f\$ \(\backslash\)det G\_\{ij\}, \(\backslash\)f\$ which}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00380}00380 \textcolor{comment}{  ///      is required in equation (2) whose solution determines the pressure.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00381}00381 \textcolor{comment}{  ///    .}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00382}00382 \textcolor{comment}{  ///   \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00383}00383 \textcolor{comment}{  ///   These quantities can be obtained from the following interface \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00384}00384 \textcolor{comment}{  ///   \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00385}00385 \textcolor{comment}{  ///   // Deviatoric part of the 2nd Piola Kirchhoff stress tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00386}00386 \textcolor{comment}{  ///   DenseMatrix<double> sigma\_dev(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00387}00387 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00388}00388 \textcolor{comment}{  ///   // Metric tensor in the undeformed (stress-\/free) configuration}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00389}00389 \textcolor{comment}{  ///   DenseMatrix<double> g(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00390}00390 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00391}00391 \textcolor{comment}{  ///   // Metric tensor in the deformed  configuration}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00392}00392 \textcolor{comment}{  ///   DenseMatrix<double> G(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00393}00393 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00394}00394 \textcolor{comment}{  ///   // Determinant of the deformed metric tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00395}00395 \textcolor{comment}{  ///   double Gdet;}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00396}00396 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00397}00397 \textcolor{comment}{  ///   // Contravariant deformed metric tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00398}00398 \textcolor{comment}{  ///   DenseMatrix<double> G\_contra(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00399}00399 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00400}00400 \textcolor{comment}{  ///   // Compute stress from the two metric tensors:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00401}00401 \textcolor{comment}{  ///   calculate\_second\_piola\_kirchhoff\_stress(g,G,sigma\_dev,G\_contra,Gdet);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00402}00402 \textcolor{comment}{  ///   \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00403}00403 \textcolor{comment}{  ///   \(\backslash\)n \(\backslash\)n \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00404}00404 \textcolor{comment}{  /// -\/\# \(\backslash\)b Nearly \(\backslash\)b Incompressible \(\backslash\)b Behaviour: \(\backslash\)n If the material is nearly}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00405}00405 \textcolor{comment}{  ///    incompressible, it is advantageous to split the stress into}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00406}00406 \textcolor{comment}{  ///    its deviatoric and hydrostatic parts by writing the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00407}00407 \textcolor{comment}{  ///    constitutive law in the form}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00408}00408 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00409}00409 \textcolor{comment}{  ///    \(\backslash\)f[ \(\backslash\)sigma\string^\{ij\} = -\/p G\string^\{ij\} + \(\backslash\)overline\{\(\backslash\)sigma\}\string^\{ij\}\(\backslash\)big(\(\backslash\)gamma\_\{kl\}\(\backslash\)big), \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) (3) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00410}00410 \textcolor{comment}{  ///    where the deviatoric part of the stress tensor,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00411}00411 \textcolor{comment}{  ///    \(\backslash\)f\$ \(\backslash\)overline\{\(\backslash\)sigma\}\string^\{ij\}, \(\backslash\)f\$ depends on the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00412}00412 \textcolor{comment}{  ///    strain. This form of the constitutive}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00413}00413 \textcolor{comment}{  ///    law is identical to that of the incompressible}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00414}00414 \textcolor{comment}{  ///    case and it involves a pressure \(\backslash\)f\$ p \(\backslash\)f\$ which needs to be}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00415}00415 \textcolor{comment}{  ///    determined from an additional equation. In the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00416}00416 \textcolor{comment}{  ///    incompressible case, this equation was given by the incompressibility}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00417}00417 \textcolor{comment}{  ///    constraint (2). Here, we need to augment the constitutive law (3) by}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00418}00418 \textcolor{comment}{  ///    a separate equation for the pressure. Generally this takes the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00419}00419 \textcolor{comment}{  ///    form}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00420}00420 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00421}00421 \textcolor{comment}{  ///    \(\backslash\)f[ p = -\/ \(\backslash\)kappa \(\backslash\) d \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) (4) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00422}00422 \textcolor{comment}{  ///    where \(\backslash\)f\$ \(\backslash\)kappa \(\backslash\)f\$ is the "{}bulk modulus"{}, a material property}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00423}00423 \textcolor{comment}{  ///    that needs to be specified by the constitutive law.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00424}00424 \textcolor{comment}{  ///    \(\backslash\)f\$ d \(\backslash\)f\$ is the (generalised) dilatation, i.e. the relative change}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00425}00425 \textcolor{comment}{  ///    in the volume of an infinitesimal material element (or some}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00426}00426 \textcolor{comment}{  ///    suitable generalised quantitiy that is related to it). As the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00427}00427 \textcolor{comment}{  ///    material approaches incompressibility, \(\backslash\)f\$ \(\backslash\)kappa \(\backslash\)to \(\backslash\)infty\(\backslash\)f\$, so}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00428}00428 \textcolor{comment}{  ///    that infinitely large pressures would be required to achieve any change}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00429}00429 \textcolor{comment}{  ///    in volume. To facilitate the implementation of (4) as the equation for}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00430}00430 \textcolor{comment}{  ///    the pressure, we re-\/write it in the form}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00431}00431 \textcolor{comment}{  ///    \(\backslash\)f[ p \(\backslash\) \(\backslash\)frac\{1\}\{\(\backslash\)kappa\} + d\(\backslash\)big(g\_\{ij\},G\_\{ij\}\(\backslash\)big) = 0 \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) (5) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00432}00432 \textcolor{comment}{  ///    which only involves quantities that remain finite}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00433}00433 \textcolor{comment}{  ///    as we approach true incompressibility.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00434}00434 \textcolor{comment}{  ///    \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00435}00435 \textcolor{comment}{  ///    Given the deformed and undeformed metric tensors,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00436}00436 \textcolor{comment}{  ///    the computation of the stress tensor \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00437}00437 \textcolor{comment}{  ///    for a nearly incompressible}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00438}00438 \textcolor{comment}{  ///    material therefore requires the computation of the following}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00439}00439 \textcolor{comment}{  ///    quantities:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00440}00440 \textcolor{comment}{  ///    -\/ The deviatoric stress \(\backslash\)f\$ \(\backslash\)overline\{\(\backslash\)sigma\}\string^\{ij\} \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00441}00441 \textcolor{comment}{  ///    -\/ The contravariant deformed metric tensor  \(\backslash\)f\$ G\string^\{ij\} \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00442}00442 \textcolor{comment}{  ///    -\/ The generalised dilatation \(\backslash\)f\$ d \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00443}00443 \textcolor{comment}{  ///    -\/ The inverse of the bulk modulus \(\backslash\)f\$ \(\backslash\)kappa \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00444}00444 \textcolor{comment}{  ///    .}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00445}00445 \textcolor{comment}{  ///   \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00446}00446 \textcolor{comment}{  ///   These quantities can be obtained from the following interface \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00447}00447 \textcolor{comment}{  ///   \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00448}00448 \textcolor{comment}{  ///   // Deviatoric part of the 2nd Piola Kirchhoff stress tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00449}00449 \textcolor{comment}{  ///   DenseMatrix<double> sigma\_dev(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00450}00450 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00451}00451 \textcolor{comment}{  ///   // Metric tensor in the undeformed (stress-\/free) configuration}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00452}00452 \textcolor{comment}{  ///   DenseMatrix<double> g(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00453}00453 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00454}00454 \textcolor{comment}{  ///   // Metric tensor in the deformed  configuration}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00455}00455 \textcolor{comment}{  ///   DenseMatrix<double> G(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00456}00456 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00457}00457 \textcolor{comment}{  ///   // Contravariant deformed metric tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00458}00458 \textcolor{comment}{  ///   DenseMatrix<double> G\_contra(DIM,DIM);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00459}00459 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00460}00460 \textcolor{comment}{  ///   // Inverse of the bulk modulus}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00461}00461 \textcolor{comment}{  ///   double inv\_kappa;}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00462}00462 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00463}00463 \textcolor{comment}{  ///   // Generalised dilatation}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00464}00464 \textcolor{comment}{  ///   double gen\_dil;}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00465}00465 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00466}00466 \textcolor{comment}{  ///   // Compute stress from the two metric tensors:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00467}00467 \textcolor{comment}{  ///   calculate\_second\_piola\_kirchhoff\_stress(g,G,sigma\_dev,G\_contra,inv\_kappa,gen\_dil);}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00468}00468 \textcolor{comment}{  ///   \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00469}00469 \textcolor{comment}{}  \textcolor{comment}{//==========================================================================}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00470}\mbox{\hyperlink{classoomph_1_1ConstitutiveLaw}{00470}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1ConstitutiveLaw}{ConstitutiveLaw}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00471}00471   \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00472}00472   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00473}00473 \textcolor{comment}{    /// Test whether a matrix is square}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00474}00474 \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a73f01e1459e7ba998ef78f7ece6baa37}{is\_matrix\_square}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& M);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00475}00475 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00476}00476 \textcolor{comment}{    /// Test whether two matrices are of equal dimensions}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00477}00477 \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a8a89bb96a9b922294509923563a13063}{are\_matrices\_of\_equal\_dimensions}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& M1,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00478}00478                                           \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& M2);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00479}00479 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00480}00480 \textcolor{comment}{    /// Check for errors in the input,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00481}00481 \textcolor{comment}{    /// i.e. check that the dimensions of the arrays are all consistent}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00482}00482 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a01763658a56a962460a80607653a33b4}{error\_checking\_in\_input}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00483}00483                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00484}00484                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00485}00485 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00486}00486 \textcolor{comment}{    /// Calculate a contravariant tensor from a covariant tensor,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00487}00487 \textcolor{comment}{    /// and return the determinant of the covariant tensor.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00488}00488 \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a5c188df10b08b340b923c3a733c0d178}{calculate\_contravariant}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& Gcov,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00489}00489                                    \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& Gcontra);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00490}00490 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00491}00491 \textcolor{comment}{    /// Calculate the derivatives of the contravariant tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00492}00492 \textcolor{comment}{    /// and the derivatives of the determinant of the covariant tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00493}00493 \textcolor{comment}{    /// with respect to the components of the covariant tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00494}00494 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a6dda64e60ed8128cb4603041dc66036f}{calculate\_d\_contravariant\_dG}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& Gcov,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00495}00495                                       \mbox{\hyperlink{classoomph_1_1RankFourTensor}{RankFourTensor<double>}}\& dGcontra\_dG,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00496}00496                                       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& d\_detG\_dG);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00497}00497 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00499}00499   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00500}00500 \textcolor{comment}{    /// Empty constructor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00501}\mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a864c36413e8ea31e63552f3db3b97a2f}{00501}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a864c36413e8ea31e63552f3db3b97a2f}{ConstitutiveLaw}}() \{\}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00502}00502 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00503}00503 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00504}00504 \textcolor{comment}{    /// Empty virtual destructor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00505}\mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_aa75b88c826723ba090ace39c26da0ae6}{00505}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_aa75b88c826723ba090ace39c26da0ae6}{\string~ConstitutiveLaw}}() \{\}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00506}00506 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00507}00507 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00508}00508 \textcolor{comment}{    /// Calculate the contravariant 2nd Piola Kirchhoff}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00509}00509 \textcolor{comment}{    /// stress tensor. Arguments are the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00510}00510 \textcolor{comment}{    /// covariant undeformed and deformed metric tensor and the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00511}00511 \textcolor{comment}{    /// matrix in which to return the stress tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00512}\mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}{00512}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a93527d910de908035feb8f41b0401065}{calculate\_second\_piola\_kirchhoff\_stress}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00513}00513       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00514}00514       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00515}00515       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma) = 0;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00516}00516 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00517}00517 \textcolor{comment}{    /// Calculate the derivatives of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00518}00518 \textcolor{comment}{    /// 2nd Piola Kirchhoff stress tensor with respect to the deformed metric}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00519}00519 \textcolor{comment}{    /// tensor. Arguments are the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00520}00520 \textcolor{comment}{    /// covariant undeformed and deformed metric tensor, the current value of}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00521}00521 \textcolor{comment}{    /// the stress tensor and the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00522}00522 \textcolor{comment}{    /// rank four tensor in which to return the derivatives of the stress tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00523}00523 \textcolor{comment}{    /// The default implementation uses finite differences, but can be}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00524}00524 \textcolor{comment}{    /// overloaded for constitutive laws in which an analytic formulation}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00525}00525 \textcolor{comment}{    /// is possible.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00526}00526 \textcolor{comment}{    /// If the boolean flag symmetrize\_tensor is false, only the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00527}00527 \textcolor{comment}{    /// "{}upper  triangular"{} entries of the tensor will be filled in. This is}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00528}00528 \textcolor{comment}{    /// a useful efficiency when using the derivatives in Jacobian calculations.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00529}00529 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a6076752384082cfa3de3e0cf17daa9aa}{calculate\_d\_second\_piola\_kirchhoff\_stress\_dG}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00530}00530       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00531}00531       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00532}00532       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00533}00533       \mbox{\hyperlink{classoomph_1_1RankFourTensor}{RankFourTensor<double>}}\& d\_sigma\_dG,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00534}00534       \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& symmetrize\_tensor = \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00535}00535 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00536}00536 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00537}00537 \textcolor{comment}{    /// Calculate the deviatoric part}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00538}00538 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}\(\backslash\)f\$  of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00539}00539 \textcolor{comment}{    /// 2nd Piola Kirchhoff stress tensor \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\}\(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00540}00540 \textcolor{comment}{    /// Also return the contravariant deformed metric}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00541}00541 \textcolor{comment}{    /// tensor and the determinant of the deformed metric tensor.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00542}00542 \textcolor{comment}{    /// This form is appropriate}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00543}00543 \textcolor{comment}{    /// for truly-\/incompressible materials for which}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00544}00544 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} = -\/ p G\string^\{ij\} +\(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}  \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00545}00545 \textcolor{comment}{    /// where the "{}pressure"{} \(\backslash\)f\$ p \(\backslash\)f\$ is determined by}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00546}00546 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)det G\_\{ij\} -\/ \(\backslash\)det g\_\{ij\} = 0 \(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00547}\mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_ac8178b1b7cd7e6a64942dba9e0997b30}{00547}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_ac8178b1b7cd7e6a64942dba9e0997b30}{calculate\_second\_piola\_kirchhoff\_stress}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00548}00548       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00549}00549       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00550}00550       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma\_dev,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00551}00551       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G\_contra,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00552}00552       \textcolor{keywordtype}{double}\& Gdet)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00553}00553     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00554}00554       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00555}00555         \textcolor{stringliteral}{"{}Incompressible formulation not implemented for this constitutive law"{}},}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00556}00556         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00557}00557         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00558}00558     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00559}00559 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00560}00560 \textcolor{comment}{    /// Calculate the derivatives of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00561}00561 \textcolor{comment}{    /// 2nd Piola Kirchhoff stress tensor \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\}\(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00562}00562 \textcolor{comment}{    /// with respect to the deformed metric tensor.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00563}00563 \textcolor{comment}{    /// Also return the derivatives of the determinant of the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00564}00564 \textcolor{comment}{    /// deformed metric tensor with respect to the deformed metric tensor.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00565}00565 \textcolor{comment}{    /// This form is appropriate}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00566}00566 \textcolor{comment}{    /// for truly-\/incompressible materials.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00567}00567 \textcolor{comment}{    /// The default implementation uses finite differences for the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00568}00568 \textcolor{comment}{    /// derivatives that depend on the constitutive law, but not}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00569}00569 \textcolor{comment}{    /// for the derivatives of the determinant, which are generic.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00570}00570 \textcolor{comment}{    /// / If the boolean flag symmetrize\_tensor is false, only the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00571}00571 \textcolor{comment}{    /// "{}upper  triangular"{} entries of the tensor will be filled in. This is}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00572}00572 \textcolor{comment}{    /// a useful efficiency when using the derivatives in Jacobian calculations.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00573}00573 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a6076752384082cfa3de3e0cf17daa9aa}{calculate\_d\_second\_piola\_kirchhoff\_stress\_dG}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00574}00574       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00575}00575       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00576}00576       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00577}00577       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& detG,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00578}00578       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& interpolated\_solid\_p,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00579}00579       \mbox{\hyperlink{classoomph_1_1RankFourTensor}{RankFourTensor<double>}}\& d\_sigma\_dG,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00580}00580       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& d\_detG\_dG,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00581}00581       \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& symmetrize\_tensor = \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00582}00582 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00583}00583 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00584}00584 \textcolor{comment}{    /// Calculate the deviatoric part of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00585}00585 \textcolor{comment}{    /// 2nd Piola Kirchoff stress tensor. Also return the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00586}00586 \textcolor{comment}{    /// deformed metric tensor, the generalised dilatation, \(\backslash\)f\$ d, \(\backslash\)f\$ and}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00587}00587 \textcolor{comment}{    /// the inverse of the bulk modulus \(\backslash\)f\$ \(\backslash\)kappa\(\backslash\)f\$. This form is appropriate}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00588}00588 \textcolor{comment}{    /// for near-\/incompressible materials for which}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00589}00589 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} = -\/p G\string^\{ij\} + \(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}  \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00590}00590 \textcolor{comment}{    /// where the "{}pressure"{} \(\backslash\)f\$ p \(\backslash\)f\$ is determined from}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00591}00591 \textcolor{comment}{    /// \(\backslash\)f\$ p / \(\backslash\)kappa -\/ d =0 \(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00592}\mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a26f34355b626bebcad8f498fa5271d20}{00592}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a26f34355b626bebcad8f498fa5271d20}{calculate\_second\_piola\_kirchhoff\_stress}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00593}00593       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00594}00594       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00595}00595       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma\_dev,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00596}00596       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& Gcontra,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00597}00597       \textcolor{keywordtype}{double}\& gen\_dil,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00598}00598       \textcolor{keywordtype}{double}\& inv\_kappa)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00599}00599     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00600}00600       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00601}00601         \textcolor{stringliteral}{"{}Near-\/incompressible formulation not implemented for constitutive law"{}},}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00602}00602         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00603}00603         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00604}00604     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00605}00605 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00606}00606 \textcolor{comment}{    /// Calculate the derivatives of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00607}00607 \textcolor{comment}{    /// 2nd Piola Kirchoff stress tensor with respect to the deformed metric}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00608}00608 \textcolor{comment}{    /// tensor. Also return the derivatives of the generalised dilatation,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00609}00609 \textcolor{comment}{    /// \(\backslash\)f\$ d, \(\backslash\)f\$ with respect to the deformed metric tensor.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00610}00610 \textcolor{comment}{    /// This form is appropriate}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00611}00611 \textcolor{comment}{    /// for near-\/incompressible materials.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00612}00612 \textcolor{comment}{    /// The default implementation uses finite differences.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00613}00613 \textcolor{comment}{    /// If the boolean flag symmetrize\_tensor is false, only the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00614}00614 \textcolor{comment}{    /// "{}upper  triangular"{} entries of the tensor will be filled in. This is}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00615}00615 \textcolor{comment}{    /// a useful efficiency when using the derivatives in Jacobian calculations.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00616}00616 \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a6076752384082cfa3de3e0cf17daa9aa}{calculate\_d\_second\_piola\_kirchhoff\_stress\_dG}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00617}00617       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00618}00618       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00619}00619       \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00620}00620       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& gen\_dil,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00621}00621       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& inv\_kappa,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00622}00622       \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& interpolated\_solid\_p,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00623}00623       \mbox{\hyperlink{classoomph_1_1RankFourTensor}{RankFourTensor<double>}}\& d\_sigma\_dG,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00624}00624       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& d\_gen\_dil\_dG,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00625}00625       \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& symmetrize\_tensor = \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00626}00626 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00627}00627 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00628}00628 \textcolor{comment}{    /// Pure virtual function in which the user must declare if the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00629}00629 \textcolor{comment}{    /// constitutive equation requires an incompressible formulation}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00630}00630 \textcolor{comment}{    /// in which the volume constraint is enforced explicitly.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00631}00631 \textcolor{comment}{    /// Used as a sanity check in PARANOID mode.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00632}\mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a446452158a8ae9fbc3dde4277155f824}{00632}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw_a446452158a8ae9fbc3dde4277155f824}{requires\_incompressibility\_constraint}}() = 0;}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00633}00633   \};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00634}00634 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00635}00635 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00636}00636 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00637}00637 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00638}00638 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00639}00639 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00640}00640 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00641}00641   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00642}00642 \textcolor{comment}{  /// Class for a "{}non-\/rational"{} extension of classical linear elasticity}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00643}00643 \textcolor{comment}{  /// to large displacements:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00644}00644 \textcolor{comment}{  /// \(\backslash\)f[ \(\backslash\)sigma\string^\{ij\} = E\string^\{ijkl\} \(\backslash\)gamma\_\{kl\} \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00645}00645 \textcolor{comment}{  /// where}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00646}00646 \textcolor{comment}{  /// \(\backslash\)f[ E\string^\{ijkl\} = \(\backslash\)frac\{E\}\{(1+\(\backslash\)nu)\} \(\backslash\)left( \(\backslash\)frac\{\(\backslash\)nu\}\{(1-\/2\(\backslash\)nu)\} G\string^\{ij\} G\string^\{kl\} + \(\backslash\)frac\{1\}\{2\} \(\backslash\)left( G\string^\{ik\} G\string^\{jl\} + G\string^\{il\} G\string^\{jk\} \(\backslash\)right) \(\backslash\)right) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00647}00647 \textcolor{comment}{  /// For small strains \(\backslash\)f\$ (| G\_\{ij\} -\/ g\_\{ij\} | \(\backslash\)ll 1)\(\backslash\)f\$ this approaches}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00648}00648 \textcolor{comment}{  /// the version appropriate for linear elasticity, obtained}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00649}00649 \textcolor{comment}{  /// by replacing \(\backslash\)f\$ G\string^\{ij\}\(\backslash\)f\$ with \(\backslash\)f\$ g\string^\{ij\}\(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00650}00650 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00651}00651 \textcolor{comment}{  /// We provide three versions of \(\backslash\)c calculate\_second\_piola\_kirchhoff\_stress():}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00652}00652 \textcolor{comment}{  /// -\/\# If \(\backslash\)f\$ \(\backslash\)nu \(\backslash\)ne 1/2 \(\backslash\)f\$ (and not close to \(\backslash\)f\$ 1/2 \(\backslash\)f\$), the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00653}00653 \textcolor{comment}{  ///    constitutive law can be used directly in the above form, using}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00654}00654 \textcolor{comment}{  ///    the deformed and undeformed metric tensors as input.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00655}00655 \textcolor{comment}{  /// -\/\# If the material is incompressible (\(\backslash\)f\$ \(\backslash\)nu = 1/2 \(\backslash\)f\$),}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00656}00656 \textcolor{comment}{  ///    the first term in the above expression for  \(\backslash\)f\$ E\string^\{ijkl\} \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00657}00657 \textcolor{comment}{  ///    is singular. We re-\/write the constitutive equation for this}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00658}00658 \textcolor{comment}{  ///    case as}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00659}00659 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00660}00660 \textcolor{comment}{  ///    \(\backslash\)f[ \(\backslash\)sigma\string^\{ij\} = -\/p G\string^\{ij\} + \(\backslash\)frac\{E\}\{3\} \(\backslash\)left( G\string^\{ik\} G\string^\{jl\} + G\string^\{il\} G\string^\{jk\} \(\backslash\)right) \(\backslash\)gamma\_\{kl\} \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00661}00661 \textcolor{comment}{  ///    where the pressure \(\backslash\)f\$ p \(\backslash\)f\$ needs to be determined independently}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00662}00662 \textcolor{comment}{  ///    via the incompressibility constraint.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00663}00663 \textcolor{comment}{  ///    In this case, the stress returned by}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00664}00664 \textcolor{comment}{  ///    \(\backslash\)c calculate\_second\_piola\_kirchhoff\_stress()}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00665}00665 \textcolor{comment}{  ///    contains only the deviatoric part of the 2nd Piola Kirchhoff stress,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00666}00666 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00667}00667 \textcolor{comment}{  ///    \(\backslash\)f[ \(\backslash\)overline\{\(\backslash\)sigma\}\string^\{ij\} = \(\backslash\)frac\{E\}\{3\} \(\backslash\)left( G\string^\{ik\} G\string^\{jl\} + G\string^\{il\} G\string^\{jk\} \(\backslash\)right) \(\backslash\)gamma\_\{kl\}. \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00668}00668 \textcolor{comment}{  ///    The function also returns the contravariant metric tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00669}00669 \textcolor{comment}{  ///    \(\backslash\)f\$ G\string^\{ij\}\(\backslash\)f\$ (since it is needed to form the complete stress}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00670}00670 \textcolor{comment}{  ///    tensor), and the determinant of the deformed covariant metric}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00671}00671 \textcolor{comment}{  ///    tensor \(\backslash\)f\$ \{\(\backslash\)tt detG\} = \(\backslash\)det G\_\{ij\} \(\backslash\)f\$ (since it is needed}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00672}00672 \textcolor{comment}{  ///    in the equation that enforces the incompressibility).}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00673}00673 \textcolor{comment}{  /// -\/\# If \(\backslash\)f\$ \(\backslash\)nu \(\backslash\)approx 1/2 \(\backslash\)f\$, the original form of the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00674}00674 \textcolor{comment}{  ///    constitutive equation could be used, but the resulting}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00675}00675 \textcolor{comment}{  ///    equations tend to be ill-\/conditioned since they contain}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00676}00676 \textcolor{comment}{  ///    the product of the large "{}bulk modulus"{}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00677}00677 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00678}00678 \textcolor{comment}{  ///    \(\backslash\)f[ \(\backslash\)kappa = \(\backslash\)frac\{E\(\backslash\)nu\}\{(1+\(\backslash\)nu)(1-\/2\(\backslash\)nu)\} \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00679}00679 \textcolor{comment}{  ///    and the small "{}generalised dilatation"{}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00680}00680 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00681}00681 \textcolor{comment}{  ///    \(\backslash\)f[ d = \(\backslash\)frac\{1\}\{2\} G\string^\{ij\} (G\_\{ij\}-\/g\_\{ij\}). \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00682}00682 \textcolor{comment}{  ///    [\(\backslash\)f\$ d \(\backslash\)f\$ represents the actual dilatation in the small}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00683}00683 \textcolor{comment}{  ///    strain limit; for large deformations it doesn't have}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00684}00684 \textcolor{comment}{  ///    any sensible interpretation (or does it?). It is simply}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00685}00685 \textcolor{comment}{  ///    the term that needs to go to zero as \(\backslash\)f\$ \(\backslash\)kappa \(\backslash\)to \(\backslash\)infty\(\backslash\)f\$.]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00686}00686 \textcolor{comment}{  ///    In this case, the stress returned by}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00687}00687 \textcolor{comment}{  ///    \(\backslash\)c calculate\_second\_piola\_kirchhoff\_stress()}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00688}00688 \textcolor{comment}{  ///    contains only the deviatoric part of the 2nd Piola Kirchhoff stress,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00689}00689 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00690}00690 \textcolor{comment}{  ///    \(\backslash\)f[ \(\backslash\)overline\{\(\backslash\)sigma\}\string^\{ij\} = \(\backslash\)frac\{E\}\{3\} \(\backslash\)left( G\string^\{ik\} G\string^\{jl\} + G\string^\{il\} G\string^\{jk\} \(\backslash\)right) \(\backslash\)gamma\_\{kl\}. \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00691}00691 \textcolor{comment}{  ///    The function also returns the contravariant metric tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00692}00692 \textcolor{comment}{  ///    \(\backslash\)f\$ G\string^\{ij\}\(\backslash\)f\$ (since it is needed to form the complete stress}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00693}00693 \textcolor{comment}{  ///    tensor), the inverse of the bulk modulus, and the generalised}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00694}00694 \textcolor{comment}{  ///    dilatation (since they are needed in the equation}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00695}00695 \textcolor{comment}{  ///    that determines the pressure).}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00696}00696 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00697}00697 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00698}\mbox{\hyperlink{classoomph_1_1GeneralisedHookean}{00698}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1GeneralisedHookean}{GeneralisedHookean}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw}{ConstitutiveLaw}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00699}00699   \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00700}00700   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00701}00701 \textcolor{comment}{    /// The constructor takes the pointers to values of material parameters:}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00702}00702 \textcolor{comment}{    /// Poisson's ratio and Young's modulus.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00703}\mbox{\hyperlink{classoomph_1_1GeneralisedHookean_ae345f3619a2826b4547f7cb42a052ca6}{00703}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_ae345f3619a2826b4547f7cb42a052ca6}{GeneralisedHookean}}(\textcolor{keywordtype}{double}* nu\_pt, \textcolor{keywordtype}{double}* e\_pt)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00704}00704       : \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw}{ConstitutiveLaw}}(), \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_ad719ee5ed6d1bcacb18fec3339ae98de}{Nu\_pt}}(nu\_pt), \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a7a68b35f227848a065a7a844766b4eeb}{E\_pt}}(e\_pt), \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a21d4ef7498c2efd5bf30fa0ecd0d7dd5}{Must\_delete\_e}}(false)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00705}00705     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00706}00706     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00707}00707 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00708}00708 \textcolor{comment}{    /// The constructor takes the pointers to value of}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00709}00709 \textcolor{comment}{    /// Poisson's ratio . Young's modulus is set to E=1.0,}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00710}00710 \textcolor{comment}{    /// implying that all stresses have been non-\/dimensionalised}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00711}00711 \textcolor{comment}{    /// on on it.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00712}\mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a470dde76fd6603da69bf4b6f12c50917}{00712}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a470dde76fd6603da69bf4b6f12c50917}{GeneralisedHookean}}(\textcolor{keywordtype}{double}* nu\_pt)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00713}00713       : \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw}{ConstitutiveLaw}}(),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00714}00714         \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_ad719ee5ed6d1bcacb18fec3339ae98de}{Nu\_pt}}(nu\_pt),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00715}00715         \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a7a68b35f227848a065a7a844766b4eeb}{E\_pt}}(new double(1.0)),}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00716}00716         \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a21d4ef7498c2efd5bf30fa0ecd0d7dd5}{Must\_delete\_e}}(true)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00717}00717     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00718}00718     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00719}00719 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00720}00720 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00721}00721 \textcolor{comment}{    /// Virtual destructor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00722}\mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a18794fa4b1750aafa2369b2a412a1228}{00722}} \textcolor{comment}{}    \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a18794fa4b1750aafa2369b2a412a1228}{\string~GeneralisedHookean}}()}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00723}00723     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00724}00724       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a21d4ef7498c2efd5bf30fa0ecd0d7dd5}{Must\_delete\_e}}) \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a7a68b35f227848a065a7a844766b4eeb}{E\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00725}00725     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00726}00726 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00727}00727 \textcolor{comment}{    /// Calculate the contravariant 2nd Piola Kirchhoff}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00728}00728 \textcolor{comment}{    /// stress tensor. Arguments are the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00729}00729 \textcolor{comment}{    /// covariant undeformed and deformed metric tensor and the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00730}00730 \textcolor{comment}{    /// matrix in which to return the stress tensor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00731}00731 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a5beca3e59f04d109c394bf9fd24bb7c1}{calculate\_second\_piola\_kirchhoff\_stress}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00732}00732                                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00733}00733                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00734}00734 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00735}00735 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00736}00736 \textcolor{comment}{    /// Calculate the deviatoric part}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00737}00737 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}\(\backslash\)f\$  of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00738}00738 \textcolor{comment}{    /// 2nd Piola Kirchhoff stress tensor \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\}\(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00739}00739 \textcolor{comment}{    /// Also return the contravariant deformed metric}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00740}00740 \textcolor{comment}{    /// tensor and the determinant of the deformed metric tensor.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00741}00741 \textcolor{comment}{    /// This form is appropriate}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00742}00742 \textcolor{comment}{    /// for truly-\/incompressible materials for which}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00743}00743 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} = -\/ p G\string^\{ij\} +\(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}  \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00744}00744 \textcolor{comment}{    /// where the "{}pressure"{} \(\backslash\)f\$ p \(\backslash\)f\$ is determined by}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00745}00745 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)det G\_\{ij\} -\/ \(\backslash\)det g\_\{ij\} = 0 \(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00746}00746 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a5beca3e59f04d109c394bf9fd24bb7c1}{calculate\_second\_piola\_kirchhoff\_stress}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00747}00747                                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00748}00748                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma\_dev,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00749}00749                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G\_contra,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00750}00750                                                  \textcolor{keywordtype}{double}\& Gdet);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00751}00751 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00752}00752 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00753}00753 \textcolor{comment}{    /// Calculate the deviatoric part of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00754}00754 \textcolor{comment}{    /// 2nd Piola Kirchoff stress tensor. Also return the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00755}00755 \textcolor{comment}{    /// deformed metric tensor, the generalised dilatation, \(\backslash\)f\$ d, \(\backslash\)f\$ and}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00756}00756 \textcolor{comment}{    /// the inverse of the bulk modulus \(\backslash\)f\$ \(\backslash\)kappa\(\backslash\)f\$. This form is appropriate}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00757}00757 \textcolor{comment}{    /// for near-\/incompressible materials for which}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00758}00758 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} = -\/p G\string^\{ij\} + \(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}  \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00759}00759 \textcolor{comment}{    /// where the "{}pressure"{} \(\backslash\)f\$ p \(\backslash\)f\$ is determined from}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00760}00760 \textcolor{comment}{    /// \(\backslash\)f\$ p / \(\backslash\)kappa -\/ d =0 \(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00761}00761 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a5beca3e59f04d109c394bf9fd24bb7c1}{calculate\_second\_piola\_kirchhoff\_stress}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00762}00762                                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00763}00763                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma\_dev,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00764}00764                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& Gcontra,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00765}00765                                                  \textcolor{keywordtype}{double}\& gen\_dil,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00766}00766                                                  \textcolor{keywordtype}{double}\& inv\_kappa);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00767}00767 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00768}00768 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00769}00769 \textcolor{comment}{    /// Pure virtual function in which the writer must declare if the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00770}00770 \textcolor{comment}{    /// constitutive equation requires an incompressible formulation}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00771}00771 \textcolor{comment}{    /// in which the volume constraint is enforced explicitly.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00772}00772 \textcolor{comment}{    /// Used as a sanity check in PARANOID mode. False.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00773}\mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a9ed467d8b7c838cb7fed8c861aa652e9}{00773}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a9ed467d8b7c838cb7fed8c861aa652e9}{requires\_incompressibility\_constraint}}()}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00774}00774     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00775}00775       \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00776}00776     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00777}00777 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00778}00778   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00779}00779 \textcolor{comment}{    /// Poisson ratio}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00780}\mbox{\hyperlink{classoomph_1_1GeneralisedHookean_ad719ee5ed6d1bcacb18fec3339ae98de}{00780}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_ad719ee5ed6d1bcacb18fec3339ae98de}{Nu\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00781}00781 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00782}00782 \textcolor{comment}{    /// Young's modulus}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00783}\mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a7a68b35f227848a065a7a844766b4eeb}{00783}} \textcolor{comment}{}    \textcolor{keywordtype}{double}* \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a7a68b35f227848a065a7a844766b4eeb}{E\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00784}00784 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00785}00785 \textcolor{comment}{    /// Boolean flag to indicate if storage for elastic modulus}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00786}00786 \textcolor{comment}{    /// must be deleted in destructor}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00787}\mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a21d4ef7498c2efd5bf30fa0ecd0d7dd5}{00787}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1GeneralisedHookean_a21d4ef7498c2efd5bf30fa0ecd0d7dd5}{Must\_delete\_e}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00788}00788   \};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00789}00789 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00790}00790 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00791}00791 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00792}00792 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00793}00793 \textcolor{comment}{  /// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00794}00794 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00795}00795 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00796}00796   \textcolor{comment}{//=====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00797}00797 \textcolor{comment}{  /// A class for constitutive laws derived from strain-\/energy functions.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00798}00798 \textcolor{comment}{  /// Theory is in Green and Zerna.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00799}00799 \textcolor{comment}{}  \textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00800}\mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw}{00800}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw}{IsotropicStrainEnergyFunctionConstitutiveLaw}} : \textcolor{keyword}{public} \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw}{ConstitutiveLaw}}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00801}00801   \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00802}00802   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00803}00803 \textcolor{comment}{    /// Pointer to the strain energy function}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00804}\mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_a273d7ba7083654b4adfbe172d9839267}{00804}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{StrainEnergyFunction}}* \mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_a273d7ba7083654b4adfbe172d9839267}{Strain\_energy\_function\_pt}};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00805}00805 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00806}00806   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00807}00807 \textcolor{comment}{    /// Constructor takes a pointer to the strain energy function}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00808}\mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_aae7ab7763c630cb8296118da81fc5905}{00808}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_aae7ab7763c630cb8296118da81fc5905}{IsotropicStrainEnergyFunctionConstitutiveLaw}}(}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00809}00809       \mbox{\hyperlink{classoomph_1_1StrainEnergyFunction}{StrainEnergyFunction}}* \textcolor{keyword}{const}\& strain\_energy\_function\_pt)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00810}00810       : \mbox{\hyperlink{classoomph_1_1ConstitutiveLaw}{ConstitutiveLaw}}(), \mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_a273d7ba7083654b4adfbe172d9839267}{Strain\_energy\_function\_pt}}(strain\_energy\_function\_pt)}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00811}00811     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00812}00812     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00813}00813 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00814}00814 \textcolor{comment}{    /// Calculate the contravariant 2nd Piola Kirchhoff}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00815}00815 \textcolor{comment}{    /// stress tensor. Arguments are the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00816}00816 \textcolor{comment}{    /// covariant undeformed and deformed metric tensor and the}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00817}00817 \textcolor{comment}{    /// matrix in which to return the stress tensor.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00818}00818 \textcolor{comment}{    /// Uses correct 3D invariants for 2D (plane strain) problems.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00819}00819 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_af6c25617b8be6cc454d6b526ec6121fc}{calculate\_second\_piola\_kirchhoff\_stress}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00820}00820                                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00821}00821                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00822}00822 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00823}00823 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00824}00824 \textcolor{comment}{    /// Calculate the deviatoric part}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00825}00825 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}\(\backslash\)f\$  of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00826}00826 \textcolor{comment}{    /// 2nd Piola Kirchhoff stress tensor \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\}\(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00827}00827 \textcolor{comment}{    /// Also return the contravariant deformed metric}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00828}00828 \textcolor{comment}{    /// tensor and the determinant of the deformed metric tensor.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00829}00829 \textcolor{comment}{    /// This form is appropriate}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00830}00830 \textcolor{comment}{    /// for truly-\/incompressible materials for which}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00831}00831 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} = -\/ p G\string^\{ij\} +\(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}  \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00832}00832 \textcolor{comment}{    /// where the "{}pressure"{} \(\backslash\)f\$ p \(\backslash\)f\$ is determined by}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00833}00833 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)det G\_\{ij\} -\/ \(\backslash\)det g\_\{ij\} = 0 \(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00834}00834 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_af6c25617b8be6cc454d6b526ec6121fc}{calculate\_second\_piola\_kirchhoff\_stress}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00835}00835                                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00836}00836                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma\_dev,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00837}00837                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G\_contra,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00838}00838                                                  \textcolor{keywordtype}{double}\& Gdet);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00839}00839 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00840}00840 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00841}00841 \textcolor{comment}{    /// Calculate the deviatoric part of the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00842}00842 \textcolor{comment}{    /// 2nd Piola Kirchoff stress tensor. Also return the contravariant}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00843}00843 \textcolor{comment}{    /// deformed metric tensor, the generalised dilatation, \(\backslash\)f\$ d, \(\backslash\)f\$ and}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00844}00844 \textcolor{comment}{    /// the inverse of the bulk modulus \(\backslash\)f\$ \(\backslash\)kappa\(\backslash\)f\$. This form is appropriate}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00845}00845 \textcolor{comment}{    /// for near-\/incompressible materials for which}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00846}00846 \textcolor{comment}{    /// \(\backslash\)f\$ \(\backslash\)sigma\string^\{ij\} = -\/p G\string^\{ij\} + \(\backslash\)overline\{ \(\backslash\)sigma\string^\{ij\}\}  \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00847}00847 \textcolor{comment}{    /// where the "{}pressure"{} \(\backslash\)f\$ p \(\backslash\)f\$ is determined from}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00848}00848 \textcolor{comment}{    /// \(\backslash\)f\$ p / \(\backslash\)kappa -\/ d =0 \(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00849}00849 \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_af6c25617b8be6cc454d6b526ec6121fc}{calculate\_second\_piola\_kirchhoff\_stress}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& g,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00850}00850                                                  \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& G,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00851}00851                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& sigma\_dev,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00852}00852                                                  \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& Gcontra,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00853}00853                                                  \textcolor{keywordtype}{double}\& gen\_dil,}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00854}00854                                                  \textcolor{keywordtype}{double}\& inv\_kappa);}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00855}00855 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00856}00856 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00857}00857 \textcolor{comment}{    /// State if the constitutive equation requires an incompressible}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00858}00858 \textcolor{comment}{    /// formulation in which the volume constraint is enforced explicitly.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00859}00859 \textcolor{comment}{    /// Used as a sanity check in PARANOID mode. This is determined}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00860}00860 \textcolor{comment}{    /// by interrogating the associated strain energy function.}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00861}\mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_a6b9a454988b023a42782f78e4e3eebc4}{00861}} \textcolor{comment}{}    \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_a6b9a454988b023a42782f78e4e3eebc4}{requires\_incompressibility\_constraint}}()}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00862}00862     \{}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00863}00863       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1IsotropicStrainEnergyFunctionConstitutiveLaw_a273d7ba7083654b4adfbe172d9839267}{Strain\_energy\_function\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1StrainEnergyFunction_a312fe03c070f5c45a99ae4e186936147}{requires\_incompressibility\_constraint}}();}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00864}00864     \}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00865}00865   \};}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00866}00866 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00867}00867 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00868}00868 }
\DoxyCodeLine{\Hypertarget{constitutive__laws_8h_source_l00869}00869 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

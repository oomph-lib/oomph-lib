\hypertarget{the__data__structure_8txt__doxygenified_8h_source}{}\doxysection{the\+\_\+data\+\_\+structure.\+txt\+\_\+doxygenified.\+h}
\mbox{\hyperlink{the__data__structure_8txt__doxygenified_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00001}00001 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00002}00002 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00003}00003 \textcolor{comment}{\(\backslash\)mainpage The data structure}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00004}00004 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00005}00005 \textcolor{comment}{\(\backslash\)section intro Introduction}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00006}00006 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00007}00007 \textcolor{comment}{\(\backslash\)c oomph-\/lib is big! This document gives a "{}bottom up"{} overview of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00008}00008 \textcolor{comment}{the library's data structure and discusses how the various objects interact. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00009}00009 \textcolor{comment}{In addition to the detailed discussion provided below, the following}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00010}00010 \textcolor{comment}{doxygen-\/generated lists/indices provide quick access to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00011}00011 \textcolor{comment}{the documentation of \(\backslash\)c oomph-\/lib's classes: clicking on the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00012}00012 \textcolor{comment}{hyperlinks associated with a class takes you directly to a }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00013}00013 \textcolor{comment}{detailed description of its inheritance structure and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00014}00014 \textcolor{comment}{its members.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00015}00015 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00016}00016 \textcolor{comment}{<ul>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00017}00017 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00018}00018 \textcolor{comment}{<li><a href="{}../../the\_data\_structure/html/classes.html"{}> Class index </a></li>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00019}00019 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00020}00020 \textcolor{comment}{<li><a href="{}../../the\_data\_structure/html/functions.html"{}> Class member index </a></li>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00021}00021 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00022}00022 \textcolor{comment}{</ul>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00023}00023 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00024}00024 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00025}00025 \textcolor{comment}{ This rest of this document provides a "{}bottom up"{} overview of the data }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00026}00026 \textcolor{comment}{ structure in \(\backslash\)c oomph-\/lib and discusses how the various objects interact. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00027}00027 \textcolor{comment}{ For brevity, we usually replace the list of arguments to functions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00028}00028 \textcolor{comment}{ by `(...)' and explain the main input and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00029}00029 \textcolor{comment}{ output parameters in words. The full specifications of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00030}00030 \textcolor{comment}{ interfaces may be found in the individual class documentation,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00031}00031 \textcolor{comment}{ accessible via the links at the top of this page.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00032}00032 \textcolor{comment}{   }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00033}00033 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00034}00034 \textcolor{comment}{ \(\backslash\)subsection technical\_terms Technical terms}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00035}00035 \textcolor{comment}{ Throughout this document, certain commonly used terms have a specific}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00036}00036 \textcolor{comment}{ technical meaning: }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00037}00037 \textcolor{comment}{ -\/ \(\backslash\)b Value: A \(\backslash\)e value is a (double precision) number (e.g. a "{}nodal }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00038}00038 \textcolor{comment}{   value"{}). A value can either be an \(\backslash\)e unknown in the problem }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00039}00039 \textcolor{comment}{   or be determined by a boundary condition. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00040}00040 \textcolor{comment}{ -\/ \(\backslash\)b Unknown: An \(\backslash\)e unknown is a \(\backslash\)e value that is not determined by a}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00041}00041 \textcolor{comment}{   boundary condition.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00042}00042 \textcolor{comment}{ -\/ \(\backslash\)b Degree \(\backslash\)b of \(\backslash\)b freedom: Synonym for \(\backslash\)e unknown; often}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00043}00043 \textcolor{comment}{   abbreviated as "{}dof"{}.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00044}00044 \textcolor{comment}{ -\/ \(\backslash\)b History \(\backslash\)b value: \(\backslash\)e History \(\backslash\)e values are (double precision)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00045}00045 \textcolor{comment}{   numbers that are used by \(\backslash\)c TimeSteppers to calculate }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00046}00046 \textcolor{comment}{   time-\/derivatives of values. For instance, history values are often,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00047}00047 \textcolor{comment}{   but \(\backslash\)b not \(\backslash\)b always, the values at previous timesteps.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00048}00048 \textcolor{comment}{ -\/ \(\backslash\)b Pinned/free: \(\backslash\)e Values that are (are not) determined by boundary}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00049}00049 \textcolor{comment}{   conditions are known as pinned (free) values.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00050}00050 \textcolor{comment}{ -\/ \(\backslash\)b Adapt: \(\backslash\)e Mesh \(\backslash\)e adaptation refines/un-\/refines meshes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00051}00051 \textcolor{comment}{   by adding or deleting selected nodes and elements. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00052}00052 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00053}00053 \textcolor{comment}{ \(\backslash\)section general\_data\_structure Overview of the basic data structure}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00054}00054 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00055}00055 \textcolor{comment}{ The main components of \(\backslash\)c oomph-\/lib are \(\backslash\)c Data, \(\backslash\)c Node, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00056}00056 \textcolor{comment}{\(\backslash\)c GeneralisedElement, \(\backslash\)c Mesh and \(\backslash\)c Problem.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00057}00057 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00058}00058 \textcolor{comment}{ \(\backslash\)subsection data Data}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00059}00059 \textcolor{comment}{ The most elementary data structure in \(\backslash\)c oomph-\/lib is \(\backslash\)c Data (ha!).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00060}00060 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00061}00061 \textcolor{comment}{ Consider the solution of a scalar PDE }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00062}00062 \textcolor{comment}{ (e.g. a Poisson equation) with certain boundary conditions. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00063}00063 \textcolor{comment}{ The numerical solution of this problem requires the computation of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00064}00064 \textcolor{comment}{ the function values (double precision numbers) at a finite number }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00065}00065 \textcolor{comment}{ of spatial positions (the \(\backslash\)c Nodes). Typically, these values fall into two}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00066}00066 \textcolor{comment}{ categories: those that are known \(\backslash\)e a \(\backslash\)e priori (i.e. are enforced by }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00067}00067 \textcolor{comment}{ boundary conditions), and those that must be determined as part of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00068}00068 \textcolor{comment}{ solution.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00069}00069 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00070}00070 \textcolor{comment}{ \(\backslash\)c Data stores a value -\/-\/-\/ a double precision number.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00071}00071 \textcolor{comment}{ Typically,  the values of the unknowns are determined by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00072}00072 \textcolor{comment}{ the solution of a system of algebraic equations. The solution}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00073}00073 \textcolor{comment}{ of this system usually requires a (linear) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00074}00074 \textcolor{comment}{ numbering of the unknowns and associated equations. Hence, \(\backslash\)c Data also}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00075}00075 \textcolor{comment}{ stores a (long) integer that represents the number of the unknown}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00076}00076 \textcolor{comment}{ in the global numbering scheme.  \(\backslash\)b Convention: If the \(\backslash\)c Data value }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00077}00077 \textcolor{comment}{ is pinned, we set the equation number to the static member data}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00078}00078 \textcolor{comment}{ \(\backslash\)c Data::Is\_pinned, a negative number.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00079}00079 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00080}00080 \textcolor{comment}{ The number of an unknown is related to the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00081}00081 \textcolor{comment}{ number of the equation that `determines its value', so we use}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00082}00082 \textcolor{comment}{ the terms `equation number' and `number of the unknown'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00083}00083 \textcolor{comment}{ interchangeably. In fact, because the term `number of the unknown'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00084}00084 \textcolor{comment}{ is rather tedious, we \(\backslash\)e only use the term `equation number'. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00085}00085 \textcolor{comment}{  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00086}00086 \textcolor{comment}{ Two observations motivate a straightforward extension}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00087}00087 \textcolor{comment}{ of this basic data structure:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00088}00088 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00089}00089 \textcolor{comment}{ -\/ In time-\/dependent problems, the approximation of time-\/derivatives}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00090}00090 \textcolor{comment}{   requires the storage of a certain number of auxiliary values}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00091}00091 \textcolor{comment}{   (e.g. the values of the unknowns at a number of previous timesteps).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00092}00092 \textcolor{comment}{ -\/ In many problems, we are not dealing with scalars (i.e. individual }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00093}00093 \textcolor{comment}{   doubles) but with vector-\/valued unknowns; for instance, in a }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00094}00094 \textcolor{comment}{   3D fluids problem, we need to store three velocity components }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00095}00095 \textcolor{comment}{   at every node. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00096}00096 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00097}00097 \textcolor{comment}{ Therefore, \(\backslash\)c Data allows the storage of multiple values }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00098}00098 \textcolor{comment}{ (all of which can either be pinned or free, and all of which have their}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00099}00099 \textcolor{comment}{ own global equation number); \(\backslash\)c Data can also store a certain number of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00100}00100 \textcolor{comment}{ auxiliary (history) values used for timestepping.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00101}00101 \textcolor{comment}{ Finally, \(\backslash\)c Data stores a pointer to a \(\backslash\)c TimeStepper whose member}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00102}00102 \textcolor{comment}{ functions relate the history values to the values' time-\/derivatives.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00103}00103 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00104}00104 \textcolor{comment}{ Direct, pointer-\/based read/write access to the \(\backslash\)c Data values is provided by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00105}00105 \textcolor{comment}{ the functions \(\backslash\)code Data::value\_pt(i) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00106}00106 \textcolor{comment}{ which returns a pointer to the i-\/th value at the present time, and by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00107}00107 \textcolor{comment}{ \(\backslash\)code Data::value\_pt(t,i) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00108}00108 \textcolor{comment}{ which returns a pointer to the \(\backslash\)c t -\/th history value associated with}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00109}00109 \textcolor{comment}{ value \(\backslash\)c i. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00110}00110 \textcolor{comment}{ Read-\/only access is also provided by the functions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00111}00111 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00112}00112 \textcolor{comment}{ Data::value(i)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00113}00113 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00114}00114 \textcolor{comment}{ and its time-\/dependent counterpart}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00115}00115 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00116}00116 \textcolor{comment}{ Data::value(t,i)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00117}00117 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00118}00118 \textcolor{comment}{ We recommend using these functions instead of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00119}00119 \textcolor{comment}{ pointer-\/based access functions for read access }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00120}00120 \textcolor{comment}{ because the two \(\backslash\)c Data::value(...) functions are overloaded}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00121}00121 \textcolor{comment}{ in the \(\backslash\)c Node class (discussed below) so that they return}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00122}00122 \textcolor{comment}{ suitably constrained nodal values if a \(\backslash\)c Node is hanging.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00123}00123 \textcolor{comment}{ The \(\backslash\)c Data::value(...) functions cannot be used to set \(\backslash\)c Data}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00124}00124 \textcolor{comment}{ values. For this purpose we provide the functions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00125}00125 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00126}00126 \textcolor{comment}{ Data::set\_value(i,val)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00127}00127 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00128}00128 \textcolor{comment}{ which sets the \(\backslash\)c i -\/th \(\backslash\)c Data value to the double precision number}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00129}00129 \textcolor{comment}{ \(\backslash\)c val;  and its time-\/dependent counterpart}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00130}00130 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00131}00131 \textcolor{comment}{ Data::set\_value(t,i,val)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00132}00132 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00133}00133 \textcolor{comment}{ which sets the \(\backslash\)c t -\/th history value associated with the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00134}00134 \textcolor{comment}{ \(\backslash\)c i -\/th \(\backslash\)c Data value to the double precision number}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00135}00135 \textcolor{comment}{ \(\backslash\)c val.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00136}00136 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00137}00137 \textcolor{comment}{ The general convention for all time-\/dependent data is }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00138}00138 \textcolor{comment}{ that the index t=0 refers to values at the present time, whereas}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00139}00139 \textcolor{comment}{ the values associated with t>0 correspond to history values.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00140}00140 \textcolor{comment}{ In many cases (e.g. BDF schemes)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00141}00141 \textcolor{comment}{ these history values are simply the values at previous timesteps, but}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00142}00142 \textcolor{comment}{ this is not guaranteed. See the section \(\backslash\)ref timestepping}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00143}00143 \textcolor{comment}{ for further details.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00144}00144 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00145}00145 \textcolor{comment}{ \(\backslash\)subsection nodes Nodes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00146}00146 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00147}00147 \textcolor{comment}{ In FE computations, most (but not all; see below) \(\backslash\)c Data are associated}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00148}00148 \textcolor{comment}{ with nodal points. Conversely, all \(\backslash\)c Nodes in a finite element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00149}00149 \textcolor{comment}{ mesh have \(\backslash\)c Data associated with them. \(\backslash\)c Nodes are therefore derived}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00150}00150 \textcolor{comment}{ from \(\backslash\)c Data, but also store a spatial position, specified }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00151}00151 \textcolor{comment}{ by a certain number of spatial (Eulerian) coordinates.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00152}00152 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00153}00153 \textcolor{comment}{ The nodal positions are accessed by the member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00154}00154 \textcolor{comment}{ \(\backslash\)code Node::x(i) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00155}00155 \textcolor{comment}{ which returns the current value of i-\/th nodal coordinate or}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00156}00156 \textcolor{comment}{ \(\backslash\)code Node::x(t,i) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00157}00157 \textcolor{comment}{ which returns the value of i-\/th nodal coordinate at the present}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00158}00158 \textcolor{comment}{ (t=0) timestep or a history value, if (t>0); again, note that the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00159}00159 \textcolor{comment}{ history values are not necessarily positions at previous timesteps.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00160}00160 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00161}00161 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00162}00162 \textcolor{comment}{ \(\backslash\)subsubsection advanced\_features\_of\_nodes Advanced features:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00163}00163 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00164}00164 \textcolor{comment}{ \(\backslash\)c Nodes have the following additional features:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00165}00165 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00166}00166 \textcolor{comment}{ -\/ In moving-\/mesh problems, we must evaluate mesh velocities, which}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00167}00167 \textcolor{comment}{   requires the storage of the nodal position at a number of previous}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00168}00168 \textcolor{comment}{   timesteps. Storage for the positional history values is allocated }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00169}00169 \textcolor{comment}{   by the \(\backslash\)c Node constructor. A different \(\backslash\)c TimeStepper may be used to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00170}00170 \textcolor{comment}{   represent time-\/derivatives of nodal position, so}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00171}00171 \textcolor{comment}{   \(\backslash\)c Nodes store a separate pointer to a positional \(\backslash\)c TimeStepper.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00172}00172 \textcolor{comment}{   [Note: By default, we allocate the same amount of storage for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00173}00173 \textcolor{comment}{   the history of the nodal positions as we do for the history of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00174}00174 \textcolor{comment}{   the nodal values;  e.g. if a \(\backslash\)c BDF<2> scheme is used to evaluate}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00175}00175 \textcolor{comment}{   the time-\/derivatives of the fluid velocities, we assume that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00176}00176 \textcolor{comment}{   the same timestepping scheme is used (and the same amount of storage }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00177}00177 \textcolor{comment}{   required) to determine the mesh velocities from the nodal}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00178}00178 \textcolor{comment}{   positions.]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00179}00179 \textcolor{comment}{ -\/ For finite elements in which the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00180}00180 \textcolor{comment}{   global position of a point in an element is determined by interpolation }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00181}00181 \textcolor{comment}{   from the position of the element's \(\backslash\)c Nodes (Lagrange-\/type elements), }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00182}00182 \textcolor{comment}{   we need only store}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00183}00183 \textcolor{comment}{   the spatial position of the \(\backslash\)c Nodes. In many other elements (e.g.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00184}00184 \textcolor{comment}{   Hermite-\/type elements), the interpolation of the geometry requires}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00185}00185 \textcolor{comment}{   additional quantities, representing, e.g. the derivative of the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00186}00186 \textcolor{comment}{   mapping between local and global coordinates.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00187}00187 \textcolor{comment}{   Therefore, we allow the storage of additional positional variables }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00188}00188 \textcolor{comment}{   at each \(\backslash\)c Node, so that, in general, every \(\backslash\)c Node}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00189}00189 \textcolor{comment}{   has a number of \(\backslash\)e generalised coordinates for each spatial coordinate}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00190}00190 \textcolor{comment}{   direction. For instance, for nodes in 1D Hermite elements,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00191}00191 \textcolor{comment}{   the nodal coordinate of type '0' stores the global position at the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00192}00192 \textcolor{comment}{   node; the nodal coordinate of type '1' stores the derivative}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00193}00193 \textcolor{comment}{   of the global position w.r.t. to the element's local}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00194}00194 \textcolor{comment}{   coordinate. The member function \(\backslash\)code Node::x\_gen(k,i) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00195}00195 \textcolor{comment}{   returns the \(\backslash\)c i -\/th coordinate of the \(\backslash\)c k -\/th coordinate type. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00196}00196 \textcolor{comment}{ -\/ In the context of mesh refinement, nodes can become hanging nodes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00197}00197 \textcolor{comment}{   (i.e. nodes on an element's edge/face that are not shared by the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00198}00198 \textcolor{comment}{   adjacent element). The "{}hanging"{} }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00199}00199 \textcolor{comment}{   status of a \(\backslash\)c Node is indicated by the pointer to its \(\backslash\)c HangInfo}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00200}00200 \textcolor{comment}{   object. For ordinary (non-\/hanging) \(\backslash\)c Nodes this pointer is NULL, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00201}00201 \textcolor{comment}{   the default setting; see the section \(\backslash\)ref Hanging\_Nodes for a more}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00202}00202 \textcolor{comment}{   detailed discussion of hanging nodes; in particular, the role of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00203}00203 \textcolor{comment}{   the member functions \(\backslash\)c Node::position() and \(\backslash\)c Node::value()}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00204}00204 \textcolor{comment}{ -\/ Mesh unrefinement can render nodes obsolete}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00205}00205 \textcolor{comment}{   and we use a boolean flag to indicate this status.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00206}00206 \textcolor{comment}{   By default, \(\backslash\)c Nodes are not obsolete.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00207}00207 \textcolor{comment}{ -\/ \(\backslash\)b BoundaryNodes: \(\backslash\)c Nodes "{}know"{} the domain/mesh boundaries on which }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00208}00208 \textcolor{comment}{   they are located. A \(\backslash\)c Node can be located}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00209}00209 \textcolor{comment}{   on none, one or multiple boundaries; the latter case arises if the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00210}00210 \textcolor{comment}{   \(\backslash\)c Node is located on edges and corners of the mesh.    }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00211}00211 \textcolor{comment}{   Storage of this information facilitates the automatic}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00212}00212 \textcolor{comment}{   determination of boundary conditions for new \(\backslash\)c Nodes that are}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00213}00213 \textcolor{comment}{   created during mesh refinement.\(\backslash\)n }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00214}00214 \textcolor{comment}{   The majority of the \(\backslash\)c Nodes will \(\backslash\)b not be located on boundaries,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00215}00215 \textcolor{comment}{   however, and providing storage for the boundary information }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00216}00216 \textcolor{comment}{   in every \(\backslash\)c Node object is rather wasteful. The derived class}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00217}00217 \textcolor{comment}{   \(\backslash\)c BoundaryNode adds the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00218}00218 \textcolor{comment}{   required additional storage to the \(\backslash\)c Node class and it follows that  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00219}00219 \textcolor{comment}{   all \(\backslash\)c Nodes that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00220}00220 \textcolor{comment}{   could lie on boundaries must be \(\backslash\)c BoundaryNodes; see \(\backslash\)ref meshes for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00221}00221 \textcolor{comment}{   further details.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00222}00222 \textcolor{comment}{ -\/ \(\backslash\)b SolidNodes: Many solid mechanics problems }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00223}00223 \textcolor{comment}{   are formulated in Lagrangian coordinates. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00224}00224 \textcolor{comment}{   In this case, the governing equations are discretised in a fixed}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00225}00225 \textcolor{comment}{   Lagrangian domain; the nodal coordinates represent the \(\backslash\)c Nodes' fixed}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00226}00226 \textcolor{comment}{   positions in this domain. When the elastic body deforms,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00227}00227 \textcolor{comment}{   material points (and hence the \(\backslash\)c Nodes) are displaced }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00228}00228 \textcolor{comment}{   to new Eulerian positions. The \(\backslash\)c SolidNode class is derived from}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00229}00229 \textcolor{comment}{   \(\backslash\)c Node and contains storage for }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00230}00230 \textcolor{comment}{   the \(\backslash\)c Nodes'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00231}00231 \textcolor{comment}{   \(\backslash\)b fixed positions (i.e. the Lagrangian coordinates)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00232}00232 \textcolor{comment}{   AND their \(\backslash\)b variable  positions (i.e. the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00233}00233 \textcolor{comment}{   Eulerian coordinates), which can be unknowns in the problem. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00234}00234 \textcolor{comment}{   To avoid confusion between the two, the access function for the nodal }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00235}00235 \textcolor{comment}{   position, \(\backslash\)code Node::x(...) \(\backslash\)endcode \(\backslash\)b always refers to a \(\backslash\)c Node's }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00236}00236 \textcolor{comment}{   Eulerian position/coordinate. In \(\backslash\)c SolidNodes, we provide }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00237}00237 \textcolor{comment}{   a wrapper \(\backslash\)code SolidNode::xi(..) \(\backslash\)endcode that provides access }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00238}00238 \textcolor{comment}{   to the Lagrangian coordinates. Similarly, in the case of generalised}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00239}00239 \textcolor{comment}{   coordinates \(\backslash\)code Node::x\_gen(...) \(\backslash\)endcode always refers to the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00240}00240 \textcolor{comment}{   generalised Eulerian position and \(\backslash\)code SolidNode::xi\_gen(...)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00241}00241 \textcolor{comment}{   \(\backslash\)endcode refers to the generalised Lagrangian position.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00242}00242 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00243}00243 \textcolor{comment}{ \(\backslash\)subsection elements Elements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00244}00244 \textcolor{comment}{  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00245}00245 \textcolor{comment}{ \(\backslash\)subsubsection Overview}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00246}00246 \textcolor{comment}{ Most (finite-\/)elements in \(\backslash\)c oomph-\/lib have a four-\/level inheritance }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00247}00247 \textcolor{comment}{structure which separates:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00248}00248 \textcolor{comment}{ -\/\# the basic functionality that is shared by all (generalised) elements.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00249}00249 \textcolor{comment}{ -\/\# the functionality that is shared by all finite elements.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00250}00250 \textcolor{comment}{ -\/\# the implementation of the finite element geometry (i.e. the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00251}00251 \textcolor{comment}{    shape-\/function-\/based mapping between local and global coordinates).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00252}00252 \textcolor{comment}{ -\/\# the representation of the mathematics that describes a specific problem.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00253}00253 \textcolor{comment}{ .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00254}00254 \textcolor{comment}{ The distinction between geometry and `maths' greatly }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00255}00255 \textcolor{comment}{ facilitates code-\/reuse as a (geometric) quad-\/element, say, can}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00256}00256 \textcolor{comment}{ form the basis for elements that solve a variety of equations}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00257}00257 \textcolor{comment}{ (e.g. Poisson, Advection-\/-\/Diffusion, Navier-\/-\/Stokes, ...).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00258}00258 \textcolor{comment}{ We shall now discuss the four levels of the element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00259}00259 \textcolor{comment}{ hierarchy in more detail.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00260}00260 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00261}00261 \textcolor{comment}{ \(\backslash\)subsubsection Generalised\_Element Level 0: GeneralisedElement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00262}00262 \textcolor{comment}{ The class \(\backslash\)c GeneralisedElement forms the base class for all}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00263}00263 \textcolor{comment}{ elements in \(\backslash\)c oomph-\/lib. It incorporates the basic functionality that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00264}00264 \textcolor{comment}{ all \(\backslash\)b elements must have. The interfaces at this level are }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00265}00265 \textcolor{comment}{ so general that a \(\backslash\)c GeneralisedElement can represent discrete algebraic }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00266}00266 \textcolor{comment}{ constraints (or even finite-\/difference stencils).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00267}00267 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00268}00268 \textcolor{comment}{   The main role of elements is to provide contributions to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00269}00269 \textcolor{comment}{   a global residual vector and to the global Jacobian matrix.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00270}00270 \textcolor{comment}{   The two virtual functions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00271}00271 \textcolor{comment}{   \(\backslash\)code  virtual void GeneralisedElement::get\_residuals(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00272}00272 \textcolor{comment}{   \(\backslash\)code  virtual void GeneralisedElement::get\_jacobian(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00273}00273 \textcolor{comment}{   specify the appropriate interfaces.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00274}00274 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00275}00275 \textcolor{comment}{   In multi-\/physics problems, the elemental residuals and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00276}00276 \textcolor{comment}{   Jacobian will be a combination of the residuals vectors and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00277}00277 \textcolor{comment}{   Jacobian matrices of the constituent}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00278}00278 \textcolor{comment}{   single-\/physics elements. An obvious implementation is to use}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00279}00279 \textcolor{comment}{   multiple inheritance and function overloading }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00280}00280 \textcolor{comment}{   \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00281}00281 \textcolor{comment}{   class MultiPhysicsElement : public virtual SinglePhysicsOneElement,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00282}00282 \textcolor{comment}{                               public virtual SinglePhysicsTwoElement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00283}00283 \textcolor{comment}{    \{   }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00284}00284 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00285}00285 \textcolor{comment}{     [...]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00286}00286 \textcolor{comment}{                        }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00287}00287 \textcolor{comment}{     void get\_residuals(...) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00288}00288 \textcolor{comment}{      \{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00289}00289 \textcolor{comment}{       SinglePhysicsOneElement::get\_residuals(...);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00290}00290 \textcolor{comment}{       SinglePhysicsTwoElement::get\_residuals(...);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00291}00291 \textcolor{comment}{      \}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00292}00292 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00293}00293 \textcolor{comment}{     [...]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00294}00294 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00295}00295 \textcolor{comment}{    \};}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00296}00296 \textcolor{comment}{    \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00297}00297 \textcolor{comment}{    where the \(\backslash\)c MultiPhysicsElement inherits from \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00298}00298 \textcolor{comment}{   SinglePhysicsOneElement and \(\backslash\)c SinglePhysicsTwoElement.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00299}00299 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00300}00300 \textcolor{comment}{   A problem with this implementation arises when we consider where to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00301}00301 \textcolor{comment}{   initialise the residuals vector. If the second single-\/physics }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00302}00302 \textcolor{comment}{   \(\backslash\)c get\_residuals(...) function initialises the residuals}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00303}00303 \textcolor{comment}{   vector, then the contribution of the first single-\/physics element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00304}00304 \textcolor{comment}{   will be negated. When writing a single-\/physics element, however,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00305}00305 \textcolor{comment}{   we cannot know whether it will ever be used as part of a}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00306}00306 \textcolor{comment}{   multi-\/physics element and, if so, in which order the \(\backslash\)c get\_residuals(...)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00307}00307 \textcolor{comment}{   functions will be called. The solution adopted in \(\backslash\)c oomph-\/lib is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00308}00308 \textcolor{comment}{   to provide the two additional virtual functions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00309}00309 \textcolor{comment}{   \(\backslash\)code }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00310}00310 \textcolor{comment}{   virtual void GeneralisedElement::fill\_in\_contribution\_to\_residuals(...)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00311}00311 \textcolor{comment}{   \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00312}00312 \textcolor{comment}{   \(\backslash\)code }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00313}00313 \textcolor{comment}{   virtual void GeneralisedElement::fill\_in\_contribution\_to\_jacobian(...)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00314}00314 \textcolor{comment}{   \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00315}00315 \textcolor{comment}{   which \(\backslash\)b must \(\backslash\)b not initialise the residuals or Jacobian, but merely add}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00316}00316 \textcolor{comment}{   the contribution of the element to the vector or matrix.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00317}00317 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00318}00318 \textcolor{comment}{   We then use the default implementation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00319}00319 \textcolor{comment}{   \(\backslash\)code }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00320}00320 \textcolor{comment}{   virtual void GeneralisedElement::get\_residuals(Vector<double> \&residuals) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00321}00321 \textcolor{comment}{    \{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00322}00322 \textcolor{comment}{     //Zero the residuals vector}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00323}00323 \textcolor{comment}{     residuals.initialise(0.0);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00324}00324 \textcolor{comment}{  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00325}00325 \textcolor{comment}{     //Add the elemental contribution to the residuals vector}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00326}00326 \textcolor{comment}{     fill\_in\_contribution\_to\_residuals(residuals);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00327}00327 \textcolor{comment}{     \}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00328}00328 \textcolor{comment}{    \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00329}00329 \textcolor{comment}{    which permits a simple multi-\/physics re-\/implementation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00330}00330 \textcolor{comment}{    \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00331}00331 \textcolor{comment}{     class MultiPhysicsElement : public virtual SinglePhysicsOneElement,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00332}00332 \textcolor{comment}{                                 public virtual SinglePhysicsTwoElement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00333}00333 \textcolor{comment}{      \{   }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00334}00334 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00335}00335 \textcolor{comment}{       [...]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00336}00336 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00337}00337 \textcolor{comment}{      void get\_residuals(Vector<double> \&residuals) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00338}00338 \textcolor{comment}{       \{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00339}00339 \textcolor{comment}{        //Zero the residuals vector}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00340}00340 \textcolor{comment}{        residuals.initialise(0.0);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00341}00341 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00342}00342 \textcolor{comment}{        //Add the first elemental contribution to the residuals vector}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00343}00343 \textcolor{comment}{        SinglePhysicsOneElement::fill\_in\_contribution\_to\_residuals(residuals);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00344}00344 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00345}00345 \textcolor{comment}{        //Add the second elemental contribution to the residuals vector   }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00346}00346 \textcolor{comment}{        SinglePhysicsTwoElement::fill\_in\_contribution\_to\_residuals(residuals); }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00347}00347 \textcolor{comment}{       \}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00348}00348 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00349}00349 \textcolor{comment}{       [...]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00350}00350 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00351}00351 \textcolor{comment}{     \};}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00352}00352 \textcolor{comment}{     \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00353}00353 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00354}00354 \textcolor{comment}{    The default implementation of \(\backslash\)c fill\_in\_contribution\_to\_jacobian(...)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00355}00355 \textcolor{comment}{    uses finite differences to calculate the Jacobian matrix. Hence,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00356}00356 \textcolor{comment}{    the simplest possible implementation of a new element requires}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00357}00357 \textcolor{comment}{    only the specification of \(\backslash\)c fill\_in\_contribution\_to\_residuals(...).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00358}00358 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00359}00359 \textcolor{comment}{ -\/ When computing element residuals and Jacobian matrices, we need to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00360}00360 \textcolor{comment}{   know which \(\backslash\)c Data affects the residuals (and hence the Jacobian matrix). }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00361}00361 \textcolor{comment}{   For a \(\backslash\)c GeneralisedElement such \(\backslash\)c Data exists in two forms, accessed }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00362}00362 \textcolor{comment}{   via pointers:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00363}00363 \textcolor{comment}{   -\/ \(\backslash\)c Data that is internal to each element is accessed via pointers}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00364}00364 \textcolor{comment}{     to `Internal \(\backslash\)c Data'. For instance, in fluid (finite) elements with}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00365}00365 \textcolor{comment}{     discontinuous pressure interpolations, the pressure degrees of freedom }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00366}00366 \textcolor{comment}{     are local to each element and are stored in }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00367}00367 \textcolor{comment}{     the element's 'Internal \(\backslash\)c Data'.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00368}00368 \textcolor{comment}{   -\/ \(\backslash\)c Data that is external to the element. An example is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00369}00369 \textcolor{comment}{     a load parameter such as the external pressure that acts}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00370}00370 \textcolor{comment}{     on a shell structure. Such \(\backslash\)c Data is accessed via pointers}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00371}00371 \textcolor{comment}{     to `External \(\backslash\)c Data'.  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00372}00372 \textcolor{comment}{   -\/ As discussed above, all \(\backslash\)c Data contains values that are either }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00373}00373 \textcolor{comment}{     free (i.e. unknown) or pinned (i.e. prescribed by boundary }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00374}00374 \textcolor{comment}{     conditions). Free/unknown values have a non-\/negative global}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00375}00375 \textcolor{comment}{     (equation) number. When assembling an element's local }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00376}00376 \textcolor{comment}{     contribution to the global residual vector and the Jacobian matrix,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00377}00377 \textcolor{comment}{     we refer to the unknowns by their local (equation) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00378}00378 \textcolor{comment}{     numbers. In order to add the elemental contribution to the appropriate }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00379}00379 \textcolor{comment}{     global degree of freedom, every element has a lookup table that }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00380}00380 \textcolor{comment}{     establishes the relation between local and global equation numbers.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00381}00381 \textcolor{comment}{     This lookup table is automatically generated by the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00382}00382 \textcolor{comment}{     element's member function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00383}00383 \textcolor{comment}{     \(\backslash\)code GeneralisedElement::assign\_local\_eqn\_numbers() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00384}00384 \textcolor{comment}{     Access to the lookup scheme is provided by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00385}00385 \textcolor{comment}{     the member function \(\backslash\)c eqn\_number(...) so that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00386}00386 \textcolor{comment}{     \(\backslash\)code }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00387}00387 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00388}00388 \textcolor{comment}{     unsigned i\_local;}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00389}00389 \textcolor{comment}{     GeneralisedElement el;}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00390}00390 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00391}00391 \textcolor{comment}{     [...]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00392}00392 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00393}00393 \textcolor{comment}{     unsigned i\_global=el.eqn\_number(i\_local); }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00394}00394 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00395}00395 \textcolor{comment}{     \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00396}00396 \textcolor{comment}{     returns the global equation number \(\backslash\)c i\_global corresponding }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00397}00397 \textcolor{comment}{     to the local equation number \(\backslash\)c i\_local. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00398}00398 \textcolor{comment}{     The local equation numbers of the internal and external \(\backslash\)c Data are}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00399}00399 \textcolor{comment}{     stored in the private arrays \(\backslash\)c Internal\_local\_eqn and \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00400}00400 \textcolor{comment}{     External\_local\_eqn, accessed by the functions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00401}00401 \textcolor{comment}{     \(\backslash\)c GeneralisedElement::internal\_local\_eqn(...) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00402}00402 \textcolor{comment}{     and \(\backslash\)c GeneralisedElement::external\_local\_eqn(...), respectively. Thus, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00403}00403 \textcolor{comment}{     \(\backslash\)c GeneralisedElement::internal\_local\_eqn(i\_internal,i\_value) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00404}00404 \textcolor{comment}{     returns the local}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00405}00405 \textcolor{comment}{     equation number of the \(\backslash\)c i\_value -\/th value stored in the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00406}00406 \textcolor{comment}{     \(\backslash\)c i\_internal -\/th internal \(\backslash\)c Data object. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00407}00407 \textcolor{comment}{   -\/ All elements have a pointer to a global \(\backslash\)c Time object which }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00408}00408 \textcolor{comment}{     allows the evaluation of time-\/dependent}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00409}00409 \textcolor{comment}{     coefficients. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00410}00410 \textcolor{comment}{   .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00411}00411 \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00412}00412 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00413}00413 \textcolor{comment}{ \(\backslash\)subsubsection Finite\_Element Level 1: FiniteElement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00414}00414 \textcolor{comment}{ The class \(\backslash\)c FiniteElement is derived from \(\backslash\)c GeneralisedElement and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00415}00415 \textcolor{comment}{ incorporates the basic functionality that all \(\backslash\)b finite elements must have.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00416}00416 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00417}00417 \textcolor{comment}{ -\/ All \(\backslash\)c FiniteElements have a certain}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00418}00418 \textcolor{comment}{   number of \(\backslash\)c Nodes. We access the \(\backslash\)c Nodes (and their associated values) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00419}00419 \textcolor{comment}{   via pointers and identify them via their (local) node numbers so that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00420}00420 \textcolor{comment}{   \(\backslash\)code  FiniteElement::Node\_pt[n] \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00421}00421 \textcolor{comment}{   or the access function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00422}00422 \textcolor{comment}{   \(\backslash\)code FiniteElement::node\_pt(n) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00423}00423 \textcolor{comment}{   returns a pointer to the element's \(\backslash\)c n -\/th local \(\backslash\)c Node.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00424}00424 \textcolor{comment}{  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00425}00425 \textcolor{comment}{  -\/ The \(\backslash\)c FiniteElement class provides wrapper functions that }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00426}00426 \textcolor{comment}{    give direct access to an element's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00427}00427 \textcolor{comment}{    (possibly generalised) nodal positions at the present timestep or,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00428}00428 \textcolor{comment}{    where appropriate, its positional history values, so that rather than}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00429}00429 \textcolor{comment}{    \(\backslash\)code FiniteElement::Node\_pt[n]-\/>x(i) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00430}00430 \textcolor{comment}{    we can write}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00431}00431 \textcolor{comment}{    \(\backslash\)code FiniteElement::nodal\_position(n,i) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00432}00432 \textcolor{comment}{    Not only does this make the code more readable but also}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00433}00433 \textcolor{comment}{    allows us to formulate the "{}mathematics"{} in general terms.\(\backslash\)n }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00434}00434 \textcolor{comment}{    [Furthermore,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00435}00435 \textcolor{comment}{    the function \(\backslash\)c FiniteElement::nodal\_position(n,i) accesses }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00436}00436 \textcolor{comment}{    the nodal positions indirectly}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00437}00437 \textcolor{comment}{    via  \(\backslash\)c Node::position(...) which ensures that the nodal position }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00438}00438 \textcolor{comment}{    is consistent with any constraints associated with the \(\backslash\)c Node's }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00439}00439 \textcolor{comment}{    hanging status; see section \(\backslash\)ref Hanging\_Nodes for further details.]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00440}00440 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00441}00441 \textcolor{comment}{  -\/ When \(\backslash\)c Nodes are created in a (templated) finite element mesh, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00442}00442 \textcolor{comment}{    it is important that \(\backslash\)c Nodes of the correct type with the appropriate}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00443}00443 \textcolor{comment}{    amount of storage are created.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00444}00444 \textcolor{comment}{    For instance, Poisson elements require \(\backslash\)c Nodes that provide storage}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00445}00445 \textcolor{comment}{    for a single value at each \(\backslash\)c Node, whereas 2D Taylor-\/Hood, Navier-\/Stokes }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00446}00446 \textcolor{comment}{    elements require storage for three values (two velocities and one}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00447}00447 \textcolor{comment}{    pressure) at the corner \(\backslash\)c Nodes, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00448}00448 \textcolor{comment}{    but only two values (the two velocities) at all others. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00449}00449 \textcolor{comment}{    The member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00450}00450 \textcolor{comment}{    \(\backslash\)code FiniteElement::construct\_node(...) \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00451}00451 \textcolor{comment}{    creates a \(\backslash\)c Node, stores a pointer to the \(\backslash\)c Node in the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00452}00452 \textcolor{comment}{    \(\backslash\)c FiniteElement::Node\_pt }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00453}00453 \textcolor{comment}{    vector and returns a pointer to the newly created \(\backslash\)c Node. The}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00454}00454 \textcolor{comment}{    function is overloaded in elements that require a different type}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00455}00455 \textcolor{comment}{    of \(\backslash\)c Node, for example \(\backslash\)c SolidElement::construct\_node(...) creates}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00456}00456 \textcolor{comment}{    a \(\backslash\)c SolidNode rather than a \(\backslash\)c Node. \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00457}00457 \textcolor{comment}{    The function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00458}00458 \textcolor{comment}{    \(\backslash\)c FiniteElement::construct\_node(...) determines}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00459}00459 \textcolor{comment}{    the necessary parameters for the node construction from virtual}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00460}00460 \textcolor{comment}{    functions or internal data that must have been set during}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00461}00461 \textcolor{comment}{    construction of the particular element. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00462}00462 \textcolor{comment}{    \(\backslash\)anchor set\_commands}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00463}00463 \textcolor{comment}{    The spatial dimension of the \(\backslash\)c Node and the number of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00464}00464 \textcolor{comment}{    generalised coordinates must be set in the constructor of a}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00465}00465 \textcolor{comment}{    geometric \(\backslash\)c FiniteElement (level 2 in the element hierarchy) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00466}00466 \textcolor{comment}{    by using the appropriate protected member}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00467}00467 \textcolor{comment}{    functions. The only function that \(\backslash\)b must be called is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00468}00468 \textcolor{comment}{    \(\backslash\)code FiniteElement::set\_dimension(dim), \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00469}00469 \textcolor{comment}{    which sets the spatial dimension of the element; by default the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00470}00470 \textcolor{comment}{    spatial dimension of the \(\backslash\)c FiniteElement's \(\backslash\)c Nodes is assumed}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00471}00471 \textcolor{comment}{    to be the same. For example,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00472}00472 \textcolor{comment}{    \(\backslash\)code FiniteElement::set\_dimension(2) \(\backslash\)endcode sets both the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00473}00473 \textcolor{comment}{    spatial dimension of the element and the spatial dimension of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00474}00474 \textcolor{comment}{    its \(\backslash\)c Nodes to be two. If the nodal dimension is not the same as the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00475}00475 \textcolor{comment}{    dimension of the element the member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00476}00476 \textcolor{comment}{    \(\backslash\)code FiniteElement::set\_nodal\_dimension(dim\_node) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00477}00477 \textcolor{comment}{    should be used to change the value of the nodal dimension. By}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00478}00478 \textcolor{comment}{    default, \(\backslash\)c FiniteElements interpolate a single position type, the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00479}00479 \textcolor{comment}{    position itself. If generalised coordinates are used, the number of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00480}00480 \textcolor{comment}{    generalised coordinates should be set using the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00481}00481 \textcolor{comment}{    \(\backslash\)code FiniteElement::set\_n\_nodal\_position\_type(n\_pos\_type). \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00482}00482 \textcolor{comment}{    The number of values stored at each \(\backslash\)c Node is determined from the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00483}00483 \textcolor{comment}{    virtual member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00484}00484 \textcolor{comment}{    \(\backslash\)code FiniteElement::required\_nvalue(...)  \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00485}00485 \textcolor{comment}{    In its default implementation this function returns zero so the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00486}00486 \textcolor{comment}{    function must be overloaded in specific derived \(\backslash\)c FiniteElements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00487}00487 \textcolor{comment}{    that require storage for some values at its \(\backslash\)c Nodes. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00488}00488 \textcolor{comment}{    }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00489}00489 \textcolor{comment}{    See section \(\backslash\)ref meshes for a full explanation of how }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00490}00490 \textcolor{comment}{    and when \(\backslash\)c Nodes are created.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00491}00491 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00492}00492 \textcolor{comment}{  -\/ The \(\backslash\)c FiniteElement class also defines standard interfaces }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00493}00493 \textcolor{comment}{    for member functions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00494}00494 \textcolor{comment}{    that compute the shape functions and their derivatives with }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00495}00495 \textcolor{comment}{    respect to the local and global (Eulerian) coordinates,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00496}00496 \textcolor{comment}{    \(\backslash\)code FiniteElement::shape(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00497}00497 \textcolor{comment}{    \(\backslash\)code FiniteElement::dshape\_local(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00498}00498 \textcolor{comment}{    The mappings from local to global Eulerian coordinates are}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00499}00499 \textcolor{comment}{    implemented in complete generality in the class. The function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00500}00500 \textcolor{comment}{    \(\backslash\)code  FiniteElement::interpolated\_x(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00501}00501 \textcolor{comment}{    returns the interpolated Eulerian position within the element;}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00502}00502 \textcolor{comment}{    \(\backslash\)code FiniteElement::dshape\_eulerian(...), \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00503}00503 \textcolor{comment}{    returns the derivative of the shape functions with respect}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00504}00504 \textcolor{comment}{    to the Eulerian coordinates; and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00505}00505 \textcolor{comment}{    \(\backslash\)code  FiniteElement::J\_eulerian(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00506}00506 \textcolor{comment}{    returns the Jacobian of the mapping from Eulerian}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00507}00507 \textcolor{comment}{    coordinates to local coordinates.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00508}00508 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00509}00509 \textcolor{comment}{  -\/ The function \(\backslash\)c GeneralisedElement::assign\_local\_eqn\_numbers() }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00510}00510 \textcolor{comment}{    is overloaded in the \(\backslash\)c FiniteElement class to ensure}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00511}00511 \textcolor{comment}{    that local equation numbers are also assigned to the nodal \(\backslash\)c Data}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00512}00512 \textcolor{comment}{    (which does not necessarily exist in all \(\backslash\)c GeneralisedElements). These}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00513}00513 \textcolor{comment}{    local equation numbers are stored in the private array}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00514}00514 \textcolor{comment}{    \(\backslash\)c  FiniteElement::Nodal\_local\_eqn, accessed by the function \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00515}00515 \textcolor{comment}{    \(\backslash\)c FiniteElement::nodal\_local\_eqn(...).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00516}00516 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00517}00517 \textcolor{comment}{ \(\backslash\)subsubsection Geometric\_Element Level 2: Geometric Elements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00518}00518 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00519}00519 \textcolor{comment}{ At this level, we specify the element geometry and the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00520}00520 \textcolor{comment}{ mapping between local and global coordinates. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00521}00521 \textcolor{comment}{ Wherever possible, templating has been (and, for any newly}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00522}00522 \textcolor{comment}{ developed elements, should be) used to formulate the elements }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00523}00523 \textcolor{comment}{ in a dimension-\/independent way. For instance, Lagrange-\/type}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00524}00524 \textcolor{comment}{ 1D line, 2D quad and 3D brick elements are implemented in}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00525}00525 \textcolor{comment}{ the doubly-\/templated \(\backslash\)c QElement<DIM,NNODE\_1D> class.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00526}00526 \textcolor{comment}{ The template parameters indicate the spatial}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00527}00527 \textcolor{comment}{ dimension of the element and the number of nodes }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00528}00528 \textcolor{comment}{ along the element's one-\/dimensional edges. Hence, \(\backslash\)c QElement<1,3>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00529}00529 \textcolor{comment}{ is a three-\/node line element with a quadratic mapping between}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00530}00530 \textcolor{comment}{ local and global coordinates; \(\backslash\)c QElement<3,2> is an 8 node brick element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00531}00531 \textcolor{comment}{ with a trilinear mapping between local and global coordinates. The}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00532}00532 \textcolor{comment}{ dimension and the number of \(\backslash\)c Nodes must be set by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00533}00533 \textcolor{comment}{ calling the appropriate \(\backslash\)c set\_ functions in the constructor, see}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00534}00534 \textcolor{comment}{ \(\backslash\)ref set\_commands "{}above"{}.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00535}00535 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00536}00536 \textcolor{comment}{ The most important member functions implemented at this level}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00537}00537 \textcolor{comment}{ include}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00538}00538 \textcolor{comment}{ -\/ Functions that evaluate the shape functions (and their derivatives) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00539}00539 \textcolor{comment}{   at given values of the local coordinates.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00540}00540 \textcolor{comment}{ -\/ Functions that specify the position of each \(\backslash\)c Node inside}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00541}00541 \textcolor{comment}{   its \(\backslash\)c FiniteElement, in terms of the \(\backslash\)c FiniteElement's local}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00542}00542 \textcolor{comment}{   coordinates and, conversely, functions that determine whether }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00543}00543 \textcolor{comment}{   a \(\backslash\)c Node is located at a particular local coordinate. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00544}00544 \textcolor{comment}{ -\/ Output functions that allow the element shapes to be plotted.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00545}00545 \textcolor{comment}{ .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00546}00546 \textcolor{comment}{ Finally, we specify a pointer to a spatial integration}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00547}00547 \textcolor{comment}{ scheme (usually a Gauss rule). The order of the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00548}00548 \textcolor{comment}{ integration scheme is based on the order of the interpolation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00549}00549 \textcolor{comment}{ in the isoparametric mapping. If this is inappropriate for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00550}00550 \textcolor{comment}{ an element that is derived from a given geometric element, the default }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00551}00551 \textcolor{comment}{ assignment can be over-\/written at a higher level. This is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00552}00552 \textcolor{comment}{ discussed in more detail in a }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00553}00553 \textcolor{comment}{ <A HREF="{}../../optimisation/html/index.html"{}>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00554}00554 \textcolor{comment}{ separate document.</A>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00555}00555 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00556}00556 \textcolor{comment}{ \(\backslash\)subsubsection Maths\_Element Level 3: `The Maths'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00557}00557 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00558}00558 \textcolor{comment}{ At this level, we implement the equations that are represented by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00559}00559 \textcolor{comment}{ the specific element. We implement the interpolation(s) for the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00560}00560 \textcolor{comment}{ unknown function(s),}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00561}00561 \textcolor{comment}{ employing either the geometric shape functions that already exist}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00562}00562 \textcolor{comment}{ on level 2, or employing additional shape functions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00563}00563 \textcolor{comment}{ defined at this level. This allows us to write further member }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00564}00564 \textcolor{comment}{ functions such as \(\backslash\)c interpolated\_u(...), say, which compute }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00565}00565 \textcolor{comment}{ the i-\/th velocity component at the local coordinate \(\backslash\)c s like this}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00566}00566 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00567}00567 \textcolor{comment}{ // Create fluid element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00568}00568 \textcolor{comment}{ SomeFluidElement fluid\_element;}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00569}00569 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00570}00570 \textcolor{comment}{ [...]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00571}00571 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00572}00572 \textcolor{comment}{ // Vector of local coordinates}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00573}00573 \textcolor{comment}{ Vector<double> s(3);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00574}00574 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00575}00575 \textcolor{comment}{ // Vector of velocity components}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00576}00576 \textcolor{comment}{ Vector<double> u(3);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00577}00577 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00578}00578 \textcolor{comment}{ // Compute the velocity at local coordinate s}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00579}00579 \textcolor{comment}{ fluid\_element.interpolated\_u(s,u);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00580}00580 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00581}00581 \textcolor{comment}{ We introduce wrapper functions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00582}00582 \textcolor{comment}{ to access function values, so that we can formulate}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00583}00583 \textcolor{comment}{ "{}The Maths"{} in generic terms. Rather than referring}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00584}00584 \textcolor{comment}{ to the pressure at node \(\backslash\)c n, via}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00585}00585 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00586}00586 \textcolor{comment}{ unsigned n;}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00587}00587 \textcolor{comment}{ double press = Node\_pt[n]-\/>value(3);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00588}00588 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00589}00589 \textcolor{comment}{ (which forces us to remember that in this particular 3D fluid }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00590}00590 \textcolor{comment}{ element, the pressure is stored as the fourth value at all nodes...),}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00591}00591 \textcolor{comment}{ say, we provide an access function \(\backslash\)c p\_fluid(...) which allows us to write}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00592}00592 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00593}00593 \textcolor{comment}{ unsigned n;}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00594}00594 \textcolor{comment}{ double press = fluid\_element.p\_fluid(n);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00595}00595 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00596}00596 \textcolor{comment}{ When writing these wrapper functions, direct access to the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00597}00597 \textcolor{comment}{ nodal values should be avoided to ensure that the element }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00598}00598 \textcolor{comment}{ remains functional in the presence of hanging nodes.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00599}00599 \textcolor{comment}{ Hence, the wrapper functions should make use of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00600}00600 \textcolor{comment}{ \(\backslash\)c Node::value(...) functions as in this example}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00601}00601 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00602}00602 \textcolor{comment}{ double SomeFluidElement::p\_fluid(const unsigned\& n)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00603}00603 \textcolor{comment}{  \{ return Node\_pt[n]-\/>value(3);\}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00604}00604 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00605}00605 \textcolor{comment}{ [See section \(\backslash\)ref Hanging\_Nodes for a full description of hanging nodes.]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00606}00606 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00607}00607 \textcolor{comment}{ The functions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00608}00608 \textcolor{comment}{ \(\backslash\)code FiniteElement::assign\_additional\_local\_eqn\_numbers()  \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00609}00609 \textcolor{comment}{ \(\backslash\)code FiniteElement::get\_residuals(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00610}00610 \textcolor{comment}{ \(\backslash\)code FiniteElement::get\_jacobian(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00611}00611 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00612}00612 \textcolor{comment}{ that were defined (as virtual functions) in \(\backslash\)c FiniteElement }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00613}00613 \textcolor{comment}{ can now be implemented for the specific system of equations that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00614}00614 \textcolor{comment}{ are represented by this element. The function \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00615}00615 \textcolor{comment}{ assign\_additional\_local\_eqn\_numbers() is called by \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00616}00616 \textcolor{comment}{ FiniteElement::assign\_local\_eqn\_numbers() and may be used to assign local}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00617}00617 \textcolor{comment}{ equation numbers that correspond to particular physical}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00618}00618 \textcolor{comment}{ variables. For example, in QCrouzeixRaviart "{}fluid"{} elements, the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00619}00619 \textcolor{comment}{ pressure is stored as 'internal \(\backslash\)c Data', so an internal array \(\backslash\)c P\_local\_eqn}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00620}00620 \textcolor{comment}{ could be defined by }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00621}00621 \textcolor{comment}{ \(\backslash\)code P\_local\_eqn[i] = internal\_local\_eqn(0,i) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00622}00622 \textcolor{comment}{ but in QTaylorHood "{}fluid"{} elements, the pressure is stored as nodal}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00623}00623 \textcolor{comment}{ \(\backslash\)c Data, so that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00624}00624 \textcolor{comment}{ \(\backslash\)code P\_local\_eqn[i] = nodal\_local\_eqn(Pconv[i],DIM+1) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00625}00625 \textcolor{comment}{ In the above, \(\backslash\)c Pconv[i] is an array that returns the local node number}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00626}00626 \textcolor{comment}{ at which the \(\backslash\)c i -\/th pressure freedom is stored and \(\backslash\)c DIM is the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00627}00627 \textcolor{comment}{ dimension of the element. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00628}00628 \textcolor{comment}{ The use of such an array introduces a memory overhead, however,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00629}00629 \textcolor{comment}{ because each element must permanently store these additional}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00630}00630 \textcolor{comment}{ integers. In general, we prefer to use member functions for this}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00631}00631 \textcolor{comment}{ purpose. In QCrouzeixRaviart elements, for example,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00632}00632 \textcolor{comment}{ \(\backslash\)code }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00633}00633 \textcolor{comment}{ int p\_local\_eqn(const unsigned \&n) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00634}00634 \textcolor{comment}{  \{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00635}00635 \textcolor{comment}{   return internal\_local\_eqn(0,n);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00636}00636 \textcolor{comment}{  \}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00637}00637 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00638}00638 \textcolor{comment}{ Thus, in our standard equations the function \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00639}00639 \textcolor{comment}{ assign\_additional\_local\_eqn\_numbers() is not used.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00640}00640 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00641}00641 \textcolor{comment}{ Finally, the virtual function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00642}00642 \textcolor{comment}{ \(\backslash\)code FiniteElement::required\_nvalue(...)  \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00643}00643 \textcolor{comment}{ should be implemented to specify the number of values that }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00644}00644 \textcolor{comment}{ are stored at each of the element's local \(\backslash\)c Nodes. The default }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00645}00645 \textcolor{comment}{ number of values stored at a \(\backslash\)c Node is zero. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00646}00646 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00647}00647 \textcolor{comment}{ \(\backslash\)subsubsection advanced\_features\_of\_elements `Advanced' features for the `Maths' level:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00648}00648 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00649}00649 \textcolor{comment}{ It often makes sense to subdivide the `Maths' level further into}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00650}00650 \textcolor{comment}{ -\/\# A class that contains the abstract FE formulation of the mathematical}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00651}00651 \textcolor{comment}{    problem.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00652}00652 \textcolor{comment}{ -\/\# A class that combines the mathematical formulation with}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00653}00653 \textcolor{comment}{    a specific geometrical element.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00654}00654 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00655}00655 \textcolor{comment}{ An example is given by the \(\backslash\)c QPoissonElements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00656}00656 \textcolor{comment}{ which inherit their maths from \(\backslash\)c PoissonEquations (templated by the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00657}00657 \textcolor{comment}{ spatial dimension) and their geometry from \(\backslash\)c QElement (templated by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00658}00658 \textcolor{comment}{ the spatial dimension and the number of nodes).  \(\backslash\)c PoissonEquations}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00659}00659 \textcolor{comment}{ specifies the weak form of the Poisson equation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00660}00660 \textcolor{comment}{ in terms of (virtual) shape and test functions. The \(\backslash\)c QPoissonElements }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00661}00661 \textcolor{comment}{ turn this abstract formulation into a specific (isoparametric) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00662}00662 \textcolor{comment}{ element, by specifying both test and shape functions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00663}00663 \textcolor{comment}{ as the geometric shape functions defined in \(\backslash\)c QElement.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00664}00664 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00665}00665 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00666}00666 \textcolor{comment}{ \(\backslash\)subsubsection no\_args\_for\_element\_constructors Important convention regarding element constructors}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00667}00667 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00668}00668 \textcolor{comment}{ To facilitate mesh generation and adaptation it is important that element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00669}00669 \textcolor{comment}{ constructors should \(\backslash\)b not have \(\backslash\)b any arguments! If arguments}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00670}00670 \textcolor{comment}{ must be passed to an element (e.g. function pointers to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00671}00671 \textcolor{comment}{ source functions, etc.), this should be done \(\backslash\)b after the mesh }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00672}00672 \textcolor{comment}{ generation, usually in the \(\backslash\)c Problem constructor. In adaptive mesh}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00673}00673 \textcolor{comment}{ refinement procedures any function/data pointers in newly created}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00674}00674 \textcolor{comment}{ elements are set to be the same as those of the father}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00675}00675 \textcolor{comment}{ element. If this is not the desired behaviour, arguments should be}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00676}00676 \textcolor{comment}{ passed to the elements in the function \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00677}00677 \textcolor{comment}{ Problem::actions\_after\_adapt().}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00678}00678 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00679}00679 \textcolor{comment}{ \(\backslash\)subsection meshes Meshes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00680}00680 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00681}00681 \textcolor{comment}{ At its most basic level, a \(\backslash\)c Mesh is simply a collection of elements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00682}00682 \textcolor{comment}{ and \(\backslash\)c Nodes, accessed by the vectors of pointers, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00683}00683 \textcolor{comment}{ \(\backslash\)c Mesh::Element\_pt and \(\backslash\)c Mesh::Node\_pt, respectively. To facilitate }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00684}00684 \textcolor{comment}{ the application of  boundary conditions, we also store vectors of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00685}00685 \textcolor{comment}{ pointers to the (\(\backslash\)c Boundary)\(\backslash\)c Nodes that lie on the boundaries of the mesh. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00686}00686 \textcolor{comment}{ They are accessible via the member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00687}00687 \textcolor{comment}{ \(\backslash\)code Mesh::boundary\_node\_pt(i,j) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00688}00688 \textcolor{comment}{ which returns a pointer to the \(\backslash\)c j -\/th node on the \(\backslash\)c i -\/th}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00689}00689 \textcolor{comment}{ boundary of the mesh.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00690}00690 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00691}00691 \textcolor{comment}{ \(\backslash\)subsubsection Mesh\_generation Mesh generation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00692}00692 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00693}00693 \textcolor{comment}{ The \(\backslash\)c oomph-\/lib data structure is designed to make the mesh generation }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00694}00694 \textcolor{comment}{ process generic so that meshes developed for one }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00695}00695 \textcolor{comment}{ particular problem can easily be re-\/used in others. For this reason, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00696}00696 \textcolor{comment}{ it is generally assumed that a \(\backslash\)c Mesh contains only elements of a }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00697}00697 \textcolor{comment}{ single type and that this element type is passed to the \(\backslash\)c Mesh }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00698}00698 \textcolor{comment}{ constructor as a template parameter. Problems that require }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00699}00699 \textcolor{comment}{ multiple element types should use multiple meshes,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00700}00700 \textcolor{comment}{ which are discussed in more detail below. It is possible to mix types}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00701}00701 \textcolor{comment}{ of elements within a single \(\backslash\)c Mesh, if desired; this can}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00702}00702 \textcolor{comment}{ be advantageous when the element types are very closely related, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00703}00703 \textcolor{comment}{ for example "{}free surface"{} elements in a mesh of "{}Fluid"{} elements.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00704}00704 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00705}00705 \textcolor{comment}{ Mesh generation (usually performed in the \(\backslash\)c Mesh 's constructor) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00706}00706 \textcolor{comment}{ then works as follows:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00707}00707 \textcolor{comment}{ -\/\# Create the first element and add the pointer to it to the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00708}00708 \textcolor{comment}{    \(\backslash\)c Mesh::Element\_pt vector. (We know which element to build }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00709}00709 \textcolor{comment}{    because we have passed its type as a template parameter.)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00710}00710 \textcolor{comment}{    Since element constructors do not take any }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00711}00711 \textcolor{comment}{    arguments, this step is completely generic }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00712}00712 \textcolor{comment}{    and ensures that a \(\backslash\)c Mesh that was originally}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00713}00713 \textcolor{comment}{    created to solve a Poisson equation, say, can also be used to solve}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00714}00714 \textcolor{comment}{    Navier-\/Stokes equations (provided the element topology}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00715}00715 \textcolor{comment}{    is the same, i.e. provided the elements are derived from the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00716}00716 \textcolor{comment}{    same type of geometric element (e.g. quad or triangle). }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00717}00717 \textcolor{comment}{    The element now exists but does not know anything about its }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00718}00718 \textcolor{comment}{    \(\backslash\)c Nodes etc.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00719}00719 \textcolor{comment}{ -\/\# Loop over the element's \(\backslash\)c Nodes and for each Node:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00720}00720 \textcolor{comment}{    -\/\# Create the \(\backslash\)c Node using}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00721}00721 \textcolor{comment}{       the element's \(\backslash\)code FiniteElement::construct\_node(...) \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00722}00722 \textcolor{comment}{       member function. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00723}00723 \textcolor{comment}{       As discussed above, this function creates \(\backslash\)c Nodes of exactly the right}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00724}00724 \textcolor{comment}{       type and fills in the  element's own \(\backslash\)c Node\_pt vector.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00725}00725 \textcolor{comment}{    -\/\# \(\backslash\)c FiniteElement::construct\_node(...) returns a pointer to the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00726}00726 \textcolor{comment}{       newly created \(\backslash\)c Node; add this to the \(\backslash\)c Mesh::Node\_pt vector.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00727}00727 \textcolor{comment}{    -\/\# Assign the nodal coordinates.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00728}00728 \textcolor{comment}{    .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00729}00729 \textcolor{comment}{    The \(\backslash\)c Node is now fully functional and (by default) all values}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00730}00730 \textcolor{comment}{    that are stored with it are free (i.e. not pinned). }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00731}00731 \textcolor{comment}{ -\/\# If the \(\backslash\)c Node is located on a mesh boundary then it must be a}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00732}00732 \textcolor{comment}{    \(\backslash\)c BoundaryNode. \(\backslash\)c BoundaryNodes can be created using the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00733}00733 \textcolor{comment}{    \(\backslash\)code FiniteElement::construct\_boundary\_node(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00734}00734 \textcolor{comment}{    in place of \(\backslash\)c FiniteElement::construct\_node(...).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00735}00735 \textcolor{comment}{    Alternatively, if the \(\backslash\)c Node has already been created, it can }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00736}00736 \textcolor{comment}{    be upgraded to a \(\backslash\)c BoundaryNode by using the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00737}00737 \textcolor{comment}{    \(\backslash\)code Mesh::convert\_to\_boundary\_node(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00738}00738 \textcolor{comment}{    The function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00739}00739 \textcolor{comment}{    \(\backslash\)code Mesh::add\_boundary\_node(i,\&node) \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00740}00740 \textcolor{comment}{    should then be used to add (a pointer to) the \(\backslash\)c BoundaryNode to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00741}00741 \textcolor{comment}{    the \(\backslash\)c Mesh's boundary-\/storage scheme.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00742}00742 \textcolor{comment}{    In addition, the function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00743}00743 \textcolor{comment}{    \(\backslash\)c Mesh::add\_boundary\_node() passes boundary}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00744}00744 \textcolor{comment}{    information to the \(\backslash\)c Node itself.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00745}00745 \textcolor{comment}{ -\/\# Create the next element and loop over its \(\backslash\)c Nodes. Some \(\backslash\)c Nodes will}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00746}00746 \textcolor{comment}{    already exist (because they have been created by the first }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00747}00747 \textcolor{comment}{    element).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00748}00748 \textcolor{comment}{    For such \(\backslash\)c Nodes, we merely add the pointer to the existing \(\backslash\)c Nodes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00749}00749 \textcolor{comment}{    to the element's \(\backslash\)c Node\_pt vector. If a \(\backslash\)c Node does not }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00750}00750 \textcolor{comment}{    exist yet, we create it, as discussed above.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00751}00751 \textcolor{comment}{ -\/\# Keep going until all the elements and \(\backslash\)c Nodes have been built.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00752}00752 \textcolor{comment}{  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00753}00753 \textcolor{comment}{ \(\backslash\)subsubsection Node\_DOF\_numbering Equation/DOF numbering at the mesh level}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00754}00754 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00755}00755 \textcolor{comment}{ Now that the \(\backslash\)c Mesh is assembled, we can set up the numbering scheme for }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00756}00756 \textcolor{comment}{ the unknowns that are associated with the \(\backslash\)c Nodes and with the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00757}00757 \textcolor{comment}{ elements' `internal \(\backslash\)c Data '. (For problems that }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00758}00758 \textcolor{comment}{ involve `external \(\backslash\)c Data ', i.e. \(\backslash\)c Data that is not associated with }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00759}00759 \textcolor{comment}{ \(\backslash\)c Nodes and elements, a further step is required; see section \(\backslash\)ref problems }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00760}00760 \textcolor{comment}{ below). }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00761}00761 \textcolor{comment}{ As discussed above, whenever a \(\backslash\)c Data object is created (either }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00762}00762 \textcolor{comment}{ as part of a \(\backslash\)c Node in the mesh or as `internal \(\backslash\)c Data ' inside an }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00763}00763 \textcolor{comment}{ element), its values are assumed to be free (i.e. not pinned).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00764}00764 \textcolor{comment}{ Before we can set up the equation numbering scheme, we must}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00765}00765 \textcolor{comment}{ pin all those \(\backslash\)c Data values that are prescribed by boundary}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00766}00766 \textcolor{comment}{ conditions. This is generally done at the \(\backslash\)c Problem level (see below) and for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00767}00767 \textcolor{comment}{ the subsequent discussion, we assume that this step has already taken}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00768}00768 \textcolor{comment}{ place.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00769}00769 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00770}00770 \textcolor{comment}{ The equation numbering scheme must achieve two}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00771}00771 \textcolor{comment}{ things:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00772}00772 \textcolor{comment}{ -\/ Every unknown value needs to be associated with a unique, non-\/negative}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00773}00773 \textcolor{comment}{   global equation number.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00774}00774 \textcolor{comment}{ -\/ All elements need to set up the lookup tables that establish}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00775}00775 \textcolor{comment}{   the relation between local and global equation numbers.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00776}00776 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00777}00777 \textcolor{comment}{ These tasks are performed in two steps. The function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00778}00778 \textcolor{comment}{ \(\backslash\)code Mesh::assign\_global\_eqn\_numbers(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00779}00779 \textcolor{comment}{ whose argument is a vector of pointers to doubles, \(\backslash\)c dof\_pt,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00780}00780 \textcolor{comment}{ assigns the (global) equation numbers for the element's internal \(\backslash\)c Data }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00781}00781 \textcolor{comment}{ and for all \(\backslash\)c Data associated with the \(\backslash\)c Mesh's \(\backslash\)c Nodes.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00782}00782 \textcolor{comment}{ On return from this function, \(\backslash\)c dof\_pt[i] points to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00783}00783 \textcolor{comment}{ the value of the i-\/th global degree of freedom.  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00784}00784 \textcolor{comment}{ The setup scheme (which is fully implemented in \(\backslash\)c oomph-\/lib) works }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00785}00785 \textcolor{comment}{ as follows:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00786}00786 \textcolor{comment}{ -\/\# Loop over all \(\backslash\)c Nodes in the \(\backslash\)c Mesh.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00787}00787 \textcolor{comment}{    -\/ Loop over all values that are stored at that \(\backslash\)c Node.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00788}00788 \textcolor{comment}{      -\/ If the value is free (i.e. not pinned), add the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00789}00789 \textcolor{comment}{        pointer to the value to the \(\backslash\)c dof\_pt vector.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00790}00790 \textcolor{comment}{ -\/\# Loop over all elements.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00791}00791 \textcolor{comment}{    -\/ In every element, loop over the `internal \(\backslash\)c Data '}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00792}00792 \textcolor{comment}{      -\/ For every instance of `internal \(\backslash\)c Data ', loop over its values.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00793}00793 \textcolor{comment}{        -\/ If the value is free (i.e. not pinned), add}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00794}00794 \textcolor{comment}{          pointer to the value to the \(\backslash\)c dof\_pt vector.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00795}00795 \textcolor{comment}{        .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00796}00796 \textcolor{comment}{      .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00797}00797 \textcolor{comment}{    .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00798}00798 \textcolor{comment}{ .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00799}00799 \textcolor{comment}{ Once this has been done (for all \(\backslash\)c Meshes, if there are multiple ones),}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00800}00800 \textcolor{comment}{ the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00801}00801 \textcolor{comment}{ \(\backslash\)code Mesh::assign\_local\_eqn\_numbers(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00802}00802 \textcolor{comment}{ loops over all elements and executes their}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00803}00803 \textcolor{comment}{ \(\backslash\)code FiniteElement::assign\_local\_eqn\_numbers(); \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00804}00804 \textcolor{comment}{ member function to set up the elements' lookup table that translates}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00805}00805 \textcolor{comment}{ between local and global equation numbers.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00806}00806 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00807}00807 \textcolor{comment}{ \(\backslash\)subsection problems Problems}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00808}00808 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00809}00809 \textcolor{comment}{ Finally, we reach the highest level of the \(\backslash\)c oomph-\/lib hierarchy, the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00810}00810 \textcolor{comment}{ \(\backslash\)c Problem itself. The generic components of \(\backslash\)c Problem, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00811}00811 \textcolor{comment}{ provided in the base class of that name, are:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00812}00812 \textcolor{comment}{ -\/ A pointer to the global \(\backslash\)c Mesh (which can represent a number of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00813}00813 \textcolor{comment}{   submeshes, see below).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00814}00814 \textcolor{comment}{ -\/ A pointer to the (discrete) \(\backslash\)c Time (see section on \(\backslash\)ref timestepping).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00815}00815 \textcolor{comment}{ -\/ A vector of pointers to (possibly multiple) \(\backslash\)c TimeSteppers.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00816}00816 \textcolor{comment}{ -\/ A vector that holds pointers to any `global \(\backslash\)c Data ', i.e. \(\backslash\)c Data }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00817}00817 \textcolor{comment}{   that is not associated with elements or \(\backslash\)c Nodes. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00818}00818 \textcolor{comment}{ -\/ A vector \(\backslash\)c Dof\_pt that stores the pointers to all the unknown }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00819}00819 \textcolor{comment}{   values (the degrees of freedom) in the problem. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00820}00820 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00821}00821 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00822}00822 \textcolor{comment}{ \(\backslash\)b Multiple \(\backslash\)b Meshes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00823}00823 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00824}00824 \textcolor{comment}{  The mesh generation process previously described was for meshes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00825}00825 \textcolor{comment}{ that contain only elements of a single type. The process }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00826}00826 \textcolor{comment}{ could easily be generalised to meshes that contain multiple element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00827}00827 \textcolor{comment}{ types by providing multiple template parameters.  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00828}00828 \textcolor{comment}{ When solving a fluid-\/structure interaction (FSI)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00829}00829 \textcolor{comment}{ problem we could, therefore, create a single mesh that discretises }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00830}00830 \textcolor{comment}{ both the fluid and the solid domains with appropriate elements.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00831}00831 \textcolor{comment}{ However, to facilitate code re-\/use it is desirable to keep meshes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00832}00832 \textcolor{comment}{ as simple as possible so that a mesh that was originally}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00833}00833 \textcolor{comment}{ developed for a pure fluids problem can also be used in an FSI }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00834}00834 \textcolor{comment}{ context. For this reason, the \(\backslash\)c Problem class }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00835}00835 \textcolor{comment}{ allows a problem to have multiple (sub-\/)meshes. Pointers to each}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00836}00836 \textcolor{comment}{ sub-\/mesh must be stored in Problem's \(\backslash\)c Sub\_mesh\_pt vector by using}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00837}00837 \textcolor{comment}{ the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00838}00838 \textcolor{comment}{ \(\backslash\)code Problem::add\_sub\_mesh(Mesh* const \&mesh\_pt) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00839}00839 \textcolor{comment}{ However, many of the generic operations within \(\backslash\)c oomph-\/lib }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00840}00840 \textcolor{comment}{ (equation numbering,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00841}00841 \textcolor{comment}{ solving, output of solutions,...) involve looping over \(\backslash\)b all elements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00842}00842 \textcolor{comment}{ and \(\backslash\)c Nodes in the problem. Therefore, if a \(\backslash\)c Problem contains multiple }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00843}00843 \textcolor{comment}{ (sub-\/)meshes, the sub-\/meshes must be combined into a single}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00844}00844 \textcolor{comment}{ global \(\backslash\)c Mesh whose \(\backslash\)c Element\_pt and \(\backslash\)c Node\_pt vectors}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00845}00845 \textcolor{comment}{ provide ordered access to the elements and \(\backslash\)c Nodes in \(\backslash\)b all}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00846}00846 \textcolor{comment}{ submeshes. The function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00847}00847 \textcolor{comment}{ \(\backslash\)code Problem::build\_global\_mesh() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00848}00848 \textcolor{comment}{ combines the sub-\/meshes into the global \(\backslash\)c Mesh and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00849}00849 \textcolor{comment}{ must be called once all the sub-\/meshes have been}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00850}00850 \textcolor{comment}{ constructed and "{}added"{} to the \(\backslash\)c Problem.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00851}00851 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00852}00852 \textcolor{comment}{ \(\backslash\)b Important: Many operations (such as the shifting of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00853}00853 \textcolor{comment}{ history values in time-\/stepping) must be performed exactly}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00854}00854 \textcolor{comment}{ once for each \(\backslash\)c Node (or \(\backslash\)c Data). Therefore, the vector of (pointers to) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00855}00855 \textcolor{comment}{ nodes in the global \(\backslash\)c Mesh must not contain any duplicate entries. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00856}00856 \textcolor{comment}{ When copying (pointer to) \(\backslash\)c Nodes from the submeshes into the global }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00857}00857 \textcolor{comment}{ \(\backslash\)c Mesh, the function \(\backslash\)c Problem::build\_global\_mesh() ignores}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00858}00858 \textcolor{comment}{ any \(\backslash\)c Nodes that have already been copied from a previous submesh.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00859}00859 \textcolor{comment}{ [The \(\backslash\)c Mesh::self\_test()}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00860}00860 \textcolor{comment}{ function checks for duplicates in the \(\backslash\)c Mesh::Node\_pt vector.]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00861}00861 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00862}00862 \textcolor{comment}{ \(\backslash\)b Convention: Recall that (\(\backslash\)c Boundary)Nodes are `told' about the number}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00863}00863 \textcolor{comment}{ of the boundary they live on when the (sub-\/)meshes are constructed.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00864}00864 \textcolor{comment}{ In the context of multiple meshes, this raises the question}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00865}00865 \textcolor{comment}{ if this number should continue to refer to the boundary number within}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00866}00866 \textcolor{comment}{ the submesh or be updated to a boundary number within the global \(\backslash\)c Mesh.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00867}00867 \textcolor{comment}{ We adopt the convention that boundary numbers remain those that were }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00868}00868 \textcolor{comment}{ originally assigned when the submeshes were constructed.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00869}00869 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00870}00870 \textcolor{comment}{ \(\backslash\)b Multiple \(\backslash\)b meshes \(\backslash\)b and \(\backslash\)b adaptivity:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00871}00871 \textcolor{comment}{ Mesh adaptation is performed separately for each submesh. Following the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00872}00872 \textcolor{comment}{ adaptation of one or more submeshes (in the process of which various}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00873}00873 \textcolor{comment}{ \(\backslash\)c Nodes/elements will have been created/deleted), we must also update}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00874}00874 \textcolor{comment}{ the global \(\backslash\)c Mesh. This is done by calling}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00875}00875 \textcolor{comment}{ \(\backslash\)code  Problem::rebuild\_global\_mesh(); \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00876}00876 \textcolor{comment}{ and this function is executed automatically if the mesh }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00877}00877 \textcolor{comment}{ adaptation/refinement is performed by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00878}00878 \textcolor{comment}{ \(\backslash\)code  Problem::refine\_uniformly(); \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00879}00879 \textcolor{comment}{ or}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00880}00880 \textcolor{comment}{ \(\backslash\)code  Problem::adapt(); \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00881}00881 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00882}00882 \textcolor{comment}{ \(\backslash\)subsubsection prob\_setup Problem Construction}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00883}00883 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00884}00884 \textcolor{comment}{ Here's an overview of how \(\backslash\)c Problems are set up and solved in \(\backslash\)c oomph-\/lib. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00885}00885 \textcolor{comment}{ For simplicity, we illustrate the process for a problem with }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00886}00886 \textcolor{comment}{ a single \(\backslash\)c Mesh that contains elements of a single type.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00887}00887 \textcolor{comment}{ -\/\# Define the element type and the \(\backslash\)c TimeStepper (if the problem}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00888}00888 \textcolor{comment}{    is time-\/dependent).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00889}00889 \textcolor{comment}{ -\/\# Build the \(\backslash\)c Mesh, passing the element type as a template parameter}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00890}00890 \textcolor{comment}{    and the \(\backslash\)c TimeStepper as an argument to the Mesh constructor.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00891}00891 \textcolor{comment}{    (Typically \(\backslash\)c Mesh constructors take a pointer to a \(\backslash\)c TimeStepper}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00892}00892 \textcolor{comment}{    as an argument since the \(\backslash\)c TimeStepper needs to be passed}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00893}00893 \textcolor{comment}{    to the element's \(\backslash\)c FiniteElement::construct\_node(...) function.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00894}00894 \textcolor{comment}{    If the \(\backslash\)c Problem has no time-\/dependence, we can pass a pointer to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00895}00895 \textcolor{comment}{    the static \(\backslash\)c Mesh::Steady timestepper; many \(\backslash\)c Mesh constructors}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00896}00896 \textcolor{comment}{    use a pointer to this \(\backslash\)c TimeStepper as the default argument). }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00897}00897 \textcolor{comment}{ -\/\# Create the \(\backslash\)c Problem 's global \(\backslash\)c Data (if it has any).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00898}00898 \textcolor{comment}{ -\/\# Apply the essential boundary conditions by pinning }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00899}00899 \textcolor{comment}{    the appropriate values; all other values remain free.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00900}00900 \textcolor{comment}{ -\/\# We now have a fully assembled \(\backslash\)c Mesh and all elements know}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00901}00901 \textcolor{comment}{    their constituent \(\backslash\)c Nodes. However, because element constructors}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00902}00902 \textcolor{comment}{    are not allowed to have any arguments, all but the simplest of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00903}00903 \textcolor{comment}{    elements will now have to be provided with additional information.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00904}00904 \textcolor{comment}{    For instance, we might need to set pointers to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00905}00905 \textcolor{comment}{    source functions, etc. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00906}00906 \textcolor{comment}{ -\/\# Assign the equation numbers to all unknowns in the problem.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00907}00907 \textcolor{comment}{    This is accomplished in a two-\/stage process by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00908}00908 \textcolor{comment}{    \(\backslash\)code Problem::assign\_eqn\_numbers(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00909}00909 \textcolor{comment}{    which }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00910}00910 \textcolor{comment}{    -\/\# Assigns the equation numbers for all global \(\backslash\)c Data (if any)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00911}00911 \textcolor{comment}{    -\/\# Loops over the submeshes to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00912}00912 \textcolor{comment}{       perform the global equation numbering for all values associated}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00913}00913 \textcolor{comment}{       with the \(\backslash\)c Meshes (i.e. \(\backslash\)c Nodes and elements), using   }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00914}00914 \textcolor{comment}{      \(\backslash\)code Mesh::assign\_global\_eqn\_numbers(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00915}00915 \textcolor{comment}{    -\/\# Loops over the submeshes again to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00916}00916 \textcolor{comment}{       perform the local equation numbering for all elements associated}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00917}00917 \textcolor{comment}{       with the meshes using   }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00918}00918 \textcolor{comment}{      \(\backslash\)code Mesh::assign\_local\_eqn\_numbers(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00919}00919 \textcolor{comment}{    .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00920}00920 \textcolor{comment}{    [Note that we have to assign the global equation numbers for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00921}00921 \textcolor{comment}{    all meshes before we assign any local equation numbers. This is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00922}00922 \textcolor{comment}{    because the external \(\backslash\)c Data of elements in one mesh might be}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00923}00923 \textcolor{comment}{    nodal \(\backslash\)c Data}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00924}00924 \textcolor{comment}{    in another mesh -\/-\/ think of fluid-\/structure interaction problems].}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00925}00925 \textcolor{comment}{    At the end of this step, we will have filled in the \(\backslash\)c Problem's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00926}00926 \textcolor{comment}{    \(\backslash\)c Dof\_pt vector which holds the pointers to the unknowns. [Note:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00927}00927 \textcolor{comment}{    The equation numbering scheme that is generated by the above procedure}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00928}00928 \textcolor{comment}{    is unlikely to be optimal; it can (and in the interest of efficiency}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00929}00929 \textcolor{comment}{    probably should) be changed afterwards }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00930}00930 \textcolor{comment}{    by a problem-\/specific renumbering function.]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00931}00931 \textcolor{comment}{ -\/\# Before we can solve the \(\backslash\)c Problem we will usually have to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00932}00932 \textcolor{comment}{    perform a few additional (problem-\/dependent) initialisation steps.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00933}00933 \textcolor{comment}{    For instance, we might want to assign initial and/or boundary }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00934}00934 \textcolor{comment}{    conditions and provide initial guesses for the unknowns.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00935}00935 \textcolor{comment}{    For time-\/dependent problems, the \(\backslash\)c Problem class provides a member }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00936}00936 \textcolor{comment}{    function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00937}00937 \textcolor{comment}{    \(\backslash\)code Problem::assign\_initial\_values\_impulsive() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00938}00938 \textcolor{comment}{    which creates a past history for all time-\/dependent}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00939}00939 \textcolor{comment}{    unknowns, assuming an impulsive start. If you want a `smooth'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00940}00940 \textcolor{comment}{    start from a given previous time-\/history, you will have to implement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00941}00941 \textcolor{comment}{    this yourself; in this case, consult the section }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00942}00942 \textcolor{comment}{    \(\backslash\)ref timestepping which outlines the time-\/stepping procedures }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00943}00943 \textcolor{comment}{    in \(\backslash\)c oomph-\/lib.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00944}00944 \textcolor{comment}{ -\/\# Now we can solve the \(\backslash\)c Problem by calling }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00945}00945 \textcolor{comment}{    \(\backslash\)code Problem::newton\_solve() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00946}00946 \textcolor{comment}{    which employs the Newton-\/Raphson method to solve the nonlinear system}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00947}00947 \textcolor{comment}{    of equations that is specified (formally) by the global Jacobian matrix}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00948}00948 \textcolor{comment}{    and the global residual vectors. The function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00949}00949 \textcolor{comment}{    \(\backslash\)c Problem::newton\_solve() }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00950}00950 \textcolor{comment}{    employs a linear solver which may be specified by }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00951}00951 \textcolor{comment}{    \(\backslash\)c Problem::linear\_solver\_pt(). The default linear solver is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00952}00952 \textcolor{comment}{    <a href="{}http://crd.lbl.gov/\string~xiaoye/SuperLU/"{}> SuperLU </a>.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00953}00953 \textcolor{comment}{    The Newton iteration proceeds}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00954}00954 \textcolor{comment}{    until the maximum residual falls below }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00955}00955 \textcolor{comment}{    \(\backslash\)c Problem::Newton\_solver\_tolerance. [If the number of iterations}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00956}00956 \textcolor{comment}{    exceeds \(\backslash\)c Problem::Max\_newton\_iterations or if the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00957}00957 \textcolor{comment}{    the maximum residual exceeds \(\backslash\)c Problem::Max\_residuals, the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00958}00958 \textcolor{comment}{    Newton solver throws an error]. When a solution has been found, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00959}00959 \textcolor{comment}{    all unknowns in the problem (which are accessible to the \(\backslash\)c Problem via}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00960}00960 \textcolor{comment}{    its \(\backslash\)c Dof\_pt vector) are up-\/to-\/date. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00961}00961 \textcolor{comment}{    The \(\backslash\)c Problem class also provides the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00962}00962 \textcolor{comment}{    \(\backslash\)code Problem::unsteady\_newton\_solve(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00963}00963 \textcolor{comment}{    for time-\/dependent problems. Given the current values of the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00964}00964 \textcolor{comment}{    unknowns (at time \(\backslash\)c t = \(\backslash\)c Problem::Time\_pt-\/>time() ) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00965}00965 \textcolor{comment}{    and their past histories, this function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00966}00966 \textcolor{comment}{    determines the solution at the advanced time \(\backslash\)c t+dt. See }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00967}00967 \textcolor{comment}{    section \(\backslash\)ref timestepping  for more details on the conventions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00968}00968 \textcolor{comment}{    used in timestepping.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00969}00969 \textcolor{comment}{ .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00970}00970 \textcolor{comment}{ The \(\backslash\)c Problem class also has member functions which assemble the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00971}00971 \textcolor{comment}{ global residual vector and the global Jacobian matrix.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00972}00972 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00973}00973 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00974}00974 \textcolor{comment}{ \(\backslash\)b Important: \(\backslash\)n \(\backslash\)n Since the unknowns in the \(\backslash\)c Problem are accessed}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00975}00975 \textcolor{comment}{ directly via pointers, their values are automatically updated}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00976}00976 \textcolor{comment}{ during the Newton iteration. If the \(\backslash\)c Problem has any auxiliary}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00977}00977 \textcolor{comment}{ parameters that depend on the unknowns, their values need}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00978}00978 \textcolor{comment}{ to be updated whenever an unknown might have changed (i.e.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00979}00979 \textcolor{comment}{ after every step of the Newton iteration).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00980}00980 \textcolor{comment}{ For such cases, the \(\backslash\)c Problem class provides the four (empty) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00981}00981 \textcolor{comment}{ virtual functions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00982}00982 \textcolor{comment}{ \(\backslash\)code Problem::actions\_before\_newton\_step() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00983}00983 \textcolor{comment}{ \(\backslash\)code Problem::actions\_after\_newton\_step() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00984}00984 \textcolor{comment}{ \(\backslash\)code Problem::actions\_before\_newton\_solve() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00985}00985 \textcolor{comment}{ and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00986}00986 \textcolor{comment}{ \(\backslash\)code Problem::actions\_after\_newton\_solve() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00987}00987 \textcolor{comment}{ which are executed before/after every step of the Newton iteration}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00988}00988 \textcolor{comment}{ and before/after the nonlinear solve itself, respectively. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00989}00989 \textcolor{comment}{ In addition, the virtual function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00990}00990 \textcolor{comment}{ \(\backslash\)code Problem::actions\_before\_newton\_convergence\_check() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00991}00991 \textcolor{comment}{ is executed before the residuals are calculated in the Newton solver.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00992}00992 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00993}00993 \textcolor{comment}{ When you  formulate your own \(\backslash\)c Problem, you will have to decide what }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00994}00994 \textcolor{comment}{ (if anything)  should live in these functions. Typical examples of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00995}00995 \textcolor{comment}{ actions that should}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00996}00996 \textcolor{comment}{ be taken before a solve are the update of any boundary conditions. If}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00997}00997 \textcolor{comment}{ the boundary conditions depend upon variables in the problem, they must}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00998}00998 \textcolor{comment}{ be updated before every Newton step and should therefore be placed in}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l00999}00999 \textcolor{comment}{ \(\backslash\)c Problem::actions\_before\_newton\_step(). Actions that take }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01000}01000 \textcolor{comment}{ place after a Newton step}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01001}01001 \textcolor{comment}{ or solve would include things like updating the nodal positions,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01002}01002 \textcolor{comment}{ writing output or any other}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01003}01003 \textcolor{comment}{ post-\/processing/solution monitoring. For }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01004}01004 \textcolor{comment}{ example, if the solution after each Newton step were to be documented}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01005}01005 \textcolor{comment}{ this could be accomplished by calling a suitable output function in the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01006}01006 \textcolor{comment}{ \(\backslash\)c Problem::actions\_after\_newton\_step() function. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01007}01007 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01008}01008 \textcolor{comment}{ In many cases, only the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01009}01009 \textcolor{comment}{ \(\backslash\)c Problem::actions\_before\_newton\_convergence\_check() function is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01010}01010 \textcolor{comment}{ required. On entry to the Newton solver, the initial residuals are}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01011}01011 \textcolor{comment}{ computed and checked, so the function is executed \(\backslash\)b before any Newton steps}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01012}01012 \textcolor{comment}{ are taken. After each Newton step, the residuals}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01013}01013 \textcolor{comment}{ vector is recomputed and checked, so the function is also called}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01014}01014 \textcolor{comment}{ after every Newton step (or before the next Newton}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01015}01015 \textcolor{comment}{ step). Nonetheless, we provide all five functions for the greatest}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01016}01016 \textcolor{comment}{ possible flexibility.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01017}01017 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01018}01018 \textcolor{comment}{ \(\backslash\)section timestepping Time-\/stepping }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01019}01019 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01020}01020 \textcolor{comment}{ \(\backslash\)subsection time Time}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01021}01021 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01022}01022 \textcolor{comment}{ Time-\/derivatives are generally evaluated by finite difference}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01023}01023 \textcolor{comment}{ expressions, e.g. by BDF schemes. Hence, within the code, functions are}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01024}01024 \textcolor{comment}{ only ever evaluated at discrete time levels. The class \(\backslash\)c Time contains }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01025}01025 \textcolor{comment}{ (a pointer to) the `current' value of the continuous time and a }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01026}01026 \textcolor{comment}{ vector of current and previous timesteps so that the value of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01027}01027 \textcolor{comment}{ continuous time at any previous timestep can easily be reconstructed. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01028}01028 \textcolor{comment}{ This is useful/necessary if there are any explicitly time-\/dependent }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01029}01029 \textcolor{comment}{ parameters in the problem. The general convention within all timestepping}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01030}01030 \textcolor{comment}{ procedures is to associate the values at the `present' time (i.e. the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01031}01031 \textcolor{comment}{ time for which a solution is sought)  with time level `0',}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01032}01032 \textcolor{comment}{ those at the previous time level (where the solution is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01033}01033 \textcolor{comment}{ already known) with time levels `1', `2' etc. The function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01034}01034 \textcolor{comment}{ \(\backslash\)code Time::time(t) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01035}01035 \textcolor{comment}{ therefore returns the `current' value of the continuous time if t=0,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01036}01036 \textcolor{comment}{ the continuous time before the previous timestep if t=1, etc.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01037}01037 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01038}01038 \textcolor{comment}{ \(\backslash\)subsection basic\_timestepping Basic Time-\/stepping}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01039}01039 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01040}01040 \textcolor{comment}{ The base class \(\backslash\)c TimeStepper provides the basic functionality }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01041}01041 \textcolor{comment}{ required to evaluate time derivatives, and to keep track of the time }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01042}01042 \textcolor{comment}{ histories of the unknowns. Primarily, a \(\backslash\)c TimeStepper stores the coefficients}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01043}01043 \textcolor{comment}{ (weights) that allow the evaluation of time-\/derivatives (up to a certain}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01044}01044 \textcolor{comment}{ order) in terms of the history values stored in \(\backslash\)c Data. Synchronisation of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01045}01045 \textcolor{comment}{ multiple \(\backslash\)c TimeStepper s is ensured by providing them with pointers to the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01046}01046 \textcolor{comment}{ \(\backslash\)c Problem's (single) \(\backslash\)c Time object. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01047}01047 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01048}01048 \textcolor{comment}{ Here's an illustration of the time-\/stepping procedure for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01049}01049 \textcolor{comment}{ an implicit scheme. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01050}01050 \textcolor{comment}{ -\/ \(\backslash\)b Stage \(\backslash\)b 1: \(\backslash\)b Initialise}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01051}01051 \textcolor{comment}{   -\/\# Add a \(\backslash\)c TimeStepper to the \(\backslash\)c Problem. If a \(\backslash\)c Time object has }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01052}01052 \textcolor{comment}{      not yet been}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01053}01053 \textcolor{comment}{      created, the \(\backslash\)c Problem::add\_time\_stepper\_pt(...) function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01054}01054 \textcolor{comment}{      creates one with the necessary storage. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01055}01055 \textcolor{comment}{      If the \(\backslash\)c Time object already exists and the new \(\backslash\)c TimeStepper }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01056}01056 \textcolor{comment}{      requires more storage than presently exists,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01057}01057 \textcolor{comment}{      the storage in the \(\backslash\)c Time object is resized. The function also passes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01058}01058 \textcolor{comment}{      a pointer to the global \(\backslash\)c Time object to each \(\backslash\)c TimeStepper.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01059}01059 \textcolor{comment}{   -\/\# Set up the \(\backslash\)c Problem as discussed in section \(\backslash\)ref problems }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01060}01060 \textcolor{comment}{   -\/\# Initialise the history of the previous timesteps by calling}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01061}01061 \textcolor{comment}{      \(\backslash\)c Problem::initialise\_dt(...).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01062}01062 \textcolor{comment}{   -\/\# Provide initial values for all unknowns. \(\backslash\)b Note: In many cases,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01063}01063 \textcolor{comment}{      the initial values may be the result of a steady calculation. The}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01064}01064 \textcolor{comment}{      function \(\backslash\)c Problem::steady\_newton\_solve() should be used to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01065}01065 \textcolor{comment}{      calculate these values. The function sets the weights of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01066}01066 \textcolor{comment}{      the time-\/stepping scheme such that the time derivatives are zero}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01067}01067 \textcolor{comment}{      and a steady problem is solved, even when the \(\backslash\)c Problem's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01068}01068 \textcolor{comment}{      \(\backslash\)c TimeStepper is not the dummy timestepper, \(\backslash\)c Steady.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01069}01069 \textcolor{comment}{   -\/\# Provide time histories for the values (pinned \(\backslash\)e and free!),}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01070}01070 \textcolor{comment}{      either by imposing an impulsive start or by setting history}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01071}01071 \textcolor{comment}{      values according to some given time-\/dependence:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01072}01072 \textcolor{comment}{      When generating the initial time history for the values}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01073}01073 \textcolor{comment}{      from a given (`exact') solution, assign the current values and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01074}01074 \textcolor{comment}{      the history values so that the solution is represented correctly}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01075}01075 \textcolor{comment}{      at the initial time, \(\backslash\)c Time::time(). At the end of this stage,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01076}01076 \textcolor{comment}{      \(\backslash\)c Data::value(...) must return the current values and  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01077}01077 \textcolor{comment}{      \(\backslash\)c TimeStepper::time\_derivative(...) must return their}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01078}01078 \textcolor{comment}{      time-\/derivatives at the initial time.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01079}01079 \textcolor{comment}{ -\/ \(\backslash\)b Stage \(\backslash\)b 2: \(\backslash\)b Perform \(\backslash\)b one \(\backslash\)b timestep: }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01080}01080 \textcolor{comment}{    \(\backslash\)n A timestep is performed by using the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01081}01081 \textcolor{comment}{    \(\backslash\)code  Problem::unsteady\_newton\_solve(...) \(\backslash\)endcode function, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01082}01082 \textcolor{comment}{     which implements the following steps:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01083}01083 \textcolor{comment}{   -\/\# Shift the time values back using}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01084}01084 \textcolor{comment}{      \(\backslash\)code Problem::shift\_time\_values() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01085}01085 \textcolor{comment}{      (For BDF timesteppers, this simply moves the history values}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01086}01086 \textcolor{comment}{      back by one level; see below for a detailed discussion of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01087}01087 \textcolor{comment}{      how the shifting of the history values is performed).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01088}01088 \textcolor{comment}{   -\/\# Solve the \(\backslash\)c Problem at the advanced time by performing the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01089}01089 \textcolor{comment}{      following steps}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01090}01090 \textcolor{comment}{       -\/\# Choose a timestep \(\backslash\)c dt.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01091}01091 \textcolor{comment}{       -\/\# Advance the \(\backslash\)c Problem's global time}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01092}01092 \textcolor{comment}{          and (re-\/)calculate the weights for the \(\backslash\)c TimeStepper(s). }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01093}01093 \textcolor{comment}{       -\/\# Update any time-\/dependent boundary conditions etc., }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01094}01094 \textcolor{comment}{          usually via \(\backslash\)code Problem::actions\_before\_newton\_solve() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01095}01095 \textcolor{comment}{          or \(\backslash\)code Problem::actions\_before\_implicit\_timestep()}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01096}01096 \textcolor{comment}{          \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01097}01097 \textcolor{comment}{       -\/\# Call the nonlinear solver to find the unknowns at the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01098}01098 \textcolor{comment}{          current (advanced) time. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01099}01099 \textcolor{comment}{ -\/ \(\backslash\)b Stage: \(\backslash\)b 3 \(\backslash\)b Document \(\backslash\)b the \(\backslash\)b solution \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01100}01100 \textcolor{comment}{    We now have a completely consistent representation of the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01101}01101 \textcolor{comment}{    current and history values of the system's unknowns}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01102}01102 \textcolor{comment}{    for the current value of \(\backslash\)c Time::time().}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01103}01103 \textcolor{comment}{    This is an excellent moment to dump the solutions to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01104}01104 \textcolor{comment}{    disk or do any other post-\/processing. These steps may be }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01105}01105 \textcolor{comment}{    included in \(\backslash\)code Problem::actions\_after\_newton\_solve() \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01106}01106 \textcolor{comment}{    or  \(\backslash\)code Problem::actions\_after\_implicit\_timestep() \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01107}01107 \textcolor{comment}{ -\/ Now return to \(\backslash\)b Stage \(\backslash\)b 2 for the next timestep.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01108}01108 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01109}01109 \textcolor{comment}{ It is important to understand how the shifting of the timesteps}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01110}01110 \textcolor{comment}{ (in preparation for the next timestep) is performed because certain default}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01111}01111 \textcolor{comment}{ operations will not be appropriate for all \(\backslash\)c Elements/ \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01112}01112 \textcolor{comment}{ Problems. Recall that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01113}01113 \textcolor{comment}{ in time-\/dependent problems, \(\backslash\)c Data::value\_pt(i) points to the current}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01114}01114 \textcolor{comment}{ (and, as yet, unknown) \(\backslash\)c Data values, while \(\backslash\)c Data::value\_pt(t,i) for }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01115}01115 \textcolor{comment}{ t>0 points to the history values that the \(\backslash\)c TimeStepper uses to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01116}01116 \textcolor{comment}{ work out time-\/derivatives. When we move to the next}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01117}01117 \textcolor{comment}{ timestep, the history values need to be adjusted in the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01118}01118 \textcolor{comment}{ manner that is appropriate for the timestepping scheme. For instance, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01119}01119 \textcolor{comment}{ for BDF schemes, all values need to be pushed back by one time level.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01120}01120 \textcolor{comment}{ This operation is performed by the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01121}01121 \textcolor{comment}{ \(\backslash\)code  TimeStepper::shift\_time\_values(...) \(\backslash\)endcode In the case of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01122}01122 \textcolor{comment}{ \(\backslash\)c Nodes,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01123}01123 \textcolor{comment}{ the shifting of values associated with the nodal positions is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01124}01124 \textcolor{comment}{ performed by the function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01125}01125 \textcolor{comment}{ \(\backslash\)code TimeStepper::shift\_time\_positions(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01126}01126 \textcolor{comment}{ To ensure that all \(\backslash\)c Data in the \(\backslash\)c Problem is shifted once (and only once!)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01127}01127 \textcolor{comment}{ \(\backslash\)c Problem::shift\_time\_values()}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01128}01128 \textcolor{comment}{ performs the following operations:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01129}01129 \textcolor{comment}{ -\/\# Shift the values of the time history stored in the \(\backslash\)c Time object.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01130}01130 \textcolor{comment}{ -\/\# Shift the time values in the global \(\backslash\)c Mesh. This involves the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01131}01131 \textcolor{comment}{    following steps:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01132}01132 \textcolor{comment}{    -\/\# Loop over all elements and call }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01133}01133 \textcolor{comment}{       \(\backslash\)c TimeStepper::shift\_time\_values(...) for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01134}01134 \textcolor{comment}{       the \(\backslash\)c TimeStepper corresponding to each internal \(\backslash\)c Data value. This}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01135}01135 \textcolor{comment}{       leads to the slightly ugly construction \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01136}01136 \textcolor{comment}{       internal\_pt(i)-\/>time\_stepper\_pt()-\/>shift\_time\_values(internal\_pt(i))}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01137}01137 \textcolor{comment}{        \(\backslash\)endcode but there appears to be no way to avoid this.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01138}01138 \textcolor{comment}{    -\/\# Loop over all \(\backslash\)c Nodes in the mesh and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01139}01139 \textcolor{comment}{       -\/\#  call \(\backslash\)c TimeStepper::shift\_time\_values(...) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01140}01140 \textcolor{comment}{           for each \(\backslash\)c Node 's \(\backslash\)c TimeStepper.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01141}01141 \textcolor{comment}{       -\/\#  call \(\backslash\)c TimeStepper::shift\_time\_positions(...) for each }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01142}01142 \textcolor{comment}{           \(\backslash\)c Node's positional \(\backslash\)c TimeStepper.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01143}01143 \textcolor{comment}{ -\/\# Shift the time values for all global \(\backslash\)c Data.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01144}01144 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01145}01145 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01146}01146 \textcolor{comment}{ \(\backslash\)subsection adaptive\_time\_stepping Adaptive time-\/stepping}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01147}01147 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01148}01148 \textcolor{comment}{ In adaptive time-\/stepping, the size of the timestep is adjusted}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01149}01149 \textcolor{comment}{ automatically, so that the global (temporal) error estimate,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01150}01150 \textcolor{comment}{ computed by the Problem member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01151}01151 \textcolor{comment}{ \(\backslash\)code Problem::global\_error\_norm() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01152}01152 \textcolor{comment}{ remains below a preset threshold. However, the function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01153}01153 \textcolor{comment}{ \(\backslash\)c Problem::global\_error\_norm() must be implemented for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01154}01154 \textcolor{comment}{ each specific problem. The error norm is usually }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01155}01155 \textcolor{comment}{ constructed from the (estimated) errors of individual}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01156}01156 \textcolor{comment}{ \(\backslash\)c Data values. Estimates for these quantities are given by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01157}01157 \textcolor{comment}{ the differences between the actual value and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01158}01158 \textcolor{comment}{ a predicted value, as determined by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01159}01159 \textcolor{comment}{ \(\backslash\)code TimeStepper::error\_in\_value(...) \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01160}01160 \textcolor{comment}{ and the errors in positional \(\backslash\)c Data values, found by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01161}01161 \textcolor{comment}{ \(\backslash\)code TimeStepper::error\_in\_position(...) \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01162}01162 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01163}01163 \textcolor{comment}{ In moving mesh problems, a suitable norm is the root-\/mean-\/square}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01164}01164 \textcolor{comment}{ of the errors in all positional coordinates at every \(\backslash\)c Node. In fluid}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01165}01165 \textcolor{comment}{ problems, the error is usually based on the velocity components, etc.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01166}01166 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01167}01167 \textcolor{comment}{ Once a suitable norm has been chosen, a single adaptive timestep is}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01168}01168 \textcolor{comment}{ taken by the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01169}01169 \textcolor{comment}{ \(\backslash\)code Problem::adaptive\_unsteady\_newton\_solve(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01170}01170 \textcolor{comment}{ This function returns a double precision number that is the value }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01171}01171 \textcolor{comment}{ of \(\backslash\)c dt that should be}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01172}01172 \textcolor{comment}{ taken at the next timestep. A typical calling loop is thus}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01173}01173 \textcolor{comment}{ \(\backslash\)code }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01174}01174 \textcolor{comment}{  // Initial suggestion for timestep}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01175}01175 \textcolor{comment}{  double dt=0.001;}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01176}01176 \textcolor{comment}{  for(unsigned t=0;t<100;t++)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01177}01177 \textcolor{comment}{   \{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01178}01178 \textcolor{comment}{    // Try to take a timestep dt forward; if the computed}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01179}01179 \textcolor{comment}{    // solution is not sufficiently accurate, reduce the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01180}01180 \textcolor{comment}{    // the timestep and repeat... Return the suggestion for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01181}01181 \textcolor{comment}{    // next timestep}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01182}01182 \textcolor{comment}{    double dt\_next = adaptive\_unsteady\_newton\_solve(dt,...);}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01183}01183 \textcolor{comment}{    dt = dt\_next;}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01184}01184 \textcolor{comment}{   \}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01185}01185 \textcolor{comment}{  \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01186}01186 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01187}01187 \textcolor{comment}{ Within the \(\backslash\)c Problem::adaptive\_unsteady\_newton\_solve(..) function,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01188}01188 \textcolor{comment}{ if the global error norm is too large, the step is rejected, the timestep}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01189}01189 \textcolor{comment}{ reduced and the step repeated. If the timestep falls below a }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01190}01190 \textcolor{comment}{ preset tolerance \(\backslash\)c Problem::Minimum\_dt (which has the default value }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01191}01191 \textcolor{comment}{ \(\backslash\)c 1.0e-\/12), the program will terminate. It is also possible to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01192}01192 \textcolor{comment}{ set a maximum timestep by over-\/writing the (large) default}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01193}01193 \textcolor{comment}{ for \(\backslash\)c Problem::Maximum\_dt (initialised to  \(\backslash\)c 1.0e12) with a smaller}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01194}01194 \textcolor{comment}{ value.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01195}01195 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01196}01196 \textcolor{comment}{ \(\backslash\)subsection restarts Restarts}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01197}01197 \textcolor{comment}{ Time-\/dependent simulations can consume a lot of computer time, and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01198}01198 \textcolor{comment}{ it is essential to be able to restart simulations rather than having}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01199}01199 \textcolor{comment}{ to re-\/do them from scratch if a computer crashes during the code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01200}01200 \textcolor{comment}{ execution. For this purpose }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01201}01201 \textcolor{comment}{ the \(\backslash\)c Problem class provides the two member functions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01202}01202 \textcolor{comment}{ \(\backslash\)code Problem::dump(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01203}01203 \textcolor{comment}{ and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01204}01204 \textcolor{comment}{ \(\backslash\)code Problem::read(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01205}01205 \textcolor{comment}{ which write/read the generic \(\backslash\)c Problem components (i.e. the \(\backslash\)c Data }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01206}01206 \textcolor{comment}{ values and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01207}01207 \textcolor{comment}{ history values, the history of previous timestep increments, etc) to/from}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01208}01208 \textcolor{comment}{ disk. These generic functions are typically called from within a specific \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01209}01209 \textcolor{comment}{ Problem's own dump/read functions which also deal with any additional, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01210}01210 \textcolor{comment}{ problem-\/specific data that has to be recorded/reset to allow a proper }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01211}01211 \textcolor{comment}{ restart.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01212}01212 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01213}01213 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01214}01214 \textcolor{comment}{ \(\backslash\)section mesh\_refinement Problem/Mesh adaptation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01215}01215 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01216}01216 \textcolor{comment}{ \(\backslash\)subsection RefineableProblems Adaptation at the Problem level}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01217}01217 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01218}01218 \textcolor{comment}{ The ability to adaptively refine/unrefine the \(\backslash\)c Problem's mesh(es)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01219}01219 \textcolor{comment}{ in regions in which the solution undergoes rapid/slow variations }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01220}01220 \textcolor{comment}{ is of crucial importance for the overall efficiency of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01221}01221 \textcolor{comment}{ solution process. Mesh-\/adaptation involves the following steps:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01222}01222 \textcolor{comment}{ -\/\# Compute an estimate of the error in the computed solution}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01223}01223 \textcolor{comment}{    for all elements in the mesh.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01224}01224 \textcolor{comment}{ -\/\# Label the elements whose error estimate is the above the maximum}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01225}01225 \textcolor{comment}{    (or below the minimum) permissible error.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01226}01226 \textcolor{comment}{ -\/\# Perform the actual mesh adaptation: elements whose error is too large}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01227}01227 \textcolor{comment}{    are subdivided into `son' elements; elements whose error is too }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01228}01228 \textcolor{comment}{    small are merged with their `siblings', provided the `siblings'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01229}01229 \textcolor{comment}{    are also scheduled for de-\/refinement. Usually, certain bounds are }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01230}01230 \textcolor{comment}{    imposed on the maximum and minimum refinement levels }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01231}01231 \textcolor{comment}{    to prevent excessive mesh refinement (e.g. near singularities)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01232}01232 \textcolor{comment}{    or de-\/refinement. (While the use of very large elements might be }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01233}01233 \textcolor{comment}{    permissible in regions in which the solution varies little, such}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01234}01234 \textcolor{comment}{    elements will provide a poor representation of the domain shape}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01235}01235 \textcolor{comment}{    and thus lead to unsatisfactory post-\/processing.)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01236}01236 \textcolor{comment}{ -\/\# Represent the previously computed solution on the newly created}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01237}01237 \textcolor{comment}{    \(\backslash\)c Nodes / elements.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01238}01238 \textcolor{comment}{ -\/\# Once all the \(\backslash\)c Problem's submeshes have been adapted, update the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01239}01239 \textcolor{comment}{    \(\backslash\)c Problem itself by updating the global \(\backslash\)c Mesh, re-\/generating }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01240}01240 \textcolor{comment}{    the equation numbering scheme, etc.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01241}01241 \textcolor{comment}{ -\/\# Solve the adapted \(\backslash\)c Problem.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01242}01242 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01243}01243 \textcolor{comment}{ The \(\backslash\)c Problem class provides several}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01244}01244 \textcolor{comment}{ functions that perform these tasks completely automatically. For }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01245}01245 \textcolor{comment}{ instance, the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01246}01246 \textcolor{comment}{ \(\backslash\)code  Problem::refine\_uniformly() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01247}01247 \textcolor{comment}{ performs one uniform mesh refinement step for all (refineable)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01248}01248 \textcolor{comment}{ submeshes in the \(\backslash\)c Problem. Similarly, the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01249}01249 \textcolor{comment}{ \(\backslash\)code  Problem::adapt(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01250}01250 \textcolor{comment}{ performs one mesh adaptation step.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01251}01251 \textcolor{comment}{ In both functions, mesh adaptation is followed by the update of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01252}01252 \textcolor{comment}{ the global \(\backslash\)c Mesh and the re-\/assignment of the equation numbers}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01253}01253 \textcolor{comment}{ so that, on return from these functions, the \(\backslash\)c Problem can immediately}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01254}01254 \textcolor{comment}{ be solved again.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01255}01255 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01256}01256 \textcolor{comment}{ The \(\backslash\)c Problem class also provides overloaded versions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01257}01257 \textcolor{comment}{ of the steady and unsteady Newton solvers}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01258}01258 \textcolor{comment}{ \(\backslash\)code Problem::newton\_solve(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01259}01259 \textcolor{comment}{ and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01260}01260 \textcolor{comment}{ \(\backslash\)code Problem::unsteady\_newton\_solve(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01261}01261 \textcolor{comment}{ that automatically perform mesh adaptations until the computed }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01262}01262 \textcolor{comment}{ solution satisfies the specified error bounds on all submeshes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01263}01263 \textcolor{comment}{ (or until a max. number of adaptations has been performed).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01264}01264 \textcolor{comment}{ The (empty) virtual member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01265}01265 \textcolor{comment}{ \(\backslash\)code Problem::set\_initial\_condition() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01266}01266 \textcolor{comment}{ establishes the interface to the function that sets}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01267}01267 \textcolor{comment}{ all \(\backslash\)c Data to their initial conditions. This function must be overloaded if}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01268}01268 \textcolor{comment}{ nontrivial initial conditions are to be applied. (If mesh adaptations}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01269}01269 \textcolor{comment}{ are performed while the first timestep is computed, the initial }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01270}01270 \textcolor{comment}{ conditions on the adapted mesh can usually be represented more accurately}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01271}01271 \textcolor{comment}{ by re-\/assigning them, rather than by interpolation from the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01272}01272 \textcolor{comment}{ coarse initial mesh). }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01273}01273 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01274}01274 \textcolor{comment}{ \(\backslash\)subsection RefineableMeshes Adaptation at the Mesh level}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01275}01275 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01276}01276 \textcolor{comment}{ The ability to perform the adaptation at the \(\backslash\)c Problem level relies}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01277}01277 \textcolor{comment}{ on the availability of standardised interfaces to functions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01278}01278 \textcolor{comment}{ that handle the adaptation on the \(\backslash\)c Mesh level. These }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01279}01279 \textcolor{comment}{ interfaces are provided in the class \(\backslash\)c RefineableMeshBase.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01280}01280 \textcolor{comment}{\(\backslash\)c  RefineableMeshBase is derived from \(\backslash\)c Mesh and stores}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01281}01281 \textcolor{comment}{ a pointer to a spatial error estimator, as well as}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01282}01282 \textcolor{comment}{ double precision numbers representing the target}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01283}01283 \textcolor{comment}{ error levels for the adaptation. The member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01284}01284 \textcolor{comment}{ \(\backslash\)code  RefineableMeshBase::refine\_uniformly(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01285}01285 \textcolor{comment}{ performs one uniform mesh refinement step. Similarly,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01286}01286 \textcolor{comment}{ \(\backslash\)code  RefineableMeshBase::adapt(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01287}01287 \textcolor{comment}{ adapts the mesh according to the specified error bounds, using the mesh's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01288}01288 \textcolor{comment}{ spatial error estimator to compute the elemental errors.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01289}01289 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01290}01290 \textcolor{comment}{ The details of the mesh adaptation process depend on the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01291}01291 \textcolor{comment}{ mesh topology; currently the virtual functions in}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01292}01292 \textcolor{comment}{ \(\backslash\)c  RefineableMeshBase are implemented in a general form for quad and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01293}01293 \textcolor{comment}{ brick elements. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01294}01294 \textcolor{comment}{ We shall discuss the mesh adaptation process }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01295}01295 \textcolor{comment}{ in detail for meshes of a particular type: The \(\backslash\)c RefineableQuadMesh}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01296}01296 \textcolor{comment}{ class implements the mesh adaptation procedures for two-\/dimensional, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01297}01297 \textcolor{comment}{ block-\/structured }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01298}01298 \textcolor{comment}{ meshes which consist of the refineable variant of 2D \(\backslash\)c QElements.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01299}01299 \textcolor{comment}{ The description provides a template for the development of mesh refinement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01300}01300 \textcolor{comment}{ procedures for meshes with different element topologies (e.g. triangular}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01301}01301 \textcolor{comment}{ elements, or 3D \(\backslash\)c QElements). }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01302}01302 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01303}01303 \textcolor{comment}{ \(\backslash\)subsection RefineableQuadMesh\_section Mesh adaptation for 2D quadrilateral meshes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01304}01304 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01305}01305 \textcolor{comment}{ \(\backslash\)subsubsection RefineableQElementsInmeshes Refineable QElements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01306}01306 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01307}01307 \textcolor{comment}{ The abstract base class \(\backslash\)c RefineableQElement<2> `upgrades' }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01308}01308 \textcolor{comment}{ existing elements of (geometric) type \(\backslash\)c QElement<2,NNODE\_1D> to versions }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01309}01309 \textcolor{comment}{ that are suitable for use in adaptive computations. 'Upgrading'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01310}01310 \textcolor{comment}{ is achieved via inheritance so that, e.g., refineable }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01311}01311 \textcolor{comment}{ Poisson elements are defined as:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01312}01312 \textcolor{comment}{ \(\backslash\)code }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01313}01313 \textcolor{comment}{ template <unsigned DIM, unsigned NNODE\_1D>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01314}01314 \textcolor{comment}{ class RefineableQPoissonElement : public QPoissonElement<DIM,NNODE\_1D>,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01315}01315 \textcolor{comment}{ public virtual RefineablePoissonEquations<DIM>,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01316}01316 \textcolor{comment}{ public virtual RefineableQElement<DIM>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01317}01317 \textcolor{comment}{ \{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01318}01318 \textcolor{comment}{  [...]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01319}01319 \textcolor{comment}{ \}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01320}01320 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01321}01321 \textcolor{comment}{ The abstract base class \(\backslash\)c RefineableQElement<2> defines}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01322}01322 \textcolor{comment}{ virtual interfaces for those \(\backslash\)c FiniteElement member functions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01323}01323 \textcolor{comment}{ that might have to be overloaded in the refineable version.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01324}01324 \textcolor{comment}{ In most cases, these member functions must be }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01325}01325 \textcolor{comment}{ re-\/implemented to deal with the possible presence of hanging nodes,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01326}01326 \textcolor{comment}{ see below.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01327}01327 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01328}01328 \textcolor{comment}{ \(\backslash\)subsubsection QuadTreeInMeshes QuadTree procedures for mesh refinement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01329}01329 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01330}01330 \textcolor{comment}{ Many of the mesh adaptation procedures for meshes of type }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01331}01331 \textcolor{comment}{ \(\backslash\)c RefineableQuadMesh use }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01332}01332 \textcolor{comment}{ quadtree representations of the mesh. The quadtree navigation }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01333}01333 \textcolor{comment}{ and search algorithms are based on those described in H. Samet's "{}The }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01334}01334 \textcolor{comment}{ design and analysis of spatial data structures"{} (Addison-\/Wesley, 1990).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01335}01335 \textcolor{comment}{ [Note: Unfortunately, in the usual tree terminology, quadtrees are }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01336}01336 \textcolor{comment}{ made of \(\backslash\)e "{}nodes"{} which are, of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01337}01337 \textcolor{comment}{ course, completely unrelated to the \(\backslash\)c Nodes in the finite element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01338}01338 \textcolor{comment}{ mesh! The context and -\/-\/ within this document -\/-\/ the different}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01339}01339 \textcolor{comment}{ typefaces should make it clear which is which...]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01340}01340 \textcolor{comment}{ It is important to understand that each \(\backslash\)c RefineableQElement<2> has an}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01341}01341 \textcolor{comment}{ associated \(\backslash\)c QuadTree and each \(\backslash\)c QuadTree has an associated}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01342}01342 \textcolor{comment}{ \(\backslash\)c RefineableQElement<2>. This two-\/way "{}has a"{} relationship permits a}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01343}01343 \textcolor{comment}{ "{}clean"{} implementation of the (generic) \(\backslash\)c QuadTree algorithms, although}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01344}01344 \textcolor{comment}{ it does incur the cost of two additional pointers.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01345}01345 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01346}01346 \textcolor{comment}{ To illustrate the way in which \(\backslash\)c RefineableQuadMeshes are represented }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01347}01347 \textcolor{comment}{ by \(\backslash\)c QuadTrees, the figure below shows a simple finite element mesh }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01348}01348 \textcolor{comment}{ together with its quadtree-\/representation.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01349}01349 \textcolor{comment}{ There are two different types of quadtree classes: \(\backslash\)c QuadTrees and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01350}01350 \textcolor{comment}{ \(\backslash\)c QuadTreeRoots, which inherit from \(\backslash\)c QuadTrees.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01351}01351 \textcolor{comment}{ The overall structure of the quadtree}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01352}01352 \textcolor{comment}{ is defined by pointers between its \(\backslash\)e "{}nodes"{}. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01353}01353 \textcolor{comment}{ Each \(\backslash\)e "{}node"{} (an object of type \(\backslash\)c QuadTree, shown in}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01354}01354 \textcolor{comment}{ pink) in the quadtree}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01355}01355 \textcolor{comment}{ has a pointer to its \(\backslash\)e "{}father"{} (if this pointer is }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01356}01356 \textcolor{comment}{ NULL, the \(\backslash\)e "{}node"{} is the \(\backslash\)e "{}root node"{}) and a vector of pointers to its}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01357}01357 \textcolor{comment}{ four \(\backslash\)e "{}sons"{} (if the vector is empty, the "{}node"{} is a \(\backslash\)e "{}leaf }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01358}01358 \textcolor{comment}{ \(\backslash\)e node"{}). This data structure is sufficient to navigate the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01359}01359 \textcolor{comment}{ quadtree (e.g. identify the quadtree's \(\backslash\)e "{}leaf nodes"{}, determine a }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01360}01360 \textcolor{comment}{ \(\backslash\)e "{}node"{}'s }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01361}01361 \textcolor{comment}{ neighbours, etc.) Each \(\backslash\)c QuadTree also stores a pointer}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01362}01362 \textcolor{comment}{ to an associated \(\backslash\)e "{}object"{} of type \(\backslash\)c RefineableElement (shown}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01363}01363 \textcolor{comment}{ in light blue). The finite element mesh that is used in the computations}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01364}01364 \textcolor{comment}{ only comprises those \(\backslash\)c RefineableElements that are associated with}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01365}01365 \textcolor{comment}{ \(\backslash\)e "{}leaf nodes"{}. We refer to these elements as "{}active elements"{}. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01366}01366 \textcolor{comment}{ In the diagram below, the active elements are identified by thick blue}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01367}01367 \textcolor{comment}{ boundaries and the blue element numbers correspond to those in the mesh.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01368}01368 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01369}01369 \textcolor{comment}{ \(\backslash\)image html QuadTree.gif "{}Illustration of a QuadTree and the associated RefineableQuadMesh"{} }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01370}01370 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01371}01371 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01372}01372 \textcolor{comment}{ \(\backslash\)subsubsection RefineableQuadMesh\_setup\_section Mesh generation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01373}01373 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01374}01374 \textcolor{comment}{ Any \(\backslash\)c Mesh that is designed to contain 2D \(\backslash\)c QElement s forms a suitable }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01375}01375 \textcolor{comment}{ basis for a \(\backslash\)c RefineableQuadMesh mesh and the initial stages of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01376}01376 \textcolor{comment}{ the mesh generation process}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01377}01377 \textcolor{comment}{ can be performed exactly as described in section \(\backslash\)ref meshes above. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01378}01378 \textcolor{comment}{ Typically, the constructor for a \(\backslash\)c RefineableQuadMesh}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01379}01379 \textcolor{comment}{ will produce a relatively }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01380}01380 \textcolor{comment}{ coarse background mesh (sometimes referred to as a "{}root mesh"{}) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01381}01381 \textcolor{comment}{ which can subsequently be refined as required. As}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01382}01382 \textcolor{comment}{ discussed before,  the type of element will typically be passed as }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01383}01383 \textcolor{comment}{ a template parameter and it is assumed that in any concrete }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01384}01384 \textcolor{comment}{ instantiation of the \(\backslash\)c RefineableQuadMesh class, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01385}01385 \textcolor{comment}{ the element is derived from the class \(\backslash\)c RefineableQElement<2>.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01386}01386 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01387}01387 \textcolor{comment}{ Following the generic setup of the mesh (creating elements, \(\backslash\)c Nodes, etc), }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01388}01388 \textcolor{comment}{ the constructor of the \(\backslash\)c RefineableQuadMesh must associate each }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01389}01389 \textcolor{comment}{ \(\backslash\)c RefineableQElement<2> in the mesh with a \(\backslash\)c QuadTreeRoot and vice versa.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01390}01390 \textcolor{comment}{ The association between \(\backslash\)c RefineableQElement<2>s}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01391}01391 \textcolor{comment}{ and \(\backslash\)c QuadTreeRoots is established by the \(\backslash\)c QuadTreeRoot constructor which}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01392}01392 \textcolor{comment}{ takes the pointer to the \(\backslash\)c RefineableQElement<2> as its argument.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01393}01393 \textcolor{comment}{ The different \(\backslash\)c QuadTrees must then be combined into a \(\backslash\)c QuadTreeForest,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01394}01394 \textcolor{comment}{ whose constructor establishes each \(\backslash\)c QuadTree 's }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01395}01395 \textcolor{comment}{ N/S/W/E neighbours and their relative orientation. Here is an }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01396}01396 \textcolor{comment}{ illustration:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01397}01397 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01398}01398 \textcolor{comment}{ \(\backslash\)image html QuarterCircleMesh.gif "{}Mesh consisting of three RefineableQElement<2>s/ QuadTrees. Element/QuadTree numbers are blue, and the QuadTree's `northern' direction is indicated by the red arrows. The QuadTrees are combined to a QuadTreeForest which establishes their adjacency (QuadTree 2 is QuadTree 0's northern neighbour etc.) and their relative orientation (QuadTree 1's North coincides with QuadTree 2's West, etc.) Note that the RefineableQElement<2>'s local coordinates  s\_0 and s\_1  are aligned with the QuadTree 's W-\/-\/>E and S-\/-\/>N directions, respectively."{} }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01399}01399 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01400}01400 \textcolor{comment}{ \(\backslash\)image latex QuarterCircleMesh.eps "{}Mesh consisting of three RefineableQElements<2>/ QuadTrees. Element/QuadTree numbers are blue, and the QuadTree's `northern' direction is indicated by the red arrows. The QuadTrees are combined into a QuadTreeForest, which establishes their adjacency (QuadTree 2 is QuadTree 0's northern neighbour etc.) and their relative orientation (QuadTree 1's North coincides with QuadTree 2's West, etc.) Note that the RefineableQElement<2>'s local coordinates  s\_0 and s\_1  are aligned with the QuadTree 's W-\/-\/>E and S-\/-\/>N directions, respectively."{} }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01401}01401 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01402}01402 \textcolor{comment}{ The virtual member function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01403}01403 \textcolor{comment}{ \(\backslash\)code RefineableQuadMesh::setup\_quadtree\_forest() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01404}01404 \textcolor{comment}{ creates the \(\backslash\)c QuadTreeForest automatically and should be called at the end}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01405}01405 \textcolor{comment}{ of the \(\backslash\)c RefineableQuadMesh's constructor. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01406}01406 \textcolor{comment}{ Finally, the mesh must be given a pointer to a spatial error estimator.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01407}01407 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01408}01408 \textcolor{comment}{ \(\backslash\)subsubsection Hanging\_Nodes Hanging Nodes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01409}01409 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01410}01410 \textcolor{comment}{ Before explaining the details of the mesh adaptation process we}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01411}01411 \textcolor{comment}{ discuss how hanging nodes are treated in \(\backslash\)c oomph-\/lib. The figure below}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01412}01412 \textcolor{comment}{ shows a \(\backslash\)c RefineableQuadMesh that }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01413}01413 \textcolor{comment}{ originally consisted of  four 4-\/node \(\backslash\)c RefineableQElements }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01414}01414 \textcolor{comment}{ and nine nodes (nodes 0 to 8). The mesh was adapted twice: During the first}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01415}01415 \textcolor{comment}{ adaptation, the top right element was subdivided into }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01416}01416 \textcolor{comment}{ four son elements and five new \(\backslash\)c Nodes (nodes 9 to 13) were created.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01417}01417 \textcolor{comment}{ Then one of the newly created elements was subdivided again}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01418}01418 \textcolor{comment}{ and in the process \(\backslash\)c Nodes 14 to 18 were created. \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01419}01419 \textcolor{comment}{ On this mesh, inter-\/element continuity is not ensured unless the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01420}01420 \textcolor{comment}{ hanging \(\backslash\)c Nodes (=internal \(\backslash\)c Nodes not shared by an adjacent }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01421}01421 \textcolor{comment}{ element -\/-\/ here \(\backslash\)c Nodes 9, 10, 14, 15, 17 and 18) are suitably constrained.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01422}01422 \textcolor{comment}{ For instance, the nodal values at \(\backslash\)c Node 10 must be linear}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01423}01423 \textcolor{comment}{ combinations of the values at nodes 4 and 7 if the solution}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01424}01424 \textcolor{comment}{ is to remain continuous across the eastern edge of element 2.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01425}01425 \textcolor{comment}{ We refer to nodes 4 and 7 as the "{}master nodes"{} of \(\backslash\)c Node}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01426}01426 \textcolor{comment}{ 10. \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01427}01427 \textcolor{comment}{ The hanging node status of the \(\backslash\)c Nodes can be determined }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01428}01428 \textcolor{comment}{ by the following procedure:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01429}01429 \textcolor{comment}{ -\/ Loop over all elements in the mesh. For each element \(\backslash\)b E do:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01430}01430 \textcolor{comment}{   -\/ Loop over the edges of element.  For each edge \(\backslash\)b e\_E do:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01431}01431 \textcolor{comment}{     -\/ Identify the neighbouring element, \(\backslash\)b N, that faces edge \(\backslash\)b e\_E. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01432}01432 \textcolor{comment}{     -\/ If the neighbouring element, \(\backslash\)b N, has the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01433}01433 \textcolor{comment}{       same size as element \(\backslash\)b E then the hanging node }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01434}01434 \textcolor{comment}{       status of the \(\backslash\)c Nodes that are located on edge \(\backslash\)b e\_E does }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01435}01435 \textcolor{comment}{       not need to be changed.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01436}01436 \textcolor{comment}{     -\/ If the neighbouring element, \(\backslash\)b N, is larger than  \(\backslash\)b E, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01437}01437 \textcolor{comment}{       determine the edge \(\backslash\)b e\_N of element \(\backslash\)b N that faces the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01438}01438 \textcolor{comment}{       edge \(\backslash\)b e\_E. Make all \(\backslash\)c Nodes on edge \(\backslash\)b e\_N }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01439}01439 \textcolor{comment}{       master nodes for all hanging \(\backslash\)c Nodes on edge \(\backslash\)b e\_E.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01440}01440 \textcolor{comment}{     .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01441}01441 \textcolor{comment}{   . }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01442}01442 \textcolor{comment}{ .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01443}01443 \textcolor{comment}{ If the difference in the refinement levels of two adjacent elements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01444}01444 \textcolor{comment}{ is greater than one, some of the master nodes determined by the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01445}01445 \textcolor{comment}{ above procedure will themselves be hanging nodes and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01446}01446 \textcolor{comment}{ these now need to be eliminated recursively. For instance, \(\backslash\)c Nodes 9 and 11}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01447}01447 \textcolor{comment}{ are initially classified as master nodes for \(\backslash\)c Node 17. However, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01448}01448 \textcolor{comment}{ \(\backslash\)c Node 9 is a hanging node which depends on \(\backslash\)c Nodes 4 and 5. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01449}01449 \textcolor{comment}{ Hence, the ultimate master  nodes for \(\backslash\)c Node 17 are \(\backslash\)c Nodes 4, 5 and 11.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01450}01450 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01451}01451 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01452}01452 \textcolor{comment}{ \(\backslash\)image html HangingNodes.gif "{}Illustration of hanging nodes"{}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01453}01453 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01454}01454 \textcolor{comment}{ \(\backslash\)image latex HangingNodes.eps "{}Illustration of hanging nodes"{}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01455}01455 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01456}01456 \textcolor{comment}{ The presence of hanging nodes must not affect the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01457}01457 \textcolor{comment}{ node-\/based representations for the unknown function(s) and for the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01458}01458 \textcolor{comment}{ geometric }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01459}01459 \textcolor{comment}{ mapping within the elements. Hence, within any}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01460}01460 \textcolor{comment}{ element \(\backslash\)f\$ E \(\backslash\)f\$, a scalar function \(\backslash\)f\$ u \(\backslash\)f\$ should continue to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01461}01461 \textcolor{comment}{ be representable as}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01462}01462 \textcolor{comment}{ \(\backslash\)f[ u = \(\backslash\)sum\_\{j\} U\_\{J(j,E)\} \(\backslash\)psi\_j(s) \(\backslash\)mbox\{\(\backslash\)hspace\{5cm\} (1)\} \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01463}01463 \textcolor{comment}{ while the mapping between local and global coordinates should retain }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01464}01464 \textcolor{comment}{ the form}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01465}01465 \textcolor{comment}{  \(\backslash\)f[   \{\(\backslash\)bf x\} = \(\backslash\)sum\_\{j\} \{\(\backslash\)bf X\}\_\{J(j,E)\} \(\backslash\)psi\_j(s),}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01466}01466 \textcolor{comment}{        \(\backslash\)mbox\{\(\backslash\)hspace\{5cm\} (2)\} \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01467}01467 \textcolor{comment}{ where the sums are taken over the nodes \(\backslash\)f\$ j \(\backslash\)f\$ of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01468}01468 \textcolor{comment}{ the element. \(\backslash\)f\$ J(j,E) \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01469}01469 \textcolor{comment}{ represents the global node number of local node \(\backslash\)f\$ j \(\backslash\)f\$ in element }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01470}01470 \textcolor{comment}{ \(\backslash\)f\$ E \(\backslash\)f\$ and \(\backslash\)f\$ U\_J \(\backslash\)f\$ and \(\backslash\)f\$ \{\(\backslash\)bf X\}\_J \(\backslash\)f\$ represent }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01471}01471 \textcolor{comment}{ the function value at and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01472}01472 \textcolor{comment}{ the position vector to global node  \(\backslash\)f\$ J \(\backslash\)f\$, respectively.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01473}01473 \textcolor{comment}{ To ensure inter-\/element continuity of \(\backslash\)f\$ u \(\backslash\)f\$ and  \(\backslash\)f\$ \{\(\backslash\)bf x\} \(\backslash\)f\$, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01474}01474 \textcolor{comment}{ we constrain the nodal values and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01475}01475 \textcolor{comment}{ positions of the hanging nodes so that for every hanging}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01476}01476 \textcolor{comment}{ node \(\backslash\)f\$ J \(\backslash\)f\$ we have}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01477}01477 \textcolor{comment}{  \(\backslash\)f[ U\_J = \(\backslash\)sum\_\{K\} U\_\{K\} \(\backslash\)omega\_\{JK\}  \(\backslash\)f] }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01478}01478 \textcolor{comment}{ and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01479}01479 \textcolor{comment}{  \(\backslash\)f[ \{\(\backslash\)bf X\}\_J = \(\backslash\)sum\_\{K\} \{\(\backslash\)bf X\}\_\{K\} \(\backslash\)omega\_\{JK\} \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01480}01480 \textcolor{comment}{ where the sum is taken over the hanging node's master nodes \(\backslash\)f\$ K \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01481}01481 \textcolor{comment}{ and the \(\backslash\)f\$ \(\backslash\)omega\_\{JK\} \(\backslash\)f\$ are suitable weights.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01482}01482 \textcolor{comment}{ It is precisely this representation of the nodal positions and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01483}01483 \textcolor{comment}{ values that is implemented in \(\backslash\)c Node::value(...) and \(\backslash\)c Node::position().}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01484}01484 \textcolor{comment}{ [Note that different nodal values can have different hanging node}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01485}01485 \textcolor{comment}{ constraints; e.g. in Taylor-\/Hood elements where the pressure and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01486}01486 \textcolor{comment}{ velocities are interpolated by linear and quadratic basis functions.]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01487}01487 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01488}01488 \textcolor{comment}{ For simply hanging nodes (e.g. \(\backslash\)c Nodes 9, 10, 14 and 15 in the above sketch)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01489}01489 \textcolor{comment}{ the weights \(\backslash\)f\$ \(\backslash\)omega\_\{JK\} \(\backslash\)f\$ are determined as follows:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01490}01490 \textcolor{comment}{ -\/ Find the neighbour element \(\backslash\)b N that faces the hanging node \(\backslash\)f\$ J \(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01491}01491 \textcolor{comment}{ -\/ Let \(\backslash\)f\$ s\_J \(\backslash\)f\$ be the local coordinate of hanging node  \(\backslash\)f\$ J \(\backslash\)f\$ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01492}01492 \textcolor{comment}{   in the neighbour element \(\backslash\)b N.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01493}01493 \textcolor{comment}{ -\/ For each master node \(\backslash\)f\$ K \(\backslash\)f\$  in \(\backslash\)b N, the weight \(\backslash\)f\$  \(\backslash\)omega\_\{JK\} \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01494}01494 \textcolor{comment}{   is then given by the shape function associated with master node}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01495}01495 \textcolor{comment}{   \(\backslash\)f\$ K \(\backslash\)f\$, evaluated at \(\backslash\)f\$ s\_J \(\backslash\)f\$, evaluated in element \(\backslash\)b N.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01496}01496 \textcolor{comment}{   \(\backslash\)f[ \(\backslash\)omega\_\{JK\} = \(\backslash\)psi\_K(s\_J) \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01497}01497 \textcolor{comment}{ .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01498}01498 \textcolor{comment}{ For multiply hanging nodes (\(\backslash\)c Nodes 17 and 18 in the above sketch),}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01499}01499 \textcolor{comment}{ the weights of the ultimate master nodes are determined }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01500}01500 \textcolor{comment}{ recursively, e.g. \(\backslash\)f\$ \(\backslash\)omega\_\{17\(\backslash\) 4\} = \(\backslash\)omega\_\{17\(\backslash\) 9\}  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01501}01501 \textcolor{comment}{ \(\backslash\)times \(\backslash\)omega\_\{9 \(\backslash\) 4\}. \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01502}01502 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01503}01503 \textcolor{comment}{ For \(\backslash\)c RefineableQuadMesh meshes, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01504}01504 \textcolor{comment}{ the above procedures are fully implemented.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01505}01505 \textcolor{comment}{ Executing the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01506}01506 \textcolor{comment}{ \(\backslash\)code  RefineableQElement<2>::setup\_hanging\_nodes() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01507}01507 \textcolor{comment}{ for each element in the mesh establishes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01508}01508 \textcolor{comment}{ which of the elements' \(\backslash\)c Nodes are hanging and determines their }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01509}01509 \textcolor{comment}{ primary master nodes and weights. Furthermore, it pins }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01510}01510 \textcolor{comment}{ the values at the hanging nodes -\/-\/ because the values are constrained,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01511}01511 \textcolor{comment}{ they cannot be unknowns in the problem. When this function has been }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01512}01512 \textcolor{comment}{ executed for all elements in the mesh, the recursive}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01513}01513 \textcolor{comment}{ elimination of hanging master nodes is performed by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01514}01514 \textcolor{comment}{ calling }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01515}01515 \textcolor{comment}{ \(\backslash\)code RefineableMesh::complete\_hanging\_nodes(); \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01516}01516 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01517}01517 \textcolor{comment}{ As mentioned above, the possible occurrence of hanging nodes }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01518}01518 \textcolor{comment}{ needs to be reflected in}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01519}01519 \textcolor{comment}{ the element's equation numbering scheme and in the functions that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01520}01520 \textcolor{comment}{ compute the elemental Jacobian matrix because the element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01521}01521 \textcolor{comment}{ residuals now potentially depend on \(\backslash\)c Nodes outside the element. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01522}01522 \textcolor{comment}{ Therefore, \(\backslash\)c RefineableQElement<2>s must re-\/implement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01523}01523 \textcolor{comment}{ various \(\backslash\)c FiniteElement member functions, e.g., by re-\/implementing}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01524}01524 \textcolor{comment}{ the virtual functions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01525}01525 \textcolor{comment}{ \(\backslash\)code  RefineableQElement<2>::get\_residuals() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01526}01526 \textcolor{comment}{ and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01527}01527 \textcolor{comment}{ \(\backslash\)code  RefineableQElement<2>::get\_jacobian(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01528}01528 \textcolor{comment}{ and various others, as specified in the \(\backslash\)c RefineableQElement<2>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01529}01529 \textcolor{comment}{ class. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01530}01530 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01531}01531 \textcolor{comment}{ In practice, we again distinguish between the "{}geometry"{} and the "{}maths"{}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01532}01532 \textcolor{comment}{ by writing a general \(\backslash\)c RefineablePoissonEquations<DIM> class that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01533}01533 \textcolor{comment}{ inherits from \(\backslash\)c PoissonEquations<DIM> and re-\/implements the appropriate}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01534}01534 \textcolor{comment}{ member functions.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01535}01535 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01536}01536 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01537}01537 \textcolor{comment}{ \(\backslash\)subsubsection RefineableQuadMesh\_adaption\_section Mesh adaptation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01538}01538 \textcolor{comment}{ We can now discuss the details of the mesh adaptation process}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01539}01539 \textcolor{comment}{ for \(\backslash\)c RefineableQuadMesh meshes, although the general procedure is, in fact,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01540}01540 \textcolor{comment}{ generic:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01541}01541 \textcolor{comment}{ Once a solution has been computed,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01542}01542 \textcolor{comment}{ \(\backslash\)c Problem::adapt() loops over all refineable submeshes, and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01543}01543 \textcolor{comment}{ uses their error estimator functions to compute the vector of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01544}01544 \textcolor{comment}{ elemental errors. The vector of errors is then passed to the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01545}01545 \textcolor{comment}{ submeshes'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01546}01546 \textcolor{comment}{ \(\backslash\)code RefineableMesh::adapt(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01547}01547 \textcolor{comment}{ function which performs the actual mesh adaptation and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01548}01548 \textcolor{comment}{ entails the following steps:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01549}01549 \textcolor{comment}{ -\/ Select all elements whose error exceeds the target maximum error }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01550}01550 \textcolor{comment}{   for refinement, provided the elements have not already been refined }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01551}01551 \textcolor{comment}{   to the maximum refinement level.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01552}01552 \textcolor{comment}{ -\/ Select all elements whose error is smaller than the target minimum error }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01553}01553 \textcolor{comment}{   for unrefinement, provided}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01554}01554 \textcolor{comment}{   -\/ their siblings (which can be identified via (Quad)Tree procedures)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01555}01555 \textcolor{comment}{     can also be unrefined}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01556}01556 \textcolor{comment}{   .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01557}01557 \textcolor{comment}{   and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01558}01558 \textcolor{comment}{   -\/ the unrefinement would not coarsen the mesh beyond the minimum}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01559}01559 \textcolor{comment}{     refinement level.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01560}01560 \textcolor{comment}{   .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01561}01561 \textcolor{comment}{ -\/ Now loop over all elements in the mesh (traversing through the leaves}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01562}01562 \textcolor{comment}{   of the \(\backslash\)c QuadTreeForest) and split those elements that are targeted for}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01563}01563 \textcolor{comment}{   refinement. This involves the following steps: }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01564}01564 \textcolor{comment}{   -\/ Create new \(\backslash\)c RefineableElements of the same type as the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01565}01565 \textcolor{comment}{     father element.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01566}01566 \textcolor{comment}{   -\/ Create new \(\backslash\)c QuadTrees -\/-\/-\/ as in the original setup, we }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01567}01567 \textcolor{comment}{     pass the pointers to the newly created \(\backslash\)c RefineableElements to the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01568}01568 \textcolor{comment}{     \(\backslash\)c QuadTree constructors to establish the association between each}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01569}01569 \textcolor{comment}{     \(\backslash\)c QuadTree and its \(\backslash\)c RefineableElement. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01570}01570 \textcolor{comment}{   -\/ Declare the newly created \(\backslash\)c QuadTrees to be the sons of the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01571}01571 \textcolor{comment}{     current \(\backslash\)c QuadTree. This transforms the current \(\backslash\)c QuadTree into a }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01572}01572 \textcolor{comment}{     \(\backslash\)e "{}non-\/leaf node"{} in the \(\backslash\)c QuadTreeForest.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01573}01573 \textcolor{comment}{   Note that the \(\backslash\)c RefineableElement is not deleted }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01574}01574 \textcolor{comment}{   when it is split -\/-\/ it retains its full functionality }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01575}01575 \textcolor{comment}{   (e.g. its pointers to its \(\backslash\)c Nodes, etc).  This ensures that the element }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01576}01576 \textcolor{comment}{   is fully functional should its sons become scheduled for }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01577}01577 \textcolor{comment}{   unrefinement at a later stage. Note that in cases when the \(\backslash\)c Nodes are not}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01578}01578 \textcolor{comment}{ uniformly-\/spaced, certain \(\backslash\)c Nodes in the father will not be}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01579}01579 \textcolor{comment}{ used by the sons. These \(\backslash\)c Nodes will be marked as obsolete and deleted}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01580}01580 \textcolor{comment}{ from the \(\backslash\)c Mesh. The pointers to these \(\backslash\)c Nodes must be set to NULL in}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01581}01581 \textcolor{comment}{ the father element, but this cannot be done until after the hanging}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01582}01582 \textcolor{comment}{ node procedures have been completed, see below.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01583}01583 \textcolor{comment}{ -\/ The newly-\/created elements now exist (and are accessible via}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01584}01584 \textcolor{comment}{   the leaves of the \(\backslash\)c QuadTreeForest) but they have not been `built'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01585}01585 \textcolor{comment}{   i.e. they do not have pointers to \(\backslash\)c Nodes etc. We now }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01586}01586 \textcolor{comment}{   loop over the \(\backslash\)e "{}leaf nodes"{} in the \(\backslash\)c QuadTreeForest and execute}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01587}01587 \textcolor{comment}{   the virtual function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01588}01588 \textcolor{comment}{   \(\backslash\)code RefineableElement::build() \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01589}01589 \textcolor{comment}{   for all newly created elements. In the specific case of a 2D}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01590}01590 \textcolor{comment}{   \(\backslash\)c QuadMesh, the \(\backslash\)c RefineableQElement<2>::build() function will be called.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01591}01591 \textcolor{comment}{   [\(\backslash\)b Note: Elements that have not been built yet are identified}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01592}01592 \textcolor{comment}{   by the fact that the entries in their \(\backslash\)c Node\_pt vector}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01593}01593 \textcolor{comment}{   point to NULL. All other elements are ignored by the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01594}01594 \textcolor{comment}{   \(\backslash\)c RefineableElement::build() function.] \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01595}01595 \textcolor{comment}{   The \(\backslash\)c RefineableElement::build() function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01596}01596 \textcolor{comment}{   establishes the element's pointers to its \(\backslash\)c Nodes and creates}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01597}01597 \textcolor{comment}{   new \(\backslash\)c Nodes as and when required: some \(\backslash\)c Nodes will already have existed }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01598}01598 \textcolor{comment}{   in the old mesh; some new \(\backslash\)c Nodes might already have been created}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01599}01599 \textcolor{comment}{   by a neighbouring element, etc. If a new \(\backslash\)c Node needs to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01600}01600 \textcolor{comment}{   be created, it is allocated with the element's }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01601}01601 \textcolor{comment}{   \(\backslash\)c FiniteElement::construct\_node(...) or }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01602}01602 \textcolor{comment}{   \(\backslash\)c FiniteElement::construct\_boundary\_node(...) functions. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01603}01603 \textcolor{comment}{   By default, the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01604}01604 \textcolor{comment}{   current and previous positions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01605}01605 \textcolor{comment}{   of the new \(\backslash\)c Nodes are determined via the father element's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01606}01606 \textcolor{comment}{   geometric mapping. However, rather than referring directly to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01607}01607 \textcolor{comment}{   \(\backslash\)c QElement::interpolated\_x(...), we determine the position}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01608}01608 \textcolor{comment}{   with}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01609}01609 \textcolor{comment}{   \(\backslash\)code FiniteElement::get\_x(...) \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01610}01610 \textcolor{comment}{   which determines the nodal positions based on the father element's }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01611}01611 \textcolor{comment}{   macro-\/element representation if it exists; see section \(\backslash\)ref MacroElements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01612}01612 \textcolor{comment}{   for a discussion of macro elements for mesh refinement in}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01613}01613 \textcolor{comment}{   domains with curvilinear boundaries. \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01614}01614 \textcolor{comment}{   By default, all values at a newly created \(\backslash\)c Node are free (not pinned).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01615}01615 \textcolor{comment}{   If a new \(\backslash\)c Node is located on the edge of the father element,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01616}01616 \textcolor{comment}{   we apply the same boundary conditions (if any) that apply along }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01617}01617 \textcolor{comment}{   the father element's edge. \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01618}01618 \textcolor{comment}{   If a \(\backslash\)c Node lies on a \(\backslash\)c Mesh boundary, we add it to the \(\backslash\)c Mesh 's storage}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01619}01619 \textcolor{comment}{   scheme for \(\backslash\)c BoundaryNodes. \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01620}01620 \textcolor{comment}{   Finally, the values (and the history values) at the newly}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01621}01621 \textcolor{comment}{   created \(\backslash\)c Nodes must be assigned. This is done by using }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01622}01622 \textcolor{comment}{   the interpolated values from the father element. Since the way in which}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01623}01623 \textcolor{comment}{   values are interpolated inside an element is element-\/specific }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01624}01624 \textcolor{comment}{   (e.g. in Taylor-\/Hood Navier-\/Stokes elements, different interpolations }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01625}01625 \textcolor{comment}{   are used for the pressure and for the velocities), }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01626}01626 \textcolor{comment}{   interpolated values are obtained from a call to the father element's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01627}01627 \textcolor{comment}{   \(\backslash\)code  RefineableQElement<2>::get\_interpolated\_values(...) \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01628}01628 \textcolor{comment}{   function which returns the vector of interpolated values (or history }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01629}01629 \textcolor{comment}{   values) at a given local coordinate. This pure virtual }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01630}01630 \textcolor{comment}{   function must be }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01631}01631 \textcolor{comment}{   implemented for every specific \(\backslash\)c RefineableElement. \(\backslash\)n}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01632}01632 \textcolor{comment}{   At this point, the generic steps in the build process are}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01633}01633 \textcolor{comment}{   completed, but many particular \(\backslash\)c RefineableElements now require further}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01634}01634 \textcolor{comment}{   build operations. For instance, in Crouzeix-\/Raviart Navier-\/Stokes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01635}01635 \textcolor{comment}{   elements, the pressure interpolation is not based on nodal}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01636}01636 \textcolor{comment}{   values but on internal \(\backslash\)c Data which must be suitably initialised.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01637}01637 \textcolor{comment}{   For this purpose, we provide the interface}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01638}01638 \textcolor{comment}{   \(\backslash\)code RefineableElement::further\_build(...) \(\backslash\)endcode }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01639}01639 \textcolor{comment}{   which is executed at the end of  \(\backslash\)c RefineableElement::build(...) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01640}01640 \textcolor{comment}{   and can be used to perform any element-\/specific further build}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01641}01641 \textcolor{comment}{   operations.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01642}01642 \textcolor{comment}{ -\/ All new \(\backslash\)c Nodes and elements have now been created.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01643}01643 \textcolor{comment}{   In the course of the mesh refinement, some }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01644}01644 \textcolor{comment}{   of the previously existing \(\backslash\)c Nodes that are (still) marked as hanging}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01645}01645 \textcolor{comment}{   might have become non-\/hanging. Therefore, we now }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01646}01646 \textcolor{comment}{   update the hanging nodes' values and coordinates }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01647}01647 \textcolor{comment}{   so that their entries}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01648}01648 \textcolor{comment}{   are consistent with their current hanging-\/node constraints and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01649}01649 \textcolor{comment}{   then reset their hanging-\/node status to non-\/hanging. Finally, we }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01650}01650 \textcolor{comment}{   free (unpin) their nodal values. The hanging-\/node status }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01651}01651 \textcolor{comment}{   of all \(\backslash\)c Nodes will be re-\/assessed later, when the de-\/refinement }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01652}01652 \textcolor{comment}{   phase is completed.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01653}01653 \textcolor{comment}{ -\/ Now we loop over \(\backslash\)b all \(\backslash\)e "{}nodes"{} in the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01654}01654 \textcolor{comment}{   \(\backslash\)c QuadTreeForest. If the sons of any \(\backslash\)e "{}non-\/leaf node"{} in the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01655}01655 \textcolor{comment}{   \(\backslash\)c QuadTreeForest are scheduled for de-\/refinement, we merge them}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01656}01656 \textcolor{comment}{   into their father element. This entails the following steps:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01657}01657 \textcolor{comment}{   -\/ First we execute the father element's }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01658}01658 \textcolor{comment}{     \(\backslash\)code RefineableElement::rebuild\_from\_sons() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01659}01659 \textcolor{comment}{     member function, which can be used, e.g., to determine }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01660}01660 \textcolor{comment}{     suitable values for the father element's internal \(\backslash\)c Data from}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01661}01661 \textcolor{comment}{     the values of its sons. In addition, if any of the father's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01662}01662 \textcolor{comment}{     \(\backslash\)c Nodes have been deleted during refinement, they must be}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01663}01663 \textcolor{comment}{     re-\/created during the merge procedure.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01664}01664 \textcolor{comment}{   -\/ Next, we 'unbuild' the son elements by marking those of its \(\backslash\)c Nodes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01665}01665 \textcolor{comment}{     that do not exist in their father element as obsolete (this}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01666}01666 \textcolor{comment}{     classification can later be over-\/ruled by other elements that}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01667}01667 \textcolor{comment}{     need to retain the \(\backslash\)c Node).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01668}01668 \textcolor{comment}{   -\/ Now we delete the son \(\backslash\)c RefineableElements and the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01669}01669 \textcolor{comment}{     associated \(\backslash\)c QuadTrees and empty the father element's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01670}01670 \textcolor{comment}{     vector of pointers to its sons. This (re)turns the father element}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01671}01671 \textcolor{comment}{     into a fully functional element. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01672}01672 \textcolor{comment}{   .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01673}01673 \textcolor{comment}{ -\/ Next, we empty the \(\backslash\)c Mesh::Element\_pt vector }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01674}01674 \textcolor{comment}{   and refill it with the currently active elements which are accessible via}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01675}01675 \textcolor{comment}{   the \(\backslash\)c QuadTreeForest 's \(\backslash\)e "{}leaf nodes"{}. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01676}01676 \textcolor{comment}{ -\/ Now we loop over all elements in the \(\backslash\)c Mesh::Element\_pt }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01677}01677 \textcolor{comment}{   vector and mark their \(\backslash\)c Nodes as non-\/obsolete.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01678}01678 \textcolor{comment}{ -\/ We then update the \(\backslash\)c Nodes hanging node status and adjust}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01679}01679 \textcolor{comment}{   the nodal positions and values of the hanging nodes to make them}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01680}01680 \textcolor{comment}{   consistent with the current hanging-\/node constraints.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01681}01681 \textcolor{comment}{ -\/ We loop over all non-\/leaf elements in the \(\backslash\)c QuadTreeForest}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01682}01682 \textcolor{comment}{   and call their \(\backslash\)c deactivate\_object() function, which sets}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01683}01683 \textcolor{comment}{   \(\backslash\)c FiniteElement::Node\_pt[n] to zero for any obsolete \(\backslash\)c Nodes.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01684}01684 \textcolor{comment}{   Any \(\backslash\)c Nodes in the \(\backslash\)c Mesh::Node\_pt vector that are still labelled}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01685}01685 \textcolor{comment}{   as obsolete are truly obsolete and are deleted by calling}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01686}01686 \textcolor{comment}{   \(\backslash\)code Mesh::prune\_dead\_nodes() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01687}01687 \textcolor{comment}{ -\/ Finally, in order to facilitate dump and restart operations we}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01688}01688 \textcolor{comment}{   sort the \(\backslash\)c Nodes into a standard order using }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01689}01689 \textcolor{comment}{   \(\backslash\)code Mesh::reorder\_nodes() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01690}01690 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01691}01691 \textcolor{comment}{ \(\backslash\)section Macro\_element\_meshes Mesh adaptation in domains with curved boundaries}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01692}01692 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01693}01693 \textcolor{comment}{ The mesh refinement procedures outlined above are perfectly adequate}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01694}01694 \textcolor{comment}{ for meshes in polygonal domains. In such meshes the generation of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01695}01695 \textcolor{comment}{ the new nodal positions and the transfer of the solution from the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01696}01696 \textcolor{comment}{ old to the new mesh can be performed by simple interpolation, using}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01697}01697 \textcolor{comment}{ the `father' element's geometric mapping and shape functions. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01698}01698 \textcolor{comment}{ However, in problems with curvilinear mesh boundaries we must}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01699}01699 \textcolor{comment}{ ensure that the refined meshes provide a progressively more }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01700}01700 \textcolor{comment}{ accurate representation of the curvilinear domain boundary.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01701}01701 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01702}01702 \textcolor{comment}{ To facilitate these steps, we now introduce the concept of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01703}01703 \textcolor{comment}{ \(\backslash\)c GeomObjects, \(\backslash\)c Domains and \(\backslash\)c MacroElements, which }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01704}01704 \textcolor{comment}{ allow a convenient and generic representation of domains that are }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01705}01705 \textcolor{comment}{ bounded by time-\/dependent and/or curvilinear boundaries.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01706}01706 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01707}01707 \textcolor{comment}{ \(\backslash\)subsection GeomObjects Geometric Objects}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01708}01708 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01709}01709 \textcolor{comment}{ Here are two examples of curvilinear boundaries}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01710}01710 \textcolor{comment}{ that are frequently encountered in computations on moving domains:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01711}01711 \textcolor{comment}{ -\/ In many problems the boundary  \(\backslash\)f\$\(\backslash\)partial D\(\backslash\)f\$ of }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01712}01712 \textcolor{comment}{   the moving domain \(\backslash\)f\$D\(\backslash\)f\$ is given explicitly in terms of a}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01713}01713 \textcolor{comment}{   position vector \(\backslash\)f[ \{\(\backslash\)bf r\}\_\{\_\{\(\backslash\)partial D\}\}(\(\backslash\)boldmath\{\(\backslash\)xi\},t), \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01714}01714 \textcolor{comment}{   where \(\backslash\)f\$ t \(\backslash\)f\$ is the (continuous) time and the components of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01715}01715 \textcolor{comment}{   vector \(\backslash\)f\$ \(\backslash\)boldmath\{\(\backslash\)xi\} \(\backslash\)f\$  parametrise the boundary.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01716}01716 \textcolor{comment}{   We have \(\backslash\)f\$DIM(\{\(\backslash\)bf r\}\_\{\_\{\(\backslash\)partial D\}\}) = DIM(\(\backslash\)boldmath\{\(\backslash\)xi\}) + 1\(\backslash\)f\$. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01717}01717 \textcolor{comment}{   For instance, the surface of a cylinder \(\backslash\)f\$C\(\backslash\)f\$ with time-\/dependent }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01718}01718 \textcolor{comment}{   radius \(\backslash\)f\$R(t)\(\backslash\)f\$ can be represented as}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01719}01719 \textcolor{comment}{   \(\backslash\)f[ \{\(\backslash\)bf r\}\_\{\_\{\(\backslash\)partial C\}\} = \(\backslash\)left( \(\backslash\)begin\{array\}\{c\} }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01720}01720 \textcolor{comment}{                         R(t) \(\backslash\)cos(\(\backslash\)xi\_2) \(\backslash\)\(\backslash\)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01721}01721 \textcolor{comment}{                         R(t) \(\backslash\)sin(\(\backslash\)xi\_2) \(\backslash\)\(\backslash\) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01722}01722 \textcolor{comment}{                         \(\backslash\)xi\_1 \(\backslash\)\(\backslash\) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01723}01723 \textcolor{comment}{                         \(\backslash\)end\{array\} \(\backslash\)right). \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01724}01724 \textcolor{comment}{ -\/ In fluid problems with free surfaces or in fluid-\/structure}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01725}01725 \textcolor{comment}{   interaction (FSI) problems, the domain boundary might have to be determined}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01726}01726 \textcolor{comment}{   as part of the solution. In such cases, the boundary will have some}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01727}01727 \textcolor{comment}{   computational representation. For instance, in an FSI computation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01728}01728 \textcolor{comment}{   in which a shell structure bounds the fluid domain, each shell }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01729}01729 \textcolor{comment}{   finite element defines a small part of the fluid domain boundary and}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01730}01730 \textcolor{comment}{   the shell element's local coordinates provide a parametrisation}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01731}01731 \textcolor{comment}{   of some part of the boundary in a form similar to the one }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01732}01732 \textcolor{comment}{   shown above.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01733}01733 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01734}01734 \textcolor{comment}{ The common feature of these two examples is that, in both cases, the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01735}01735 \textcolor{comment}{ boundary is represented by a parametrised position vector.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01736}01736 \textcolor{comment}{ The \(\backslash\)c GeomObject base class provides an abstract interface for such}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01737}01737 \textcolor{comment}{ situations. In its most basic form, a `geometric object'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01738}01738 \textcolor{comment}{ simply provides a parametrisation of its shape by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01739}01739 \textcolor{comment}{ implementing the \(\backslash\)c GeomObject's pure virtual member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01740}01740 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01741}01741 \textcolor{comment}{ GeomObject::position(xi,r)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01742}01742 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01743}01743 \textcolor{comment}{ which computes the position vector \(\backslash\)c r at the coordinates}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01744}01744 \textcolor{comment}{ specified by the vector \(\backslash\)c xi. \(\backslash\)c GeomObject also provides }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01745}01745 \textcolor{comment}{ a large number of additional interfaces in the form of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01746}01746 \textcolor{comment}{ (broken) virtual functions. The most important of these is the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01747}01747 \textcolor{comment}{ time-\/dependent version of the above function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01748}01748 \textcolor{comment}{ \(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01749}01749 \textcolor{comment}{ GeomObject::position(xi,t,r)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01750}01750 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01751}01751 \textcolor{comment}{ which computes the position vector \(\backslash\)c r at the coordinates}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01752}01752 \textcolor{comment}{ specified by the vector \(\backslash\)c xi at the \(\backslash\)b previous \(\backslash\)b discrete}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01753}01753 \textcolor{comment}{ time level \(\backslash\)c t. We follow the usual convention that }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01754}01754 \textcolor{comment}{ -\/ for \(\backslash\)c t=0 the vector \(\backslash\)c r is the position vector at the current time,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01755}01755 \textcolor{comment}{   <CODE> time = Time::time() = Time::time(0) </CODE>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01756}01756 \textcolor{comment}{ -\/ for \(\backslash\)c t=1 it represents the position at the previous (discrete) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01757}01757 \textcolor{comment}{   time level \(\backslash\)c t, i.e. at the continuous time }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01758}01758 \textcolor{comment}{   <CODE> time = Time::time() -\/ Time::dt() = Time::time(1) </CODE>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01759}01759 \textcolor{comment}{ -\/ etc. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01760}01760 \textcolor{comment}{ .}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01761}01761 \textcolor{comment}{ By default, the virtual member function \(\backslash\)c GeomObject::position(xi,t,r)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01762}01762 \textcolor{comment}{ calls the steady version  \(\backslash\)c GeomObject::position(xi,r), so it only }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01763}01763 \textcolor{comment}{ needs to be overloaded for genuinely time-\/dependent geometric objects }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01764}01764 \textcolor{comment}{ (by default, the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01765}01765 \textcolor{comment}{ code execution terminates if the time-\/dependent version is called }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01766}01766 \textcolor{comment}{ for \(\backslash\)f\$ \{\(\backslash\)tt t\} \(\backslash\)ne 0; \(\backslash\)f\$ the function needs to be overloaded if this is }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01767}01767 \textcolor{comment}{ not appropriate).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01768}01768 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01769}01769 \textcolor{comment}{ Further virtual member functions provide interfaces for the determination}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01770}01770 \textcolor{comment}{ of the first and second spatial and temporal derivatives of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01771}01771 \textcolor{comment}{ position vector, allowing the computation of boundary velocities,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01772}01772 \textcolor{comment}{ accelerations and curvatures, etc. These interfaces are provided as}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01773}01773 \textcolor{comment}{ broken virtual functions, so they only need to be overloaded if/when the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01774}01774 \textcolor{comment}{ functionality is actually required in a particular application.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01775}01775 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01776}01776 \textcolor{comment}{ Typically, the shape of a \(\backslash\)c GeomObject depends on a certain number of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01777}01777 \textcolor{comment}{ parameters (in the above examples, the radius \(\backslash\)f\$ R(t) \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01778}01778 \textcolor{comment}{ of the cylinder and the displacements of the shell element, respectively)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01779}01779 \textcolor{comment}{ which can be unknowns in the problem. We therefore store these parameters}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01780}01780 \textcolor{comment}{ as (geometric) \(\backslash\)c Data, whose values can be pinned or free.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01781}01781 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01782}01782 \textcolor{comment}{ \(\backslash\)subsection MacroElements Domains and Macro Elements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01783}01783 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01784}01784 \textcolor{comment}{ For the purposes of mesh generation, we represent curvilinear }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01785}01785 \textcolor{comment}{ domains by objects that are derived from the base class \(\backslash\)c Domain }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01786}01786 \textcolor{comment}{ and use \(\backslash\)c GeomObjects to represent the curvilinear boundaries. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01787}01787 \textcolor{comment}{ For instance, the \(\backslash\)c QuarterCircleSectorDomain sketched}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01788}01788 \textcolor{comment}{ in the figure below is bounded by the geometric object \(\backslash\)c Ellipse }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01789}01789 \textcolor{comment}{ that parametrises the domain's curved boundary, shown in red.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01790}01790 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01791}01791 \textcolor{comment}{ Consider the coarse discretisation of the domain }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01792}01792 \textcolor{comment}{ shown in the Fig. (a) and assume that element 2 (a four-\/node quad }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01793}01793 \textcolor{comment}{ element from the \(\backslash\)c QElement family) is scheduled for }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01794}01794 \textcolor{comment}{ refinement into four son elements. As discussed above, by default the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01795}01795 \textcolor{comment}{ \(\backslash\)c Nodes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01796}01796 \textcolor{comment}{ of the son elements are established/created as follows:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01797}01797 \textcolor{comment}{ -\/ If a \(\backslash\)c Node already exists in the father element we store the pointer}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01798}01798 \textcolor{comment}{   to the existing \(\backslash\)c Node in the son element's \(\backslash\)c Node\_pt vector.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01799}01799 \textcolor{comment}{ -\/ If a \(\backslash\)c Node needs to be created, we determine its position from the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01800}01800 \textcolor{comment}{   geometric mapping of the father element. Thus the five new \(\backslash\)c Nodes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01801}01801 \textcolor{comment}{   that need to be created when element 2 is refined,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01802}01802 \textcolor{comment}{   are placed at their father element's (i.e. element 2's) local }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01803}01803 \textcolor{comment}{   coordinates (0,0), (0,1), (0,-\/1), (1,0) and (-\/1,0). The}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01804}01804 \textcolor{comment}{   father element's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01805}01805 \textcolor{comment}{   \(\backslash\)code RefineableQElement<2>::get\_x(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01806}01806 \textcolor{comment}{   determines the nodal position via a call to }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01807}01807 \textcolor{comment}{   \(\backslash\)c QElement::interpolated\_x(...).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01808}01808 \textcolor{comment}{   Similarly, the nodal values of the new \(\backslash\)c Nodes are determined by}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01809}01809 \textcolor{comment}{   using the interpolated values in the father element. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01810}01810 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01811}01811 \textcolor{comment}{ \(\backslash\)image html MacroElementSketch.gif "{}Illustration of mesh refinement with and without macro elements"{}}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01812}01812 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01813}01813 \textcolor{comment}{ For the element 0, this procedure would be}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01814}01814 \textcolor{comment}{ perfectly adequate, as the domain boundary after refinement }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01815}01815 \textcolor{comment}{ would (still) be captured exactly.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01816}01816 \textcolor{comment}{ However, when refining element 2 by this procedure, the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01817}01817 \textcolor{comment}{ new \(\backslash\)c Node on the boundary is positioned on the straight line }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01818}01818 \textcolor{comment}{ between the two boundary \(\backslash\)c Nodes in the father}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01819}01819 \textcolor{comment}{ element and not on the curved boundary itself, as shown in Fig. (b).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01820}01820 \textcolor{comment}{ Hence repeated mesh refinement will not lead to a better }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01821}01821 \textcolor{comment}{ representation of the domain geometry and preclude convergence }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01822}01822 \textcolor{comment}{ to the exact solution. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01823}01823 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01824}01824 \textcolor{comment}{ To overcome this problem, objects of type \(\backslash\)c Domain}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01825}01825 \textcolor{comment}{ provide a decomposition of the domain into a number}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01826}01826 \textcolor{comment}{ of so-\/called \(\backslash\)c MacroElements, as sketched in Fig. (c). Boundaries}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01827}01827 \textcolor{comment}{ of the \(\backslash\)c MacroElements are either given by (parts of) the (exact) }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01828}01828 \textcolor{comment}{ curvilinear boundaries (as specified by the \(\backslash\)c Domain's \(\backslash\)c GeomObjects)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01829}01829 \textcolor{comment}{ or by (arbitrary and usually straight) internal edges (or, in 3D, faces).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01830}01830 \textcolor{comment}{ In 2D, \(\backslash\)c MacroElements provide a mapping \(\backslash\)f\$ \{\(\backslash\)bf r\}(S\_0,S\_1) \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01831}01831 \textcolor{comment}{ from a local coordinate system \(\backslash\)f\$ (S\_0, S\_1) \(\backslash\)f\$,  with}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01832}01832 \textcolor{comment}{ \(\backslash\)f\$ S\_i \(\backslash\)in [-\/1..1]\string^2 \(\backslash\)f\$, to the points inside the \(\backslash\)c MacroElement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01833}01833 \textcolor{comment}{ via their member function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01834}01834 \textcolor{comment}{ \(\backslash\)code MacroElement::macro\_map(S,r) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01835}01835 \textcolor{comment}{ The mapping needs to be chosen such that for \(\backslash\)f\$ S\_1\(\backslash\)in [-\/1..1]\(\backslash\)f\$ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01836}01836 \textcolor{comment}{ the position vector \(\backslash\)f\$ \{\(\backslash\)bf r\}(S\_0=-\/1,S\_1) \(\backslash\)f\$  sweeps}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01837}01837 \textcolor{comment}{ along the `southern' edge of the \(\backslash\)c MacroElement, etc.; see Fig. (e).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01838}01838 \textcolor{comment}{ The form of the macro-\/element mapping is obviously not unique and it}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01839}01839 \textcolor{comment}{ depends on the \(\backslash\)c MacroElement's topology. The class }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01840}01840 \textcolor{comment}{ \(\backslash\)c QMacroElement<2> provides a mapping that is suitable for 2D quadrilateral }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01841}01841 \textcolor{comment}{ elements and can therefore be used with \(\backslash\)c RefineableQElement<2> s. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01842}01842 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01843}01843 \textcolor{comment}{ The constructors for objects of}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01844}01844 \textcolor{comment}{ type \(\backslash\)c Domain typically require a vector of pointers to the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01845}01845 \textcolor{comment}{ \(\backslash\)c GeomObjects that define its boundaries. The \(\backslash\)c Domain constructor}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01846}01846 \textcolor{comment}{ then usually employs function pointers to the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01847}01847 \textcolor{comment}{ \(\backslash\)c GeomObject::position(...) function to define the \(\backslash\)c MacroElement }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01848}01848 \textcolor{comment}{ boundaries. Once built, the \(\backslash\)c MacroElements are accessible }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01849}01849 \textcolor{comment}{ via the member function \(\backslash\)code Domain::macro\_element\_pt(...). \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01850}01850 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01851}01851 \textcolor{comment}{ We illustrate the macro-\/element based mesh generation and adaptation }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01852}01852 \textcolor{comment}{ process for the case of \(\backslash\)c RefineableQuadMesh meshes. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01853}01853 \textcolor{comment}{ Assume that the domain }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01854}01854 \textcolor{comment}{ is represented by an object of type \(\backslash\)c Domain. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01855}01855 \textcolor{comment}{ We build a coarse initial mesh which contains as many}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01856}01856 \textcolor{comment}{ \(\backslash\)c RefineableQElement<2>s as there are \(\backslash\)c QMacroElements in the \(\backslash\)c Domain.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01857}01857 \textcolor{comment}{ We associate each \(\backslash\)c RefineableQElement<2> with one of the \(\backslash\)c QMacroElements}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01858}01858 \textcolor{comment}{ by storing a pointer to the \(\backslash\)c QMacroElement in }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01859}01859 \textcolor{comment}{ \(\backslash\)c FiniteElement::Macro\_elem\_pt. Next, we use the \(\backslash\)c QMacroElements'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01860}01860 \textcolor{comment}{ macro map to determine the \(\backslash\)c RefineableQElement<2>'s nodal positions such }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01861}01861 \textcolor{comment}{ that, e.g., the \(\backslash\)c RefineableQElement<2>'s SW node is placed at the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01862}01862 \textcolor{comment}{ \(\backslash\)c QMacroElement 's local coordinates \(\backslash\)f\$(S\_0,S\_1)=(-\/1,-\/1)\(\backslash\)f\$, etc.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01863}01863 \textcolor{comment}{ The fraction of the \(\backslash\)c QMacroElement that is spanned by each}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01864}01864 \textcolor{comment}{ \(\backslash\)c RefineableQElement<2> is represented by the maximum and minimum}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01865}01865 \textcolor{comment}{ values of the \(\backslash\)c QMacroElement's local coordinates; the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01866}01866 \textcolor{comment}{ \(\backslash\)c RefineableQElement<2>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01867}01867 \textcolor{comment}{ constructor initially sets these values to the defaults of +1.0 and -\/1.0, }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01868}01868 \textcolor{comment}{ respectively, indicating that the \(\backslash\)c RefineableQElement<2> spans the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01869}01869 \textcolor{comment}{ entire area of the corresponding \(\backslash\)c QMacroElement.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01870}01870 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01871}01871 \textcolor{comment}{ With this additional information, we modify the  }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01872}01872 \textcolor{comment}{ \(\backslash\)c RefineableQElement<2>::build() process as follows:}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01873}01873 \textcolor{comment}{ -\/ After creating the son elements, we set their }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01874}01874 \textcolor{comment}{   \(\backslash\)c FiniteElement::Macro\_elem\_pt to that of their father.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01875}01875 \textcolor{comment}{ -\/ We adjust the son's maximum and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01876}01876 \textcolor{comment}{   minimum \(\backslash\)c MacroElement coordinates so that they span the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01877}01877 \textcolor{comment}{   appropriate fraction of the \(\backslash\)c MacroElement.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01878}01878 \textcolor{comment}{   For instance, for the SW son element of element 2 in the above}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01879}01879 \textcolor{comment}{   sketch, we set}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01880}01880 \textcolor{comment}{   \(\backslash\)f\$ S\_0\string^\{min\}=-\/1, \(\backslash\)  S\_0\string^\{max\}=0, \(\backslash\) S\_1\string^\{min\}=-\/1, \(\backslash\)  S\_1\string^\{max\}=0 \(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01881}01881 \textcolor{comment}{   Should this element get refined again, we set its NW son element's}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01882}01882 \textcolor{comment}{   coordinates to \(\backslash\)f\$ S\_0\string^\{min\}=-\/1, \(\backslash\)  S\_0\string^\{max\}=-\/0.5,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01883}01883 \textcolor{comment}{   \(\backslash\) S\_1\string^\{min\}=-\/0.5, \(\backslash\)  S\_1\string^\{max\}=0 \(\backslash\)f\$, etc.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01884}01884 \textcolor{comment}{ -\/ The nodal positions of newly created \(\backslash\)c Nodes are}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01885}01885 \textcolor{comment}{   determined via calls to the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01886}01886 \textcolor{comment}{   father element's \(\backslash\)c RefineableQElement<2>::get\_x(...) function.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01887}01887 \textcolor{comment}{   If the father element is associated with a \(\backslash\)c MacroElement}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01888}01888 \textcolor{comment}{   (indicated by a non-\/NULL \(\backslash\)c RefineableQElement<2>::Macro\_elem\_pt pointer),}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01889}01889 \textcolor{comment}{   this function does not }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01890}01890 \textcolor{comment}{   refer to \(\backslash\)c QElement::interpolated\_x(...) (i.e. the FE mapping)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01891}01891 \textcolor{comment}{   but places the new \(\backslash\)c Node at the appropriate point inside the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01892}01892 \textcolor{comment}{   father's \(\backslash\)c MacroElement. This ensures that \(\backslash\)c Nodes that are created }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01893}01893 \textcolor{comment}{   on the \(\backslash\)c Mesh boundaries get placed on the \(\backslash\)c Domain boundary,}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01894}01894 \textcolor{comment}{   as shown in Fig. (d).}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01895}01895 \textcolor{comment}{ -\/ In time-\/dependent, moving mesh problems, the history of the new \(\backslash\)c Nodes'}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01896}01896 \textcolor{comment}{   position is established by calls to the time-\/dependent version of the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01897}01897 \textcolor{comment}{   \(\backslash\)c MacroElement::macro\_map(...) function, which in turn refers to}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01898}01898 \textcolor{comment}{   the time-\/dependent \(\backslash\)c GeomObject::position(...) function of the }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01899}01899 \textcolor{comment}{   \(\backslash\)c GeomObjects that define the \(\backslash\)c Domain boundaries. Hence for all new }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01900}01900 \textcolor{comment}{   \(\backslash\)c Nodes, \(\backslash\)c Node::x(t,i) for \(\backslash\)c t>0, returns the position the \(\backslash\)c Node}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01901}01901 \textcolor{comment}{   would have had if it had already existed at the previous time level t. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01902}01902 \textcolor{comment}{ -\/ We retain the original procedure for initialising the current and }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01903}01903 \textcolor{comment}{   previous values at the new \(\backslash\)c Nodes and continue to determine them by }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01904}01904 \textcolor{comment}{   interpolation from the father element, based on the father }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01905}01905 \textcolor{comment}{   element's local coordinates. (We cannot determine the function }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01906}01906 \textcolor{comment}{   values at the exact new nodal positions because new \(\backslash\)c Nodes can be located }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01907}01907 \textcolor{comment}{   outside their father elements.)}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01908}01908 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01909}01909 \textcolor{comment}{ \(\backslash\)subsection moving\_mesh Macro-\/element-\/based node updates in moving mesh problems }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01910}01910 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01911}01911 \textcolor{comment}{  Once a \(\backslash\)c Mesh is associated with a \(\backslash\)c Domain, the function}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01912}01912 \textcolor{comment}{  \(\backslash\)c Mesh::node\_update() updates the nodal positions in response}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01913}01913 \textcolor{comment}{  to a change in the shape of the \(\backslash\)c GeomObjects that define the}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01914}01914 \textcolor{comment}{  \(\backslash\)c Domain boundaries. [Note: This function updates all nodal positions}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01915}01915 \textcolor{comment}{  first and then updates the positions of the hanging nodes}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01916}01916 \textcolor{comment}{  to subject them to the hanging node constraints.] }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01917}01917 \textcolor{comment}{  Alternative procedures for the update of the nodal positions in }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01918}01918 \textcolor{comment}{  response to changes in the domain boundary are implemented}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01919}01919 \textcolor{comment}{  in the \(\backslash\)c AlgebraicMesh, \(\backslash\)c SpineMesh and \(\backslash\)c SolidMesh classes. }}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01920}01920 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01921}01921 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01922}01922 \textcolor{comment}{<hr>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01923}01923 \textcolor{comment}{<hr>}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01924}01924 \textcolor{comment}{\(\backslash\)section pdf PDF file}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01925}01925 \textcolor{comment}{A <a href="{}../latex/refman.pdf"{}>pdf version</a> of this document is available.}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01926}01926 \textcolor{comment}{**/}}
\DoxyCodeLine{\Hypertarget{the__data__structure_8txt__doxygenified_8h_source_l01927}01927 }

\end{DoxyCode}

\hypertarget{binary__tree_8cc_source}{}\doxysection{binary\+\_\+tree.\+cc}
\label{binary__tree_8cc_source}\index{binary\_tree.cc@{binary\_tree.cc}}
\mbox{\hyperlink{binary__tree_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00026}00026 \textcolor{comment}{// Non-\/inline and non-\/templated functions for BinaryTree and BinaryTreeForest}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00027}00027 \textcolor{comment}{// classes}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00029}00029 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00030}00030 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00031}00031 \textcolor{preprocessor}{\#include <oomph-\/lib-\/config.h>}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00032}00032 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00034}00034 \textcolor{preprocessor}{\#include <set>}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00036}00036 \textcolor{comment}{// oomph-\/lib headers}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00037}00037 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{binary__tree_8h}{binary\_tree.h}}"{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00038}00038 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{refineable__line__element_8h}{refineable\_line\_element.h}}"{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00040}00040 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00041}00041 \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00042}00042   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00043}00043 \textcolor{comment}{  /// Boolean indicating that static member data has been setup.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00044}00044 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00045}00045   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1BinaryTree_a5890507c23970c4e2604fb65a546b9b4}{BinaryTree::Static\_data\_has\_been\_setup}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00046}00046 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00047}00047   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00048}00048 \textcolor{comment}{  /// Colours for neighbours in various directions (static data).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00049}00049 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00050}00050   Vector<std::string> \mbox{\hyperlink{classoomph_1_1BinaryTree_a14b12263ce207c5ab343cd2bc971b983}{BinaryTree::Colour}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00052}00052   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00053}00053 \textcolor{comment}{  /// S\_base(direction): Initial value for coordinate s on the edge}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00054}00054 \textcolor{comment}{  /// indicated by direction (L/R) (static data).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00055}00055 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00056}00056   Vector<double> \mbox{\hyperlink{classoomph_1_1BinaryTree_a0071402257f6137a0bb19dd702665a92}{BinaryTree::S\_base}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00058}00058   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00059}00059 \textcolor{comment}{  /// Translate (enumerated) directions into strings (static data).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00060}00060 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00061}00061   Vector<std::string> \mbox{\hyperlink{classoomph_1_1BinaryTree_a24331ca02be2713a58833da84ed02f9b}{BinaryTree::Direct\_string}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00063}00063   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00064}00064 \textcolor{comment}{  /// Get opposite edge, e.g. Reflect\_edge[N]=S (static data)}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00065}00065 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00066}00066   Vector<int> \mbox{\hyperlink{classoomph_1_1BinaryTree_af44e99a31403858e88fe62294eb40770}{BinaryTree::Reflect\_edge}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00068}00068   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00069}00069 \textcolor{comment}{  /// Array of direction/segment adjacency scheme:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00070}00070 \textcolor{comment}{  /// Is\_adjacent(i\_vertex,j\_segment): Is vertex adjacent to segment?}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00071}00071 \textcolor{comment}{  /// (static data)}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00072}00072 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00073}00073   DenseMatrix<bool> \mbox{\hyperlink{classoomph_1_1BinaryTree_ae8d579bfff3e2b7b3c344b6839aaa9f3}{BinaryTree::Is\_adjacent}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00075}00075   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00076}00076 \textcolor{comment}{  /// Reflection scheme: Reflect(direction,segment): Get mirror of segment}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00077}00077 \textcolor{comment}{  /// in specified direction. E.g. Reflect(L,L)=R (static data)}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00078}00078 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00079}00079   DenseMatrix<int> \mbox{\hyperlink{classoomph_1_1BinaryTree_aa039fcc5eb37f101d449582af4be33fc}{BinaryTree::Reflect}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00081}00081   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00082}00082 \textcolor{comment}{  /// Set up the static data stored in the BinaryTree -\/-\/ this needs to be}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00083}00083 \textcolor{comment}{  /// called before BinaryTrees can be used. Automatically called by}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00084}00084 \textcolor{comment}{  /// RefineableLineMesh constructor.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00085}00085 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00086}\mbox{\hyperlink{classoomph_1_1BinaryTree_a46528d3d7749ee316f193f28b5abd8fb}{00086}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1BinaryTree_a46528d3d7749ee316f193f28b5abd8fb}{BinaryTree::setup\_static\_data}}()}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00087}00087   \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00088}00088     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00089}00089 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00090}00090 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00091}00091     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}} != \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{BinaryTree::OMEGA}})}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00092}00092     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00093}00093       std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00094}00094       error\_stream << \textcolor{stringliteral}{"{}Inconsistent enumeration!  \(\backslash\)n    Tree::OMEGA="{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00095}00095                    << \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{Tree::OMEGA}} << \textcolor{stringliteral}{"{}\(\backslash\)nBinaryTree::OMEGA="{}} << \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{BinaryTree::OMEGA}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00096}00096                    << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00097}00097       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00098}00098         error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00099}00099     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00100}00100 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00102}00102     \textcolor{comment}{// Set flag to indicate that static data has been setup}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00103}00103     \mbox{\hyperlink{classoomph_1_1BinaryTree_a5890507c23970c4e2604fb65a546b9b4}{Static\_data\_has\_been\_setup}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00105}00105     \textcolor{comment}{// Tecplot colours for neighbours in various directions}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00106}00106     \mbox{\hyperlink{classoomph_1_1BinaryTree_a14b12263ce207c5ab343cd2bc971b983}{Colour}}.resize(27);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00108}00108     \mbox{\hyperlink{classoomph_1_1BinaryTree_a14b12263ce207c5ab343cd2bc971b983}{Colour}}[\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}] = \textcolor{stringliteral}{"{}RED"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00109}00109     \mbox{\hyperlink{classoomph_1_1BinaryTree_a14b12263ce207c5ab343cd2bc971b983}{Colour}}[\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}] = \textcolor{stringliteral}{"{}CYAN"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00110}00110     \mbox{\hyperlink{classoomph_1_1BinaryTree_a14b12263ce207c5ab343cd2bc971b983}{Colour}}[\mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{OMEGA}}] = \textcolor{stringliteral}{"{}YELLOW"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00111}00111 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00112}00112     \textcolor{comment}{// S\_base(direction): Initial value for coordinate s on the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00113}00113     \textcolor{comment}{// edge indicated by direction (L/R)}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00114}00114     \mbox{\hyperlink{classoomph_1_1BinaryTree_a0071402257f6137a0bb19dd702665a92}{S\_base}}.resize(27);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00116}00116     \mbox{\hyperlink{classoomph_1_1BinaryTree_a0071402257f6137a0bb19dd702665a92}{S\_base}}[\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}] = -\/1.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00117}00117     \mbox{\hyperlink{classoomph_1_1BinaryTree_a0071402257f6137a0bb19dd702665a92}{S\_base}}[\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}] = 1.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00119}00119     \textcolor{comment}{// Translate (enumerated) directions into strings}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00120}00120     \mbox{\hyperlink{classoomph_1_1BinaryTree_a24331ca02be2713a58833da84ed02f9b}{Direct\_string}}.resize(27);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00121}00121 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00122}00122     \mbox{\hyperlink{classoomph_1_1BinaryTree_a24331ca02be2713a58833da84ed02f9b}{Direct\_string}}[\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}] = \textcolor{stringliteral}{"{}L"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00123}00123     \mbox{\hyperlink{classoomph_1_1BinaryTree_a24331ca02be2713a58833da84ed02f9b}{Direct\_string}}[\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}] = \textcolor{stringliteral}{"{}R"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00124}00124     \mbox{\hyperlink{classoomph_1_1BinaryTree_a24331ca02be2713a58833da84ed02f9b}{Direct\_string}}[\mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{OMEGA}}] = \textcolor{stringliteral}{"{}OMEGA"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00125}00125 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00126}00126     \textcolor{comment}{// Build direction/segment adjacency scheme:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00127}00127     \textcolor{comment}{// Is\_adjacent(i\_vertex,j\_segment): Is vertex adjacent to segment?}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00128}00128     \mbox{\hyperlink{classoomph_1_1BinaryTree_ae8d579bfff3e2b7b3c344b6839aaa9f3}{Is\_adjacent}}.resize(27, 27);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00130}00130     \mbox{\hyperlink{classoomph_1_1BinaryTree_ae8d579bfff3e2b7b3c344b6839aaa9f3}{Is\_adjacent}}(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}) = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00131}00131     \mbox{\hyperlink{classoomph_1_1BinaryTree_ae8d579bfff3e2b7b3c344b6839aaa9f3}{Is\_adjacent}}(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}) = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00132}00132     \mbox{\hyperlink{classoomph_1_1BinaryTree_ae8d579bfff3e2b7b3c344b6839aaa9f3}{Is\_adjacent}}(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}) = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00133}00133     \mbox{\hyperlink{classoomph_1_1BinaryTree_ae8d579bfff3e2b7b3c344b6839aaa9f3}{Is\_adjacent}}(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}) = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00134}00134 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00135}00135     \textcolor{comment}{// Build reflection scheme: Reflect(direction,segment):}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00136}00136     \textcolor{comment}{// Get mirror of segment in direction}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00137}00137     \mbox{\hyperlink{classoomph_1_1BinaryTree_aa039fcc5eb37f101d449582af4be33fc}{Reflect}}.resize(27, 27);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00138}00138 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00139}00139     \mbox{\hyperlink{classoomph_1_1BinaryTree_aa039fcc5eb37f101d449582af4be33fc}{Reflect}}(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}) = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00140}00140     \mbox{\hyperlink{classoomph_1_1BinaryTree_aa039fcc5eb37f101d449582af4be33fc}{Reflect}}(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}) = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00141}00141     \mbox{\hyperlink{classoomph_1_1BinaryTree_aa039fcc5eb37f101d449582af4be33fc}{Reflect}}(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}) = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00142}00142     \mbox{\hyperlink{classoomph_1_1BinaryTree_aa039fcc5eb37f101d449582af4be33fc}{Reflect}}(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}, \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}) = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00143}00143 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00144}00144     \textcolor{comment}{// Get opposite edge, e.g. Reflect\_edge(L)=R}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00145}00145     \mbox{\hyperlink{classoomph_1_1BinaryTree_af44e99a31403858e88fe62294eb40770}{Reflect\_edge}}.resize(27);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00146}00146 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00147}00147     \mbox{\hyperlink{classoomph_1_1BinaryTree_af44e99a31403858e88fe62294eb40770}{Reflect\_edge}}[\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00148}00148     \mbox{\hyperlink{classoomph_1_1BinaryTree_af44e99a31403858e88fe62294eb40770}{Reflect\_edge}}[\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}] = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00149}00149   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00151}00151   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00152}00152 \textcolor{comment}{  /// Return pointer to greater or equal-\/sized edge neighbour in specified}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00153}00153 \textcolor{comment}{  /// \(\backslash\)c direction; also provide info regarding the relative size of the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00154}00154 \textcolor{comment}{  /// neighbour:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00155}00155 \textcolor{comment}{  /// -\/ In the present binary tree, the left vertex is located at the local}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00156}00156 \textcolor{comment}{  ///   coordinate s = -\/1. This point is located at the local coordinate}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00157}00157 \textcolor{comment}{  ///   s = \(\backslash\)c s\_in\_neighbour[0] in the neighbouring binary tree.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00158}00158 \textcolor{comment}{  /// -\/ We're looking for a neighbour in the specified \(\backslash\)c direction. When}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00159}00159 \textcolor{comment}{  ///   viewed from the neighbouring binary tree, the edge that separates}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00160}00160 \textcolor{comment}{  ///   the present binary tree from its neighbour is the neighbour's}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00161}00161 \textcolor{comment}{  ///   \(\backslash\)c edge edge. Since in 1D there can be no rotation between the two}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00162}00162 \textcolor{comment}{  ///   binary trees, this is a simple reflection. For instance, if we're}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00163}00163 \textcolor{comment}{  ///   looking for a neighhbour in the \(\backslash\)c L [eft] \(\backslash\)c direction, \(\backslash\)c edge}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00164}00164 \textcolor{comment}{  ///   will be \(\backslash\)c R [ight].}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00165}00165 \textcolor{comment}{  /// -\/ \(\backslash\)c diff\_level <= 0 indicates the difference in refinement levels}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00166}00166 \textcolor{comment}{  ///   between the two neighbours. If \(\backslash\)c diff\_level==0, the neighbour has}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00167}00167 \textcolor{comment}{  ///   the same size as the current binary tree.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00168}00168 \textcolor{comment}{  /// -\/ \(\backslash\)c in\_neighbouring\_tree returns true if we have had to flip to a}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00169}00169 \textcolor{comment}{  ///   different root, even if that root is actually the same (as it can}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00170}00170 \textcolor{comment}{  ///   be in periodic problems).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00171}00171 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00172}\mbox{\hyperlink{classoomph_1_1BinaryTree_aba768160bad3531d0f62033788619f56}{00172}}   \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* \mbox{\hyperlink{classoomph_1_1BinaryTree_aba768160bad3531d0f62033788619f56}{BinaryTree::gteq\_edge\_neighbour}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& direction,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00173}00173                                               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& s\_in\_neighbour,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00174}00174                                               \textcolor{keywordtype}{int}\& edge,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00175}00175                                               \textcolor{keywordtype}{int}\& diff\_level,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00176}00176                                               \textcolor{keywordtype}{bool}\& in\_neighbouring\_tree)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00177}00177 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00178}00178     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00179}00179 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00180}00180 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00181}00181     \textcolor{keywordflow}{if} ((direction != \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}) \&\& (direction != \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}))}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00182}00182     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00183}00183       std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00184}00184       error\_stream << \textcolor{stringliteral}{"{}Direction "{}} << direction << \textcolor{stringliteral}{"{} is not L or R"{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00185}00185                    << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00187}00187       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00188}00188         error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00189}00189     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00190}00190 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00191}00191 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00192}00192     \textcolor{comment}{// Initialise in\_neighbouring tree to false. It will be set to true}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00193}00193     \textcolor{comment}{// during the recursion if we do actually hop over into the neighbour}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00194}00194     in\_neighbouring\_tree = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00196}00196     \textcolor{comment}{// Maximum level to which we're allowed to descend (we only want}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00197}00197     \textcolor{comment}{// greater-\/or-\/equal-\/sized neighbours)}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00198}00198     \textcolor{keywordtype}{int} max\_level = \mbox{\hyperlink{classoomph_1_1Tree_a9ac30decb7a63027906880620f8b98ee}{Level}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00200}00200     \textcolor{comment}{// Current element has the following root:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00201}00201     \mbox{\hyperlink{classoomph_1_1BinaryTreeRoot}{BinaryTreeRoot}}* orig\_root\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTreeRoot}{BinaryTreeRoot}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Tree_a61782afd668561ad7ab324f658ffeb6a}{Root\_pt}});}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00203}00203     \textcolor{comment}{// Initialise offset in local coordinate}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00204}00204     \textcolor{keywordtype}{double} s\_diff = 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00205}00205 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00206}00206     \textcolor{comment}{// Initialise difference in level}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00207}00207     diff\_level = 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00208}00208 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00209}00209     \textcolor{comment}{// Find neighbour}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00210}00210     \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* return\_pt = \mbox{\hyperlink{classoomph_1_1BinaryTree_aba768160bad3531d0f62033788619f56}{gteq\_edge\_neighbour}}(direction,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00211}00211                                                 s\_diff,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00212}00212                                                 diff\_level,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00213}00213                                                 in\_neighbouring\_tree,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00214}00214                                                 max\_level,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00215}00215                                                 orig\_root\_pt);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00216}00216 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00217}00217     \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* neighb\_pt = return\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00218}00218 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00219}00219     \textcolor{comment}{// If neighbour exists...}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00220}00220     \textcolor{keywordflow}{if} (neighb\_pt != 0)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00221}00221     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00222}00222       \textcolor{comment}{// What's the direction of the interfacial edge when viewed from within}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00223}00223       \textcolor{comment}{// the neighbour element?}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00224}00224       edge = \mbox{\hyperlink{classoomph_1_1BinaryTree_af44e99a31403858e88fe62294eb40770}{Reflect\_edge}}[direction];}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00225}00225 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00226}00226       \textcolor{comment}{// What's the local coordinate s at which this edge is located in the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00227}00227       \textcolor{comment}{// neighbouring element?}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00228}00228       s\_in\_neighbour[0] = \mbox{\hyperlink{classoomph_1_1BinaryTree_a0071402257f6137a0bb19dd702665a92}{S\_base}}[edge];}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00229}00229     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00230}00230     \textcolor{keywordflow}{return} return\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00231}00231   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00232}00232 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00233}00233   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00234}00234 \textcolor{comment}{  /// Find `greater-\/or-\/equal-\/sized edge neighbour' in given direction (L/R).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00235}00235 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00236}00236 \textcolor{comment}{  /// This is an auxiliary routine which allows neighbour finding in}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00237}00237 \textcolor{comment}{  /// adjacent binary trees. Needs to keep track of previous son types}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00238}00238 \textcolor{comment}{  /// and the maximum level to which search is performed.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00239}00239 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00240}00240 \textcolor{comment}{  /// Parameters:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00241}00241 \textcolor{comment}{  /// -\/ direction (L/R): Direction in which neighbour has to be found.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00242}00242 \textcolor{comment}{  /// -\/ s\_diff: Offset of left vertex from corresponding vertex in}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00243}00243 \textcolor{comment}{  ///   neighbour. Note that this is input/output as it needs to be}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00244}00244 \textcolor{comment}{  ///   incremented/decremented during the recursive calls to this function.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00245}00245 \textcolor{comment}{  /// -\/ edge: We're looking for the neighbour across our edge 'direction'}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00246}00246 \textcolor{comment}{  ///   (L/R). When viewed from the neighbour, this edge is `edge' (L/R).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00247}00247 \textcolor{comment}{  ///   Since there is no relative rotation between neighbours this is a}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00248}00248 \textcolor{comment}{  ///   mere reflection, e.g. direction=L  -\/-\/> edge=R etc.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00249}00249 \textcolor{comment}{  /// -\/ diff\_level <= 0 indicates the difference in binary tree levels}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00250}00250 \textcolor{comment}{  ///   between the current element and its neighbour.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00251}00251 \textcolor{comment}{  /// -\/ max\_level is the maximum level to which the neighbour search is}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00252}00252 \textcolor{comment}{  ///   allowed to proceed. This is again necessary because in a forest,}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00253}00253 \textcolor{comment}{  ///   the neighbour search isn't based on pure recursion.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00254}00254 \textcolor{comment}{  /// -\/ orig\_root\_pt identifies the root node of the element whose}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00255}00255 \textcolor{comment}{  ///   neighbour we're really trying to find by all these recursive calls.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00256}00256 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00257}\mbox{\hyperlink{classoomph_1_1BinaryTree_aef4ea20b1eb9525513a505975a61d35d}{00257}}   \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* \mbox{\hyperlink{classoomph_1_1BinaryTree_aba768160bad3531d0f62033788619f56}{BinaryTree::gteq\_edge\_neighbour}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00258}00258     \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& direction,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00259}00259     \textcolor{keywordtype}{double}\& s\_diff,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00260}00260     \textcolor{keywordtype}{int}\& diff\_level,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00261}00261     \textcolor{keywordtype}{bool}\& in\_neighbouring\_tree,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00262}00262     \textcolor{keywordtype}{int} max\_level,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00263}00263     \mbox{\hyperlink{classoomph_1_1BinaryTreeRoot}{BinaryTreeRoot}}* \textcolor{keyword}{const}\& orig\_root\_pt)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00264}00264 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00265}00265     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00266}00266 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00267}00267 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00268}00268     \textcolor{keywordflow}{if} ((direction != \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}) \&\& (direction != \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}))}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00269}00269     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00270}00270       std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00271}00271       error\_stream << \textcolor{stringliteral}{"{}Direction "{}} << direction << \textcolor{stringliteral}{"{} is not L or R"{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00272}00272                    << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00273}00273 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00274}00274       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00275}00275         error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00276}00276     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00277}00277 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00278}00278 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00279}00279     \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* next\_el\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00280}00280     \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* return\_el\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00281}00281 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00282}00282     \textcolor{comment}{// STEP 1: Find the neighbour's father}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00283}00283     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00284}00284 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00285}00285     \textcolor{comment}{// Does the element have a father?}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00286}00286     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Tree_a001ce5515a3d76cdad248695e149504b}{Father\_pt}} != 0)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00287}00287     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00288}00288       \textcolor{comment}{// If the present segment (whose location inside its father element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00289}00289       \textcolor{comment}{// is specified by Son\_type) is adjacent to the father's edge in the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00290}00290       \textcolor{comment}{// required direction, then its neighbour has a different father}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00291}00291       \textcolor{comment}{// -\/-\/-\/> we need to climb up the tree to the father and find his}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00292}00292       \textcolor{comment}{// neighbour in the required direction. Note that this is the cunning}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00293}00293       \textcolor{comment}{// recursive part. The returning may not stop until we hit the very}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00294}00294       \textcolor{comment}{// top of the tree, when the element does NOT have a father.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00295}00295       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1BinaryTree_ae8d579bfff3e2b7b3c344b6839aaa9f3}{Is\_adjacent}}(direction, \mbox{\hyperlink{classoomph_1_1Tree_a83fe7895af25c9f60062c081fc51967c}{Son\_type}}))}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00296}00296       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00297}00297         next\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Tree_a001ce5515a3d76cdad248695e149504b}{Father\_pt}})-\/>\mbox{\hyperlink{classoomph_1_1BinaryTree_aba768160bad3531d0f62033788619f56}{gteq\_edge\_neighbour}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00298}00298           direction,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00299}00299           s\_diff,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00300}00300           diff\_level,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00301}00301           in\_neighbouring\_tree,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00302}00302           max\_level,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00303}00303           orig\_root\_pt);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00304}00304       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00305}00305       \textcolor{comment}{// If the present segment is not adjacent to the father's edge in the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00306}00306       \textcolor{comment}{// required direction, then the neighbour has the same father and is}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00307}00307       \textcolor{comment}{// obtained by the appropriate reflection inside the father element.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00308}00308       \textcolor{comment}{// This will only be called if we have not left the original tree.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00309}00309       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00310}00310       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00311}00311         next\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Tree_a001ce5515a3d76cdad248695e149504b}{Father\_pt}});}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00312}00312       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00313}00313 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00314}00314       \textcolor{comment}{// We're about to ascend one level}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00315}00315       diff\_level -\/= 1;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00316}00316 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00317}00317       \textcolor{comment}{// Work out position of left corner of present edge in its father element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00318}00318       s\_diff += pow(0.5, -\/diff\_level);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00320}00320       \textcolor{comment}{// STEP 2: We have now located the neighbour's father and need to}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00321}00321       \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/ find the appropriate son.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00322}00322 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00323}00323       \textcolor{comment}{// Buffer cases where the neighbour (and hence its father) lie outside}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00324}00324       \textcolor{comment}{// the boundary}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00325}00325       \textcolor{keywordflow}{if} (next\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00326}00326       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00327}00327         \textcolor{comment}{// If the father is a leaf then we can't descend to the same}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00328}00328         \textcolor{comment}{// level as the present node -\/-\/-\/> simply return the father himself}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00329}00329         \textcolor{comment}{// as the (greater) neighbour. Same applies if we are about to}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00330}00330         \textcolor{comment}{// descend lower than the max\_level (in a  neighbouring tree).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00331}00331         \textcolor{keywordflow}{if} ((next\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_ac6b9069f345b296654421604c5569af6}{Son\_pt}}.size() == 0) ||}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00332}00332             (next\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a9ac30decb7a63027906880620f8b98ee}{Level}} > max\_level -\/ 1))}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00333}00333         \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00334}00334           return\_el\_pt = next\_el\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00335}00335         \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00336}00336         \textcolor{comment}{// We have located the neighbour's father: The position of the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00337}00337         \textcolor{comment}{// neighbour is obtained by `reflecting' the position of the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00338}00338         \textcolor{comment}{// node itself. We know exactly how to reflect because we know which}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00339}00339         \textcolor{comment}{// son type we are and we have the pointer to the neighbour's father.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00340}00340         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00341}00341         \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00342}00342           \textcolor{keywordtype}{int} son\_segment = \mbox{\hyperlink{classoomph_1_1BinaryTree_aa039fcc5eb37f101d449582af4be33fc}{Reflect}}(direction, \mbox{\hyperlink{classoomph_1_1Tree_a83fe7895af25c9f60062c081fc51967c}{Son\_type}});}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00343}00343 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00344}00344           \textcolor{comment}{// The next element in the tree is the appropriate son of the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00345}00345           \textcolor{comment}{// neighbour's father}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00346}00346           return\_el\_pt =}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00347}00347             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}*\textcolor{keyword}{>}(next\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_ac6b9069f345b296654421604c5569af6}{Son\_pt}}[son\_segment]);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00349}00349           \textcolor{comment}{// Work out position of left corner of present edge in next}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00350}00350           \textcolor{comment}{// higher element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00351}00351           s\_diff -\/= pow(0.5, -\/diff\_level);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00353}00353           \textcolor{comment}{// We have just descended one level}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00354}00354           diff\_level += 1;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00355}00355         \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00356}00356       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00357}00357       \textcolor{comment}{// The neighbour's father lies outside the boundary -\/-\/> the neighbour}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00358}00358       \textcolor{comment}{// itself does too -\/-\/> return NULL}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00359}00359       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00360}00360       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00361}00361         return\_el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00362}00362       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00363}00363     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00364}00364     \textcolor{comment}{// Element does not have a father -\/-\/> check if it has a neighbouring}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00365}00365     \textcolor{comment}{// tree in the appropriate direction}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00366}00366     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00367}00367     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00368}00368       \textcolor{comment}{// Find neighbouring root}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00369}00369       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Tree_a61782afd668561ad7ab324f658ffeb6a}{Root\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1TreeRoot_ae25383c6dd2ab2def3dc98bb5e279d58}{neighbour\_pt}}(direction) != 0)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00370}00370       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00371}00371         \textcolor{comment}{// In this case we have moved to a neighbour, so set the flag}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00372}00372         in\_neighbouring\_tree = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00373}00373         return\_el\_pt =}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00374}00374           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTreeRoot}{BinaryTreeRoot}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Tree_a61782afd668561ad7ab324f658ffeb6a}{Root\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1TreeRoot_ae25383c6dd2ab2def3dc98bb5e279d58}{neighbour\_pt}}(direction));}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00375}00375       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00376}00376       \textcolor{comment}{// No neighbouring tree, so there really is no neighbour -\/-\/> return NULL}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00377}00377       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00378}00378       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00379}00379         return\_el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00380}00380       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00381}00381     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00383}00383     \textcolor{keywordflow}{return} return\_el\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00384}00384   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00385}00385 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00386}00386   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00387}00387 \textcolor{comment}{  /// Self-\/test: Check neighbour finding routine. For each element in the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00388}00388 \textcolor{comment}{  /// tree and for each vertex, determine the distance between the vertex}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00389}00389 \textcolor{comment}{  /// and its position in the neighbour. If the difference is less than}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00390}00390 \textcolor{comment}{  /// Tree::Max\_neighbour\_finding\_tolerance return success (0), otherwise}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00391}00391 \textcolor{comment}{  /// failure (1).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00392}00392 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00393}\mbox{\hyperlink{classoomph_1_1BinaryTree_ac8052fae786bd4aad0a7334d04b59328}{00393}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1BinaryTree_ac8052fae786bd4aad0a7334d04b59328}{BinaryTree::self\_test}}()}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00394}00394   \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00395}00395     \textcolor{comment}{// Stick pointers to all nodes into Vector and number elements}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00396}00396     \textcolor{comment}{// in the process}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00397}00397     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Tree*>}} all\_nodes\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00398}00398     \mbox{\hyperlink{classoomph_1_1Tree_a2c84b4e4700a825ef0a6ca533b9ae895}{stick\_all\_tree\_nodes\_into\_vector}}(all\_nodes\_pt);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00399}00399     \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} count = 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00400}00400     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} num\_nodes = all\_nodes\_pt.size();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00401}00401     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < num\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00402}00402     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00403}00403       all\_nodes\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>object\_pt()-\/>set\_number(++count);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00404}00404     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00405}00405 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00406}00406     \textcolor{comment}{// Check neighbours (distance between hanging nodes) -\/-\/ don't print}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00407}00407     \textcolor{comment}{// (keep output streams closed)}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00408}00408     \textcolor{keywordtype}{double} max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00409}00409     std::ofstream neighbours\_file;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00410}00410     std::ofstream neighbours\_txt\_file;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00411}00411     \mbox{\hyperlink{classoomph_1_1BinaryTree_a49791c16aedc51ecd542ce65507c68c6}{BinaryTree::doc\_neighbours}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00412}00412       all\_nodes\_pt, neighbours\_file, neighbours\_txt\_file, max\_error);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00413}00413 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00414}00414     \textcolor{keywordflow}{if} (max\_error > \mbox{\hyperlink{classoomph_1_1Tree_aef9abebc166fa3bf81ecb59ec0d5d6b2}{Max\_neighbour\_finding\_tolerance}})}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00415}00415     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00416}00416       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n \(\backslash\)n Failed self\_test() for BinaryTree: Max. error "{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00417}00417                  << max\_error << std::endl}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00418}00418                  << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00419}00419       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00420}00420     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00421}00421     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00422}00422     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00423}00423       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n \(\backslash\)n Passed self\_test() for BinaryTree: Max. error "{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00424}00424                  << max\_error << std::endl}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00425}00425                  << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00426}00426       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00427}00427     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00428}00428   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00429}00429 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00431}00431   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00432}00432 \textcolor{comment}{  /// Constructor for BinaryTreeForest:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00433}00433 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00434}00434 \textcolor{comment}{  /// Pass:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00435}00435 \textcolor{comment}{  ///  -\/ trees\_pt[], the Vector of pointers to the constituent trees}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00436}00436 \textcolor{comment}{  ///    (BinaryTreeRoot objects)}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00437}00437 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00438}\mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a534e8527d8701034afb5a8d6ab343de2}{00438}}   \mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a0185044e57a122d19fef2a5c9256a74b}{BinaryTreeForest::BinaryTreeForest}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<TreeRoot*>}}\& trees\_pt)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00439}00439     : \mbox{\hyperlink{classoomph_1_1TreeForest}{TreeForest}}(trees\_pt)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00440}00440   \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00441}00441 \textcolor{preprocessor}{\#ifdef LEAK\_CHECK}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00442}00442     LeakCheckNames::BinaryTreeForest\_build += 1;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00443}00443 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00444}00444 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00445}00445     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00446}00446 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00447}00447     \textcolor{comment}{// Set up the neighbours}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00448}00448     \mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a01845fafe6ef29f11226bf11e07eec1a}{find\_neighbours}}();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00449}00449   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00450}00450 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00451}00451   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00452}00452 \textcolor{comment}{  /// Set up the neighbour lookup schemes for all constituent binary trees.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00453}00453 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00454}\mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a01845fafe6ef29f11226bf11e07eec1a}{00454}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a01845fafe6ef29f11226bf11e07eec1a}{BinaryTreeForest::find\_neighbours}}()}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00455}00455   \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00456}00456     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00457}00457 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00458}00458     \textcolor{keywordtype}{unsigned} numtrees = \mbox{\hyperlink{classoomph_1_1TreeForest_a6796a34cf1211f554a59055ff5765863}{ntree}}();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00459}00459     \textcolor{keywordtype}{unsigned} n = 0; \textcolor{comment}{// to store nnode1d}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00460}00460     \textcolor{keywordflow}{if} (numtrees > 0)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00461}00461     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00462}00462       n = \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[0]-\/>object\_pt()-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00463}00463     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00464}00464     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00465}00465     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00466}00466       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00467}00467         \textcolor{stringliteral}{"{}Trying to setup the neighbour scheme for an empty forest\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00468}00468         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00469}00469         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00470}00470     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00471}00471 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00472}00472     \textcolor{comment}{// Number of vertex nodes: 2}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00473}00473     \textcolor{keywordtype}{unsigned} n\_vertex\_node = 2;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00475}00475     \textcolor{comment}{// Find connected trees by identifying those whose associated elements}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00476}00476     \textcolor{comment}{// share a common vertex node}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00477}00477     std::map<Node*, std::set<unsigned>> tree\_assoc\_with\_vertex\_node;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00479}00479     \textcolor{comment}{// Loop over all trees}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00480}00480     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < numtrees; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00481}00481     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00482}00482       \textcolor{comment}{// Loop over the vertex nodes of the associated element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00483}00483       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_vertex\_node; j++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00484}00484       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00485}00485         Node* nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1LineElementBase}{LineElementBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>object\_pt())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00486}00486                          -\/>vertex\_node\_pt(j);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00487}00487         tree\_assoc\_with\_vertex\_node[nod\_pt].insert(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00488}00488       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00489}00489     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00490}00490 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00491}00491     \textcolor{comment}{// For each tree we store a set of neighbouring trees}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00492}00492     \textcolor{comment}{// i.e. trees that share a node}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00493}00493     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<std::set<unsigned>}}> neighb\_tree(numtrees);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00494}00494 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00495}00495     \textcolor{comment}{// Loop over vertex nodes}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00496}00496     \textcolor{keywordflow}{for} (std::map<Node*, std::set<unsigned>>::iterator it =}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00497}00497            tree\_assoc\_with\_vertex\_node.begin();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00498}00498          it != tree\_assoc\_with\_vertex\_node.end();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00499}00499          it++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00500}00500     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00501}00501       \textcolor{comment}{// Loop over connected elements twice}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00502}00502       \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it\_el1 = it-\/>second.begin();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00503}00503            it\_el1 != it-\/>second.end();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00504}00504            it\_el1++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00505}00505       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00506}00506         \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = (*it\_el1);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00507}00507         \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it\_el2 = it-\/>second.begin();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00508}00508              it\_el2 != it-\/>second.end();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00509}00509              it\_el2++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00510}00510         \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00511}00511           \textcolor{keywordtype}{unsigned} j = (*it\_el2);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00512}00512           \textcolor{comment}{// These two elements are connected}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00513}00513           \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} != j)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00514}00514           \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00515}00515             neighb\_tree[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].insert(j);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00516}00516           \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00517}00517         \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00518}00518       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00519}00519     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00520}00520 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00521}00521     \textcolor{comment}{// Loop over all trees}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00522}00522     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < numtrees; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00523}00523     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00524}00524       \textcolor{comment}{// Loop over their neighbours}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00525}00525       \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = neighb\_tree[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].begin();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00526}00526            it != neighb\_tree[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}].end();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00527}00527            it++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00528}00528       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00529}00529         \textcolor{keywordtype}{unsigned} j = (*it);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00530}00530 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00531}00531         \textcolor{comment}{// is it the left-\/hand neighbour?}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00532}00532         \textcolor{keywordtype}{bool} is\_L\_neighbour = \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[j]-\/>object\_pt()-\/>get\_node\_number(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00533}00533                                 \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>object\_pt()-\/>node\_pt(0)) != -\/1;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00534}00534 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00535}00535         \textcolor{comment}{// is it the right-\/hand neighbour?}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00536}00536         \textcolor{keywordtype}{bool} is\_R\_neighbour = \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[j]-\/>object\_pt()-\/>get\_node\_number(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00537}00537                                 \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>object\_pt()-\/>node\_pt(n -\/ 1)) != -\/1;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00538}00538 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00539}00539         \textcolor{keywordflow}{if} (is\_L\_neighbour) \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>neighbour\_pt(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}) = \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[j];}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00540}00540         \textcolor{keywordflow}{if} (is\_R\_neighbour) \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>neighbour\_pt(\mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}) = \mbox{\hyperlink{classoomph_1_1TreeForest_a94d44c85e121758945f04aa28aa8df2a}{Trees\_pt}}[j];}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00541}00541       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00542}00542     \} \textcolor{comment}{// End of loop over all trees}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00543}00543   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00544}00544 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00545}00545   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00546}00546 \textcolor{comment}{  /// Document and check all the neighbours in all the nodes in the forest.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00547}00547 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00548}\mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a2e99234fcdc75760e00afb7d140c74ec}{00548}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a2e99234fcdc75760e00afb7d140c74ec}{BinaryTreeForest::check\_all\_neighbours}}(\mbox{\hyperlink{classoomph_1_1DocInfo}{DocInfo}}\& doc\_info)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00549}00549   \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00550}00550     \textcolor{comment}{// Create Vector of elements}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00551}00551     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Tree*>}} all\_tree\_nodes\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00552}00552     this-\/>\mbox{\hyperlink{classoomph_1_1TreeForest_a40bd3735303f019892b03d6a5355c8db}{stick\_all\_tree\_nodes\_into\_vector}}(all\_tree\_nodes\_pt);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00553}00553 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00554}00554     \textcolor{comment}{// Create storage for information files}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00555}00555     std::ofstream neigh\_file;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00556}00556     std::ofstream neigh\_txt\_file;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00557}00557 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00558}00558     \textcolor{comment}{// If we are documenting the results, then open the files}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00559}00559     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00560}00560     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00561}00561       std::ostringstream fullname;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00562}00562       fullname << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/neighbours"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00563}00563                << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00564}00564       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}opened "{}} << fullname.str() << \textcolor{stringliteral}{"{} to doc neighbours"{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00565}00565                  << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00566}00566       neigh\_file.open(fullname.str().c\_str());}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00567}00567       fullname.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00568}00568       fullname << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/neighbours"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00569}00569                << \textcolor{stringliteral}{"{}.txt"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00570}00570       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}opened "{}} << fullname.str() << \textcolor{stringliteral}{"{} to doc neighbours"{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00571}00571                  << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00572}00572       neigh\_txt\_file.open(fullname.str().c\_str());}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00573}00573     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00574}00574 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00575}00575     \textcolor{comment}{// Call the standard documentation function}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00576}00576     \textcolor{keywordtype}{double} max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00577}00577     \mbox{\hyperlink{classoomph_1_1BinaryTree_a49791c16aedc51ecd542ce65507c68c6}{BinaryTree::doc\_neighbours}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00578}00578       all\_tree\_nodes\_pt, neigh\_file, neigh\_txt\_file, max\_error);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00579}00579 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00580}00580     \textcolor{comment}{// If the error is too large, complain}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00581}00581     \textcolor{keywordflow}{if} (max\_error > \mbox{\hyperlink{classoomph_1_1Tree_a939e2d66696d9d59b47cea8c8d05957c}{Tree::max\_neighbour\_finding\_tolerance}}())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00582}00582     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00583}00583       std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00584}00584       error\_stream << \textcolor{stringliteral}{"{}Max. error in binary tree neighbour finding: "{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00585}00585                    << max\_error << \textcolor{stringliteral}{"{} is too big"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00586}00586       error\_stream}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00587}00587         << \textcolor{stringliteral}{"{}i.e. bigger than Tree::max\_neighbour\_finding\_tolerance()="{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00588}00588         << \mbox{\hyperlink{classoomph_1_1Tree_a939e2d66696d9d59b47cea8c8d05957c}{Tree::max\_neighbour\_finding\_tolerance}}() << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00589}00589 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00590}00590       \textcolor{comment}{// Close the files if they were opened}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00591}00591       \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00592}00592       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00593}00593         neigh\_file.close();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00594}00594         neigh\_txt\_file.close();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00595}00595       \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00596}00596 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00597}00597       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00598}00598         error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00599}00599     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00600}00600     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00601}00601     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00602}00602       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Max. error in binary tree neighbour finding: "{}} << max\_error}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00603}00603                  << \textcolor{stringliteral}{"{} is OK"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00604}00604       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00605}00605         << \textcolor{stringliteral}{"{}i.e. less than BinaryTree::max\_neighbour\_finding\_tolerance()="{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00606}00606         << \mbox{\hyperlink{classoomph_1_1Tree_a939e2d66696d9d59b47cea8c8d05957c}{BinaryTree::max\_neighbour\_finding\_tolerance}}() << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00607}00607     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00608}00608 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00609}00609     \textcolor{comment}{// Close the files if they were opened}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00610}00610     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00611}00611     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00612}00612       neigh\_file.close();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00613}00613       neigh\_txt\_file.close();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00614}00614     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00615}00615   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00616}00616 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00617}00617   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00618}00618 \textcolor{comment}{  /// Self test: Check neighbour finding routine. For each element in the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00619}00619 \textcolor{comment}{  /// tree and for each vertex, determine the distance between the vertex}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00620}00620 \textcolor{comment}{  /// and its position in the neighbour. If the difference is less than}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00621}00621 \textcolor{comment}{  /// Tree::Max\_neighbour\_finding\_tolerance return success (0), otherwise}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00622}00622 \textcolor{comment}{  /// failure (1).}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00623}00623 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00624}\mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a7cf3ec0bdb4c0955ca35bcc2e0874f80}{00624}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1BinaryTreeForest_a7cf3ec0bdb4c0955ca35bcc2e0874f80}{BinaryTreeForest::self\_test}}()}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00625}00625   \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00626}00626     \textcolor{comment}{// Stick pointers to all nodes into Vector and number elements}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00627}00627     \textcolor{comment}{// in the process}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00628}00628     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Tree*>}} all\_forest\_nodes\_pt;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00629}00629     \mbox{\hyperlink{classoomph_1_1TreeForest_a40bd3735303f019892b03d6a5355c8db}{stick\_all\_tree\_nodes\_into\_vector}}(all\_forest\_nodes\_pt);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00630}00630     \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} count = 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00631}00631     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} num\_nodes = all\_forest\_nodes\_pt.size();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00632}00632     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < num\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00633}00633     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00634}00634       all\_forest\_nodes\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>object\_pt()-\/>set\_number(++count);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00635}00635     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00637}00637     \textcolor{comment}{// Check neighbours (distance between hanging nodes) -\/-\/ don't print}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00638}00638     \textcolor{comment}{// (keep output streams closed)}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00639}00639     \textcolor{keywordtype}{double} max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00640}00640     std::ofstream neighbours\_file;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00641}00641     std::ofstream neighbours\_txt\_file;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00642}00642     \mbox{\hyperlink{classoomph_1_1BinaryTree_a49791c16aedc51ecd542ce65507c68c6}{BinaryTree::doc\_neighbours}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00643}00643       all\_forest\_nodes\_pt, neighbours\_file, neighbours\_txt\_file, max\_error);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00644}00644     \textcolor{keywordflow}{if} (max\_error > \mbox{\hyperlink{classoomph_1_1Tree_a939e2d66696d9d59b47cea8c8d05957c}{BinaryTree::max\_neighbour\_finding\_tolerance}}())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00645}00645     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00646}00646       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n \(\backslash\)n Failed self\_test() for BinaryTree: Max. error "{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00647}00647                  << max\_error << std::endl}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00648}00648                  << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00649}00649       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00650}00650     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00651}00651     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00652}00652     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00653}00653       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n \(\backslash\)n Passed self\_test() for BinaryTree: Max. error "{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00654}00654                  << max\_error << std::endl}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00655}00655                  << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00656}00656       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00657}00657     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00658}00658   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00659}00659 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00660}00660   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00661}00661 \textcolor{comment}{  /// Doc/check all neighbours of binary tree ("{}nodes"{}) contained in the}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00662}00662 \textcolor{comment}{  /// Vector forest\_node\_pt. Output into neighbours\_file which can be viewed}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00663}00663 \textcolor{comment}{  /// from tecplot with BinaryTreeNeighbours.mcr. Neighbour info and errors}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00664}00664 \textcolor{comment}{  /// are displayed on neighbours\_txt\_file. Finally, compute the maximum}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00665}00665 \textcolor{comment}{  /// error between vertices when viewed from neighbouring element. Output}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00666}00666 \textcolor{comment}{  /// is suppressed if the output streams are closed.}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00667}00667 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00668}\mbox{\hyperlink{classoomph_1_1BinaryTree_a49791c16aedc51ecd542ce65507c68c6}{00668}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1BinaryTree_a49791c16aedc51ecd542ce65507c68c6}{BinaryTree::doc\_neighbours}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<Tree*>}} forest\_nodes\_pt,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00669}00669                                   std::ofstream\& neighbours\_file,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00670}00670                                   std::ofstream\& neighbours\_txt\_file,}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00671}00671                                   \textcolor{keywordtype}{double}\& max\_error)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00672}00672   \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00673}00673     \textcolor{keyword}{using namespace }BinaryTreeNames;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00674}00674 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00675}00675     \textcolor{keywordtype}{int} diff\_level;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00676}00676     \textcolor{keywordtype}{double} s\_diff;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00677}00677     \textcolor{keywordtype}{bool} in\_neighbouring\_tree;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00678}00678     \textcolor{keywordtype}{int} edge = \mbox{\hyperlink{classoomph_1_1Tree_a9e532196340dcd859ff8207eea2ddbbc}{OMEGA}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00679}00679 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00680}00680     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(1);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00681}00681     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{namespaceoomph_a9d1d2da2b8bb8e73af72b5cadb8fe97c}{x}}(1);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00682}00682     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} prev\_son\_type;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00683}00683 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00684}00684     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} s\_in\_neighbour(1);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00685}00685 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00686}00686     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_small(1);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00687}00687     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_large(1);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00688}00688 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00689}00689     \textcolor{comment}{// Initialise error in vertex positions}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00690}00690     max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00691}00691 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00692}00692     \textcolor{comment}{// Loop over all elements to assign numbers for plotting}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00693}00693     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00694}00694     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} num\_nodes = forest\_nodes\_pt.size();}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00695}00695     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < num\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00696}00696     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00697}00697       \textcolor{comment}{// Set number}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00698}00698       forest\_nodes\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>object\_pt()-\/>set\_number(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00699}00699     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00700}00700 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00701}00701     \textcolor{comment}{// Loop over all elements for checks}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00702}00702     \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00703}00703     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < num\_nodes; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00704}00704     \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00705}00705       \textcolor{comment}{// Doc the element itself}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00706}00706       \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}*\textcolor{keyword}{>}(forest\_nodes\_pt[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00707}00707 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00708}00708       \textcolor{comment}{// If the object is incomplete, complain}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00709}00709       \textcolor{keywordflow}{if} (el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a50758228db823d72ea8da23dbb000901}{nodes\_built}}())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00710}00710       \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00711}00711         \textcolor{comment}{// Print it}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00712}00712         \textcolor{keywordflow}{if} (neighbours\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00713}00713         \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00714}00714           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4}{RefineableQElement<1>}}*\textcolor{keyword}{>}(el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00715}00715             -\/>output\_corners(neighbours\_file, \textcolor{stringliteral}{"{}BLACK"{}});}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00716}00716         \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00717}00717 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00718}00718         \textcolor{comment}{// Loop over directions to find neighbours}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00719}00719         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00720}00720         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} direction = \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a8df863dabb4096fa066f7a6dbf7502d1}{L}}; direction <= \mbox{\hyperlink{namespaceoomph_1_1BinaryTreeNames_a7ff5e7e46beae31bf81579531b1f9895a1bf47d3f36e6272d94344ae84aca2498}{R}}; direction++)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00721}00721         \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00722}00722           \textcolor{comment}{// Initialise difference in levels and coordinate offset}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00723}00723           diff\_level = 0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00724}00724           s\_diff = 0.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00725}00725 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00726}00726           \textcolor{comment}{// Find greater-\/or-\/equal-\/sized neighbour...}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00727}00727           \mbox{\hyperlink{classoomph_1_1BinaryTree}{BinaryTree}}* neighb\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1BinaryTree_aba768160bad3531d0f62033788619f56}{gteq\_edge\_neighbour}}(}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00728}00728             direction, s\_in\_neighbour, edge, diff\_level, in\_neighbouring\_tree);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00729}00729 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00730}00730           \textcolor{comment}{// If neighbour exist and nodes are created: Doc it}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00731}00731           \textcolor{keywordflow}{if} ((neighb\_pt != 0) \&\& (neighb\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a50758228db823d72ea8da23dbb000901}{nodes\_built}}()))}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00732}00732           \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00733}00733             \textcolor{comment}{// Doc neighbour stats}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00734}00734             \textcolor{keywordflow}{if} (neighbours\_txt\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00735}00735             \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00736}00736               neighbours\_txt\_file}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00737}00737                 << \mbox{\hyperlink{classoomph_1_1BinaryTree_a24331ca02be2713a58833da84ed02f9b}{Direct\_string}}[direction] << \textcolor{stringliteral}{"{} neighbour of "{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00738}00738                 << el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a49698dae92649ebf102dfb4359d7b0bf}{number}}() << \textcolor{stringliteral}{"{} is "{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00739}00739                 << neighb\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a49698dae92649ebf102dfb4359d7b0bf}{number}}() << \textcolor{stringliteral}{"{} diff\_level "{}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00740}00740                 << diff\_level << \textcolor{stringliteral}{"{} s\_diff "{}} << s\_diff}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00741}00741                 << \textcolor{stringliteral}{"{} inside neighbour the edge is "{}} << \mbox{\hyperlink{classoomph_1_1BinaryTree_a24331ca02be2713a58833da84ed02f9b}{Direct\_string}}[edge]}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00742}00742                 << std::endl}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00743}00743                 << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00744}00744             \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00745}00745 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00746}00746             \textcolor{comment}{// Plot neighbour in the appropriate colour}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00747}00747             \textcolor{keywordflow}{if} (neighbours\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00748}00748             \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00749}00749               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableQElement_3_011_01_4}{RefineableQElement<1>}}*\textcolor{keyword}{>}(neighb\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00750}00750                 -\/>output\_corners(neighbours\_file, \mbox{\hyperlink{classoomph_1_1BinaryTree_a14b12263ce207c5ab343cd2bc971b983}{Colour}}[direction]);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00751}00751             \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00752}00752 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00753}00753             \textcolor{comment}{// Check that local coordinates in the larger element (obtained}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00754}00754             \textcolor{comment}{// via s\_diff) lead to the same spatial point as the node vertices}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00755}00755             \textcolor{comment}{// in the current element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00756}00756             \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00757}00757               \textcolor{keywordflow}{if} (neighbours\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00758}00758               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00759}00759                 neighbours\_file << \textcolor{stringliteral}{"{}ZONE I=1 \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00760}00760               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00761}00761 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00762}00762               \textcolor{comment}{// Left vertex:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00763}00763               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00764}00764 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00765}00765               \textcolor{comment}{// Get coordinates in large (neighbour) element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00766}00766               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_in\_neighbour[0];}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00767}00767               neighb\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_large);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00768}00768 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00769}00769               \textcolor{comment}{// Get coordinates in small element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00770}00770               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(1);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00771}00771               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1BinaryTree_a0071402257f6137a0bb19dd702665a92}{S\_base}}[direction];}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00772}00772               el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_small);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00773}00773 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00774}00774               \textcolor{comment}{// Need to exclude periodic nodes from this check. There can}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00775}00775               \textcolor{comment}{// only be periodic nodes if we have moved into the neighbour}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00776}00776               \textcolor{keywordtype}{bool} is\_periodic = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00777}00777               \textcolor{keywordflow}{if} (in\_neighbouring\_tree)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00778}00778               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00779}00779                 \textcolor{comment}{// Is the node periodic?}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00780}00780                 is\_periodic =}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00781}00781                   el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a33b9926754cddfaafd9869af3fe266e7}{root\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1TreeRoot_a7be347e54e34f924c008c302f5146064}{is\_neighbour\_periodic}}(direction);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00782}00782               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00783}00783 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00784}00784               \textcolor{keywordtype}{double} error = 0.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00785}00785               \textcolor{comment}{// Only bother to calculate the error if the node is NOT periodic}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00786}00786               \textcolor{keywordflow}{if} (is\_periodic == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00787}00787               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00788}00788                 error += pow(x\_small[0] -\/ x\_large[0], 2);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00789}00789               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00790}00790 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00791}00791               \textcolor{comment}{// Take the root of the square error}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00792}00792               error = sqrt(error);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00793}00793               \textcolor{keywordflow}{if} (neighbours\_txt\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00794}00794               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00795}00795                 neighbours\_txt\_file << \textcolor{stringliteral}{"{}Error (1) "{}} << error << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00796}00796               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00797}00797 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00798}00798               \textcolor{keywordflow}{if} (std::fabs(error) > max\_error)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00799}00799               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00800}00800                 max\_error = std::fabs(error);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00801}00801               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00802}00802 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00803}00803               \textcolor{keywordflow}{if} (neighbours\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00804}00804               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00805}00805                 neighbours\_file << x\_large[0] << \textcolor{stringliteral}{"{}  0 \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00806}00806               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00807}00807 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00808}00808               \textcolor{comment}{// Right vertex:}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00809}00809               \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00810}00810 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00811}00811               \textcolor{comment}{// Get coordinates in large (neighbour) element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00812}00812               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = s\_in\_neighbour[0];}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00813}00813               neighb\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_large);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00814}00814 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00815}00815               \textcolor{comment}{// Get coordinates in small element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00816}00816               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[0] = \mbox{\hyperlink{classoomph_1_1BinaryTree_a0071402257f6137a0bb19dd702665a92}{S\_base}}[direction];}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00817}00817               el\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, x\_small);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00818}00818 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00819}00819               error = 0.0;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00820}00820               \textcolor{comment}{// Only do this if we are NOT periodic}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00821}00821               \textcolor{keywordflow}{if} (is\_periodic == \textcolor{keyword}{false})}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00822}00822               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00823}00823                 error += pow(x\_small[0] -\/ x\_large[0], 2);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00824}00824               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00825}00825               \textcolor{comment}{// Take the root of the square error}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00826}00826               error = sqrt(error);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00827}00827 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00828}00828               \textcolor{comment}{// error =}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00829}00829               \textcolor{comment}{// sqrt(pow(x\_small[0]-\/x\_large[0],2)+pow(x\_small[1]-\/x\_large[1],2));}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00830}00830               \textcolor{keywordflow}{if} (neighbours\_txt\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00831}00831               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00832}00832                 neighbours\_txt\_file << \textcolor{stringliteral}{"{}Error (2) "{}} << error << std::endl;}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00833}00833               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00834}00834 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00835}00835               \textcolor{keywordflow}{if} (std::fabs(error) > max\_error)}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00836}00836               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00837}00837                 max\_error = std::fabs(error);}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00838}00838               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00839}00839 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00840}00840               \textcolor{keywordflow}{if} (neighbours\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00841}00841               \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00842}00842                 neighbours\_file << x\_large[0] << \textcolor{stringliteral}{"{}  0 \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00843}00843               \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00844}00844             \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00845}00845             \textcolor{comment}{//        else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00846}00846             \textcolor{comment}{//         \{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00847}00847             \textcolor{comment}{//          // No neighbour: write dummy zone so tecplot can find}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00848}00848             \textcolor{comment}{//          four}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00849}00849             \textcolor{comment}{//          // neighbours for every element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00850}00850             \textcolor{comment}{//          if (neighbours\_file.is\_open())}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00851}00851             \textcolor{comment}{//            \{}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00852}00852             \textcolor{comment}{//             neighbours\_file << "{}ZONE I=1 \(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00853}00853             \textcolor{comment}{//             neighbours\_file << "{}-\/0.05 -\/0.05   0 \(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00854}00854             \textcolor{comment}{//             neighbours\_file << "{}-\/0.05 -\/0.05   0 \(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00855}00855             \textcolor{comment}{//            \}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00856}00856             \textcolor{comment}{//         \}}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00857}00857           \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00858}00858           \textcolor{comment}{// If neighbour does not exist: Insert blank zones into file}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00859}00859           \textcolor{comment}{// so that tecplot can find four neighbours for every element}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00860}00860           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00861}00861           \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00862}00862             \textcolor{keywordflow}{if} (neighbours\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00863}00863             \{}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00864}00864               neighbours\_file << \textcolor{stringliteral}{"{}ZONE \(\backslash\)n 0.00  0 \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00865}00865               neighbours\_file << \textcolor{stringliteral}{"{}ZONE I=1 \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00866}00866               neighbours\_file << \textcolor{stringliteral}{"{}-\/0.05  0 \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00867}00867               neighbours\_file << \textcolor{stringliteral}{"{}-\/0.05  0 \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00868}00868             \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00869}00869           \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00870}00870         \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00871}00871       \} \textcolor{comment}{// End of case when element can be documented}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00872}00872     \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00873}00873   \}}
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00874}00874 }
\DoxyCodeLine{\Hypertarget{binary__tree_8cc_source_l00875}00875 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

\hypertarget{mesh_8cc_source}{}\doxysection{mesh.\+cc}
\label{mesh_8cc_source}\index{mesh.cc@{mesh.cc}}
\mbox{\hyperlink{mesh_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00026}00026 \textcolor{comment}{// Non-\/inline member functions for general mesh classes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00028}00028 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00029}00029 \textcolor{preprocessor}{\#include "{}mpi.h"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00030}00030 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00032}00032 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00033}00033 \textcolor{preprocessor}{\#include <limits.h>}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00034}00034 \textcolor{preprocessor}{\#include <typeinfo>}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00037}00037 \textcolor{comment}{// oomph-\/lib headers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00038}00038 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{oomph__utilities_8h}{oomph\_utilities.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00039}00039 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{mesh_8h}{mesh.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00040}00040 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{problem_8h}{problem.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00041}00041 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{elastic__problems_8h}{elastic\_problems.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00042}00042 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{refineable__mesh_8h}{refineable\_mesh.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00043}00043 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{triangle__mesh_8h}{triangle\_mesh.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00044}00044 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{shape_8h}{shape.h}}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00046}00046 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00047}00047 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00048}00048   \textcolor{comment}{//======================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00049}00049 \textcolor{comment}{  /// The Steady Timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00050}00050 \textcolor{comment}{}  \textcolor{comment}{//======================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00051}00051   Steady<0> \mbox{\hyperlink{classoomph_1_1Mesh_a12243d0fee2b1fcee729ee5a4777ea10}{Mesh::Default\_TimeStepper}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00054}00054   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00055}00055 \textcolor{comment}{  /// Static boolean flag to control warning about mesh level timesteppers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00056}00056 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00057}00057   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1Mesh_ada6bc12304d1536b747596d1049e48be}{Mesh::Suppress\_warning\_about\_empty\_mesh\_level\_time\_stepper\_function}} =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00058}00058     \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00060}00060   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00061}00061 \textcolor{comment}{  /// Merge meshes.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00062}00062 \textcolor{comment}{  /// Note: This simply merges the meshes' elements and nodes (ignoring}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00063}00063 \textcolor{comment}{  /// duplicates; no boundary information etc. is created).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00064}00064 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00065}\mbox{\hyperlink{classoomph_1_1Mesh_af4e77a5529b2aabfed8289e313c1c8d9}{00065}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_af4e77a5529b2aabfed8289e313c1c8d9}{Mesh::merge\_meshes}}(\textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Mesh*>}}\& sub\_mesh\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00066}00066   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00067}00067     \textcolor{comment}{// No boundary lookup scheme is set up for the combined mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00068}00068     \mbox{\hyperlink{classoomph_1_1Mesh_a37f6d27447f643a74694012b09350ce9}{Lookup\_for\_elements\_next\_boundary\_is\_setup}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00070}00070     \textcolor{comment}{// Number of submeshes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00071}00071     \textcolor{keywordtype}{unsigned} nsub\_mesh = sub\_mesh\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00073}00073     \textcolor{comment}{// Initialise element, node and boundary counters for global mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00074}00074     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_element = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00075}00075     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00076}00076     \textcolor{keywordtype}{unsigned} n\_bound = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00078}00078     \textcolor{comment}{// Loop over submeshes and get total number of elements, nodes and}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00079}00079     \textcolor{comment}{// boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00080}00080     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} imesh = 0; imesh < nsub\_mesh; imesh++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00081}00081     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00082}00082       n\_element += sub\_mesh\_pt[imesh]-\/>nelement();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00083}00083       n\_node += sub\_mesh\_pt[imesh]-\/>nnode();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00084}00084       n\_bound += sub\_mesh\_pt[imesh]-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00085}00085     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00087}00087     \textcolor{comment}{// Reserve storage for element and node pointers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00088}00088     \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00089}00089     \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.reserve(n\_element);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00090}00090     \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00091}00091     \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.reserve(n\_node);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00092}00092 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00093}00093     \textcolor{comment}{// Resize vector of vectors of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00094}00094     \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00095}00095     \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}.resize(n\_bound);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00097}00097     \textcolor{comment}{// Sets of pointers to elements and nodes (to exlude duplicates -\/-\/ they}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00098}00098     \textcolor{comment}{// shouldn't occur anyway but if they do, they must only be added}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00099}00099     \textcolor{comment}{// once in the global mesh to avoid trouble in the timestepping)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00100}00100     std::set<GeneralisedElement*> element\_set\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00101}00101     std::set<Node*> node\_set\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00103}00103     \textcolor{comment}{// Counter for total number of boundaries in all the submeshes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00104}00104     \textcolor{keywordtype}{unsigned} ibound\_global = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00105}00105     \textcolor{comment}{// Loop over the number of submeshes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00106}00106     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} imesh = 0; imesh < nsub\_mesh; imesh++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00107}00107     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00108}00108       \textcolor{comment}{// Loop over the elements of the submesh and add to vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00109}00109       \textcolor{comment}{// duplicates are ignored}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00110}00110       \textcolor{keywordtype}{unsigned} nel\_before = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00111}00111       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_element = sub\_mesh\_pt[imesh]-\/>nelement();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00112}00112       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00113}00113       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00114}00114         \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = sub\_mesh\_pt[imesh]-\/>element\_pt(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00115}00115         element\_set\_pt.insert(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00116}00116         \textcolor{comment}{// Was it a duplicate?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00117}00117         \textcolor{keywordtype}{unsigned} nel\_now = element\_set\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00118}00118         \textcolor{keywordflow}{if} (nel\_now == nel\_before)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00119}00119         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00120}00120           std::ostringstream warning\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00121}00121           warning\_stream << \textcolor{stringliteral}{"{}WARNING: "{}} << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00122}00122                          << \textcolor{stringliteral}{"{}Element "{}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} << \textcolor{stringliteral}{"{} in submesh "{}} << imesh}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00123}00123                          << \textcolor{stringliteral}{"{} is a duplicate \(\backslash\)n and was ignored when assembling"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00124}00124                          << \textcolor{stringliteral}{"{} combined mesh."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00125}00125           \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(warning\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00126}00126                           \textcolor{stringliteral}{"{}Mesh::Mesh(const Vector<Mesh*>\&)"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00127}00127                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00128}00128         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00129}00129         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00130}00130         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00131}00131           \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.push\_back(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00132}00132         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00133}00133         nel\_before = nel\_now;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00134}00134       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00135}00135 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00136}00136       \textcolor{comment}{// Loop over the nodes of the submesh and add to vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00137}00137       \textcolor{comment}{// duplicates are ignored}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00138}00138       \textcolor{keywordtype}{unsigned} nnod\_before = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00139}00139       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = sub\_mesh\_pt[imesh]-\/>nnode();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00140}00140       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00141}00141       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00142}00142         Node* nod\_pt = sub\_mesh\_pt[imesh]-\/>node\_pt(n);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00143}00143         node\_set\_pt.insert(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00144}00144         \textcolor{comment}{// Was it a duplicate?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00145}00145         \textcolor{keywordtype}{unsigned} nnod\_now = node\_set\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00146}00146         \textcolor{keywordflow}{if} (nnod\_now == nnod\_before)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00147}00147         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00148}00148           std::ostringstream warning\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00149}00149           warning\_stream}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00150}00150             << \textcolor{stringliteral}{"{}WARNING: "{}} << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00151}00151             << \textcolor{stringliteral}{"{}Node "{}} << n << \textcolor{stringliteral}{"{} in submesh "{}} << imesh}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00152}00152             << \textcolor{stringliteral}{"{} is a duplicate \(\backslash\)n and was ignored when assembling "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00153}00153             << \textcolor{stringliteral}{"{}combined mesh."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00154}00154           \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(warning\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00155}00155                           \textcolor{stringliteral}{"{}Mesh::Mesh(const Vector<Mesh*>\&)"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00156}00156                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00157}00157         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00158}00158         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00159}00159         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00160}00160           \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00161}00161         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00162}00162         nnod\_before = nnod\_now;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00163}00163       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00164}00164 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00165}00165       \textcolor{comment}{// Loop over the boundaries of the submesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00166}00166       \textcolor{keywordtype}{unsigned} n\_bound = sub\_mesh\_pt[imesh]-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00167}00167       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ibound = 0; ibound < n\_bound; ibound++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00168}00168       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00169}00169         \textcolor{comment}{// Loop over the number of nodes on the boundary and add to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00170}00170         \textcolor{comment}{// global vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00171}00171         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_bound\_node = sub\_mesh\_pt[imesh]-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00172}00172         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_bound\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00173}00173         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00174}00174           \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound\_global].push\_back(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00175}00175             sub\_mesh\_pt[imesh]-\/>\mbox{\hyperlink{classoomph_1_1Mesh_afc4d1204afc31b9ec88fe82d8fc01625}{boundary\_node\_pt}}(ibound, n));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00176}00176         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00177}00177         \textcolor{comment}{// Increase the number of the global boundary counter}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00178}00178         ibound\_global++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00179}00179       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00180}00180     \} \textcolor{comment}{// End of loop over submeshes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00181}00181   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00182}00182 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00183}00183 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00184}00184   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00185}00185 \textcolor{comment}{  /// Remove the information about nodes stored on the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00186}00186 \textcolor{comment}{  /// b-\/th boundary of the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00187}00187 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00188}\mbox{\hyperlink{classoomph_1_1Mesh_a5bf720135d0728907b98c5d31157f569}{00188}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a8d86e14d55a1162e184bd7fac4630904}{Mesh::remove\_boundary\_nodes}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& b)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00189}00189   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00190}00190     \textcolor{comment}{// Loop over all the nodes on the boundary and call}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00191}00191     \textcolor{comment}{// their remove\_from\_boundary function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00192}00192     \textcolor{keywordtype}{unsigned} n\_boundary\_node = \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00193}00193     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_boundary\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00194}00194     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00195}00195       \mbox{\hyperlink{classoomph_1_1Mesh_afc4d1204afc31b9ec88fe82d8fc01625}{boundary\_node\_pt}}(b, n)-\/>remove\_from\_boundary(b);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00196}00196     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00197}00197     \textcolor{comment}{// Clear the storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00198}00198     \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b].clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00199}00199   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00200}00200 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00201}00201   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00202}00202 \textcolor{comment}{  /// Remove all information about mesh boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00203}00203 \textcolor{comment}{}  \textcolor{comment}{//================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00204}\mbox{\hyperlink{classoomph_1_1Mesh_a8d86e14d55a1162e184bd7fac4630904}{00204}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a8d86e14d55a1162e184bd7fac4630904}{Mesh::remove\_boundary\_nodes}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00205}00205   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00206}00206     \textcolor{comment}{// Loop over each boundary call remove\_boundary\_nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00207}00207     \textcolor{keywordtype}{unsigned} n\_bound = \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00208}00208     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < n\_bound; b++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00209}00209     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00210}00210       \mbox{\hyperlink{classoomph_1_1Mesh_a8d86e14d55a1162e184bd7fac4630904}{remove\_boundary\_nodes}}(b);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00211}00211     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00212}00212     \textcolor{comment}{// Clear the storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00213}00213     \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00214}00214   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00215}00215 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00216}00216   \textcolor{comment}{//============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00217}00217 \textcolor{comment}{  /// Remove the node node\_pt from the b-\/th boundary of the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00218}00218 \textcolor{comment}{  /// This function also removes the information from the Node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00219}00219 \textcolor{comment}{  /// itself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00220}00220 \textcolor{comment}{}  \textcolor{comment}{//===========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00221}\mbox{\hyperlink{classoomph_1_1Mesh_a1690e5351ff05b5e47db184f64b1edc4}{00221}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a1690e5351ff05b5e47db184f64b1edc4}{Mesh::remove\_boundary\_node}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& b, Node* \textcolor{keyword}{const}\& node\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00222}00222   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00223}00223     \textcolor{comment}{// Find the location of the node in the boundary}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00224}00224     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>::iterator}} it = std::find(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00225}00225       \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b].begin(), \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b].end(), \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00226}00226     \textcolor{comment}{// If the node is on this boundary}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00227}00227     \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b].end())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00228}00228     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00229}00229       \textcolor{comment}{// Remove the node from the mesh's list of boundary nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00230}00230       \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b].erase(it);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00231}00231       \textcolor{comment}{// Now remove the node's boundary information}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00232}00232       \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}-\/>remove\_from\_boundary(b);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00233}00233     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00234}00234     \textcolor{comment}{// If not do nothing}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00235}00235   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00236}00236 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00237}00237 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00238}00238   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00239}00239 \textcolor{comment}{  /// Add the node node\_pt to the b-\/th boundary of the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00240}00240 \textcolor{comment}{  /// This function also sets the boundary information in the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00241}00241 \textcolor{comment}{  /// Node itself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00242}00242 \textcolor{comment}{}  \textcolor{comment}{//=========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00243}\mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{00243}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a007b102ac8e42328872ad658d7110bfc}{Mesh::add\_boundary\_node}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& b, Node* \textcolor{keyword}{const}\& node\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00244}00244   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00245}00245     \textcolor{comment}{// Tell the node that it's on boundary b.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00246}00246     \textcolor{comment}{// At this point, if the node is not a BoundaryNode, the function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00247}00247     \textcolor{comment}{// should throw an exception.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00248}00248     \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}-\/>add\_to\_boundary(b);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00249}00249 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00250}00250     \textcolor{comment}{// Get the size of the Boundary\_node\_pt vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00251}00251     \textcolor{keywordtype}{unsigned} nbound\_node = \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00252}00252     \textcolor{keywordtype}{bool} node\_already\_on\_this\_boundary = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00253}00253     \textcolor{comment}{// Loop over the vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00254}00254     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < nbound\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00255}00255     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00256}00256       \textcolor{comment}{// is the current node here already?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00257}00257       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}} == \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b][n])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00258}00258       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00259}00259         node\_already\_on\_this\_boundary = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00260}00260       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00261}00261     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00262}00262 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00263}00263     \textcolor{comment}{// Add the base node pointer to the vector if it's not there already}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00264}00264     \textcolor{keywordflow}{if} (!node\_already\_on\_this\_boundary)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00265}00265     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00266}00266       \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[b].push\_back(\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00267}00267     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00268}00268   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00269}00269 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00270}00270 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00271}00271   \textcolor{comment}{//=======================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00272}00272 \textcolor{comment}{  /// Update nodal positions in response to changes in the domain shape.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00273}00273 \textcolor{comment}{  /// Uses the FiniteElement::get\_x(...) function for FiniteElements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00274}00274 \textcolor{comment}{  /// and doesn't do anything for other element types.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00275}00275 \textcolor{comment}{  /// If a MacroElement pointer has been set for a FiniteElement,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00276}00276 \textcolor{comment}{  /// the MacroElement representation is used to update the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00277}00277 \textcolor{comment}{  /// nodal positions; if not get\_x(...) uses the FE interpolation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00278}00278 \textcolor{comment}{  /// and thus leaves the nodal positions unchanged.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00279}00279 \textcolor{comment}{  /// Virtual, so it can be overloaded by specific meshes,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00280}00280 \textcolor{comment}{  /// such as AlgebraicMeshes or SpineMeshes.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00281}00281 \textcolor{comment}{  /// Generally, this function updates the position of all nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00282}00282 \textcolor{comment}{  /// in response to changes in the boundary position. For}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00283}00283 \textcolor{comment}{  /// SolidNodes it only applies the update to those SolidNodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00284}00284 \textcolor{comment}{  /// whose position is determined by the boundary position, unless}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00285}00285 \textcolor{comment}{  /// the bool flag is set to true.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00286}00286 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00287}\mbox{\hyperlink{classoomph_1_1Mesh_a95bf112e5e1b3892e70a41f91b3cc523}{00287}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a95bf112e5e1b3892e70a41f91b3cc523}{Mesh::node\_update}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& update\_all\_solid\_nodes)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00288}00288   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00289}00289     \textcolor{comment}{// Get the current time}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00290}00290     \textcolor{keywordtype}{double} t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00292}00292 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00293}00293 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00294}00294     \textcolor{comment}{// Paranoid check to throw an error if node update is called for elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00295}00295     \textcolor{comment}{// with nonuniformly spaced nodes for which some masters are 'external'}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00296}00296     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}(); n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00297}00297     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00298}00298       Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00299}00299       \textcolor{keywordflow}{if} (nod\_pt-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00300}00300       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00301}00301         \textcolor{comment}{// Loop over master nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00302}00302         \textcolor{keywordtype}{unsigned} nmaster = nod\_pt-\/>hanging\_pt()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00303}00303         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} imaster = 0; imaster < nmaster; imaster++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00304}00304         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00305}00305           \textcolor{comment}{// Get pointer to master node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00306}00306           Node* master\_nod\_pt = nod\_pt-\/>hanging\_pt()-\/>master\_node\_pt(imaster);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00307}00307 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00308}00308           \textcolor{comment}{// Get vector of all external halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00309}00309           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} \mbox{\hyperlink{classoomph_1_1Mesh_a1f88352a0bf5be7d15858915097c1e70}{external\_halo\_node\_pt}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00310}00310           \mbox{\hyperlink{classoomph_1_1Mesh_abd71f68171d761023c71c5c99b549997}{get\_external\_halo\_node\_pt}}(\mbox{\hyperlink{classoomph_1_1Mesh_a1f88352a0bf5be7d15858915097c1e70}{external\_halo\_node\_pt}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00311}00311 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00312}00312           \textcolor{comment}{// Search the external halo storage for this node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00313}00313           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>::iterator}} it = std::find(\mbox{\hyperlink{classoomph_1_1Mesh_a1f88352a0bf5be7d15858915097c1e70}{external\_halo\_node\_pt}}.begin(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00314}00314                                                  \mbox{\hyperlink{classoomph_1_1Mesh_a1f88352a0bf5be7d15858915097c1e70}{external\_halo\_node\_pt}}.end(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00315}00315                                                  master\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00316}00316 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00317}00317           \textcolor{comment}{// Check if the node was found}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00318}00318           \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classoomph_1_1Mesh_a1f88352a0bf5be7d15858915097c1e70}{external\_halo\_node\_pt}}.end())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00319}00319           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00320}00320             \textcolor{comment}{// Throw error becase node update won't work}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00321}00321             \textcolor{comment}{// It's ok to throw an error here because this function is}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00322}00322             \textcolor{comment}{// overloaded for Algebraic and MacroElementNodeUpdate}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00323}00323             \textcolor{comment}{// Meshes. This is only a problem for meshes of ordinary}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00324}00324             \textcolor{comment}{// nodes.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00325}00325             std::ostringstream err\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00327}00327             err\_stream << \textcolor{stringliteral}{"{}Calling node\_update() for a mesh which contains"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00328}00328                        << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00329}00329                        << \textcolor{stringliteral}{"{}master nodes which live in the external storage."{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00330}00330                        << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00331}00331                        << \textcolor{stringliteral}{"{}These nodes do not belong to elements on this"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00332}00332                        << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00333}00333                        << \textcolor{stringliteral}{"{}processor and therefore cannot be updated locally."{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00334}00334                        << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00335}00335 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00336}00336             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(err\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00337}00337                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00338}00338                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00339}00339           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00340}00340         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00341}00341       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00342}00342     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00343}00343     \textcolor{comment}{// If we get to here then none of the masters of any of the nodes in the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00344}00344     \textcolor{comment}{// mesh live in the external storage, so we'll be fine if we carry on.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00345}00345 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00346}00346 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00347}00347 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00348}00348 \textcolor{comment}{    /// Local and global (Eulerian) coordinate}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00349}00349 \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00350}00350     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} r;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00352}00352     \textcolor{comment}{// NB: This repeats nodes a lot -\/ surely it would be}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00353}00353     \textcolor{comment}{// quicker to modify it so that it only does each node once,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00354}00354     \textcolor{comment}{// particularly in the update\_all\_solid\_nodes=true case?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00355}00355     \textcolor{comment}{// Create a map to indicate whether or not we've updated a node already}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00356}00356     std::map<Node*, bool> has\_node\_been\_updated;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00357}00357 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00358}00358     \textcolor{comment}{// How many nodes are there?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00359}00359     \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00360}00360 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00361}00361     \textcolor{comment}{// Loop over all Nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00362}00362     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00363}00363     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00364}00364       \textcolor{comment}{// Get pointer to node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00365}00365       Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00366}00366 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00367}00367       \textcolor{comment}{// Initialise the boolean value associated with this node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00368}00368       has\_node\_been\_updated[nod\_pt] = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00369}00369     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00370}00370 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00371}00371     \textcolor{comment}{// Loop over all elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00372}00372     \textcolor{keywordtype}{unsigned} nel = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00373}00373     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nel; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00374}00374     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00375}00375       \textcolor{comment}{// Try to cast to FiniteElement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00376}00376       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00377}00377 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00378}00378       \textcolor{comment}{// If it's a finite element we can proceed: FiniteElements have}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00379}00379       \textcolor{comment}{// nodes and a get\_x() function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00380}00380       \textcolor{keywordflow}{if} (el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00381}00381       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00382}00382         \textcolor{comment}{// Find out dimension of element = number of local coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00383}00383         \textcolor{keywordtype}{unsigned} ndim\_el = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00384}00384         \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}.resize(ndim\_el);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00385}00385 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00386}00386         \textcolor{comment}{// Loop over nodal points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00387}00387         \textcolor{keywordtype}{unsigned} n\_node = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00388}00388         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00389}00389         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00390}00390           \textcolor{comment}{// Get pointer to node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00391}00391           Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00393}00393           \textcolor{comment}{// Get spatial dimension of node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00394}00394           \textcolor{keywordtype}{unsigned} ndim\_node = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00395}00395           r.resize(ndim\_node);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00396}00396 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00397}00397           \textcolor{comment}{// For non-\/hanging nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00398}00398           \textcolor{keywordflow}{if} (!(nod\_pt-\/>is\_hanging()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00399}00399           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00400}00400             \textcolor{comment}{// If we've not dealt with this Node yet}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00401}00401             \textcolor{keywordflow}{if} (!has\_node\_been\_updated[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00402}00402             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00403}00403               \textcolor{comment}{// Get the position of the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00404}00404               el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a22bc4ee35e4f948d8d7fba18c7b4f4c4}{local\_coordinate\_of\_node}}(j, \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00405}00405 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00406}00406               \textcolor{comment}{// Get new position}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00407}00407               el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6fc14cbf4e1d031acbc59b415cefa1ca}{get\_x}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, r);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00408}00408 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00409}00409               \textcolor{comment}{// Try to cast to SolidNode}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00410}00410               \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_node\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00411}00411 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00412}00412               \textcolor{comment}{// Loop over coordinate directions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00413}00413               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim\_node; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00414}00414               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00415}00415                 \textcolor{comment}{// It's a SolidNode:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00416}00416                 \textcolor{keywordflow}{if} (solid\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00417}00417                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00418}00418                   \textcolor{comment}{// only do it if explicitly requested!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00419}00419                   \textcolor{keywordflow}{if} (update\_all\_solid\_nodes)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00420}00420                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00421}00421                     solid\_node\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = r[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00422}00422                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00423}00423                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00424}00424                 \textcolor{comment}{// Not a SolidNode: Definitely update}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00425}00425                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00426}00426                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00427}00427                   nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = r[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00428}00428                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00429}00429               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00430}00430 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00431}00431               \textcolor{comment}{// Indicate that we're done with this node, regardless of whether}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00432}00432               \textcolor{comment}{// or not it even needed updating}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00433}00433               has\_node\_been\_updated[nod\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00434}00434             \} \textcolor{comment}{// if (!has\_node\_been\_updated[nod\_pt])}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00435}00435           \} \textcolor{comment}{// if (!(nod\_pt-\/>is\_hanging()))}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00436}00436         \} \textcolor{comment}{// for (unsigned j=0;j<n\_node;j++)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00437}00437       \} \textcolor{comment}{// if (el\_pt!=0)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00438}00438     \} \textcolor{comment}{// for (unsigned e=0;e<nel;e++)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00439}00439 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00440}00440     \textcolor{comment}{// Now update the external halo nodes before we adjust the positions of the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00441}00441     \textcolor{comment}{// hanging nodes incase any are masters of local nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00442}00442 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00443}00443     \textcolor{comment}{// Loop over all external halo nodes with other processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00444}00444     \textcolor{comment}{// and update them}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00445}00445     \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}>::iterator it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00446}00446            \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00447}00447          it != \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00448}00448          it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00449}00449     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00450}00450       \textcolor{comment}{// Get vector of external halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00451}00451       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} ext\_halo\_node\_pt = (*it).second;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00452}00452       \textcolor{keywordtype}{unsigned} nnod = ext\_halo\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00453}00453       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00454}00454       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00455}00455         ext\_halo\_node\_pt[j]-\/>node\_update();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00456}00456       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00457}00457     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00458}00458 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00459}00459 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00460}00460     \textcolor{comment}{// Now loop over hanging nodes and adjust their position}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00461}00461     \textcolor{comment}{// in line with their hanging node constraints}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00462}00462     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00463}00463     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00464}00464       Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00465}00465       \textcolor{keywordflow}{if} (nod\_pt-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00466}00466       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00467}00467         \textcolor{comment}{// Get spatial dimension of node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00468}00468         \textcolor{keywordtype}{unsigned} ndim\_node = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00469}00469 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00470}00470         \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00471}00471         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim\_node; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00472}00472         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00473}00473           nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00474}00474         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00475}00475 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00476}00476         \textcolor{comment}{// Loop over master nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00477}00477         \textcolor{keywordtype}{unsigned} nmaster = nod\_pt-\/>hanging\_pt()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00478}00478         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} imaster = 0; imaster < nmaster; imaster++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00479}00479         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00480}00480           \textcolor{comment}{// Loop over directions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00481}00481           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim\_node; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00482}00482           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00483}00483             nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) +=}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00484}00484               nod\_pt-\/>hanging\_pt()-\/>master\_node\_pt(imaster)-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) *}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00485}00485               nod\_pt-\/>hanging\_pt()-\/>master\_weight(imaster);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00486}00486           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00487}00487         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00488}00488       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00489}00489     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00490}00490 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00491}00491     \textcolor{comment}{// Loop over all nodes again and execute auxiliary node update}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00492}00492     \textcolor{comment}{// function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00493}00493     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00494}00494     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00495}00495       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>perform\_auxiliary\_node\_update\_fct();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00496}00496     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00497}00497 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00498}00498     \textcolor{comment}{// Tell the user how long it's taken}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00499}00499     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time taken to update nodal positions [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00500}00500                << \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}() -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00501}00501   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00502}00502 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00503}00503 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00504}00504   \textcolor{comment}{//=======================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00505}00505 \textcolor{comment}{  /// Reorder nodes in the order in which they are}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00506}00506 \textcolor{comment}{  /// encountered when stepping through the elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00507}00507 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00508}\mbox{\hyperlink{classoomph_1_1Mesh_a801e77424d1bf8a35c9bba055230f1e3}{00508}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a801e77424d1bf8a35c9bba055230f1e3}{Mesh::reorder\_nodes}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& use\_old\_ordering)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00509}00509   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00510}00510     \textcolor{comment}{// Create storage for the reordered nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00511}00511     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} reordering;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00512}00512 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00513}00513     \textcolor{comment}{// Get the reordered nodes (without altering the mesh's node vector)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00514}00514     \mbox{\hyperlink{classoomph_1_1Mesh_af191bd67272f0ca8ec389bdc233140fd}{get\_node\_reordering}}(reordering, use\_old\_ordering);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00515}00515 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00516}00516     \textcolor{comment}{// Get the number of nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00517}00517     \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00518}00518 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00519}00519     \textcolor{comment}{// Loop over all of the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00520}00520     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_node; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00521}00521     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00522}00522       \textcolor{comment}{// Replace the Mesh's i-\/th node pointer with the reordered node pointer}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00523}00523       \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = reordering[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00524}00524     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00525}00525   \} \textcolor{comment}{// End of reorder\_nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00526}00526 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00527}00527   \textcolor{comment}{//=======================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00528}00528 \textcolor{comment}{  /// Get a vector of the nodes in the order in which they are encountered}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00529}00529 \textcolor{comment}{  /// when stepping through the elements (similar to reorder\_nodes() but}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00530}00530 \textcolor{comment}{  /// without changing the mesh's node vector).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00531}00531 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00532}\mbox{\hyperlink{classoomph_1_1Mesh_af191bd67272f0ca8ec389bdc233140fd}{00532}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_af191bd67272f0ca8ec389bdc233140fd}{Mesh::get\_node\_reordering}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}\& reordering,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00533}00533                                  \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& use\_old\_ordering)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00534}00534 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00535}00535     \textcolor{comment}{// If the user wants to use the original order}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00536}00536     \textcolor{keywordflow}{if} (use\_old\_ordering)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00537}00537     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00538}00538       \textcolor{comment}{// Setup map to check if nodes have been done yet}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00539}00539       std::map<Node*, bool> done;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00540}00540 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00541}00541       \textcolor{comment}{// Loop over all nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00542}00542       \textcolor{keywordtype}{unsigned} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00543}00543 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00544}00544       \textcolor{comment}{// Initialise the vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00545}00545       reordering.assign(nnod, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00546}00546 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00547}00547       \textcolor{comment}{// Return immediately if there are no nodes: Note assumption:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00548}00548       \textcolor{comment}{// Either all the elements' nodes stored here or none. If only a subset}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00549}00549       \textcolor{comment}{// is stored in the Node\_pt vector we'll get a range checking error below}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00550}00550       \textcolor{comment}{// (only if run with range checking, of course).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00551}00551       \textcolor{keywordflow}{if} (nnod == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00552}00552       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00553}00553         \textcolor{comment}{// Return immediately}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00554}00554         \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00555}00555       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00556}00556 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00557}00557       \textcolor{comment}{// Loop over the nodes in the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00558}00558       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00559}00559       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00560}00560         \textcolor{comment}{// Indicate whether or not the node has been swapped}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00561}00561         done[\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j)] = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00562}00562       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00563}00563 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00564}00564       \textcolor{comment}{// Initialise counter for number of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00565}00565       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00566}00566 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00567}00567       \textcolor{comment}{// Get the number of elements in the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00568}00568       \textcolor{keywordtype}{unsigned} nel = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00569}00569 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00570}00570       \textcolor{comment}{// Loop over all elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00571}00571       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nel; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00572}00572       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00573}00573         \textcolor{comment}{// Make sure the e-\/th element is a FiniteElement (or derived) class}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00574}00574         \textcolor{comment}{// object}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00575}00575         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00576}00576           checked\_dynamic\_cast<FiniteElement*>(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00577}00577 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00578}00578         \textcolor{comment}{// Get the number of nodes in this element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00579}00579         \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00580}00580 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00581}00581         \textcolor{comment}{// Loop over nodes in element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00582}00582         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00583}00583         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00584}00584           \textcolor{comment}{// Get a pointer to the j-\/th node in the element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00585}00585           Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00586}00586 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00587}00587           \textcolor{comment}{// Has node been done yet?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00588}00588           \textcolor{keywordflow}{if} (!done[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00589}00589           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00590}00590             \textcolor{comment}{// Insert into node vector. NOTE: If you get a seg fault/range}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00591}00591             \textcolor{comment}{// checking error here then you probably haven't added all the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00592}00592             \textcolor{comment}{// elements' nodes to the Node\_pt vector -\/-\/ this is most likely to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00593}00593             \textcolor{comment}{// arise in the case of meshes of face elements (though they usually}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00594}00594             \textcolor{comment}{// don't store the nodes at all so if you have any problems here}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00595}00595             \textcolor{comment}{// there's something unusual/not quite right in any case... For this}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00596}00596             \textcolor{comment}{// reason we don't range check here by default (not even under}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00597}00597             \textcolor{comment}{// paranoia) but force you turn on proper (costly) range checking to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00598}00598             \textcolor{comment}{// track this down...}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00599}00599             reordering[count] = nod\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00600}00600 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00601}00601             \textcolor{comment}{// Indicate that the node has been done}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00602}00602             done[nod\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00603}00603 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00604}00604             \textcolor{comment}{// Increase counter}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00605}00605             count++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00606}00606           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00607}00607         \} \textcolor{comment}{// for (unsigned j=0;j<nnod;j++)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00608}00608       \} \textcolor{comment}{// for (unsigned e=0;e<nel;e++)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00609}00609 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00610}00610       \textcolor{comment}{// Sanity check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00611}00611       \textcolor{keywordflow}{if} (count != nnod)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00612}00612       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00613}00613         \textcolor{comment}{// Create an error message}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00614}00614         \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} error\_message = \textcolor{stringliteral}{"{}Trouble: Number of nodes hasn't stayed "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00615}00615 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00616}00616         \textcolor{comment}{// Finish off the message}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00617}00617         error\_message += \textcolor{stringliteral}{"{}constant during reordering!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00618}00618 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00619}00619         \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00620}00620         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00621}00621           error\_message, OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00622}00622       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00623}00623     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00624}00624     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00625}00625     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00626}00626       \textcolor{comment}{// Copy node vector out}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00627}00627       \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00628}00628 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00629}00629       \textcolor{comment}{// Resize the node ordering vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00630}00630       reordering.resize(n\_node);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00631}00631 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00632}00632       \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00633}00633       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_node; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00634}00634       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00635}00635         \textcolor{comment}{// Assign the i-\/th node pointer entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00636}00636         reordering[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00637}00637       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00638}00638 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00639}00639       \textcolor{comment}{// Now sort the nodes lexicographically}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00640}00640       std::sort(reordering.begin(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00641}00641                 reordering.end(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00642}00642                 \&\mbox{\hyperlink{namespaceoomph_1_1NodeOrdering_ab4b56433bc36410fa77a0038a0996ecb}{NodeOrdering::node\_global\_position\_comparison}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00643}00643     \} \textcolor{comment}{// if (use\_old\_ordering)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00644}00644   \} \textcolor{comment}{// End of get\_node\_reordering}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00645}00645 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00646}00646 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00647}00647   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00648}00648 \textcolor{comment}{  /// Virtual Destructor to clean up all memory}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00649}00649 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00650}\mbox{\hyperlink{classoomph_1_1Mesh_abc071afb5c34ca6ced42734030f81353}{00650}}   \mbox{\hyperlink{classoomph_1_1Mesh_abc071afb5c34ca6ced42734030f81353}{Mesh::\string~Mesh}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00651}00651   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00652}00652     \textcolor{comment}{// Free the nodes first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00653}00653     \textcolor{comment}{// Loop over the nodes in reverse order}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00654}00654     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Node\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00655}00655     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = Node\_pt\_range; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} > 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}-\/-\/)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00656}00656     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00657}00657       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00658}00658       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00659}00659     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00660}00660 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00661}00661     \textcolor{comment}{// Free the elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00662}00662     \textcolor{comment}{// Loop over the elements in reverse order}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00663}00663     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00664}00664     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} > 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}-\/-\/)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00665}00665     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00666}00666       \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00667}00667       \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} -\/ 1] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00668}00668     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00669}00669 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00670}00670     \textcolor{comment}{// Wipe the storage for all externally-\/based elements and delete halos}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00671}00671     \mbox{\hyperlink{classoomph_1_1Mesh_a9e3ecb07dc622cf37ce0085446ff9aa6}{delete\_all\_external\_storage}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00672}00672   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00673}00673 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00674}00674   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00675}00675 \textcolor{comment}{  /// Assign (global) equation numbers to the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00676}00676 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00677}\mbox{\hyperlink{classoomph_1_1Mesh_addf84f5fbe29d45259c36acf5f01d330}{00677}}   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{classoomph_1_1Mesh_addf84f5fbe29d45259c36acf5f01d330}{Mesh::assign\_global\_eqn\_numbers}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double*>}}\& Dof\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00678}00678   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00679}00679     \textcolor{comment}{// Find out the current number of equations}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00680}00680     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} equation\_number = Dof\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00681}00681 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00682}00682     \textcolor{comment}{// Loop over the nodes and call their assigment functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00683}00683     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00684}00684 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00685}00685     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nnod; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00686}00686     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00687}00687       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>assign\_eqn\_numbers(equation\_number, Dof\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00688}00688     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00690}00690     \textcolor{comment}{// Loop over the elements and number their internals}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00691}00691     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nel = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00692}00692     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nel; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00693}00693     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00694}00694       \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>assign\_internal\_eqn\_numbers(equation\_number, Dof\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00695}00695     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00696}00696 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00697}00697     \textcolor{comment}{// Return the total number of equations}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00698}00698     \textcolor{keywordflow}{return} (equation\_number);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00699}00699   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00700}00700 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00701}00701   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00702}00702 \textcolor{comment}{  /// Function to describe the dofs of the Mesh. The ostream}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00703}00703 \textcolor{comment}{  /// specifies the output stream to which the description}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00704}00704 \textcolor{comment}{  /// is written; the string stores the currently}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00705}00705 \textcolor{comment}{  /// assembled output that is ultimately written to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00706}00706 \textcolor{comment}{  /// output stream by Data::describe\_dofs(...); it is typically}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00707}00707 \textcolor{comment}{  /// built up incrementally as we descend through the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00708}00708 \textcolor{comment}{  /// call hierarchy of this function when called from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00709}00709 \textcolor{comment}{  /// Problem::describe\_dofs(...)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00710}00710 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00711}\mbox{\hyperlink{classoomph_1_1Mesh_a86d000c45f6d29fa215b98051cc2d23f}{00711}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a86d000c45f6d29fa215b98051cc2d23f}{Mesh::describe\_dofs}}(std::ostream\& out,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00712}00712                            \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}}\& current\_string)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00713}00713 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00714}00714     \textcolor{comment}{// Loop over the nodes and call their classification functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00715}00715     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00716}00716     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nnod; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00717}00717     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00718}00718       std::stringstream conversion;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00719}00719       conversion << \textcolor{stringliteral}{"{} of Node "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << current\_string;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00720}00720       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} in(conversion.str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00721}00721       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>describe\_dofs(out, in);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00722}00722     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00723}00723 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00724}00724     \textcolor{comment}{// Loop over the elements and classify.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00725}00725     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nel = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00726}00726     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nel; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00727}00727     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00728}00728       std::stringstream conversion;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00729}00729       conversion << \textcolor{stringliteral}{"{} in Element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} ["{}} << \textcolor{keyword}{typeid}(*\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]).name()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00730}00730                  << \textcolor{stringliteral}{"{}] "{}} << current\_string;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00731}00731       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} in(conversion.str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00732}00732       \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>describe\_dofs(out, in);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00733}00733     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00734}00734   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00735}00735 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00736}00736   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00737}00737 \textcolor{comment}{  /// Function to describe the local dofs of the elements. The ostream}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00738}00738 \textcolor{comment}{  /// specifies the output stream to which the description}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00739}00739 \textcolor{comment}{  /// is written; the string stores the currently}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00740}00740 \textcolor{comment}{  /// assembled output that is ultimately written to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00741}00741 \textcolor{comment}{  /// output stream by Data::describe\_dofs(...); it is typically}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00742}00742 \textcolor{comment}{  /// built up incrementally as we descend through the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00743}00743 \textcolor{comment}{  /// call hierarchy of this function when called from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00744}00744 \textcolor{comment}{  /// Problem::describe\_dofs(...)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00745}00745 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00746}\mbox{\hyperlink{classoomph_1_1Mesh_a57d57b7b6d7a32fadafb03e7055c5ad4}{00746}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a57d57b7b6d7a32fadafb03e7055c5ad4}{Mesh::describe\_local\_dofs}}(std::ostream\& out,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00747}00747                                  \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}}\& current\_string)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00748}00748 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00749}00749     \textcolor{comment}{// Now loop over the elements and describe local dofs}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00750}00750     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nel = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00751}00751     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nel; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00752}00752     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00753}00753       std::stringstream conversion;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00754}00754       conversion << \textcolor{stringliteral}{"{} in Element"{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} ["{}} << \textcolor{keyword}{typeid}(*\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]).name()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00755}00755                  << \textcolor{stringliteral}{"{}] "{}} << current\_string;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00756}00756       \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} in(conversion.str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00757}00757       \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>describe\_local\_dofs(out, in);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00758}00758     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00759}00759   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00760}00760 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00761}00761 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00762}00762   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00763}00763 \textcolor{comment}{  /// Assign local equation numbers in all elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00764}00764 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00765}\mbox{\hyperlink{classoomph_1_1Mesh_ab73d03d38e9b94b15f21b2c12f5dc3bc}{00765}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ab73d03d38e9b94b15f21b2c12f5dc3bc}{Mesh::assign\_local\_eqn\_numbers}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& store\_local\_dof\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00766}00766   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00767}00767     \textcolor{comment}{// Now loop over the elements and assign local equation numbers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00768}00768     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00769}00769     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00770}00770     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00771}00771       \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>assign\_local\_eqn\_numbers(store\_local\_dof\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00772}00772     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00773}00773   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00774}00774 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00775}00775   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00776}00776 \textcolor{comment}{  /// Self-\/test: Check elements and nodes. Return 0 for OK}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00777}00777 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00778}\mbox{\hyperlink{classoomph_1_1Mesh_ac713e5a9cbd8b21907d39df493d6bfc9}{00778}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1Mesh_ac713e5a9cbd8b21907d39df493d6bfc9}{Mesh::self\_test}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00779}00779   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00780}00780     \textcolor{comment}{// Initialise}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00781}00781     \textcolor{keywordtype}{bool} passed = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00782}00782 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00783}00783     \textcolor{comment}{// Check the mesh for repeated nodes (issues its own error message)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00784}00784     \textcolor{keywordflow}{if} (0 != \mbox{\hyperlink{classoomph_1_1Mesh_aa8229e193565c8de821170d482dfcee2}{check\_for\_repeated\_nodes}}()) passed = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00785}00785 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00786}00786     \textcolor{comment}{// hierher -\/-\/ re-\/enable once problem with Hermite elements has been}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00787}00787     \textcolor{comment}{// resolved.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00788}00788     \textcolor{comment}{//  // Check if there are any inverted elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00789}00789     \textcolor{comment}{//  bool mesh\_has\_inverted\_elements=false;}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00790}00790     \textcolor{comment}{//  check\_inverted\_elements(mesh\_has\_inverted\_elements);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00791}00791     \textcolor{comment}{//  if (mesh\_has\_inverted\_elements)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00792}00792     \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00793}00793     \textcolor{comment}{//    passed=false;}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00794}00794     \textcolor{comment}{//    oomph\_info << "{}\(\backslash\)n ERROR: Mesh has inverted elements\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00795}00795     \textcolor{comment}{//               << "{}     Run Mesh::check\_inverted\_elements(...) with"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00796}00796     \textcolor{comment}{//               << "{}     with output stream to find out which elements are"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00797}00797     \textcolor{comment}{//               << "{}     inverted.\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00798}00798     \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00799}00799 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00800}00800     \textcolor{comment}{// Loop over the elements, check for duplicates and do self test}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00801}00801     std::set<GeneralisedElement*> element\_set\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00802}00802     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00803}00803     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00804}00804     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00805}00805       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac713e5a9cbd8b21907d39df493d6bfc9}{self\_test}}() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00806}00806       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00807}00807         passed = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00808}00808         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n ERROR: Failed Element::self\_test() for element i="{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00809}00809                    << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00810}00810       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00811}00811       \textcolor{comment}{// Add to set (which ignores duplicates):}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00812}00812       element\_set\_pt.insert(\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00813}00813     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00814}00814 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00815}00815     \textcolor{comment}{// Check for duplicates:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00816}00816     \textcolor{keywordflow}{if} (element\_set\_pt.size() != Element\_pt\_range)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00817}00817     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00818}00818       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}ERROR:  "{}} << Element\_pt\_range -\/ element\_set\_pt.size()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00819}00819                  << \textcolor{stringliteral}{"{} duplicate elements were encountered in mesh!"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00820}00820                  << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00821}00821       passed = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00822}00822     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00823}00823 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00824}00824 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00825}00825     \textcolor{comment}{// Loop over the nodes, check for duplicates and do self test}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00826}00826     std::set<Node*> node\_set\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00827}00827     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Node\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00828}00828     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < Node\_pt\_range; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00829}00829     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00830}00830       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac713e5a9cbd8b21907d39df493d6bfc9}{self\_test}}() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00831}00831       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00832}00832         passed = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00833}00833         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}\(\backslash\)n ERROR: Failed Node::self\_test() for node i="{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00834}00834                    << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00835}00835       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00836}00836       \textcolor{comment}{// Add to set (which ignores duplicates):}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00837}00837       node\_set\_pt.insert(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00838}00838     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00839}00839 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00840}00840     \textcolor{comment}{// Check for duplicates:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00841}00841     \textcolor{keywordflow}{if} (node\_set\_pt.size() != Node\_pt\_range)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00842}00842     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00843}00843       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}ERROR:  "{}} << Node\_pt\_range -\/ node\_set\_pt.size()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00844}00844                  << \textcolor{stringliteral}{"{} duplicate nodes were encountered in mesh!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00845}00845       passed = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00846}00846     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00847}00847 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00848}00848     \textcolor{comment}{// Return verdict}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00849}00849     \textcolor{keywordflow}{if} (passed)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00850}00850     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00851}00851       \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00852}00852     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00853}00853     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00854}00854     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00855}00855       \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00856}00856     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00857}00857   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00858}00858 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00859}00859 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00860}00860   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00861}00861 \textcolor{comment}{  ///  Check for inverted elements and report outcome}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00862}00862 \textcolor{comment}{  /// in boolean variable. This visits all elements at their}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00863}00863 \textcolor{comment}{  /// integration points and checks if the Jacobian of the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00864}00864 \textcolor{comment}{  /// mapping between local and global coordinates is positive -\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00865}00865 \textcolor{comment}{  /// using the same test that would be carried out (but only in PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00866}00866 \textcolor{comment}{  /// mode) during the assembly of the elements' Jacobian matrices.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00867}00867 \textcolor{comment}{  /// Inverted elements are output in inverted\_element\_file (if the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00868}00868 \textcolor{comment}{  /// stream is open).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00869}00869 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00870}\mbox{\hyperlink{classoomph_1_1Mesh_a76adc3fcd3e49d3bd2e3b9d92c854430}{00870}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a76adc3fcd3e49d3bd2e3b9d92c854430}{Mesh::check\_inverted\_elements}}(\textcolor{keywordtype}{bool}\& mesh\_has\_inverted\_elements,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00871}00871                                      std::ofstream\& inverted\_element\_file)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00872}00872   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00873}00873     \textcolor{comment}{// Initialise flag}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00874}00874     mesh\_has\_inverted\_elements = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00875}00875 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00876}00876     \textcolor{comment}{// Suppress output while checking for inverted elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00877}00877     \textcolor{keywordtype}{bool} backup =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00878}00878       \mbox{\hyperlink{classoomph_1_1FiniteElement_ae8357b9337e2148c57267f1d4c32fcfa}{FiniteElement::Suppress\_output\_while\_checking\_for\_inverted\_elements}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00879}00879     \mbox{\hyperlink{classoomph_1_1FiniteElement_ae8357b9337e2148c57267f1d4c32fcfa}{FiniteElement::Suppress\_output\_while\_checking\_for\_inverted\_elements}} = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00880}00880 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00881}00881     \textcolor{comment}{// Loop over all elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00882}00882     \textcolor{keywordtype}{unsigned} nelem = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00883}00883     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00884}00884     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00885}00885       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00886}00886 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00887}00887       \textcolor{comment}{// Only check for finite elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00888}00888       \textcolor{keywordflow}{if} (el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00889}00889       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00890}00890         \textcolor{comment}{// Find out number of nodes and local coordinates in the element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00891}00891         \textcolor{keywordtype}{unsigned} n\_node = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00892}00892         \textcolor{keywordtype}{unsigned} n\_dim = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00893}00893         \textcolor{keywordtype}{unsigned} ndim\_node = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_ab6602b43c3a2f1a5e48729b0b23c0d91}{nodal\_dimension}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00894}00894 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00895}00895         \textcolor{comment}{// Can't check Jacobian for elements in which nodal and elementa}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00896}00896         \textcolor{comment}{// dimensions don't match}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00897}00897         \textcolor{keywordflow}{if} (n\_dim == ndim\_node)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00898}00898         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00899}00899           \textcolor{comment}{// Set up memory for the shape and test function and local coord}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00900}00900           \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00901}00901           \mbox{\hyperlink{classoomph_1_1DShape}{DShape}} dpsidx(n\_node, n\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00902}00902           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}(n\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00903}00903 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00904}00904           \textcolor{comment}{// Initialise element-\/level test}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00905}00905           \textcolor{keywordtype}{bool} is\_inverted = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00906}00906 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00907}00907           \textcolor{keywordtype}{unsigned} n\_intpt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00908}00908           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00909}00909           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00910}00910             \textcolor{comment}{// Local coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00911}00911             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00912}00912             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00913}00913               \mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>knot(ipt, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00914}00914             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00915}00915 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00916}00916             \textcolor{keywordtype}{double} J = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00917}00917             \textcolor{comment}{// Dummy assignment to keep gcc from complaining about}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00918}00918             \textcolor{comment}{// "{}set but unused"{}.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00919}00919             J += 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00920}00920             \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00921}00921             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00922}00922               \textcolor{comment}{// Call the derivatives of the shape functions and Jacobian}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00923}00923               J = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9296c17b134688049256a4bbc886df69}{dshape\_eulerian}}(\mbox{\hyperlink{cfortran_8h_ab7123126e4885ef647dd9c6e3807a21c}{s}}, psi, dpsidx);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00924}00924 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00925}00925               \textcolor{comment}{// If code is compiled without PARANOID setting, the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00926}00926               \textcolor{comment}{// above call will simply return the negative Jacobian}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00927}00927               \textcolor{comment}{// without failing, so we need to check manually}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00928}00928 \textcolor{preprocessor}{\#ifndef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00929}00929               \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00930}00930               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00931}00931                 el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a524acd2f6d25d55806b7050032ee6330}{check\_jacobian}}(J);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00932}00932               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00933}00933               \textcolor{keywordflow}{catch} (\mbox{\hyperlink{classoomph_1_1OomphLibQuietException}{OomphLibQuietException}}\& error)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00934}00934               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00935}00935                 is\_inverted = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00936}00936               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00937}00937 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00938}00938             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00939}00939             \textcolor{keywordflow}{catch} (\mbox{\hyperlink{classoomph_1_1OomphLibQuietException}{OomphLibQuietException}}\& error)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00940}00940             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00941}00941               is\_inverted = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00942}00942             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00943}00943           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00944}00944           \textcolor{keywordflow}{if} (is\_inverted)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00945}00945           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00946}00946             mesh\_has\_inverted\_elements = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00947}00947             \textcolor{keywordflow}{if} (inverted\_element\_file.is\_open())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00948}00948             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00949}00949               el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(inverted\_element\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00950}00950             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00951}00951           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00952}00952         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00953}00953       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00954}00954     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00955}00955     \textcolor{comment}{// Reset}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00956}00956     \mbox{\hyperlink{classoomph_1_1FiniteElement_ae8357b9337e2148c57267f1d4c32fcfa}{FiniteElement::Suppress\_output\_while\_checking\_for\_inverted\_elements}} =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00957}00957       backup;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00958}00958   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00959}00959 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00960}00960 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00961}00961   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00962}00962 \textcolor{comment}{  /// Nodes that have been marked as obsolete are removed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00963}00963 \textcolor{comment}{  /// from the mesh and the its boundaries. Returns vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00964}00964 \textcolor{comment}{  /// of pointers to deleted nodes.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00965}00965 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00966}\mbox{\hyperlink{classoomph_1_1Mesh_ac9f58929371a3f39dd646d2756547ad2}{00966}}   \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} \mbox{\hyperlink{classoomph_1_1Mesh_ac9f58929371a3f39dd646d2756547ad2}{Mesh::prune\_dead\_nodes}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00967}00967   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00968}00968     \textcolor{comment}{// Only copy the 'live' nodes across to new mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00969}00969     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00970}00970 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00971}00971     \textcolor{comment}{// New Vector of pointers to nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00972}00972     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} new\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00973}00973     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} deleted\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00974}00974 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00975}00975     \textcolor{comment}{// Loop over all nodes in mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00976}00976     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00977}00977     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00978}00978     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00979}00979       \textcolor{comment}{// If the node still exists: Copy across}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00980}00980       \textcolor{keywordflow}{if} (!(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>is\_obsolete()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00981}00981       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00982}00982         new\_node\_pt.push\_back(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00983}00983       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00984}00984       \textcolor{comment}{// Otherwise the Node is gone:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00985}00985       \textcolor{comment}{// Delete it for good if it does not lie on a boundary}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00986}00986       \textcolor{comment}{// (if it lives on a boundary we have to remove it from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00987}00987       \textcolor{comment}{// the boundary lookup schemes below)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00988}00988       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00989}00989       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00990}00990         \textcolor{keywordflow}{if} (!(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>is\_on\_boundary()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00991}00991         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00992}00992           deleted\_node\_pt.push\_back(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00993}00993           \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00994}00994           \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00995}00995         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00996}00996       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00997}00997     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00998}00998 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l00999}00999     \textcolor{comment}{// Now update old vector by setting it equal to the new vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01000}01000     \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}} = new\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01001}01001 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01002}01002 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01003}01003     \textcolor{comment}{// Boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01004}01004     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01005}01005 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01006}01006     \textcolor{comment}{// Only copy the 'live' nodes into new boundary node arrays}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01007}01007     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01008}01008     \textcolor{comment}{// Loop over the boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01009}01009     \textcolor{keywordtype}{unsigned} num\_bound = \mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01010}01010     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ibound = 0; ibound < num\_bound; ibound++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01011}01011     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01012}01012       \textcolor{comment}{// New Vector of pointers to existent boundary nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01013}01013       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} new\_boundary\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01014}01014 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01015}01015       \textcolor{comment}{// Loop over the boundary nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01016}01016       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Nboundary\_node = \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01017}01017 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01018}01018       \textcolor{comment}{// Reserve contiguous memory for new vector of pointers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01019}01019       \textcolor{comment}{// Must be equal in size to the number of nodes or less}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01020}01020       new\_boundary\_node\_pt.reserve(Nboundary\_node);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01021}01021 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01022}01022       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < Nboundary\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01023}01023       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01024}01024         \textcolor{comment}{// If node still exists: Copy across}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01025}01025         \textcolor{keywordflow}{if} (!(\mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound][n]-\/>is\_obsolete()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01026}01026         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01027}01027           new\_boundary\_node\_pt.push\_back(\mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound][n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01028}01028         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01029}01029         \textcolor{comment}{// Otherwise Node is gone: Delete it for good}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01030}01030         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01031}01031         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01032}01032           \textcolor{comment}{// The node may lie on multiple boundaries, so remove the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01033}01033           \textcolor{comment}{// from the current boundary}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01034}01034           \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound][n]-\/>remove\_from\_boundary(ibound);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01035}01035 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01036}01036           \textcolor{comment}{// Now if the node is no longer on any boundaries, delete it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01037}01037           \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound][n]-\/>is\_on\_boundary())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01038}01038           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01039}01039             deleted\_node\_pt.push\_back(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01040}01040               \textcolor{keyword}{dynamic\_cast<}Node*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound][n]));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01041}01041 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01042}01042             \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound][n];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01043}01043           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01044}01044         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01045}01045       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01046}01046 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01047}01047       \textcolor{comment}{// Update the old vector by setting it equal to the new vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01048}01048       \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound] = new\_boundary\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01049}01049 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01050}01050     \} \textcolor{comment}{// End of loop over boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01051}01051 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01052}01052     \textcolor{comment}{// Tell us who you deleted}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01053}01053     \textcolor{keywordflow}{return} deleted\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01054}01054   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01055}01055 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01056}01056 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01057}01057   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01058}01058 \textcolor{comment}{  /// Output function for the mesh boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01059}01059 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01060}01060 \textcolor{comment}{  /// Loop over all boundaries and dump out the coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01061}01061 \textcolor{comment}{  /// of the points on the boundary (in individual tecplot}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01062}01062 \textcolor{comment}{  /// zones)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01063}01063 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01064}\mbox{\hyperlink{classoomph_1_1Mesh_af6effab50e32290d4d8066440b9b3e37}{01064}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_af6effab50e32290d4d8066440b9b3e37}{Mesh::output\_boundaries}}(std::ostream\& outfile)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01065}01065   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01066}01066     \textcolor{comment}{// Loop over the boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01067}01067     \textcolor{keywordtype}{unsigned} num\_bound = \mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01068}01068     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} ibound = 0; ibound < num\_bound; ibound++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01069}01069     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01070}01070       \textcolor{keywordtype}{unsigned} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01071}01071       \textcolor{keywordflow}{if} (nnod > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01072}01072       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01073}01073         outfile << \textcolor{stringliteral}{"{}ZONE T=\(\backslash\)"{}boundary"{}} << ibound << \textcolor{stringliteral}{"{}\(\backslash\)"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01074}01074 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01075}01075         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod = 0; inod < nnod; inod++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01076}01076         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01077}01077           \mbox{\hyperlink{classoomph_1_1Mesh_abbba08d3de5cccd78ee98afc7b2f61fc}{Boundary\_node\_pt}}[ibound][inod]-\/>output(outfile);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01078}01078         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01079}01079       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01080}01080     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01081}01081   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01082}01082 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01083}01083 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01084}01084   \textcolor{comment}{//===================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01085}01085 \textcolor{comment}{  /// Dump function for the mesh class.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01086}01086 \textcolor{comment}{  /// Loop over all nodes and elements and dump them}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01087}01087 \textcolor{comment}{}  \textcolor{comment}{//===================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01088}\mbox{\hyperlink{classoomph_1_1Mesh_af821b936768868ea5dd91495e9ae3bc0}{01088}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_af821b936768868ea5dd91495e9ae3bc0}{Mesh::dump}}(std::ofstream\& dump\_file, \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& use\_old\_ordering)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01089}01089 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01090}01090     \textcolor{comment}{// Get a reordering of the nodes so that the dump file is in a standard}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01091}01091     \textcolor{comment}{// ordering regardless of the sequence of mesh refinements etc.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01092}01092     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} reordering;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01093}01093     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af191bd67272f0ca8ec389bdc233140fd}{get\_node\_reordering}}(reordering, use\_old\_ordering);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01094}01094 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01095}01095     \textcolor{comment}{// Find number of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01096}01096     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Node\_pt\_range = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01097}01097 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01098}01098     \textcolor{comment}{// Doc \# of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01099}01099     dump\_file << Node\_pt\_range << \textcolor{stringliteral}{"{} \# number of nodes "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01100}01100 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01101}01101     \textcolor{comment}{// Loop over all the nodes and dump their data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01102}01102     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} nd = 0; nd < Node\_pt\_range; nd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01103}01103     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01104}01104       reordering[nd]-\/>dump(dump\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01105}01105     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01106}01106 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01107}01107     \textcolor{comment}{// Loop over elements and deal with internal data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01108}01108     \textcolor{keywordtype}{unsigned} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01109}01109     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01110}01110     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01111}01111       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01112}01112       \textcolor{keywordtype}{unsigned} n\_internal = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01113}01113       \textcolor{keywordflow}{if} (n\_internal > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01114}01114       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01115}01115         dump\_file << n\_internal}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01116}01116                   << \textcolor{stringliteral}{"{} \# number of internal Data items in element "{}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01117}01117                   << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01118}01118         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_internal; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01119}01119         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01120}01120           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>\mbox{\hyperlink{classoomph_1_1Data_a87fa5ba80f2e6f0d0fb9658b9b358c05}{dump}}(dump\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01121}01121         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01122}01122       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01123}01123     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01124}01124   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01125}01125 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01126}01126 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01127}01127   \textcolor{comment}{//=======================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01128}01128 \textcolor{comment}{  /// Read solution from restart file}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01129}01129 \textcolor{comment}{}  \textcolor{comment}{//=======================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01130}\mbox{\hyperlink{classoomph_1_1Mesh_ac192b41d1a24297ff38854548defd92b}{01130}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ac192b41d1a24297ff38854548defd92b}{Mesh::read}}(std::ifstream\& restart\_file)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01131}01131   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01132}01132     \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}} input\_string;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01133}01133 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01134}01134     \textcolor{comment}{// Reorder the nodes within the mesh's node vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01135}01135     \textcolor{comment}{// to establish a standard ordering regardless of the sequence}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01136}01136     \textcolor{comment}{// of mesh refinements etc}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01137}01137     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a801e77424d1bf8a35c9bba055230f1e3}{reorder\_nodes}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01138}01138 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01139}01139     \textcolor{comment}{// Read nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01140}01140 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01141}01141     \textcolor{comment}{// Find number of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01142}01142     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01143}01143 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01144}01144     \textcolor{comment}{// Read line up to termination sign}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01145}01145     getline(restart\_file, input\_string, \textcolor{charliteral}{'\#'});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01146}01146 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01147}01147     \textcolor{comment}{// Ignore rest of line}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01148}01148     restart\_file.ignore(80, \textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01149}01149 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01150}01150     \textcolor{comment}{// Check \# of nodes:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01151}01151     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} check\_n\_node = atoi(input\_string.c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01152}01152     \textcolor{keywordflow}{if} (check\_n\_node != n\_node)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01153}01153     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01154}01154       std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01155}01155       error\_stream << \textcolor{stringliteral}{"{}The number of nodes allocated "{}} << n\_node}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01156}01156                    << \textcolor{stringliteral}{"{} is not the same as specified in the restart file "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01157}01157                    << check\_n\_node << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01158}01158 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01159}01159       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01160}01160         error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01161}01161     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01162}01162 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01163}01163     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01164}01164     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01165}01165     \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01166}01166 \textcolor{comment}{      /// Try to cast to elastic node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01167}01167 \textcolor{comment}{}      \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* el\_node\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01168}01168       \textcolor{keywordflow}{if} (el\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01169}01169       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01170}01170         el\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_ac4614b9f9c2222cb40cb004f85a66e57}{read}}(restart\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01171}01171       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01172}01172       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01173}01173       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01174}01174         this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(n)-\/>read(restart\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01175}01175       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01176}01176     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01177}01177 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01178}01178     \textcolor{comment}{// Read internal data of elements:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01179}01179     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01180}01180     \textcolor{comment}{// Loop over elements and deal with internal data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01181}01181     \textcolor{keywordtype}{unsigned} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01182}01182     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01183}01183     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01184}01184       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01185}01185       \textcolor{keywordtype}{unsigned} n\_internal = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01186}01186       \textcolor{keywordflow}{if} (n\_internal > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01187}01187       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01188}01188         \textcolor{comment}{// Read line up to termination sign}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01189}01189         getline(restart\_file, input\_string, \textcolor{charliteral}{'\#'});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01190}01190 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01191}01191         \textcolor{comment}{// Ignore rest of line}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01192}01192         restart\_file.ignore(80, \textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01193}01193 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01194}01194         \textcolor{comment}{// Check \# of internals :}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01195}01195         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} check\_n\_internal = atoi(input\_string.c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01196}01196         \textcolor{keywordflow}{if} (check\_n\_internal != n\_internal)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01197}01197         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01198}01198           std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01199}01199           error\_stream << \textcolor{stringliteral}{"{}The number of internal data  "{}} << n\_internal}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01200}01200                        << \textcolor{stringliteral}{"{} is not the same as specified in the restart file "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01201}01201                        << check\_n\_internal << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01202}01202 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01203}01203           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01204}01204                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01205}01205                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01206}01206         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01207}01207 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01208}01208         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_internal; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01209}01209         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01210}01210           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>\mbox{\hyperlink{classoomph_1_1Data_ad520cff679734b7654b1638ada2c728a}{read}}(restart\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01211}01211         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01212}01212       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01213}01213     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01214}01214   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01215}01215 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01216}01216 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01217}01217   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01218}01218 \textcolor{comment}{  /// Output in paraview format into specified file.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01219}01219 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01220}01220 \textcolor{comment}{  /// Breaks up each element into sub-\/elements for plotting}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01221}01221 \textcolor{comment}{  /// purposes. We assume that all elements are of the same}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01222}01222 \textcolor{comment}{  /// type (fct will break (in paranoid mode) if paraview}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01223}01223 \textcolor{comment}{  /// output fcts of the elements are inconsistent).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01224}01224 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01225}\mbox{\hyperlink{classoomph_1_1Mesh_af62d80c53dc07390d8f62ed180ab6d3a}{01225}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_af62d80c53dc07390d8f62ed180ab6d3a}{Mesh::output\_paraview}}(std::ofstream\& file\_out,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01226}01226                              \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01227}01227 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01228}01228     \textcolor{comment}{// Change the scientific format so that E is used rather than e}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01229}01229     file\_out.setf(std::ios\_base::uppercase);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01230}01230 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01231}01231     \textcolor{comment}{// Decide how many elements there are to be plotted}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01232}01232     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} number\_of\_elements = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01233}01233 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01234}01234     \textcolor{comment}{// Cast to finite element and return if cast fails.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01235}01235     \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01236}01236 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01237}01237 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01238}01238     \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01239}01239     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01240}01240       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Recast for FiniteElement failed for element 0!\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01241}01241                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01242}01242                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01243}01243     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01244}01244 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01245}01245 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01246}01246 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01247}01247 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01248}01248     \textcolor{comment}{// Check if all elements have the same number of degrees of freedom,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01249}01249     \textcolor{comment}{// if they don't, paraview will break}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01250}01250     \textcolor{keywordtype}{unsigned} el\_zero\_ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01251}01251     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01252}01252     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01253}01253       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01254}01254       \textcolor{keywordtype}{unsigned} el\_i\_ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01255}01255       \textcolor{keywordflow}{if} (el\_zero\_ndof != el\_i\_ndof)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01256}01256       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01257}01257         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01258}01258         error\_stream}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01259}01259           << \textcolor{stringliteral}{"{}Element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} has different number of degrees of freedom\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01260}01260           << \textcolor{stringliteral}{"{}than from previous elements, Paraview cannot handle this.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01261}01261           << \textcolor{stringliteral}{"{}We suggest that the problem is broken up into submeshes instead."{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01262}01262           << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01263}01263         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01264}01264           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01265}01265       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01266}01266     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01267}01267 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01268}01268 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01269}01269     \textcolor{comment}{// Make variables to hold the number of nodes and elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01270}01270     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} number\_of\_nodes = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01271}01271     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} total\_number\_of\_elements = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01272}01272 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01273}01273     \textcolor{comment}{// Loop over all the elements to find total number of plot points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01274}01274     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01275}01275     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01276}01276       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01277}01277       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01278}01278       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01279}01279 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01280}01280 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01281}01281       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01282}01282       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01283}01283         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01284}01284         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01285}01285         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01286}01286           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01287}01287       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01288}01288 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01289}01289 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01290}01290       number\_of\_nodes += fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a06d32c85753a1e302c3b345ea27f6c85}{nplot\_points\_paraview}}(nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01291}01291       total\_number\_of\_elements += fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_aa1e11deffc8ee67adaa59ce3ade0579f}{nsub\_elements\_paraview}}(nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01292}01292     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01293}01293 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01294}01294 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01295}01295     \textcolor{comment}{// File Declaration}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01296}01296     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01297}01297 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01298}01298     \textcolor{comment}{// Insert the necessary lines plus header of file, and}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01299}01299     \textcolor{comment}{// number of nodes and elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01300}01300     file\_out << \textcolor{stringliteral}{"{}<?xml version=\(\backslash\)"{}1.0\(\backslash\)"{}?>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01301}01301              << \textcolor{stringliteral}{"{}<VTKFile type=\(\backslash\)"{}UnstructuredGrid\(\backslash\)"{} version=\(\backslash\)"{}0.1\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01302}01302              << \textcolor{stringliteral}{"{}byte\_order=\(\backslash\)"{}LittleEndian\(\backslash\)"{}>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01303}01303              << \textcolor{stringliteral}{"{}<UnstructuredGrid>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01304}01304              << \textcolor{stringliteral}{"{}<Piece NumberOfPoints=\(\backslash\)"{}"{}} << number\_of\_nodes}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01305}01305              << \textcolor{stringliteral}{"{}\(\backslash\)"{} NumberOfCells=\(\backslash\)"{}"{}} << total\_number\_of\_elements << \textcolor{stringliteral}{"{}\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01306}01306 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01307}01307 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01308}01308     \textcolor{comment}{// Point Data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01309}01309     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01310}01310 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01311}01311     \textcolor{comment}{// Check the number of degrees of freedom}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01312}01312     \textcolor{keywordtype}{unsigned} ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01313}01313 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01314}01314     \textcolor{comment}{// Point data is going in here}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01315}01315     file\_out << \textcolor{stringliteral}{"{}<PointData "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01316}01316 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01317}01317     \textcolor{comment}{// Insert just the first scalar name, since paraview reads everything}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01318}01318     \textcolor{comment}{// else after that as being of the same type. Get information from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01319}01319     \textcolor{comment}{// first element.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01320}01320     file\_out << \textcolor{stringliteral}{"{}Scalars=\(\backslash\)"{}"{}} << fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a49cc2d4f7ed5772bbc96f06760372b51}{scalar\_name\_paraview}}(0) << \textcolor{stringliteral}{"{}\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01321}01321 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01322}01322     \textcolor{comment}{// Loop over i scalar fields and j number of elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01323}01323     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01324}01324     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01325}01325       file\_out << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Float32\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01326}01326                << \textcolor{stringliteral}{"{}Name=\(\backslash\)"{}"{}} << fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a49cc2d4f7ed5772bbc96f06760372b51}{scalar\_name\_paraview}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01327}01327                << \textcolor{stringliteral}{"{}format=\(\backslash\)"{}ascii\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01328}01328                << \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01329}01329 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01330}01330       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < number\_of\_elements; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01331}01331       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01332}01332         \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01333}01333         \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01334}01334         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01335}01335 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01336}01336 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01337}01337         \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01338}01338         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01339}01339           std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01340}01340           error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << j << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01341}01341           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01342}01342                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01343}01343                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01344}01344         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01345}01345 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01346}01346 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01347}01347         fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a02cf8832a5e2886f1572bd36f7a7c1e3}{scalar\_value\_paraview}}(file\_out, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01348}01348       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01349}01349 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01350}01350       \textcolor{comment}{// Close of the DataArray}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01351}01351       file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01352}01352     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01353}01353 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01354}01354     \textcolor{comment}{// Close off the PointData set}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01355}01355     file\_out << \textcolor{stringliteral}{"{}</PointData>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01356}01356 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01357}01357 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01358}01358     \textcolor{comment}{// Geometric Points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01359}01359     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01360}01360 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01361}01361     file\_out << \textcolor{stringliteral}{"{}<Points>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01362}01362              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Float32\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01363}01363              << \textcolor{stringliteral}{"{} NumberOfComponents=\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01364}01364              \textcolor{comment}{// This always has to be 3 for an unstructured grid}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01365}01365              << 3 << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01366}01366              << \textcolor{stringliteral}{"{}format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01367}01367 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01368}01368     \textcolor{comment}{// Loop over all the elements to print their plot points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01369}01369     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01370}01370     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01371}01371       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01372}01372       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01373}01373       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01374}01374 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01375}01375 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01376}01376       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01377}01377       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01378}01378         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01379}01379         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} faild"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01380}01380         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01381}01381           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01382}01382       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01383}01383 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01384}01384 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01385}01385       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_acf068d845f288d6353a96c323807352f}{output\_paraview}}(file\_out, nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01386}01386     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01387}01387 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01388}01388     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01389}01389              << \textcolor{stringliteral}{"{}</Points>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01390}01390 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01391}01391 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01392}01392     \textcolor{comment}{// Cells}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01393}01393     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01394}01394 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01395}01395     file\_out}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01396}01396       << \textcolor{stringliteral}{"{}<Cells>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01397}01397       << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Int32\(\backslash\)"{} Name=\(\backslash\)"{}connectivity\(\backslash\)"{} format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01398}01398 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01399}01399     \textcolor{comment}{// Make counter for keeping track of all the local elements,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01400}01400     \textcolor{comment}{// because Paraview requires global coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01401}01401     \textcolor{keywordtype}{unsigned} counter = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01402}01402 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01403}01403     \textcolor{comment}{// Write connectivity with the local elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01404}01404     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01405}01405     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01406}01406       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01407}01407       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01408}01408       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01409}01409 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01410}01410 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01411}01411       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01412}01412       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01413}01413         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01414}01414         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} faild"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01415}01415         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01416}01416           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01417}01417       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01418}01418 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01419}01419       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_afed006dd5b9ab6bd613d8496e6048abf}{write\_paraview\_output\_offset\_information}}(file\_out, nplot, counter);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01420}01420     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01421}01421 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01422}01422     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01423}01423              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Int32\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01424}01424              << \textcolor{stringliteral}{"{}Name=\(\backslash\)"{}offsets\(\backslash\)"{} format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01425}01425 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01426}01426     \textcolor{comment}{// Make variable that holds the current offset number}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01427}01427     \textcolor{keywordtype}{unsigned} offset\_sum = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01428}01428 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01429}01429     \textcolor{comment}{// Write the offset for the specific elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01430}01430     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01431}01431     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01432}01432       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01433}01433       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01434}01434       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01435}01435 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01436}01436 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01437}01437       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01438}01438       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01439}01439         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01440}01440         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01441}01441         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01442}01442           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01443}01443       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01444}01444 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01445}01445       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_af11d35779224185e6693f2db450cc111}{write\_paraview\_offsets}}(file\_out, nplot, offset\_sum);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01446}01446     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01447}01447 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01448}01448     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01449}01449              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}UInt8\(\backslash\)"{} Name=\(\backslash\)"{}types\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01450}01450 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01451}01451     \textcolor{comment}{// Loop over all elements to get the type that they have}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01452}01452     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01453}01453     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01454}01454       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01455}01455       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01456}01456       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01457}01457 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01458}01458 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01459}01459       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01460}01460       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01461}01461         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01462}01462         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01463}01463         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01464}01464           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01465}01465       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01466}01466 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01467}01467 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01468}01468       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a68f0f8dc76f04e7d69983ec711b4ab08}{write\_paraview\_type}}(file\_out, nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01469}01469     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01470}01470 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01471}01471     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01472}01472              << \textcolor{stringliteral}{"{}</Cells>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01473}01473 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01474}01474 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01475}01475     \textcolor{comment}{// File Closure}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01476}01476     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01477}01477     file\_out << \textcolor{stringliteral}{"{}</Piece>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01478}01478              << \textcolor{stringliteral}{"{}</UnstructuredGrid>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01479}01479              << \textcolor{stringliteral}{"{}</VTKFile>"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01480}01480   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01481}01481 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01482}01482 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01483}01483   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01484}01484 \textcolor{comment}{  /// Output in paraview format into specified file.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01485}01485 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01486}01486 \textcolor{comment}{  /// Breaks up each element into sub-\/elements for plotting}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01487}01487 \textcolor{comment}{  /// purposes. We assume that all elements are of the same}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01488}01488 \textcolor{comment}{  /// type (fct will break (in paranoid mode) if paraview}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01489}01489 \textcolor{comment}{  /// output fcts of the elements are inconsistent).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01490}01490 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01491}\mbox{\hyperlink{classoomph_1_1Mesh_a8bba347dea4098f0bf7142db582adc38}{01491}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a8bba347dea4098f0bf7142db582adc38}{Mesh::output\_fct\_paraview}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01492}01492     std::ofstream\& file\_out,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01493}01493     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01494}01494     \mbox{\hyperlink{classoomph_1_1FiniteElement_a690fd33af26cc3e84f39bba6d5a85202}{FiniteElement::SteadyExactSolutionFctPt}} exact\_soln\_pt)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01495}01495 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01496}01496     \textcolor{comment}{// Change the scientific format so that E is used rather than e}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01497}01497     file\_out.setf(std::ios\_base::uppercase);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01498}01498 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01499}01499     \textcolor{comment}{// Decide how many elements there are to be plotted}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01500}01500     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} number\_of\_elements = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01501}01501 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01502}01502     \textcolor{comment}{// Cast to finite element and return if cast fails.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01503}01503     \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01504}01504 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01505}01505 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01506}01506     \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01507}01507     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01508}01508       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Recast for FiniteElement failed for element 0!\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01509}01509                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01510}01510                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01511}01511     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01512}01512 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01513}01513 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01514}01514 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01515}01515 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01516}01516     \textcolor{comment}{// Check if all elements have the same number of degrees of freedom,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01517}01517     \textcolor{comment}{// if they don't, paraview will break}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01518}01518     \textcolor{keywordtype}{unsigned} el\_zero\_ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01519}01519     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01520}01520     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01521}01521       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01522}01522       \textcolor{keywordtype}{unsigned} el\_i\_ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01523}01523       \textcolor{keywordflow}{if} (el\_zero\_ndof != el\_i\_ndof)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01524}01524       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01525}01525         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01526}01526         error\_stream}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01527}01527           << \textcolor{stringliteral}{"{}Element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} has different number of degrees of freedom\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01528}01528           << \textcolor{stringliteral}{"{}than from previous elements, Paraview cannot handle this.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01529}01529           << \textcolor{stringliteral}{"{}We suggest that the problem is broken up into submeshes instead."{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01530}01530           << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01531}01531         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01532}01532           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01533}01533       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01534}01534     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01535}01535 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01536}01536 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01537}01537     \textcolor{comment}{// Make variables to hold the number of nodes and elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01538}01538     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} number\_of\_nodes = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01539}01539     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} total\_number\_of\_elements = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01540}01540 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01541}01541     \textcolor{comment}{// Loop over all the elements to find total number of plot points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01542}01542     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01543}01543     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01544}01544       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01545}01545       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01546}01546       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01547}01547 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01548}01548 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01549}01549       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01550}01550       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01551}01551         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01552}01552         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01553}01553         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01554}01554           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01555}01555       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01556}01556 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01557}01557 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01558}01558       number\_of\_nodes += fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a06d32c85753a1e302c3b345ea27f6c85}{nplot\_points\_paraview}}(nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01559}01559       total\_number\_of\_elements += fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_aa1e11deffc8ee67adaa59ce3ade0579f}{nsub\_elements\_paraview}}(nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01560}01560     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01561}01561 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01562}01562 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01563}01563     \textcolor{comment}{// File Declaration}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01564}01564     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01565}01565 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01566}01566     \textcolor{comment}{// Insert the necessary lines plus header of file, and}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01567}01567     \textcolor{comment}{// number of nodes and elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01568}01568     file\_out << \textcolor{stringliteral}{"{}<?xml version=\(\backslash\)"{}1.0\(\backslash\)"{}?>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01569}01569              << \textcolor{stringliteral}{"{}<VTKFile type=\(\backslash\)"{}UnstructuredGrid\(\backslash\)"{} version=\(\backslash\)"{}0.1\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01570}01570              << \textcolor{stringliteral}{"{}byte\_order=\(\backslash\)"{}LittleEndian\(\backslash\)"{}>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01571}01571              << \textcolor{stringliteral}{"{}<UnstructuredGrid>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01572}01572              << \textcolor{stringliteral}{"{}<Piece NumberOfPoints=\(\backslash\)"{}"{}} << number\_of\_nodes}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01573}01573              << \textcolor{stringliteral}{"{}\(\backslash\)"{} NumberOfCells=\(\backslash\)"{}"{}} << total\_number\_of\_elements << \textcolor{stringliteral}{"{}\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01574}01574 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01575}01575 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01576}01576     \textcolor{comment}{// Point Data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01577}01577     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01578}01578 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01579}01579     \textcolor{comment}{// Check the number of degrees of freedom}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01580}01580     \textcolor{keywordtype}{unsigned} ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01581}01581 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01582}01582     \textcolor{comment}{// Point data is going in here}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01583}01583     file\_out << \textcolor{stringliteral}{"{}<PointData "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01584}01584 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01585}01585     \textcolor{comment}{// Insert just the first scalar name, since paraview reads everything}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01586}01586     \textcolor{comment}{// else after that as being of the same type. Get information from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01587}01587     \textcolor{comment}{// first element.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01588}01588     file\_out << \textcolor{stringliteral}{"{}Scalars=\(\backslash\)"{}"{}} << fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a49cc2d4f7ed5772bbc96f06760372b51}{scalar\_name\_paraview}}(0) << \textcolor{stringliteral}{"{}\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01589}01589 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01590}01590     \textcolor{comment}{// Loop over i scalar fields and j number of elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01591}01591     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01592}01592     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01593}01593       file\_out << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Float32\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01594}01594                << \textcolor{stringliteral}{"{}Name=\(\backslash\)"{}"{}} << fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a49cc2d4f7ed5772bbc96f06760372b51}{scalar\_name\_paraview}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01595}01595                << \textcolor{stringliteral}{"{}format=\(\backslash\)"{}ascii\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01596}01596                << \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01597}01597 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01598}01598       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < number\_of\_elements; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01599}01599       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01600}01600         \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01601}01601         \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01602}01602         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01603}01603 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01604}01604 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01605}01605         \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01606}01606         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01607}01607           std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01608}01608           error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << j << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01609}01609           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01610}01610                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01611}01611                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01612}01612         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01613}01613 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01614}01614 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01615}01615         fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_ac6ce34f52481195e8dba634618ef3f36}{scalar\_value\_fct\_paraview}}(file\_out, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, nplot, exact\_soln\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01616}01616       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01617}01617 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01618}01618       \textcolor{comment}{// Close of the DataArray}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01619}01619       file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01620}01620     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01621}01621 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01622}01622     \textcolor{comment}{// Close off the PointData set}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01623}01623     file\_out << \textcolor{stringliteral}{"{}</PointData>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01624}01624 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01625}01625 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01626}01626     \textcolor{comment}{// Geometric Points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01627}01627     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01628}01628 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01629}01629     file\_out << \textcolor{stringliteral}{"{}<Points>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01630}01630              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Float32\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01631}01631              << \textcolor{stringliteral}{"{} NumberOfComponents=\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01632}01632              \textcolor{comment}{// This always has to be 3 for an unstructured grid}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01633}01633              << 3 << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01634}01634              << \textcolor{stringliteral}{"{}format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01635}01635 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01636}01636     \textcolor{comment}{// Loop over all the elements to print their plot points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01637}01637     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01638}01638     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01639}01639       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01640}01640       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01641}01641       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01642}01642 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01643}01643 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01644}01644       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01645}01645       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01646}01646         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01647}01647         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} faild"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01648}01648         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01649}01649           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01650}01650       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01651}01651 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01652}01652 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01653}01653       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_acf068d845f288d6353a96c323807352f}{output\_paraview}}(file\_out, nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01654}01654     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01655}01655 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01656}01656     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01657}01657              << \textcolor{stringliteral}{"{}</Points>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01658}01658 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01659}01659 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01660}01660     \textcolor{comment}{// Cells}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01661}01661     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01662}01662 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01663}01663     file\_out}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01664}01664       << \textcolor{stringliteral}{"{}<Cells>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01665}01665       << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Int32\(\backslash\)"{} Name=\(\backslash\)"{}connectivity\(\backslash\)"{} format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01666}01666 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01667}01667     \textcolor{comment}{// Make counter for keeping track of all the local elements,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01668}01668     \textcolor{comment}{// because Paraview requires global coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01669}01669     \textcolor{keywordtype}{unsigned} counter = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01670}01670 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01671}01671     \textcolor{comment}{// Write connectivity with the local elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01672}01672     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01673}01673     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01674}01674       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01675}01675       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01676}01676       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01677}01677 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01678}01678 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01679}01679       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01680}01680       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01681}01681         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01682}01682         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} faild"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01683}01683         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01684}01684           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01685}01685       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01686}01686 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01687}01687       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_afed006dd5b9ab6bd613d8496e6048abf}{write\_paraview\_output\_offset\_information}}(file\_out, nplot, counter);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01688}01688     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01689}01689 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01690}01690     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01691}01691              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Int32\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01692}01692              << \textcolor{stringliteral}{"{}Name=\(\backslash\)"{}offsets\(\backslash\)"{} format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01693}01693 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01694}01694     \textcolor{comment}{// Make variable that holds the current offset number}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01695}01695     \textcolor{keywordtype}{unsigned} offset\_sum = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01696}01696 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01697}01697     \textcolor{comment}{// Write the offset for the specific elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01698}01698     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01699}01699     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01700}01700       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01701}01701       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01702}01702       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01703}01703 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01704}01704 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01705}01705       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01706}01706       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01707}01707         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01708}01708         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01709}01709         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01710}01710           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01711}01711       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01712}01712 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01713}01713       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_af11d35779224185e6693f2db450cc111}{write\_paraview\_offsets}}(file\_out, nplot, offset\_sum);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01714}01714     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01715}01715 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01716}01716     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01717}01717              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}UInt8\(\backslash\)"{} Name=\(\backslash\)"{}types\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01718}01718 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01719}01719     \textcolor{comment}{// Loop over all elements to get the type that they have}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01720}01720     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01721}01721     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01722}01722       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01723}01723       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01724}01724       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01725}01725 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01726}01726 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01727}01727       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01728}01728       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01729}01729         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01730}01730         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01731}01731         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01732}01732           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01733}01733       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01734}01734 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01735}01735 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01736}01736       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a68f0f8dc76f04e7d69983ec711b4ab08}{write\_paraview\_type}}(file\_out, nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01737}01737     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01738}01738 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01739}01739     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01740}01740              << \textcolor{stringliteral}{"{}</Cells>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01741}01741 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01742}01742 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01743}01743     \textcolor{comment}{// File Closure}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01744}01744     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01745}01745     file\_out << \textcolor{stringliteral}{"{}</Piece>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01746}01746              << \textcolor{stringliteral}{"{}</UnstructuredGrid>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01747}01747              << \textcolor{stringliteral}{"{}</VTKFile>"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01748}01748   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01749}01749 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01750}01750 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01751}01751   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01752}01752 \textcolor{comment}{  /// Output in paraview format into specified file.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01753}01753 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01754}01754 \textcolor{comment}{  /// Breaks up each element into sub-\/elements for plotting}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01755}01755 \textcolor{comment}{  /// purposes. We assume that all elements are of the same}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01756}01756 \textcolor{comment}{  /// type (fct will break (in paranoid mode) if paraview}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01757}01757 \textcolor{comment}{  /// output fcts of the elements are inconsistent).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01758}01758 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01759}\mbox{\hyperlink{classoomph_1_1Mesh_a16157f769019724da979e47445e6c2d2}{01759}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a8bba347dea4098f0bf7142db582adc38}{Mesh::output\_fct\_paraview}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01760}01760     std::ofstream\& file\_out,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01761}01761     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01762}01762     \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& time,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01763}01763     \mbox{\hyperlink{classoomph_1_1FiniteElement_ad4ecf2b61b158a4b4d351a60d23c633e}{FiniteElement::UnsteadyExactSolutionFctPt}} exact\_soln\_pt)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01764}01764 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01765}01765     \textcolor{comment}{// Change the scientific format so that E is used rather than e}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01766}01766     file\_out.setf(std::ios\_base::uppercase);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01767}01767 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01768}01768     \textcolor{comment}{// Decide how many elements there are to be plotted}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01769}01769     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} number\_of\_elements = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01770}01770 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01771}01771     \textcolor{comment}{// Cast to finite element and return if cast fails.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01772}01772     \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01773}01773 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01774}01774 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01775}01775     \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01776}01776     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01777}01777       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Recast for FiniteElement failed for element 0!\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01778}01778                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01779}01779                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01780}01780     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01781}01781 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01782}01782 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01783}01783 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01784}01784 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01785}01785     \textcolor{comment}{// Check if all elements have the same number of degrees of freedom,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01786}01786     \textcolor{comment}{// if they don't, paraview will break}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01787}01787     \textcolor{keywordtype}{unsigned} el\_zero\_ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01788}01788     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01789}01789     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01790}01790       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01791}01791       \textcolor{keywordtype}{unsigned} el\_i\_ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01792}01792       \textcolor{keywordflow}{if} (el\_zero\_ndof != el\_i\_ndof)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01793}01793       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01794}01794         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01795}01795         error\_stream}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01796}01796           << \textcolor{stringliteral}{"{}Element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} has different number of degrees of freedom\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01797}01797           << \textcolor{stringliteral}{"{}than from previous elements, Paraview cannot handle this.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01798}01798           << \textcolor{stringliteral}{"{}We suggest that the problem is broken up into submeshes instead."{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01799}01799           << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01800}01800         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01801}01801           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01802}01802       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01803}01803     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01804}01804 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01805}01805 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01806}01806     \textcolor{comment}{// Make variables to hold the number of nodes and elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01807}01807     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} number\_of\_nodes = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01808}01808     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} total\_number\_of\_elements = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01809}01809 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01810}01810     \textcolor{comment}{// Loop over all the elements to find total number of plot points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01811}01811     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01812}01812     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01813}01813       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01814}01814       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01815}01815       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01816}01816 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01817}01817 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01818}01818       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01819}01819       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01820}01820         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01821}01821         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01822}01822         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01823}01823           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01824}01824       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01825}01825 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01826}01826 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01827}01827       number\_of\_nodes += fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a06d32c85753a1e302c3b345ea27f6c85}{nplot\_points\_paraview}}(nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01828}01828       total\_number\_of\_elements += fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_aa1e11deffc8ee67adaa59ce3ade0579f}{nsub\_elements\_paraview}}(nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01829}01829     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01830}01830 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01831}01831 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01832}01832     \textcolor{comment}{// File Declaration}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01833}01833     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01834}01834 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01835}01835     \textcolor{comment}{// Insert the necessary lines plus header of file, and}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01836}01836     \textcolor{comment}{// number of nodes and elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01837}01837     file\_out << \textcolor{stringliteral}{"{}<?xml version=\(\backslash\)"{}1.0\(\backslash\)"{}?>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01838}01838              << \textcolor{stringliteral}{"{}<VTKFile type=\(\backslash\)"{}UnstructuredGrid\(\backslash\)"{} version=\(\backslash\)"{}0.1\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01839}01839              << \textcolor{stringliteral}{"{}byte\_order=\(\backslash\)"{}LittleEndian\(\backslash\)"{}>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01840}01840              << \textcolor{stringliteral}{"{}<UnstructuredGrid>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01841}01841              << \textcolor{stringliteral}{"{}<Piece NumberOfPoints=\(\backslash\)"{}"{}} << number\_of\_nodes}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01842}01842              << \textcolor{stringliteral}{"{}\(\backslash\)"{} NumberOfCells=\(\backslash\)"{}"{}} << total\_number\_of\_elements << \textcolor{stringliteral}{"{}\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01843}01843 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01844}01844 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01845}01845     \textcolor{comment}{// Point Data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01846}01846     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01847}01847 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01848}01848     \textcolor{comment}{// Check the number of degrees of freedom}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01849}01849     \textcolor{keywordtype}{unsigned} ndof = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a865e2e5586552ba80babdbe26a77fe8c}{nscalar\_paraview}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01850}01850 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01851}01851     \textcolor{comment}{// Point data is going in here}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01852}01852     file\_out << \textcolor{stringliteral}{"{}<PointData "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01853}01853 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01854}01854     \textcolor{comment}{// Insert just the first scalar name, since paraview reads everything}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01855}01855     \textcolor{comment}{// else after that as being of the same type. Get information from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01856}01856     \textcolor{comment}{// first element.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01857}01857     file\_out << \textcolor{stringliteral}{"{}Scalars=\(\backslash\)"{}"{}} << fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a49cc2d4f7ed5772bbc96f06760372b51}{scalar\_name\_paraview}}(0) << \textcolor{stringliteral}{"{}\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01858}01858 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01859}01859     \textcolor{comment}{// Loop over i scalar fields and j number of elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01860}01860     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndof; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01861}01861     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01862}01862       file\_out << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Float32\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01863}01863                << \textcolor{stringliteral}{"{}Name=\(\backslash\)"{}"{}} << fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a49cc2d4f7ed5772bbc96f06760372b51}{scalar\_name\_paraview}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01864}01864                << \textcolor{stringliteral}{"{}format=\(\backslash\)"{}ascii\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01865}01865                << \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01866}01866 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01867}01867       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < number\_of\_elements; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01868}01868       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01869}01869         \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01870}01870         \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01871}01871         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01872}01872 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01873}01873 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01874}01874         \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01875}01875         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01876}01876           std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01877}01877           error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << j << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01878}01878           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01879}01879                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01880}01880                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01881}01881         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01882}01882 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01883}01883 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01884}01884         fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_ac6ce34f52481195e8dba634618ef3f36}{scalar\_value\_fct\_paraview}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01885}01885           file\_out, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, nplot, time, exact\_soln\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01886}01886       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01887}01887 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01888}01888       \textcolor{comment}{// Close of the DataArray}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01889}01889       file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01890}01890     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01891}01891 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01892}01892     \textcolor{comment}{// Close off the PointData set}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01893}01893     file\_out << \textcolor{stringliteral}{"{}</PointData>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01894}01894 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01895}01895 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01896}01896     \textcolor{comment}{// Geometric Points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01897}01897     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01898}01898 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01899}01899     file\_out << \textcolor{stringliteral}{"{}<Points>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01900}01900              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Float32\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01901}01901              << \textcolor{stringliteral}{"{} NumberOfComponents=\(\backslash\)"{}"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01902}01902              \textcolor{comment}{// This always has to be 3 for an unstructured grid}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01903}01903              << 3 << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01904}01904              << \textcolor{stringliteral}{"{}format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01905}01905 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01906}01906     \textcolor{comment}{// Loop over all the elements to print their plot points}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01907}01907     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01908}01908     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01909}01909       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01910}01910       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01911}01911       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01912}01912 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01913}01913 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01914}01914       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01915}01915       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01916}01916         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01917}01917         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} faild"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01918}01918         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01919}01919           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01920}01920       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01921}01921 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01922}01922 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01923}01923       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_acf068d845f288d6353a96c323807352f}{output\_paraview}}(file\_out, nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01924}01924     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01925}01925 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01926}01926     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01927}01927              << \textcolor{stringliteral}{"{}</Points>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01928}01928 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01929}01929 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01930}01930     \textcolor{comment}{// Cells}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01931}01931     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01932}01932 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01933}01933     file\_out}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01934}01934       << \textcolor{stringliteral}{"{}<Cells>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01935}01935       << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Int32\(\backslash\)"{} Name=\(\backslash\)"{}connectivity\(\backslash\)"{} format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01936}01936 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01937}01937     \textcolor{comment}{// Make counter for keeping track of all the local elements,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01938}01938     \textcolor{comment}{// because Paraview requires global coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01939}01939     \textcolor{keywordtype}{unsigned} counter = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01940}01940 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01941}01941     \textcolor{comment}{// Write connectivity with the local elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01942}01942     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01943}01943     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01944}01944       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01945}01945       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01946}01946       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01947}01947 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01948}01948 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01949}01949       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01950}01950       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01951}01951         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01952}01952         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} faild"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01953}01953         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01954}01954           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01955}01955       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01956}01956 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01957}01957       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_afed006dd5b9ab6bd613d8496e6048abf}{write\_paraview\_output\_offset\_information}}(file\_out, nplot, counter);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01958}01958     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01959}01959 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01960}01960     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01961}01961              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}Int32\(\backslash\)"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01962}01962              << \textcolor{stringliteral}{"{}Name=\(\backslash\)"{}offsets\(\backslash\)"{} format=\(\backslash\)"{}ascii\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01963}01963 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01964}01964     \textcolor{comment}{// Make variable that holds the current offset number}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01965}01965     \textcolor{keywordtype}{unsigned} offset\_sum = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01966}01966 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01967}01967     \textcolor{comment}{// Write the offset for the specific elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01968}01968     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01969}01969     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01970}01970       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01971}01971       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01972}01972       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01973}01973 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01974}01974 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01975}01975       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01976}01976       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01977}01977         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01978}01978         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01979}01979         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01980}01980           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01981}01981       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01982}01982 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01983}01983       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_af11d35779224185e6693f2db450cc111}{write\_paraview\_offsets}}(file\_out, nplot, offset\_sum);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01984}01984     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01985}01985 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01986}01986     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01987}01987              << \textcolor{stringliteral}{"{}<DataArray type=\(\backslash\)"{}UInt8\(\backslash\)"{} Name=\(\backslash\)"{}types\(\backslash\)"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01988}01988 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01989}01989     \textcolor{comment}{// Loop over all elements to get the type that they have}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01990}01990     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < number\_of\_elements; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01991}01991     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01992}01992       \textcolor{comment}{// Cast to FiniteElement and (in paranoid mode) check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01993}01993       \textcolor{comment}{// if cast has failed.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01994}01994       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01995}01995 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01996}01996 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01997}01997       \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01998}01998       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l01999}01999         std::stringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02000}02000         error\_stream << \textcolor{stringliteral}{"{}Recast for element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} failed"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02001}02001         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02002}02002           error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02003}02003       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02004}02004 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02005}02005 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02006}02006       fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a68f0f8dc76f04e7d69983ec711b4ab08}{write\_paraview\_type}}(file\_out, nplot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02007}02007     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02008}02008 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02009}02009     file\_out << \textcolor{stringliteral}{"{}</DataArray>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02010}02010              << \textcolor{stringliteral}{"{}</Cells>\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02011}02011 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02012}02012 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02013}02013     \textcolor{comment}{// File Closure}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02014}02014     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02015}02015     file\_out << \textcolor{stringliteral}{"{}</Piece>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02016}02016              << \textcolor{stringliteral}{"{}</UnstructuredGrid>\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02017}02017              << \textcolor{stringliteral}{"{}</VTKFile>"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02018}02018   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02019}02019 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02020}02020 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02021}02021   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02022}02022 \textcolor{comment}{  /// Output function for the mesh class}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02023}02023 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02024}02024 \textcolor{comment}{  /// Loop over all elements and plot (i.e. execute}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02025}02025 \textcolor{comment}{  /// the element's own output() function)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02026}02026 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02027}\mbox{\hyperlink{classoomph_1_1Mesh_aab74388e8e21325f3ca26f1bd99c26f7}{02027}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_aab74388e8e21325f3ca26f1bd99c26f7}{Mesh::output}}(std::ostream\& outfile)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02028}02028   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02029}02029     \textcolor{comment}{// Loop over the elements and call their output functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02030}02030     \textcolor{comment}{// Assign Element\_pt\_range}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02031}02031     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02032}02032     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02033}02033     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02034}02034       \textcolor{comment}{// Try to cast to FiniteElement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02035}02035       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02036}02036       \textcolor{keywordflow}{if} (el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02037}02037       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02038}02038         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Can't execute output(...) for non FiniteElements"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02039}02039                    << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02040}02040       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02041}02041       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02042}02042       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02043}02043 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02044}02044         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a90a3555bd14fdfe3b0c503672f832a43}{Output\_halo\_elements}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02045}02045 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02046}02046         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02047}02047           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(outfile);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02048}02048         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02049}02049 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02050}02050         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02051}02051         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02052}02052           \textcolor{keywordflow}{if} (!el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02053}02053           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02054}02054             el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(outfile);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02055}02055           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02056}02056         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02057}02057 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02058}02058       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02059}02059     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02060}02060   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02061}02061 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02062}02062   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02063}02063 \textcolor{comment}{  /// Output function for the mesh class}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02064}02064 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02065}02065 \textcolor{comment}{  /// Loop over all elements and plot (i.e. execute}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02066}02066 \textcolor{comment}{  /// the element's own output() function). Use}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02067}02067 \textcolor{comment}{  /// n\_plot plot points in each coordinate direction.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02068}02068 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02069}\mbox{\hyperlink{classoomph_1_1Mesh_acdd7ba97e7b862988955fd0c4766ba4d}{02069}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_aab74388e8e21325f3ca26f1bd99c26f7}{Mesh::output}}(std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02070}02070   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02071}02071     \textcolor{comment}{// Loop over the elements and call their output functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02072}02072     \textcolor{comment}{// Assign Element\_pt\_range}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02073}02073     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02074}02074 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02075}02075     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02076}02076     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02077}02077       \textcolor{comment}{// Try to cast to FiniteElement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02078}02078       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02079}02079       \textcolor{keywordflow}{if} (el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02080}02080       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02081}02081         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Can't execute output(...) for non FiniteElements"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02082}02082                    << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02083}02083       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02084}02084       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02085}02085       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02086}02086 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02087}02087         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a90a3555bd14fdfe3b0c503672f832a43}{Output\_halo\_elements}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02088}02088 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02089}02089         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02090}02090           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(outfile, n\_plot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02091}02091         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02092}02092 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02093}02093         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02094}02094         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02095}02095           \textcolor{keywordflow}{if} (!el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02096}02096           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02097}02097             el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(outfile, n\_plot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02098}02098           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02099}02099         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02100}02100 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02101}02101       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02102}02102     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02103}02103   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02104}02104 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02105}02105 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02106}02106   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02107}02107 \textcolor{comment}{  /// Output function for the mesh class}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02108}02108 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02109}02109 \textcolor{comment}{  /// Loop over all elements and plot (i.e. execute}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02110}02110 \textcolor{comment}{  /// the element's own output() function)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02111}02111 \textcolor{comment}{  /// (C style output)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02112}02112 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02113}\mbox{\hyperlink{classoomph_1_1Mesh_a8d2a1aa08f3a7912c5e3f2d5f30e0110}{02113}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_aab74388e8e21325f3ca26f1bd99c26f7}{Mesh::output}}(FILE* file\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02114}02114   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02115}02115     \textcolor{comment}{// Loop over the elements and call their output functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02116}02116     \textcolor{comment}{// Assign Element\_pt\_range}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02117}02117     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02118}02118     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02119}02119     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02120}02120       \textcolor{comment}{// Try to cast to FiniteElement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02121}02121       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02122}02122       \textcolor{keywordflow}{if} (el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02123}02123       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02124}02124         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Can't execute output(...) for non FiniteElements"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02125}02125                    << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02126}02126       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02127}02127       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02128}02128       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02129}02129 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02130}02130         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a90a3555bd14fdfe3b0c503672f832a43}{Output\_halo\_elements}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02131}02131 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02132}02132         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02133}02133           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(file\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02134}02134         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02135}02135 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02136}02136         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02137}02137         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02138}02138           \textcolor{keywordflow}{if} (!el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02139}02139           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02140}02140             el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(file\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02141}02141           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02142}02142         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02143}02143 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02144}02144       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02145}02145     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02146}02146   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02147}02147 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02148}02148   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02149}02149 \textcolor{comment}{  /// Output function for the mesh class}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02150}02150 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02151}02151 \textcolor{comment}{  /// Loop over all elements and plot (i.e. execute}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02152}02152 \textcolor{comment}{  /// the element's own output() function). Use}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02153}02153 \textcolor{comment}{  /// n\_plot plot points in each coordinate direction.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02154}02154 \textcolor{comment}{  /// (C style output)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02155}02155 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02156}\mbox{\hyperlink{classoomph_1_1Mesh_a926a1595fd8e9932e8c87a58a7ae23e1}{02156}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_aab74388e8e21325f3ca26f1bd99c26f7}{Mesh::output}}(FILE* file\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02157}02157   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02158}02158     \textcolor{comment}{// Loop over the elements and call their output functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02159}02159     \textcolor{comment}{// Assign Element\_pt\_range}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02160}02160     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02161}02161     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02162}02162     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02163}02163       \textcolor{comment}{// Try to cast to FiniteElement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02164}02164       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02165}02165       \textcolor{keywordflow}{if} (el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02166}02166       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02167}02167         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Can't execute output(...) for non FiniteElements"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02168}02168                    << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02169}02169       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02170}02170       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02171}02171       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02172}02172 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02173}02173         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a90a3555bd14fdfe3b0c503672f832a43}{Output\_halo\_elements}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02174}02174 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02175}02175         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02176}02176           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(file\_pt, n\_plot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02177}02177         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02178}02178 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02179}02179         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02180}02180         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02181}02181           \textcolor{keywordflow}{if} (!el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02182}02182           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02183}02183             el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(file\_pt, n\_plot);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02184}02184           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02185}02185         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02186}02186 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02187}02187       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02188}02188     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02189}02189   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02190}02190 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02191}02191 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02192}02192   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02193}02193 \textcolor{comment}{  /// Output function for the mesh class}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02194}02194 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02195}02195 \textcolor{comment}{  /// Loop over all elements and plot (i.e. execute}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02196}02196 \textcolor{comment}{  /// the element's own output() function). Use}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02197}02197 \textcolor{comment}{  /// n\_plot plot points in each coordinate direction.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02198}02198 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02199}\mbox{\hyperlink{classoomph_1_1Mesh_a7c5d6492f33fcd0dc7a65b7bc2a2dde2}{02199}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a7c5d6492f33fcd0dc7a65b7bc2a2dde2}{Mesh::output\_fct}}(std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02200}02200                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02201}02201                         \mbox{\hyperlink{classoomph_1_1FiniteElement_a690fd33af26cc3e84f39bba6d5a85202}{FiniteElement::SteadyExactSolutionFctPt}} exact\_soln\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02202}02202   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02203}02203     \textcolor{comment}{// Loop over the elements and call their output functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02204}02204     \textcolor{comment}{// Assign Element\_pt\_range}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02205}02205     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02206}02206     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02207}02207     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02208}02208       \textcolor{comment}{// Try to cast to FiniteElement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02209}02209       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02210}02210       \textcolor{keywordflow}{if} (el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02211}02211       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02212}02212         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Can't execute output\_fct(...) for non FiniteElements"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02213}02213                    << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02214}02214       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02215}02215       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02216}02216       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02217}02217 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02218}02218         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a90a3555bd14fdfe3b0c503672f832a43}{Output\_halo\_elements}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02219}02219 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02220}02220         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02221}02221           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a22b695c714f60ee6cd145be348042035}{output\_fct}}(outfile, n\_plot, exact\_soln\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02222}02222         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02223}02223 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02224}02224         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02225}02225         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02226}02226           \textcolor{keywordflow}{if} (!el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02227}02227           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02228}02228             el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a22b695c714f60ee6cd145be348042035}{output\_fct}}(outfile, n\_plot, exact\_soln\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02229}02229           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02230}02230         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02231}02231 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02232}02232       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02233}02233     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02234}02234   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02235}02235 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02236}02236   \textcolor{comment}{//========================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02237}02237 \textcolor{comment}{  /// Output function for the mesh class}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02238}02238 \textcolor{comment}{  ///}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02239}02239 \textcolor{comment}{  /// Loop over all elements and plot (i.e. execute}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02240}02240 \textcolor{comment}{  /// the element's own output() function) at time t. Use}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02241}02241 \textcolor{comment}{  /// n\_plot plot points in each coordinate direction.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02242}02242 \textcolor{comment}{}  \textcolor{comment}{//========================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02243}\mbox{\hyperlink{classoomph_1_1Mesh_a56d3007b3d8a11c8f5852bcfcc1d195d}{02243}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a7c5d6492f33fcd0dc7a65b7bc2a2dde2}{Mesh::output\_fct}}(std::ostream\& outfile,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02244}02244                         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n\_plot,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02245}02245                         \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& time,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02246}02246                         \mbox{\hyperlink{classoomph_1_1FiniteElement_ad4ecf2b61b158a4b4d351a60d23c633e}{FiniteElement::UnsteadyExactSolutionFctPt}} exact\_soln\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02247}02247   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02248}02248     \textcolor{comment}{// Loop over the elements and call their output functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02249}02249     \textcolor{comment}{// Assign Element\_pt\_range}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02250}02250     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Element\_pt\_range = \mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02251}02251     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Element\_pt\_range; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02252}02252     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02253}02253       \textcolor{comment}{// Try to cast to FiniteElement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02254}02254       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02255}02255       \textcolor{keywordflow}{if} (el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02256}02256       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02257}02257         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Can't execute output\_fct(...) for non FiniteElements"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02258}02258                    << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02259}02259       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02260}02260       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02261}02261       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02262}02262 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02263}02263         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a90a3555bd14fdfe3b0c503672f832a43}{Output\_halo\_elements}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02264}02264 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02265}02265         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02266}02266           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a22b695c714f60ee6cd145be348042035}{output\_fct}}(outfile, n\_plot, time, exact\_soln\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02267}02267         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02268}02268 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02269}02269         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02270}02270         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02271}02271           \textcolor{keywordflow}{if} (!el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02272}02272           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02273}02273             el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a22b695c714f60ee6cd145be348042035}{output\_fct}}(outfile, n\_plot, time, exact\_soln\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02274}02274           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02275}02275         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02276}02276 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02277}02277       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02278}02278     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02279}02279   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02280}02280 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02281}02281   \textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02282}02282 \textcolor{comment}{  /// Assign the initial values for an impulsive start, which is}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02283}02283 \textcolor{comment}{  /// acheived by looping over all data in the mesh (internal element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02284}02284 \textcolor{comment}{  /// data and data stored at nodes) and setting the calling the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02285}02285 \textcolor{comment}{  /// assign\_initial\_values\_impulsive() function for each data's}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02286}02286 \textcolor{comment}{  /// timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02287}02287 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02288}\mbox{\hyperlink{classoomph_1_1Mesh_ab1ceceaadc7114773f5a70cb52e67081}{02288}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ab1ceceaadc7114773f5a70cb52e67081}{Mesh::assign\_initial\_values\_impulsive}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02289}02289   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02290}02290     \textcolor{comment}{// Loop over the elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02291}02291     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Nelement = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02292}02292     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Nelement; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02293}02293     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02294}02294       \textcolor{comment}{// Find the number of internal dofs}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02295}02295       \textcolor{keywordtype}{unsigned} Ninternal = \mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>ninternal\_data();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02296}02296       \textcolor{comment}{// Loop over internal dofs and shift the time values}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02297}02297       \textcolor{comment}{// using the internals data's timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02298}02298       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < Ninternal; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02299}02299       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02300}02300         \mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02301}02301           -\/>internal\_data\_pt(j)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02302}02302           -\/>time\_stepper\_pt()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02303}02303           -\/>assign\_initial\_values\_impulsive(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>internal\_data\_pt(j));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02304}02304       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02305}02305     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02306}02306 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02307}02307     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02308}02308     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02309}02309     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02310}02310     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02311}02311       \textcolor{comment}{// Assign initial values using the Node's timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02312}02312       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>time\_stepper\_pt()-\/>assign\_initial\_values\_impulsive(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02313}02313         \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02314}02314       \textcolor{comment}{// Assign initial positions using the Node's timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02315}02315       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02316}02316         -\/>position\_time\_stepper\_pt()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02317}02317         -\/>assign\_initial\_positions\_impulsive(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02318}02318     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02319}02319   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02320}02320 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02321}02321   \textcolor{comment}{//===============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02322}02322 \textcolor{comment}{  /// Shift time-\/dependent data along for next timestep:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02323}02323 \textcolor{comment}{  /// Again this is achieved by looping over all data and calling}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02324}02324 \textcolor{comment}{  /// the functions defined in each data object's timestepper.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02325}02325 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02326}\mbox{\hyperlink{classoomph_1_1Mesh_a7f097aaa854ac697f8016ba3b7e6c982}{02326}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a7f097aaa854ac697f8016ba3b7e6c982}{Mesh::shift\_time\_values}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02327}02327   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02328}02328     \textcolor{comment}{// Loop over the elements which shift their internal data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02329}02329     \textcolor{comment}{// via their own timesteppers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02330}02330     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Nelement = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02331}02331     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Nelement; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02332}02332     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02333}02333       \textcolor{comment}{// Find the number of internal dofs}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02334}02334       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} Ninternal = \mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>ninternal\_data();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02335}02335       \textcolor{comment}{// Loop over internal dofs and shift the time values}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02336}02336       \textcolor{comment}{// using the internals data's timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02337}02337       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < Ninternal; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02338}02338       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02339}02339         \mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02340}02340           -\/>internal\_data\_pt(j)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02341}02341           -\/>time\_stepper\_pt()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02342}02342           -\/>shift\_time\_values(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>internal\_data\_pt(j));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02343}02343       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02344}02344     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02345}02345 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02346}02346     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02347}02347     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02348}02348     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02349}02349     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02350}02350       \textcolor{comment}{// Shift the Data associated with the nodes with the Node's own}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02351}02351       \textcolor{comment}{// timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02352}02352       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>time\_stepper\_pt()-\/>shift\_time\_values(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02353}02353       \textcolor{comment}{// Push history of nodal positions back}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02354}02354       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>position\_time\_stepper\_pt()-\/>shift\_time\_positions(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02355}02355     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02356}02356   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02357}02357 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02358}02358   \textcolor{comment}{//=========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02359}02359 \textcolor{comment}{  /// Calculate predictions for all Data and positions associated}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02360}02360 \textcolor{comment}{  /// with the mesh. This is usually only used for adaptive time-\/stepping}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02361}02361 \textcolor{comment}{  /// when the comparison between a predicted value and the actual value}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02362}02362 \textcolor{comment}{  /// is usually used to determine the change in step size. Again the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02363}02363 \textcolor{comment}{  /// loop is over all data in the mesh and individual timestepper functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02364}02364 \textcolor{comment}{  /// for each data value are called.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02365}02365 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02366}\mbox{\hyperlink{classoomph_1_1Mesh_a823b11b11e6a0c3c22ea86dc60a3da65}{02366}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a823b11b11e6a0c3c22ea86dc60a3da65}{Mesh::calculate\_predictions}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02367}02367   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02368}02368     \textcolor{comment}{// Loop over the elements which shift their internal data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02369}02369     \textcolor{comment}{// via their own timesteppers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02370}02370     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} Nelement = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02371}02371     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < Nelement; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02372}02372     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02373}02373       \textcolor{comment}{// Find the number of internal dofs}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02374}02374       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} Ninternal = \mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>ninternal\_data();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02375}02375       \textcolor{comment}{// Loop over internal dofs and calculate predicted positions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02376}02376       \textcolor{comment}{// using the internals data's timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02377}02377       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < Ninternal; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02378}02378       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02379}02379         \mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02380}02380           -\/>internal\_data\_pt(j)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02381}02381           -\/>time\_stepper\_pt()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02382}02382           -\/>calculate\_predicted\_values(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>internal\_data\_pt(j));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02383}02383       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02384}02384     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02385}02385 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02386}02386     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02387}02387     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02388}02388     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02389}02389     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02390}02390       \textcolor{comment}{// Calculate the predicted values at the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02391}02391       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>time\_stepper\_pt()-\/>calculate\_predicted\_values(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02392}02392       \textcolor{comment}{// Calculate the predicted positions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02393}02393       \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>position\_time\_stepper\_pt()-\/>calculate\_predicted\_positions(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02394}02394         \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02395}02395     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02396}02396   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02397}02397 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02398}02398   \textcolor{comment}{//===============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02399}02399 \textcolor{comment}{  /// Virtual function that should be overloaded if the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02400}02400 \textcolor{comment}{  /// has any mesh level storage of the timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02401}02401 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02402}\mbox{\hyperlink{classoomph_1_1Mesh_a52c30b4ebc67038e137a5de1c5d422e5}{02402}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a52c30b4ebc67038e137a5de1c5d422e5}{Mesh::set\_mesh\_level\_time\_stepper}}(\mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* \textcolor{keyword}{const}\& time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02403}02403                                          \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& preserve\_existing\_data)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02404}02404   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02405}02405 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02406}02406     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classoomph_1_1Mesh_ada6bc12304d1536b747596d1049e48be}{Suppress\_warning\_about\_empty\_mesh\_level\_time\_stepper\_function}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02407}02407     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02408}02408       std::ostringstream warning\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02409}02409       warning\_stream}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02410}02410         << \textcolor{stringliteral}{"{}Empty set\_mesh\_level\_time\_stepper() has been called.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02411}02411         << \textcolor{stringliteral}{"{}This function needs to be overloaded to reset any (pointers to) \(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02412}02412         << \textcolor{stringliteral}{"{}timesteppers for meshes that store timesteppers in locations "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02413}02413            \textcolor{stringliteral}{"{}other\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02414}02414         << \textcolor{stringliteral}{"{}than the Nodes or Elements;\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02415}02415         << \textcolor{stringliteral}{"{}e.g. SpineMeshes have SpineData with timesteppers,\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02416}02416         << \textcolor{stringliteral}{"{}Triangle and TetMeshes store the timestepper for use in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02417}02417            \textcolor{stringliteral}{"{}adaptivity.\(\backslash\)n\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02418}02418       warning\_stream}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02419}02419         << \textcolor{stringliteral}{"{}If you are solving a continuation or bifurcation detecion\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02420}02420         << \textcolor{stringliteral}{"{}problem and strange things are happening, then check that\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02421}02421         << \textcolor{stringliteral}{"{}you don't need to overload this function for your mesh."{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02422}02422         << \textcolor{stringliteral}{"{}\(\backslash\)n This warning can be suppressed by setting:\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02423}02423         << \textcolor{stringliteral}{"{}Mesh::Suppress\_warning\_about\_empty\_mesh\_level\_time\_stepper\_"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02424}02424            \textcolor{stringliteral}{"{}function=true"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02425}02425         << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02426}02426       \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02427}02427         warning\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02428}02428     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02429}02429 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02430}02430   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02431}02431 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02432}02432   \textcolor{comment}{//===============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02433}02433 \textcolor{comment}{  /// Set the values of auxilliary data used in continuation problems}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02434}02434 \textcolor{comment}{  /// when the data is pinned.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02435}02435 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02436}\mbox{\hyperlink{classoomph_1_1Mesh_ac8d6a5dcf3af2df66625079975d84c19}{02436}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ac8d6a5dcf3af2df66625079975d84c19}{Mesh::set\_consistent\_pinned\_values\_for\_continuation}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02437}02437     \mbox{\hyperlink{classoomph_1_1ContinuationStorageScheme}{ContinuationStorageScheme}}* \textcolor{keyword}{const}\& continuation\_storage\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02438}02438   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02439}02439     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02440}02440     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02441}02441     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02442}02442     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02443}02443       continuation\_storage\_pt-\/>\mbox{\hyperlink{classoomph_1_1ContinuationStorageScheme_a279e4c16176c0374b9bba05519a17b0c}{set\_consistent\_pinned\_values}}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02444}02444       continuation\_storage\_pt-\/>\mbox{\hyperlink{classoomph_1_1ContinuationStorageScheme_ad08f35407fff9e171312d482cfdeacc0}{set\_consistent\_pinned\_positions}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02445}02445         this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02446}02446     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02447}02447 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02448}02448     \textcolor{comment}{// Loop over the elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02449}02449     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02450}02450     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02451}02451     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02452}02452       \textcolor{comment}{// Cache pointer to the elemnet}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02453}02453       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const} elem\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02454}02454       \textcolor{comment}{// Find the number of internal dofs}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02455}02455       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_internal = elem\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02456}02456 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02457}02457       \textcolor{comment}{// Loop over internal dofs and test the data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02458}02458       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_internal; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02459}02459       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02460}02460         continuation\_storage\_pt-\/>\mbox{\hyperlink{classoomph_1_1ContinuationStorageScheme_a279e4c16176c0374b9bba05519a17b0c}{set\_consistent\_pinned\_values}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02461}02461           elem\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02462}02462       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02463}02463     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02464}02464   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02465}02465 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02466}02466 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02467}02467   \textcolor{comment}{//===============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02468}02468 \textcolor{comment}{  /// Return true if the pointer corresponds to any data stored in}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02469}02469 \textcolor{comment}{  /// the mesh and false if not}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02470}02470 \textcolor{comment}{}  \textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02471}\mbox{\hyperlink{classoomph_1_1Mesh_a13712b3fb8f01107772db51e01dbeee0}{02471}}   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classoomph_1_1Mesh_a13712b3fb8f01107772db51e01dbeee0}{Mesh::does\_pointer\_correspond\_to\_mesh\_data}}(\textcolor{keywordtype}{double}* \textcolor{keyword}{const}\& parameter\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02472}02472   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02473}02473     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02474}02474     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02475}02475     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02476}02476     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02477}02477       \textcolor{comment}{// Check the values and positional data associated with each node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02478}02478       \textcolor{keywordflow}{if} ((this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>does\_pointer\_correspond\_to\_value(parameter\_pt)) ||}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02479}02479           (this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>does\_pointer\_correspond\_to\_position\_data(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02480}02480             parameter\_pt)))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02481}02481       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02482}02482         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02483}02483       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02484}02484     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02485}02485 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02486}02486     \textcolor{comment}{// Loop over the elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02487}02487     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02488}02488     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02489}02489     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02490}02490       \textcolor{comment}{// Cache pointer to the elemnet}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02491}02491       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* \textcolor{keyword}{const} elem\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02492}02492 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02493}02493       \textcolor{comment}{// Find the number of internal dofs}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02494}02494       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_internal = elem\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02495}02495 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02496}02496       \textcolor{comment}{// Loop over internal dofs and test the data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02497}02497       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_internal; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02498}02498       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02499}02499         \textcolor{keywordflow}{if} (elem\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(j)-\/>\mbox{\hyperlink{classoomph_1_1Data_a1f001b88764d62579e0ed8d53f9d359f}{does\_pointer\_correspond\_to\_value}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02500}02500               parameter\_pt))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02501}02501         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02502}02502           \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02503}02503         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02504}02504       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02505}02505     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02506}02506 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02507}02507     \textcolor{comment}{// If we get here we haven't found the data, so return false}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02508}02508     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02509}02509   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02510}02510 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02511}02511 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02512}02512   \textcolor{comment}{//===============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02513}02513 \textcolor{comment}{  /// Set the time stepper associated with all the nodal data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02514}02514 \textcolor{comment}{  /// in the problem}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02515}02515 \textcolor{comment}{}  \textcolor{comment}{//==============================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02516}\mbox{\hyperlink{classoomph_1_1Mesh_ac40c947d8ffe5b14aa6ac77fc398f3ec}{02516}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ac40c947d8ffe5b14aa6ac77fc398f3ec}{Mesh::set\_nodal\_time\_stepper}}(\mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* \textcolor{keyword}{const}\& time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02517}02517                                     \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& preserve\_existing\_data)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02518}02518   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02519}02519     \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02520}02520     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02521}02521     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02522}02522     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02523}02523       \textcolor{comment}{// Set the timestepper associated with each node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02524}02524       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>set\_time\_stepper(time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02525}02525                                          preserve\_existing\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02526}02526       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]-\/>set\_position\_time\_stepper(time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02527}02527                                                   preserve\_existing\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02528}02528     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02529}02529   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02530}02530 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02531}02531   \textcolor{comment}{//===============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02532}02532 \textcolor{comment}{  /// Set the time stepper associated with all internal data stored}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02533}02533 \textcolor{comment}{  /// in the elements in the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02534}02534 \textcolor{comment}{}  \textcolor{comment}{//===============================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02535}\mbox{\hyperlink{classoomph_1_1Mesh_a681b7531f2c90ea88c8a5ff4df7bce59}{02535}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a681b7531f2c90ea88c8a5ff4df7bce59}{Mesh::set\_elemental\_internal\_time\_stepper}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02536}02536     \mbox{\hyperlink{classoomph_1_1TimeStepper}{TimeStepper}}* \textcolor{keyword}{const}\& time\_stepper\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& preserve\_existing\_data)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02537}02537   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02538}02538     \textcolor{comment}{// Loop over the elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02539}02539     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02540}02540     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02541}02541     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02542}02542       \textcolor{comment}{// Find the number of internal dofs}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02543}02543       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_internal = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>ninternal\_data();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02544}02544 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02545}02545       \textcolor{comment}{// Loop over internal dofs and set the timestepper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02546}02546       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_internal; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02547}02547       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02548}02548         this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>internal\_data\_pt(j)-\/>set\_time\_stepper(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02549}02549           time\_stepper\_pt, preserve\_existing\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02550}02550       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02551}02551     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02552}02552   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02553}02553 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02554}02554   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02555}02555 \textcolor{comment}{  /// A function that upgrades an ordinary node to a boundary node.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02556}02556 \textcolor{comment}{  /// All pointers to the node from the mesh's elements are found.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02557}02557 \textcolor{comment}{  /// and replaced by pointers to the new boundary node. If the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02558}02558 \textcolor{comment}{  /// is present in the mesh's list of nodes, that pointer is also}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02559}02559 \textcolor{comment}{  /// replaced. Finally, the pointer argument node\_pt addresses the new}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02560}02560 \textcolor{comment}{  /// node on return from the function.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02561}02561 \textcolor{comment}{  /// We shouldn't ever really use this, but it does make life that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02562}02562 \textcolor{comment}{  /// bit easier for the lazy mesh writer.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02563}02563 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02564}\mbox{\hyperlink{classoomph_1_1Mesh_a2bdff104c0cc1f2669f9f5cad4a2a1a9}{02564}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_aa864cbb7f3ff399eef871c63067894df}{Mesh::convert\_to\_boundary\_node}}(Node*\& node\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02565}02565   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02566}02566     \textcolor{comment}{// Cache a list of FiniteElement pointers for use in this function.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02567}02567     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<FiniteElement*>}} fe\_pt(\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}(), 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02568}02568     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0, ne = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}(); \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < ne; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02569}02569     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02570}02570       \textcolor{comment}{// Some elements may not have been build yet, just store a null pointer}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02571}02571       \textcolor{comment}{// for these cases.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02572}02572       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] == 0) fe\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02573}02573       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02574}02574         fe\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02575}02575     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02576}02576 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02577}02577     \textcolor{comment}{// Now call the real function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02578}02578     \mbox{\hyperlink{classoomph_1_1Mesh_aa864cbb7f3ff399eef871c63067894df}{convert\_to\_boundary\_node}}(\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}, fe\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02579}02579   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02580}02580 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02581}02581   \textcolor{comment}{// ============================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02582}02582 \textcolor{comment}{  /// As convert\_to\_boundary\_node but with a vector of pre-\/"{}dynamic cast"{}ed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02583}02583 \textcolor{comment}{  /// pointers passed in. If this function is being called often then}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02584}02584 \textcolor{comment}{  /// creating this vector and passing it in explicitly each time can give a}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02585}02585 \textcolor{comment}{  /// large speed up.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02586}02586 \textcolor{comment}{}  \textcolor{comment}{// Note: the real reason that this function is so slow in the first place}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02587}02587   \textcolor{comment}{// is because it has to loop over all elements. So if you use this function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02588}02588   \textcolor{comment}{// O(N) times your boundary node creation complexity is O(N\string^2).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02589}02589   \textcolor{comment}{// ============================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02590}\mbox{\hyperlink{classoomph_1_1Mesh_aa864cbb7f3ff399eef871c63067894df}{02590}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_aa864cbb7f3ff399eef871c63067894df}{Mesh::convert\_to\_boundary\_node}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02591}02591     Node*\& node\_pt, \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<FiniteElement*>}}\& finite\_element\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02592}02592   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02593}02593     \textcolor{comment}{// If the node is already a boundary node, then return straight away,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02594}02594     \textcolor{comment}{// we don't need to do anything}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02595}02595     \textcolor{keywordflow}{if} (\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}) != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02596}02596     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02597}02597       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02598}02598     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02599}02599 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02600}02600     \textcolor{comment}{// Loop over all the elements in the mesh and find all those in which}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02601}02601     \textcolor{comment}{// the present node is referenced and the corresponding local node number}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02602}02602     \textcolor{comment}{// in those elements.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02603}02603 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02604}02604     \textcolor{comment}{// Storage for elements and local node number}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02605}02605     std::list<std::pair<unsigned long, int>>}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02606}02606       list\_of\_elements\_and\_local\_node\_numbers;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02607}02607 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02608}02608     \textcolor{comment}{// Loop over all elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02609}02609     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_element = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02610}02610     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02611}02611     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02612}02612       \textcolor{comment}{// Buffer the case when we have not yet filled up the element array}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02613}02613       \textcolor{comment}{// Unfortunately, we should not assume that the array has been filled}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02614}02614       \textcolor{comment}{// in a linear order, so we can't break out early.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02615}02615       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_aca12acfe655a4d5c4a4eab4a7b970812}{Element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02616}02616       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02617}02617         \textcolor{comment}{// Find the local node number of the passed node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02618}02618         \textcolor{keywordtype}{int} node\_number = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_aeb40d7a104d99e6f7d8123e801e53b5b}{get\_node\_number}}(\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02619}02619         \textcolor{comment}{// If the node is present in the element, add it to our list and}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02620}02620         \textcolor{comment}{// NULL out the local element entries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02621}02621         \textcolor{keywordflow}{if} (node\_number != -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02622}02622         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02623}02623           list\_of\_elements\_and\_local\_node\_numbers.insert(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02624}02624             list\_of\_elements\_and\_local\_node\_numbers.end(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02625}02625             std::make\_pair(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}, node\_number));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02626}02626           \textcolor{comment}{// Null it out}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02627}02627           \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(node\_number) = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02628}02628         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02629}02629       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02630}02630     \} \textcolor{comment}{// End of loop over elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02631}02631 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02632}02632     \textcolor{comment}{// If there are no entries in the list we are in real trouble}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02633}02633     \textcolor{keywordflow}{if} (list\_of\_elements\_and\_local\_node\_numbers.empty())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02634}02634     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02635}02635       std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02636}02636       error\_stream << \textcolor{stringliteral}{"{}Node "{}} << \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02637}02637                    << \textcolor{stringliteral}{"{} is not contained in any elements in the Mesh."{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02638}02638                    << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02639}02639                    << \textcolor{stringliteral}{"{}How was it created then?"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02640}02640 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02641}02641       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02642}02642         error\_stream.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02643}02643     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02644}02644 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02645}02645 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02646}02646     \textcolor{comment}{// Create temporary storage for a pointer to the old node.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02647}02647     \textcolor{comment}{// This is required because if we have passed a reference to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02648}02648     \textcolor{comment}{// first element that we find, constructing the new node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02649}02649     \textcolor{comment}{// will over-\/write our pointer and we'll get segmentation faults.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02650}02650     Node* old\_node\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02651}02651 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02652}02652     \textcolor{comment}{// We now create the new node by using the first element in the list}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02653}02653     std::list<std::pair<unsigned long, int>>::iterator list\_it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02654}02654       list\_of\_elements\_and\_local\_node\_numbers.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02655}02655 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02656}02656     \textcolor{comment}{// Create a new boundary node, using the timestepper from the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02657}02657     \textcolor{comment}{// original node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02658}02658     Node* new\_node\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02659}02659       \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}[list\_it-\/>first]-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a88a427f24deee1be92d6e63eac0fb36f}{construct\_boundary\_node}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02660}02660         list\_it-\/>second, \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}-\/>time\_stepper\_pt());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02661}02661 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02662}02662     \textcolor{comment}{// Now copy all the information accross from the old node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02663}02663 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02664}02664     \textcolor{comment}{// Can we cast the node to a solid node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02665}02665     \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_node\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(new\_node\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02666}02666     \textcolor{comment}{// If it's a solid node, do the casting}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02667}02667     \textcolor{keywordflow}{if} (solid\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02668}02668     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02669}02669       solid\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_ae4dfa5355b84b58745b0c6a3fef60112}{copy}}(\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(old\_node\_pt));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02670}02670     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02671}02671     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02672}02672     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02673}02673       new\_node\_pt-\/>copy(old\_node\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02674}02674     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02675}02675 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02676}02676     \textcolor{comment}{// Loop over all other elements in the list and set their pointers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02677}02677     \textcolor{comment}{// to the new node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02678}02678     \textcolor{keywordflow}{for} (++list\_it; \textcolor{comment}{// Increment the iterator}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02679}02679          list\_it != list\_of\_elements\_and\_local\_node\_numbers.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02680}02680          ++list\_it)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02681}02681     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02682}02682       \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}[list\_it-\/>first]-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(list\_it-\/>second) = new\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02683}02683     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02684}02684 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02685}02685     \textcolor{comment}{// Finally, find the position of the node in the global mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02686}02686     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>::iterator}} it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02687}02687       std::find(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.begin(), \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.end(), old\_node\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02688}02688 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02689}02689     \textcolor{comment}{// If it is in the mesh, update the pointer}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02690}02690     \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}.end())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02691}02691     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02692}02692       *it = new\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02693}02693     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02694}02694 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02695}02695     \textcolor{comment}{// Can now delete the old node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02696}02696     \textcolor{keyword}{delete} old\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02697}02697 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02698}02698     \textcolor{comment}{// Replace the passed pointer by a pointer to the new node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02699}02699     \textcolor{comment}{// Note that in most cases, this will be wasted work because the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02700}02700     \textcolor{comment}{// pointer will either the pointer in the mesh's or an element's}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02701}02701     \textcolor{comment}{// node\_pt vector. Still assignment is quicker than an if to check this.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02702}02702     \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}} = new\_node\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02703}02703   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02704}02704 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02705}02705 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02706}02706 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02707}02707   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02708}02708 \textcolor{comment}{  /// Setup shared node scheme: Shared node lookup scheme contains}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02709}02709 \textcolor{comment}{  /// a unique correspondence between all nodes on the halo/haloed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02710}02710 \textcolor{comment}{  /// elements between two processors.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02711}02711 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02712}\mbox{\hyperlink{classoomph_1_1Mesh_a1ef2de4e0406dd4ed6317cf857b2c3b1}{02712}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a1ef2de4e0406dd4ed6317cf857b2c3b1}{Mesh::setup\_shared\_node\_scheme}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02713}02713   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02714}02714     \textcolor{comment}{// Determine the shared nodes lookup scheme -\/ all nodes located on the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02715}02715     \textcolor{comment}{// halo(ed) elements between two domains.  This scheme is necessary in order}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02716}02716     \textcolor{comment}{// to identify master nodes that may not be present in the halo-\/haloed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02717}02717     \textcolor{comment}{// element lookup scheme between two processors (for example, if the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02718}02718     \textcolor{comment}{// is on an element which is in a lookup scheme between two higher-\/numbered}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02719}02719     \textcolor{comment}{// processors)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02720}02720 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02721}02721     \textcolor{keywordtype}{double} t\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02722}02722     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02723}02723     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02724}02724       t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02725}02725     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02726}02726 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02727}02727     \textcolor{comment}{// Store number of processors and current process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02728}02728     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02729}02729     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02730}02730 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02731}02731     \textcolor{comment}{// Need to clear the shared node scheme first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02732}02732     \mbox{\hyperlink{classoomph_1_1Mesh_a0fba80dc38b8577982b94309e4e1d3d7}{Shared\_node\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02733}02733 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02734}02734     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02735}02735     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02736}02736       \textcolor{comment}{// map of bools for whether the node has been shared,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02737}02737       \textcolor{comment}{// initialised to 0 (false) for each domain d}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02738}02738       std::map<Node*, bool> node\_shared;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02739}02739 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02740}02740       \textcolor{comment}{// For all domains lower than the current domain: Do halos first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02741}02741       \textcolor{comment}{// then haloed, to ensure correct order in lookup scheme from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02742}02742       \textcolor{comment}{// the other side}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02743}02743       \textcolor{keywordflow}{if} (d < my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02744}02744       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02745}02745         \textcolor{comment}{// Get the nodes from the halo elements first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02746}02746         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02747}02747         \textcolor{keywordtype}{unsigned} nhalo\_elem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02748}02748 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02749}02749         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nhalo\_elem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02750}02750         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02751}02751           \textcolor{comment}{// Get finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02752}02752           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02753}02753           \textcolor{keywordflow}{if} (el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02754}02754           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02755}02755             \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02756}02756             \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02757}02757             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02758}02758             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02759}02759               Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02760}02760 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02761}02761               \textcolor{comment}{// Add it as a shared node from current domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02762}02762               \textcolor{keywordflow}{if} (!node\_shared[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02763}02763               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02764}02764                 this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(d, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02765}02765                 node\_shared[nod\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02766}02766               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02767}02767 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02768}02768             \} \textcolor{comment}{// end loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02769}02769           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02770}02770 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02771}02771         \} \textcolor{comment}{// end loop over elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02772}02772 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02773}02773         \textcolor{comment}{// Now get any left over nodes on the haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02774}02774         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02775}02775         \textcolor{keywordtype}{unsigned} nhaloed\_elem = haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02776}02776 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02777}02777         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nhaloed\_elem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02778}02778         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02779}02779           \textcolor{comment}{// Get element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02780}02780           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02781}02781             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02782}02782           \textcolor{keywordflow}{if} (el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02783}02783           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02784}02784             \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02785}02785             \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02786}02786             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02787}02787             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02788}02788               Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02789}02789 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02790}02790               \textcolor{comment}{// Add it as a shared node from current domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02791}02791               \textcolor{keywordflow}{if} (!node\_shared[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02792}02792               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02793}02793                 this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(d, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02794}02794                 node\_shared[nod\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02795}02795               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02796}02796 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02797}02797             \} \textcolor{comment}{// end loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02798}02798           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02799}02799         \} \textcolor{comment}{// end loop over elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02800}02800       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02801}02801 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02802}02802       \textcolor{comment}{// If the domain is bigger than the current rank: Do haloed first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02803}02803       \textcolor{comment}{// then halo, to ensure correct order in lookup scheme from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02804}02804       \textcolor{comment}{// the other side}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02805}02805       \textcolor{keywordflow}{if} (d > my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02806}02806       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02807}02807         \textcolor{comment}{// Get the nodes from the haloed elements first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02808}02808         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02809}02809         \textcolor{keywordtype}{unsigned} nhaloed\_elem = haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02810}02810 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02811}02811         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nhaloed\_elem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02812}02812         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02813}02813           \textcolor{comment}{// Get element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02814}02814           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02815}02815             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02816}02816           \textcolor{keywordflow}{if} (el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02817}02817           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02818}02818             \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02819}02819             \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02820}02820             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02821}02821             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02822}02822               Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02823}02823 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02824}02824               \textcolor{comment}{// Add it as a shared node from current domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02825}02825               \textcolor{keywordflow}{if} (!node\_shared[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02826}02826               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02827}02827                 this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(d, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02828}02828                 node\_shared[nod\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02829}02829               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02830}02830 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02831}02831             \} \textcolor{comment}{// end loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02832}02832           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02833}02833         \} \textcolor{comment}{// end loop over elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02834}02834 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02835}02835         \textcolor{comment}{// Now get the nodes from any halo elements left over}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02836}02836         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02837}02837         \textcolor{keywordtype}{unsigned} nhalo\_elem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02838}02838 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02839}02839         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nhalo\_elem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02840}02840         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02841}02841           \textcolor{comment}{// Get element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02842}02842           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02843}02843           \textcolor{keywordflow}{if} (el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02844}02844           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02845}02845             \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02846}02846             \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02847}02847             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02848}02848             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02849}02849               Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02850}02850 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02851}02851               \textcolor{comment}{// Add it as a shared node from current domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02852}02852               \textcolor{keywordflow}{if} (!node\_shared[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02853}02853               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02854}02854                 this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(d, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02855}02855                 node\_shared[nod\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02856}02856               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02857}02857 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02858}02858             \} \textcolor{comment}{// end loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02859}02859           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02860}02860         \} \textcolor{comment}{// end loop over elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02861}02861 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02862}02862       \} \textcolor{comment}{// end if (d ...)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02863}02863 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02864}02864     \} \textcolor{comment}{// end loop over processes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02865}02865 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02866}02866 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02867}02867     \textcolor{keywordtype}{double} t\_end = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02868}02868     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02869}02869     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02870}02870       t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02871}02871       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for identification of shared nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02872}02872                  << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02873}02873       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02874}02874     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02875}02875   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02876}02876 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02877}02877   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02878}02878 \textcolor{comment}{  /// Synchronise shared node lookup schemes to cater for the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02879}02879 \textcolor{comment}{  /// the case where:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02880}02880 \textcolor{comment}{  /// (1) a certain node on the current processor is halo with proc p}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02881}02881 \textcolor{comment}{  ///     (i.e. its non-\/halo counterpart lives on processor p)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02882}02882 \textcolor{comment}{  /// (2) that node also exists (also as a halo) on another processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02883}02883 \textcolor{comment}{  ///     (q, say) where its non-\/halo counter part is also known to be}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02884}02884 \textcolor{comment}{  ///     on processor p.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02885}02885 \textcolor{comment}{  /// However, without calling this function the current processor does not}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02886}02886 \textcolor{comment}{  /// necessarily know that it shares a node with processor q. This}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02887}02887 \textcolor{comment}{  /// information can be required, e.g. when synchronising hanging node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02888}02888 \textcolor{comment}{  /// schemes over all processors.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02889}02889 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02890}\mbox{\hyperlink{classoomph_1_1Mesh_a5c535dac8f8de9240ecb58058a9cd5ec}{02890}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a5c535dac8f8de9240ecb58058a9cd5ec}{Mesh::synchronise\_shared\_nodes}}(\textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& report\_stats)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02891}02891   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02892}02892     \textcolor{keywordtype}{double} t\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02893}02893     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02894}02894     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02895}02895       t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02896}02896     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02897}02897 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02898}02898     \textcolor{keywordtype}{double} tt\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02899}02899     \textcolor{keywordtype}{double} tt\_end = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02900}02900     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02901}02901     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02902}02902       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02903}02903     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02904}02904 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02905}02905     \textcolor{comment}{// Storage for current processor and number of processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02906}02906     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02907}02907     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02908}02908 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02909}02909 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02910}02910 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02911}02911     \textcolor{comment}{// Has some twit filled in shared nodes with own process?!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02912}02912     \textcolor{comment}{// Check at start of function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02913}02913     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a0fba80dc38b8577982b94309e4e1d3d7}{Shared\_node\_pt}}[my\_rank].size() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02914}02914     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02915}02915       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02916}02916         \textcolor{stringliteral}{"{}Processor has shared nodes with itself! Something's gone wrong!"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02917}02917         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02918}02918         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02919}02919     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02920}02920 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02921}02921 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02922}02922 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02923}02923     \textcolor{comment}{// Stage 1: Populate the set of of processor IDs that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02924}02924     \textcolor{comment}{// each haloed node on current processor is haloed by.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02925}02925     std::map<Node*, std::set<int>> shared\_domain\_set;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02926}02926 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02927}02927     \textcolor{comment}{// Associate unique number with any haloed nodes on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02928}02928     std::map<Node*, unsigned> global\_haloed\_node\_number\_plus\_one;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02929}02929     \textcolor{keywordtype}{unsigned} global\_haloed\_count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02930}02930 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02931}02931     \textcolor{comment}{// Loop over domains}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02932}02932     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02933}02933     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02934}02934       \textcolor{comment}{// Don't talk to yourself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02935}02935       \textcolor{keywordflow}{if} (d != my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02936}02936       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02937}02937         \textcolor{comment}{// Loop over haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02938}02938         \textcolor{keywordtype}{unsigned} nnod\_haloed = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02939}02939         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod\_haloed; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02940}02940         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02941}02941           Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ab29fbaa5e88f722de752b3fd642a75e4}{haloed\_node\_pt}}(d, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02942}02942           shared\_domain\_set[nod\_pt].insert(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02943}02943           \textcolor{keywordflow}{if} (global\_haloed\_node\_number\_plus\_one[nod\_pt] == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02944}02944           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02945}02945             global\_haloed\_node\_number\_plus\_one[nod\_pt] =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02946}02946               global\_haloed\_count + 1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02947}02947             global\_haloed\_count++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02948}02948           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02949}02949         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02950}02950       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02951}02951     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02952}02952 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02953}02953     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02954}02954     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02955}02955       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02956}02956       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for initial classification in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02957}02957                     \textcolor{stringliteral}{"{}Mesh::synchronise\_shared\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02958}02958                  << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02959}02959       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02960}02960     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02961}02961 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02962}02962 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02963}02963     \textcolor{comment}{// Stage 2: All-\/to-\/all communication to inform all processors that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02964}02964     \textcolor{comment}{// hold halo nodes with current processor about all domains that the current}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02965}02965     \textcolor{comment}{// processor shares nodes with [This will allow the other processors to add}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02966}02966     \textcolor{comment}{// these nodes to their shared node lookup schemes with processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02967}02967     \textcolor{comment}{// that they currently "{}can't see"{}].}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02968}02968 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02969}02969     \textcolor{comment}{// Data to be sent to each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02970}02970     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} send\_n(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02971}02971 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02972}02972     \textcolor{comment}{// Storage for all values to be sent to all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02973}02973     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} send\_data;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02974}02974 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02975}02975     \textcolor{comment}{// Start location within send\_data for data to be sent to each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02976}02976     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} send\_displacement(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02977}02977 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02978}02978 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02979}02979     \textcolor{comment}{// Loop over haloed nodes with other domains}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02980}02980     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02981}02981     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02982}02982       \textcolor{comment}{// Set the offset for the current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02983}02983       send\_displacement[domain] = send\_data.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02984}02984 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02985}02985       \textcolor{comment}{// Every processor works on haloed nodes with proc "{}domain"{} and}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02986}02986       \textcolor{comment}{// sends associations across to that domain. No need to talk to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02987}02987       \textcolor{comment}{// yourself...}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02988}02988       \textcolor{keywordflow}{if} (domain != my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02989}02989       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02990}02990         \textcolor{comment}{// Send total number of global haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02991}02991         \textcolor{comment}{// send\_data.push\_back(global\_haloed\_count);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02992}02992 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02993}02993         \textcolor{comment}{// Loop over haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02994}02994         \textcolor{keywordtype}{unsigned} nnod\_haloed = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02995}02995         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod\_haloed; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02996}02996         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02997}02997           Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ab29fbaa5e88f722de752b3fd642a75e4}{haloed\_node\_pt}}(domain, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02998}02998 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l02999}02999           \textcolor{comment}{// Send global ID of haloed node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03000}03000           send\_data.push\_back(global\_haloed\_node\_number\_plus\_one[nod\_pt] -\/ 1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03001}03001 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03002}03002           \textcolor{comment}{// Get the set of domains that halo this node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03003}03003           std::set<int> tmp\_shared\_domain\_set = shared\_domain\_set[nod\_pt];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03004}03004 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03005}03005           \textcolor{comment}{// Insert number of shared domains into send data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03006}03006           \textcolor{keywordtype}{unsigned} n\_shared\_domains = tmp\_shared\_domain\_set.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03007}03007           send\_data.push\_back(n\_shared\_domains);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03008}03008 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03009}03009           \textcolor{comment}{// Add shared domains}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03010}03010           \textcolor{keywordflow}{for} (std::set<int>::iterator it = tmp\_shared\_domain\_set.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03011}03011                it != tmp\_shared\_domain\_set.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03012}03012                it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03013}03013           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03014}03014             send\_data.push\_back(*it);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03015}03015           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03016}03016         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03017}03017       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03018}03018 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03019}03019       \textcolor{comment}{// Find the number of data added to the vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03020}03020       send\_n[domain] = send\_data.size() -\/ send\_displacement[domain];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03021}03021     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03022}03022 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03023}03023 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03024}03024     \textcolor{comment}{// Storage for the number of data to be received from each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03025}03025     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} receive\_n(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03026}03026 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03027}03027     \textcolor{comment}{// Now send numbers of data to be sent between all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03028}03028     MPI\_Alltoall(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03029}03029       \&send\_n[0], 1, MPI\_INT, \&receive\_n[0], 1, MPI\_INT, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03030}03030 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03031}03031 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03032}03032     \textcolor{comment}{// We now prepare the data to be received}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03033}03033     \textcolor{comment}{// by working out the displacements from the received data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03034}03034     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} receive\_displacement(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03035}03035     \textcolor{keywordtype}{int} receive\_data\_count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03036}03036     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} rank = 0; rank < n\_proc; ++rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03037}03037     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03038}03038       \textcolor{comment}{// Displacement is number of data received so far}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03039}03039       receive\_displacement[rank] = receive\_data\_count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03040}03040       receive\_data\_count += receive\_n[rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03041}03041     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03042}03042 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03043}03043     \textcolor{comment}{// Now resize the receive buffer for all data from all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03044}03044     \textcolor{comment}{// Make sure that it has a size of at least one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03045}03045     \textcolor{keywordflow}{if} (receive\_data\_count == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03046}03046     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03047}03047       ++receive\_data\_count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03048}03048     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03049}03049     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} receive\_data(receive\_data\_count);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03050}03050 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03051}03051     \textcolor{comment}{// Make sure that the send buffer has size at least one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03052}03052     \textcolor{comment}{// so that we don't get a segmentation fault}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03053}03053     \textcolor{keywordflow}{if} (send\_data.size() == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03054}03054     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03055}03055       send\_data.resize(1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03056}03056     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03057}03057 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03058}03058     \textcolor{comment}{// Now send the data between all the processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03059}03059     MPI\_Alltoallv(\&send\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03060}03060                   \&send\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03061}03061                   \&send\_displacement[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03062}03062                   MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03063}03063                   \&receive\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03064}03064                   \&receive\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03065}03065                   \&receive\_displacement[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03066}03066                   MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03067}03067                   \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03068}03068 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03069}03069 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03070}03070     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03071}03071     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03072}03072       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03073}03073       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for alltoall in Mesh::synchronise\_shared\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03074}03074                  << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03075}03075       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03076}03076     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03077}03077 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03078}03078 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03079}03079     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03080}03080     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03081}03081       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Starting vector to set conversion in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03082}03082                  << \textcolor{stringliteral}{"{}Mesh::synchronise\_shared\_nodes() for a total of "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03083}03083                  << \mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}() << \textcolor{stringliteral}{"{} nodes\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03084}03084       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03085}03085     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03086}03086 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03087}03087 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03088}03088     \textcolor{comment}{// Copy vector-\/based representation of shared nodes into}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03089}03089     \textcolor{comment}{// sets for faster search}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03090}03090     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<std::set<Node*>}}> shared\_node\_set(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03091}03091     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03092}03092     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03093}03093       \textcolor{keywordtype}{unsigned} n\_vector = \mbox{\hyperlink{classoomph_1_1Mesh_a0fba80dc38b8577982b94309e4e1d3d7}{Shared\_node\_pt}}[d].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03094}03094       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_vector; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03095}03095       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03096}03096         shared\_node\_set[d].insert(\mbox{\hyperlink{classoomph_1_1Mesh_a0fba80dc38b8577982b94309e4e1d3d7}{Shared\_node\_pt}}[d][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03097}03097       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03098}03098     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03099}03099 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03100}03100 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03101}03101     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03102}03102     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03103}03103       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03104}03104       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03105}03105         << \textcolor{stringliteral}{"{}Time for vector to set in Mesh::synchronise\_shared\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03106}03106         << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03107}03107       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03108}03108     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03109}03109 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03110}03110 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03111}03111     \textcolor{comment}{// Now use the received data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03112}03112     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} send\_rank = 0; send\_rank < n\_proc; send\_rank++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03113}03113     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03114}03114       \textcolor{comment}{// Don't bother to do anything for the processor corresponding to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03115}03115       \textcolor{comment}{// current processor or if no data were received from this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03116}03116       \textcolor{keywordflow}{if} ((send\_rank != my\_rank) \&\& (receive\_n[send\_rank] != 0))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03117}03117       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03118}03118         \textcolor{comment}{// Counter for the data within the large array}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03119}03119         \textcolor{keywordtype}{unsigned} count = receive\_displacement[send\_rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03120}03120 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03121}03121         \textcolor{comment}{// Read total number of global haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03122}03122         \textcolor{comment}{// unsigned n\_global\_haloed\_nodes\_on\_send\_proc=receive\_data[count++];}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03123}03123 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03124}03124         \textcolor{comment}{// Storage for nodes and associated domains:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03125}03125         \textcolor{comment}{// domains\_map[global\_haloed\_node\_number].first = node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03126}03126         \textcolor{comment}{// domains\_map[global\_haloed\_node\_number].second = set of domains}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03127}03127         \textcolor{comment}{//                                                 this node is}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03128}03128         \textcolor{comment}{//                                                 associated with.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03129}03129         std::map<unsigned, std::pair<Node*, std::set<unsigned>>> domains\_map;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03130}03130 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03131}03131         \textcolor{comment}{// Loop over halo nodes with sending processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03132}03132         \textcolor{keywordtype}{unsigned} nnod\_halo = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(send\_rank);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03133}03133         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod\_halo; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03134}03134         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03135}03135           Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad7ba73da180acb43523166ee71fb2e99}{halo\_node\_pt}}(send\_rank, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03136}03136 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03137}03137           \textcolor{comment}{// Read unique ID of haloed node on send proc}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03138}03138           \textcolor{keywordtype}{unsigned} haloed\_node\_id\_on\_send\_proc = receive\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03139}03139 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03140}03140           \textcolor{comment}{// Read out number of shared domains into send data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03141}03141           \textcolor{keywordtype}{unsigned} n\_shared\_domains = receive\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03142}03142 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03143}03143           \textcolor{comment}{// Prepare set of domains}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03144}03144           std::set<unsigned> domain\_set;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03145}03145 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03146}03146           \textcolor{comment}{// Read 'em}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03147}03147           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_shared\_domains; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03148}03148           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03149}03149             \textcolor{keywordtype}{int} shared\_domain = receive\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03150}03150 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03151}03151             \textcolor{comment}{// Record in set}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03152}03152             domain\_set.insert(shared\_domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03153}03153           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03154}03154 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03155}03155           \textcolor{comment}{// Add entry:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03156}03156           domains\_map[haloed\_node\_id\_on\_send\_proc] =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03157}03157             std::make\_pair(nod\_pt, domain\_set);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03158}03158 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03159}03159         \} \textcolor{comment}{// end of loop over halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03160}03160 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03161}03161 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03162}03162         \textcolor{comment}{// Now add new shared nodes in order}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03163}03163 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03164}03164         \textcolor{keywordtype}{int} previous\_one = -\/1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03165}03165 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03166}03166         \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, std::pair<Node*, std::set<unsigned>>>::iterator}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03167}03167                it = domains\_map.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03168}03168              it != domains\_map.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03169}03169              it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03170}03170         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03171}03171           \textcolor{comment}{// Super-\/paranoid: Check that the map actually sorted entries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03172}03172           \textcolor{comment}{// by key (as it should)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03173}03173 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03174}03174           \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}((*it).first) < previous\_one)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03175}03175           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03176}03176             std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03177}03177             error\_stream << \textcolor{stringliteral}{"{}Map did not store entries in order of key\(\backslash\)n "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03178}03178                          << \textcolor{stringliteral}{"{}Current key:  "{}} << (*it).first}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03179}03179                          << \textcolor{stringliteral}{"{}; previous one: "{}} << previous\_one << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03180}03180                          << \textcolor{stringliteral}{"{}Need to rewrite this...\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03181}03181             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03182}03182                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03183}03183                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03184}03184           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03185}03185           previous\_one = (*it).first;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03186}03186 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03187}03187 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03188}03188           \textcolor{comment}{// Extract node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03189}03189           Node* nod\_pt = (*it).second.first;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03190}03190 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03191}03191           \textcolor{comment}{// Extract set of domains}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03192}03192           std::set<unsigned> domain\_set((*it).second.second);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03193}03193 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03194}03194           \textcolor{comment}{// Read 'em}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03195}03195           \textcolor{keywordflow}{for} (std::set<unsigned>::iterator itt = domain\_set.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03196}03196                itt != domain\_set.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03197}03197                itt++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03198}03198           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03199}03199             \textcolor{keywordtype}{int} shared\_domain = (*itt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03200}03200 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03201}03201             \textcolor{comment}{// No need to add shared nodes with oneself!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03202}03202             \textcolor{keywordflow}{if} (shared\_domain != my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03203}03203             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03204}03204               \textcolor{comment}{// Is node already listed in shared node scheme? Find it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03205}03205               \textcolor{comment}{// and get iterator to entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03206}03206               std::set<Node*>::iterator ittt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03207}03207                 shared\_node\_set[shared\_domain].find(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03208}03208 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03209}03209               \textcolor{comment}{// If it's not in there already iterator points to end of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03210}03210               \textcolor{comment}{// set}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03211}03211               \textcolor{keywordflow}{if} (ittt == shared\_node\_set[shared\_domain].end())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03212}03212               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03213}03213                 \textcolor{comment}{// Now add it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03214}03214                 \mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(shared\_domain, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03215}03215 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03216}03216                 \textcolor{comment}{// Update set}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03217}03217                 shared\_node\_set[shared\_domain].insert(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03218}03218               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03219}03219             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03220}03220           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03221}03221         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03222}03222 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03223}03223       \} \textcolor{comment}{// end of any data is received and ignore own domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03224}03224 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03225}03225     \} \textcolor{comment}{// end of loop over send ranks}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03226}03226 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03227}03227 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03228}03228 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03229}03229     \textcolor{comment}{// Has some twit filled in shared nodes with own process?!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03230}03230     \textcolor{comment}{// Check at end pf function.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03231}03231     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a0fba80dc38b8577982b94309e4e1d3d7}{Shared\_node\_pt}}[my\_rank].size() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03232}03232     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03233}03233       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03234}03234         \textcolor{stringliteral}{"{}Processor has shared nodes with itself! Something's gone wrong!"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03235}03235         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03236}03236         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03237}03237     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03238}03238 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03239}03239 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03240}03240 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03241}03241     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03242}03242     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03243}03243       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03244}03244       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03245}03245         << \textcolor{stringliteral}{"{}Time for final processing in Mesh::synchronise\_shared\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03246}03246         << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03247}03247       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03248}03248     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03249}03249 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03250}03250     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03251}03251     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03252}03252       \textcolor{keywordtype}{double} t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03253}03253       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Total time for Mesh::synchronise\_shared\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03254}03254                  << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03255}03255     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03256}03256   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03257}03257 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03258}03258 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03259}03259   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03260}03260 \textcolor{comment}{  /// Classify all halo and haloed information in the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03261}03261 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03262}\mbox{\hyperlink{classoomph_1_1Mesh_a595cfa652d75d9fbfc72a8252fe6782e}{03262}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a595cfa652d75d9fbfc72a8252fe6782e}{Mesh::classify\_halo\_and\_haloed\_nodes}}(\mbox{\hyperlink{classoomph_1_1DocInfo}{DocInfo}}\& doc\_info,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03263}03263                                             \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& report\_stats)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03264}03264   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03265}03265     \textcolor{comment}{//  MemoryUsage::doc\_memory\_usage(}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03266}03266     \textcolor{comment}{//   "{}at beginning of Mesh::classify\_halo\_and\_haloed\_nodes"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03267}03267 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03268}03268     \textcolor{keywordtype}{double} t\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03269}03269     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03270}03270     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03271}03271       t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03272}03272     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03273}03273 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03274}03274     \textcolor{keywordtype}{double} tt\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03275}03275     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03276}03276     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03277}03277       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03278}03278     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03279}03279 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03280}03280     \textcolor{comment}{// Set up shared nodes scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03281}03281     \mbox{\hyperlink{classoomph_1_1Mesh_a1ef2de4e0406dd4ed6317cf857b2c3b1}{setup\_shared\_node\_scheme}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03282}03282 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03283}03283     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after setup shared node scheme"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03284}03284 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03285}03285     \textcolor{keywordtype}{double} tt\_end = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03286}03286     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03287}03287     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03288}03288       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03289}03289       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for Mesh::setup\_shared\_node\_scheme() "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03290}03290                  << \textcolor{stringliteral}{"{} Mesh::classify\_halo\_and\_haloed\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03291}03291                  << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03292}03292       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03293}03293       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03294}03294     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03295}03295 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03296}03296 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03297}03297     \textcolor{comment}{// Wipe existing storage schemes for halo(ed) nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03298}03298     \mbox{\hyperlink{classoomph_1_1Mesh_aa36c21b9e32a318c4b043aea2411cdac}{Halo\_node\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03299}03299     \mbox{\hyperlink{classoomph_1_1Mesh_ab05a3c50d404474a00996a0c9a0e1da8}{Haloed\_node\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03300}03300 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03301}03301     \textcolor{comment}{// Storage for number of processors and current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03302}03302     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03303}03303     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03304}03304     MPI\_Status status;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03305}03305 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03306}03306     \textcolor{comment}{// Determine which processors the nodes are associated with}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03307}03307     \textcolor{comment}{// and hence who's in charge}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03308}03308     std::map<Data*, std::set<unsigned>> processors\_associated\_with\_data;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03309}03309     std::map<Data*, unsigned> processor\_in\_charge;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03310}03310 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03311}03311     \textcolor{comment}{// Loop over all processors and associate any nodes on the halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03312}03312     \textcolor{comment}{// elements involved with that processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03313}03313     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03314}03314     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03315}03315       \textcolor{comment}{// Get vector of halo elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03316}03316       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(domain));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03317}03317 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03318}03318       \textcolor{comment}{// Loop over halo elements associated with this adjacent domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03319}03319       \textcolor{keywordtype}{unsigned} nelem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03320}03320       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03321}03321       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03322}03322         \textcolor{comment}{// Get element only have nodes if a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03323}03323         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03324}03324           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03325}03325         \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03326}03326         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03327}03327           \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03328}03328           \textcolor{keywordtype}{unsigned} nnod = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03329}03329           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03330}03330           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03331}03331             Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03332}03332             \textcolor{comment}{// Associate node with this domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03333}03333             processors\_associated\_with\_data[nod\_pt].insert(domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03334}03334 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03335}03335             \textcolor{comment}{// Do the same if the node is solid}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03336}03336             \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03337}03337             \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03338}03338             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03339}03339               processors\_associated\_with\_data[solid\_nod\_pt}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03340}03340                                                 -\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03341}03341                 .insert(domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03342}03342             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03343}03343           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03344}03344         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03345}03345       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03346}03346     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03347}03347 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03348}03348 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03349}03349     \textcolor{comment}{// Loop over all [non-\/halo] elements and associate their nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03350}03350     \textcolor{comment}{// with current procesor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03351}03351     \textcolor{keywordtype}{unsigned} nelem = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03352}03352     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03353}03353     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03354}03354       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03355}03355         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03356}03356 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03357}03357       \textcolor{comment}{// Only visit non-\/halos and finite elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03358}03358       \textcolor{keywordflow}{if} ((finite\_el\_pt != 0) \&\& (!finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03359}03359       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03360}03360         \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03361}03361         \textcolor{keywordtype}{unsigned} nnod = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03362}03362         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03363}03363         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03364}03364           Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03365}03365 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03366}03366           \textcolor{comment}{// Associate this node with current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03367}03367           processors\_associated\_with\_data[nod\_pt].insert(my\_rank);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03368}03368 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03369}03369           \textcolor{comment}{// do the same if we have a SolidNode}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03370}03370           \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03371}03371           \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03372}03372           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03373}03373             processors\_associated\_with\_data[solid\_nod\_pt}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03374}03374                                               -\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03375}03375               .insert(my\_rank);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03376}03376           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03377}03377         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03378}03378       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03379}03379     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03380}03380 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03381}03381 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03382}03382     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03383}03383     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03384}03384       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03385}03385       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03386}03386         << \textcolor{stringliteral}{"{}Time for setup loops in Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03387}03387         << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03388}03388       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03389}03389       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03390}03390     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03391}03391 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03392}03392     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after setup loops"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03393}03393 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03394}03394     \textcolor{comment}{// At this point we need to "{}synchronise"{} the nodes on halo(ed) elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03395}03395     \textcolor{comment}{// so that the processors\_associated\_with\_data agrees for the same node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03396}03396     \textcolor{comment}{// on all processors. Strategy: All local nodes have just had their}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03397}03397     \textcolor{comment}{// association recorded. Now loop over all haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03398}03398     \textcolor{comment}{// and send the association of their nodes to the corresponding}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03399}03399     \textcolor{comment}{// halo processors where they update/augment the association of the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03400}03400     \textcolor{comment}{// nodes of the corresponding halo elements.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03401}03401 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03402}03402     \textcolor{comment}{// Loop over all domains}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03403}03403     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03404}03404     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03405}03405       \textcolor{comment}{// Prepare vector to send/receive}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03406}03406       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} processors\_associated\_with\_data\_on\_other\_proc;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03407}03407 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03408}03408       \textcolor{keywordflow}{if} (d != my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03409}03409       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03410}03410         \textcolor{comment}{// Communicate the processors associated with data on haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03411}03411 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03412}03412         \textcolor{comment}{// Get haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03413}03413         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03414}03414 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03415}03415         \textcolor{comment}{// Initialise counter for this haloed layer}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03416}03416         \textcolor{keywordtype}{unsigned} count\_data = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03417}03417 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03418}03418         \textcolor{comment}{// Loop over haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03419}03419         \textcolor{keywordtype}{unsigned} n\_haloed\_elem = haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03420}03420         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_haloed\_elem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03421}03421         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03422}03422           \textcolor{comment}{// Only nodes in finite elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03423}03423           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* haloed\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03424}03424             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03425}03425           \textcolor{keywordflow}{if} (haloed\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03426}03426           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03427}03427             \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03428}03428             \textcolor{keywordtype}{unsigned} n\_node = haloed\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03429}03429             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03430}03430             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03431}03431               Node* nod\_pt = haloed\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03432}03432 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03433}03433               \textcolor{comment}{// Number of processors associated with this node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03434}03434               \textcolor{keywordtype}{unsigned} n\_assoc = processors\_associated\_with\_data[nod\_pt].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03435}03435 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03436}03436               \textcolor{comment}{// This number needs to be sent}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03437}03437               processors\_associated\_with\_data\_on\_other\_proc.push\_back(n\_assoc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03438}03438               count\_data++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03439}03439 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03440}03440               \textcolor{comment}{// Now add the process IDs associated to the vector to be sent}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03441}03441               std::set<unsigned> procs\_set =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03442}03442                 processors\_associated\_with\_data[nod\_pt];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03443}03443               \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = procs\_set.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03444}03444                    it != procs\_set.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03445}03445                    it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03446}03446               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03447}03447                 processors\_associated\_with\_data\_on\_other\_proc.push\_back(*it);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03448}03448                 count\_data++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03449}03449               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03450}03450             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03451}03451           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03452}03452         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03453}03453 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03454}03454 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03455}03455         \textcolor{comment}{// Send the information}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03456}03456         MPI\_Send(\&count\_data, 1, MPI\_UNSIGNED, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03457}03457         \textcolor{keywordflow}{if} (count\_data != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03458}03458         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03459}03459           MPI\_Send(\&processors\_associated\_with\_data\_on\_other\_proc[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03460}03460                    count\_data,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03461}03461                    MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03462}03462                    d,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03463}03463                    1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03464}03464                    \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03465}03465         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03466}03466       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03467}03467       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03468}03468       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03469}03469         \textcolor{comment}{// Receive the processors associated with data onto halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03470}03470         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03471}03471         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03472}03472           \textcolor{keywordflow}{if} (dd != my\_rank) \textcolor{comment}{// (my\_rank=d)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03473}03473           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03474}03474             \textcolor{comment}{// We will be looping over the halo elements with process dd}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03475}03475             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(dd));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03476}03476             \textcolor{keywordtype}{unsigned} n\_halo\_elem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03477}03477             \textcolor{keywordtype}{unsigned} count\_data = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03478}03478             MPI\_Recv(\&count\_data,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03479}03479                      1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03480}03480                      MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03481}03481                      dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03482}03482                      0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03483}03483                      \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03484}03484                      \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03485}03485             \textcolor{keywordflow}{if} (count\_data != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03486}03486             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03487}03487               processors\_associated\_with\_data\_on\_other\_proc.resize(count\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03488}03488               MPI\_Recv(\&processors\_associated\_with\_data\_on\_other\_proc[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03489}03489                        count\_data,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03490}03490                        MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03491}03491                        dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03492}03492                        1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03493}03493                        \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03494}03494                        \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03495}03495 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03496}03496               \textcolor{comment}{// Reset counter and loop through nodes on halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03497}03497               count\_data = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03498}03498               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_halo\_elem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03499}03499               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03500}03500                 \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* halo\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03501}03501                   \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03502}03502                 \textcolor{keywordflow}{if} (halo\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03503}03503                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03504}03504                   \textcolor{keywordtype}{unsigned} n\_node = halo\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03505}03505                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03506}03506                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03507}03507                     Node* nod\_pt = halo\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03508}03508 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03509}03509                     \textcolor{comment}{// Get number of processors associated with data that was}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03510}03510                     \textcolor{comment}{// sent}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03511}03511                     \textcolor{keywordtype}{unsigned} n\_assoc =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03512}03512                       processors\_associated\_with\_data\_on\_other\_proc[count\_data];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03513}03513                     count\_data++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03514}03514 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03515}03515                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_assoc = 0; i\_assoc < n\_assoc; i\_assoc++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03516}03516                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03517}03517                       \textcolor{comment}{// Get the process ID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03518}03518                       \textcolor{keywordtype}{unsigned} sent\_domain =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03519}03519                         processors\_associated\_with\_data\_on\_other\_proc}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03520}03520                           [count\_data];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03521}03521                       count\_data++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03522}03522 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03523}03523                       \textcolor{comment}{// Add it to this processor's list of IDs}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03524}03524                       processors\_associated\_with\_data[nod\_pt].insert(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03525}03525                         sent\_domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03526}03526 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03527}03527                       \textcolor{comment}{// If the node is solid then add the ID to the solid data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03528}03528                       \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03529}03529                         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03530}03530                       \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03531}03531                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03532}03532                         processors\_associated\_with\_data}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03533}03533                           [solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03534}03534                             .insert(sent\_domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03535}03535                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03536}03536                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03537}03537                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03538}03538                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03539}03539               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03540}03540             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03541}03541           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03542}03542         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03543}03543       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03544}03544     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03545}03545 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03546}03546     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03547}03547     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03548}03548       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03549}03549       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03550}03550         << \textcolor{stringliteral}{"{}Time for pt2pt send/recv in Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03551}03551         << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03552}03552       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03553}03553       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03554}03554     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03555}03555 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03556}03556 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03557}03557     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after pt2pt send/recv"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03558}03558 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03559}03559     \textcolor{comment}{// Loop over all nodes on the present processor and put the highest-\/numbered}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03560}03560     \textcolor{comment}{// processor associated with each node "{}in charge"{} of the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03561}03561     \textcolor{keywordtype}{unsigned} nnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03562}03562     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03563}03563     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03564}03564       Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03565}03565 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03566}03566       \textcolor{comment}{// Reset halo status of node to false}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03567}03567       nod\_pt-\/>set\_nonhalo();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03568}03568 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03569}03569       \textcolor{comment}{// If it's a SolidNode then the halo status of the data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03570}03570       \textcolor{comment}{// associated with that must also be reset to false}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03571}03571       \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03572}03572       \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03573}03573       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03574}03574         solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_ab2c485e220d3cf13647d251c509f5136}{set\_nonhalo}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03575}03575       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03576}03576 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03577}03577       \textcolor{comment}{// Now put the highest-\/numbered one in charge}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03578}03578       \textcolor{keywordtype}{unsigned} proc\_max = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03579}03579       std::set<unsigned> procs\_set = processors\_associated\_with\_data[nod\_pt];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03580}03580       \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = procs\_set.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03581}03581            it != procs\_set.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03582}03582            it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03583}03583       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03584}03584         \textcolor{keywordflow}{if} (*it > proc\_max) proc\_max = *it;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03585}03585       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03586}03586       processor\_in\_charge[nod\_pt] = proc\_max;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03587}03587 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03588}03588       \textcolor{comment}{// Do the same if we have a SolidNode}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03589}03589       \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03590}03590       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03591}03591         \textcolor{comment}{// Now put the highest-\/numbered one in charge}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03592}03592         \textcolor{keywordtype}{unsigned} proc\_max\_solid = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03593}03593         std::set<unsigned> procs\_set\_solid =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03594}03594           processors\_associated\_with\_data[solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03595}03595         \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it = procs\_set\_solid.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03596}03596              it != procs\_set\_solid.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03597}03597              it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03598}03598         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03599}03599           \textcolor{keywordflow}{if} (*it > proc\_max\_solid) proc\_max\_solid = *it;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03600}03600         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03601}03601         processor\_in\_charge[solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()] =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03602}03602           proc\_max\_solid;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03603}03603       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03604}03604     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03605}03605 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03606}03606 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03607}03607     \textcolor{comment}{// First stab at determining halo nodes. They are located on the halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03608}03608     \textcolor{comment}{// elements and the processor in charge differs from the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03609}03609     \textcolor{comment}{// current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03610}03610 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03611}03611     \textcolor{comment}{// Only count nodes once (map is initialised to 0 = false)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03612}03612     std::map<Node*, bool> done;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03613}03613 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03614}03614     \textcolor{comment}{// Loop over all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03615}03615     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03616}03616     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03617}03617       \textcolor{comment}{// Get vector of halo elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03618}03618       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(domain));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03619}03619 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03620}03620       \textcolor{comment}{// Loop over halo elements associated with this adjacent domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03621}03621       \textcolor{keywordtype}{unsigned} nelem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03622}03622 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03623}03623       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03624}03624       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03625}03625         \textcolor{comment}{// Get element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03626}03626         \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03627}03627 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03628}03628         \textcolor{comment}{// Can if be cast to a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03629}03629         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03630}03630         \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03631}03631         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03632}03632           \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03633}03633           \textcolor{keywordtype}{unsigned} nnod = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03634}03634           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03635}03635           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03636}03636             Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03637}03637 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03638}03638             \textcolor{comment}{// Have we done this node already?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03639}03639             \textcolor{keywordflow}{if} (!done[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03640}03640             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03641}03641               \textcolor{comment}{// Is the other processor/domain in charge of this node?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03642}03642               \textcolor{keywordtype}{int} proc\_in\_charge = processor\_in\_charge[nod\_pt];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03643}03643 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03644}03644               \textcolor{keywordflow}{if} (proc\_in\_charge != my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03645}03645               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03646}03646                 \textcolor{comment}{// To keep the order of the nodes consistent with that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03647}03647                 \textcolor{comment}{// in the haloed node lookup scheme, only}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03648}03648                 \textcolor{comment}{// allow it to be added when the current domain is in charge}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03649}03649                 \textcolor{keywordflow}{if} (proc\_in\_charge == \textcolor{keywordtype}{int}(domain))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03650}03650                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03651}03651                   \textcolor{comment}{// Add it as being halo node whose non-\/halo counterpart}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03652}03652                   \textcolor{comment}{// is located on processor proc\_in\_charge}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03653}03653                   this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a2a707cd17908b06270d9169b3baa37d5}{add\_halo\_node\_pt}}(proc\_in\_charge, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03654}03654 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03655}03655                   \textcolor{comment}{// The node itself needs to know it is a halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03656}03656                   nod\_pt-\/>set\_halo(proc\_in\_charge);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03657}03657 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03658}03658                   \textcolor{comment}{// If it's a SolidNode then the data associated with that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03659}03659                   \textcolor{comment}{// must also be halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03660}03660                   \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03661}03661                   \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03662}03662                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03663}03663                     solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_ac96b285ae3f1ce549807072b652573bf}{set\_halo}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03664}03664                       proc\_in\_charge);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03665}03665                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03666}03666 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03667}03667                   \textcolor{comment}{// We're done with this node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03668}03668                   done[nod\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03669}03669                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03670}03670               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03671}03671             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03672}03672           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03673}03673 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03674}03674         \} \textcolor{comment}{// End of finite element case}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03675}03675 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03676}03676         \textcolor{comment}{// Now make sure internal data on halo elements is also halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03677}03677         \textcolor{keywordtype}{unsigned} nintern\_data = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6b736de0af4c92831968636479b3480e}{ninternal\_data}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03678}03678         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} iintern = 0; iintern < nintern\_data; iintern++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03679}03679         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03680}03680           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a3b83389f2c80788013421c6d59604f0b}{internal\_data\_pt}}(iintern)-\/>\mbox{\hyperlink{classoomph_1_1Data_ac96b285ae3f1ce549807072b652573bf}{set\_halo}}(domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03681}03681         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03682}03682       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03683}03683     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03684}03684 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03685}03685 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03686}03686     \textcolor{comment}{// First stab at determining haloed nodes. They are located on the haloed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03687}03687     \textcolor{comment}{// elements and the processor in charge is the current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03688}03688 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03689}03689     \textcolor{comment}{// Loop over processors that share haloes with the current one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03690}03690     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03691}03691     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03692}03692       \textcolor{comment}{// Only count nodes once (map is initialised to 0 = false)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03693}03693       std::map<Node*, bool> node\_done;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03694}03694 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03695}03695       \textcolor{comment}{// Get vector of haloed elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03696}03696       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03697}03697         this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(domain));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03698}03698 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03699}03699       \textcolor{comment}{// Loop over haloed elements associated with this adjacent domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03700}03700       \textcolor{keywordtype}{unsigned} nelem = haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03701}03701 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03702}03702       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03703}03703       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03704}03704         \textcolor{comment}{// Get element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03705}03705         \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03706}03706 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03707}03707         \textcolor{comment}{// Can it be cast to a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03708}03708         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03709}03709         \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03710}03710         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03711}03711           \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03712}03712           \textcolor{keywordtype}{unsigned} nnod = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03713}03713           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03714}03714           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03715}03715             Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03716}03716 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03717}03717             \textcolor{comment}{// Have we done this node already?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03718}03718             \textcolor{keywordflow}{if} (!node\_done[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03719}03719             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03720}03720               \textcolor{comment}{// Is the current processor/domain in charge of this node?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03721}03721               \textcolor{keywordtype}{int} proc\_in\_charge = processor\_in\_charge[nod\_pt];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03722}03722 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03723}03723               \textcolor{keywordflow}{if} (proc\_in\_charge == my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03724}03724               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03725}03725                 \textcolor{comment}{// Add it as being haloed from specified domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03726}03726                 this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_abd2b195d6bdf05acff222d2ae1c68357}{add\_haloed\_node\_pt}}(domain, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03727}03727 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03728}03728                 \textcolor{comment}{// We're done with this node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03729}03729                 node\_done[nod\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03730}03730               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03731}03731             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03732}03732           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03733}03733         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03734}03734       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03735}03735     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03736}03736 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03737}03737 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03738}03738     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03739}03739     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03740}03740       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03741}03741       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03742}03742         << \textcolor{stringliteral}{"{}Time for first classific in Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03743}03743         << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03744}03744       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03745}03745       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03746}03746     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03747}03747 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03748}03748     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after first classific"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03749}03749 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03750}03750 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03751}03751     \textcolor{comment}{// Find any overlooked halo nodes: These are any nodes on the halo/haloed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03752}03752     \textcolor{comment}{// elements (i.e. precisely the nodes currently contained in the shared}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03753}03753     \textcolor{comment}{// node scheme) that have not been classified as haloes (yet) though they}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03754}03754     \textcolor{comment}{// should have been because another processor is in charge of them.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03755}03755     \textcolor{comment}{// This arises when the "{}overlooked halo node"{} is not part of the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03756}03756     \textcolor{comment}{// halo/haloed element lookup scheme between the current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03757}03757     \textcolor{comment}{// and the processor that holds the non-\/halo counterpart. E.g. we're}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03758}03758     \textcolor{comment}{// on proc 3. A node at the very edge of its halo layer also exists}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03759}03759     \textcolor{comment}{// on procs 0 and 1 with 1 being "{}in charge"{}. However, the node in}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03760}03760     \textcolor{comment}{// question is not part of the halo/haloed element lookup scheme between}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03761}03761     \textcolor{comment}{// processor 1 and 3 so in the classification performed above, we never}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03762}03762     \textcolor{comment}{// visit it so it's overlooked. The code below rectifies this by going}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03763}03763     \textcolor{comment}{// through the intermediate processor (here proc 0) that contains the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03764}03764     \textcolor{comment}{// in lookup schemes with the halo processor (here proc 3, this one) and the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03765}03765     \textcolor{comment}{// one that contains the non-\/halo counterpart (here proc 1).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03766}03766 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03767}03767 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03768}03768     \textcolor{comment}{// Counter for number of overlooked halos (if there aren't any we don't}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03769}03769     \textcolor{comment}{// need any comms below)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03770}03770     \textcolor{keywordtype}{unsigned} n\_overlooked\_halo = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03771}03771 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03772}03772     \textcolor{comment}{// Record previously overlooked halo nodes so they can be}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03773}03773     \textcolor{comment}{// added to the shared node lookup scheme (in a consistent order) below}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03774}03774     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<Node*>}}> over\_looked\_halo\_node\_pt(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03775}03775 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03776}03776     \textcolor{comment}{// Record previously overlooked haloed nodes so they can be}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03777}03777     \textcolor{comment}{// added to the shared node lookup scheme (in a consistent order) below}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03778}03778     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<Node*>}}> over\_looked\_haloed\_node\_pt(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03779}03779 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03780}03780     \textcolor{comment}{// Data to be sent to each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03781}03781     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} send\_n(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03782}03782 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03783}03783     \textcolor{comment}{// Storage for all values to be sent to all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03784}03784     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} send\_data;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03785}03785 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03786}03786     \textcolor{comment}{// Start location within send\_data for data to be sent to each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03787}03787     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} send\_displacement(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03788}03788 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03789}03789     \textcolor{comment}{// Check missing ones}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03790}03790     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03791}03791     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03792}03792       \textcolor{comment}{// Set the offset for the current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03793}03793       send\_displacement[domain] = send\_data.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03794}03794 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03795}03795       \textcolor{comment}{// Don't bother to do anything if the processor in the loop is the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03796}03796       \textcolor{comment}{// current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03797}03797       \textcolor{keywordflow}{if} (domain != my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03798}03798       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03799}03799         \textcolor{keywordtype}{unsigned} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03800}03800         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03801}03801         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03802}03802           Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(domain, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03803}03803 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03804}03804           \textcolor{comment}{// Is a different-\/numbered processor/domain in charge of this node?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03805}03805           \textcolor{keywordtype}{int} proc\_in\_charge = processor\_in\_charge[nod\_pt];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03806}03806           \textcolor{keywordflow}{if} ((proc\_in\_charge != my\_rank) \&\& !(nod\_pt-\/>is\_halo()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03807}03807           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03808}03808             \textcolor{comment}{// Add it as being halo node whose non-\/halo counterpart}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03809}03809             \textcolor{comment}{// is located on processor proc\_in\_charge}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03810}03810             this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a2a707cd17908b06270d9169b3baa37d5}{add\_halo\_node\_pt}}(proc\_in\_charge, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03811}03811 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03812}03812             \textcolor{comment}{// We have another one...}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03813}03813             n\_overlooked\_halo++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03814}03814             over\_looked\_halo\_node\_pt[proc\_in\_charge].push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03815}03815 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03816}03816             \textcolor{comment}{// The node itself needs to know it is a halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03817}03817             nod\_pt-\/>set\_halo(proc\_in\_charge);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03818}03818 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03819}03819             \textcolor{comment}{// If it's a SolidNode then the data associated with that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03820}03820             \textcolor{comment}{// must also be halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03821}03821             \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03822}03822             \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03823}03823             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03824}03824               solid\_nod\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a22078726936f5bf3cf9e4328b3852a4a}{variable\_position\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Data_ac96b285ae3f1ce549807072b652573bf}{set\_halo}}(proc\_in\_charge);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03825}03825             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03826}03826 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03827}03827             \textcolor{comment}{// Send shared node ID and processor in charge info to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03828}03828             \textcolor{comment}{// "{}intermediate"{} processor (i.e. the processor that has}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03829}03829             \textcolor{comment}{// the lookup schemes to talk to both}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03830}03830             send\_data.push\_back(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03831}03831             send\_data.push\_back(proc\_in\_charge);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03832}03832           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03833}03833         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03834}03834       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03835}03835 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03836}03836       \textcolor{comment}{// End of data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03837}03837       send\_data.push\_back(-\/1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03838}03838 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03839}03839       \textcolor{comment}{// Find the number of data added to the vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03840}03840       send\_n[domain] = send\_data.size() -\/ send\_displacement[domain];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03841}03841     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03842}03842 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03843}03843 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03844}03844     \textcolor{comment}{// Check if any processor has stumbled across overlooked halos}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03845}03845     \textcolor{comment}{// (if not we can omit the comms below)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03846}03846     \textcolor{keywordtype}{unsigned} global\_max\_n\_overlooked\_halo = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03847}03847     MPI\_Allreduce(\&n\_overlooked\_halo,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03848}03848                   \&global\_max\_n\_overlooked\_halo,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03849}03849                   1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03850}03850                   MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03851}03851                   MPI\_MAX,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03852}03852                   \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03853}03853 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03854}03854 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03855}03855     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Global max number of overlooked haloes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03856}03856                << global\_max\_n\_overlooked\_halo << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03857}03857 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03858}03858     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03859}03859     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03860}03860       tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03861}03861       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for setup 1st alltoalls in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03862}03862                     \textcolor{stringliteral}{"{}Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03863}03863                  << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03864}03864       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03865}03865       tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03866}03866     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03867}03867 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03868}03868     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after setup 1st alltoalls"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03869}03869 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03870}03870     \textcolor{comment}{// Any comms needed?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03871}03871     \textcolor{keywordflow}{if} (global\_max\_n\_overlooked\_halo > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03872}03872     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03873}03873       \textcolor{comment}{// Storage for the number of data to be received from each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03874}03874       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} receive\_n(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03875}03875 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03876}03876       \textcolor{comment}{// Now send numbers of data to be sent between all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03877}03877       MPI\_Alltoall(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03878}03878         \&send\_n[0], 1, MPI\_INT, \&receive\_n[0], 1, MPI\_INT, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03879}03879 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03880}03880 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03881}03881       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03882}03882       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03883}03883         tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03884}03884         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03885}03885           << \textcolor{stringliteral}{"{}Time for 1st alltoall in Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03886}03886           << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03887}03887         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03888}03888         tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03889}03889       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03890}03890 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03891}03891       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after 1st alltoall"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03892}03892 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03893}03893 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03894}03894       \textcolor{comment}{// We now prepare the data to be received}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03895}03895       \textcolor{comment}{// by working out the displacements from the received data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03896}03896       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} receive\_displacement(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03897}03897       \textcolor{keywordtype}{int} receive\_data\_count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03898}03898       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} rank = 0; rank < n\_proc; ++rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03899}03899       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03900}03900         \textcolor{comment}{// Displacement is number of data received so far}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03901}03901         receive\_displacement[rank] = receive\_data\_count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03902}03902         receive\_data\_count += receive\_n[rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03903}03903       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03904}03904 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03905}03905       \textcolor{comment}{// Now resize the receive buffer for all data from all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03906}03906       \textcolor{comment}{// Make sure that it has a size of at least one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03907}03907       \textcolor{keywordflow}{if} (receive\_data\_count == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03908}03908       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03909}03909         ++receive\_data\_count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03910}03910       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03911}03911       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} receive\_data(receive\_data\_count);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03912}03912 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03913}03913       \textcolor{comment}{// Make sure that the send buffer has size at least one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03914}03914       \textcolor{comment}{// so that we don't get a segmentation fault}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03915}03915       \textcolor{keywordflow}{if} (send\_data.size() == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03916}03916       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03917}03917         send\_data.resize(1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03918}03918       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03919}03919 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03920}03920       \textcolor{comment}{// Now send the data between all the processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03921}03921       MPI\_Alltoallv(\&send\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03922}03922                     \&send\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03923}03923                     \&send\_displacement[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03924}03924                     MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03925}03925                     \&receive\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03926}03926                     \&receive\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03927}03927                     \&receive\_displacement[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03928}03928                     MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03929}03929                     \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03930}03930 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03931}03931 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03932}03932       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03933}03933       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03934}03934         tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03935}03935         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03936}03936           << \textcolor{stringliteral}{"{}Time for 2nd alltoall in Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03937}03937           << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03938}03938         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03939}03939         tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03940}03940       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03941}03941 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03942}03942       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after 2nd alltoall"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03943}03943 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03944}03944       \textcolor{comment}{// Provide storage for data to be sent to processor that used to be}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03945}03945       \textcolor{comment}{// in charge}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03946}03946       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<int>}}> send\_data\_for\_proc\_in\_charge(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03947}03947 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03948}03948       \textcolor{comment}{// Now use the received data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03949}03949       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} send\_rank = 0; send\_rank < n\_proc; send\_rank++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03950}03950       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03951}03951         \textcolor{comment}{// Don't bother to do anything for the processor corresponding to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03952}03952         \textcolor{comment}{// current processor or if no data were received from this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03953}03953         \textcolor{keywordflow}{if} ((send\_rank != my\_rank) \&\& (receive\_n[send\_rank] != 0))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03954}03954         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03955}03955           \textcolor{comment}{// Counter for the data within the large array}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03956}03956           \textcolor{keywordtype}{unsigned} count = receive\_displacement[send\_rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03957}03957 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03958}03958           \textcolor{comment}{// Unpack until we reach "{}end of data"{} indicator (-\/1)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03959}03959           \textcolor{keywordflow}{while} (\textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03960}03960           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03961}03961             \textcolor{comment}{// Read next entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03962}03962             \textcolor{keywordtype}{int} next\_one = receive\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03963}03963 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03964}03964             \textcolor{keywordflow}{if} (next\_one == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03965}03965             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03966}03966               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03967}03967             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03968}03968             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03969}03969             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03970}03970               \textcolor{comment}{// Shared halo node number in lookup scheme between intermediate}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03971}03971               \textcolor{comment}{// (i.e. this) processor and the one that has the overlooked halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03972}03972               \textcolor{keywordtype}{unsigned} j = unsigned(next\_one);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03973}03973 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03974}03974               \textcolor{comment}{// Processor in charge:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03975}03975               \textcolor{keywordtype}{unsigned} proc\_in\_charge = unsigned(receive\_data[count++]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03976}03976 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03977}03977               \textcolor{comment}{// Find actual node from shared node lookup scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03978}03978               Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(send\_rank, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03979}03979 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03980}03980 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03981}03981               \textcolor{comment}{// Note: This search seems relatively cheap}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03982}03982               \textcolor{comment}{//       and in the tests done, did not benefit}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03983}03983               \textcolor{comment}{//       from conversion to map-\/based search}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03984}03984               \textcolor{comment}{//       as in}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03985}03985               \textcolor{comment}{//       TreeBasedRefineableMeshBase::synchronise\_hanging\_nodes()}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03986}03986 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03987}03987 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03988}03988               \textcolor{comment}{// Locate its index in lookup scheme with proc in charge}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03989}03989               \textcolor{keywordtype}{bool} found = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03990}03990               \textcolor{keywordtype}{unsigned} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(proc\_in\_charge);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03991}03991               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} jj = 0; jj < nnod; jj++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03992}03992               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03993}03993                 \textcolor{keywordflow}{if} (nod\_pt == \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(proc\_in\_charge, jj))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03994}03994                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03995}03995                   found = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03996}03996 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03997}03997                   \textcolor{comment}{// Shared node ID in lookup scheme with intermediate (i.e.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03998}03998                   \textcolor{comment}{// this) processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l03999}03999                   send\_data\_for\_proc\_in\_charge[proc\_in\_charge].push\_back(jj);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04000}04000 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04001}04001                   \textcolor{comment}{// Processor that holds the overlooked halo node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04002}04002                   send\_data\_for\_proc\_in\_charge[proc\_in\_charge].push\_back(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04003}04003                     send\_rank);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04004}04004 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04005}04005                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04006}04006                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04007}04007               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04008}04008               \textcolor{keywordflow}{if} (!found)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04009}04009               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04010}04010                 std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04011}04011                 error\_stream}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04012}04012                   << \textcolor{stringliteral}{"{}Failed to find node that is shared node "{}} << j}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04013}04013                   << \textcolor{stringliteral}{"{} (with processor "{}} << send\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04014}04014                   << \textcolor{stringliteral}{"{}) \(\backslash\)n in shared node lookup scheme with processor "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04015}04015                   << proc\_in\_charge << \textcolor{stringliteral}{"{} which is in charge.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04016}04016                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04017}04017                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04018}04018                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04019}04019               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04020}04020             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04021}04021           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04022}04022         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04023}04023       \} \textcolor{comment}{// End of data is received}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04024}04024 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04025}04025 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04026}04026       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04027}04027       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04028}04028         tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04029}04029         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for 1st setup 3rd alltoall in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04030}04030                       \textcolor{stringliteral}{"{}Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04031}04031                    << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04032}04032         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04033}04033         tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04034}04034       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04035}04035 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04036}04036       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after 1st setup for 3rd alltoall"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04037}04037 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04038}04038       \textcolor{comment}{// Data to be sent to each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04039}04039       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} all\_send\_n(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04040}04040 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04041}04041       \textcolor{comment}{// Storage for all values to be sent to all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04042}04042       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} all\_send\_data;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04043}04043 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04044}04044       \textcolor{comment}{// Start location within send\_data for data to be sent to each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04045}04045       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} all\_send\_displacement(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04046}04046 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04047}04047       \textcolor{comment}{// Collate data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04048}04048       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04049}04049       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04050}04050         \textcolor{comment}{// Set the offset for the current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04051}04051         all\_send\_displacement[domain] = all\_send\_data.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04052}04052 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04053}04053         \textcolor{comment}{// Don't bother to do anything if the processor in the loop is the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04054}04054         \textcolor{comment}{// current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04055}04055         \textcolor{keywordflow}{if} (domain != my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04056}04056         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04057}04057           \textcolor{keywordtype}{unsigned} n = send\_data\_for\_proc\_in\_charge[domain].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04058}04058           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04059}04059           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04060}04060             all\_send\_data.push\_back(send\_data\_for\_proc\_in\_charge[domain][j]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04061}04061           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04062}04062         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04063}04063 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04064}04064         \textcolor{comment}{// End of data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04065}04065         all\_send\_data.push\_back(-\/1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04066}04066 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04067}04067         \textcolor{comment}{// Find the number of data added to the vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04068}04068         all\_send\_n[domain] =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04069}04069           all\_send\_data.size() -\/ all\_send\_displacement[domain];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04070}04070       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04071}04071 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04072}04072 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04073}04073       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04074}04074       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04075}04075         tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04076}04076         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for 2nd setup 3rd alltoall in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04077}04077                       \textcolor{stringliteral}{"{}Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04078}04078                    << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04079}04079         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04080}04080         tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04081}04081       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04082}04082 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04083}04083       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after 2nd setup 3rd alltoall"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04084}04084 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04085}04085       \textcolor{comment}{// Storage for the number of data to be received from each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04086}04086       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} all\_receive\_n(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04087}04087 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04088}04088       \textcolor{comment}{// Now send numbers of data to be sent between all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04089}04089       MPI\_Alltoall(\&all\_send\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04090}04090                    1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04091}04091                    MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04092}04092                    \&all\_receive\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04093}04093                    1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04094}04094                    MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04095}04095                    \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04096}04096 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04097}04097 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04098}04098       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04099}04099       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04100}04100         tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04101}04101         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04102}04102           << \textcolor{stringliteral}{"{}Time for 3rd alltoall in Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04103}04103           << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04104}04104         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04105}04105         tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04106}04106       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04107}04107 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04108}04108       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after 3rd alltoall"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04109}04109 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04110}04110       \textcolor{comment}{// We now prepare the data to be received}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04111}04111       \textcolor{comment}{// by working out the displacements from the received data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04112}04112       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} all\_receive\_displacement(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04113}04113       \textcolor{keywordtype}{int} all\_receive\_data\_count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04114}04114 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04115}04115       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} rank = 0; rank < n\_proc; ++rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04116}04116       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04117}04117         \textcolor{comment}{// Displacement is number of data received so far}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04118}04118         all\_receive\_displacement[rank] = all\_receive\_data\_count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04119}04119         all\_receive\_data\_count += all\_receive\_n[rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04120}04120       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04121}04121 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04122}04122       \textcolor{comment}{// Now resize the receive buffer for all data from all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04123}04123       \textcolor{comment}{// Make sure that it has a size of at least one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04124}04124       \textcolor{keywordflow}{if} (all\_receive\_data\_count == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04125}04125       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04126}04126         ++all\_receive\_data\_count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04127}04127       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04128}04128       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} all\_receive\_data(all\_receive\_data\_count);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04129}04129 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04130}04130       \textcolor{comment}{// Make sure that the send buffer has size at least one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04131}04131       \textcolor{comment}{// so that we don't get a segmentation fault}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04132}04132       \textcolor{keywordflow}{if} (all\_send\_data.size() == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04133}04133       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04134}04134         all\_send\_data.resize(1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04135}04135       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04136}04136 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04137}04137       \textcolor{comment}{// Now send the data between all the processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04138}04138       MPI\_Alltoallv(\&all\_send\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04139}04139                     \&all\_send\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04140}04140                     \&all\_send\_displacement[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04141}04141                     MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04142}04142                     \&all\_receive\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04143}04143                     \&all\_receive\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04144}04144                     \&all\_receive\_displacement[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04145}04145                     MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04146}04146                     \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04147}04147 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04148}04148 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04149}04149       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04150}04150       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04151}04151         tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04152}04152         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04153}04153           << \textcolor{stringliteral}{"{}Time for 4th alltoall in Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04154}04154           << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04155}04155         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04156}04156         tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04157}04157       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04158}04158 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04159}04159       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after 4th alltoall"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04160}04160 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04161}04161 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04162}04162       \textcolor{comment}{// Now use the received data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04163}04163       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} send\_rank = 0; send\_rank < n\_proc; send\_rank++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04164}04164       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04165}04165         \textcolor{comment}{// Don't bother to do anything for the processor corresponding to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04166}04166         \textcolor{comment}{// current processor or if no data were received from this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04167}04167         \textcolor{keywordflow}{if} ((send\_rank != my\_rank) \&\& (all\_receive\_n[send\_rank] != 0))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04168}04168         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04169}04169           \textcolor{comment}{// Counter for the data within the large array}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04170}04170           \textcolor{keywordtype}{unsigned} count = all\_receive\_displacement[send\_rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04171}04171 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04172}04172           \textcolor{comment}{// Unpack until we reach "{}end of data"{} indicator (-\/1)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04173}04173           \textcolor{keywordflow}{while} (\textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04174}04174           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04175}04175             \textcolor{comment}{// Read next entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04176}04176             \textcolor{keywordtype}{int} next\_one = all\_receive\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04177}04177 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04178}04178             \textcolor{keywordflow}{if} (next\_one == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04179}04179             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04180}04180               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04181}04181             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04182}04182             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04183}04183             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04184}04184               \textcolor{comment}{// Shared node ID in lookup scheme with intermediate (sending)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04185}04185               \textcolor{comment}{// processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04186}04186               \textcolor{keywordtype}{unsigned} j = unsigned(next\_one);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04187}04187 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04188}04188               \textcolor{comment}{// Get pointer to previously overlooked halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04189}04189               Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(send\_rank, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04190}04190 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04191}04191               \textcolor{comment}{// Proc where overlooked halo is}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04192}04192               \textcolor{keywordtype}{unsigned} proc\_with\_overlooked\_halo = all\_receive\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04193}04193 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04194}04194               \textcolor{comment}{// Add it as being haloed from specified domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04195}04195               this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_abd2b195d6bdf05acff222d2ae1c68357}{add\_haloed\_node\_pt}}(proc\_with\_overlooked\_halo, nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04196}04196 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04197}04197               \textcolor{comment}{// Record new haloed node so it an be added to the shared}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04198}04198               \textcolor{comment}{// node lookup scheme (in a consistent order) below.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04199}04199               over\_looked\_haloed\_node\_pt[proc\_with\_overlooked\_halo].push\_back(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04200}04200                 nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04201}04201             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04202}04202           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04203}04203         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04204}04204       \} \textcolor{comment}{// End of data is received}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04205}04205 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04206}04206       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04207}04207       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04208}04208         tt\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04209}04209         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for postproc 4th alltoall in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04210}04210                       \textcolor{stringliteral}{"{}Mesh::classify\_halo\_and\_haloed\_nodes: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04211}04211                    << tt\_end -\/ tt\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04212}04212         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04213}04213         tt\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04214}04214       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04215}04215 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04216}04216       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after postprocess 4th alltoall"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04217}04217 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04218}04218       \textcolor{comment}{// Now add previously overlooked halo/haloed nodes to shared node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04219}04219       \textcolor{comment}{// lookup scheme in consistent order}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04220}04220       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04221}04221       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04222}04222         \textcolor{comment}{// For all domains lower than the current domain: Do halos first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04223}04223         \textcolor{comment}{// then haloed, to ensure correct order in lookup scheme from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04224}04224         \textcolor{comment}{// the other side}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04225}04225         \textcolor{keywordflow}{if} (d < my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04226}04226         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04227}04227           \textcolor{keywordtype}{unsigned} nnod = over\_looked\_halo\_node\_pt[d].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04228}04228           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04229}04229           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04230}04230             this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(d, over\_looked\_halo\_node\_pt[d][j]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04231}04231           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04232}04232           nnod = over\_looked\_haloed\_node\_pt[d].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04233}04233           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04234}04234           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04235}04235             this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(d, over\_looked\_haloed\_node\_pt[d][j]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04236}04236           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04237}04237         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04238}04238         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (d > my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04239}04239         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04240}04240           \textcolor{keywordtype}{unsigned} nnod = over\_looked\_haloed\_node\_pt[d].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04241}04241           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04242}04242           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04243}04243             this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(d, over\_looked\_haloed\_node\_pt[d][j]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04244}04244           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04245}04245           nnod = over\_looked\_halo\_node\_pt[d].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04246}04246           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04247}04247           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04248}04248             this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3b81e17514396174f857d412a8c6abd7}{add\_shared\_node\_pt}}(d, over\_looked\_halo\_node\_pt[d][j]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04249}04249           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04250}04250         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04251}04251       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04252}04252 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04253}04253 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04254}04254       \textcolor{comment}{// Doc stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04255}04255       \textcolor{keywordflow}{if} (report\_stats)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04256}04256       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04257}04257         \textcolor{comment}{// Report total number of halo(ed) and shared nodes for this process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04258}04258         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}BEFORE SYNCHRONISE SHARED NODES Processor "{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04259}04259                    << \textcolor{stringliteral}{"{} holds "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}() << \textcolor{stringliteral}{"{} nodes of which "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04260}04260                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}() << \textcolor{stringliteral}{"{} are halo nodes \(\backslash\)n while "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04261}04261                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}() << \textcolor{stringliteral}{"{} are haloed nodes, and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04262}04262                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}() << \textcolor{stringliteral}{"{} are shared nodes."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04263}04263 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04264}04264         \textcolor{comment}{// Report number of halo(ed) and shared nodes with each domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04265}04265         \textcolor{comment}{// from the current process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04266}04266         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} iproc = 0; iproc < n\_proc; iproc++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04267}04267         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04268}04268           \textcolor{comment}{// Get vector of halo elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04269}04269           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04270}04270             this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(iproc));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04271}04271           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04272}04272             this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(iproc));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04273}04273           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}With process "{}} << iproc << \textcolor{stringliteral}{"{}, there are "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04274}04274                      << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(iproc) << \textcolor{stringliteral}{"{} halo nodes, and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04275}04275                      << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04276}04276                      << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(iproc) << \textcolor{stringliteral}{"{} haloed nodes, and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04277}04277                      << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(iproc) << \textcolor{stringliteral}{"{} shared nodes"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04278}04278                      << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04279}04279                      << halo\_elem\_pt.size() << \textcolor{stringliteral}{"{} halo elements and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04280}04280                      << haloed\_elem\_pt.size() << \textcolor{stringliteral}{"{} haloed elements\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04281}04281         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04282}04282       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04283}04283 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04284}04284       \textcolor{comment}{//  // Doc stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04285}04285       \textcolor{comment}{//  if (report\_stats)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04286}04286       \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04287}04287       \textcolor{comment}{//    // Report total number of halo(ed) and shared nodes for this process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04288}04288       \textcolor{comment}{//    oomph\_info << "{}BEFORE SYNCHRONISE SHARED NODES Processor "{} <<}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04289}04289       \textcolor{comment}{//    my\_rank}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04290}04290       \textcolor{comment}{//               << "{} holds "{} << this-\/>nnode()}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04291}04291       \textcolor{comment}{//               << "{} nodes of which "{} << this-\/>nhalo\_node()}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04292}04292       \textcolor{comment}{//               << "{} are halo nodes \(\backslash\)n while "{} << this-\/>nhaloed\_node()}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04293}04293       \textcolor{comment}{//               << "{} are haloed nodes, and "{} << this-\/>nshared\_node()}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04294}04294       \textcolor{comment}{//               << "{} are shared nodes."{} << std::endl;}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04295}04295 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04296}04296       \textcolor{comment}{//    // Report number of halo(ed) and shared nodes with each domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04297}04297       \textcolor{comment}{//    // from the current process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04298}04298       \textcolor{comment}{//    for (int iproc=0;iproc<n\_proc;iproc++)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04299}04299       \textcolor{comment}{//     \{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04300}04300       \textcolor{comment}{//      // Get vector of halo elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04301}04301       \textcolor{comment}{//      Vector<GeneralisedElement*>}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04302}04302       \textcolor{comment}{//      halo\_elem\_pt(this-\/>halo\_element\_pt(iproc));}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04303}04303       \textcolor{comment}{//      Vector<GeneralisedElement*> haloed\_elem\_pt(}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04304}04304       \textcolor{comment}{//       this-\/>haloed\_element\_pt(iproc));}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04305}04305       \textcolor{comment}{//      oomph\_info << "{}With process "{} << iproc << "{}, there are "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04306}04306       \textcolor{comment}{//                 << this-\/>nhalo\_node(iproc) << "{} halo nodes, and "{} <<}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04307}04307       \textcolor{comment}{//                 std::endl}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04308}04308       \textcolor{comment}{//                 << this-\/>nhaloed\_node(iproc) << "{} haloed nodes, and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04309}04309       \textcolor{comment}{//                 << this-\/>nshared\_node(iproc) << "{} shared nodes"{} <<}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04310}04310       \textcolor{comment}{//                 std::endl}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04311}04311       \textcolor{comment}{//                 <<  halo\_elem\_pt.size() << "{} halo elements and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04312}04312       \textcolor{comment}{//                 <<  haloed\_elem\_pt.size() << "{} haloed elements\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04313}04313       \textcolor{comment}{//     \}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04314}04314       \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04315}04315 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04316}04316     \} \textcolor{comment}{// end if comms reqd because we encountered overlooked halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04317}04317 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04318}04318 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04319}04319     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}before sync halo nodes"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04320}04320 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04321}04321     \textcolor{comment}{// Synchronise shared nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04322}04322     \mbox{\hyperlink{classoomph_1_1Mesh_a5c535dac8f8de9240ecb58058a9cd5ec}{synchronise\_shared\_nodes}}(report\_stats);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04323}04323 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04324}04324     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after sync halo nodes"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04325}04325 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04326}04326 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04327}04327     \textcolor{comment}{// Has some twit filled in haloed nodes with own process?!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04328}04328     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_ab05a3c50d404474a00996a0c9a0e1da8}{Haloed\_node\_pt}}[my\_rank].size() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04329}04329     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04330}04330       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04331}04331         \textcolor{stringliteral}{"{}Processor has haloed nodes with itself! Something's gone wrong!"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04332}04332         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04333}04333         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04334}04334     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04335}04335     \textcolor{comment}{// Has some twit filled in halo nodes with own process?!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04336}04336     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_aa36c21b9e32a318c4b043aea2411cdac}{Halo\_node\_pt}}[my\_rank].size() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04337}04337     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04338}04338       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04339}04339         \textcolor{stringliteral}{"{}Processor has halo nodes with itself! Something's gone wrong!"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04340}04340         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04341}04341         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04342}04342     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04343}04343     \textcolor{comment}{// Has some twit filled in root haloed elements with own process?!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04344}04344     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a205ef660e5763d553053075a254db2a7}{Root\_haloed\_element\_pt}}[my\_rank].size() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04345}04345     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04346}04346       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Processor has root haloed elements with itself! "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04347}04347                           \textcolor{stringliteral}{"{}Something's gone wrong!"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04348}04348                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04349}04349                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04350}04350     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04351}04351     \textcolor{comment}{// Has some twit filled in root halo elements with own process?!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04352}04352     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a6e01d05056ce7e2d38eb66a7af8d9174}{Root\_halo\_element\_pt}}[my\_rank].size() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04353}04353     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04354}04354       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04355}04355         \textcolor{stringliteral}{"{}Processor has root halo elements with itself! Something's gone wrong!"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04356}04356         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04357}04357         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04358}04358     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04359}04359 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04360}04360 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04361}04361     \textcolor{comment}{// Doc stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04362}04362     \textcolor{keywordflow}{if} (report\_stats)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04363}04363     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04364}04364       \textcolor{comment}{// Report total number of halo(ed) and shared nodes for this process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04365}04365       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Processor "{}} << my\_rank << \textcolor{stringliteral}{"{} holds "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04366}04366                  << \textcolor{stringliteral}{"{} nodes of which "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04367}04367                  << \textcolor{stringliteral}{"{} are halo nodes \(\backslash\)n while "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04368}04368                  << \textcolor{stringliteral}{"{} are haloed nodes, and "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04369}04369                  << \textcolor{stringliteral}{"{} are shared nodes."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04370}04370 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04371}04371       \textcolor{comment}{// Report number of halo(ed) and shared nodes with each domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04372}04372       \textcolor{comment}{// from the current process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04373}04373       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} iproc = 0; iproc < n\_proc; iproc++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04374}04374       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04375}04375         \textcolor{comment}{// Get vector of halo elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04376}04376         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(iproc));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04377}04377         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04378}04378           this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(iproc));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04379}04379         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}With process "{}} << iproc << \textcolor{stringliteral}{"{}, there are "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04380}04380                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(iproc) << \textcolor{stringliteral}{"{} halo nodes, and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04381}04381                    << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04382}04382                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(iproc) << \textcolor{stringliteral}{"{} haloed nodes, and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04383}04383                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(iproc) << \textcolor{stringliteral}{"{} shared nodes"{}} << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04384}04384                    << halo\_elem\_pt.size() << \textcolor{stringliteral}{"{} halo elements and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04385}04385                    << haloed\_elem\_pt.size() << \textcolor{stringliteral}{"{} haloed elements\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04386}04386       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04387}04387     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04388}04388 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04389}04389 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04390}04390     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}before resize halo nodes"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04391}04391 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04392}04392     \textcolor{comment}{// Now resize halo nodes if required (can be over-\/ruled from the outside}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04393}04393     \textcolor{comment}{// either by user (for (risky!) efficienty saving) or from overloaded}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04394}04394     \textcolor{comment}{// version of classify\_... in refineable version of that function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04395}04395     \textcolor{comment}{// where resize\_halo\_nodes() is called after synchronising hanging nodes.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04396}04396     \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classoomph_1_1Mesh_ab32657ac33c3c7daff735f8de6229c16}{Resize\_halo\_nodes\_not\_required}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04397}04397     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04398}04398       \mbox{\hyperlink{classoomph_1_1Mesh_ad1e7104f5ffadce2823c4088327fd402}{resize\_halo\_nodes}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04399}04399     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04400}04400 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04401}04401     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after resize halo nodes"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04402}04402 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04403}04403     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04404}04404     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04405}04405       \textcolor{keywordtype}{double} t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04406}04406       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Total time for Mesh::classify\_halo\_and\_halo\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04407}04407                  << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04408}04408       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}.\mbox{\hyperlink{classoomph_1_1OomphInfo_a353cd56d96da9152d6d730b328c07a06}{stream\_pt}}()-\/>flush();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04409}04409     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04410}04410 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04411}04411     \textcolor{comment}{//  MemoryUsage::doc\_memory\_usage(}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04412}04412     \textcolor{comment}{//   "{}at end of Mesh::classify\_halo\_and\_halo\_nodes()"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04413}04413   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04414}04414 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04415}04415 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04416}04416   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04417}04417 \textcolor{comment}{  /// Helper function that resizes halo nodes to the same}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04418}04418 \textcolor{comment}{  /// size as their non-\/halo counterparts if required. (A discrepancy}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04419}04419 \textcolor{comment}{  /// can arise if a FaceElement that introduces additional unknowns}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04420}04420 \textcolor{comment}{  /// are attached to a bulk element that shares a node with a haloed element.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04421}04421 \textcolor{comment}{  /// In that case the joint node between haloed and non-\/haloed element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04422}04422 \textcolor{comment}{  /// is resized on that processor but not on the one that holds the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04423}04423 \textcolor{comment}{  /// halo counterpart (because no FaceElement is attached to the halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04424}04424 \textcolor{comment}{  /// element)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04425}04425 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04426}\mbox{\hyperlink{classoomph_1_1Mesh_ad1e7104f5ffadce2823c4088327fd402}{04426}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ad1e7104f5ffadce2823c4088327fd402}{Mesh::resize\_halo\_nodes}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04427}04427   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04428}04428     \textcolor{keywordtype}{double} t\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04429}04429     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04430}04430     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04431}04431       t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04432}04432     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04433}04433 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04434}04434     MPI\_Status status;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04435}04435 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04436}04436     \textcolor{comment}{// Nuffink needs to be done if mesh isn't distributed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04437}04437     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a1ab35b022b95f2d28c53aa58859bd6b5}{is\_mesh\_distributed}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04438}04438     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04439}04439       \textcolor{comment}{// Storage for current processor and number of processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04440}04440       \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04441}04441       \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04442}04442 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04443}04443       \textcolor{comment}{// Loop over domains on which non-\/halo counter parts of my halo nodes live}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04444}04444       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04445}04445       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04446}04446         \textcolor{comment}{// On current processor: Receive data for my halo nodes with proc d.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04447}04447         \textcolor{comment}{// Elsewhere: Send haloed data with proc d.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04448}04448         \textcolor{keywordflow}{if} (d == my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04449}04449         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04450}04450           \textcolor{comment}{// Loop over domains that hold non-\/halo counterparts of my halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04451}04451           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04452}04452           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04453}04453             \textcolor{comment}{// Don't talk to yourself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04454}04454             \textcolor{keywordflow}{if} (dd != d)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04455}04455             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04456}04456               \textcolor{comment}{// How many of my nodes are halo nodes whose non-\/halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04457}04457               \textcolor{comment}{// counterpart is located on processor dd?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04458}04458               \textcolor{keywordtype}{int} nnod\_halo = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(dd);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04459}04459               \textcolor{keywordtype}{int} nnod\_ext\_halo = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a2dc1f87191771f18f55e9b44664bc7ea}{nexternal\_halo\_node}}(dd);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04460}04460               \textcolor{keywordflow}{if} ((nnod\_halo + nnod\_ext\_halo) != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04461}04461               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04462}04462                 \textcolor{comment}{// Receive from processor dd number of haloed nodes (entry 0),}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04463}04463                 \textcolor{comment}{// external haloed nodes (entry 1) and total number of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04464}04464                 \textcolor{comment}{// unsigneds to be sent below (entry 2)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04465}04465                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} tmp(3);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04466}04466                 MPI\_Recv(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04467}04467                   \&tmp[0], 3, MPI\_INT, dd, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(), \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04468}04468 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04469}04469 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04470}04470                 \textcolor{comment}{// Check that number of halo/haloed nodes match}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04471}04471                 \textcolor{keywordtype}{int} nnod\_haloed = tmp[0];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04472}04472                 \textcolor{keywordflow}{if} (nnod\_haloed != nnod\_halo)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04473}04473                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04474}04474                   std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04475}04475                   error\_message << \textcolor{stringliteral}{"{}Clash in numbers of halo and haloed nodes "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04476}04476                                 << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04477}04477                   error\_message << \textcolor{stringliteral}{"{} between procs "{}} << dd << \textcolor{stringliteral}{"{} and "{}} << d}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04478}04478                                 << \textcolor{stringliteral}{"{}: "{}} << nnod\_haloed << \textcolor{stringliteral}{"{} "{}} << nnod\_halo}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04479}04479                                 << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04480}04480                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04481}04481                                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04482}04482                                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04483}04483                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04484}04484 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04485}04485                 \textcolor{comment}{// Check that number of external halo/haloed nodes match}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04486}04486                 \textcolor{keywordtype}{int} nnod\_ext\_haloed = tmp[1];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04487}04487                 \textcolor{keywordflow}{if} (nnod\_ext\_haloed != nnod\_ext\_halo)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04488}04488                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04489}04489                   std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04490}04490                   error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04491}04491                     << \textcolor{stringliteral}{"{}Clash in numbers of external halo and haloed nodes "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04492}04492                     << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04493}04493                   error\_message << \textcolor{stringliteral}{"{} between procs "{}} << dd << \textcolor{stringliteral}{"{} and "{}} << d}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04494}04494                                 << \textcolor{stringliteral}{"{}: "{}} << nnod\_ext\_haloed << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04495}04495                                 << nnod\_ext\_halo << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04496}04496                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04497}04497                                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04498}04498                                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04499}04499                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04500}04500 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04501}04501 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04502}04502                 \textcolor{comment}{// How many unsigneds are we about to receive}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04503}04503                 \textcolor{keywordtype}{unsigned} n\_rec = tmp[2];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04504}04504 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04505}04505                 \textcolor{comment}{// Get strung-\/together data from other proc}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04506}04506                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} unsigned\_rec\_data(n\_rec);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04507}04507                 MPI\_Recv(\&unsigned\_rec\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04508}04508                          n\_rec,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04509}04509                          MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04510}04510                          dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04511}04511                          0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04512}04512                          \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04513}04513                          \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04514}04514 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04515}04515                 \textcolor{comment}{// Step through the flat-\/packed unsigneds}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04516}04516                 \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04517}04517 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04518}04518                 \textcolor{comment}{// Normal and external halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04519}04519                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} loop = 0; loop < 2; loop++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04520}04520                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04521}04521                   \textcolor{keywordtype}{unsigned} hi\_nod = nnod\_halo;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04522}04522                   \textcolor{keywordflow}{if} (loop == 1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04523}04523                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04524}04524                     hi\_nod = nnod\_ext\_halo;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04525}04525                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04526}04526                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < int(hi\_nod); j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04527}04527                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04528}04528                     \textcolor{comment}{// Which node are we dealing with}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04529}04529                     Node* nod\_pt = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04530}04530                     \textcolor{keywordflow}{if} (loop == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04531}04531                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04532}04532                       nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad7ba73da180acb43523166ee71fb2e99}{halo\_node\_pt}}(dd, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04533}04533                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04534}04534                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04535}04535                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04536}04536                       nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a1f88352a0bf5be7d15858915097c1e70}{external\_halo\_node\_pt}}(dd, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04537}04537                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04538}04538 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04539}04539                     \textcolor{comment}{// How many values do we have locally?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04540}04540                     \textcolor{keywordtype}{unsigned} nval\_local = nod\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04541}04541 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04542}04542                     \textcolor{comment}{// Read number of values on other side}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04543}04543                     \textcolor{keywordtype}{unsigned} nval\_other = unsigned\_rec\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04544}04544 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04545}04545                     \textcolor{keywordflow}{if} (nval\_local != nval\_other)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04546}04546                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04547}04547                       nod\_pt-\/>resize(nval\_other);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04548}04548                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04549}04549 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04550}04550                     \textcolor{comment}{// Read number of entries in resize map}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04551}04551                     \textcolor{keywordtype}{unsigned} nentry = unsigned\_rec\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04552}04552                     \textcolor{keywordflow}{if} (nentry != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04553}04553                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04554}04554                       \textcolor{comment}{// Is current node a boundary node?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04555}04555                       \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04556}04556                         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04557}04557 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04558}04558                       \textcolor{keywordflow}{if} (bnod\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04559}04559                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04560}04560                         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04561}04561                           \textcolor{stringliteral}{"{}Failed to cast node to boundary node even though "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04562}04562                           \textcolor{stringliteral}{"{}we've received data for boundary node"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04563}04563                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04564}04564                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04565}04565                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04566}04566 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04567}04567 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04568}04568                       \textcolor{comment}{// Create storage for map if it doesn't already exist}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04569}04569                       \textcolor{keywordtype}{bool} already\_existed = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04570}04570                       \textcolor{keywordflow}{if} (}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04571}04571                         bnod\_pt}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04572}04572                           -\/>index\_of\_first\_value\_assigned\_by\_face\_element\_pt() ==}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04573}04573                         0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04574}04574                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04575}04575                         bnod\_pt}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04576}04576                           -\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a5f73c54dbb9bdfe3538b61117a0cc674}{index\_of\_first\_value\_assigned\_by\_face\_element\_pt}}() =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04577}04577                           \textcolor{keyword}{new} std::map<unsigned, unsigned>;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04578}04578                         already\_existed = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04579}04579                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04580}04580 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04581}04581                       \textcolor{comment}{// Get pointer to the map of indices associated with}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04582}04582                       \textcolor{comment}{// additional values created by face elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04583}04583                       std::map<unsigned, unsigned>* map\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04584}04584                         bnod\_pt}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04585}04585                           -\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a5f73c54dbb9bdfe3538b61117a0cc674}{index\_of\_first\_value\_assigned\_by\_face\_element\_pt}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04586}04586 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04587}04587                       \textcolor{comment}{// Loop over number of entries in map (as received)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04588}04588                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nentry; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04589}04589                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04590}04590                         \textcolor{comment}{// Read out pairs...}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04591}04591                         \textcolor{keywordtype}{unsigned} first\_received = unsigned\_rec\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04592}04592                         \textcolor{keywordtype}{unsigned} second\_received = unsigned\_rec\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04593}04593 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04594}04594                         \textcolor{comment}{// If it exists check that values are consistent:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04595}04595                         \textcolor{keywordflow}{if} (already\_existed)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04596}04596                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04597}04597 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04598}04598                           \textcolor{keywordflow}{if} ((*map\_pt)[first\_received] != second\_received)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04599}04599                           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04600}04600                             std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04601}04601                             error\_message << \textcolor{stringliteral}{"{}Existing map entry for map entry "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04602}04602                                           << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} for node located at "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04603}04603                             \textcolor{keywordtype}{unsigned} n = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04604}04604                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ii = 0; ii < n; ii++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04605}04605                             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04606}04606                               error\_message << nod\_pt-\/>position(ii) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04607}04607                             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04608}04608                             error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04609}04609                               << \textcolor{stringliteral}{"{}Key: "{}} << first\_received << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04610}04610                               << \textcolor{stringliteral}{"{}Local value: "{}} << (*map\_pt)[first\_received]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04611}04611                               << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04612}04612                               << \textcolor{stringliteral}{"{}Received value: "{}} << second\_received}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04613}04613                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04614}04614                             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04615}04615                                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04616}04616                                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04617}04617                           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04618}04618 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04619}04619                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04620}04620                         \textcolor{comment}{// Else assign}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04621}04621                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04622}04622                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04623}04623                           (*map\_pt)[first\_received] = second\_received;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04624}04624                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04625}04625                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04626}04626                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04627}04627                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04628}04628                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04629}04629               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04630}04630             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04631}04631           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04632}04632         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04633}04633         \textcolor{comment}{// Send my haloed nodes whose halo counterparts are located on processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04634}04634         \textcolor{comment}{// d}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04635}04635         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04636}04636         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04637}04637           \textcolor{comment}{// Storage for number of haloed nodes (entry 0), number of external}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04638}04638           \textcolor{comment}{// haloed nodes (entry 1) and total number of unsigneds to be sent}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04639}04639           \textcolor{comment}{// below (entry 2)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04640}04640           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} tmp(3);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04641}04641           \textcolor{keywordtype}{int} nnod\_haloed = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04642}04642           tmp[0] = nnod\_haloed;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04643}04643           \textcolor{keywordtype}{int} nnod\_ext\_haloed = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad37eca6c72c9687954aa2d321938d692}{nexternal\_haloed\_node}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04644}04644           tmp[1] = nnod\_ext\_haloed;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04645}04645           \textcolor{keywordflow}{if} ((nnod\_haloed + nnod\_ext\_haloed) != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04646}04646           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04647}04647             \textcolor{comment}{// Now string together the data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04648}04648             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} unsigned\_send\_data;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04649}04649 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04650}04650             \textcolor{comment}{// Normal and external haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04651}04651             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} loop = 0; loop < 2; loop++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04652}04652             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04653}04653               \textcolor{keywordtype}{unsigned} hi\_nod = nnod\_haloed;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04654}04654               \textcolor{keywordflow}{if} (loop == 1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04655}04655               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04656}04656                 hi\_nod = nnod\_ext\_haloed;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04657}04657               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04658}04658               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < int(hi\_nod); j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04659}04659               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04660}04660                 \textcolor{comment}{// Which node are we dealing with?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04661}04661                 Node* nod\_pt = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04662}04662                 \textcolor{keywordflow}{if} (loop == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04663}04663                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04664}04664                   nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ab29fbaa5e88f722de752b3fd642a75e4}{haloed\_node\_pt}}(d, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04665}04665                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04666}04666                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04667}04667                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04668}04668                   nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9f6a99d3f3b01dc1b48247285f50e14d}{external\_haloed\_node\_pt}}(d, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04669}04669                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04670}04670 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04671}04671                 \textcolor{comment}{// Add number of values of node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04672}04672                 unsigned\_send\_data.push\_back(nod\_pt-\/>nvalue());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04673}04673 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04674}04674                 \textcolor{comment}{// Get pointer to the map of indices associated with}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04675}04675                 \textcolor{comment}{// additional values created by face elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04676}04676 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04677}04677                 \textcolor{comment}{// Is it a boundary node?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04678}04678                 \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04679}04679                   \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04680}04680                 \textcolor{keywordflow}{if} (bnod\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04681}04681                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04682}04682                   \textcolor{comment}{// Not a boundary node -\/-\/ there are zero map entries to follow}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04683}04683                   unsigned\_send\_data.push\_back(0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04684}04684                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04685}04685                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04686}04686                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04687}04687                   \textcolor{comment}{// It's a boundary node: Check if it's been resized}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04688}04688                   std::map<unsigned, unsigned>* map\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04689}04689                     bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a5f73c54dbb9bdfe3538b61117a0cc674}{index\_of\_first\_value\_assigned\_by\_face\_element\_pt}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04690}04690 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04691}04691                   \textcolor{comment}{// No additional values created -\/-\/ there are zero map entries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04692}04692                   \textcolor{comment}{// to follow}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04693}04693                   \textcolor{keywordflow}{if} (map\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04694}04694                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04695}04695                     unsigned\_send\_data.push\_back(0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04696}04696                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04697}04697                   \textcolor{comment}{// Created additional values}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04698}04698                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04699}04699                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04700}04700                     \textcolor{comment}{// How many map entries were there}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04701}04701                     unsigned\_send\_data.push\_back(map\_pt-\/>size());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04702}04702 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04703}04703                     \textcolor{comment}{// Loop over entries in map and add to send data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04704}04704                     \textcolor{keywordflow}{for} (std::map<unsigned, unsigned>::iterator p =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04705}04705                            map\_pt-\/>begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04706}04706                          p != map\_pt-\/>end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04707}04707                          p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04708}04708                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04709}04709                       unsigned\_send\_data.push\_back((*p).first);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04710}04710                       unsigned\_send\_data.push\_back((*p).second);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04711}04711                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04712}04712                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04713}04713                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04714}04714               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04715}04715             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04716}04716 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04717}04717             \textcolor{comment}{// How many values are there in total?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04718}04718             \textcolor{keywordtype}{int} n\_send = unsigned\_send\_data.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04719}04719             tmp[2] = n\_send;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04720}04720 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04721}04721             \textcolor{comment}{// Send the counts across to the other processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04722}04722             MPI\_Send(\&tmp[0], 3, MPI\_INT, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04723}04723 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04724}04724             \textcolor{comment}{// Send it across to the processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04725}04725             MPI\_Send(\&unsigned\_send\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04726}04726                      n\_send,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04727}04727                      MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04728}04728                      d,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04729}04729                      0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04730}04730                      \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04731}04731           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04732}04732         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04733}04733       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04734}04734     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04735}04735 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04736}04736     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04737}04737     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04738}04738       \textcolor{keywordtype}{double} t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04739}04739       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Total time for Mesh::resize\_halo\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04740}04740                  << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04741}04741     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04742}04742   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04743}04743 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04744}04744 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04745}04745   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04746}04746 \textcolor{comment}{  /// Get all the halo data stored in the mesh and add pointers to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04747}04747 \textcolor{comment}{  /// the data to the map, indexed by global equation number}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04748}04748 \textcolor{comment}{}  \textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04749}\mbox{\hyperlink{classoomph_1_1Mesh_a9ea031181ace6be72e84892656bdb2cf}{04749}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a9ea031181ace6be72e84892656bdb2cf}{Mesh::get\_all\_halo\_data}}(std::map<unsigned, double*>\& map\_of\_halo\_data)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04750}04750   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04751}04751     \textcolor{comment}{// Loop over the map of Halo\_nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04752}04752     \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}>::iterator it = \mbox{\hyperlink{classoomph_1_1Mesh_aa36c21b9e32a318c4b043aea2411cdac}{Halo\_node\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04753}04753          it != \mbox{\hyperlink{classoomph_1_1Mesh_aa36c21b9e32a318c4b043aea2411cdac}{Halo\_node\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04754}04754          ++it)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04755}04755     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04756}04756       \textcolor{comment}{// Find the number of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04757}04757       \textcolor{keywordtype}{unsigned} n\_node = (it-\/>second).size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04758}04758       \textcolor{comment}{// Loop over them all}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04759}04759       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04760}04760       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04761}04761         \textcolor{comment}{// Add the Node's values (including any solid values) to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04762}04762         \textcolor{comment}{// the map}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04763}04763         (it-\/>second)[n]-\/>add\_value\_pt\_to\_map(map\_of\_halo\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04764}04764       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04765}04765     \} \textcolor{comment}{// End of loop over halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04766}04766 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04767}04767     \textcolor{comment}{// Now loop over all the halo elements and add their internal data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04768}04768     \textcolor{comment}{// Loop over the map of Halo\_nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04769}04769     \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}}>::iterator it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04770}04770            \mbox{\hyperlink{classoomph_1_1Mesh_a6e01d05056ce7e2d38eb66a7af8d9174}{Root\_halo\_element\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04771}04771          it != \mbox{\hyperlink{classoomph_1_1Mesh_a6e01d05056ce7e2d38eb66a7af8d9174}{Root\_halo\_element\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04772}04772          ++it)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04773}04773     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04774}04774       \textcolor{comment}{// Find the number of root elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04775}04775       \textcolor{keywordtype}{unsigned} n\_element = (it-\/>second).size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04776}04776       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04777}04777       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04778}04778         \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = (it-\/>second)[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04779}04779 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04780}04780         \textcolor{comment}{// Is it a refineable element?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04781}04781         \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04782}04782         \textcolor{keywordflow}{if} (ref\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04783}04783         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04784}04784           \textcolor{comment}{// Vector of pointers to leaves in tree emanating from}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04785}04785           \textcolor{comment}{// current root halo element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04786}04786           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Tree*>}} leaf\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04787}04787           ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a4b783f4e5b6aeed83d49e478510d614f}{tree\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Tree_accfbeb9178ce92a8a51e3a15293a86d1}{stick\_leaves\_into\_vector}}(leaf\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04788}04788 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04789}04789           \textcolor{comment}{// Loop over leaves and add their objects (the finite elements)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04790}04790           \textcolor{comment}{// to vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04791}04791           \textcolor{keywordtype}{unsigned} nleaf = leaf\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04792}04792           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} l = 0; l < nleaf; l++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04793}04793           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04794}04794             leaf\_pt[l]-\/>object\_pt()-\/>add\_internal\_value\_pt\_to\_map(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04795}04795               map\_of\_halo\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04796}04796           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04797}04797         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04798}04798         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04799}04799         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04800}04800           el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a80a55128c12660e1c5b0ed191ca25a14}{add\_internal\_value\_pt\_to\_map}}(map\_of\_halo\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04801}04801         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04802}04802       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04803}04803     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04804}04804 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04805}04805 \textcolor{comment}{    /// Repeat for the external data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04806}04806 \textcolor{comment}{}    \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}>::iterator it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04807}04807            \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04808}04808          it != \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04809}04809          ++it)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04810}04810     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04811}04811       \textcolor{comment}{// Find the number of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04812}04812       \textcolor{keywordtype}{unsigned} n\_node = (it-\/>second).size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04813}04813       \textcolor{comment}{// Loop over them all}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04814}04814       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04815}04815       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04816}04816         \textcolor{comment}{// Add the Node's values (including any solid values) to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04817}04817         \textcolor{comment}{// the map}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04818}04818         (it-\/>second)[n]-\/>add\_value\_pt\_to\_map(map\_of\_halo\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04819}04819       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04820}04820     \} \textcolor{comment}{// End of loop over halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04821}04821 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04822}04822     \textcolor{comment}{// Now loop over all the halo elements and add their internal data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04823}04823     \textcolor{comment}{// Loop over the map of Halo\_nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04824}04824     \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}}>::iterator it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04825}04825            \mbox{\hyperlink{classoomph_1_1Mesh_afb2def03c6259295dbd65303584edf31}{External\_halo\_element\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04826}04826          it != \mbox{\hyperlink{classoomph_1_1Mesh_afb2def03c6259295dbd65303584edf31}{External\_halo\_element\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04827}04827          ++it)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04828}04828     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04829}04829       \textcolor{comment}{// Find the number of root elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04830}04830       \textcolor{keywordtype}{unsigned} n\_element = (it-\/>second).size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04831}04831       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_element; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04832}04832       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04833}04833         (it-\/>second)[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]-\/>add\_internal\_value\_pt\_to\_map(map\_of\_halo\_data);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04834}04834       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04835}04835     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04836}04836   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04837}04837 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04838}04838 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04839}04839   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04840}04840 \textcolor{comment}{  /// Get halo node stats for this distributed mesh:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04841}04841 \textcolor{comment}{  /// Average/max/min number of halo nodes over all processors.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04842}04842 \textcolor{comment}{  /// \(\backslash\)b Careful: Involves MPI Broadcasts and must therefore}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04843}04843 \textcolor{comment}{  /// be called on all processors!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04844}04844 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04845}\mbox{\hyperlink{classoomph_1_1Mesh_ac8b298686d35c27b0cbcb7453786b543}{04845}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ac8b298686d35c27b0cbcb7453786b543}{Mesh::get\_halo\_node\_stats}}(\textcolor{keywordtype}{double}\& av\_number,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04846}04846                                  \textcolor{keywordtype}{unsigned}\& max\_number,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04847}04847                                  \textcolor{keywordtype}{unsigned}\& min\_number)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04848}04848   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04849}04849     \textcolor{comment}{// Storage for number of processors and current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04850}04850     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04851}04851     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04852}04852 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04853}04853     \textcolor{comment}{// Create vector to hold number of halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04854}04854     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} nhalo\_nodes(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04855}04855 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04856}04856     \textcolor{comment}{// Stick own number of halo nodes into appropriate entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04857}04857     \textcolor{keywordtype}{int} nhalo\_node\_local = \mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04858}04858 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04859}04859     \textcolor{comment}{// Gather information on root processor: First argument group}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04860}04860     \textcolor{comment}{// specifies what is to be sent (one int from each procssor, indicating}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04861}04861     \textcolor{comment}{// the number of dofs on it), the second group indicates where}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04862}04862     \textcolor{comment}{// the results are to be gathered (in rank order) on root processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04863}04863     MPI\_Gather(\&nhalo\_node\_local,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04864}04864                1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04865}04865                MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04866}04866                \&nhalo\_nodes[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04867}04867                1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04868}04868                MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04869}04869                0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04870}04870                \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04871}04871 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04872}04872     \textcolor{comment}{// Initialise stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04873}04873     av\_number = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04874}04874     \textcolor{keywordtype}{int} max = -\/1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04875}04875     \textcolor{keywordtype}{int} min = 1000000000;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04876}04876 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04877}04877     \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04878}04878     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04879}04879       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_proc; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04880}04880       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04881}04881         av\_number += double(nhalo\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04882}04882         \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}(nhalo\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) > max) max = nhalo\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04883}04883         \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}(nhalo\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) < min) min = nhalo\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04884}04884       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04885}04885       av\_number /= double(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04886}04886     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04887}04887 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04888}04888     \textcolor{comment}{// Now broadcast the result back out}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04889}04889     MPI\_Bcast(\&max, 1, MPI\_INT, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04890}04890     MPI\_Bcast(\&min, 1, MPI\_INT, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04891}04891     MPI\_Bcast(\&av\_number, 1, MPI\_DOUBLE, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04892}04892 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04893}04893     max\_number = max;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04894}04894     min\_number = min;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04895}04895   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04896}04896 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04897}04897 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04898}04898   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04899}04899 \textcolor{comment}{  /// Get haloed node stats for this distributed mesh:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04900}04900 \textcolor{comment}{  /// Average/max/min number of haloed nodes over all processors.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04901}04901 \textcolor{comment}{  /// \(\backslash\)b Careful: Involves MPI Broadcasts and must therefore}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04902}04902 \textcolor{comment}{  /// be called on all processors!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04903}04903 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04904}\mbox{\hyperlink{classoomph_1_1Mesh_a4f7b8beffb9f4b5f95842edf4d8af4c6}{04904}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a4f7b8beffb9f4b5f95842edf4d8af4c6}{Mesh::get\_haloed\_node\_stats}}(\textcolor{keywordtype}{double}\& av\_number,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04905}04905                                    \textcolor{keywordtype}{unsigned}\& max\_number,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04906}04906                                    \textcolor{keywordtype}{unsigned}\& min\_number)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04907}04907   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04908}04908     \textcolor{comment}{// Storage for number of processors and current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04909}04909     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04910}04910     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04911}04911 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04912}04912     \textcolor{comment}{// Create vector to hold number of haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04913}04913     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} nhaloed\_nodes(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04914}04914 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04915}04915     \textcolor{comment}{// Stick own number of haloed nodes into appropriate entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04916}04916     \textcolor{keywordtype}{int} nhaloed\_node\_local = \mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04917}04917 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04918}04918     \textcolor{comment}{// Gather information on root processor: First argument group}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04919}04919     \textcolor{comment}{// specifies what is to be sent (one int from each procssor, indicating}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04920}04920     \textcolor{comment}{// the number of dofs on it), the second group indicates where}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04921}04921     \textcolor{comment}{// the results are to be gathered (in rank order) on root processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04922}04922     MPI\_Gather(\&nhaloed\_node\_local,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04923}04923                1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04924}04924                MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04925}04925                \&nhaloed\_nodes[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04926}04926                1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04927}04927                MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04928}04928                0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04929}04929                \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04930}04930 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04931}04931     \textcolor{comment}{// Initialise stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04932}04932     av\_number = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04933}04933     \textcolor{keywordtype}{int} max = -\/1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04934}04934     \textcolor{keywordtype}{int} min = 1000000000;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04935}04935 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04936}04936     \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04937}04937     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04938}04938       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_proc; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04939}04939       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04940}04940         av\_number += double(nhaloed\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04941}04941         \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}(nhaloed\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) > max) max = nhaloed\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04942}04942         \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}(nhaloed\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) < min) min = nhaloed\_nodes[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04943}04943       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04944}04944       av\_number /= double(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04945}04945     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04946}04946 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04947}04947     \textcolor{comment}{// Now broadcast the result back out}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04948}04948     MPI\_Bcast(\&max, 1, MPI\_INT, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04949}04949     MPI\_Bcast(\&min, 1, MPI\_INT, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04950}04950     MPI\_Bcast(\&av\_number, 1, MPI\_DOUBLE, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04951}04951 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04952}04952     max\_number = max;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04953}04953     min\_number = min;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04954}04954   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04955}04955 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04956}04956   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04957}04957 \textcolor{comment}{  /// Distribute the mesh. Add to vector of deleted elements.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04958}04958 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04959}\mbox{\hyperlink{classoomph_1_1Mesh_adeef6d5b1de197aab956025b4b038778}{04959}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_adeef6d5b1de197aab956025b4b038778}{Mesh::distribute}}(\mbox{\hyperlink{classoomph_1_1OomphCommunicator}{OomphCommunicator}}* comm\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04960}04960                         \textcolor{keyword}{const} \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}}\& element\_domain,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04961}04961                         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}}\& deleted\_element\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04962}04962                         \mbox{\hyperlink{classoomph_1_1DocInfo}{DocInfo}}\& doc\_info,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04963}04963                         \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& report\_stats,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04964}04964                         \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& overrule\_keep\_as\_halo\_element\_status)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04965}04965   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04966}04966     \textcolor{comment}{// Store communicator}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04967}04967     \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}} = comm\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04968}04968 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04969}04969     \textcolor{comment}{// Storage for number of processors and current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04970}04970     \textcolor{keywordtype}{int} n\_proc = comm\_pt-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04971}04971     \textcolor{keywordtype}{int} my\_rank = comm\_pt-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04972}04972 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04973}04973     \textcolor{comment}{// Storage for number of elements and number of nodes on this mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04974}04974     \textcolor{keywordtype}{unsigned} nelem = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04975}04975     \textcolor{keywordtype}{unsigned} nnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04976}04976 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04977}04977     std::ostringstream filename;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04978}04978 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04979}04979     \textcolor{comment}{// Doc the partitioning (only on processor 0)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04980}04980     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04981}04981     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04982}04982     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04983}04983       \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04984}04984       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04985}04985         \textcolor{comment}{// Open files for doc of element partitioning}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04986}04986         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<std::ofstream*>}} domain\_file(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04987}04987         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04988}04988         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04989}04989           \textcolor{comment}{// Note: doc\_info.number() was set in Problem::distribute(...) to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04990}04990           \textcolor{comment}{// reflect the submesh number}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04991}04991           \textcolor{comment}{// Clear the filename}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04992}04992           filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04993}04993           filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/domain"{}} << d << \textcolor{stringliteral}{"{}-\/"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04994}04994                    << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04995}04995           domain\_file[d] = \textcolor{keyword}{new} std::ofstream(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04996}04996         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04997}04997 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04998}04998         \textcolor{comment}{// Doc}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l04999}04999         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05000}05000         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05001}05001           \textcolor{comment}{// If we can't cast to a finite element, we can't output because}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05002}05002           \textcolor{comment}{// there is no output function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05003}05003           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* f\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05004}05004             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05005}05005           \textcolor{keywordflow}{if} (f\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05006}05006           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05007}05007             f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(*domain\_file[element\_domain[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]], 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05008}05008           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05009}05009         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05010}05010 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05011}05011         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05012}05012         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05013}05013           domain\_file[d]-\/>close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05014}05014           \textcolor{keyword}{delete} domain\_file[d];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05015}05015           domain\_file[d] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05016}05016         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05017}05017       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05018}05018     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05019}05019 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05020}05020     \textcolor{comment}{// Loop over all elements, associate all}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05021}05021     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05022}05022     \textcolor{comment}{// nodes with the highest-\/numbered processor and record all}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05023}05023     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05024}05024     \textcolor{comment}{// processors the node is associated with}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05025}05025     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05026}05026 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05027}05027     \textcolor{comment}{// Storage for processors in charge and processors associated with data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05028}05028     std::map<Data*, std::set<unsigned>> processors\_associated\_with\_data;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05029}05029     std::map<Data*, unsigned> processor\_in\_charge;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05030}05030 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05031}05031     \textcolor{comment}{// For all nodes set the processor in charge to zero}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05032}05032     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05033}05033     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05034}05034       Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05035}05035       processor\_in\_charge[nod\_pt] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05036}05036     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05037}05037 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05038}05038     \textcolor{comment}{// Loop over elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05039}05039     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05040}05040     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05041}05041       \textcolor{comment}{// Get an element and its domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05042}05042       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05043}05043       \textcolor{comment}{// Element will only have nodes if it is a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05044}05044       \textcolor{keywordflow}{if} (el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05045}05045       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05046}05046         \textcolor{keywordtype}{unsigned} el\_domain = element\_domain[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05047}05047 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05048}05048         \textcolor{comment}{// Associate nodes with highest numbered processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05049}05049         \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05050}05050         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05051}05051         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05052}05052           Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05053}05053 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05054}05054           \textcolor{comment}{// processor in charge was initialised to 0 above}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05055}05055           \textcolor{keywordflow}{if} (el\_domain > processor\_in\_charge[nod\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05056}05056           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05057}05057             processor\_in\_charge[nod\_pt] = el\_domain;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05058}05058           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05059}05059           processors\_associated\_with\_data[nod\_pt].insert(el\_domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05060}05060         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05061}05061       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05062}05062     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05063}05063 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05064}05064     \textcolor{comment}{// Doc the partitioning (only on processor 0)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05065}05065     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05066}05066     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05067}05067     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05068}05068       \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05069}05069       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05070}05070         \textcolor{comment}{// Open files for doc of node partitioning}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05071}05071         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<std::ofstream*>}} node\_file(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05072}05072         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05073}05073         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05074}05074           \textcolor{comment}{// Note: doc\_info.number() was set in Problem::distribute(...) to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05075}05075           \textcolor{comment}{// reflect the submesh number...}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05076}05076           \textcolor{comment}{// Clear the filename}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05077}05077           filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05078}05078           filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/node"{}} << d << \textcolor{stringliteral}{"{}-\/"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05079}05079                    << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05080}05080           node\_file[d] = \textcolor{keyword}{new} std::ofstream(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05081}05081         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05082}05082 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05083}05083         \textcolor{comment}{// Doc}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05084}05084         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05085}05085         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05086}05086           Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05087}05087           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_dim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05088}05088           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05089}05089           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05090}05090             *node\_file[processor\_in\_charge[nod\_pt]] << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05091}05091           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05092}05092           *node\_file[processor\_in\_charge[nod\_pt]] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05093}05093         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05094}05094         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05095}05095         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05096}05096           node\_file[d]-\/>close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05097}05097           \textcolor{keyword}{delete} node\_file[d];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05098}05098           node\_file[d] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05099}05099         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05100}05100       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05101}05101     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05102}05102 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05103}05103     \textcolor{comment}{// Declare all nodes as obsolete. We'll}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05104}05104     \textcolor{comment}{// change this setting for all nodes that must be retained}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05105}05105     \textcolor{comment}{// further down}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05106}05106     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05107}05107     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05108}05108       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j)-\/>set\_obsolete();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05109}05109     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05110}05110 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05111}05111 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05112}05112     \textcolor{comment}{// Backup old mesh data and flush mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05113}05113     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05114}05114 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05115}05115     \textcolor{comment}{// Backup pointers to elements in this mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05116}05116     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} backed\_up\_el\_pt(nelem);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05117}05117     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05118}05118     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05119}05119       backed\_up\_el\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05120}05120     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05121}05121 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05122}05122     \textcolor{comment}{// Info. used to re-\/generate the boundary element scheme after the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05123}05123     \textcolor{comment}{// deletion of elements not belonging to the current processor)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05124}05124 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05125}05125     \textcolor{comment}{// Get the number of boundary elements before the deletion of non}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05126}05126     \textcolor{comment}{// retained elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05127}05127     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} tmp\_nboundary = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05128}05128     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} ntmp\_boundary\_elements(tmp\_nboundary);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05129}05129     \textcolor{comment}{// In case that there are regions, also get the number of boundary}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05130}05130     \textcolor{comment}{// elements in each region}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05131}05131     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<unsigned>}}> ntmp\_boundary\_elements\_in\_region(tmp\_nboundary);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05132}05132     \textcolor{comment}{// Also get the finite element version of the elements and back them}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05133}05133     \textcolor{comment}{// up}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05134}05134     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<FiniteElement*>}} backed\_up\_f\_el\_pt(nelem);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05135}05135 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05136}05136     \textcolor{comment}{// Only do this if the mesh is a TriangleMeshBase}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05137}05137     \mbox{\hyperlink{classoomph_1_1TriangleMeshBase}{TriangleMeshBase}}* triangle\_mesh\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1TriangleMeshBase}{TriangleMeshBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05138}05138     \textcolor{keywordtype}{bool} is\_a\_triangle\_mesh\_base\_mesh = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05139}05139     \textcolor{keywordflow}{if} (triangle\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05140}05140     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05141}05141       \textcolor{comment}{// Set the flag to indicate we are working with a TriangleMeshBase}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05142}05142       \textcolor{comment}{// mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05143}05143       is\_a\_triangle\_mesh\_base\_mesh = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05144}05144 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05145}05145       \textcolor{comment}{// Are there regions?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05146}05146       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_regions = triangle\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1UnstructuredTwoDMeshGeometryBase_a9776e5d11ad42ce4d49750d31a87e1fc}{nregion}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05147}05147 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05148}05148       \textcolor{comment}{// Loop over the boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05149}05149       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ib = 0; ib < tmp\_nboundary; ib++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05150}05150       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05151}05151         \textcolor{comment}{// Get the number of boundary elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05152}05152         ntmp\_boundary\_elements[ib] = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a68e04b3b70cff70d53d75f66661555e8}{nboundary\_element}}(ib);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05153}05153 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05154}05154         \textcolor{comment}{// Resize the container}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05155}05155         ntmp\_boundary\_elements\_in\_region[ib].resize(n\_regions);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05156}05156 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05157}05157         \textcolor{comment}{// Loop over the regions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05158}05158         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} rr = 0; rr < n\_regions; rr++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05159}05159         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05160}05160           \textcolor{comment}{// Get the region id}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05161}05161           \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} region\_id =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05162}05162             \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\textcolor{keyword}{>}(triangle\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1UnstructuredTwoDMeshGeometryBase_a166bb8462a9ccb50ce7d93b037bb6597}{region\_attribute}}(rr));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05163}05163 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05164}05164           \textcolor{comment}{// Store the number of element in the region (notice we are}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05165}05165           \textcolor{comment}{// using the region index not the region id to refer to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05166}05166           \textcolor{comment}{// region)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05167}05167           ntmp\_boundary\_elements\_in\_region[ib][rr] =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05168}05168             triangle\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1UnstructuredTwoDMeshGeometryBase_a93eb7cb31573833c66dc0eaa4ae357ef}{nboundary\_element\_in\_region}}(ib, region\_id);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05169}05169 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05170}05170         \} \textcolor{comment}{// for (rr < n\_regions)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05171}05171 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05172}05172       \} \textcolor{comment}{// for (ib < tmp\_nboundary)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05173}05173 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05174}05174       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05175}05175       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05176}05176         \textcolor{comment}{// Get the finite element version of the elements and back them}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05177}05177         \textcolor{comment}{// up}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05178}05178         backed\_up\_f\_el\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05179}05179       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05180}05180 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05181}05181     \} \textcolor{comment}{// if (triangle\_mesh\_pt!=0)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05182}05182 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05183}05183     \textcolor{comment}{// Flush the mesh storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05184}05184     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a3def47aa1e0028970a250d9c534e93b2}{flush\_element\_storage}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05185}05185 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05186}05186     \textcolor{comment}{// Delete any storage of external elements and nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05187}05187     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9e3ecb07dc622cf37ce0085446ff9aa6}{delete\_all\_external\_storage}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05188}05188 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05189}05189     \textcolor{comment}{// Boolean to indicate which element is to be retained}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05190}05190     std::vector<bool> element\_retained(nelem, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05191}05191 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05192}05192     \textcolor{comment}{// Storage for element numbers of root halo elements that will be}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05193}05193     \textcolor{comment}{// retained on current processor: root\_halo\_element[p][j]}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05194}05194     \textcolor{comment}{// stores the element number (in the order in which the elements are stored}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05195}05195     \textcolor{comment}{// in backed\_up\_el\_pt) of the j-\/th root halo element with processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05196}05196     \textcolor{comment}{// p.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05197}05197     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<int>}}> root\_halo\_element(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05198}05198 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05199}05199     \textcolor{comment}{// Dummy entry to make sure we always have something to send}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05200}05200     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < n\_proc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05201}05201     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05202}05202       root\_halo\_element[p].push\_back(-\/1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05203}05203     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05204}05204 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05205}05205     \textcolor{comment}{// Determine which elements are going to end up on which processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05206}05206     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05207}05207     \textcolor{keywordtype}{unsigned} number\_of\_retained\_elements = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05208}05208 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05209}05209     \textcolor{comment}{// Loop over all backed up elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05210}05210     nelem = backed\_up\_el\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05211}05211     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05212}05212     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05213}05213       \textcolor{comment}{// Get element and its domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05214}05214       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = backed\_up\_el\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05215}05215       \textcolor{keywordtype}{unsigned} el\_domain = element\_domain[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05216}05216 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05217}05217       \textcolor{comment}{// If element is located on current processor add it back to the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05218}05218       \textcolor{keywordflow}{if} (el\_domain == \textcolor{keywordtype}{unsigned}(my\_rank))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05219}05219       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05220}05220         \textcolor{comment}{// Add element to current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05221}05221         element\_retained[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05222}05222         number\_of\_retained\_elements++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05223}05223       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05224}05224       \textcolor{comment}{// Otherwise we may still need it if it's a halo element:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05225}05225       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05226}05226       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05227}05227         \textcolor{comment}{// If this current mesh has been told to keep all elements as halos,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05228}05228         \textcolor{comment}{// OR the element itself knows that it must be kept then}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05229}05229         \textcolor{comment}{// keep it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05230}05230         \textcolor{keywordflow}{if} ((this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a693e14069672a6770b31e9dfce191042}{Keep\_all\_elements\_as\_halos}}) ||}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05231}05231             (el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6bfd80be22c82459b6029ca1202c8f36}{must\_be\_kept\_as\_halo}}()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05232}05232         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05233}05233           \textcolor{keywordflow}{if} (!overrule\_keep\_as\_halo\_element\_status)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05234}05234           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05235}05235             \textcolor{comment}{// Add as root halo element whose non-\/halo counterpart is}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05236}05236             \textcolor{comment}{// located on processor el\_domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05237}05237             \textcolor{keywordflow}{if} (!element\_retained[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05238}05238             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05239}05239               root\_halo\_element[el\_domain].push\_back(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05240}05240               element\_retained[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05241}05241               number\_of\_retained\_elements++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05242}05242             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05243}05243           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05244}05244         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05245}05245         \textcolor{comment}{// Otherwise: Is one of the nodes associated with the current processor?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05246}05246         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05247}05247         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05248}05248           \textcolor{comment}{// Can only have nodes if this is a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05249}05249           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05250}05250           \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05251}05251           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05252}05252             \textcolor{keywordtype}{unsigned} n\_node = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05253}05253             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05254}05254             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05255}05255               Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(n);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05256}05256 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05257}05257               \textcolor{comment}{// Keep element? (use stl find?)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05258}05258               \textcolor{keywordtype}{unsigned} keep\_it = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05259}05259               \textcolor{keywordflow}{for} (std::set<unsigned>::iterator it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05260}05260                      processors\_associated\_with\_data[nod\_pt].begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05261}05261                    it != processors\_associated\_with\_data[nod\_pt].end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05262}05262                    it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05263}05263               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05264}05264                 \textcolor{keywordflow}{if} (*it == \textcolor{keywordtype}{unsigned}(my\_rank))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05265}05265                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05266}05266                   keep\_it = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05267}05267                   \textcolor{comment}{// Break out of the loop over processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05268}05268                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05269}05269                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05270}05270               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05271}05271 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05272}05272               \textcolor{comment}{// Add a root halo element either if keep\_it=true}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05273}05273               \textcolor{keywordflow}{if} (keep\_it)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05274}05274               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05275}05275                 \textcolor{comment}{// Add as root halo element whose non-\/halo counterpart is}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05276}05276                 \textcolor{comment}{// located on processor el\_domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05277}05277                 \textcolor{keywordflow}{if} (!element\_retained[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05278}05278                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05279}05279                   root\_halo\_element[el\_domain].push\_back(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05280}05280                   element\_retained[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05281}05281                   number\_of\_retained\_elements++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05282}05282                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05283}05283                 \textcolor{comment}{// Now break out of loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05284}05284                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05285}05285               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05286}05286             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05287}05287           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05288}05288         \} \textcolor{comment}{// End of testing for halo by virtue of shared nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05289}05289       \} \textcolor{comment}{// End of halo element conditions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05290}05290     \} \textcolor{comment}{// end of loop over elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05291}05291 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05292}05292     \textcolor{comment}{// First check that the number of elements is greater than zero, when}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05293}05293     \textcolor{comment}{// working with submeshes it may be possible that some of them have}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05294}05294     \textcolor{comment}{// no elements (face element meshes) since those may have been}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05295}05295     \textcolor{comment}{// deleted in "{}Problem::actions\_before\_distribute()"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05296}05296     \textcolor{keywordflow}{if} (nelem > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05297}05297     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05298}05298       \textcolor{comment}{// Check that we are working with a TriangleMeshBase mesh, if}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05299}05299       \textcolor{comment}{// that is the case then we need to create shared boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05300}05300       \textcolor{keywordflow}{if} (is\_a\_triangle\_mesh\_base\_mesh)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05301}05301       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05302}05302         \textcolor{comment}{// Creation of shared boundaries}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05303}05303         \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05304}05304         \textcolor{comment}{// All processors share the same boundary id for the created}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05305}05305         \textcolor{comment}{// shared boundary. We need all the elements on all processors,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05306}05306         \textcolor{comment}{// that is why this step is performed before the deletion of the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05307}05307         \textcolor{comment}{// elements not associated to the current processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05308}05308         \textcolor{comment}{// N.B.: This applies only to unstructured meshes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05309}05309         this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a78170e61889ad6017c67a0025f15c8ad}{create\_shared\_boundaries}}(comm\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05310}05310                                        element\_domain,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05311}05311                                        backed\_up\_el\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05312}05312                                        backed\_up\_f\_el\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05313}05313                                        processors\_associated\_with\_data,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05314}05314                                        overrule\_keep\_as\_halo\_element\_status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05315}05315       \} \textcolor{comment}{// if (is\_a\_triangle\_mesh\_base\_mesh)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05316}05316     \} \textcolor{comment}{// if (nelem > 0)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05317}05317 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05318}05318     \textcolor{comment}{// NOTE: No need to add additional layer of halo elements.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05319}05319     \textcolor{comment}{//       Procedure for removing "{}overlooked"{} halo nodes in}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05320}05320     \textcolor{comment}{//       deals classify\_halo\_and\_haloed\_nodes() deals}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05321}05321     \textcolor{comment}{//       with the problem addressed here. [code that dealt with this}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05322}05322     \textcolor{comment}{//       problem at distribution stage has been removed]}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05323}05323 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05324}05324     \textcolor{comment}{// Store the finite element pointer version of the elements that are}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05325}05325     \textcolor{comment}{// about to be deleted, used to reset the boundary elements info}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05326}05326     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<FiniteElement*>}} deleted\_f\_element\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05327}05327 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05328}05328     \textcolor{comment}{// Copy the elements associated with the actual}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05329}05329     \textcolor{comment}{// current processor into its own permanent storage.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05330}05330     \textcolor{comment}{// Do it in the order in which the elements appeared originally}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05331}05331     nelem = backed\_up\_el\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05332}05332     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05333}05333     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05334}05334       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = backed\_up\_el\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05335}05335       \textcolor{keywordflow}{if} (element\_retained[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05336}05336       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05337}05337         this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aafc35b5df26c448b5d5ab26a793eee35}{add\_element\_pt}}(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05338}05338       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05339}05339       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05340}05340       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05341}05341         \textcolor{comment}{// Flush the object attached to the tree for this element?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05342}05342         \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05343}05343         \textcolor{keywordflow}{if} (ref\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05344}05344         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05345}05345           ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a4b783f4e5b6aeed83d49e478510d614f}{tree\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Tree_a96a95bd9942e906fde87194845a1868c}{flush\_object}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05346}05346         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05347}05347 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05348}05348 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05349}05349         \textcolor{comment}{// Store pointer to the element that's about to be deleted.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05350}05350 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05351}05351         \textcolor{comment}{// Only for structured meshes since this "{}deleted\_element\_pt"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05352}05352         \textcolor{comment}{// vector is used in the "{}problem"{} class to set null pointer to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05353}05353         \textcolor{comment}{// the deleted elements in the Base\_mesh\_element\_pt structure}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05354}05354         \textcolor{keywordflow}{if} (!is\_a\_triangle\_mesh\_base\_mesh)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05355}05355         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05356}05356           deleted\_element\_pt.push\_back(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05357}05357         \} \textcolor{comment}{// if (!is\_a\_triangle\_mesh\_base\_mesh)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05358}05358 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05359}05359         \textcolor{keywordflow}{if} (is\_a\_triangle\_mesh\_base\_mesh)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05360}05360         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05361}05361           \textcolor{comment}{// Store pointer to the finite element that's about to be deleted}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05362}05362           deleted\_f\_element\_pt.push\_back(backed\_up\_f\_el\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05363}05363         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05364}05364 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05365}05365         \textcolor{comment}{// Delete the element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05366}05366         \textcolor{keyword}{delete} el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05367}05367       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05368}05368     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05369}05369 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05370}05370     \textcolor{comment}{// Copy the root halo elements associated with the actual}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05371}05371     \textcolor{comment}{// current processor into its own permanent storage; the order}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05372}05372     \textcolor{comment}{// here is somewhat random but we compensate for that by}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05373}05373     \textcolor{comment}{// ensuring that the corresponding haloed elements are}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05374}05374     \textcolor{comment}{// added in the same order below}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05375}05375 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05376}05376     std::map<unsigned, bool> done;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05377}05377 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05378}05378     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05379}05379     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05380}05380       nelem = root\_halo\_element[d].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05381}05381       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05382}05382       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05383}05383         \textcolor{keywordtype}{int} number = root\_halo\_element[d][\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05384}05384         \textcolor{keywordflow}{if} (number >= 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05385}05385         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05386}05386 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05387}05387           \textcolor{keywordflow}{if} (done[number])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05388}05388           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05389}05389             std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05390}05390             error\_message << \textcolor{stringliteral}{"{}Have already added element "{}} << number}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05391}05391                           << \textcolor{stringliteral}{"{} as root halo element\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05392}05392                           << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05393}05393             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05394}05394                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05395}05395                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05396}05396           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05397}05397           done[number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05398}05398 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05399}05399           this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a7a1e11514626e7619dfa99acac03ff79}{add\_root\_halo\_element\_pt}}(d, backed\_up\_el\_pt[number]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05400}05400         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05401}05401       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05402}05402     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05403}05403 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05404}05404 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05405}05405     \textcolor{comment}{// Now get root haloed elements: root\_haloed\_element[p][j] stores}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05406}05406     \textcolor{comment}{// the element number (in the order in which the elements are stored}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05407}05407     \textcolor{comment}{// in backedup\_el\_pt) of the j-\/th rooted halo element with processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05408}05408     \textcolor{comment}{// p. On proc my\_proc this the same as root\_haloed\_element[my\_proc][j]}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05409}05409     \textcolor{comment}{// on processor p, so get the information by gatherv operations.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05410}05410     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<unsigned>}}> root\_haloed\_element(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05411}05411 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05412}05412     \textcolor{comment}{// Find out number of root halo elements with each other proc}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05413}05413     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} nhalo(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05414}05414     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} nhaloed(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05415}05415     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < n\_proc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05416}05416     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05417}05417       nhalo[p] = root\_halo\_element[p].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05418}05418     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05419}05419 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05420}05420     \textcolor{comment}{// Each processor sends number of halo elements it has with processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05421}05421     \textcolor{comment}{// p to processor p where this information is stored in nhaloed[...]}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05422}05422     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < n\_proc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05423}05423     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05424}05424       \textcolor{comment}{// Gather the p-\/th entries in nhalo from every processor on}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05425}05425       \textcolor{comment}{// processor p and store them in nhaloed consecutively}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05426}05426       \textcolor{comment}{// starting at beginning}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05427}05427       MPI\_Gather(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05428}05428         \&nhalo[p], 1, MPI\_INT, \&nhaloed[0], 1, MPI\_INT, p, comm\_pt-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05429}05429     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05430}05430 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05431}05431     \textcolor{comment}{// In the big sequence of concatenated root halo elements (enumerated}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05432}05432     \textcolor{comment}{// individually on the various processors) where do the root halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05433}05433     \textcolor{comment}{// elements from a given processor start? Also figure out how many}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05434}05434     \textcolor{comment}{// root haloed elements there are in total by summing up their numbers}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05435}05435     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} start\_index(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05436}05436     \textcolor{keywordtype}{unsigned} total\_number\_of\_root\_haloed\_elements = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05437}05437     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_proc = 0; i\_proc < n\_proc; i\_proc++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05438}05438     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05439}05439       total\_number\_of\_root\_haloed\_elements += nhaloed[i\_proc];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05440}05440       \textcolor{keywordflow}{if} (i\_proc != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05441}05441       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05442}05442         start\_index[i\_proc] =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05443}05443           total\_number\_of\_root\_haloed\_elements -\/ nhaloed[i\_proc];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05444}05444       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05445}05445       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05446}05446       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05447}05447         start\_index[0] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05448}05448       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05449}05449     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05450}05450 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05451}05451     \textcolor{comment}{// Storage for all root haloed elements from the various processors, one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05452}05452     \textcolor{comment}{// after the other, with some padding from negative entries to avoid}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05453}05453     \textcolor{comment}{// zero length vectors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05454}05454     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} all\_root\_haloed\_element(total\_number\_of\_root\_haloed\_elements,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05455}05455                                         0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05456}05456 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05457}05457     \textcolor{comment}{// Now send the ids of the relevant elements via gatherv}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05458}05458     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 0; p < n\_proc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05459}05459     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05460}05460       \textcolor{comment}{// Gather the p-\/th entries in nhalo from every processor on}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05461}05461       \textcolor{comment}{// processor p and store them in nhaloed consecutively}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05462}05462       \textcolor{comment}{// starting at beginning}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05463}05463       MPI\_Gatherv(\&root\_halo\_element[p][0], \textcolor{comment}{// pointer to first entry in vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05464}05464                                             \textcolor{comment}{// to be gathered on processor p}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05465}05465                   nhalo[p], \textcolor{comment}{// Number of entries to be sent}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05466}05466                   MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05467}05467                   \&all\_root\_haloed\_element[0], \textcolor{comment}{// Target -\/-\/ this will store}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05468}05468                                                \textcolor{comment}{// the element numbers of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05469}05469                                                \textcolor{comment}{// all root haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05470}05470                                                \textcolor{comment}{// received from other processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05471}05471                                                \textcolor{comment}{// in order}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05472}05472                   \&nhaloed[0], \textcolor{comment}{// Pointer to the vector containing the lengths}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05473}05473                                \textcolor{comment}{// of the vectors received from elsewhere}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05474}05474                   \&start\_index[0], \textcolor{comment}{// "{}offset"{} for storage of vector received}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05475}05475                                    \textcolor{comment}{// from various processors in the global}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05476}05476                                    \textcolor{comment}{// concatenated vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05477}05477                   MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05478}05478                   p, \textcolor{comment}{// processor that gathers the information}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05479}05479                   comm\_pt-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05480}05480     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05481}05481 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05482}05482 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05483}05483     \textcolor{comment}{// Determine root haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05484}05484     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05485}05485 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05486}05486     \textcolor{comment}{// Loop over all other processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05487}05487     \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05488}05488     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05489}05489     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05490}05490 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05491}05491       std::map<unsigned, bool> done;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05492}05492 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05493}05493 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05494}05494       \textcolor{comment}{// Loop over root haloed elements with specified processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05495}05495       \textcolor{keywordtype}{unsigned} n = nhaloed[d];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05496}05496       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05497}05497       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05498}05498         \textcolor{keywordtype}{int} number = all\_root\_haloed\_element[count];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05499}05499         count++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05500}05500 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05501}05501         \textcolor{comment}{// Ignore padded -\/1s that were only inserted to avoid}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05502}05502         \textcolor{comment}{// zero sized vectors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05503}05503         \textcolor{keywordflow}{if} (number >= 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05504}05504         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05505}05505           \textcolor{comment}{// Get pointer to element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05506}05506           \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = backed\_up\_el\_pt[number];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05507}05507 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05508}05508           \textcolor{comment}{// Halo elements can't be haloed themselves}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05509}05509           \textcolor{keywordflow}{if} (!el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05510}05510           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05511}05511 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05512}05512             \textcolor{keywordflow}{if} (done[number])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05513}05513             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05514}05514               std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05515}05515               error\_message << \textcolor{stringliteral}{"{}Have already added element "{}} << number}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05516}05516                             << \textcolor{stringliteral}{"{} as root haloed element\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05517}05517                             << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05518}05518               \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05519}05519                                   OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05520}05520                                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05521}05521             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05522}05522             done[number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05523}05523 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05524}05524 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05525}05525             \textcolor{comment}{// Current element is haloed by other processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05526}05526             this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a5ad406db29df11b70df0f497817cc24f}{add\_root\_haloed\_element\_pt}}(d, el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05527}05527           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05528}05528         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05529}05529       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05530}05530     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05531}05531 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05532}05532 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05533}05533     \textcolor{comment}{// Doc stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05534}05534     \textcolor{keywordflow}{if} (report\_stats)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05535}05535     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05536}05536       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Processor "{}} << my\_rank << \textcolor{stringliteral}{"{} holds "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05537}05537                  << \textcolor{stringliteral}{"{} elements of which "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_afeb339ee6659e611aee6b0d6fed99c9a}{nroot\_halo\_element}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05538}05538                  << \textcolor{stringliteral}{"{} are root halo elements \(\backslash\)n while "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05539}05539                  << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9892d5aa82024c973b021cf6c49356a9}{nroot\_haloed\_element}}() << \textcolor{stringliteral}{"{} are root haloed elements"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05540}05540                  << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05541}05541     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05542}05542 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05543}05543 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05544}05544     \textcolor{comment}{// Loop over all retained elements and mark their nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05545}05545     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05546}05546     \textcolor{comment}{// as to be retained too (some double counting going on here)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05547}05547     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05548}05548     nelem = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05549}05549     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05550}05550     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05551}05551       \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* f\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05552}05552         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05553}05553 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05554}05554       \textcolor{comment}{// If we have a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05555}05555       \textcolor{keywordflow}{if} (f\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05556}05556       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05557}05557         \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05558}05558         \textcolor{keywordtype}{unsigned} nnod = f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05559}05559         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05560}05560         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05561}05561           Node* nod\_pt = f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05562}05562           nod\_pt-\/>set\_non\_obsolete();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05563}05563         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05564}05564       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05565}05565     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05566}05566 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05567}05567 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05568}05568     \textcolor{comment}{// Now remove the pruned nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05569}05569     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac9f58929371a3f39dd646d2756547ad2}{prune\_dead\_nodes}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05570}05570 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05571}05571 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05572}05572 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_TRIANGLE\_LIB}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05573}05573     \textcolor{keywordflow}{if} (is\_a\_triangle\_mesh\_base\_mesh)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05574}05574     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05575}05575       triangle\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TriangleMeshBase_adbb7621302c427dfc55dbc1ee2b7e77b}{reset\_boundary\_element\_info}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05576}05576         ntmp\_boundary\_elements,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05577}05577         ntmp\_boundary\_elements\_in\_region,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05578}05578         deleted\_f\_element\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05579}05579     \} \textcolor{comment}{// if (tri\_mesh\_pt!=0)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05580}05580     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05581}05581     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05582}05582 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// \#ifdef OOMPH\_HAS\_TRIANGLE\_LIB}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05583}05583 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05584}05584       \textcolor{comment}{// Temporarly set the mesh as distributed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05585}05585       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a6cc8bcd6b41209f0e9295cc993d9c6bb}{setup\_boundary\_element\_info}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05586}05586 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05587}05587 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_TRIANGLE\_LIB}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05588}05588     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05589}05589 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05590}05590 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05591}05591     \textcolor{comment}{// Re-\/setup tree forest. (Call this every time even if}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05592}05592     \textcolor{comment}{// a (distributed) mesh has no elements on this processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05593}05593     \textcolor{comment}{// We still need to participate in communication.)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05594}05594     \mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}* ref\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05595}05595       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05596}05596     \textcolor{keywordflow}{if} (ref\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05597}05597     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05598}05598       ref\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_aab7cbaa680b2258f2b1eea5de6bbe605}{setup\_tree\_forest}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05599}05599     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05600}05600 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05601}05601     \textcolor{comment}{// Classify nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05602}05602     \mbox{\hyperlink{classoomph_1_1Mesh_a595cfa652d75d9fbfc72a8252fe6782e}{classify\_halo\_and\_haloed\_nodes}}(doc\_info, report\_stats);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05603}05603 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05604}05604     \textcolor{comment}{// Doc?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05605}05605     \textcolor{comment}{//-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05606}05606     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05607}05607     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05608}05608       \mbox{\hyperlink{classoomph_1_1Mesh_ac709c75770886514e2d38c2c7cb74f72}{doc\_mesh\_distribution}}(doc\_info);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05609}05609     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05610}05610   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05611}05611 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05612}05612 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05613}05613   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05614}05614 \textcolor{comment}{  /// (Irreversibly) prune halo(ed) elements and nodes, usually}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05615}05615 \textcolor{comment}{  /// after another round of refinement, to get rid of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05616}05616 \textcolor{comment}{  /// excessively wide halo layers. Note that the current}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05617}05617 \textcolor{comment}{  /// mesh will be now regarded as the base mesh and no unrefinement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05618}05618 \textcolor{comment}{  /// relative to it will be possible once this function}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05619}05619 \textcolor{comment}{  /// has been called.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05620}05620 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05621}\mbox{\hyperlink{classoomph_1_1Mesh_a7fbff473ec9b120d97a4e4f9d56c7950}{05621}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a80f2372d3d0847d26030df88204acebe}{Mesh::prune\_halo\_elements\_and\_nodes}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05622}05622     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}}\& deleted\_element\_pt,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05623}05623     \mbox{\hyperlink{classoomph_1_1DocInfo}{DocInfo}}\& doc\_info,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05624}05624     \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& report\_stats)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05625}05625   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05626}05626     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}at start of mesh-\/level prunes"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05627}05627 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05628}05628 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05629}05629 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05630}05630     \textcolor{comment}{// Delete any external element storage before performing the redistribution}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05631}05631     \textcolor{comment}{// (in particular, external halo nodes that are on mesh boundaries)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05632}05632     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9e3ecb07dc622cf37ce0085446ff9aa6}{delete\_all\_external\_storage}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05633}05633 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05634}05634 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05635}05635     \mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}* ref\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05636}05636       \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05637}05637     \textcolor{keywordflow}{if} (ref\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05638}05638     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05639}05639       \textcolor{comment}{// Storage for number of processors and current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05640}05640       \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05641}05641       \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05642}05642 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05643}05643       \textcolor{comment}{// Doc stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05644}05644       \textcolor{keywordflow}{if} (report\_stats)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05645}05645       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05646}05646         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05647}05647           << \textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05648}05648         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Before pruning: Processor "{}} << my\_rank << \textcolor{stringliteral}{"{} holds "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05649}05649                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}() << \textcolor{stringliteral}{"{} elements of which "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05650}05650                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_afeb339ee6659e611aee6b0d6fed99c9a}{nroot\_halo\_element}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05651}05651                    << \textcolor{stringliteral}{"{} are root halo elements \(\backslash\)n while "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05652}05652                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9892d5aa82024c973b021cf6c49356a9}{nroot\_haloed\_element}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05653}05653                    << \textcolor{stringliteral}{"{} are root haloed elements"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05654}05654 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05655}05655         \textcolor{comment}{// Report total number of halo(ed) and shared nodes for this process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05656}05656         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Before pruning: Processor "{}} << my\_rank << \textcolor{stringliteral}{"{} holds "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05657}05657                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}() << \textcolor{stringliteral}{"{} nodes of which "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05658}05658                    << \textcolor{stringliteral}{"{} are halo nodes \(\backslash\)n while "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05659}05659                    << \textcolor{stringliteral}{"{} are haloed nodes, and "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05660}05660                    << \textcolor{stringliteral}{"{} are shared nodes."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05661}05661 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05662}05662         \textcolor{comment}{// Report number of halo(ed) and shared nodes with each domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05663}05663         \textcolor{comment}{// from the current process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05664}05664         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} iproc = 0; iproc < n\_proc; iproc++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05665}05665         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05666}05666           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Before pruning: With process "{}} << iproc}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05667}05667                      << \textcolor{stringliteral}{"{}, there are "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(iproc)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05668}05668                      << \textcolor{stringliteral}{"{} halo nodes, and "{}} << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05669}05669                      << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(iproc) << \textcolor{stringliteral}{"{} haloed nodes, and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05670}05670                      << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(iproc) << \textcolor{stringliteral}{"{} shared nodes"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05671}05671                      << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05672}05672         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05673}05673         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05674}05674           << \textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05675}05675       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05676}05676 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05677}05677 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05678}05678       \textcolor{keywordtype}{double} t\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05679}05679       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05680}05680       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05681}05681         t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05682}05682       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05683}05683 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05684}05684       \textcolor{comment}{// Declare all nodes as obsolete. We'll}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05685}05685       \textcolor{comment}{// change this setting for all nodes that must be retained}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05686}05686       \textcolor{comment}{// further down}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05687}05687       \textcolor{keywordtype}{unsigned} nnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05688}05688       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05689}05689       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05690}05690         this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j)-\/>set\_obsolete();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05691}05691       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05692}05692 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05693}05693       \textcolor{comment}{// Backup pointers to elements in this mesh (they must be finite elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05694}05694       \textcolor{comment}{// beacuse it's a refineable mesh)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05695}05695       \textcolor{keywordtype}{unsigned} nelem = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05696}05696       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<FiniteElement*>}} backed\_up\_el\_pt(nelem);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05697}05697       std::map<RefineableElement*, bool> keep\_element;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05698}05698       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05699}05699       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05700}05700         backed\_up\_el\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05701}05701       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05702}05702 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05703}05703       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after backed up elements"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05704}05704 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05705}05705       \textcolor{comment}{// Get the min and max refinement level, and current refinement pattern}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05706}05706       \textcolor{keywordtype}{unsigned} min\_ref = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05707}05707       \textcolor{keywordtype}{unsigned} max\_ref = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05708}05708 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05709}05709       \textcolor{comment}{// Get min and max refinement level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05710}05710       \textcolor{keywordtype}{unsigned} local\_min\_ref = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05711}05711       \textcolor{keywordtype}{unsigned} local\_max\_ref = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05712}05712       ref\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_a937e4321288b6642d5057498f7659d76}{get\_refinement\_levels}}(local\_min\_ref, local\_max\_ref);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05713}05713 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05714}05714       \textcolor{comment}{// Reconcile between processors: If (e.g. following distribution/pruning)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05715}05715       \textcolor{comment}{// the mesh has no elements on this processor) then ignore its}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05716}05716       \textcolor{comment}{// contribution to the poll of max/min refinement levels}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05717}05717       \textcolor{keywordtype}{int} int\_local\_min\_ref = local\_min\_ref;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05718}05718       \textcolor{keywordtype}{int} int\_local\_max\_ref = local\_max\_ref;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05719}05719 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05720}05720       \textcolor{keywordflow}{if} (nelem == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05721}05721       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05722}05722         int\_local\_min\_ref = INT\_MAX;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05723}05723         int\_local\_max\_ref = INT\_MIN;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05724}05724       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05725}05725 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05726}05726       \textcolor{keywordtype}{int} int\_min\_ref = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05727}05727       \textcolor{keywordtype}{int} int\_max\_ref = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05728}05728 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05729}05729       MPI\_Allreduce(\&int\_local\_min\_ref,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05730}05730                     \&int\_min\_ref,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05731}05731                     1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05732}05732                     MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05733}05733                     MPI\_MIN,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05734}05734                     \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05735}05735       MPI\_Allreduce(\&int\_local\_max\_ref,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05736}05736                     \&int\_max\_ref,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05737}05737                     1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05738}05738                     MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05739}05739                     MPI\_MAX,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05740}05740                     \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05741}05741 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05742}05742       min\_ref = unsigned(int\_min\_ref);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05743}05743       max\_ref = unsigned(int\_max\_ref);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05744}05744 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05745}05745       \textcolor{comment}{// Get refinement pattern}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05746}05746       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Vector<unsigned>}}> current\_refined;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05747}05747       ref\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_a6dba989c0d0735d8fe34ceb231425401}{get\_refinement\_pattern}}(current\_refined);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05748}05748 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05749}05749       \textcolor{comment}{// get\_refinement\_pattern refers to the elements at each level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05750}05750       \textcolor{comment}{// that were refined when proceeding to the next level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05751}05751       \textcolor{keywordtype}{int} local\_n\_ref = current\_refined.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05752}05752 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05753}05753       \textcolor{comment}{// Bypass if no elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05754}05754       \textcolor{keywordflow}{if} (nelem == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05755}05755       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05756}05756         local\_n\_ref = INT\_MIN;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05757}05757       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05758}05758 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05759}05759       \textcolor{comment}{// Reconcile between processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05760}05760       \textcolor{keywordtype}{int} int\_n\_ref = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05761}05761       MPI\_Allreduce(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05762}05762         \&local\_n\_ref, \&int\_n\_ref, 1, MPI\_INT, MPI\_MAX, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05763}05763       \textcolor{keywordtype}{unsigned} n\_ref = int(int\_n\_ref);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05764}05764 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05765}05765 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05766}05766       \textcolor{keywordtype}{double} t\_end = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05767}05767       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05768}05768       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05769}05769         t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05770}05770         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05771}05771           << \textcolor{stringliteral}{"{}Time for establishing refinement levels in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05772}05772           << \textcolor{stringliteral}{"{} Mesh::prune\_halo\_elements\_and\_nodes() [includes comms]: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05773}05773           << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05774}05774         t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05775}05775       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05776}05776 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05777}05777       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after establishing refinement levels"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05778}05778 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05779}05779       \textcolor{comment}{// Bypass everything until next comms if no elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05780}05780       \textcolor{keywordflow}{if} (nelem > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05781}05781       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05782}05782         \textcolor{comment}{// Loop over all elements; keep those on the min refinement level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05783}05783         \textcolor{comment}{// Need to go back to the level indicated by min\_ref}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05784}05784         \textcolor{keywordtype}{unsigned} base\_level = n\_ref -\/ (max\_ref -\/ min\_ref);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05785}05785 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05786}05786         \textcolor{comment}{// This is the new minimum uniform refinement level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05787}05787         \textcolor{comment}{// relative to total unrefined base mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05788}05788         ref\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_a1ee27bd5bd3c2eded38103b9161af719}{uniform\_refinement\_level\_when\_pruned}}() = min\_ref;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05789}05789 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05790}05790         \textcolor{comment}{// Get the elements at the specified "{}base"{} refinement level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05791}05791         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<RefineableElement*>}} base\_level\_elements\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05792}05792         ref\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_a0d5d1cfce0db7953c21eef213049c433}{get\_elements\_at\_refinement\_level}}(base\_level,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05793}05793                                                       base\_level\_elements\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05794}05794 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05795}05795         \textcolor{comment}{// Loop over the elements at this level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05796}05796         \textcolor{keywordtype}{unsigned} n\_base\_el = base\_level\_elements\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05797}05797         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_base\_el; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05798}05798         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05799}05799           \textcolor{comment}{// Extract correct element...}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05800}05800           \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt = base\_level\_elements\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05801}05801 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05802}05802 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05803}05803           \textcolor{comment}{// Check it exists}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05804}05804           \textcolor{keywordflow}{if} (ref\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05805}05805           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05806}05806             \textcolor{comment}{// Keep all non-\/halo elements, remove excess halos}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05807}05807             \textcolor{keywordflow}{if} ((!ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}()) || (ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a6bfd80be22c82459b6029ca1202c8f36}{must\_be\_kept\_as\_halo}}()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05808}05808             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05809}05809               keep\_element[ref\_el\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05810}05810 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05811}05811               \textcolor{comment}{// Loop over this non-\/halo element's nodes and retain them too}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05812}05812               \textcolor{keywordtype}{unsigned} nnod = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05813}05813               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05814}05814               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05815}05815                 ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>set\_non\_obsolete();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05816}05816               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05817}05817             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05818}05818           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05819}05819 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05820}05820         \} \textcolor{comment}{// end loop over base level elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05821}05821       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05822}05822 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05823}05823       \textcolor{comment}{// Synchronise refinement level when pruned over all meshes even if they}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05824}05824       \textcolor{comment}{// were empty (in which case the uniform refinement level is still zero}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05825}05825       \textcolor{comment}{// so go for max}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05826}05826       \textcolor{keywordtype}{unsigned} n\_unif = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05827}05827       \textcolor{keywordtype}{unsigned} n\_unif\_local =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05828}05828         ref\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_a1ee27bd5bd3c2eded38103b9161af719}{uniform\_refinement\_level\_when\_pruned}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05829}05829       MPI\_Allreduce(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05830}05830         \&n\_unif\_local, \&n\_unif, 1, MPI\_UNSIGNED, MPI\_MAX, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05831}05831       ref\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_a1ee27bd5bd3c2eded38103b9161af719}{uniform\_refinement\_level\_when\_pruned}}() = n\_unif;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05832}05832 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05833}05833 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05834}05834       t\_end = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05835}05835       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05836}05836       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05837}05837         t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05838}05838         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05839}05839           << \textcolor{stringliteral}{"{}Time for synchronising refinement levels in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05840}05840           << \textcolor{stringliteral}{"{} Mesh::prune\_halo\_elements\_and\_nodes() [includes comms]: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05841}05841           << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05842}05842         t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05843}05843       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05844}05844 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05845}05845 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05846}05846       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after synchronising refinement levels"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05847}05847 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05848}05848 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05849}05849       \textcolor{comment}{// Now work on which "{}root"{} halo elements to keep at this level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05850}05850       \textcolor{comment}{// Can't use the current set directly; however,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05851}05851       \textcolor{comment}{// we know the refinement level of the current halo, so}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05852}05852       \textcolor{comment}{// it is possible to go from that backwards to find the "{}father}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05853}05853       \textcolor{comment}{// halo element"{} necessary to complete this step}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05854}05854 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05855}05855       \textcolor{comment}{// Temp map of vectors holding the pointers to the root halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05856}05856       std::map<unsigned, Vector<FiniteElement*>> tmp\_root\_halo\_element\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05857}05857 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05858}05858       \textcolor{comment}{// Temp map of vectors holding the pointers to the root haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05859}05859       std::map<unsigned, Vector<FiniteElement*>> tmp\_root\_haloed\_element\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05860}05860 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05861}05861       \textcolor{comment}{// Make sure we only push back each element once}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05862}05862       std::map<unsigned, std::map<FiniteElement*, bool>>}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05863}05863         tmp\_root\_halo\_element\_is\_retained;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05864}05864 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05865}05865       \textcolor{comment}{// Map to store if a halo element survives}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05866}05866       std::map<FiniteElement*, bool> halo\_element\_is\_retained;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05867}05867 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05868}05868       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05869}05869       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05870}05870         \textcolor{comment}{// Get vector of halo elements with processor domain by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05871}05871         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(domain));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05872}05872 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05873}05873         \textcolor{comment}{// Loop over halo elements associated with this adjacent domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05874}05874         \textcolor{keywordtype}{unsigned} nelem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05875}05875         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05876}05876         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05877}05877           \textcolor{comment}{// Get element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05878}05878           \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05879}05879             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05880}05880 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05881}05881           \textcolor{comment}{// An element should only be kept if its refinement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05882}05882           \textcolor{comment}{// level is the same as the minimum refinement level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05883}05883           \textcolor{keywordtype}{unsigned} halo\_el\_level = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a6b9153d7933baf6092febaca278a6fc7}{refinement\_level}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05884}05884 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05885}05885           \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05886}05886           \textcolor{keywordflow}{if} (halo\_el\_level == min\_ref)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05887}05887           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05888}05888             \textcolor{comment}{// Already at the correct level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05889}05889             el\_pt = ref\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05890}05890           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05891}05891           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05892}05892           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05893}05893             \textcolor{comment}{// Need to go up the tree to the father element at min\_ref}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05894}05894             \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* father\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05895}05895             ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a6ade15684ccece690c3ba8aebcc02797}{get\_father\_at\_refinement\_level}}(min\_ref, father\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05896}05896             el\_pt = father\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05897}05897           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05898}05898 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05899}05899           \textcolor{comment}{// Now loop over nodes in the halo element and retain it as}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05900}05900           \textcolor{comment}{// halo element if any of it's nodes are shared with one of the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05901}05901           \textcolor{comment}{// non-\/halo-\/elements that we've already identified earlier -\/-\/ these}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05902}05902           \textcolor{comment}{// were set to non-\/obsolete above.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05903}05903           \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05904}05904           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05905}05905           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05906}05906             \textcolor{comment}{// Node has been reclaimed by one of the non-\/halo elements above}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05907}05907             Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05908}05908             \textcolor{keywordflow}{if} (!nod\_pt-\/>is\_obsolete())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05909}05909             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05910}05910               \textcolor{comment}{// Keep element and add it to preliminary storage for}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05911}05911               \textcolor{comment}{// halo elements associated with current neighbouring domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05912}05912               \textcolor{keywordflow}{if} (!tmp\_root\_halo\_element\_is\_retained[domain][el\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05913}05913               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05914}05914                 tmp\_root\_halo\_element\_pt[domain].push\_back(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05915}05915                 tmp\_root\_halo\_element\_is\_retained[domain][el\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05916}05916               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05917}05917               keep\_element[el\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05918}05918               halo\_element\_is\_retained[el\_pt] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05919}05919               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05920}05920             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05921}05921           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05922}05922         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05923}05923       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05924}05924 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05925}05925       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05926}05926       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05927}05927         t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05928}05928         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for setup of retention pattern in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05929}05929                    << \textcolor{stringliteral}{"{} Mesh::prune\_halo\_elements\_and\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05930}05930                    << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05931}05931         t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05932}05932       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05933}05933 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05934}05934       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after setup of retention pattern"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05935}05935 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05936}05936       \textcolor{comment}{// Make sure everybody finishes this part}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05937}05937       MPI\_Barrier(\mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05938}05938 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05939}05939       \textcolor{comment}{// Now all processors have decided (independently) which of their}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05940}05940       \textcolor{comment}{// (to-\/be root) halo elements they wish to retain. Now we need to figure}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05941}05941       \textcolor{comment}{// out which of their elements are haloed and add them in the appropriate}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05942}05942       \textcolor{comment}{// order into the haloed element scheme. For this we exploit that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05943}05943       \textcolor{comment}{// the halo and haloed elements are accessed in the same order on}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05944}05944       \textcolor{comment}{// all processors!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05945}05945 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05946}05946       \textcolor{comment}{// Identify haloed elements on domain d}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05947}05947       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05948}05948       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05949}05949         \textcolor{comment}{// Loop over domains that halo this domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05950}05950         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05951}05951         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05952}05952           \textcolor{comment}{// Dont't talk to yourself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05953}05953           \textcolor{keywordflow}{if} (d != dd)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05954}05954           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05955}05955             \textcolor{comment}{// If we're identifying my haloed elements:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05956}05956             \textcolor{keywordflow}{if} (d == my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05957}05957             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05958}05958               \textcolor{comment}{// Get vector all elements that are currently haloed by domain dd}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05959}05959               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05960}05960                 this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(dd));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05961}05961 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05962}05962               \textcolor{comment}{// Create a vector of ints to indicate if the halo element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05963}05963               \textcolor{comment}{// on processor dd processor was kept}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05964}05964               \textcolor{keywordtype}{unsigned} nelem = haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05965}05965               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} halo\_kept(nelem);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05966}05966 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05967}05967               \textcolor{comment}{// Receive this vector from processor dd}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05968}05968               \textcolor{keywordflow}{if} (nelem != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05969}05969               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05970}05970                 MPI\_Status status;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05971}05971                 MPI\_Recv(\&halo\_kept[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05972}05972                          nelem,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05973}05973                          MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05974}05974                          dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05975}05975                          0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05976}05976                          \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05977}05977                          \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05978}05978 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05979}05979                 \textcolor{comment}{// Classify haloed element accordingly}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05980}05980                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05981}05981                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05982}05982                   \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05983}05983                     \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05984}05984 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05985}05985                   \textcolor{comment}{// An element should only be kept if its refinement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05986}05986                   \textcolor{comment}{// level is the same as the minimum refinement level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05987}05987                   \textcolor{keywordtype}{unsigned} haloed\_el\_level = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a6b9153d7933baf6092febaca278a6fc7}{refinement\_level}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05988}05988 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05989}05989                   \textcolor{comment}{// Go up the tree to the correct level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05990}05990                   \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05991}05991 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05992}05992                   \textcolor{keywordflow}{if} (haloed\_el\_level == min\_ref)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05993}05993                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05994}05994                     \textcolor{comment}{// Already at the correct level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05995}05995                     el\_pt = ref\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05996}05996                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05997}05997                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05998}05998                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l05999}05999                     \textcolor{comment}{// Need to go up the tree to the father element at min\_ref}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06000}06000                     \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* father\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06001}06001                     ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a6ade15684ccece690c3ba8aebcc02797}{get\_father\_at\_refinement\_level}}(min\_ref,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06002}06002                                                               father\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06003}06003                     el\_pt = father\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06004}06004                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06005}06005 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06006}06006                   \textcolor{keywordflow}{if} (halo\_kept[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] == 1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06007}06007                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06008}06008                     \textcolor{comment}{// I am being haloed by processor dd}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06009}06009                     \textcolor{comment}{// Only keep it if it's not already in the storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06010}06010                     \textcolor{keywordtype}{bool} already\_root\_haloed = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06011}06011                     \textcolor{keywordtype}{unsigned} n\_root\_haloed =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06012}06012                       tmp\_root\_haloed\_element\_pt[dd].\mbox{\hyperlink{classoomph_1_1FiniteElement_a4986a443968d3741fde4d6c6012cd586}{size}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06013}06013                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e\_root = 0; e\_root < n\_root\_haloed; e\_root++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06014}06014                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06015}06015                       \textcolor{keywordflow}{if} (el\_pt == tmp\_root\_haloed\_element\_pt[dd][e\_root])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06016}06016                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06017}06017                         already\_root\_haloed = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06018}06018                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06019}06019                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06020}06020                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06021}06021                     \textcolor{keywordflow}{if} (!already\_root\_haloed)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06022}06022                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06023}06023                       tmp\_root\_haloed\_element\_pt[dd].push\_back(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06024}06024                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06025}06025                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06026}06026                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06027}06027               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06028}06028             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06029}06029             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06030}06030             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06031}06031               \textcolor{comment}{// If we're dealing with my halo elements:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06032}06032               \textcolor{keywordflow}{if} (dd == my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06033}06033               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06034}06034                 \textcolor{comment}{// Find (current) halo elements on processor dd whose non-\/halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06035}06035                 \textcolor{comment}{// is on processor d}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06036}06036                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06037}06037                   this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06038}06038 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06039}06039                 \textcolor{comment}{// Create a vector of ints to indicate if the halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06040}06040                 \textcolor{comment}{// element was kept}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06041}06041                 \textcolor{keywordtype}{unsigned} nelem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06042}06042                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} halo\_kept(nelem, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06043}06043                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06044}06044                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06045}06045                   \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06046}06046                     \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06047}06047 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06048}06048                   \textcolor{comment}{// An element should only be kept if its refinement}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06049}06049                   \textcolor{comment}{// level is the same as the minimum refinement level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06050}06050                   \textcolor{keywordtype}{unsigned} halo\_el\_level = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a6b9153d7933baf6092febaca278a6fc7}{refinement\_level}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06051}06051 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06052}06052                   \textcolor{comment}{// Go up the tree to the correct level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06053}06053                   \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06054}06054                   \textcolor{keywordflow}{if} (halo\_el\_level == min\_ref)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06055}06055                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06056}06056                     \textcolor{comment}{// Already at the correct level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06057}06057                     el\_pt = ref\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06058}06058                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06059}06059                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06060}06060                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06061}06061                     \textcolor{comment}{// Need to go up the tree to the father element at min\_ref}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06062}06062                     \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* father\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06063}06063                     ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a6ade15684ccece690c3ba8aebcc02797}{get\_father\_at\_refinement\_level}}(min\_ref,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06064}06064                                                               father\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06065}06065                     el\_pt = father\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06066}06066                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06067}06067 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06068}06068                   \textcolor{keywordflow}{if} (halo\_element\_is\_retained[el\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06069}06069                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06070}06070                     halo\_kept[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}] = 1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06071}06071                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06072}06072                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06073}06073 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06074}06074                 \textcolor{comment}{// Now send this vector to processor d to tell it which of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06075}06075                 \textcolor{comment}{// the haloed elements (which are listed in the same order)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06076}06076                 \textcolor{comment}{// are to be retained as haloed elements.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06077}06077                 \textcolor{keywordflow}{if} (nelem != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06078}06078                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06079}06079                   MPI\_Send(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06080}06080                     \&halo\_kept[0], nelem, MPI\_INT, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06081}06081                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06082}06082               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06083}06083             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06084}06084           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06085}06085         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06086}06086       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06087}06087 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06088}06088       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06089}06089       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06090}06090         t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06091}06091         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for pt2pt comms of retention pattern in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06092}06092                    << \textcolor{stringliteral}{"{} Mesh::prune\_halo\_elements\_and\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06093}06093                    << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06094}06094         t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06095}06095       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06096}06096 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06097}06097       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after pt2pt comms of retention}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06098}06098       \textcolor{comment}{// pattern"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06099}06099 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06100}06100 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06101}06101       \textcolor{comment}{// Backup pointers to nodes in this mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06102}06102       nnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06103}06103       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} backed\_up\_nod\_pt(nnod);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06104}06104       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06105}06105       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06106}06106         backed\_up\_nod\_pt[j] = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06107}06107       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06108}06108 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06109}06109       \textcolor{comment}{// Flush the mesh storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06110}06110       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a38446e721be2f75a64fdaa025b7c23ad}{flush\_element\_and\_node\_storage}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06111}06111 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06112}06112       \textcolor{comment}{// Storage for non-\/active trees/elements that are to be deleted}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06113}06113       std::set<Tree*> trees\_to\_be\_deleted\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06114}06114 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06115}06115       \textcolor{comment}{// Loop over all backed-\/up elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06116}06116       nelem = backed\_up\_el\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06117}06117       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06118}06118       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06119}06119         \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06120}06120           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(backed\_up\_el\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06121}06121 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06122}06122         \textcolor{comment}{// Get refinement level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06123}06123         \textcolor{keywordtype}{unsigned} level = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a6b9153d7933baf6092febaca278a6fc7}{refinement\_level}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06124}06124 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06125}06125         \textcolor{comment}{// Go up the tree to the correct level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06126}06126         \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06127}06127 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06128}06128         \textcolor{keywordflow}{if} (level == min\_ref)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06129}06129         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06130}06130           \textcolor{comment}{// Already at the correct level}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06131}06131           el\_pt = ref\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06132}06132         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06133}06133         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06134}06134         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06135}06135           \textcolor{comment}{// Need to go up the tree to the father element at min\_ref}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06136}06136           \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* father\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06137}06137           ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a6ade15684ccece690c3ba8aebcc02797}{get\_father\_at\_refinement\_level}}(min\_ref, father\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06138}06138           el\_pt = father\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06139}06139         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06140}06140 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06141}06141         \textcolor{comment}{// If the base element is going to be kept, then add the current element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06142}06142         \textcolor{comment}{// to the "{}new"{} mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06143}06143         \textcolor{keywordflow}{if} (keep\_element[el\_pt])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06144}06144         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06145}06145           this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aafc35b5df26c448b5d5ab26a793eee35}{add\_element\_pt}}(ref\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06146}06146         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06147}06147         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06148}06148         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06149}06149           \textcolor{comment}{// Flush the object attached to the tree for this element?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06150}06150           \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* my\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06151}06151             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(ref\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06152}06152           \textcolor{keywordflow}{if} (my\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06153}06153           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06154}06154             my\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a4b783f4e5b6aeed83d49e478510d614f}{tree\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Tree_a96a95bd9942e906fde87194845a1868c}{flush\_object}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06155}06155           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06156}06156 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06157}06157           \textcolor{comment}{// Get associated tree root}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06158}06158           \mbox{\hyperlink{classoomph_1_1Tree}{Tree}}* tmp\_tree\_root\_pt = my\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a4b783f4e5b6aeed83d49e478510d614f}{tree\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Tree_a33b9926754cddfaafd9869af3fe266e7}{root\_pt}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06159}06159 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06160}06160           \textcolor{comment}{// Get all the tree nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06161}06161           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Tree*>}} tmp\_all\_tree\_nodes\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06162}06162           tmp\_tree\_root\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a2c84b4e4700a825ef0a6ca533b9ae895}{stick\_all\_tree\_nodes\_into\_vector}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06163}06163             tmp\_all\_tree\_nodes\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06164}06164 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06165}06165           \textcolor{comment}{// Loop over all of them and delete associated object/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06166}06166           \textcolor{comment}{// and flush any record of it in tree}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06167}06167           \textcolor{keywordtype}{unsigned} n\_tree = tmp\_all\_tree\_nodes\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06168}06168           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_tree; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06169}06169           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06170}06170             \textcolor{keywordflow}{if} (tmp\_all\_tree\_nodes\_pt[j]-\/>object\_pt() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06171}06171             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06172}06172               \textcolor{keywordtype}{unsigned} lev =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06173}06173                 tmp\_all\_tree\_nodes\_pt[j]-\/>object\_pt()-\/>refinement\_level();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06174}06174               \textcolor{keywordflow}{if} (lev <= min\_ref)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06175}06175               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06176}06176                 \textcolor{keywordflow}{if} (!keep\_element[tmp\_all\_tree\_nodes\_pt[j]-\/>object\_pt()])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06177}06177                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06178}06178                   trees\_to\_be\_deleted\_pt.insert(tmp\_all\_tree\_nodes\_pt[j]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06179}06179                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06180}06180               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06181}06181             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06182}06182           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06183}06183 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06184}06184           \textcolor{comment}{// Delete the element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06185}06185           deleted\_element\_pt.push\_back(ref\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06186}06186           \textcolor{keyword}{delete} ref\_el\_pt;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06187}06187         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06188}06188       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06189}06189 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06190}06190       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}before deleting superfluous elements"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06191}06191 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06192}06192       \textcolor{comment}{// Delete superfluous elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06193}06193       \textcolor{keywordflow}{for} (std::set<Tree*>::iterator it = trees\_to\_be\_deleted\_pt.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06194}06194            it != trees\_to\_be\_deleted\_pt.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06195}06195            it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06196}06196       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06197}06197         \mbox{\hyperlink{classoomph_1_1Tree}{Tree}}* tree\_pt = (*it);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06198}06198         \textcolor{keywordflow}{if} (tree\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}() != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06199}06199         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06200}06200           deleted\_element\_pt.push\_back(tree\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06201}06201           \textcolor{keyword}{delete} tree\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a7d630dad19ef861ab6a5f37ad6ea67f4}{object\_pt}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06202}06202           tree\_pt-\/>\mbox{\hyperlink{classoomph_1_1Tree_a96a95bd9942e906fde87194845a1868c}{flush\_object}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06203}06203         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06204}06204       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06205}06205 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06206}06206       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after deleting superfluous elements"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06207}06207 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06208}06208 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06209}06209       \textcolor{comment}{// Wipe the storage scheme for (root) halo(ed) elements and then re-\/assign}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06210}06210       \mbox{\hyperlink{classoomph_1_1Mesh_a205ef660e5763d553053075a254db2a7}{Root\_haloed\_element\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06211}06211       \mbox{\hyperlink{classoomph_1_1Mesh_a6e01d05056ce7e2d38eb66a7af8d9174}{Root\_halo\_element\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06212}06212       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06213}06213       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06214}06214         \textcolor{keywordtype}{unsigned} nelem = tmp\_root\_halo\_element\_pt[domain].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06215}06215         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06216}06216         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06217}06217           \mbox{\hyperlink{classoomph_1_1Mesh_a6e01d05056ce7e2d38eb66a7af8d9174}{Root\_halo\_element\_pt}}[domain].push\_back(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06218}06218             tmp\_root\_halo\_element\_pt[domain][\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06219}06219         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06220}06220 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06221}06221         nelem = tmp\_root\_haloed\_element\_pt[domain].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06222}06222         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06223}06223         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06224}06224           \mbox{\hyperlink{classoomph_1_1Mesh_a205ef660e5763d553053075a254db2a7}{Root\_haloed\_element\_pt}}[domain].push\_back(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06225}06225             tmp\_root\_haloed\_element\_pt[domain][\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06226}06226         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06227}06227       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06228}06228 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06229}06229       \textcolor{comment}{//    MemoryUsage::doc\_memory\_usage(}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06230}06230       \textcolor{comment}{//     "{}after wiping storage scheme for root halo/ed els"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06231}06231 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06232}06232       \textcolor{comment}{// Loop over all retained elements at this level and mark their nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06233}06233       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06234}06234       \textcolor{comment}{// as to be retained too (some double counting going on here)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06235}06235       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06236}06236       nelem = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06237}06237       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06238}06238       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06239}06239         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* el\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06240}06240 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06241}06241         \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06242}06242         \textcolor{keywordtype}{unsigned} nnod = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06243}06243         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06244}06244         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06245}06245           Node* nod\_pt = el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06246}06246           nod\_pt-\/>set\_non\_obsolete();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06247}06247         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06248}06248       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06249}06249 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06250}06250       \textcolor{comment}{// Complete rebuild of mesh by adding retained nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06251}06251       \textcolor{comment}{// Note that they are added in the order in which they}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06252}06252       \textcolor{comment}{// occured in the original mesh as this guarantees the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06253}06253       \textcolor{comment}{// synchronisity between the serialised access to halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06254}06254       \textcolor{comment}{// and haloed nodes from different processors.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06255}06255       nnod = backed\_up\_nod\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06256}06256       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06257}06257       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06258}06258         Node* nod\_pt = backed\_up\_nod\_pt[j];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06259}06259         \textcolor{keywordflow}{if} (!nod\_pt-\/>is\_obsolete())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06260}06260         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06261}06261           \textcolor{comment}{// Not obsolete so add it back to the mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06262}06262           this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac09a9bfeb6d70d8bbefe13c86948a6fc}{add\_node\_pt}}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06263}06263         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06264}06264       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06265}06265 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06266}06266       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after adding nodes back in"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06267}06267 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06268}06268       \textcolor{comment}{// Prune and rebuild mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06269}06269       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06270}06270 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06271}06271       \textcolor{comment}{// Now remove the pruned nodes from the boundary lookup scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06272}06272       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ac9f58929371a3f39dd646d2756547ad2}{prune\_dead\_nodes}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06273}06273 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06274}06274       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after prune dead nodes"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06275}06275 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06276}06276       \textcolor{comment}{// And finally re-\/setup the boundary lookup scheme for elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06277}06277       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a6cc8bcd6b41209f0e9295cc993d9c6bb}{setup\_boundary\_element\_info}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06278}06278 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06279}06279       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after setup boundary info"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06280}06280 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06281}06281       \textcolor{comment}{// Re-\/setup tree forest if needed. (Call this every time even if}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06282}06282       \textcolor{comment}{// a (distributed) mesh has no elements on this processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06283}06283       \textcolor{comment}{// We still need to participate in communication.)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06284}06284       \mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}* ref\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06285}06285         \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase}{TreeBasedRefineableMeshBase}}*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06286}06286       \textcolor{keywordflow}{if} (ref\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06287}06287       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06288}06288         ref\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TreeBasedRefineableMeshBase_aab7cbaa680b2258f2b1eea5de6bbe605}{setup\_tree\_forest}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06289}06289       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06290}06290 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06291}06291       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after setup tree forest"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06292}06292 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06293}06293       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06294}06294       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06295}06295         t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06296}06296         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06297}06297           << \textcolor{stringliteral}{"{}Time for local rebuild of mesh from retained elements in "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06298}06298           << \textcolor{stringliteral}{"{} Mesh::prune\_halo\_elements\_and\_nodes(): "{}} << t\_end -\/ t\_start}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06299}06299           << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06300}06300         t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06301}06301       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06302}06302 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06303}06303       \textcolor{comment}{// Classify nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06304}06304       \mbox{\hyperlink{classoomph_1_1Mesh_a595cfa652d75d9fbfc72a8252fe6782e}{classify\_halo\_and\_haloed\_nodes}}(doc\_info, report\_stats);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06305}06305 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06306}06306       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06307}06307       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06308}06308         t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06309}06309         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for Mesh::classify\_halo\_and\_haloed\_nodes() "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06310}06310                    << \textcolor{stringliteral}{"{} Mesh::prune\_halo\_elements\_and\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06311}06311                    << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06312}06312         t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06313}06313       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06314}06314 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06315}06315       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06316}06316       \textcolor{comment}{// classify\_halo\_and\_haloed\_nodes()"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06317}06317 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06318}06318       \textcolor{comment}{// Doc?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06319}06319       \textcolor{comment}{//-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06320}06320       \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06321}06321       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06322}06322         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Outputting distribution in "{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06323}06323                    << \textcolor{stringliteral}{"{} "{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06324}06324         \mbox{\hyperlink{classoomph_1_1Mesh_ac709c75770886514e2d38c2c7cb74f72}{doc\_mesh\_distribution}}(doc\_info);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06325}06325       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06326}06326 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06327}06327       \textcolor{comment}{// Finally: Reorder the nodes within the mesh's node vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06328}06328       \textcolor{comment}{// to establish a standard ordering regardless of the sequence}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06329}06329       \textcolor{comment}{// of mesh refinements -\/-\/ this is required to allow dump/restart}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06330}06330       \textcolor{comment}{// on refined meshes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06331}06331       this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a801e77424d1bf8a35c9bba055230f1e3}{reorder\_nodes}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06332}06332 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06333}06333 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06334}06334       \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1Global__timings_af25dd181537f6e338daadd0a73d269a0}{Global\_timings::Doc\_comprehensive\_timings}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06335}06335       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06336}06336         t\_end = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06337}06337         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Time for Mesh::reorder\_nodes() "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06338}06338                    << \textcolor{stringliteral}{"{} Mesh::prune\_halo\_elements\_and\_nodes(): "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06339}06339                    << t\_end -\/ t\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06340}06340         t\_start = \mbox{\hyperlink{namespaceoomph_1_1TimingHelpers_a9fb6ad7e2e01b0914e9f7072ef9ebfa6}{TimingHelpers::timer}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06341}06341       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06342}06342 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06343}06343       \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}after reorder nodes"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06344}06344 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06345}06345       \textcolor{comment}{// Doc stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06346}06346       \textcolor{keywordflow}{if} (report\_stats)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06347}06347       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06348}06348         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06349}06349           << \textcolor{stringliteral}{"{}\(\backslash\)n-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06350}06350         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}After pruning:  Processor "{}} << my\_rank << \textcolor{stringliteral}{"{} holds "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06351}06351                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}() << \textcolor{stringliteral}{"{} elements of which "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06352}06352                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_afeb339ee6659e611aee6b0d6fed99c9a}{nroot\_halo\_element}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06353}06353                    << \textcolor{stringliteral}{"{} are root halo elements \(\backslash\)n while "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06354}06354                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a9892d5aa82024c973b021cf6c49356a9}{nroot\_haloed\_element}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06355}06355                    << \textcolor{stringliteral}{"{} are root haloed elements"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06356}06356 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06357}06357         \textcolor{comment}{// Report total number of halo(ed) and shared nodes for this process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06358}06358         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}After pruning: Processor "{}} << my\_rank << \textcolor{stringliteral}{"{} holds "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06359}06359                    << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}() << \textcolor{stringliteral}{"{} nodes of which "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06360}06360                    << \textcolor{stringliteral}{"{} are halo nodes \(\backslash\)n while "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06361}06361                    << \textcolor{stringliteral}{"{} are haloed nodes, and "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06362}06362                    << \textcolor{stringliteral}{"{} are shared nodes."{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06363}06363 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06364}06364         \textcolor{comment}{// Report number of halo(ed) and shared nodes with each domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06365}06365         \textcolor{comment}{// from the current process}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06366}06366         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} iproc = 0; iproc < n\_proc; iproc++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06367}06367         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06368}06368           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}After pruning: With process "{}} << iproc}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06369}06369                      << \textcolor{stringliteral}{"{}, there are "{}} << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(iproc)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06370}06370                      << \textcolor{stringliteral}{"{} halo nodes, and "{}} << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06371}06371                      << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(iproc) << \textcolor{stringliteral}{"{} haloed nodes, and "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06372}06372                      << this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(iproc) << \textcolor{stringliteral}{"{} shared nodes"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06373}06373                      << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06374}06374         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06375}06375         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06376}06376           << \textcolor{stringliteral}{"{}-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06377}06377       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06378}06378     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06379}06379 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06380}06380     \textcolor{comment}{// MemoryUsage::doc\_memory\_usage("{}end of mesh level prune"{});}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06381}06381   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06382}06382 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06383}06383 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06384}06384   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06385}06385 \textcolor{comment}{  ///  Get efficiency of mesh distribution: In an ideal distribution}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06386}06386 \textcolor{comment}{  /// without halo overhead, each processor would only hold its own}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06387}06387 \textcolor{comment}{  /// elements. Efficieny per processor =  (number of non-\/halo elements)/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06388}06388 \textcolor{comment}{  /// (total number of elements).}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06389}06389 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06390}\mbox{\hyperlink{classoomph_1_1Mesh_a976ee9d35c0e10786bd3bfc86dfb34b1}{06390}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a976ee9d35c0e10786bd3bfc86dfb34b1}{Mesh::get\_efficiency\_of\_mesh\_distribution}}(\textcolor{keywordtype}{double}\& av\_efficiency,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06391}06391                                                  \textcolor{keywordtype}{double}\& max\_efficiency,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06392}06392                                                  \textcolor{keywordtype}{double}\& min\_efficiency)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06393}06393   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06394}06394     \textcolor{comment}{// Storage for number of processors and current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06395}06395     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06396}06396     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06397}06397 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06398}06398     \textcolor{comment}{// Create vector to hold number of elements and halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06399}06399     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} nhalo\_elements(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06400}06400     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} n\_elements(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06401}06401 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06402}06402     \textcolor{comment}{// Count total number of halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06403}06403     \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06404}06404     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06405}06405     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06406}06406       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06407}06407       count += halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06408}06408     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06409}06409 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06410}06410     \textcolor{comment}{// Stick own number into appropriate entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06411}06411     \textcolor{keywordtype}{int} nhalo\_element\_local = count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06412}06412     \textcolor{keywordtype}{int} n\_element\_local = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06413}06413 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06414}06414     \textcolor{comment}{// Gather information on root processor: First argument group}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06415}06415     \textcolor{comment}{// specifies what is to be sent (one int from each procssor, indicating}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06416}06416     \textcolor{comment}{// the number of elements on it), the second group indicates where}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06417}06417     \textcolor{comment}{// the results are to be gathered (in rank order) on root processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06418}06418     MPI\_Gather(\&nhalo\_element\_local,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06419}06419                1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06420}06420                MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06421}06421                \&nhalo\_elements[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06422}06422                1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06423}06423                MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06424}06424                0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06425}06425                \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06426}06426     MPI\_Gather(\&n\_element\_local,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06427}06427                1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06428}06428                MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06429}06429                \&n\_elements[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06430}06430                1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06431}06431                MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06432}06432                0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06433}06433                \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06434}06434 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06435}06435     \textcolor{comment}{// Initialise stats}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06436}06436     av\_efficiency = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06437}06437     \textcolor{keywordtype}{double} max = -\/1.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06438}06438     \textcolor{keywordtype}{double} min = 1000000000.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06439}06439 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06440}06440     \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06441}06441     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06442}06442       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_proc; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06443}06443       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06444}06444         \textcolor{keywordtype}{unsigned} nel = n\_elements[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06445}06445         \textcolor{keywordtype}{double} eff = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06446}06446         \textcolor{keywordflow}{if} (nel != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06447}06447         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06448}06448           eff = double(n\_elements[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ nhalo\_elements[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) / double(nel);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06449}06449         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06450}06450         av\_efficiency += eff;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06451}06451         \textcolor{keywordflow}{if} (eff > max) max = eff;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06452}06452         \textcolor{keywordflow}{if} (eff < min) min = eff;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06453}06453       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06454}06454       av\_efficiency /= double(n\_proc);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06455}06455     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06456}06456 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06457}06457     \textcolor{comment}{// Now broadcast the result back out}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06458}06458     MPI\_Bcast(\&max, 1, MPI\_DOUBLE, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06459}06459     MPI\_Bcast(\&min, 1, MPI\_DOUBLE, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06460}06460     MPI\_Bcast(\&av\_efficiency, 1, MPI\_DOUBLE, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06461}06461 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06462}06462     max\_efficiency = max;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06463}06463     min\_efficiency = min;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06464}06464   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06465}06465 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06466}06466 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06467}06467   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06468}06468 \textcolor{comment}{  /// Doc the mesh distribution}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06469}06469 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06470}\mbox{\hyperlink{classoomph_1_1Mesh_ac709c75770886514e2d38c2c7cb74f72}{06470}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ac709c75770886514e2d38c2c7cb74f72}{Mesh::doc\_mesh\_distribution}}(\mbox{\hyperlink{classoomph_1_1DocInfo}{DocInfo}}\& doc\_info)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06471}06471   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06472}06472     \textcolor{comment}{// Storage for current processor and number of processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06473}06473     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06474}06474     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06475}06475 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06476}06476     std::ostringstream filename;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06477}06477     std::ostringstream filename2;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06478}06478     std::ofstream some\_file;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06479}06479     std::ofstream some\_file2;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06480}06480 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06481}06481     \textcolor{comment}{// Doc elements on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06482}06482     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06483}06483              << \textcolor{stringliteral}{"{}elements\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06484}06484              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06485}06485     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06486}06486     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aab74388e8e21325f3ca26f1bd99c26f7}{output}}(some\_file, 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06487}06487     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06488}06488 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06489}06489     \textcolor{comment}{// Doc non-\/halo elements on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06490}06490     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06491}06491     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06492}06492              << \textcolor{stringliteral}{"{}non\_halo\_elements\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06493}06493              << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06494}06494     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06495}06495 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06496}06496     \textcolor{comment}{// Get to elements on processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06497}06497     \textcolor{keywordtype}{unsigned} nelem = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06498}06498     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06499}06499     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06500}06500       \textcolor{comment}{// Get the element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06501}06501       \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}* el\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06502}06502       \textcolor{comment}{// Only output if not  a halo element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06503}06503       \textcolor{keywordflow}{if} (!el\_pt-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a0d9869eaf7d6e104c1e465b0d3cd6a9b}{is\_halo}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06504}06504       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06505}06505         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* f\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06506}06506         \textcolor{comment}{// Indicate a generalised element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06507}06507         \textcolor{keywordflow}{if} (f\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06508}06508         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06509}06509           some\_file << \textcolor{stringliteral}{"{}Generalised Element "{}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06510}06510         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06511}06511         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06512}06512         \textcolor{comment}{// output if non-\/halo and a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06513}06513         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06514}06514           f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(some\_file, 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06515}06515         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06516}06516       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06517}06517     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06518}06518 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06519}06519     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06520}06520 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06521}06521 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06522}06522     \textcolor{comment}{// Doc halo elements on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06523}06523     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06524}06524     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06525}06525              << \textcolor{stringliteral}{"{}halo\_elements\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06526}06526              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06527}06527     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06528}06528     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06529}06529     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06530}06530       filename2.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06531}06531       filename2 << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06532}06532                 << \textcolor{stringliteral}{"{}halo\_elements\_with\_proc"{}} << domain << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06533}06533                 << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06534}06534       some\_file2.open(filename2.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06535}06535 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06536}06536       \textcolor{comment}{// Get vector of halo elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06537}06537       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(domain));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06538}06538       \textcolor{keywordtype}{unsigned} nelem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06539}06539       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06540}06540       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06541}06541         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* f\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06542}06542         \textcolor{keywordflow}{if} (f\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06543}06543         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06544}06544 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06545}06545           \textcolor{comment}{// Check if it's refineable and if so if it's a leaf.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06546}06546           \textcolor{comment}{// If not something must have gone wrong.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06547}06547           \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06548}06548             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(f\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06549}06549           \textcolor{keywordflow}{if} (ref\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06550}06550           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06551}06551             \textcolor{keywordflow}{if} (!(ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a4b783f4e5b6aeed83d49e478510d614f}{tree\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Tree_a72000456c76880e3f78f8f8fb43d49d8}{is\_leaf}}()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06552}06552             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06553}06553               std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06554}06554               error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06555}06555                 << \textcolor{stringliteral}{"{}Haloed element is not a leaf element. This shouldn't happen"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06556}06556                 << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06557}06557               error\_message << \textcolor{stringliteral}{"{}Here are the nodal positions: "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06558}06558               \textcolor{keywordtype}{unsigned} nnod = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06559}06559               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06560}06560               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06561}06561                 Node* nod\_pt = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06562}06562                 \textcolor{keywordtype}{unsigned} n\_dim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06563}06563                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06564}06564                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06565}06565                   error\_message << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06566}06566                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06567}06567                 error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06568}06568                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06569}06569                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06570}06570                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06571}06571               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06572}06572             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06573}06573           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06574}06574 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06575}06575 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06576}06576           f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(some\_file, 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06577}06577           f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(some\_file2, 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06578}06578         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06579}06579         \textcolor{comment}{// Indicate a generalised element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06580}06580         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06581}06581         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06582}06582           some\_file << \textcolor{stringliteral}{"{}Generalised Element "{}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06583}06583           some\_file2 << \textcolor{stringliteral}{"{}Generalised Element "{}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06584}06584         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06585}06585       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06586}06586       some\_file2.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06587}06587     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06588}06588     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06589}06589 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06590}06590     \textcolor{comment}{// Doc haloed elements on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06591}06591     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06592}06592     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06593}06593              << \textcolor{stringliteral}{"{}haloed\_elements\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06594}06594              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06595}06595     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06596}06596     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06597}06597     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06598}06598       filename2.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06599}06599       filename2 << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06600}06600                 << \textcolor{stringliteral}{"{}haloed\_elements\_with\_proc"{}} << domain << \textcolor{stringliteral}{"{}\_on\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06601}06601                 << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06602}06602       some\_file2.open(filename2.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06603}06603 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06604}06604       \textcolor{comment}{// Get vector of haloed elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06605}06605       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06606}06606         this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(domain));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06607}06607       \textcolor{keywordtype}{unsigned} nelem = haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06608}06608       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06609}06609       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06610}06610         \textcolor{comment}{// Is it a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06611}06611         \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06612}06612           \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06613}06613         \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06614}06614         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06615}06615 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06616}06616           \textcolor{comment}{// Check if it's refineable and if so if it's a leaf.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06617}06617           \textcolor{comment}{// If not something must have gone wrong.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06618}06618           \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06619}06619             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(finite\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06620}06620           \textcolor{keywordflow}{if} (ref\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06621}06621           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06622}06622             \textcolor{keywordflow}{if} (!(ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a4b783f4e5b6aeed83d49e478510d614f}{tree\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Tree_a72000456c76880e3f78f8f8fb43d49d8}{is\_leaf}}()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06623}06623             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06624}06624               std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06625}06625               error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06626}06626                 << \textcolor{stringliteral}{"{}Haloed element is not a leaf element. This shouldn't happen"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06627}06627                 << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06628}06628               error\_message << \textcolor{stringliteral}{"{}Here are the nodal positions: "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06629}06629               \textcolor{keywordtype}{unsigned} nnod = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06630}06630               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06631}06631               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06632}06632                 Node* nod\_pt = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06633}06633                 \textcolor{keywordtype}{unsigned} n\_dim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06634}06634                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06635}06635                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06636}06636                   error\_message << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06637}06637                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06638}06638                 error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06639}06639                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06640}06640                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06641}06641                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06642}06642               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06643}06643             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06644}06644           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06645}06645 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06646}06646 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06647}06647           finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(some\_file, 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06648}06648           finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(some\_file2, 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06649}06649         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06650}06650         \textcolor{comment}{// Indicate a generalised element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06651}06651         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06652}06652         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06653}06653           some\_file << \textcolor{stringliteral}{"{}Generalised  Element "{}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06654}06654           some\_file2 << \textcolor{stringliteral}{"{}Generalised  Element "{}} << \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06655}06655         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06656}06656       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06657}06657       some\_file2.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06658}06658     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06659}06659     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06660}06660 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06661}06661 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06662}06662     \textcolor{comment}{// Doc non-\/halo nodes on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06663}06663     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06664}06664     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06665}06665              << \textcolor{stringliteral}{"{}non\_halo\_nodes\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06666}06666              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06667}06667     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06668}06668     \textcolor{keywordtype}{unsigned} nnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06669}06669     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06670}06670     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06671}06671       Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06672}06672       \textcolor{keywordflow}{if} (!nod\_pt-\/>is\_halo())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06673}06673       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06674}06674         \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06675}06675         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06676}06676         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06677}06677           some\_file << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06678}06678         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06679}06679         some\_file << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06680}06680                   << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>hang\_code()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06681}06681                   << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06682}06682       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06683}06683     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06684}06684     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06685}06685 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06686}06686 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06687}06687     \textcolor{comment}{// Doc nodes on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06688}06688     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06689}06689     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06690}06690              << \textcolor{stringliteral}{"{}nodes\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06691}06691              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06692}06692     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06693}06693     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06694}06694     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06695}06695       Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06696}06696       \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06697}06697       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06698}06698       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06699}06699         some\_file << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06700}06700       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06701}06701       some\_file << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID() << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06702}06702                 << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>hang\_code() << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06703}06703     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06704}06704     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06705}06705 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06706}06706     \textcolor{comment}{// Doc solid nodes on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06707}06707     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06708}06708     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06709}06709              << \textcolor{stringliteral}{"{}solid\_nodes\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06710}06710              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06711}06711     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06712}06712     \textcolor{keywordtype}{unsigned} nsnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06713}06713     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nsnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06714}06714     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06715}06715       Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06716}06716       \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_nod\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06717}06717       \textcolor{keywordflow}{if} (solid\_nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06718}06718       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06719}06719         \textcolor{keywordtype}{unsigned} ndim = solid\_nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06720}06720         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06721}06721         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06722}06722           some\_file << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06723}06723         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06724}06724         some\_file << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06725}06725                   << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>hang\_code()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06726}06726                   << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06727}06727       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06728}06728     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06729}06729     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06730}06730 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06731}06731 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06732}06732     \textcolor{comment}{// Doc halo nodes on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06733}06733     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06734}06734     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06735}06735              << \textcolor{stringliteral}{"{}halo\_nodes\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06736}06736              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06737}06737     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06738}06738     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06739}06739     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06740}06740       filename2.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06741}06741       filename2 << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06742}06742                 << \textcolor{stringliteral}{"{}halo\_nodes\_with\_proc"{}} << domain << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06743}06743                 << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06744}06744       some\_file2.open(filename2.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06745}06745       \textcolor{keywordtype}{unsigned} nnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06746}06746       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06747}06747       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06748}06748         Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad7ba73da180acb43523166ee71fb2e99}{halo\_node\_pt}}(domain, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06749}06749         \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06750}06750         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06751}06751         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06752}06752           some\_file << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06753}06753           some\_file2 << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06754}06754         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06755}06755         some\_file << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06756}06756                   << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>hang\_code()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06757}06757                   << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06758}06758         some\_file2 << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06759}06759                    << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>hang\_code()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06760}06760                    << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06761}06761       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06762}06762       some\_file2.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06763}06763     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06764}06764     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06765}06765 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06766}06766 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06767}06767     \textcolor{comment}{// Doc haloed nodes on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06768}06768     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06769}06769     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06770}06770              << \textcolor{stringliteral}{"{}haloed\_nodes\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06771}06771              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06772}06772     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06773}06773     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06774}06774     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06775}06775       filename2.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06776}06776       filename2 << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06777}06777                 << \textcolor{stringliteral}{"{}haloed\_nodes\_with\_proc"{}} << domain << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06778}06778                 << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06779}06779       some\_file2.open(filename2.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06780}06780       \textcolor{keywordtype}{unsigned} nnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06781}06781       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06782}06782       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06783}06783         Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ab29fbaa5e88f722de752b3fd642a75e4}{haloed\_node\_pt}}(domain, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06784}06784         \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06785}06785         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06786}06786         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06787}06787           some\_file << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06788}06788           some\_file2 << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06789}06789         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06790}06790         some\_file << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06791}06791                   << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>hang\_code()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06792}06792                   << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06793}06793         some\_file2 << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06794}06794                    << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>hang\_code()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06795}06795                    << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06796}06796       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06797}06797       some\_file2.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06798}06798     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06799}06799     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06800}06800 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06801}06801 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06802}06802     \textcolor{comment}{// Doc shared nodes on this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06803}06803     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06804}06804     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06805}06805              << \textcolor{stringliteral}{"{}shared\_nodes\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06806}06806              << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06807}06807     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06808}06808     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06809}06809     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06810}06810       filename2.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06811}06811       filename2 << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06812}06812                 << \textcolor{stringliteral}{"{}shared\_nodes\_with\_proc"{}} << domain << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06813}06813                 << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06814}06814       some\_file2.open(filename2.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06815}06815       \textcolor{keywordtype}{unsigned} nnod = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(domain);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06816}06816       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06817}06817       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06818}06818         Node* nod\_pt = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(domain, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06819}06819         \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06820}06820         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06821}06821         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06822}06822           some\_file << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06823}06823           some\_file2 << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06824}06824         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06825}06825         some\_file << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06826}06826                   << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06827}06827         some\_file2 << nod\_pt-\/>nvalue() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>non\_halo\_proc\_ID()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06828}06828                    << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>is\_halo() << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>hang\_code()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06829}06829                    << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06830}06830       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06831}06831       some\_file2.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06832}06832     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06833}06833     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06834}06834 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06835}06835 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06836}06836     \textcolor{comment}{// Doc mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06837}06837     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06838}06838     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}mesh"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06839}06839              << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06840}06840     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06841}06841     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aab74388e8e21325f3ca26f1bd99c26f7}{output}}(some\_file, 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06842}06842     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06843}06843 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06844}06844 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06845}06845     \textcolor{comment}{// Doc boundary scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06846}06846     filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06847}06847     filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}boundaries"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06848}06848              << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06849}06849     some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06850}06850     this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_af6effab50e32290d4d8066440b9b3e37}{output\_boundaries}}(some\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06851}06851     some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06852}06852 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06853}06853 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06854}06854     \textcolor{comment}{// Doc elements next to boundaries scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06855}06855     \textcolor{comment}{// if set up}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06856}06856     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a37f6d27447f643a74694012b09350ce9}{Lookup\_for\_elements\_next\_boundary\_is\_setup}})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06857}06857     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06858}06858       \textcolor{comment}{// How many finite elements are adjacent to boundary b?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06859}06859       \textcolor{keywordtype}{unsigned} nbound = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06860}06860       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < nbound; b++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06861}06861       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06862}06862         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06863}06863         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06864}06864                  << \textcolor{stringliteral}{"{}boundary\_elements"{}} << my\_rank << \textcolor{stringliteral}{"{}\_"{}} << b << \textcolor{stringliteral}{"{}\_"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06865}06865                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06866}06866         some\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06867}06867         \textcolor{keywordtype}{unsigned} nelem = this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a68e04b3b70cff70d53d75f66661555e8}{nboundary\_element}}(b);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06868}06868         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06869}06869         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06870}06870           this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a6dcf10c6fff9d13b309549ba73e10069}{boundary\_element\_pt}}(b, \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{output}}(some\_file, 5);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06871}06871         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06872}06872         some\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06873}06873       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06874}06874     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06875}06875   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06876}06876 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06877}06877 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06878}06878   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06879}06879 \textcolor{comment}{  /// Check the halo/haloed/shared node/element schemes on the Mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06880}06880 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06881}\mbox{\hyperlink{classoomph_1_1Mesh_a500ba96f32d090b15dbdbadcaef0e32a}{06881}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a500ba96f32d090b15dbdbadcaef0e32a}{Mesh::check\_halo\_schemes}}(\mbox{\hyperlink{classoomph_1_1DocInfo}{DocInfo}}\& doc\_info,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06882}06882                                 \textcolor{keywordtype}{double}\& max\_permitted\_error\_for\_halo\_check)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06883}06883   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06884}06884     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Doing check\_halo\_schemes for mesh: "{}} << \textcolor{keyword}{typeid}(*this).name()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06885}06885                << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06886}06886 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06887}06887     \textcolor{comment}{// Moved this from the Problem class so that it would work better}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06888}06888     \textcolor{comment}{// in multiple mesh problems; there remains a simple "{}wrapper"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06889}06889     \textcolor{comment}{// function in the Problem class that calls this for each (sub)mesh.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06890}06890 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06891}06891     MPI\_Status status;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06892}06892     std::ostringstream filename;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06893}06893     std::ofstream shared\_file;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06894}06894     std::ofstream halo\_file;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06895}06895     std::ofstream haloed\_file;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06896}06896     std::ofstream ext\_halo\_file;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06897}06897     std::ofstream ext\_haloed\_file;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06898}06898 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06899}06899     \textcolor{comment}{// Storage for current processor and number of processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06900}06900     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06901}06901     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06902}06902 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06903}06903 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06904}06904     \textcolor{comment}{// Check the shared node scheme first: if this is incorrect then}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06905}06905     \textcolor{comment}{// the halo(ed) node scheme is likely to be wrong too}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06906}06906 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06907}06907     \textcolor{comment}{// Doc shared nodes lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06908}06908     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06909}06909     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06910}06910     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06911}06911       \textcolor{comment}{// Loop over domains for shared nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06912}06912       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06913}06913       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06914}06914         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06915}06915         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/shared\_node\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06916}06916                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06917}06917                  << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06918}06918         shared\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06919}06919         shared\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06920}06920 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06921}06921         \textcolor{keywordtype}{unsigned} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(dd);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06922}06922         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06923}06923         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06924}06924           Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(dd, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06925}06925           \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06926}06926           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06927}06927           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06928}06928             shared\_file << nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06929}06929           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06930}06930           shared\_file << j << \textcolor{stringliteral}{"{} "{}} << nod\_pt << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06931}06931         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06932}06932         \textcolor{comment}{// Dummy output for processor that doesn't share nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06933}06933         \textcolor{comment}{// (needed for tecplot)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06934}06934         \textcolor{keywordflow}{if} ((nnod == 0) \&\& (\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}() != 0))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06935}06935         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06936}06936           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* f\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06937}06937           \textcolor{comment}{// If it's a generalised element mesh dummy output}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06938}06938           \textcolor{keywordflow}{if} (f\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06939}06939           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06940}06940             shared\_file << \textcolor{stringliteral}{"{}0.0"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06941}06941           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06942}06942           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06943}06943           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06944}06944             \textcolor{keywordtype}{unsigned} ndim = f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06945}06945             \textcolor{keywordflow}{if} (ndim == 2)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06946}06946             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06947}06947               shared\_file << \textcolor{stringliteral}{"{} 1.0 1.1 "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06948}06948             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06949}06949             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06950}06950             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06951}06951               shared\_file << \textcolor{stringliteral}{"{} 1.0 1.1 1.1"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06952}06952             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06953}06953           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06954}06954         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06955}06955         shared\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06956}06956       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06957}06957     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06958}06958 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06959}06959 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06960}06960     \textcolor{comment}{// Check for duplicates in shared node scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06961}06961     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06962}06962     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06963}06963       \textcolor{keywordtype}{unsigned} n\_vector = \mbox{\hyperlink{classoomph_1_1Mesh_a0fba80dc38b8577982b94309e4e1d3d7}{Shared\_node\_pt}}[d].size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06964}06964       std::set<Node*> shared\_node\_set;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06965}06965       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_vector; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06966}06966       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06967}06967         \textcolor{keywordtype}{unsigned} old\_size = shared\_node\_set.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06968}06968         shared\_node\_set.insert(\mbox{\hyperlink{classoomph_1_1Mesh_a0fba80dc38b8577982b94309e4e1d3d7}{Shared\_node\_pt}}[d][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06969}06969         \textcolor{keywordtype}{unsigned} new\_size = shared\_node\_set.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06970}06970         \textcolor{keywordflow}{if} (old\_size == new\_size)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06971}06971         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06972}06972           Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a0fba80dc38b8577982b94309e4e1d3d7}{Shared\_node\_pt}}[d][\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06973}06973           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Repeated node in shared node lookup scheme: "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06974}06974                      << \textcolor{stringliteral}{"{}-\/th node with proc "{}} << d << \textcolor{stringliteral}{"{} : "{}} << nod\_pt}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06975}06975                      << \textcolor{stringliteral}{"{} at: "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06976}06976           \textcolor{keywordtype}{unsigned} n = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06977}06977           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ii = 0; ii < n; ii++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06978}06978           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06979}06979             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << nod\_pt-\/>x(ii) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06980}06980           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06981}06981           \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06982}06982         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06983}06983       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06984}06984       \textcolor{keywordtype}{unsigned} n\_set = shared\_node\_set.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06985}06985       \textcolor{keywordflow}{if} (n\_vector != n\_set)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06986}06986       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06987}06987         std::ostringstream warning\_stream;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06988}06988         warning\_stream}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06989}06989           << \textcolor{stringliteral}{"{}WARNING: "{}} << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06990}06990           << \textcolor{stringliteral}{"{}There seem to be repeated entries in shared node scheme "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06991}06991           << \textcolor{stringliteral}{"{}with proc "{}} << d << \textcolor{stringliteral}{"{}.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06992}06992           << \textcolor{stringliteral}{"{}n\_vector="{}} << n\_vector << \textcolor{stringliteral}{"{}; n\_set="{}} << n\_set << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06993}06993         \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06994}06994         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06995}06995           warning\_stream << \textcolor{stringliteral}{"{}Shared node scheme has been output in files like\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06996}06996                          << filename.str() << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06997}06997         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06998}06998         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l06999}06999         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07000}07000           warning\_stream << \textcolor{stringliteral}{"{}Re-\/run with doc\_info enabled to see where the "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07001}07001                             \textcolor{stringliteral}{"{}shared nodes are.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07002}07002         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07003}07003         \mbox{\hyperlink{classoomph_1_1OomphLibWarning}{OomphLibWarning}}(warning\_stream.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07004}07004                         \textcolor{stringliteral}{"{}Mesh::check\_halo\_schemes"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07005}07005                         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07006}07006       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07007}07007     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07008}07008 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07009}07009 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07010}07010     \textcolor{comment}{// Check shared nodes lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07011}07011     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07012}07012     \textcolor{keywordtype}{double} max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07013}07013 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07014}07014     \textcolor{comment}{// Loop over domains for shared nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07015}07015     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07016}07016     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07017}07017       \textcolor{comment}{// Are my shared nodes being checked?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07018}07018       \textcolor{keywordflow}{if} (d == my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07019}07019       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07020}07020         \textcolor{comment}{// Loop over domains for shared nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07021}07021         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07022}07022         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07023}07023           \textcolor{comment}{// Don't talk to yourself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07024}07024           \textcolor{keywordflow}{if} (dd != d)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07025}07025           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07026}07026             \textcolor{comment}{// How many of my nodes are shared nodes with processor dd?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07027}07027             \textcolor{keywordtype}{int} nnod\_shared = \mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(dd);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07028}07028 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07029}07029             \textcolor{keywordflow}{if} (nnod\_shared != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07030}07030             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07031}07031               \textcolor{comment}{// Receive from processor dd how many of his nodes are shared}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07032}07032               \textcolor{comment}{// with this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07033}07033               \textcolor{keywordtype}{int} nnod\_share = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07034}07034               MPI\_Recv(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07035}07035                 \&nnod\_share, 1, MPI\_INT, dd, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(), \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07036}07036 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07037}07037               \textcolor{keywordflow}{if} (nnod\_shared != nnod\_share)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07038}07038               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07039}07039                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07040}07040 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07041}07041                 error\_message << \textcolor{stringliteral}{"{}Clash in numbers of shared nodes! "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07042}07042                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07043}07043                 error\_message << \textcolor{stringliteral}{"{}\# of shared nodes on proc "{}} << dd << \textcolor{stringliteral}{"{}: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07044}07044                               << nnod\_shared << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07045}07045                 error\_message << \textcolor{stringliteral}{"{}\# of shared nodes on proc "{}} << d << \textcolor{stringliteral}{"{}: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07046}07046                               << nnod\_share << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07047}07047                 error\_message << \textcolor{stringliteral}{"{}(Re-\/)run Problem::check\_halo\_schemes() with "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07048}07048                                  \textcolor{stringliteral}{"{}DocInfo object"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07049}07049                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07050}07050                 error\_message << \textcolor{stringliteral}{"{}to identify the problem"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07051}07051                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07052}07052                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07053}07053                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07054}07054               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07055}07055 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07056}07056 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07057}07057               \textcolor{keywordtype}{unsigned} nod\_dim = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07058}07058 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07059}07059               \textcolor{comment}{// Get strung-\/together nodal positions from other processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07060}07060               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} other\_nodal\_positions(nod\_dim * nnod\_share);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07061}07061               MPI\_Recv(\&other\_nodal\_positions[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07062}07062                        nod\_dim * nnod\_share,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07063}07063                        MPI\_DOUBLE,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07064}07064                        dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07065}07065                        0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07066}07066                        \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07067}07067                        \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07068}07068 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07069}07069               \textcolor{comment}{// Check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07070}07070               \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07071}07071               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < nnod\_share; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07072}07072               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07073}07073                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_shared(nod\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07074}07074                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07075}07075                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07076}07076                   x\_shared[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(dd, j)-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07077}07077                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07078}07078                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_share(nod\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07079}07079                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07080}07080                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07081}07081                   x\_share[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = other\_nodal\_positions[count];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07082}07082                   count++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07083}07083                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07084}07084                 \textcolor{keywordtype}{double} error = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07085}07085                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07086}07086                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07087}07087                   error +=}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07088}07088                     (x\_shared[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ x\_share[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) * (x\_shared[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ x\_share[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07089}07089                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07090}07090                 error = sqrt(error);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07091}07091 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07092}07092                 \textcolor{comment}{// Doc if relevant}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07093}07093                 \textcolor{keywordflow}{if} (error > max\_permitted\_error\_for\_halo\_check)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07094}07094                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07095}07095                   \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Error in shared nodes: "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07096}07096                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07097}07097                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07098}07098                     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << x\_shared[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07099}07099                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07100}07100                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07101}07101                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07102}07102                     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << x\_share[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07103}07103                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07104}07104                   \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << error << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07105}07105                   \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}shared node: "{}} << \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(dd, j)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07106}07106                              << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07107}07107                   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(dd, j)-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07108}07108                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07109}07109                     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}shared node: "{}} << \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(dd, j)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07110}07110                                << \textcolor{stringliteral}{"{} is hanging with masters"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07111}07111                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07112}07112                          m < \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(dd, j)-\/>hanging\_pt()-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07113}07113                          m++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07114}07114                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07115}07115                       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07116}07116                         << \textcolor{stringliteral}{"{}master: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07117}07117                         << \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(dd, j)-\/>hanging\_pt()-\/>master\_node\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07118}07118                              m)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07119}07119                         << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07120}07120                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07121}07121                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07122}07122                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07123}07123 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07124}07124                 \textcolor{comment}{// Keep tracking max}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07125}07125                 \textcolor{keywordflow}{if} (error > max\_error)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07126}07126                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07127}07127                   max\_error = error;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07128}07128                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07129}07129               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07130}07130             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07131}07131           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07132}07132         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07133}07133       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07134}07134       \textcolor{comment}{// My shared nodes are not being checked: Send my shared nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07135}07135       \textcolor{comment}{// to the other processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07136}07136       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07137}07137       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07138}07138         \textcolor{keywordtype}{int} nnod\_share = \mbox{\hyperlink{classoomph_1_1Mesh_aeca9041d73b9641ca1361763401b4799}{nshared\_node}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07139}07139 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07140}07140         \textcolor{keywordflow}{if} (nnod\_share != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07141}07141         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07142}07142           \textcolor{comment}{// Send it across to the processor whose shared nodes are being}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07143}07143           \textcolor{comment}{// checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07144}07144           MPI\_Send(\&nnod\_share, 1, MPI\_INT, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07145}07145 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07146}07146           \textcolor{keywordtype}{unsigned} nod\_dim = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07147}07147 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07148}07148           \textcolor{comment}{// Now string together the nodal positions of all shared nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07149}07149           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} nodal\_positions(nod\_dim * nnod\_share);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07150}07150           \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07151}07151           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < nnod\_share; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07152}07152           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07153}07153             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07154}07154             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07155}07155               nodal\_positions[count] = \mbox{\hyperlink{classoomph_1_1Mesh_ae43776ad2c2cf72ed50cc32f927386d4}{shared\_node\_pt}}(d, j)-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07156}07156               count++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07157}07157             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07158}07158           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07159}07159           \textcolor{comment}{// Send it across to the processor whose shared nodes are being}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07160}07160           \textcolor{comment}{// checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07161}07161           MPI\_Send(\&nodal\_positions[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07162}07162                    nod\_dim * nnod\_share,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07163}07163                    MPI\_DOUBLE,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07164}07164                    d,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07165}07165                    0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07166}07166                    \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07167}07167         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07168}07168       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07169}07169     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07170}07170 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07171}07171     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Max. error for shared nodes "{}} << max\_error << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07172}07172     \textcolor{keywordflow}{if} (max\_error > max\_permitted\_error\_for\_halo\_check)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07173}07173     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07174}07174       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07175}07175       error\_message << \textcolor{stringliteral}{"{}This is bigger than the permitted threshold "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07176}07176                     << max\_permitted\_error\_for\_halo\_check << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07177}07177       error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07178}07178         << \textcolor{stringliteral}{"{}If you believe this to be acceptable for your problem\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07179}07179         << \textcolor{stringliteral}{"{}increase Problem::Max\_permitted\_error\_for\_halo\_check and re-\/run \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07180}07180       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07181}07181         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07182}07182     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07183}07183 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07184}07184     \textcolor{comment}{// Now check the halo/haloed element lookup scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07185}07185 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07186}07186     \textcolor{comment}{// Doc halo/haoloed element lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07187}07187     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07188}07188     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07189}07189     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07190}07190       \textcolor{comment}{// Loop over domains for halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07191}07191       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07192}07192       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07193}07193         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07194}07194         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/halo\_element\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07195}07195                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07196}07196                  << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07197}07197         halo\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07198}07198 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07199}07199         \textcolor{comment}{// Get vectors of halo/haloed elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07200}07200         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(dd));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07201}07201 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07202}07202         \textcolor{keywordtype}{unsigned} nelem = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07203}07203 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07204}07204         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07205}07205         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07206}07206           halo\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07207}07207           \textcolor{comment}{// Can I cast to a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07208}07208           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07209}07209             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07210}07210           \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07211}07211           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07212}07212             \textcolor{keywordtype}{unsigned} nnod = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07213}07213             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07214}07214             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07215}07215               Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07216}07216               \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07217}07217               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07218}07218               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07219}07219                 halo\_file << nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07220}07220               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07221}07221               halo\_file << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07222}07222             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07223}07223           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07224}07224         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07225}07225         halo\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07226}07226       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07227}07227 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07228}07228       \textcolor{comment}{// Loop over domains for halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07229}07229       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07230}07230       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07231}07231         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07232}07232         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/haloed\_element\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07233}07233                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07234}07234                  << d << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07235}07235         haloed\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07236}07236 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07237}07237         \textcolor{comment}{// Get vectors of halo/haloed elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07238}07238         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07239}07239 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07240}07240         \textcolor{keywordtype}{unsigned} nelem2 = haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07241}07241         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem2; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07242}07242         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07243}07243           haloed\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07244}07244           \textcolor{comment}{// Is it a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07245}07245           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07246}07246             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07247}07247           \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07248}07248           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07249}07249             \textcolor{comment}{// Check if it's refineable and if so if it's a leaf.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07250}07250             \textcolor{comment}{// If not something must have gone wrong.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07251}07251             \mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}* ref\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07252}07252               \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1RefineableElement}{RefineableElement}}*\textcolor{keyword}{>}(finite\_el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07253}07253             \textcolor{keywordflow}{if} (ref\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07254}07254             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07255}07255               \textcolor{keywordflow}{if} (!(ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1RefineableElement_a4b783f4e5b6aeed83d49e478510d614f}{tree\_pt}}()-\/>\mbox{\hyperlink{classoomph_1_1Tree_a72000456c76880e3f78f8f8fb43d49d8}{is\_leaf}}()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07256}07256               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07257}07257                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07258}07258                 error\_message << \textcolor{stringliteral}{"{}Haloed element is not a leaf element. This "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07259}07259                                  \textcolor{stringliteral}{"{}shouldn't happen"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07260}07260                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07261}07261                 error\_message << \textcolor{stringliteral}{"{}Here are the nodal positions: "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07262}07262                 \textcolor{keywordtype}{unsigned} nnod = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07263}07263                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07264}07264                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07265}07265                   Node* nod\_pt = ref\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07266}07266                   \textcolor{keywordtype}{unsigned} n\_dim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07267}07267                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07268}07268                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07269}07269                     error\_message << nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07270}07270                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07271}07271                   error\_message << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07272}07272                   \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07273}07273                                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07274}07274                                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07275}07275                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07276}07276               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07277}07277             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07278}07278             \textcolor{keywordtype}{unsigned} nnod2 = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07279}07279             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod2; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07280}07280             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07281}07281               Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07282}07282               \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07283}07283               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07284}07284               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07285}07285                 haloed\_file << nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07286}07286               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07287}07287               haloed\_file << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07288}07288             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07289}07289           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07290}07290         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07291}07291         haloed\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07292}07292       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07293}07293     \} \textcolor{comment}{// end of if doc flag}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07294}07294 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07295}07295     \textcolor{comment}{// Check halo/haloed element lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07296}07296     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07297}07297     max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07298}07298     \textcolor{keywordtype}{bool} shout = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07299}07299     \textcolor{keywordtype}{bool} shout\_and\_terminate = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07300}07300 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07301}07301     \textcolor{comment}{// Loop over domains for haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07302}07302     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07303}07303     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07304}07304       \textcolor{comment}{// Are my haloed elements being checked?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07305}07305       \textcolor{keywordflow}{if} (d == my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07306}07306       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07307}07307         \textcolor{comment}{// Loop over domains for halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07308}07308         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07309}07309         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07310}07310           \textcolor{comment}{// Don't talk to yourself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07311}07311           \textcolor{keywordflow}{if} (dd != d)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07312}07312           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07313}07313             \textcolor{comment}{// Get vectors of haloed elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07314}07314             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} haloed\_elem\_pt(\mbox{\hyperlink{classoomph_1_1Mesh_ae1376f1c2e3e2dbd66b9334992f02ae0}{haloed\_element\_pt}}(dd));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07315}07315 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07316}07316             \textcolor{comment}{// How many of my elements are haloed elements whose halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07317}07317             \textcolor{comment}{// counterpart is located on processor dd?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07318}07318             \textcolor{keywordtype}{int} nelem\_haloed = haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07319}07319 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07320}07320             \textcolor{keywordflow}{if} (nelem\_haloed != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07321}07321             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07322}07322               \textcolor{comment}{// Receive from processor dd how many of his elements are halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07323}07323               \textcolor{comment}{// nodes whose non-\/halo counterparts are located here}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07324}07324               \textcolor{keywordtype}{int} nelem\_halo = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07325}07325               MPI\_Recv(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07326}07326                 \&nelem\_halo, 1, MPI\_INT, dd, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(), \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07327}07327               \textcolor{keywordflow}{if} (nelem\_halo != nelem\_haloed)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07328}07328               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07329}07329                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07330}07330                 error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07331}07331                   << \textcolor{stringliteral}{"{}Clash in numbers of halo and haloed elements! "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07332}07332                   << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07333}07333                 error\_message << \textcolor{stringliteral}{"{}\# of haloed elements whose halo counterpart "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07334}07334                                  \textcolor{stringliteral}{"{}lives on proc "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07335}07335                               << dd << \textcolor{stringliteral}{"{}: "{}} << nelem\_haloed << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07336}07336                 error\_message << \textcolor{stringliteral}{"{}\# of halo elements whose non-\/halo "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07337}07337                                  \textcolor{stringliteral}{"{}counterpart lives on proc "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07338}07338                               << d << \textcolor{stringliteral}{"{}: "{}} << nelem\_halo << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07339}07339                 error\_message << \textcolor{stringliteral}{"{}(Re-\/)run Problem::check\_halo\_schemes() with "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07340}07340                                  \textcolor{stringliteral}{"{}DocInfo object"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07341}07341                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07342}07342                 error\_message << \textcolor{stringliteral}{"{}to identify the problem"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07343}07343                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07344}07344                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07345}07345                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07346}07346               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07347}07347 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07348}07348 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07349}07349               \textcolor{comment}{// We can only check nodal stuff for meshes of finite elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07350}07350               \textcolor{keywordflow}{if} (\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0)))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07351}07351               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07352}07352                 \textcolor{comment}{// Get strung-\/together elemental nodal positions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07353}07353                 \textcolor{comment}{// from other processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07354}07354                 \textcolor{comment}{// unsigned nnod\_per\_el=finite\_element\_pt(0)-\/>nnode();}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07355}07355                 \textcolor{keywordtype}{unsigned} nod\_dim = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07356}07356                 \textcolor{comment}{// Vector<double> other\_nodal\_positions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07357}07357                 \textcolor{comment}{// (nod\_dim*nnod\_per\_el*nelem\_halo);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07358}07358                 \textcolor{comment}{// MPI\_Recv(\&other\_nodal\_positions[0],nod\_dim*nnod\_per\_el*nelem\_halo,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07359}07359                 \textcolor{comment}{//         MPI\_DOUBLE,dd,0,comm\_pt-\/>mpi\_comm(),\&status);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07360}07360                 \textcolor{keywordtype}{unsigned} n\_nodal\_positions = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07361}07361                 MPI\_Recv(\&n\_nodal\_positions,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07362}07362                          1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07363}07363                          MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07364}07364                          dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07365}07365                          0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07366}07366                          \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07367}07367                          \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07368}07368                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} other\_nodal\_positions(n\_nodal\_positions);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07369}07369                 \textcolor{keywordflow}{if} (n\_nodal\_positions > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07370}07370                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07371}07371                   MPI\_Recv(\&other\_nodal\_positions[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07372}07372                            n\_nodal\_positions,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07373}07373                            MPI\_DOUBLE,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07374}07374                            dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07375}07375                            0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07376}07376                            \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07377}07377                            \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07378}07378                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07379}07379 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07380}07380 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07381}07381                 \textcolor{comment}{// Receive hanging info to be checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07382}07382                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} other\_nodal\_hangings;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07383}07383                 \textcolor{keywordtype}{unsigned} n\_other\_nodal\_hangings = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07384}07384                 MPI\_Recv(\&n\_other\_nodal\_hangings,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07385}07385                          1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07386}07386                          MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07387}07387                          dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07388}07388                          1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07389}07389                          \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07390}07390                          \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07391}07391                 \textcolor{keywordflow}{if} (n\_other\_nodal\_hangings > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07392}07392                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07393}07393                   other\_nodal\_hangings.resize(n\_other\_nodal\_hangings);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07394}07394                   MPI\_Recv(\&other\_nodal\_hangings[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07395}07395                            n\_other\_nodal\_hangings,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07396}07396                            MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07397}07397                            dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07398}07398                            1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07399}07399                            \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07400}07400                            \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07401}07401                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07402}07402 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07403}07403                 \textcolor{comment}{// If documenting, open the output files}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07404}07404                 \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07405}07405                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07406}07406                   filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07407}07407                   filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/error\_haloed\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07408}07408                            << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07409}07409                            << \textcolor{stringliteral}{"{}\_with\_proc"{}} << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07410}07410                            << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07411}07411                   haloed\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07412}07412                   filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07413}07413                   filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/error\_halo\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07414}07414                            << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07415}07415                            << \textcolor{stringliteral}{"{}\_with\_proc"{}} << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07416}07416                            << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07417}07417                   halo\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07418}07418                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07419}07419 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07420}07420                 \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07421}07421                 \textcolor{keywordtype}{unsigned} count\_hanging = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07422}07422                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem\_haloed; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07423}07423                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07424}07424                   \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07425}07425                     \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07426}07426 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07427}07427                   \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07428}07428                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07429}07429                     \textcolor{keywordtype}{unsigned} nnod\_this\_el = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07430}07430                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod\_this\_el; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07431}07431                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07432}07432                       Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07433}07433                       \textcolor{comment}{// unsigned nod\_dim = nod\_pt-\/>ndim();}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07434}07434 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07435}07435                       \textcolor{comment}{// Testing POSITIONS, not x location}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07436}07436                       \textcolor{comment}{// (cf hanging nodes, nodes.h)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07437}07437                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_haloed(nod\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07438}07438                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07439}07439                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07440}07440                         x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07441}07441                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07442}07442 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07443}07443                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_halo(nod\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07444}07444                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07445}07445                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07446}07446                         x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = other\_nodal\_positions[count];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07447}07447                         ++count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07448}07448                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07449}07449 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07450}07450                       \textcolor{keywordtype}{double} error = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07451}07451                       shout = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07452}07452                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07453}07453                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07454}07454                         error +=}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07455}07455                           (x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) * (x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07456}07456                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07457}07457                       error = sqrt(error);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07458}07458 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07459}07459                       \textcolor{keywordflow}{if} (error > max\_error)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07460}07460                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07461}07461                         max\_error = error;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07462}07462                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07463}07463                       \textcolor{keywordtype}{double} tol = 1.0e-\/12;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07464}07464                       \textcolor{keywordflow}{if} (error > tol)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07465}07465                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07466}07466                         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07467}07467                           << \textcolor{stringliteral}{"{}Discrepancy between nodal coordinates of halo(ed)"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07468}07468                           << \textcolor{stringliteral}{"{}element larger than tolerance ("{}} << tol}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07469}07469                           << \textcolor{stringliteral}{"{})\(\backslash\)n  Error: "{}} << error << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07470}07470                         shout = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07471}07471                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07472}07472 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07473}07473                       \textcolor{keywordtype}{unsigned} nval = nod\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07474}07474                       \textcolor{keywordtype}{int} nval\_other = other\_nodal\_hangings[count\_hanging];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07475}07475                       count\_hanging++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07476}07476                       \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}(nval) != nval\_other)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07477}07477                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07478}07478                         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07479}07479                           << \textcolor{stringliteral}{"{}Number of values of node, "{}} << nval}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07480}07480                           << \textcolor{stringliteral}{"{}, does not match number of values on other proc, "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07481}07481                           << nval\_other << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07482}07482                         shout = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07483}07483                         shout\_and\_terminate = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07484}07484                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07485}07485 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07486}07486                       \textcolor{comment}{// Is other node geometrically hanging?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07487}07487                       \textcolor{keywordtype}{int} other\_geom\_hanging = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07488}07488 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07489}07489                       \textcolor{comment}{// Check hangingness/number of master nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07490}07490                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = -\/1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < int(nval); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07491}07491                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07492}07492                         \textcolor{keywordtype}{int} nmaster\_other = other\_nodal\_hangings[count\_hanging];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07493}07493                         count\_hanging++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07494}07494 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07495}07495                         \textcolor{comment}{// Record geom hang status of other node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07496}07496                         \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == -\/1) other\_geom\_hanging = nmaster\_other;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07497}07497 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07498}07498                         \textcolor{comment}{// Value is hanging on local proc: Does it have the same}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07499}07499                         \textcolor{comment}{// number of masters as its counterpart on other proc?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07500}07500                         \textcolor{keywordflow}{if} (nod\_pt-\/>is\_hanging(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07501}07501                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07502}07502                           \textcolor{keywordtype}{unsigned} nmaster = nod\_pt-\/>hanging\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07503}07503                           \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}(nmaster) != nmaster\_other)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07504}07504                           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07505}07505                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07506}07506                               << \textcolor{stringliteral}{"{}Number of master nodes for hanging value "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07507}07507                               << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} of node, "{}} << nmaster}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07508}07508                               << \textcolor{stringliteral}{"{}, does not match number of master "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07509}07509                               << \textcolor{stringliteral}{"{}nodes on other proc, "{}} << nmaster\_other}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07510}07510                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07511}07511                             shout = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07512}07512                             shout\_and\_terminate = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07513}07513                           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07514}07514                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07515}07515                         \textcolor{comment}{// Value is not hanging on local proc: It had better}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07516}07516                         \textcolor{comment}{// not have any masters (i.e. be hanging) on the other}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07517}07517                         \textcolor{comment}{// proc}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07518}07518                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07519}07519                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07520}07520                           \textcolor{keywordflow}{if} (nmaster\_other != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07521}07521                           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07522}07522                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07523}07523                               << \textcolor{stringliteral}{"{}Value "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07524}07524                               << \textcolor{stringliteral}{"{} of node is not hanging whereas "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07525}07525                               << \textcolor{stringliteral}{"{} node on other proc has "{}} << nmaster\_other}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07526}07526                               << \textcolor{stringliteral}{"{} masters and therefore is hanging. \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07527}07527                             shout = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07528}07528                             shout\_and\_terminate = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07529}07529                           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07530}07530                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07531}07531                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07532}07532 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07533}07533                       \textcolor{keywordflow}{if} (shout)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07534}07534                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07535}07535                         \textcolor{comment}{// Report error. NOTE: ERROR IS THROWN BELOW ONCE}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07536}07536                         \textcolor{comment}{// ALL THIS HAS BEEN PROCESSED.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07537}07537 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07538}07538                         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07539}07539                           << \textcolor{stringliteral}{"{}Error(s) displayed above are for "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07540}07540                           << \textcolor{stringliteral}{"{}domain with non-\/halo (i.e. haloed) elem: "{}} << dd}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07541}07541                           << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07542}07542                         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07543}07543                           << \textcolor{stringliteral}{"{}Domain with    halo                elem: "{}} << d}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07544}07544                           << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07545}07545                         \textcolor{keywordflow}{switch} (nod\_dim)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07546}07546                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07547}07547                           \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07548}07548                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07549}07549                               << \textcolor{stringliteral}{"{}Current processor is "{}} << my\_rank << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07550}07550                               << \textcolor{stringliteral}{"{}Nodal positions: "{}} << x\_halo[0] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07551}07551                               << \textcolor{stringliteral}{"{}and haloed:      "{}} << x\_haloed[0]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07552}07552                               << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07553}07553                               \textcolor{comment}{//<< "{}Node pointer: "{} << finite\_el\_pt-\/>node\_pt(j)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07554}07554                               << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07555}07555                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07556}07556                           \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07557}07557                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07558}07558                               << \textcolor{stringliteral}{"{}Current processor is "{}} << my\_rank << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07559}07559                               << \textcolor{stringliteral}{"{}Nodal positions: "{}} << x\_halo[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07560}07560                               << x\_halo[1] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07561}07561                               << \textcolor{stringliteral}{"{}and haloed:      "{}} << x\_haloed[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07562}07562                               << x\_haloed[1]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07563}07563                               << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07564}07564                               \textcolor{comment}{//<< "{}Node pointer: "{} << finite\_el\_pt-\/>node\_pt(j)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07565}07565                               << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07566}07566                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07567}07567                           \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07568}07568                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07569}07569                               << \textcolor{stringliteral}{"{}Current processor is "{}} << my\_rank << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07570}07570                               << \textcolor{stringliteral}{"{}Nodal positions: "{}} << x\_halo[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07571}07571                               << x\_halo[1] << \textcolor{stringliteral}{"{} "{}} << x\_halo[2] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07572}07572                               << \textcolor{stringliteral}{"{}and haloed:      "{}} << x\_haloed[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07573}07573                               << x\_haloed[1] << \textcolor{stringliteral}{"{} "{}} << x\_haloed[2]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07574}07574                               << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07575}07575                               \textcolor{comment}{//<< "{}Node pointer: "{} << finite\_el\_pt-\/>node\_pt(j)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07576}07576                               << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07577}07577                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07578}07578                           \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07579}07579                             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07580}07580                               \textcolor{stringliteral}{"{}Nodal dimension not equal to 1, 2 or 3\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07581}07581                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07582}07582                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07583}07583                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07584}07584 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07585}07585 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07586}07586                         \textcolor{comment}{// If documenting, write to output files}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07587}07587                         \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07588}07588                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07589}07589                           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07590}07590                           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07591}07591                             haloed\_file << x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07592}07592                             halo\_file << x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{}  "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07593}07593                           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07594}07594                           haloed\_file << error << \textcolor{stringliteral}{"{} "{}} << my\_rank << \textcolor{stringliteral}{"{} "{}} << dd}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07595}07595                                       << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07596}07596                                       << finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>is\_hanging()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07597}07597                                       << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07598}07598                           halo\_file << error << \textcolor{stringliteral}{"{} "{}} << my\_rank << \textcolor{stringliteral}{"{} "{}} << dd}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07599}07599                                     << \textcolor{stringliteral}{"{} "{}} << other\_geom\_hanging << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07600}07600                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07601}07601                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07602}07602                     \} \textcolor{comment}{// j<nnod\_per\_el}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07603}07603                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07604}07604                 \} \textcolor{comment}{// e<nelem\_haloed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07605}07605 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07606}07606                 \textcolor{comment}{// If documenting, close output files}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07607}07607                 \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07608}07608                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07609}07609                   haloed\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07610}07610                   halo\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07611}07611                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07612}07612               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07613}07613             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07614}07614           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07615}07615         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07616}07616       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07617}07617       \textcolor{comment}{// My haloed elements are not being checked: Send my halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07618}07618       \textcolor{comment}{// whose non-\/halo counterparts are located on processor d}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07619}07619       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07620}07620       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07621}07621         \textcolor{comment}{// Get vectors of halo elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07622}07622         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} halo\_elem\_pt(\mbox{\hyperlink{classoomph_1_1Mesh_a882f5825ab0369b49d1d694f8e87d951}{halo\_element\_pt}}(d));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07623}07623 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07624}07624         \textcolor{comment}{// How many of my elements are halo elements whose non-\/halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07625}07625         \textcolor{comment}{// counterpart is located on processor d?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07626}07626         \textcolor{keywordtype}{unsigned} nelem\_halo = halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07627}07627 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07628}07628         \textcolor{keywordflow}{if} (nelem\_halo != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07629}07629         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07630}07630           \textcolor{comment}{// Send it across to the processor whose haloed nodes are being}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07631}07631           \textcolor{comment}{// checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07632}07632           MPI\_Send(\&nelem\_halo, 1, MPI\_UNSIGNED, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07633}07633 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07634}07634           \textcolor{comment}{// Only bother if the mesh consists of finite elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07635}07635           \textcolor{keywordflow}{if} (\textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0)))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07636}07636           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07637}07637             \textcolor{comment}{// Now string together the nodal positions of all halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07638}07638             \textcolor{comment}{// Use this only to work out roughly how much space to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07639}07639             \textcolor{comment}{// reserve for the vector. Then we can push data cheaply}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07640}07640             \textcolor{comment}{// while not assuming all elements have the same number}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07641}07641             \textcolor{comment}{// of nodes.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07642}07642             \textcolor{keywordtype}{unsigned} nnod\_first\_el = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07643}07643             \textcolor{keywordtype}{unsigned} nod\_dim = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07644}07644             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} nodal\_positions;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07645}07645             nodal\_positions.reserve(nod\_dim * nnod\_first\_el * nelem\_halo);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07646}07646 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07647}07647             \textcolor{comment}{// Storage for hang information}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07648}07648             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} nodal\_hangings;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07649}07649 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07650}07650             \textcolor{comment}{// unsigned count=0;}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07651}07651             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem\_halo; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07652}07652             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07653}07653               \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07654}07654                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07655}07655               \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07656}07656               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07657}07657                 \textcolor{keywordtype}{unsigned} nnod\_this\_el = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07658}07658                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod\_this\_el; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07659}07659                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07660}07660                   Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07661}07661                   \textcolor{comment}{// unsigned nod\_dim = nod\_pt-\/>ndim();}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07662}07662 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07663}07663                   \textcolor{comment}{// Throw error if node doesn't exist}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07664}07664                   \textcolor{keywordflow}{if} (nod\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07665}07665                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07666}07666                     \textcolor{comment}{// Print our nodes in element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07667}07667                     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}element: "{}} << finite\_el\_pt << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07668}07668                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07669}07669                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07670}07670                       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07671}07671                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07672}07672 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07673}07673                     \textcolor{comment}{// Throw error}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07674}07674                     \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Node doesn't exist!"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07675}07675                                         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07676}07676                                         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07677}07677                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07678}07678 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07679}07679                   \textcolor{comment}{// Testing POSITIONS, not x location (cf hanging nodes,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07680}07680                   \textcolor{comment}{// nodes.h)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07681}07681                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07682}07682                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07683}07683                     \textcolor{comment}{// nodal\_positions[count]=nod\_pt-\/>position(i);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07684}07684                     \textcolor{comment}{// count++;}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07685}07685                     nodal\_positions.push\_back(nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07686}07686                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07687}07687 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07688}07688                   \textcolor{keywordtype}{unsigned} nval = nod\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07689}07689                   nodal\_hangings.push\_back(nval);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07690}07690                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = -\/1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < int(nval); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07691}07691                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07692}07692                     \textcolor{keywordflow}{if} (nod\_pt-\/>is\_hanging(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07693}07693                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07694}07694                       \textcolor{keywordtype}{unsigned} nmaster = nod\_pt-\/>hanging\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07695}07695                       nodal\_hangings.push\_back(nmaster);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07696}07696                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07697}07697                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07698}07698                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07699}07699                       nodal\_hangings.push\_back(0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07700}07700                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07701}07701                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07702}07702                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07703}07703               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07704}07704             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07705}07705 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07706}07706             \textcolor{comment}{// Total number of nodal positions to be checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07707}07707             \textcolor{keywordtype}{unsigned} n\_nodal\_positions = nodal\_positions.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07708}07708 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07709}07709             \textcolor{comment}{// Total number of nodal hang information to be checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07710}07710             \textcolor{keywordtype}{unsigned} n\_nodal\_hangings = nodal\_hangings.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07711}07711 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07712}07712             \textcolor{comment}{// Send it across to the processor whose haloed elements are being}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07713}07713             \textcolor{comment}{// checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07714}07714             \textcolor{comment}{// MPI\_Send(\&nodal\_positions[0],nod\_dim*nnod\_per\_el*nelem\_halo,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07715}07715             \textcolor{comment}{//         MPI\_DOUBLE,d,0,comm\_pt-\/>mpi\_comm());}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07716}07716             MPI\_Send(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07717}07717               \&n\_nodal\_positions, 1, MPI\_UNSIGNED, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07718}07718             \textcolor{keywordflow}{if} (n\_nodal\_positions > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07719}07719             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07720}07720               MPI\_Send(\&nodal\_positions[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07721}07721                        n\_nodal\_positions,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07722}07722                        MPI\_DOUBLE,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07723}07723                        d,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07724}07724                        0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07725}07725                        \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07726}07726             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07727}07727             MPI\_Send(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07728}07728               \&n\_nodal\_hangings, 1, MPI\_UNSIGNED, d, 1, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07729}07729             \textcolor{keywordflow}{if} (n\_nodal\_hangings > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07730}07730             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07731}07731               MPI\_Send(\&nodal\_hangings[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07732}07732                        n\_nodal\_hangings,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07733}07733                        MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07734}07734                        d,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07735}07735                        1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07736}07736                        \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07737}07737             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07738}07738           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07739}07739         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07740}07740       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07741}07741     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07742}07742 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07743}07743     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Max. error for halo/haloed elements "{}} << max\_error}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07744}07744                << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07745}07745     \textcolor{keywordflow}{if} (max\_error > max\_permitted\_error\_for\_halo\_check)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07746}07746     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07747}07747       shout\_and\_terminate = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07748}07748       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}This is bigger than the permitted threshold "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07749}07749                  << max\_permitted\_error\_for\_halo\_check << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07750}07750       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07751}07751         << \textcolor{stringliteral}{"{}If you believe this to be acceptable for your problem\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07752}07752         << \textcolor{stringliteral}{"{}increase Problem::Max\_permitted\_error\_for\_halo\_check and re-\/run \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07753}07753     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07754}07754 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07755}07755     \textcolor{keywordflow}{if} (shout\_and\_terminate)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07756}07756     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07757}07757       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Error in halo checking"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07758}07758                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07759}07759                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07760}07760     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07761}07761 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07762}07762     \textcolor{comment}{// Now check the halo/haloed nodes lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07763}07763 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07764}07764     \textcolor{comment}{// Doc halo/haloed nodes lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07765}07765     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07766}07766     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07767}07767     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07768}07768       \textcolor{comment}{// Loop over domains for halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07769}07769       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07770}07770       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07771}07771         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07772}07772         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/halo\_node\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07773}07773                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07774}07774                  << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07775}07775         halo\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07776}07776         halo\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07777}07777 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07778}07778         \textcolor{keywordtype}{unsigned} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(dd);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07779}07779         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07780}07780         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07781}07781           Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_ad7ba73da180acb43523166ee71fb2e99}{halo\_node\_pt}}(dd, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07782}07782           \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07783}07783           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07784}07784           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07785}07785             halo\_file << nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07786}07786           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07787}07787           halo\_file << nod\_pt-\/>is\_hanging() << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07788}07788         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07789}07789         \textcolor{comment}{// Dummy output for processor that doesn't share halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07790}07790         \textcolor{comment}{// (needed for tecplot)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07791}07791         \textcolor{comment}{// (This will only work if there are elements on this processor...)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07792}07792         \textcolor{keywordflow}{if} ((nnod == 0) \&\& (\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}() != 0))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07793}07793         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07794}07794           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* f\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07795}07795           \textcolor{comment}{// If it's a generalised element mesh dummy output}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07796}07796           \textcolor{keywordflow}{if} (f\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07797}07797           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07798}07798             halo\_file << \textcolor{stringliteral}{"{}0.0"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07799}07799           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07800}07800           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07801}07801           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07802}07802             \textcolor{keywordtype}{unsigned} ndim = f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07803}07803             \textcolor{keywordflow}{if} (ndim == 2)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07804}07804             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07805}07805               halo\_file << \textcolor{stringliteral}{"{} 1.0 1.1 "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07806}07806             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07807}07807             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07808}07808             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07809}07809               halo\_file << \textcolor{stringliteral}{"{} 1.0 1.1 1.1"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07810}07810             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07811}07811           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07812}07812         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07813}07813         halo\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07814}07814       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07815}07815 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07816}07816 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07817}07817       \textcolor{comment}{// Loop over domains for haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07818}07818       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07819}07819       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07820}07820         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07821}07821         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/haloed\_node\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07822}07822                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07823}07823                  << d << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07824}07824         haloed\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07825}07825         haloed\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07826}07826 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07827}07827         \textcolor{keywordtype}{unsigned} nnod = \mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07828}07828         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07829}07829         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07830}07830           Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_ab29fbaa5e88f722de752b3fd642a75e4}{haloed\_node\_pt}}(d, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07831}07831           \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07832}07832           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07833}07833           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07834}07834             haloed\_file << nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07835}07835           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07836}07836           haloed\_file << nod\_pt-\/>is\_hanging() << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07837}07837         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07838}07838         \textcolor{comment}{// Dummy output for processor that doesn't share halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07839}07839         \textcolor{comment}{// (needed for tecplot)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07840}07840         \textcolor{keywordflow}{if} ((nnod == 0) \&\& (\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}() != 0))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07841}07841         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07842}07842           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* f\_el\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07843}07843           \textcolor{comment}{// If it's a generalised element mesh dummy output}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07844}07844           \textcolor{keywordflow}{if} (f\_el\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07845}07845           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07846}07846             haloed\_file << \textcolor{stringliteral}{"{}0.0"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07847}07847           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07848}07848           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07849}07849           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07850}07850             \textcolor{keywordtype}{unsigned} ndim = f\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07851}07851             \textcolor{keywordflow}{if} (ndim == 2)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07852}07852             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07853}07853               haloed\_file << \textcolor{stringliteral}{"{} 1.0 1.1 "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07854}07854             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07855}07855             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07856}07856             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07857}07857               haloed\_file << \textcolor{stringliteral}{"{} 1.0 1.1 1.1"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07858}07858             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07859}07859           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07860}07860         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07861}07861         haloed\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07862}07862       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07863}07863     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07864}07864 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07865}07865     \textcolor{comment}{// Check halo/haloed nodes lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07866}07866     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07867}07867     max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07868}07868 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07869}07869     \textcolor{comment}{// Loop over domains for haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07870}07870     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07871}07871     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07872}07872       \textcolor{comment}{// Are my haloed nodes being checked?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07873}07873       \textcolor{keywordflow}{if} (d == my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07874}07874       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07875}07875         \textcolor{comment}{// Loop over domains for halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07876}07876         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07877}07877         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07878}07878           \textcolor{comment}{// Don't talk to yourself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07879}07879           \textcolor{keywordflow}{if} (dd != d)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07880}07880           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07881}07881             \textcolor{comment}{// How many of my nodes are haloed nodes whose halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07882}07882             \textcolor{comment}{// counterpart is located on processor dd?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07883}07883             \textcolor{keywordtype}{int} nnod\_haloed = \mbox{\hyperlink{classoomph_1_1Mesh_ad3202cdf7b1b35f8b3db51430dbbb8c6}{nhaloed\_node}}(dd);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07884}07884 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07885}07885             \textcolor{keywordflow}{if} (nnod\_haloed != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07886}07886             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07887}07887               \textcolor{comment}{// Receive from processor dd how many of his nodes are halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07888}07888               \textcolor{comment}{// nodes whose non-\/halo counterparts are located here}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07889}07889               \textcolor{keywordtype}{int} nnod\_halo = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07890}07890               MPI\_Recv(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07891}07891                 \&nnod\_halo, 1, MPI\_INT, dd, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(), \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07892}07892 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07893}07893               \textcolor{keywordflow}{if} (nnod\_haloed != nnod\_halo)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07894}07894               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07895}07895                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07896}07896 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07897}07897                 error\_message << \textcolor{stringliteral}{"{}Clash in numbers of halo and haloed nodes! "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07898}07898                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07899}07899                 error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07900}07900                   << \textcolor{stringliteral}{"{}\# of haloed nodes whose halo counterpart lives on proc "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07901}07901                   << dd << \textcolor{stringliteral}{"{}: "{}} << nnod\_haloed << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07902}07902                 error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07903}07903                   << \textcolor{stringliteral}{"{}\# of halo nodes whose non-\/halo counterpart lives on proc "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07904}07904                   << d << \textcolor{stringliteral}{"{}: "{}} << nnod\_halo << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07905}07905                 error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07906}07906                   << \textcolor{stringliteral}{"{}(Re-\/)run Mesh::check\_halo\_schemes() with DocInfo object"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07907}07907                   << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07908}07908                 error\_message << \textcolor{stringliteral}{"{}to identify the problem"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07909}07909                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07910}07910                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07911}07911                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07912}07912               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07913}07913 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07914}07914 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07915}07915               \textcolor{keywordtype}{unsigned} nod\_dim = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07916}07916 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07917}07917               \textcolor{comment}{// Get strung-\/together nodal positions from other processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07918}07918               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} other\_nodal\_positions(nod\_dim * nnod\_halo);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07919}07919               MPI\_Recv(\&other\_nodal\_positions[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07920}07920                        nod\_dim * nnod\_halo,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07921}07921                        MPI\_DOUBLE,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07922}07922                        dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07923}07923                        0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07924}07924                        \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07925}07925                        \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07926}07926 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07927}07927               \textcolor{comment}{// Check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07928}07928               \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07929}07929               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < nnod\_halo; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07930}07930               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07931}07931                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_haloed(nod\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07932}07932                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07933}07933                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07934}07934                   x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = \mbox{\hyperlink{classoomph_1_1Mesh_ab29fbaa5e88f722de752b3fd642a75e4}{haloed\_node\_pt}}(dd, j)-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07935}07935                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07936}07936                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_halo(nod\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07937}07937                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07938}07938                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07939}07939                   x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = other\_nodal\_positions[count];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07940}07940                   count++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07941}07941                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07942}07942                 \textcolor{keywordtype}{double} error = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07943}07943                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07944}07944                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07945}07945                   error +=}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07946}07946                     (x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) * (x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07947}07947                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07948}07948                 error = sqrt(error);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07949}07949                 \textcolor{keywordflow}{if} (error > max\_error)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07950}07950                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07951}07951                   max\_error = error;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07952}07952                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07953}07953               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07954}07954             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07955}07955           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07956}07956         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07957}07957       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07958}07958       \textcolor{comment}{// My haloed nodes are not being checked: Send my halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07959}07959       \textcolor{comment}{// whose non-\/halo counterparts are located on processor d}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07960}07960       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07961}07961       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07962}07962         \textcolor{keywordtype}{int} nnod\_halo = \mbox{\hyperlink{classoomph_1_1Mesh_aa19080c0e68facf0e8c8ec55b327279f}{nhalo\_node}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07963}07963 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07964}07964         \textcolor{keywordflow}{if} (nnod\_halo != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07965}07965         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07966}07966           \textcolor{comment}{// Send it across to the processor whose haloed nodes are being}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07967}07967           \textcolor{comment}{// checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07968}07968           MPI\_Send(\&nnod\_halo, 1, MPI\_INT, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07969}07969 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07970}07970           \textcolor{keywordtype}{unsigned} nod\_dim = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07971}07971 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07972}07972           \textcolor{comment}{// Now string together the nodal positions of all halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07973}07973           \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} nodal\_positions(nod\_dim * nnod\_halo);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07974}07974           \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07975}07975           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < nnod\_halo; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07976}07976           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07977}07977             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07978}07978             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07979}07979               nodal\_positions[count] = \mbox{\hyperlink{classoomph_1_1Mesh_ad7ba73da180acb43523166ee71fb2e99}{halo\_node\_pt}}(d, j)-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07980}07980               count++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07981}07981             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07982}07982           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07983}07983           \textcolor{comment}{// Send it across to the processor whose haloed nodes are being}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07984}07984           \textcolor{comment}{// checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07985}07985           MPI\_Send(\&nodal\_positions[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07986}07986                    nod\_dim * nnod\_halo,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07987}07987                    MPI\_DOUBLE,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07988}07988                    d,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07989}07989                    0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07990}07990                    \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07991}07991         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07992}07992       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07993}07993     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07994}07994 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07995}07995     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Max. error for halo/haloed nodes "{}} << max\_error << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07996}07996 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07997}07997     \textcolor{keywordflow}{if} (max\_error > max\_permitted\_error\_for\_halo\_check)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07998}07998     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l07999}07999       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08000}08000       error\_message << \textcolor{stringliteral}{"{}This is bigger than the permitted threshold "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08001}08001                     << max\_permitted\_error\_for\_halo\_check << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08002}08002       error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08003}08003         << \textcolor{stringliteral}{"{}If you believe this to be acceptable for your problem\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08004}08004         << \textcolor{stringliteral}{"{}increase Problem::Max\_permitted\_error\_for\_halo\_check and re-\/run \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08005}08005       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08006}08006         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08007}08007     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08008}08008 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08009}08009 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08010}08010     \textcolor{comment}{// Now check the external halo/haloed element lookup scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08011}08011 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08012}08012     \textcolor{comment}{// Doc external halo/haoloed element lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08013}08013     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08014}08014     \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08015}08015     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08016}08016       \textcolor{comment}{// Loop over domains for external halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08017}08017       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08018}08018       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08019}08019         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08020}08020         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/ext\_halo\_element\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08021}08021                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08022}08022                  << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08023}08023         ext\_halo\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08024}08024         \mbox{\hyperlink{classoomph_1_1Mesh_a1bf4b7961c46409b20b33083d7537eba}{output\_external\_halo\_elements}}(dd, ext\_halo\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08025}08025         ext\_halo\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08026}08026 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08027}08027 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08028}08028         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08029}08029         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/ext\_halo\_node\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08030}08030                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08031}08031                  << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08032}08032         ext\_halo\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08033}08033 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08034}08034         \textcolor{comment}{// Get vectors of external halo/haloed elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08035}08035         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} ext\_halo\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08036}08036           \mbox{\hyperlink{classoomph_1_1Mesh_afb2def03c6259295dbd65303584edf31}{External\_halo\_element\_pt}}[dd]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08037}08037 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08038}08038         \textcolor{keywordtype}{unsigned} nelem = ext\_halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08039}08039 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08040}08040         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08041}08041         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08042}08042           ext\_halo\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08043}08043           \textcolor{comment}{// Can I cast to a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08044}08044           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08045}08045             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(ext\_halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08046}08046           \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08047}08047           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08048}08048             \textcolor{keywordtype}{unsigned} nnod = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08049}08049             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08050}08050             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08051}08051               Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08052}08052               \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08053}08053               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08054}08054               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08055}08055                 ext\_halo\_file << nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08056}08056               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08057}08057               ext\_halo\_file << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08058}08058             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08059}08059           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08060}08060         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08061}08061         ext\_halo\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08062}08062       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08063}08063 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08064}08064       \textcolor{comment}{// Loop over domains for external halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08065}08065       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08066}08066       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08067}08067         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08068}08068         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/ext\_haloed\_element\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08069}08069                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08070}08070                  << d << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08071}08071         ext\_haloed\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08072}08072         \mbox{\hyperlink{classoomph_1_1Mesh_a9b165e729938cf8d11e348969ea40a25}{output\_external\_haloed\_elements}}(d, ext\_haloed\_file);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08073}08073         ext\_haloed\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08074}08074 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08075}08075 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08076}08076         filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08077}08077         filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/ext\_haloed\_node\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08078}08078                  << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank << \textcolor{stringliteral}{"{}\_with\_proc"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08079}08079                  << d << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}() << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08080}08080         ext\_haloed\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08081}08081 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08082}08082         \textcolor{comment}{// Get vectors of external halo/haloed elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08083}08083         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} ext\_haloed\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08084}08084           \mbox{\hyperlink{classoomph_1_1Mesh_a3a031fedb3ebe4762e09c0416f2eaca2}{External\_haloed\_element\_pt}}[d]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08085}08085 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08086}08086         \textcolor{keywordtype}{unsigned} nelem2 = ext\_haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08087}08087         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem2; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08088}08088         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08089}08089           ext\_haloed\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08090}08090           \textcolor{comment}{// Is it a finite element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08091}08091           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08092}08092             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(ext\_haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08093}08093           \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08094}08094           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08095}08095             \textcolor{keywordtype}{unsigned} nnod2 = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08096}08096             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod2; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08097}08097             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08098}08098               Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08099}08099               \textcolor{keywordtype}{unsigned} ndim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08100}08100               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < ndim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08101}08101               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08102}08102                 ext\_haloed\_file << nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08103}08103               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08104}08104               ext\_haloed\_file << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08105}08105             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08106}08106           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08107}08107         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08108}08108         ext\_haloed\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08109}08109       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08110}08110     \} \textcolor{comment}{// end of if doc flag}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08111}08111 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08112}08112     \textcolor{comment}{// Check external halo/haloed element lookup schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08113}08113     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08114}08114     max\_error = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08115}08115     shout = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08116}08116     shout\_and\_terminate = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08117}08117 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08118}08118     \textcolor{comment}{// Loop over domains for external haloed elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08119}08119     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < n\_proc; d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08120}08120     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08121}08121       \textcolor{comment}{// Are my external haloed elements being checked?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08122}08122       \textcolor{keywordflow}{if} (d == my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08123}08123       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08124}08124         \textcolor{comment}{// Loop over domains for external halo elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08125}08125         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} dd = 0; dd < n\_proc; dd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08126}08126         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08127}08127           \textcolor{comment}{// Don't talk to yourself}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08128}08128           \textcolor{keywordflow}{if} (dd != d)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08129}08129           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08130}08130             \textcolor{comment}{// Get vectors of external haloed elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08131}08131             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} ext\_haloed\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08132}08132               \mbox{\hyperlink{classoomph_1_1Mesh_a3a031fedb3ebe4762e09c0416f2eaca2}{External\_haloed\_element\_pt}}[dd]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08133}08133 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08134}08134             \textcolor{comment}{// How many of my elements are external haloed elements whose halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08135}08135             \textcolor{comment}{// counterpart is located on processor dd?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08136}08136             \textcolor{keywordtype}{int} nelem\_haloed = ext\_haloed\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08137}08137 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08138}08138             \textcolor{keywordflow}{if} (nelem\_haloed != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08139}08139             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08140}08140               \textcolor{comment}{// Receive from processor dd how many of his elements are halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08141}08141               \textcolor{comment}{// nodes whose non-\/halo counterparts are located here}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08142}08142               \textcolor{keywordtype}{int} nelem\_halo = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08143}08143               MPI\_Recv(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08144}08144                 \&nelem\_halo, 1, MPI\_INT, dd, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(), \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08145}08145               \textcolor{keywordflow}{if} (nelem\_halo != nelem\_haloed)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08146}08146               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08147}08147                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08148}08148                 error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08149}08149                   << \textcolor{stringliteral}{"{}Clash in numbers of external halo and haloed elements! "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08150}08150                   << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08151}08151                 error\_message << \textcolor{stringliteral}{"{}\# of external haloed elements whose halo "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08152}08152                                  \textcolor{stringliteral}{"{}counterpart lives on proc "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08153}08153                               << dd << \textcolor{stringliteral}{"{}: "{}} << nelem\_haloed << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08154}08154                 error\_message << \textcolor{stringliteral}{"{}\# of external halo elements whose non-\/halo "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08155}08155                                  \textcolor{stringliteral}{"{}counterpart lives on proc "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08156}08156                               << d << \textcolor{stringliteral}{"{}: "{}} << nelem\_halo << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08157}08157                 error\_message << \textcolor{stringliteral}{"{}(Re-\/)run Problem::check\_halo\_schemes() with "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08158}08158                                  \textcolor{stringliteral}{"{}DocInfo object"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08159}08159                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08160}08160                 error\_message << \textcolor{stringliteral}{"{}to identify the problem"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08161}08161                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08162}08162                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08163}08163                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08164}08164               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08165}08165 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08166}08166 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08167}08167               \textcolor{comment}{// We can only check nodal stuff for meshes of finite elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08168}08168               \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08169}08169                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(ext\_haloed\_elem\_pt[0]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08170}08170               \textcolor{keywordflow}{if} (fe\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08171}08171               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08172}08172                 \textcolor{comment}{// Get strung-\/together elemental nodal positions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08173}08173                 \textcolor{comment}{// from other processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08174}08174                 \textcolor{comment}{// unsigned nnod\_per\_el=fe\_pt-\/>nnode();}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08175}08175                 \textcolor{keywordtype}{unsigned} nod\_dim = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08176}08176                 \textcolor{comment}{// Vector<double> other\_nodal\_positions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08177}08177                 \textcolor{comment}{// (nod\_dim*nnod\_per\_el*nelem\_halo);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08178}08178                 \textcolor{comment}{// MPI\_Recv(\&other\_nodal\_positions[0],nod\_dim*nnod\_per\_el*nelem\_halo,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08179}08179                 \textcolor{comment}{//         MPI\_DOUBLE,dd,0,comm\_pt-\/>mpi\_comm(),\&status);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08180}08180                 \textcolor{keywordtype}{unsigned} n\_nodal\_positions = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08181}08181                 MPI\_Recv(\&n\_nodal\_positions,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08182}08182                          1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08183}08183                          MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08184}08184                          dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08185}08185                          0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08186}08186                          \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08187}08187                          \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08188}08188                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} other\_nodal\_positions(n\_nodal\_positions);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08189}08189                 \textcolor{keywordflow}{if} (n\_nodal\_positions > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08190}08190                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08191}08191                   MPI\_Recv(\&other\_nodal\_positions[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08192}08192                            n\_nodal\_positions,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08193}08193                            MPI\_DOUBLE,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08194}08194                            dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08195}08195                            0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08196}08196                            \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08197}08197                            \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08198}08198                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08199}08199 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08200}08200 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08201}08201                 \textcolor{comment}{// Receive hanging info to be checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08202}08202                 \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} other\_nodal\_hangings;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08203}08203                 \textcolor{keywordtype}{unsigned} n\_other\_nodal\_hangings = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08204}08204                 MPI\_Recv(\&n\_other\_nodal\_hangings,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08205}08205                          1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08206}08206                          MPI\_UNSIGNED,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08207}08207                          dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08208}08208                          1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08209}08209                          \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08210}08210                          \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08211}08211                 \textcolor{keywordflow}{if} (n\_other\_nodal\_hangings > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08212}08212                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08213}08213                   other\_nodal\_hangings.resize(n\_other\_nodal\_hangings);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08214}08214                   MPI\_Recv(\&other\_nodal\_hangings[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08215}08215                            n\_other\_nodal\_hangings,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08216}08216                            MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08217}08217                            dd,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08218}08218                            1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08219}08219                            \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08220}08220                            \&status);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08221}08221                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08222}08222 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08223}08223                 \textcolor{comment}{// If documenting, open the output files}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08224}08224                 \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08225}08225                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08226}08226                   filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08227}08227                   filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/error\_ext\_haloed\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08228}08228                            << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08229}08229                            << \textcolor{stringliteral}{"{}\_with\_proc"{}} << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08230}08230                            << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08231}08231                   ext\_haloed\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08232}08232                   filename.str(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08233}08233                   filename << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a85d58bcfce0a7b7cae461624e6fcd08a}{directory}}() << \textcolor{stringliteral}{"{}/error\_ext\_halo\_check"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08234}08234                            << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a0ed2b6a12c476044ceb77a0d450ba43f}{label}}() << \textcolor{stringliteral}{"{}\_on\_proc"{}} << my\_rank}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08235}08235                            << \textcolor{stringliteral}{"{}\_with\_proc"{}} << dd << \textcolor{stringliteral}{"{}\_"{}} << doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a9d9ce638a7834bbd4961779af426bf13}{number}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08236}08236                            << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08237}08237                   ext\_halo\_file.open(filename.str().c\_str());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08238}08238                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08239}08239 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08240}08240                 \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08241}08241                 \textcolor{keywordtype}{unsigned} count\_hanging = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08242}08242                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem\_haloed; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08243}08243                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08244}08244                   \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08245}08245                     \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(ext\_haloed\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08246}08246 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08247}08247                   \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08248}08248                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08249}08249                     \textcolor{keywordtype}{unsigned} nnod\_this\_el = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08250}08250                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod\_this\_el; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08251}08251                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08252}08252                       Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08253}08253                       \textcolor{comment}{// unsigned nod\_dim = mod\_pt-\/>ndim();}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08254}08254 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08255}08255                       \textcolor{comment}{// Testing POSITIONS, not x location}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08256}08256                       \textcolor{comment}{// (cf hanging nodes, nodes.h)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08257}08257                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_haloed(nod\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08258}08258                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08259}08259                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08260}08260                         x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08261}08261                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08262}08262 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08263}08263                       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} x\_halo(nod\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08264}08264                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08265}08265                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08266}08266                         x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = other\_nodal\_positions[count];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08267}08267                         ++count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08268}08268                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08269}08269 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08270}08270                       \textcolor{keywordtype}{double} error = 0.0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08271}08271                       shout = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08272}08272                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08273}08273                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08274}08274                         error +=}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08275}08275                           (x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) * (x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] -\/ x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08276}08276                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08277}08277                       error = sqrt(error);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08278}08278 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08279}08279                       \textcolor{keywordflow}{if} (error > max\_error)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08280}08280                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08281}08281                         max\_error = error;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08282}08282                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08283}08283                       \textcolor{keywordtype}{double} tol = 1.0e-\/12;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08284}08284                       \textcolor{keywordflow}{if} (error > tol)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08285}08285                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08286}08286                         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Discrepancy between nodal coordinates "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08287}08287                                       \textcolor{stringliteral}{"{}of external halo(ed)"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08288}08288                                    << \textcolor{stringliteral}{"{}element larger than tolerance ("{}} << tol}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08289}08289                                    << \textcolor{stringliteral}{"{})\(\backslash\)n  Error: "{}} << error << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08290}08290                         shout = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08291}08291                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08292}08292 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08293}08293                       \textcolor{keywordtype}{unsigned} nval = nod\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08294}08294                       \textcolor{keywordtype}{int} nval\_other = other\_nodal\_hangings[count\_hanging];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08295}08295                       count\_hanging++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08296}08296                       \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}(nval) != nval\_other)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08297}08297                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08298}08298                         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08299}08299                           << \textcolor{stringliteral}{"{}Number of values of node, "{}} << nval}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08300}08300                           << \textcolor{stringliteral}{"{}, does not match number of values on other proc, "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08301}08301                           << nval\_other << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08302}08302                         shout = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08303}08303                         shout\_and\_terminate = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08304}08304                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08305}08305 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08306}08306                       \textcolor{comment}{// Is other node geometrically hanging?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08307}08307                       \textcolor{keywordtype}{int} other\_geom\_hanging = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08308}08308 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08309}08309                       \textcolor{comment}{// Check hangingness/number of master nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08310}08310                       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = -\/1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < int(nval); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08311}08311                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08312}08312                         \textcolor{keywordtype}{int} nmaster\_other = other\_nodal\_hangings[count\_hanging];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08313}08313                         count\_hanging++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08314}08314 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08315}08315                         \textcolor{comment}{// Record geom hang status of other node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08316}08316                         \textcolor{keywordflow}{if} (\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} == -\/1) other\_geom\_hanging = nmaster\_other;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08317}08317 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08318}08318                         \textcolor{comment}{// Value is hanging on local proc: Does it have the same}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08319}08319                         \textcolor{comment}{// number of masters as its counterpart on other proc?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08320}08320                         \textcolor{keywordflow}{if} (nod\_pt-\/>is\_hanging(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08321}08321                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08322}08322                           \textcolor{keywordtype}{unsigned} nmaster = nod\_pt-\/>hanging\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08323}08323                           \textcolor{keywordflow}{if} (\textcolor{keywordtype}{int}(nmaster) != nmaster\_other)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08324}08324                           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08325}08325                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08326}08326                               << \textcolor{stringliteral}{"{}Number of master nodes for hanging value "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08327}08327                               << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} of node, "{}} << nmaster}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08328}08328                               << \textcolor{stringliteral}{"{}, does not match number of master "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08329}08329                               << \textcolor{stringliteral}{"{}nodes on other proc, "{}} << nmaster\_other}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08330}08330                               << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08331}08331                             shout = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08332}08332                             shout\_and\_terminate = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08333}08333                           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08334}08334                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08335}08335                         \textcolor{comment}{// Value is not hanging on local proc: It had better}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08336}08336                         \textcolor{comment}{// not have any masters (i.e. be hanging) on the other}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08337}08337                         \textcolor{comment}{// proc}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08338}08338                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08339}08339                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08340}08340                           \textcolor{keywordflow}{if} (nmaster\_other != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08341}08341                           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08342}08342                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08343}08343                               << \textcolor{stringliteral}{"{}Value "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08344}08344                               << \textcolor{stringliteral}{"{} of node is not hanging whereas "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08345}08345                               << \textcolor{stringliteral}{"{} node on other proc has "{}} << nmaster\_other}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08346}08346                               << \textcolor{stringliteral}{"{} masters and therefore is hanging. \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08347}08347                             shout = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08348}08348                             shout\_and\_terminate = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08349}08349                           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08350}08350                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08351}08351                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08352}08352 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08353}08353                       \textcolor{keywordflow}{if} (shout)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08354}08354                       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08355}08355                         \textcolor{comment}{// Report error. NOTE: ERROR IS THROWN BELOW ONCE}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08356}08356                         \textcolor{comment}{// ALL THIS HAS BEEN PROCESSED.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08357}08357 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08358}08358                         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Error(s) displayed above are for "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08359}08359                                    << \textcolor{stringliteral}{"{}domain with external non-\/halo (i.e. "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08360}08360                                       \textcolor{stringliteral}{"{}haloed) elem: "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08361}08361                                    << dd << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08362}08362                         \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08363}08363                           << \textcolor{stringliteral}{"{}Domain with    halo                elem: "{}} << d}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08364}08364                           << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08365}08365                         \textcolor{keywordflow}{switch} (nod\_dim)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08366}08366                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08367}08367                           \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08368}08368                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08369}08369                               << \textcolor{stringliteral}{"{}Current processor is "{}} << my\_rank << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08370}08370                               << \textcolor{stringliteral}{"{}Nodal positions: "{}} << x\_halo[0] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08371}08371                               << \textcolor{stringliteral}{"{}and haloed:      "{}} << x\_haloed[0]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08372}08372                               << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08373}08373                               \textcolor{comment}{//<< "{}Node pointer: "{} << finite\_el\_pt-\/>node\_pt(j)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08374}08374                               << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08375}08375                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08376}08376                           \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08377}08377                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08378}08378                               << \textcolor{stringliteral}{"{}Current processor is "{}} << my\_rank << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08379}08379                               << \textcolor{stringliteral}{"{}Nodal positions: "{}} << x\_halo[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08380}08380                               << x\_halo[1] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08381}08381                               << \textcolor{stringliteral}{"{}and haloed:      "{}} << x\_haloed[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08382}08382                               << x\_haloed[1]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08383}08383                               << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08384}08384                               \textcolor{comment}{//<< "{}Node pointer: "{} << finite\_el\_pt-\/>node\_pt(j)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08385}08385                               << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08386}08386                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08387}08387                           \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08388}08388                             \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08389}08389                               << \textcolor{stringliteral}{"{}Current processor is "{}} << my\_rank << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08390}08390                               << \textcolor{stringliteral}{"{}Nodal positions: "{}} << x\_halo[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08391}08391                               << x\_halo[1] << \textcolor{stringliteral}{"{} "{}} << x\_halo[2] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08392}08392                               << \textcolor{stringliteral}{"{}and haloed:      "{}} << x\_haloed[0] << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08393}08393                               << x\_haloed[1] << \textcolor{stringliteral}{"{} "{}} << x\_haloed[2]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08394}08394                               << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08395}08395                               \textcolor{comment}{//<< "{}Node pointer: "{} << finite\_el\_pt-\/>node\_pt(j)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08396}08396                               << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08397}08397                             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08398}08398                           \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08399}08399                             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08400}08400                               \textcolor{stringliteral}{"{}Nodal dimension not equal to 1, 2 or 3\(\backslash\)n"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08401}08401                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08402}08402                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08403}08403                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08404}08404 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08405}08405 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08406}08406                         \textcolor{comment}{// If documenting, write to output files}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08407}08407                         \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08408}08408                         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08409}08409                           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08410}08410                           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08411}08411                             ext\_haloed\_file << x\_haloed[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08412}08412                             ext\_halo\_file << x\_halo[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] << \textcolor{stringliteral}{"{}  "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08413}08413                           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08414}08414                           ext\_haloed\_file}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08415}08415                             << error << \textcolor{stringliteral}{"{} "{}} << my\_rank << \textcolor{stringliteral}{"{} "{}} << dd << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08416}08416                             << finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j)-\/>is\_hanging()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08417}08417                             << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08418}08418                           ext\_halo\_file << error << \textcolor{stringliteral}{"{} "{}} << my\_rank << \textcolor{stringliteral}{"{} "{}} << dd}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08419}08419                                         << \textcolor{stringliteral}{"{} "{}} << other\_geom\_hanging}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08420}08420                                         << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08421}08421                         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08422}08422                       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08423}08423                     \} \textcolor{comment}{// j<nnod\_per\_el}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08424}08424                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08425}08425                 \} \textcolor{comment}{// e<nelem\_haloed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08426}08426 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08427}08427                 \textcolor{comment}{// If documenting, close output files}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08428}08428                 \textcolor{keywordflow}{if} (doc\_info.\mbox{\hyperlink{classoomph_1_1DocInfo_a2ce90cf54f24b4ab523c624031fbb76b}{is\_doc\_enabled}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08429}08429                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08430}08430                   ext\_haloed\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08431}08431                   ext\_halo\_file.close();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08432}08432                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08433}08433               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08434}08434             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08435}08435           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08436}08436         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08437}08437       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08438}08438       \textcolor{comment}{// My external haloed elements are not being checked: Send my halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08439}08439       \textcolor{comment}{// elements whose non-\/halo counterparts are located on processor d}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08440}08440       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08441}08441       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08442}08442         \textcolor{comment}{// Get vectors of external halo elements by copy operation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08443}08443         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}} ext\_halo\_elem\_pt(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08444}08444           \mbox{\hyperlink{classoomph_1_1Mesh_afb2def03c6259295dbd65303584edf31}{External\_halo\_element\_pt}}[d]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08445}08445 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08446}08446         \textcolor{comment}{// How many of my elements are external halo elements whose non-\/halo}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08447}08447         \textcolor{comment}{// counterpart is located on processor d?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08448}08448         \textcolor{keywordtype}{unsigned} nelem\_halo = ext\_halo\_elem\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08449}08449 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08450}08450         \textcolor{keywordflow}{if} (nelem\_halo != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08451}08451         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08452}08452           \textcolor{comment}{// Send it across to the processor whose external haloed nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08453}08453           \textcolor{comment}{// are being checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08454}08454           MPI\_Send(\&nelem\_halo, 1, MPI\_UNSIGNED, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08455}08455 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08456}08456           \textcolor{comment}{// Only bother if the mesh consists of finite elements}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08457}08457           \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* fe\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08458}08458             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(ext\_halo\_elem\_pt[0]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08459}08459           \textcolor{keywordflow}{if} (fe\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08460}08460           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08461}08461             \textcolor{comment}{// Now string together the nodal positions of all halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08462}08462             \textcolor{keywordtype}{unsigned} nnod\_first\_el = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08463}08463             \textcolor{keywordtype}{unsigned} nod\_dim = fe\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(0)-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08464}08464             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} nodal\_positions;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08465}08465             nodal\_positions.reserve(nod\_dim * nnod\_first\_el * nelem\_halo);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08466}08466 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08467}08467             \textcolor{comment}{// Storage for hang information}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08468}08468             \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} nodal\_hangings;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08469}08469 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08470}08470             \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08471}08471             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < nelem\_halo; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08472}08472             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08473}08473               \mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* finite\_el\_pt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08474}08474                 \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}*\textcolor{keyword}{>}(ext\_halo\_elem\_pt[\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08475}08475               \textcolor{keywordflow}{if} (finite\_el\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08476}08476               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08477}08477                 \textcolor{keywordtype}{unsigned} nnod\_this\_el = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08478}08478                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod\_this\_el; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08479}08479                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08480}08480                   Node* nod\_pt = finite\_el\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08481}08481 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08482}08482                   \textcolor{comment}{// Testing POSITIONS, not x location (cf hanging nodes,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08483}08483                   \textcolor{comment}{// nodes.h)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08484}08484                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nod\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08485}08485                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08486}08486                     nodal\_positions.push\_back(nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08487}08487                     count++;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08488}08488                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08489}08489 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08490}08490                   \textcolor{keywordtype}{unsigned} nval = nod\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08491}08491                   nodal\_hangings.push\_back(nval);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08492}08492                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = -\/1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < int(nval); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08493}08493                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08494}08494                     \textcolor{keywordflow}{if} (nod\_pt-\/>is\_hanging(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08495}08495                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08496}08496                       \textcolor{keywordtype}{unsigned} nmaster = nod\_pt-\/>hanging\_pt(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>nmaster();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08497}08497                       nodal\_hangings.push\_back(nmaster);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08498}08498                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08499}08499                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08500}08500                     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08501}08501                       nodal\_hangings.push\_back(0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08502}08502                     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08503}08503                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08504}08504                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08505}08505               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08506}08506             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08507}08507 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08508}08508             \textcolor{comment}{// Total number of nodal positions to be checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08509}08509             \textcolor{keywordtype}{unsigned} n\_nodal\_positions = nodal\_positions.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08510}08510 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08511}08511             \textcolor{comment}{// Total number of nodal hang information to be checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08512}08512             \textcolor{keywordtype}{unsigned} n\_nodal\_hangings = nodal\_hangings.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08513}08513 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08514}08514             \textcolor{comment}{// Send it across to the processor whose external haloed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08515}08515             \textcolor{comment}{// elements are being checked}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08516}08516             \textcolor{comment}{// MPI\_Send(\&nodal\_positions[0],nod\_dim*nnod\_per\_el*nelem\_halo,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08517}08517             \textcolor{comment}{//         MPI\_DOUBLE,d,0,comm\_pt-\/>mpi\_comm());}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08518}08518             MPI\_Send(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08519}08519               \&n\_nodal\_positions, 1, MPI\_UNSIGNED, d, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08520}08520             \textcolor{keywordflow}{if} (n\_nodal\_positions > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08521}08521             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08522}08522               MPI\_Send(\&nodal\_positions[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08523}08523                        n\_nodal\_positions,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08524}08524                        MPI\_DOUBLE,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08525}08525                        d,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08526}08526                        0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08527}08527                        \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08528}08528             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08529}08529             MPI\_Send(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08530}08530               \&n\_nodal\_hangings, 1, MPI\_UNSIGNED, d, 1, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08531}08531             \textcolor{keywordflow}{if} (n\_nodal\_hangings > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08532}08532             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08533}08533               MPI\_Send(\&nodal\_hangings[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08534}08534                        n\_nodal\_hangings,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08535}08535                        MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08536}08536                        d,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08537}08537                        1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08538}08538                        \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08539}08539             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08540}08540           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08541}08541         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08542}08542       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08543}08543     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08544}08544 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08545}08545     \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}Max. error for external halo/haloed elements "{}} << max\_error}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08546}08546                << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08547}08547     \textcolor{keywordflow}{if} (max\_error > max\_permitted\_error\_for\_halo\_check)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08548}08548     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08549}08549       shout\_and\_terminate = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08550}08550       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}} << \textcolor{stringliteral}{"{}This is bigger than the permitted threshold "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08551}08551                  << max\_permitted\_error\_for\_halo\_check << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08552}08552       \mbox{\hyperlink{namespaceoomph_aec474227917784dc0a255faf289cfc16}{oomph\_info}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08553}08553         << \textcolor{stringliteral}{"{}If you believe this to be acceptable for your problem\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08554}08554         << \textcolor{stringliteral}{"{}increase Problem::Max\_permitted\_error\_for\_halo\_check and re-\/run \(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08555}08555     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08556}08556 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08557}08557     \textcolor{keywordflow}{if} (shout\_and\_terminate)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08558}08558     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08559}08559       \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(\textcolor{stringliteral}{"{}Error in halo checking"{}},}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08560}08560                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08561}08561                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08562}08562     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08563}08563   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08564}08564 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08565}08565 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08566}08566   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08567}08567 \textcolor{comment}{  /// Null out specified external halo node (used when deleting duplicates)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08568}08568 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08569}\mbox{\hyperlink{classoomph_1_1Mesh_ae44a2c10b99136ec7ff3b31e67745d72}{08569}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_ae44a2c10b99136ec7ff3b31e67745d72}{Mesh::null\_external\_halo\_node}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& p, Node* nod\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08570}08570   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08571}08571     \textcolor{comment}{// Loop over all external halo nodes with specified processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08572}08572     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} ext\_halo\_node\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[p];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08573}08573     \textcolor{keywordtype}{unsigned} n = ext\_halo\_node\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08574}08574     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08575}08575     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08576}08576       \textcolor{keywordflow}{if} (ext\_halo\_node\_pt[j] == nod\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08577}08577       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08578}08578         \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[p][j] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08579}08579         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08580}08580       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08581}08581     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08582}08582   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08583}08583 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08584}08584 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08585}08585   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08586}08586 \textcolor{comment}{  /// Consolidate external halo node storage by removing nulled out}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08587}08587 \textcolor{comment}{  /// pointes in external halo and haloed schemes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08588}08588 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08589}\mbox{\hyperlink{classoomph_1_1Mesh_aee3e4769c2025c603a6eb90bed08fb9a}{08589}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_aee3e4769c2025c603a6eb90bed08fb9a}{Mesh::remove\_null\_pointers\_from\_external\_halo\_node\_storage}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08590}08590   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08591}08591     \textcolor{comment}{// Storage for number of processors and current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08592}08592     \textcolor{keywordtype}{int} n\_proc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08593}08593     \textcolor{keywordtype}{int} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08594}08594 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08595}08595     \textcolor{comment}{// Loop over all (other) processors and store index of any nulled-\/out}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08596}08596     \textcolor{comment}{// external halo nodes in storage scheme.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08597}08597 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08598}08598     \textcolor{comment}{// Data to be sent to each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08599}08599     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} send\_n(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08600}08600 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08601}08601     \textcolor{comment}{// Storage for all values to be sent to all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08602}08602     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} send\_data;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08603}08603 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08604}08604     \textcolor{comment}{// Start location within send\_data for data to be sent to each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08605}08605     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} send\_displacement(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08606}08606 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08607}08607     \textcolor{comment}{// Check missing ones}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08608}08608     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} domain = 0; domain < n\_proc; domain++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08609}08609     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08610}08610       \textcolor{comment}{// Set the offset for the current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08611}08611       send\_displacement[domain] = send\_data.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08612}08612 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08613}08613       \textcolor{comment}{// Don't bother to do anything if the processor in the loop is the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08614}08614       \textcolor{comment}{// current processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08615}08615       \textcolor{keywordflow}{if} (domain != my\_rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08616}08616       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08617}08617         \textcolor{comment}{// Make backup of external halo node pointers with this domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08618}08618         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} backup\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[domain];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08619}08619 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08620}08620         \textcolor{comment}{// Wipe}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08621}08621         \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[domain].clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08622}08622 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08623}08623         \textcolor{comment}{// How many do we have currently?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08624}08624         \textcolor{keywordtype}{unsigned} nnod = backup\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08625}08625         \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[domain].reserve(nnod);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08626}08626 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08627}08627         \textcolor{comment}{// Loop over external halo nodes with this domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08628}08628         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08629}08629         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08630}08630           \textcolor{comment}{// Get pointer to node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08631}08631           Node* nod\_pt = backup\_pt[j];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08632}08632 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08633}08633           \textcolor{comment}{// Has it been nulled out?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08634}08634           \textcolor{keywordflow}{if} (nod\_pt == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08635}08635           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08636}08636             \textcolor{comment}{// Save index of nulled out one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08637}08637             send\_data.push\_back(j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08638}08638           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08639}08639           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08640}08640           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08641}08641             \textcolor{comment}{// Still alive: Copy across}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08642}08642             \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[domain].push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08643}08643           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08644}08644         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08645}08645       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08646}08646 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08647}08647       \textcolor{comment}{// End of data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08648}08648       send\_data.push\_back(-\/1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08649}08649 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08650}08650       \textcolor{comment}{// Find the number of data added to the vector}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08651}08651       send\_n[domain] = send\_data.size() -\/ send\_displacement[domain];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08652}08652     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08653}08653 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08654}08654 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08655}08655     \textcolor{comment}{// Storage for the number of data to be received from each processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08656}08656     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} receive\_n(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08657}08657 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08658}08658     \textcolor{comment}{// Now send numbers of data to be sent between all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08659}08659     MPI\_Alltoall(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08660}08660       \&send\_n[0], 1, MPI\_INT, \&receive\_n[0], 1, MPI\_INT, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08661}08661 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08662}08662 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08663}08663     \textcolor{comment}{// We now prepare the data to be received}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08664}08664     \textcolor{comment}{// by working out the displacements from the received data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08665}08665     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} receive\_displacement(n\_proc, 0);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08666}08666     \textcolor{keywordtype}{int} receive\_data\_count = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08667}08667     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} rank = 0; rank < n\_proc; ++rank)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08668}08668     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08669}08669       \textcolor{comment}{// Displacement is number of data received so far}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08670}08670       receive\_displacement[rank] = receive\_data\_count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08671}08671       receive\_data\_count += receive\_n[rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08672}08672     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08673}08673 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08674}08674     \textcolor{comment}{// Now resize the receive buffer for all data from all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08675}08675     \textcolor{comment}{// Make sure that it has a size of at least one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08676}08676     \textcolor{keywordflow}{if} (receive\_data\_count == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08677}08677     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08678}08678       ++receive\_data\_count;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08679}08679     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08680}08680     \mbox{\hyperlink{classoomph_1_1Vector}{Vector<int>}} receive\_data(receive\_data\_count);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08681}08681 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08682}08682     \textcolor{comment}{// Make sure that the send buffer has size at least one}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08683}08683     \textcolor{comment}{// so that we don't get a segmentation fault}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08684}08684     \textcolor{keywordflow}{if} (send\_data.size() == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08685}08685     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08686}08686       send\_data.resize(1);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08687}08687     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08688}08688 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08689}08689     \textcolor{comment}{// Now send the data between all the processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08690}08690     MPI\_Alltoallv(\&send\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08691}08691                   \&send\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08692}08692                   \&send\_displacement[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08693}08693                   MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08694}08694                   \&receive\_data[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08695}08695                   \&receive\_n[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08696}08696                   \&receive\_displacement[0],}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08697}08697                   MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08698}08698                   \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08699}08699 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08700}08700     \textcolor{comment}{// Now use the received data}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08701}08701     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} send\_rank = 0; send\_rank < n\_proc; send\_rank++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08702}08702     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08703}08703       \textcolor{comment}{// Don't bother to do anything for the processor corresponding to the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08704}08704       \textcolor{comment}{// current processor or if no data were received from this processor}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08705}08705       \textcolor{keywordflow}{if} ((send\_rank != my\_rank) \&\& (receive\_n[send\_rank] != 0))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08706}08706       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08707}08707         \textcolor{comment}{// Counter for the data within the large array}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08708}08708         \textcolor{keywordtype}{unsigned} count = receive\_displacement[send\_rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08709}08709 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08710}08710         \textcolor{comment}{// Unpack until we reach "{}end of data"{} indicator (-\/1)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08711}08711         \textcolor{keywordflow}{while} (\textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08712}08712         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08713}08713           \textcolor{comment}{// Read next entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08714}08714           \textcolor{keywordtype}{int} next\_one = receive\_data[count++];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08715}08715 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08716}08716           \textcolor{keywordflow}{if} (next\_one == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08717}08717           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08718}08718             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08719}08719           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08720}08720           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08721}08721           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08722}08722             \textcolor{comment}{// Null out the entry}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08723}08723             \mbox{\hyperlink{classoomph_1_1Mesh_a6af0686ce8758874520426cfac5e7899}{External\_haloed\_node\_pt}}[send\_rank][next\_one] = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08724}08724           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08725}08725         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08726}08726 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08727}08727         \textcolor{comment}{// Make backup of external haloed node pointers with this domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08728}08728         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}} backup\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a6af0686ce8758874520426cfac5e7899}{External\_haloed\_node\_pt}}[send\_rank];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08729}08729 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08730}08730         \textcolor{comment}{// Wipe}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08731}08731         \mbox{\hyperlink{classoomph_1_1Mesh_a6af0686ce8758874520426cfac5e7899}{External\_haloed\_node\_pt}}[send\_rank].clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08732}08732 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08733}08733         \textcolor{comment}{// How many do we have currently?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08734}08734         \textcolor{keywordtype}{unsigned} nnod = backup\_pt.size();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08735}08735         \mbox{\hyperlink{classoomph_1_1Mesh_a6af0686ce8758874520426cfac5e7899}{External\_haloed\_node\_pt}}[send\_rank].reserve(nnod);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08736}08736 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08737}08737         \textcolor{comment}{// Loop over external haloed nodes with this domain}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08738}08738         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08739}08739         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08740}08740           \textcolor{comment}{// Get pointer to node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08741}08741           Node* nod\_pt = backup\_pt[j];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08742}08742 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08743}08743           \textcolor{comment}{// Has it been nulled out?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08744}08744           \textcolor{keywordflow}{if} (nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08745}08745           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08746}08746             \textcolor{comment}{// Still alive: Copy across}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08747}08747             \mbox{\hyperlink{classoomph_1_1Mesh_a6af0686ce8758874520426cfac5e7899}{External\_haloed\_node\_pt}}[send\_rank].push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08748}08748           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08749}08749         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08750}08750       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08751}08751 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08752}08752     \} \textcolor{comment}{// End of data is received}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08753}08753   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08754}08754 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08755}08755 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08756}08756 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08757}08757 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08758}08758   \textcolor{comment}{// =================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08759}08759 \textcolor{comment}{  /// Get the number of dof types in the mesh from the first element of the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08760}08760 \textcolor{comment}{  /// mesh. If MPI is on then also do some consistency checks between}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08761}08761 \textcolor{comment}{  /// processors. \(\backslash\)b Careful: Involves MPI Broadcasts and must therefore be}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08762}08762 \textcolor{comment}{  /// called on all processors!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08763}08763 \textcolor{comment}{}  \textcolor{comment}{// =================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08764}\mbox{\hyperlink{classoomph_1_1Mesh_a16225f0094eeb234460f6cf963099c85}{08764}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1Mesh_a16225f0094eeb234460f6cf963099c85}{Mesh::ndof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08765}08765 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08766}08766     \textcolor{comment}{// Remains -\/1 if we don't have any elements on this processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08767}08767     \textcolor{keywordtype}{int} int\_ndof\_types = -\/1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08768}08768     \textcolor{keywordtype}{unsigned} nel = \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08769}08769     \textcolor{keywordflow}{if} (nel > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08770}08770     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08771}08771       int\_ndof\_types = \mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0)-\/>ndof\_types();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08772}08772 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08773}08773       \textcolor{comment}{// Check that every element in this mesh has the same number of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08774}08774       \textcolor{comment}{// types of DOF.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08775}08775       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < nel; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08776}08776       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08777}08777         \textcolor{keywordflow}{if} (int\_ndof\_types != \textcolor{keywordtype}{int}(\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a16225f0094eeb234460f6cf963099c85}{ndof\_types}}()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08778}08778         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08779}08779           std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08780}08780           error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08781}08781             << \textcolor{stringliteral}{"{}Every element in the mesh must have the same number of "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08782}08782             << \textcolor{stringliteral}{"{}types of DOF for ndof\_types() to work\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08783}08783             << \textcolor{stringliteral}{"{}Element 0 has "{}} << int\_ndof\_types << \textcolor{stringliteral}{"{} DOF types\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08784}08784             << \textcolor{stringliteral}{"{}Element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} [out of a total of "{}} << nel << \textcolor{stringliteral}{"{} ] has "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08785}08785             << \mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>ndof\_types() << \textcolor{stringliteral}{"{} DOF types"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08786}08786             << \textcolor{stringliteral}{"{}Element types are: Element 0:"{}} << \textcolor{keyword}{typeid}(*\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(0)).name()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08787}08787             << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08788}08788             << \textcolor{stringliteral}{"{}           Current Element  :"{}} << \textcolor{keyword}{typeid}(*\mbox{\hyperlink{classoomph_1_1Mesh_aaa46cc70f706199e91fa58aef74763c2}{element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})).name()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08789}08789             << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08790}08790           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08791}08791                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08792}08792                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08793}08793         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08794}08794       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08795}08795 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08796}08796     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08797}08797 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08798}08798 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08799}08799 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08800}08800     \textcolor{comment}{// If mesh is distributed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08801}08801     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a1ab35b022b95f2d28c53aa58859bd6b5}{is\_mesh\_distributed}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08802}08802     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08803}08803       \textcolor{comment}{// if more than one processor then}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08804}08804       \textcolor{comment}{// + ensure number of DOFs is consistent on each processor (PARANOID)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08805}08805       \textcolor{comment}{// + ensure processors with no elements in this mesh have the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08806}08806       \textcolor{comment}{//   correct number of DOF types}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08807}08807       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc() > 1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08808}08808       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08809}08809         \textcolor{keywordtype}{unsigned} nproc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08810}08810         \textcolor{keywordtype}{unsigned} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08811}08811 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08812}08812         \textcolor{comment}{// Collect on root the number of dofs types determined independently}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08813}08813         \textcolor{comment}{// on all processors (-\/1 indicates that the processor didn't have}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08814}08814         \textcolor{comment}{// any elements and therefore doesn't know!)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08815}08815         \textcolor{keywordtype}{int}* ndof\_types\_recv = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08816}08816         \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08817}08817         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08818}08818           ndof\_types\_recv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[nproc];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08819}08819         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08820}08820 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08821}08821         MPI\_Gather(\&int\_ndof\_types,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08822}08822                    1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08823}08823                    MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08824}08824                    ndof\_types\_recv,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08825}08825                    1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08826}08826                    MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08827}08827                    0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08828}08828                    \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08829}08829 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08830}08830         \textcolor{comment}{// Root: Update own number of dof types, check consistency amongst}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08831}08831         \textcolor{comment}{// all processors (in paranoid mode) and send out the actual}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08832}08832         \textcolor{comment}{// number of dof types to those processors who couldn't figure this}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08833}08833         \textcolor{comment}{// out themselves}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08834}08834         \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08835}08835         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08836}08836           \textcolor{comment}{// Check number of types of all non-\/root processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08837}08837           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 1; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08838}08838           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08839}08839             \textcolor{keywordflow}{if} (ndof\_types\_recv[p] != -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08840}08840             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08841}08841               \textcolor{comment}{// Processor p was able to figure out how many}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08842}08842               \textcolor{comment}{// dof types there are, so I root can update}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08843}08843               \textcolor{comment}{// its own (if required)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08844}08844               \textcolor{keywordflow}{if} (int\_ndof\_types == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08845}08845               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08846}08846                 int\_ndof\_types = ndof\_types\_recv[p];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08847}08847               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08848}08848 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08849}08849               \textcolor{comment}{// Check consistency}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08850}08850               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (int\_ndof\_types != ndof\_types\_recv[p])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08851}08851               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08852}08852                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08853}08853                 error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08854}08854                   << \textcolor{stringliteral}{"{}The elements in this mesh must have the same number "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08855}08855                   << \textcolor{stringliteral}{"{}of types of DOF on each processor"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08856}08856                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08857}08857                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08858}08858                   \textcolor{keywordflow}{if} (ndof\_types\_recv[p] != -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08859}08859                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08860}08860                     error\_message << \textcolor{stringliteral}{"{}Processor "{}} << p << \textcolor{stringliteral}{"{} : "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08861}08861                                   << ndof\_types\_recv[p] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08862}08862                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08863}08863                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08864}08864                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08865}08865                     error\_message << \textcolor{stringliteral}{"{}Processor "{}} << p << \textcolor{stringliteral}{"{} : (no elements)\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08866}08866                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08867}08867                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08868}08868                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08869}08869                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08870}08870                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08871}08871               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08872}08872 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08873}08873             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08874}08874           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08875}08875 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08876}08876           \textcolor{comment}{// Now send ndof types to non-\/root processors that don't have it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08877}08877           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 1; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08878}08878           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08879}08879             \textcolor{keywordflow}{if} (ndof\_types\_recv[p] == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08880}08880             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08881}08881               MPI\_Send(\&int\_ndof\_types, 1, MPI\_INT, p, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08882}08882             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08883}08883           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08884}08884           \textcolor{comment}{// clean up}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08885}08885           \textcolor{keyword}{delete}[] ndof\_types\_recv;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08886}08886         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08887}08887         \textcolor{comment}{// "{}else if"{}: "{}else"{} for non-\/root; "{}if"{} for checking if current}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08888}08888         \textcolor{comment}{// (non-\/root) processor does not know ndof type and is therefore}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08889}08889         \textcolor{comment}{// about to receive it from root.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08890}08890         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (int\_ndof\_types == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08891}08891         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08892}08892           MPI\_Recv(\&int\_ndof\_types,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08893}08893                    1,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08894}08894                    MPI\_INT,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08895}08895                    0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08896}08896                    0,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08897}08897                    \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08898}08898                    MPI\_STATUS\_IGNORE);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08899}08899         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08900}08900       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08901}08901     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08902}08902 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08903}08903 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08904}08904     \textcolor{comment}{// If int\_ndof\_types if still -\/1 then no elements were found for this mesh,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08905}08905     \textcolor{comment}{// so it has no dofs.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08906}08906     \textcolor{keywordflow}{if} (int\_ndof\_types == -\/1) int\_ndof\_types = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08907}08907 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08908}08908     \textcolor{keywordflow}{return} unsigned(int\_ndof\_types);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08909}08909   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08910}08910 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08911}08911   \textcolor{comment}{// =================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08912}08912 \textcolor{comment}{  /// Get the number of elemental dimension in the mesh from the first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08913}08913 \textcolor{comment}{  /// element of the mesh. If MPI is on then also do some consistency}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08914}08914 \textcolor{comment}{  /// checks between processors. \(\backslash\)b Careful: Involves MPI Broadcasts}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08915}08915 \textcolor{comment}{  /// and must therefore be called on all processors!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08916}08916 \textcolor{comment}{}  \textcolor{comment}{// =================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08917}\mbox{\hyperlink{classoomph_1_1Mesh_a700a3c461df1c52534d7f6e303a0ebb6}{08917}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1Mesh_a700a3c461df1c52534d7f6e303a0ebb6}{Mesh::elemental\_dimension}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08918}08918 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08919}08919     \textcolor{comment}{// Remains -\/1 if we don't have any elements on this processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08920}08920     \textcolor{keywordtype}{int} int\_dim = -\/1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08921}08921     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}() > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08922}08922     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08923}08923       int\_dim = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08924}08924 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08925}08925       \textcolor{comment}{// Check that every element in this mesh has the same number of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08926}08926       \textcolor{comment}{// types of elemental dimension.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08927}08927       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08928}08928       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08929}08929         \textcolor{keywordflow}{if} (int\_dim != \textcolor{keywordtype}{int}(\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>dim()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08930}08930         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08931}08931           std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08932}08932           error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08933}08933             << \textcolor{stringliteral}{"{}Every element in the mesh must have the same number of "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08934}08934             << \textcolor{stringliteral}{"{}elemental dimension for elemental\_dimension() to work.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08935}08935             << \textcolor{stringliteral}{"{}Element 0 has elemental dimension "{}} << int\_dim << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08936}08936             << \textcolor{stringliteral}{"{}Element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} has elemental dimension "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08937}08937             << \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}() << \textcolor{stringliteral}{"{}."{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08938}08938           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08939}08939                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08940}08940                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08941}08941         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08942}08942       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08943}08943 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08944}08944     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08945}08945 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08946}08946 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08947}08947 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08948}08948     \textcolor{comment}{// If mesh is distributed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08949}08949     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}} != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08950}08950     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08951}08951       \textcolor{comment}{// if more than one processor then}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08952}08952       \textcolor{comment}{// + ensure dimension number is consistent on each processor (PARANOID)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08953}08953       \textcolor{comment}{// + ensure processors with no elements in this mesh have the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08954}08954       \textcolor{comment}{//   correct dimension number.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08955}08955       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc() > 1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08956}08956       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08957}08957         \textcolor{keywordtype}{unsigned} nproc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08958}08958         \textcolor{keywordtype}{unsigned} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08959}08959 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08960}08960         \textcolor{comment}{// Collect on root the dimension number determined independently}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08961}08961         \textcolor{comment}{// on all processors (-\/1 indicates that the processor didn't have}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08962}08962         \textcolor{comment}{// any elements and therefore doesn't know!)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08963}08963         \textcolor{keywordtype}{int}* dim\_recv = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08964}08964         \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08965}08965         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08966}08966           dim\_recv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[nproc];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08967}08967         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08968}08968 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08969}08969         MPI\_Gather(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08970}08970           \&int\_dim, 1, MPI\_INT, dim\_recv, 1, MPI\_INT, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08971}08971 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08972}08972         \textcolor{comment}{// Root: Update own dimension, check consistency amongst}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08973}08973         \textcolor{comment}{// all processors (in paranoid mode) and send out the actual}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08974}08974         \textcolor{comment}{// dimension number to those processors who couldn't figure this}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08975}08975         \textcolor{comment}{// out themselves}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08976}08976         \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08977}08977         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08978}08978           \textcolor{comment}{// Check number of types of all non-\/root processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08979}08979           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 1; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08980}08980           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08981}08981             \textcolor{keywordflow}{if} (dim\_recv[p] != -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08982}08982             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08983}08983               \textcolor{comment}{// Processor p was able to figure out the elemental}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08984}08984               \textcolor{comment}{// dimension, so I root can update}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08985}08985               \textcolor{comment}{// its own (if required)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08986}08986               \textcolor{keywordflow}{if} (int\_dim == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08987}08987               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08988}08988                 int\_dim = dim\_recv[p];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08989}08989               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08990}08990 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08991}08991               \textcolor{comment}{// Check consistency}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08992}08992               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (int\_dim != dim\_recv[p])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08993}08993               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08994}08994                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08995}08995                 error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08996}08996                   << \textcolor{stringliteral}{"{}The elements in this mesh must have the same elemental "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08997}08997                   << \textcolor{stringliteral}{"{}dimension number on each processor"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08998}08998                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l08999}08999                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09000}09000                   \textcolor{keywordflow}{if} (dim\_recv[p] != -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09001}09001                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09002}09002                     error\_message << \textcolor{stringliteral}{"{}Processor "{}} << p << \textcolor{stringliteral}{"{} : "{}} << dim\_recv[p]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09003}09003                                   << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09004}09004                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09005}09005                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09006}09006                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09007}09007                     error\_message << \textcolor{stringliteral}{"{}Processor "{}} << p << \textcolor{stringliteral}{"{} : (no elements)\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09008}09008                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09009}09009                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09010}09010                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09011}09011                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09012}09012                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09013}09013               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09014}09014 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09015}09015             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09016}09016           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09017}09017 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09018}09018           \textcolor{comment}{// Now send the elemental dimension to non-\/root processors that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09019}09019           \textcolor{comment}{// don't have it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09020}09020           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 1; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09021}09021           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09022}09022             \textcolor{keywordflow}{if} (dim\_recv[p] == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09023}09023             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09024}09024               MPI\_Send(\&int\_dim, 1, MPI\_INT, p, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09025}09025             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09026}09026           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09027}09027           \textcolor{comment}{// clean up}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09028}09028           \textcolor{keyword}{delete}[] dim\_recv;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09029}09029         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09030}09030         \textcolor{comment}{// "{}else if"{}: "{}else"{} for non-\/root; "{}if"{} for checking if current}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09031}09031         \textcolor{comment}{// (non-\/root) processor does not know elemental dimension and is}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09032}09032         \textcolor{comment}{// therefore about to receive it from root.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09033}09033         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (int\_dim == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09034}09034         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09035}09035           MPI\_Recv(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09036}09036             \&int\_dim, 1, MPI\_INT, 0, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(), MPI\_STATUS\_IGNORE);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09037}09037         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09038}09038       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09039}09039     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09040}09040 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09041}09041 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09042}09042     \textcolor{comment}{// If int\_dim if still -\/1 then no elements were found for this mesh, so it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09043}09043     \textcolor{comment}{// has no elemental dimension.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09044}09044     \textcolor{keywordflow}{if} (int\_dim == -\/1) int\_dim = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09045}09045 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09046}09046     \textcolor{keywordflow}{return} unsigned(int\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09047}09047   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09048}09048 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09049}09049   \textcolor{comment}{// =================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09050}09050 \textcolor{comment}{  /// Get the number of nodal dimension in the mesh from the first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09051}09051 \textcolor{comment}{  /// element of the mesh. If MPI is on then also do some consistency}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09052}09052 \textcolor{comment}{  /// checks between processors. \(\backslash\)b Careful: Involves MPI Broadcasts}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09053}09053 \textcolor{comment}{  /// and must therefore be called on all processors!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09054}09054 \textcolor{comment}{}  \textcolor{comment}{// =================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09055}\mbox{\hyperlink{classoomph_1_1Mesh_a32c8d3d454d3ba912b04985cb63e6a3c}{09055}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1Mesh_a32c8d3d454d3ba912b04985cb63e6a3c}{Mesh::nodal\_dimension}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09056}09056 \textcolor{keyword}{  }\{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09057}09057     \textcolor{comment}{// Remains -\/1 if we don't have any elements on this processor.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09058}09058     \textcolor{keywordtype}{int} int\_dim = -\/1;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09059}09059     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}() > 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09060}09060     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09061}09061       int\_dim = \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(0)-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_ab6602b43c3a2f1a5e48729b0b23c0d91}{nodal\_dimension}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09062}09062 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09063}09063       \textcolor{comment}{// Check that every element in this mesh has the same number of}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09064}09064       \textcolor{comment}{// types of nodal dimension.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09065}09065       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1Mesh_af01dfefb66c15579b540be62999d93ee}{nelement}}(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09066}09066       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09067}09067         \textcolor{keywordflow}{if} (int\_dim != \textcolor{keywordtype}{int}(\mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>\mbox{\hyperlink{classoomph_1_1Mesh_a32c8d3d454d3ba912b04985cb63e6a3c}{nodal\_dimension}}()))}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09068}09068         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09069}09069           std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09070}09070           error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09071}09071             << \textcolor{stringliteral}{"{}Every element in the mesh must have the same number of "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09072}09072             << \textcolor{stringliteral}{"{}nodal dimension for nodal\_dimension() to work.\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09073}09073             << \textcolor{stringliteral}{"{}Element 0 has nodal dimension "{}} << int\_dim << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09074}09074             << \textcolor{stringliteral}{"{}Element "{}} << \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} << \textcolor{stringliteral}{"{} has nodal dimension "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09075}09075             << \mbox{\hyperlink{classoomph_1_1Mesh_a479059b0964826a8cee6eb506b57268a}{finite\_element\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_ab6602b43c3a2f1a5e48729b0b23c0d91}{nodal\_dimension}}() << \textcolor{stringliteral}{"{}."{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09076}09076           \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09077}09077                               OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09078}09078                               OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09079}09079         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09080}09080       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09081}09081 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09082}09082     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09083}09083 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09084}09084 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09085}09085 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09086}09086     \textcolor{comment}{// If mesh is distributed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09087}09087     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}} != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09088}09088     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09089}09089       \textcolor{comment}{// if more than one processor then}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09090}09090       \textcolor{comment}{// + ensure dimension number is consistent on each processor (PARANOID)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09091}09091       \textcolor{comment}{// + ensure processors with no elements in this mesh have the}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09092}09092       \textcolor{comment}{//   correct dimension number.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09093}09093       \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc() > 1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09094}09094       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09095}09095         \textcolor{keywordtype}{unsigned} nproc = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09096}09096         \textcolor{keywordtype}{unsigned} my\_rank = \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>my\_rank();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09097}09097 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09098}09098         \textcolor{comment}{// Collect on root the dimension number determined independently}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09099}09099         \textcolor{comment}{// on all processors (-\/1 indicates that the processor didn't have}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09100}09100         \textcolor{comment}{// any elements and therefore doesn't know!)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09101}09101         \textcolor{keywordtype}{int}* dim\_recv = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09102}09102         \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09103}09103         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09104}09104           dim\_recv = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[nproc];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09105}09105         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09106}09106 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09107}09107         MPI\_Gather(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09108}09108           \&int\_dim, 1, MPI\_INT, dim\_recv, 1, MPI\_INT, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09109}09109 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09110}09110         \textcolor{comment}{// Root: Update own dimension, check consistency amongst}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09111}09111         \textcolor{comment}{// all processors (in paranoid mode) and send out the actual}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09112}09112         \textcolor{comment}{// dimension number to those processors who couldn't figure this}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09113}09113         \textcolor{comment}{// out themselves}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09114}09114         \textcolor{keywordflow}{if} (my\_rank == 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09115}09115         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09116}09116           \textcolor{comment}{// Check number of types of all non-\/root processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09117}09117           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 1; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09118}09118           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09119}09119             \textcolor{keywordflow}{if} (dim\_recv[p] != -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09120}09120             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09121}09121               \textcolor{comment}{// Processor p was able to figure out the nodal}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09122}09122               \textcolor{comment}{// dimension, so I root can update}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09123}09123               \textcolor{comment}{// its own (if required)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09124}09124               \textcolor{keywordflow}{if} (int\_dim == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09125}09125               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09126}09126                 int\_dim = dim\_recv[p];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09127}09127               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09128}09128 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09129}09129               \textcolor{comment}{// Check consistency}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09130}09130               \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (int\_dim != dim\_recv[p])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09131}09131               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09132}09132                 std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09133}09133                 error\_message}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09134}09134                   << \textcolor{stringliteral}{"{}The elements in this mesh must have the same nodal "{}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09135}09135                   << \textcolor{stringliteral}{"{}dimension number on each processor"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09136}09136                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 0; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09137}09137                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09138}09138                   \textcolor{keywordflow}{if} (dim\_recv[p] != -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09139}09139                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09140}09140                     error\_message << \textcolor{stringliteral}{"{}Processor "{}} << p << \textcolor{stringliteral}{"{} : "{}} << dim\_recv[p]}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09141}09141                                   << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09142}09142                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09143}09143                   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09144}09144                   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09145}09145                     error\_message << \textcolor{stringliteral}{"{}Processor "{}} << p << \textcolor{stringliteral}{"{} : (no elements)\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09146}09146                   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09147}09147                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09148}09148                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classoomph_1_1OomphLibError}{OomphLibError}}(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09149}09149                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09150}09150                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09151}09151               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09152}09152 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09153}09153             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09154}09154           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09155}09155 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09156}09156           \textcolor{comment}{// Now send the nodal dimension to non-\/root processors that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09157}09157           \textcolor{comment}{// don't have it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09158}09158           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} p = 1; p < nproc; p++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09159}09159           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09160}09160             \textcolor{keywordflow}{if} (dim\_recv[p] == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09161}09161             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09162}09162               MPI\_Send(\&int\_dim, 1, MPI\_INT, p, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm());}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09163}09163             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09164}09164           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09165}09165           \textcolor{comment}{// clean up}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09166}09166           \textcolor{keyword}{delete}[] dim\_recv;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09167}09167         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09168}09168         \textcolor{comment}{// "{}else if"{}: "{}else"{} for non-\/root; "{}if"{} for checking if current}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09169}09169         \textcolor{comment}{// (non-\/root) processor does not know nodal dimension and is therefore}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09170}09170         \textcolor{comment}{// about to receive it from root.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09171}09171         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (int\_dim == -\/1)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09172}09172         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09173}09173           MPI\_Recv(}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09174}09174             \&int\_dim, 1, MPI\_INT, 0, 0, \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>mpi\_comm(), MPI\_STATUS\_IGNORE);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09175}09175         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09176}09176       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09177}09177     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09178}09178 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09179}09179 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09180}09180     \textcolor{comment}{// If int\_dim if still -\/1 then no elements were found for this mesh, so it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09181}09181     \textcolor{comment}{// has no nodal dimension.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09182}09182     \textcolor{keywordflow}{if} (int\_dim == -\/1) int\_dim = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09183}09183 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09184}09184     \textcolor{keywordflow}{return} unsigned(int\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09185}09185   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09186}09186 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09187}09187   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09188}09188 \textcolor{comment}{  /// Wipe the storage for all externally-\/based elements and delete halos}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09189}09189 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09190}\mbox{\hyperlink{classoomph_1_1Mesh_a9e3ecb07dc622cf37ce0085446ff9aa6}{09190}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1Mesh_a9e3ecb07dc622cf37ce0085446ff9aa6}{Mesh::delete\_all\_external\_storage}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09191}09191   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09192}09192 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09193}09193 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09194}09194     \textcolor{comment}{// Only do for distributed meshes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09195}09195     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a1ab35b022b95f2d28c53aa58859bd6b5}{is\_mesh\_distributed}}())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09196}09196     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09197}09197       \textcolor{comment}{// Some of the external halo/haloed nodes are masters of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09198}09198       \textcolor{comment}{// in this mesh. We must set to be non-\/hanging any nodes whose}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09199}09199       \textcolor{comment}{// masters we are about to delete, to remove any dependencies.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09200}09200 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09201}09201       \textcolor{comment}{// Loop over all the mesh nodes and check their masters}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09202}09202       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}(); \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09203}09203       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09204}09204         \textcolor{comment}{// Get pointer to the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09205}09205         Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a69d22c2070f1649c4cb2607f26070d7c}{node\_pt}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09206}09206 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09207}09207         \textcolor{comment}{// Check if the node exists}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09208}09208         \textcolor{keywordflow}{if} (nod\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09209}09209         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09210}09210           \textcolor{comment}{// Check if the node is hanging}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09211}09211           \textcolor{keywordflow}{if} (nod\_pt-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09212}09212           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09213}09213             \textcolor{comment}{// Get pointer to the hang info}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09214}09214             \mbox{\hyperlink{classoomph_1_1HangInfo}{HangInfo}}* hang\_pt = nod\_pt-\/>hanging\_pt();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09215}09215 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09216}09216             \textcolor{comment}{// Check if any master is in the external halo storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09217}09217             \textcolor{comment}{// External haloed nodes don't get deleted, so we don't need to}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09218}09218             \textcolor{comment}{//(and shouldn't) un-\/hang their dependents}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09219}09219             \textcolor{keywordtype}{bool} found\_a\_master\_in\_external\_halo\_storage = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09220}09220             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} m = 0; m < hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_aa9c1130b58db2ff6d5eee4f923ba365c}{nmaster}}(); m++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09221}09221             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09222}09222               \textcolor{comment}{// Iterator for vector of nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09223}09223               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>::iterator}} it;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09224}09224 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09225}09225               \textcolor{comment}{// Loop over external halo storage with all processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09226}09226               \textcolor{keywordtype}{bool} found\_this\_master\_in\_external\_halo\_storage = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09227}09227               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} d = 0; d < \mbox{\hyperlink{classoomph_1_1Mesh_a775158642d3320e0d709bcccd790875f}{Comm\_pt}}-\/>nproc(); d++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09228}09228               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09229}09229                 \textcolor{comment}{// Find master in map of external halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09230}09230                 it = std::find(\mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[d].begin(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09231}09231                                \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[d].end(),}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09232}09232                                hang\_pt-\/>\mbox{\hyperlink{classoomph_1_1HangInfo_a7a935ae7eeca594a648ca1800444827c}{master\_node\_pt}}(m));}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09233}09233 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09234}09234                 \textcolor{comment}{// Check if it was found}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09235}09235                 \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[d].end())}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09236}09236                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09237}09237                   \textcolor{comment}{// Mark as found}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09238}09238                   found\_this\_master\_in\_external\_halo\_storage = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09239}09239                   \textcolor{comment}{// Don't need to search remaining processors}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09240}09240                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09241}09241                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09242}09242               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09243}09243 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09244}09244               \textcolor{comment}{// Check if any have been found}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09245}09245               \textcolor{keywordflow}{if} (found\_this\_master\_in\_external\_halo\_storage)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09246}09246               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09247}09247                 \textcolor{comment}{// Mark as found}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09248}09248                 found\_a\_master\_in\_external\_halo\_storage = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09249}09249                 \textcolor{comment}{// Don't need to search remaining masters}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09250}09250                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09251}09251               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09252}09252             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09253}09253 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09254}09254             \textcolor{comment}{// If it was found...}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09255}09255             \textcolor{keywordflow}{if} (found\_a\_master\_in\_external\_halo\_storage)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09256}09256             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09257}09257               \textcolor{comment}{// Master is in external halo storage and is about to be deleted,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09258}09258               \textcolor{comment}{// so we'd better make this node non-\/hanging. In case the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09259}09259               \textcolor{comment}{// does not become hanging again, we must get all the required}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09260}09260               \textcolor{comment}{// information from its masters to make it a 'proper' node again.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09261}09261 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09262}09262               \textcolor{comment}{// Reconstruct the nodal values/position from the node's}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09263}09263               \textcolor{comment}{// hanging node representation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09264}09264               \textcolor{keywordtype}{unsigned} nt = nod\_pt-\/>ntstorage();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09265}09265               \textcolor{keywordtype}{unsigned} n\_value = nod\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09266}09266               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} values(n\_value);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09267}09267               \textcolor{keywordtype}{unsigned} n\_dim = nod\_pt-\/>ndim();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09268}09268               \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} position(n\_dim);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09269}09269               \textcolor{comment}{// Loop over all history values}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09270}09270               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} = 0; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}} < nt; \mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09271}09271               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09272}09272                 nod\_pt-\/>value(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, values);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09273}09273                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_value; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09274}09274                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09275}09275                   nod\_pt-\/>set\_value(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}, values[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09276}09276                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09277}09277                 nod\_pt-\/>position(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, position);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09278}09278                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_dim; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09279}09279                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09280}09280                   nod\_pt-\/>x(\mbox{\hyperlink{cfortran_8h_af6f0bd3dc13317f895c91323c25c2b8f}{t}}, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = position[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09281}09281                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09282}09282               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09283}09283 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09284}09284               \textcolor{comment}{// If it's an algebraic node: Update its previous nodal positions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09285}09285               \textcolor{comment}{// too}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09286}09286               \mbox{\hyperlink{classoomph_1_1AlgebraicNode}{AlgebraicNode}}* alg\_node\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1AlgebraicNode}{AlgebraicNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09287}09287               \textcolor{keywordflow}{if} (alg\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09288}09288               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09289}09289                 \textcolor{keywordtype}{bool} update\_all\_time\_levels = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09290}09290                 alg\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1AlgebraicNode_a754dc8fcac3382a07f60262c9792c84c}{node\_update}}(update\_all\_time\_levels);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09291}09291               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09292}09292 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09293}09293 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09294}09294               \textcolor{comment}{// If it's a Solid node, update Lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09295}09295               \textcolor{comment}{// from its hanging node representation}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09296}09296               \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* solid\_node\_pt = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09297}09297               \textcolor{keywordflow}{if} (solid\_node\_pt != 0)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09298}09298               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09299}09299                 \textcolor{keywordtype}{unsigned} n\_lagrangian = solid\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_af98a0623f9e41a10f48112b9ff7b38a0}{nlagrangian}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09300}09300                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < n\_lagrangian; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09301}09301                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09302}09302                   solid\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_aa6780c66ed3f5db5cbb8fe2c0a476974}{xi}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}) = solid\_node\_pt-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a790277999eb7d8ff0c3f2398d8aaedb0}{lagrangian\_position}}(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09303}09303                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09304}09304               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09305}09305 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09306}09306               \textcolor{comment}{// No need to worry about geometrically hanging nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09307}09307               \textcolor{comment}{// on boundaries (as in (p\_)adapt\_mesh())}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09308}09308 \textcolor{comment}{              /// /Now store geometrically hanging nodes on boundaries that}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09309}09309 \textcolor{comment}{              /// /may need updating after refinement.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09310}09310 \textcolor{comment}{              /// /There will only be a problem if we have 3 spatial dimensions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09311}09311 \textcolor{comment}{}              \textcolor{comment}{// if((mesh\_dim > 2) \&\& (nod\_pt-\/>is\_hanging()))}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09312}09312               \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09313}09313               \textcolor{comment}{//  //If the node is on a boundary then add a pointer to the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09314}09314               \textcolor{comment}{//  //to our lookup scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09315}09315               \textcolor{comment}{//  if(nod\_pt-\/>is\_on\_boundary())}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09316}09316               \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09317}09317               \textcolor{comment}{//    //Storage for the boundaries on which the Node is located}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09318}09318               \textcolor{comment}{//    std::set<unsigned>* boundaries\_pt;}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09319}09319               \textcolor{comment}{//    nod\_pt-\/>get\_boundaries\_pt(boundaries\_pt);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09320}09320               \textcolor{comment}{//    if(boundaries\_pt!=0)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09321}09321               \textcolor{comment}{//     \{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09322}09322               \textcolor{comment}{//      //Loop over the boundaries and add a pointer to the node}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09323}09323               \textcolor{comment}{//      //to the appropriate storage scheme}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09324}09324               \textcolor{comment}{//      for(std::set<unsigned>::iterator}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09325}09325               \textcolor{comment}{//      it=boundaries\_pt-\/>begin();}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09326}09326               \textcolor{comment}{//          it!=boundaries\_pt-\/>end();++it)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09327}09327               \textcolor{comment}{//       \{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09328}09328               \textcolor{comment}{//        hanging\_nodes\_on\_boundary\_pt[*it].insert(nod\_pt);}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09329}09329               \textcolor{comment}{//       \}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09330}09330               \textcolor{comment}{//     \}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09331}09331               \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09332}09332               \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09333}09333 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09334}09334               \textcolor{comment}{// Finally set nonhanging}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09335}09335               nod\_pt-\/>set\_nonhanging();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09336}09336             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09337}09337           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09338}09338         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09339}09339         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09340}09340         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09341}09341           \textcolor{comment}{// Node doesn't exist!}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09342}09342         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09343}09343       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09344}09344     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09345}09345 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09346}09346     \textcolor{comment}{// Careful: some of the external halo nodes are also in boundary}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09347}09347     \textcolor{comment}{//          node storage and should be removed from this first}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09348}09348     \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}>::iterator it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09349}09349            \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09350}09350          it != \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09351}09351          it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09352}09352     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09353}09353       \textcolor{comment}{// Processor ID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09354}09354       \textcolor{keywordtype}{int} d = (*it).first;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09355}09355 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09356}09356       \textcolor{comment}{// How many external haloes with this process?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09357}09357       \textcolor{keywordtype}{unsigned} n\_ext\_halo\_nod = \mbox{\hyperlink{classoomph_1_1Mesh_a2dc1f87191771f18f55e9b44664bc7ea}{nexternal\_halo\_node}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09358}09358       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_ext\_halo\_nod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09359}09359       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09360}09360         Node* ext\_halo\_nod\_pt = \mbox{\hyperlink{classoomph_1_1Mesh_a1f88352a0bf5be7d15858915097c1e70}{external\_halo\_node\_pt}}(d, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09361}09361         \textcolor{keywordtype}{unsigned} n\_bnd = \mbox{\hyperlink{classoomph_1_1Mesh_a84543564d6babe4faacbb9d87043fc19}{nboundary}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09362}09362         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_bnd = 0; i\_bnd < n\_bnd; i\_bnd++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09363}09363         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09364}09364           \textcolor{comment}{// Call this for all boundaries; it will do nothing}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09365}09365           \textcolor{comment}{// if the node is not on the current boundary}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09366}09366           \mbox{\hyperlink{classoomph_1_1Mesh_a1690e5351ff05b5e47db184f64b1edc4}{remove\_boundary\_node}}(i\_bnd, ext\_halo\_nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09367}09367         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09368}09368       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09369}09369     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09370}09370 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09371}09371     \textcolor{comment}{// A loop to delete external halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09372}09372     \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}>::iterator it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09373}09373            \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09374}09374          it != \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09375}09375          it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09376}09376     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09377}09377       \textcolor{comment}{// Processor ID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09378}09378       \textcolor{keywordtype}{int} d = (*it).first;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09379}09379 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09380}09380       \textcolor{keywordtype}{unsigned} n\_ext\_halo\_nod = \mbox{\hyperlink{classoomph_1_1Mesh_a2dc1f87191771f18f55e9b44664bc7ea}{nexternal\_halo\_node}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09381}09381       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_ext\_halo\_nod; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09382}09382       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09383}09383         \textcolor{comment}{// Only delete if it's not a node stored in the current mesh}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09384}09384         \textcolor{keywordtype}{bool} is\_a\_mesh\_node = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09385}09385         \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09386}09386         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} jj = 0; jj < n\_node; jj++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09387}09387         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09388}09388           \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[jj] == \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[d][j])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09389}09389           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09390}09390             is\_a\_mesh\_node = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09391}09391           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09392}09392         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09393}09393 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09394}09394         \textcolor{comment}{// There will also be duplications between multiple processors,}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09395}09395         \textcolor{comment}{// so make sure that we don't try to delete these twice}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09396}09396         \textcolor{keywordflow}{if} (!is\_a\_mesh\_node)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09397}09397         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09398}09398           \textcolor{comment}{// Loop over all other higher-\/numbered processors and check}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09399}09399           \textcolor{comment}{// for duplicated external halo nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09400}09400           \textcolor{comment}{// (The highest numbered processor should delete all its ext halos)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09401}09401           \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<Node*>}}>::iterator itt =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09402}09402                  \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09403}09403                itt != \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09404}09404                itt++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09405}09405           \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09406}09406             \textcolor{comment}{// Processor ID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09407}09407             \textcolor{keywordtype}{int} dd = (*itt).first;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09408}09408 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09409}09409             \textcolor{keywordflow}{if} (dd > d)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09410}09410             \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09411}09411               \textcolor{keywordtype}{unsigned} n\_ext\_halo = \mbox{\hyperlink{classoomph_1_1Mesh_a2dc1f87191771f18f55e9b44664bc7ea}{nexternal\_halo\_node}}(dd);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09412}09412               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} jjj = 0; jjj < n\_ext\_halo; jjj++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09413}09413               \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09414}09414                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[dd][jjj] ==}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09415}09415                     \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[d][j])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09416}09416                 \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09417}09417                   is\_a\_mesh\_node = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09418}09418                 \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09419}09419               \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09420}09420             \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09421}09421           \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09422}09422         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09423}09423 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09424}09424         \textcolor{comment}{// Only now if no duplicates exist can the node be safely deleted}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09425}09425         \textcolor{keywordflow}{if} (!is\_a\_mesh\_node)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09426}09426         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09427}09427           \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}[d][j];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09428}09428         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09429}09429       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09430}09430     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09431}09431 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09432}09432     \textcolor{comment}{// Another loop to delete external halo elements (which are distinct)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09433}09433     \textcolor{keywordflow}{for} (std::map<\textcolor{keywordtype}{unsigned}, \mbox{\hyperlink{classoomph_1_1Vector}{Vector<GeneralisedElement*>}}>::iterator it =}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09434}09434            \mbox{\hyperlink{classoomph_1_1Mesh_afb2def03c6259295dbd65303584edf31}{External\_halo\_element\_pt}}.begin();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09435}09435          it != \mbox{\hyperlink{classoomph_1_1Mesh_afb2def03c6259295dbd65303584edf31}{External\_halo\_element\_pt}}.end();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09436}09436          it++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09437}09437     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09438}09438       \textcolor{comment}{// Processor ID}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09439}09439       \textcolor{keywordtype}{int} d = (*it).first;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09440}09440 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09441}09441       \textcolor{keywordtype}{unsigned} n\_ext\_halo\_el = \mbox{\hyperlink{classoomph_1_1Mesh_af7554deb7f9854272d849a6482a57d60}{nexternal\_halo\_element}}(d);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09442}09442       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} = 0; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}} < n\_ext\_halo\_el; \mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09443}09443       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09444}09444         \textcolor{keyword}{delete} \mbox{\hyperlink{classoomph_1_1Mesh_afb2def03c6259295dbd65303584edf31}{External\_halo\_element\_pt}}[d][\mbox{\hyperlink{cfortran_8h_a37cd013acc76697829c324bdd8562d82}{e}}];}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09445}09445       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09446}09446     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09447}09447 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09448}09448     \textcolor{comment}{// Now we are okay to clear the external halo node storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09449}09449     \mbox{\hyperlink{classoomph_1_1Mesh_ad30b8d9485ce49908983600293887440}{External\_halo\_node\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09450}09450     \mbox{\hyperlink{classoomph_1_1Mesh_afb2def03c6259295dbd65303584edf31}{External\_halo\_element\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09451}09451 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09452}09452     \textcolor{comment}{// External haloed nodes and elements are actual members}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09453}09453     \textcolor{comment}{// of the external mesh and should not be deleted}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09454}09454     \mbox{\hyperlink{classoomph_1_1Mesh_a6af0686ce8758874520426cfac5e7899}{External\_haloed\_node\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09455}09455     \mbox{\hyperlink{classoomph_1_1Mesh_a3a031fedb3ebe4762e09c0416f2eaca2}{External\_haloed\_element\_pt}}.clear();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09456}09456 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09457}09457   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09458}09458 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09459}09459 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09460}09460 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09461}09461 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09462}09462   \textcolor{comment}{// NOTE: the add\_external\_haloed\_node\_pt and add\_external\_haloed\_element\_pt}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09463}09463   \textcolor{comment}{//       functions need to check whether the Node/FiniteElement argument}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09464}09464   \textcolor{comment}{//       has been added to the storage already; this is not the case}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09465}09465   \textcolor{comment}{//       for the add\_external\_halo\_node\_pt and add\_external\_halo\_element\_pt}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09466}09466   \textcolor{comment}{//       functions as these are newly-\/created elements that are created and}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09467}09467   \textcolor{comment}{//       added to the storage based on the knowledge of when their haloed}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09468}09468   \textcolor{comment}{//       counterparts were created and whether they were newly added}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09469}09469 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09470}09470   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09471}09471 \textcolor{comment}{  /// Add external haloed element whose non-\/halo counterpart is held}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09472}09472 \textcolor{comment}{  /// on processor p to the storage scheme for external haloed elements.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09473}09473 \textcolor{comment}{  /// If the element is already in the storage scheme then return its index}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09474}09474 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09475}\mbox{\hyperlink{classoomph_1_1Mesh_a85fd3fc85e61062a50cdc56dec197449}{09475}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1Mesh_a85fd3fc85e61062a50cdc56dec197449}{Mesh::add\_external\_haloed\_element\_pt}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& p,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09476}09476                                                 \mbox{\hyperlink{classoomph_1_1GeneralisedElement}{GeneralisedElement}}*\& el\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09477}09477   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09478}09478     \textcolor{comment}{// Loop over current storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09479}09479     \textcolor{keywordtype}{unsigned} n\_extern\_haloed = \mbox{\hyperlink{classoomph_1_1Mesh_a2ab617e7c2c754234dcad02d3d0ed5ba}{nexternal\_haloed\_element}}(p);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09480}09480 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09481}09481     \textcolor{comment}{// Is this already an external haloed element?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09482}09482     \textcolor{keywordtype}{bool} already\_external\_haloed\_element = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09483}09483     \textcolor{keywordtype}{unsigned} external\_haloed\_el\_index = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09484}09484     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} eh = 0; eh < n\_extern\_haloed; eh++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09485}09485     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09486}09486       \textcolor{keywordflow}{if} (el\_pt == \mbox{\hyperlink{classoomph_1_1Mesh_a3a031fedb3ebe4762e09c0416f2eaca2}{External\_haloed\_element\_pt}}[p][eh])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09487}09487       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09488}09488         \textcolor{comment}{// It's already there, so...}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09489}09489         already\_external\_haloed\_element = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09490}09490         \textcolor{comment}{// ...set the index of this element}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09491}09491         external\_haloed\_el\_index = eh;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09492}09492         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09493}09493       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09494}09494     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09495}09495 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09496}09496     \textcolor{comment}{// Has it been found?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09497}09497     \textcolor{keywordflow}{if} (!already\_external\_haloed\_element)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09498}09498     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09499}09499       \textcolor{comment}{// Not found, so add it:}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09500}09500       \mbox{\hyperlink{classoomph_1_1Mesh_a3a031fedb3ebe4762e09c0416f2eaca2}{External\_haloed\_element\_pt}}[p].push\_back(el\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09501}09501       \textcolor{comment}{// Return the index where it's just been added}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09502}09502       \textcolor{keywordflow}{return} n\_extern\_haloed;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09503}09503     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09504}09504     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09505}09505     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09506}09506       \textcolor{comment}{// Return the index where it was found}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09507}09507       \textcolor{keywordflow}{return} external\_haloed\_el\_index;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09508}09508     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09509}09509   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09510}09510 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09511}09511   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09512}09512 \textcolor{comment}{  /// Add external haloed node whose halo (external) counterpart}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09513}09513 \textcolor{comment}{  /// is held on processor p to the storage scheme for external haloed nodes.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09514}09514 \textcolor{comment}{  /// If the node is already in the storage scheme then return its index}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09515}09515 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09516}\mbox{\hyperlink{classoomph_1_1Mesh_a2cc2600eb480287be5afe6bebf430c00}{09516}}   \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1Mesh_a2cc2600eb480287be5afe6bebf430c00}{Mesh::add\_external\_haloed\_node\_pt}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& p, Node*\& nod\_pt)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09517}09517   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09518}09518     \textcolor{comment}{// Loop over current storage}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09519}09519     \textcolor{keywordtype}{unsigned} n\_ext\_haloed\_nod = \mbox{\hyperlink{classoomph_1_1Mesh_ad37eca6c72c9687954aa2d321938d692}{nexternal\_haloed\_node}}(p);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09520}09520 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09521}09521     \textcolor{comment}{// Is this already an external haloed node?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09522}09522     \textcolor{keywordtype}{bool} is\_an\_external\_haloed\_node = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09523}09523     \textcolor{keywordtype}{unsigned} external\_haloed\_node\_index = 0;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09524}09524     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_ext\_haloed\_nod; k++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09525}09525     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09526}09526       \textcolor{keywordflow}{if} (nod\_pt == \mbox{\hyperlink{classoomph_1_1Mesh_a6af0686ce8758874520426cfac5e7899}{External\_haloed\_node\_pt}}[p][k])}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09527}09527       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09528}09528         is\_an\_external\_haloed\_node = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09529}09529         external\_haloed\_node\_index = k;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09530}09530         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09531}09531       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09532}09532     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09533}09533 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09534}09534     \textcolor{comment}{// Has it been found?}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09535}09535     \textcolor{keywordflow}{if} (!is\_an\_external\_haloed\_node)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09536}09536     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09537}09537       \textcolor{comment}{// Not found, so add it}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09538}09538       \mbox{\hyperlink{classoomph_1_1Mesh_a6af0686ce8758874520426cfac5e7899}{External\_haloed\_node\_pt}}[p].push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09539}09539       \textcolor{comment}{// Return the index where it's just been added}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09540}09540       \textcolor{keywordflow}{return} n\_ext\_haloed\_nod;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09541}09541     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09542}09542     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09543}09543     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09544}09544       \textcolor{comment}{// Return the index where it was found}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09545}09545       \textcolor{keywordflow}{return} external\_haloed\_node\_index;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09546}09546     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09547}09547   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09548}09548 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09549}09549 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09550}09550 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09551}09551 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09552}09552 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09553}09553 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09554}09554 \textcolor{comment}{}  \textcolor{comment}{// Functions for solid meshes}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09555}09555 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09556}09556 \textcolor{comment}{  /// ///////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09557}09557 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09558}09558 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09559}09559   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09560}09560 \textcolor{comment}{  /// Make the current configuration the undeformed one by}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09561}09561 \textcolor{comment}{  /// setting the nodal Lagrangian coordinates to their current}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09562}09562 \textcolor{comment}{  /// Eulerian ones}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09563}09563 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09564}\mbox{\hyperlink{classoomph_1_1SolidMesh_a3eb52bbb81875244774cfc305c3ab21d}{09564}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1SolidMesh_a3eb52bbb81875244774cfc305c3ab21d}{SolidMesh::set\_lagrangian\_nodal\_coordinates}}()}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09565}09565   \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09566}09566     \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09567}09567     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node = \mbox{\hyperlink{classoomph_1_1Mesh_a945e7823d1a2af243b5b7f7866aaff5e}{nnode}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09568}09568 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09569}09569     \textcolor{comment}{// Loop over all the nodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09570}09570     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09571}09571     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09572}09572       \textcolor{comment}{// Cast node to solid node (can safely be done because}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09573}09573       \textcolor{comment}{// SolidMeshes consist of SolidNodes}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09574}09574       \mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}* \mbox{\hyperlink{classoomph_1_1SolidMesh_a053f864c3df9b7436b2eda1554d30ee5}{node\_pt}} = \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{classoomph_1_1SolidNode}{SolidNode}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1Mesh_a0a42111e7eb200e5831f8b73c018b7dc}{Node\_pt}}[n]);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09575}09575 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09576}09576       \textcolor{comment}{// Number of Lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09577}09577       \textcolor{keywordtype}{unsigned} n\_lagrangian = \mbox{\hyperlink{classoomph_1_1SolidMesh_a053f864c3df9b7436b2eda1554d30ee5}{node\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_af98a0623f9e41a10f48112b9ff7b38a0}{nlagrangian}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09578}09578 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09579}09579       \textcolor{comment}{// Number of generalised Lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09580}09580       \textcolor{keywordtype}{unsigned} n\_lagrangian\_type = \mbox{\hyperlink{classoomph_1_1SolidMesh_a053f864c3df9b7436b2eda1554d30ee5}{node\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_a3c1e52e4b6dde53b98228d621f7fcb0a}{nlagrangian\_type}}();}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09581}09581 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09582}09582       \textcolor{comment}{// The assumption here is that there must be fewer lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09583}09583       \textcolor{comment}{// than eulerian (which must be true?)}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09584}09584       \textcolor{comment}{// Set (generalised) Lagrangian coords = (generalised) Eulerian coords}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09585}09585       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} k = 0; k < n\_lagrangian\_type; k++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09586}09586       \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09587}09587         \textcolor{comment}{// Loop over lagrangian coordinates and set their values}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09588}09588         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_lagrangian; j++)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09589}09589         \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09590}09590           \mbox{\hyperlink{classoomph_1_1SolidMesh_a053f864c3df9b7436b2eda1554d30ee5}{node\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1SolidNode_ada699bd006497ddeabb0bc0750d99965}{xi\_gen}}(k, j) = \mbox{\hyperlink{classoomph_1_1SolidMesh_a053f864c3df9b7436b2eda1554d30ee5}{node\_pt}}-\/>x\_gen(k, j);}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09591}09591         \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09592}09592       \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09593}09593     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09594}09594   \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09595}09595 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09596}09596 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09597}09597   \textcolor{comment}{//=======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09598}09598 \textcolor{comment}{  /// Static problem that can be used to assign initial conditions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09599}09599 \textcolor{comment}{  /// on a given mesh.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09600}09600 \textcolor{comment}{}  \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09601}09601   \mbox{\hyperlink{classoomph_1_1SolidICProblem}{SolidICProblem}} \mbox{\hyperlink{classoomph_1_1SolidMesh_a6ec5dbbbccfb4e5f1aa92a29905f5073}{SolidMesh::Solid\_IC\_problem}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09602}09602 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09603}09603 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09604}09604 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09605}09605 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09606}09606 \textcolor{comment}{  /// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09607}09607 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09608}09608 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09609}09609   \textcolor{comment}{//=================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09610}09610 \textcolor{comment}{  /// Namespace for paraview-\/style output helper functions}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09611}09611 \textcolor{comment}{}  \textcolor{comment}{//=================================================================}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09612}\mbox{\hyperlink{namespaceoomph_1_1ParaviewHelper}{09612}}   \textcolor{keyword}{namespace }ParaviewHelper}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09613}09613   \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09614}09614 \textcolor{comment}{    /// Write the pvd file header}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09615}\mbox{\hyperlink{namespaceoomph_1_1ParaviewHelper_a5e200ee35119c91fb4ab83ddf5d55373}{09615}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1ParaviewHelper_a5e200ee35119c91fb4ab83ddf5d55373}{write\_pvd\_header}}(std::ofstream\& pvd\_file)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09616}09616     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09617}09617       pvd\_file << \textcolor{stringliteral}{"{}<?xml version=\(\backslash\)"{}1.0\(\backslash\)"{}?>"{}} << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09618}09618                << \textcolor{stringliteral}{"{}<VTKFile type=\(\backslash\)"{}Collection\(\backslash\)"{} version=\(\backslash\)"{}0.1\(\backslash\)"{}>"{}} << std::endl}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09619}09619                << \textcolor{stringliteral}{"{}<Collection>"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09620}09620     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09621}09621 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09622}09622 \textcolor{comment}{    /// Add name of output file and associated continuous time}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09623}09623 \textcolor{comment}{    /// to pvd file.}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09624}\mbox{\hyperlink{namespaceoomph_1_1ParaviewHelper_a970f03dfd06efb8efd2cfcc8d7a5c371}{09624}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1ParaviewHelper_a970f03dfd06efb8efd2cfcc8d7a5c371}{write\_pvd\_information}}(std::ofstream\& pvd\_file,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09625}09625                                \textcolor{keyword}{const} \mbox{\hyperlink{namespaceoomph_1_1Global__string__for__annotation_ac5379de2fa7fe44f2cb31785fc208135}{std::string}}\& output\_filename,}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09626}09626                                \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& time)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09627}09627     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09628}09628       \textcolor{comment}{// Output the actual time values}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09629}09629       pvd\_file << \textcolor{stringliteral}{"{}<DataSet timestep=\(\backslash\)"{}"{}} << time << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09630}09630 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09631}09631       \textcolor{comment}{// Apparently this has to go in}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09632}09632       pvd\_file << \textcolor{stringliteral}{"{}part=\(\backslash\)"{}0\(\backslash\)"{} "{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09633}09633 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09634}09634       \textcolor{comment}{// Add the name of the file, so that the pvd file knows what it is called}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09635}09635       pvd\_file << \textcolor{stringliteral}{"{}file=\(\backslash\)"{}"{}} << output\_filename << \textcolor{stringliteral}{"{}\(\backslash\)"{}/>"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09636}09636     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09637}09637 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09638}09638 \textcolor{comment}{    /// Write the pvd file footer}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09639}\mbox{\hyperlink{namespaceoomph_1_1ParaviewHelper_a41a4f292c2f1f0b10755d940e3aeadad}{09639}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceoomph_1_1ParaviewHelper_a41a4f292c2f1f0b10755d940e3aeadad}{write\_pvd\_footer}}(std::ofstream\& pvd\_file)}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09640}09640     \{}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09641}09641       pvd\_file << \textcolor{stringliteral}{"{}</Collection>"{}} << std::endl << \textcolor{stringliteral}{"{}</VTKFile>"{}};}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09642}09642     \}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09643}09643 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09644}09644   \} \textcolor{comment}{// namespace ParaviewHelper}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09645}09645 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09646}09646 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09647}09647 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09648}09648 \textcolor{comment}{  /// /////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09649}09649 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09650}09650 }
\DoxyCodeLine{\Hypertarget{mesh_8cc_source_l09651}09651 \} \textcolor{comment}{// namespace oomph}}

\end{DoxyCode}

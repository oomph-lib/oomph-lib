\hypertarget{impose__impenetrability__element_8h_source}{}\doxysection{impose\+\_\+impenetrability\+\_\+element.\+h}
\label{impose__impenetrability__element_8h_source}\index{impose\_impenetrability\_element.h@{impose\_impenetrability\_element.h}}
\mbox{\hyperlink{impose__impenetrability__element_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00026}00026 \textcolor{preprocessor}{\#ifndef OOMPH\_IMPOSE\_IMPENETRABLE\_ELEMENTS\_HEADER}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00027}00027 \textcolor{preprocessor}{\#define OOMPH\_IMPOSE\_IMPENETRABLE\_ELEMENTS\_HEADER}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00029}00029 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00030}00030 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00031}00031 \textcolor{preprocessor}{\#include <oomph-\/lib-\/config.h>}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00032}00032 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00034}00034 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00035}00035 \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00036}00036   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00037}00037 \textcolor{comment}{  ///  ImposeImpenetrabilityElement}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00038}00038 \textcolor{comment}{  /// are elements that coincide with the faces of}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00039}00039 \textcolor{comment}{  /// higher-\/dimensional "{}bulk"{} elements. They are used on}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00040}00040 \textcolor{comment}{  /// boundaries where we would like to impose impenetrability.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00041}00041 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00042}00042   \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00043}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement}{00043}}   \textcolor{keyword}{class }\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement}{ImposeImpenetrabilityElement}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<ELEMENT>,}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00044}00044                                        \textcolor{keyword}{public} \textcolor{keyword}{virtual} \mbox{\hyperlink{classoomph_1_1FaceElement}{FaceElement}}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00045}00045   \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00046}00046   \textcolor{keyword}{private}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00047}00047 \textcolor{comment}{    /// Lagrange Id}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00048}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a6a8cf1048dbcc32288ea8eca1e6c380d}{00048}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a6a8cf1048dbcc32288ea8eca1e6c380d}{Id}};}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00050}00050   \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00051}00051 \textcolor{comment}{    /// Constructor takes a "{}bulk"{} element, the}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00052}00052 \textcolor{comment}{    /// index that identifies which face the}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00053}00053 \textcolor{comment}{    /// ImposeImpenetrabilityElement is supposed}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00054}00054 \textcolor{comment}{    /// to be attached to, and the face element ID}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00055}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_ae00b64597005a63ba62f7db13784a5fd}{00055}} \textcolor{comment}{}    \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_ae00b64597005a63ba62f7db13784a5fd}{ImposeImpenetrabilityElement}}(\mbox{\hyperlink{classoomph_1_1FiniteElement}{FiniteElement}}* \textcolor{keyword}{const}\& element\_pt,}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00056}00056                                  \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& \mbox{\hyperlink{classoomph_1_1FaceElement_a14990bd081523c47cfe57e5ecf54dfe1}{face\_index}},}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00057}00057                                  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \textcolor{keywordtype}{id} = 0)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00058}00058       : \mbox{\hyperlink{classoomph_1_1FaceGeometry}{FaceGeometry}}<ELEMENT>(), \mbox{\hyperlink{classoomph_1_1FaceElement}{FaceElement}}()}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00059}00059     \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00060}00060       \textcolor{comment}{//  set the Id}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00061}00061       \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a6a8cf1048dbcc32288ea8eca1e6c380d}{Id}} = id;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00063}00063       \textcolor{comment}{// Build the face element}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00064}00064       element\_pt-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a025ab56ef9c6eea66fb34416fdf19152}{build\_face\_element}}(\mbox{\hyperlink{classoomph_1_1FaceElement_a14990bd081523c47cfe57e5ecf54dfe1}{face\_index}}, \textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00066}00066       \textcolor{comment}{// we need 1 additional values for each FaceElement node}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00067}00067       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} n\_additional\_values(\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}(), 1);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00069}00069       \textcolor{comment}{// add storage for lagrange multipliers and set the map containing}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00070}00070       \textcolor{comment}{// the position of the first entry of this face element's}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00071}00071       \textcolor{comment}{// additional values.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00072}00072       \mbox{\hyperlink{classoomph_1_1FaceElement_a652aa3d84b6d91e0ce93bdb2e6718338}{add\_additional\_values}}(n\_additional\_values, \textcolor{keywordtype}{id});}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00073}00073     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00074}00074 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00075}00075 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00076}00076 \textcolor{comment}{    /// Fill in the residuals}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00077}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a1642298b1eca7806849324886672273e}{00077}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a1642298b1eca7806849324886672273e}{fill\_in\_contribution\_to\_residuals}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00078}00078     \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00079}00079       \textcolor{comment}{// Call the generic routine with the flag set to 0}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00080}00080       \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a943dc887f5a792524e418b23dea934c3}{fill\_in\_generic\_contribution\_to\_residuals\_parall\_lagr\_multiplier}}(}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00081}00081         residuals, \mbox{\hyperlink{classoomph_1_1GeneralisedElement_a4bff11b8ff97aefabb2df41e61e1779f}{GeneralisedElement::Dummy\_matrix}}, 0);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00082}00082     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00083}00083 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00084}00084 \textcolor{comment}{    /// Fill in contribution from Jacobian}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00085}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a9a53b713347bdb2b9c04692ea708eb01}{00085}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a9a53b713347bdb2b9c04692ea708eb01}{fill\_in\_contribution\_to\_jacobian}}(\mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00086}00086                                           \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& \mbox{\hyperlink{classoomph_1_1FiniteElement_aa6c806dab803b82ba4f02cf806971af8}{jacobian}})}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00087}00087     \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00088}00088       \textcolor{comment}{// Call the generic routine with the flag set to 1}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00089}00089       \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a943dc887f5a792524e418b23dea934c3}{fill\_in\_generic\_contribution\_to\_residuals\_parall\_lagr\_multiplier}}(}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00090}00090         residuals, \mbox{\hyperlink{classoomph_1_1FiniteElement_aa6c806dab803b82ba4f02cf806971af8}{jacobian}}, 1);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00091}00091     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00092}00092 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00093}00093 \textcolor{comment}{    /// Overload the output function}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00094}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a44097c20f6a16ab6a8f60daeaba7aa7d}{00094}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a44097c20f6a16ab6a8f60daeaba7aa7d}{output}}(std::ostream\& outfile)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00095}00095     \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00096}00096       \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{FiniteElement::output}}(outfile);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00097}00097     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00098}00098 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00099}00099 \textcolor{comment}{    /// Output function: x,y,[z],u,v,[w],p in tecplot format}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00100}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_ad23ac5158f42b7a6c65ec7cbd3deac44}{00100}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_ad23ac5158f42b7a6c65ec7cbd3deac44}{output}}(std::ostream\& outfile, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& nplot)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00101}00101     \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00102}00102       \mbox{\hyperlink{classoomph_1_1FiniteElement_a2ad98a3d2ef4999f1bef62c0ff13f2a7}{FiniteElement::output}}(outfile, nplot);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00103}00103     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00104}00104 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00105}00105 \textcolor{comment}{    /// The "{}global"{} intrinsic coordinate of the element when}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00106}00106 \textcolor{comment}{    /// viewed as part of a geometric object should be given by}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00107}00107 \textcolor{comment}{    /// the FaceElement representation, by default}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00108}00108 \textcolor{comment}{    /// This final over-\/ride is required because both SolidFiniteElements}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00109}00109 \textcolor{comment}{    /// and FaceElements overload zeta\_nodal}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00110}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_acd1ef4e239729447691ba0b973e395ae}{00110}} \textcolor{comment}{}    \textcolor{keywordtype}{double} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_acd1ef4e239729447691ba0b973e395ae}{zeta\_nodal}}(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& n,}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00111}00111                       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& k,}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00112}00112                       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00113}00113 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00114}00114       \textcolor{keywordflow}{return} \mbox{\hyperlink{classoomph_1_1FaceElement_a58c9f93705c7741f76c8487d152e68a6}{FaceElement::zeta\_nodal}}(n, k, \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00115}00115     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00116}00116 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00117}00117   \textcolor{keyword}{protected}:\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00118}00118 \textcolor{comment}{    /// Helper function to compute the residuals and, if flag==1, the}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00119}00119 \textcolor{comment}{    /// Jacobian}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00120}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a943dc887f5a792524e418b23dea934c3}{00120}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a943dc887f5a792524e418b23dea934c3}{fill\_in\_generic\_contribution\_to\_residuals\_parall\_lagr\_multiplier}}(}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00121}00121       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}}\& residuals,}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00122}00122       \mbox{\hyperlink{classoomph_1_1DenseMatrix}{DenseMatrix<double>}}\& \mbox{\hyperlink{classoomph_1_1FiniteElement_aa6c806dab803b82ba4f02cf806971af8}{jacobian}},}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00123}00123       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& flag)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00124}00124     \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00125}00125       \textcolor{comment}{// Find out how many nodes there are}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00126}00126       \textcolor{keywordtype}{unsigned} n\_node = \mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00128}00128       \textcolor{comment}{// Dimension of element}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00129}00129       \textcolor{keywordtype}{unsigned} dim\_el = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00131}00131       \textcolor{comment}{// Set up memory for the shape functions}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00132}00132       \mbox{\hyperlink{classoomph_1_1Shape}{Shape}} psi(n\_node);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00134}00134       \textcolor{comment}{// Set the value of n\_intpt}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00135}00135       \textcolor{keywordtype}{unsigned} n\_intpt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00137}00137       \textcolor{comment}{// to store local equation number}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00138}00138       \textcolor{keywordtype}{int} local\_eqn = 0;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00139}00139       \textcolor{keywordtype}{int} local\_unknown = 0;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00141}00141       \textcolor{comment}{// to store normal vector}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00142}00142       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} norm\_vec(dim\_el + 1);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00143}00143 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00144}00144       \textcolor{comment}{// get the value at which the velocities are stored}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00145}00145       \mbox{\hyperlink{classoomph_1_1Vector}{Vector<unsigned>}} u\_index(dim\_el + 1);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00146}00146       ELEMENT* el\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(this-\/>\mbox{\hyperlink{classoomph_1_1FaceElement_a89e9f7ebc8019c47d54dded72f05479e}{bulk\_element\_pt}}());}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00147}00147       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dim\_el + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00148}00148       \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00149}00149         u\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] = el\_pt-\/>u\_index\_nst(\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00150}00150       \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00151}00151 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00152}00152       \textcolor{comment}{// Loop over the integration points}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00153}00153       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < n\_intpt; ipt++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00154}00154       \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00155}00155         \textcolor{comment}{// Get the integral weight}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00156}00156         \textcolor{keywordtype}{double} w = \mbox{\hyperlink{classoomph_1_1FiniteElement_a1a4723c4ee3fe4c6404203bb987f804e}{integral\_pt}}()-\/>weight(ipt);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00157}00157 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00158}00158         \textcolor{comment}{// Jacobian of mapping}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00159}00159         \textcolor{keywordtype}{double} J = \mbox{\hyperlink{classoomph_1_1FaceElement_aa6380a08afc18bd4f35e337a1131a9d8}{J\_eulerian\_at\_knot}}(ipt);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00161}00161         \textcolor{comment}{// Premultiply the weights and the Jacobian}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00162}00162         \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}} = w * J;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00163}00163 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00164}00164         \textcolor{comment}{// Calculate the shape functions}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00165}00165         \mbox{\hyperlink{classoomph_1_1FiniteElement_a2de680722518136b5c6bf2aacc267a31}{shape\_at\_knot}}(ipt, psi);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00166}00166 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00167}00167         \textcolor{comment}{// compute  the velocity and the Lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00168}00168         \mbox{\hyperlink{classoomph_1_1Vector}{Vector<double>}} interpolated\_u(dim\_el + 1, 0.0);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00169}00169         \textcolor{keywordtype}{double} lambda = 0.0;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00170}00170 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00171}00171         \textcolor{comment}{// Loop over nodes}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00172}00172         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00173}00173         \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00174}00174           \textcolor{comment}{// Assemble the velocity component}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00175}00175           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dim\_el + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00176}00176           \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00177}00177             interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] += \mbox{\hyperlink{classoomph_1_1FiniteElement_a28fd5c2d4aeba5ef65bee0e0d72569f5}{nodal\_value}}(j, u\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]) * psi(j);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00178}00178           \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00179}00179 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00180}00180           \textcolor{comment}{// Cast to a boundary node}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00181}00181           \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00182}00182             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00183}00183 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00184}00184           \textcolor{comment}{// get the node}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00185}00185           Node* nod\_pt = \mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00187}00187           \textcolor{comment}{// Get the index of the first nodal value associated with}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00188}00188           \textcolor{comment}{// this FaceElement}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00189}00189           \textcolor{keywordtype}{unsigned} first\_index =}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00190}00190             bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a67c470bd15750e91775101b5bce65a58}{index\_of\_first\_value\_assigned\_by\_face\_element}}(\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a6a8cf1048dbcc32288ea8eca1e6c380d}{Id}});}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00191}00191 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00192}00192           \textcolor{comment}{// Assemble the Lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00193}00193           lambda += nod\_pt-\/>value(first\_index) * psi(j);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00194}00194         \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00196}00196         \textcolor{comment}{// compute the normal vector}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00197}00197         \mbox{\hyperlink{classoomph_1_1FaceElement_a49cf44d89e80926635d2a26abfbbf3b0}{outer\_unit\_normal}}(ipt, norm\_vec);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00198}00198 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00199}00199         \textcolor{comment}{// Assemble residuals and jacobian}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00200}00200 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00201}00201         \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00202}00202         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00203}00203         \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00204}00204           \textcolor{comment}{// Cast to a boundary node}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00205}00205           \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00206}00206             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00208}00208           \textcolor{comment}{// Get the index of the first nodal value associated with}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00209}00209           \textcolor{comment}{// this FaceElement}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00210}00210           \textcolor{keywordtype}{unsigned} first\_index =}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00211}00211             bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a67c470bd15750e91775101b5bce65a58}{index\_of\_first\_value\_assigned\_by\_face\_element}}(\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a6a8cf1048dbcc32288ea8eca1e6c380d}{Id}});}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00212}00212 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00213}00213           \textcolor{comment}{// Local eqn number for the l-\/th component of lamdba}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00214}00214           \textcolor{comment}{// in the j-\/th element}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00215}00215           local\_eqn = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(j, first\_index);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00216}00216 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00217}00217           \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00218}00218           \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00219}00219             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dim\_el + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00220}00220             \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00221}00221               \textcolor{comment}{// Assemble residual for lagrange multiplier}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00222}00222               residuals[local\_eqn] +=}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00223}00223                 interpolated\_u[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * norm\_vec[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(j) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00225}00225               \textcolor{comment}{// Assemble Jacobian for Lagrange multiplier:}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00226}00226               \textcolor{keywordflow}{if} (flag == 1)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00227}00227               \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00228}00228                 \textcolor{comment}{// Loop over the nodes again for unknowns}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00229}00229                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} jj = 0; jj < n\_node; jj++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00230}00230                 \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00231}00231                   \textcolor{comment}{// Local eqn number for the i-\/th component}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00232}00232                   \textcolor{comment}{// of the velocity in the jj-\/th element}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00233}00233                   local\_unknown = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(jj, u\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00234}00234                   \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00235}00235                   \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00236}00236                     \mbox{\hyperlink{classoomph_1_1FiniteElement_aa6c806dab803b82ba4f02cf806971af8}{jacobian}}(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00237}00237                       norm\_vec[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(jj) * psi(j) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00238}00238                   \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00239}00239                 \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00240}00240               \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00241}00241             \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00242}00242           \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00243}00243 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00244}00244           \textcolor{comment}{// Loop over the directions}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00245}00245           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} < dim\_el + 1; \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00246}00246           \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00247}00247             \textcolor{comment}{// Local eqn number for the i-\/th component of the}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00248}00248             \textcolor{comment}{// velocity in the j-\/th element}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00249}00249             local\_eqn = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(j, u\_index[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}]);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00250}00250 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00251}00251             \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00252}00252             \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00253}00253               \textcolor{comment}{// Add lagrange multiplier contribution to the bulk equation}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00254}00254               \textcolor{comment}{// Add to residual}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00255}00255               residuals[local\_eqn] += norm\_vec[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(j) * lambda * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00256}00256 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00257}00257               \textcolor{comment}{// Do Jacobian too?}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00258}00258               \textcolor{keywordflow}{if} (flag == 1)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00259}00259               \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00260}00260                 \textcolor{comment}{// Loop over the nodes again for unknowns}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00261}00261                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} jj = 0; jj < n\_node; jj++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00262}00262                 \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00263}00263                   \textcolor{comment}{// Cast to a boundary node}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00264}00264                   \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnode\_pt =}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00265}00265                     \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(jj));}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00266}00266 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00267}00267                   \textcolor{comment}{// Local eqn number for the l-\/th component of lamdba}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00268}00268                   \textcolor{comment}{// in the jj-\/th element}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00269}00269                   local\_unknown = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00270}00270                     jj,}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00271}00271                     bnode\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a67c470bd15750e91775101b5bce65a58}{index\_of\_first\_value\_assigned\_by\_face\_element}}(}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00272}00272                       \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a6a8cf1048dbcc32288ea8eca1e6c380d}{Id}}));}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00273}00273                   \textcolor{keywordflow}{if} (local\_unknown >= 0)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00274}00274                   \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00275}00275                     \mbox{\hyperlink{classoomph_1_1FiniteElement_aa6c806dab803b82ba4f02cf806971af8}{jacobian}}(local\_eqn, local\_unknown) +=}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00276}00276                       norm\_vec[\mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}}] * psi(jj) * psi(j) * \mbox{\hyperlink{namespaceoomph_ab40f6d5233caa62dd428818b4cba72d5}{W}};}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00277}00277                   \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00278}00278                 \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00279}00279               \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00280}00280             \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00281}00281           \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00282}00282         \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00283}00283       \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00284}00284     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00285}00285 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00286}00286 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00287}00287 \textcolor{comment}{    /// The number of "{}DOF types"{} that degrees of freedom in this element}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00288}00288 \textcolor{comment}{    /// are sub-\/divided into: Just the solid degrees of freedom themselves.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00289}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a0aa0ca45ff2d80ca16708224d09749de}{00289}} \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a0aa0ca45ff2d80ca16708224d09749de}{ndof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00290}00290 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00291}00291       \textcolor{comment}{// There is only ever one normal. Plus the constrained velocities.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00292}00292       \textcolor{comment}{// unsigned ndofndof = 1 + additional\_ndof\_types();}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00293}00293       \textcolor{comment}{// std::cout << "{}ndof: "{} << ndofndof << std::endl;}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00294}00294 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00295}00295       \textcolor{keywordflow}{return} (1 + \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a9bd9f83e67108ac008efa20601fb1ade}{additional\_ndof\_types}}());}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00296}00296     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00297}00297 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00299}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a9bd9f83e67108ac008efa20601fb1ade}{00299}}     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a9bd9f83e67108ac008efa20601fb1ade}{additional\_ndof\_types}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00300}00300 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00301}00301       \textcolor{comment}{// Additional dof types for the constained bulk velocities}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00302}00302       \textcolor{comment}{// two velocities for a 2D problem, 3 for 3D.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00303}00303       \textcolor{keywordflow}{return} (this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}() + 1);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00304}00304     \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00305}00305 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00306}00306 \textcolor{comment}{    /// Create a list of pairs for all unknowns in this element,}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00307}00307 \textcolor{comment}{    /// so that the first entry in each pair contains the global equation}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00308}00308 \textcolor{comment}{    /// number of the unknown, while the second one contains the number}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00309}00309 \textcolor{comment}{    /// of the "{}DOF type"{} that this unknown is associated with.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00310}00310 \textcolor{comment}{    /// (Function can obviously only be called if the equation numbering}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00311}00311 \textcolor{comment}{    /// scheme has been set up.)}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00312}\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a722461f623710d20a71a28b5fa6018a9}{00312}} \textcolor{comment}{}    \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a722461f623710d20a71a28b5fa6018a9}{get\_dof\_numbers\_for\_unknowns}}(}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00313}00313       std::list<std::pair<unsigned long, unsigned>>\& dof\_lookup\_list)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00314}00314 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00315}00315       \textcolor{comment}{// temporary pair (used to store dof lookup prior to}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00316}00316       \textcolor{comment}{// being added to list)}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00317}00317       std::pair<unsigned, unsigned> dof\_lookup;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00318}00318 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00319}00319       \textcolor{comment}{// number of nodes}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00320}00320       \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a6219ed269a6d89b5aa14659cce48905a}{nnode}}();}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00321}00321 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00322}00322       \textcolor{comment}{// Loop over directions in this Face(!)Element}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00323}00323       \textcolor{keywordtype}{unsigned} dim\_el = this-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5f8fe59f06da1da9f6b7bbcbdb90ef93}{dim}}();}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00324}00324       \textcolor{comment}{// for(unsigned i=0;i<dim\_el;i++)}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00325}00325       \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00326}00326         \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} = 0;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00327}00327         \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00328}00328         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < n\_node; j++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00329}00329         \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00330}00330           \textcolor{comment}{// Cast to a boundary node}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00331}00331           \mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}* bnod\_pt =}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00332}00332             \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase}{BoundaryNodeBase}}*\textcolor{keyword}{>}(\mbox{\hyperlink{classoomph_1_1FiniteElement_a9addfe893ab8205619963aa96204cdc4}{node\_pt}}(j));}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00333}00333 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00334}00334           \textcolor{comment}{// Local eqn number:}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00335}00335           \textcolor{keywordtype}{int} local\_eqn = \mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00336}00336             j, bnod\_pt-\/>\mbox{\hyperlink{classoomph_1_1BoundaryNodeBase_a67c470bd15750e91775101b5bce65a58}{index\_of\_first\_value\_assigned\_by\_face\_element}}(\mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a6a8cf1048dbcc32288ea8eca1e6c380d}{Id}}) + \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}});}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00337}00337           \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00338}00338           \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00339}00339             \textcolor{comment}{// store dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00340}00340             \textcolor{comment}{// is global equation number; second entry is dof type}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00341}00341             dof\_lookup.first = this-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(local\_eqn);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00342}00342             dof\_lookup.second = \mbox{\hyperlink{cfortran_8h_adb50e893b86b3e55e751a42eab3cba82}{i}} + \mbox{\hyperlink{classoomph_1_1ImposeImpenetrabilityElement_a9bd9f83e67108ac008efa20601fb1ade}{additional\_ndof\_types}}();}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00343}00343 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00344}00344             \textcolor{comment}{// add to list}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00345}00345             dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00346}00346           \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00347}00347         \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00348}00348       \}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00349}00349 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00350}00350       \textcolor{comment}{//*}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00351}00351       \textcolor{comment}{// Now we do the bulk elements. Each velocity component of a constrained}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00352}00352       \textcolor{comment}{// dof of a different type of FaceElement has a different dof\_type. E.g.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00353}00353       \textcolor{comment}{// Consider the Navier Stokes equations in three spatial dimensions with}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00354}00354       \textcolor{comment}{// parallel outflow (using ImposeParallelOutflowElement with Boundary\_id =}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00355}00355       \textcolor{comment}{// 1) and tangential flow (using ImposeTangentialFlowElement with}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00356}00356       \textcolor{comment}{// Boundary\_id = 2) imposed along two different boundaries. There will be}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00357}00357       \textcolor{comment}{// 10 dof types: 0 1 2 3 4  5  6  7  8  9 u v w p u1 v1 w1 u2 v2 w2}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00358}00358 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00359}00359       \textcolor{comment}{// Loop over only the nodes of the "{}bulk"{} element that are associated}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00360}00360       \textcolor{comment}{// with this "{}face"{} element.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00361}00361       \textcolor{comment}{// cout << "{}n\_node: "{} << n\_node << endl;}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00362}00362       \textcolor{keywordtype}{unsigned} \textcolor{keyword}{const} bulk\_dim = dim\_el + 1;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00363}00363       \textcolor{comment}{// cout << "{}bulk\_dim: "{} << bulk\_dim << endl;}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00364}00364       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} node\_i = 0; node\_i < n\_node; node\_i++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00365}00365       \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00366}00366         \textcolor{comment}{// Loop over the velocity components}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00367}00367         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} velocity\_i = 0; velocity\_i < bulk\_dim; velocity\_i++)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00368}00368         \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00369}00369           \textcolor{comment}{// Calculating the offset for this Boundary\_id.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00370}00370           \textcolor{comment}{// 0 1 2 3 4  5  6  7  8  9}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00371}00371           \textcolor{comment}{// u v w p u1 v1 w1 u2 v2 w2}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00372}00372           \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00373}00373           \textcolor{comment}{// for the first surface mesh, offset = 4}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00374}00374           \textcolor{comment}{// for the second surface mesh, offset = 7}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00375}00375           \textcolor{comment}{// unsigned offset = bulk\_dim * Boundary\_id + 1;}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00377}00377           \textcolor{comment}{// The local equation number is required to check if the value is}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00378}00378           \textcolor{comment}{// pinned, if it is not pinned, the local equation number is required}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00379}00379           \textcolor{comment}{// to get the global equation number.}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00380}00380           \textcolor{keywordtype}{int} local\_eqn = \mbox{\hyperlink{classoomph_1_1FaceElement_a2d616b77ff557bbc70ece741fa2c6d96}{Bulk\_element\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1FiniteElement_a5da80bbed97543e586f698251d67941d}{nodal\_local\_eqn}}(}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00381}00381             \mbox{\hyperlink{classoomph_1_1FaceElement_a27a8a3240049a53c7fac20ebde716846}{Bulk\_node\_number}}[node\_i], velocity\_i);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00383}00383           \textcolor{comment}{// ignore pinned values}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00384}00384           \textcolor{keywordflow}{if} (local\_eqn >= 0)}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00385}00385           \{}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00386}00386             \textcolor{comment}{// store the dof lookup in temporary pair: First entry in pair}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00387}00387             \textcolor{comment}{// is the global equation number; second entry is the dof type}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00388}00388             dof\_lookup.first = \mbox{\hyperlink{classoomph_1_1FaceElement_a2d616b77ff557bbc70ece741fa2c6d96}{Bulk\_element\_pt}}-\/>\mbox{\hyperlink{classoomph_1_1GeneralisedElement_a37ac5a1d5234fa931ab710c0c74d55d2}{eqn\_number}}(local\_eqn);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00389}00389             dof\_lookup.second = velocity\_i;}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00390}00390             dof\_lookup\_list.push\_front(dof\_lookup);}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00391}00391 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00392}00392             \textcolor{comment}{// RRRcout << "{}Face v: "{} <<  dof\_lookup.first}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00393}00393             \textcolor{comment}{// RRR     << "{}, doftype: "{} << dof\_lookup.second << endl;}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00395}00395           \} \textcolor{comment}{// ignore pinned nodes "{}if(local-\/eqn>=0)"{}}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00396}00396         \} \textcolor{comment}{// for loop over the velocity components}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00397}00397       \} \textcolor{comment}{//  for loop over bulk nodes only}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00398}00398 }
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00399}00399     \} \textcolor{comment}{// get unknowns...}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00400}00400   \};}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00401}00401 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{impose__impenetrability__element_8h_source_l00402}00402 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

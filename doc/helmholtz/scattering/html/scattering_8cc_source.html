<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: scattering.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_84da053f12ef5a81ef4b3176404ae876.html">helmholtz</a></li><li class="navelem"><a class="el" href="dir_6faf8ab4c6e8139d15fac99dde938254.html">scattering</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">scattering.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="scattering_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//Driver for a specific  2D Helmholtz problem with flux boundary conditions</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//uses two separate meshes for bulk and surface mesh</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include&lt;fenv.h&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;math.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//Generic routines</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">// The Helmholtz equations</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;helmholtz.h&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// The mesh</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;meshes/annular_mesh.h&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// Get the Bessel functions</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;oomph_crbond_bessel.h&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//===== start_of_namespace=============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">/// Namespace for the Helmholtz problem parameters</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span><span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobalParameters.html">GlobalParameters</a></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> /// \short Square of the wavenumber</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">   64</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">K_squared</a>=10.0; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> /// \short Number of terms used in the computation </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> /// of the exact solution</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">   68</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>=10;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> /// \short Flag to choose the Dirichlet to Neumann BC</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> /// or ABC BC</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">   72</a></span>&#160;<span class="comment"></span> <span class="keywordtype">bool</span> <a class="code" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">DtN_BC</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> /// \short Flag to choose wich order to use</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> <span class="comment">// in the ABCs BC: 1 for ABC 1st order...</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="namespaceGlobalParameters.html#a552eed3548a269715a95161ad3c4b96a">   76</a></span>&#160; <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobalParameters.html#a552eed3548a269715a95161ad3c4b96a">ABC_order</a>=3;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"> /// Radius of outer boundary (must be a circle!)</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="namespaceGlobalParameters.html#a61b086072a6b8fd38af1a85f1dd1674a">   79</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#a61b086072a6b8fd38af1a85f1dd1674a">Outer_radius</a>=1.5;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> /// Imaginary unit </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span> std::complex&lt;double&gt; <a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>(0.0,1.0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> /// \short Exact solution for scattered field </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> /// (vector returns real and impaginary parts).</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="namespaceGlobalParameters.html#ae2320da6053f5527b2af5ebb362a8a07">   86</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobalParameters.html#ae2320da6053f5527b2af5ebb362a8a07">get_exact_u</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; x, Vector&lt;double&gt;&amp; <a class="code" href="scattering_8txt.html#a8c816198c8bd9c7829d875346c691800">u</a>)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// Switch to polar coordinates</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">double</span> r;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  r=sqrt(x[0]*x[0]+x[1]*x[1]);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordtype">double</span> theta;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  theta=atan2(x[1],x[0]);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// Argument for Bessel/Hankel functions</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">double</span> rr=sqrt(<a class="code" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">K_squared</a>)*r;  </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// Evaluate Bessel/Hankel functions</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  complex &lt;double &gt; u_ex(0.0,0.0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  Vector&lt;double&gt; jn(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1), yn(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   jnp(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1), ynp(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  Vector&lt;double&gt; jn_a(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1),yn_a(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1),</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   jnp_a(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1), ynp_a(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  Vector&lt;complex&lt;double&gt; &gt; h(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1),h_a(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   hp(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1), hp_a(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// We want to compute N_fourier terms but the function</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// may return fewer than that.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">int</span> n_actual=0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  CRBond_Bessel::bessjyna(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>,sqrt(<a class="code" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">K_squared</a>),n_actual,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                          &amp;jn_a[0],&amp;yn_a[0],</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                          &amp;jnp_a[0],&amp;ynp_a[0]); </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// Shout if things went wrong  </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">if</span> (n_actual!=<span class="keywordtype">int</span>(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>))</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    std::ostringstream error_stream; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    error_stream &lt;&lt; <span class="stringliteral">&quot;CRBond_Bessel::bessjyna() only computed &quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                 &lt;&lt; n_actual &lt;&lt; <span class="stringliteral">&quot; rather than &quot;</span> &lt;&lt; <a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a> </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; Bessel functions.\n&quot;</span>;    </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// Evaluate Hankel at actual radius</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  Hankel_functions_for_helmholtz_problem::Hankel_first(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>,rr,h,hp);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// Evaluate Hankel at inner (unit) radius</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  Hankel_functions_for_helmholtz_problem::Hankel_first(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                                       ,sqrt(<a class="code" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">K_squared</a>),</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                                       h_a,hp_a);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// Compute the sum: Separate the computation of the negative </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// and positive terms</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>;i++)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    u_ex-=pow(<a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>,i)*h[i]*((jnp_a[i])/hp_a[i])*pow(exp(<a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>*theta),i);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=1;i&lt;<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>;i++)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    u_ex-=pow(<a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>,i)*h[i]*((jnp_a[i])/hp_a[i])*pow(exp(-<a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>*theta),i);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// Get the real &amp; imaginary part of the result</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="scattering_8txt.html#a8c816198c8bd9c7829d875346c691800">u</a>[0]=real(u_ex);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="scattering_8txt.html#a8c816198c8bd9c7829d875346c691800">u</a>[1]=imag(u_ex);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; }<span class="comment">// end of get_exact_u</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> /// \short Flux (normal derivative) on the unit disk</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> /// for a planar incoming wave</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="namespaceGlobalParameters.html#a5183de63b992338ee60bb4da78a45039">  156</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobalParameters.html#a5183de63b992338ee60bb4da78a45039">prescribed_incoming_flux</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; x, </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                               complex&lt;double&gt;&amp; <a class="code" href="scattering_8txt.html#a6e2308ba2b055a80cdd4c2a0469b7d60">flux</a>)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// Switch to polar coordinates</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">double</span> r;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  r=sqrt(x[0]*x[0]+x[1]*x[1]);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordtype">double</span> theta;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  theta=atan2(x[1],x[0]);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// Argument of the Bessel/Hankel fcts</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordtype">double</span> rr=sqrt(<a class="code" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">K_squared</a>)*r;  </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// Compute Bessel/Hankel functions</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  Vector&lt;double&gt; jn(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1), yn(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   jnp(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1), ynp(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>+1);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="comment">// We want to compute N_fourier terms but the function</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// may return fewer than that.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">int</span> n_actual=0;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  CRBond_Bessel::bessjyna(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>,rr,n_actual,&amp;jn[0],&amp;yn[0],</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                          &amp;jnp[0],&amp;ynp[0]);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// Shout if things went wrong...</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#ifdef PARANOID</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span> (n_actual!=<span class="keywordtype">int</span>(<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>))</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    std::ostringstream error_stream; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    error_stream &lt;&lt; <span class="stringliteral">&quot;CRBond_Bessel::bessjyna() only computed &quot;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                 &lt;&lt; n_actual &lt;&lt; <span class="stringliteral">&quot; rather than &quot;</span> &lt;&lt; <a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a> </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; Bessel functions.\n&quot;</span>;    </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">throw</span> OomphLibError(error_stream.str(),</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// Compute the sum: Separate the computation of the negative and </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// positive terms</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="scattering_8txt.html#a6e2308ba2b055a80cdd4c2a0469b7d60">flux</a>=std::complex&lt;double&gt;(0.0,0.0);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>;i++)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="scattering_8txt.html#a6e2308ba2b055a80cdd4c2a0469b7d60">flux</a>+=pow(<a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>,i)*(sqrt(<a class="code" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">K_squared</a>))*pow(exp(<a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>*theta),i)*jnp[i];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=1;i&lt;<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">N_fourier</a>;i++)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="scattering_8txt.html#a6e2308ba2b055a80cdd4c2a0469b7d60">flux</a>+=pow(<a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>,i)*(sqrt(<a class="code" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">K_squared</a>))*pow(exp(-<a class="code" href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">I</a>*theta),i)*jnp[i];</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; }<span class="comment">// end of prescribed_incoming_flux </span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;} <span class="comment">// end of namespace</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">/////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">//========= start_of_problem_class=====================================</span><span class="comment"></span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">/// Problem class to compute scattering of planar wave from unit disk</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span><span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt; </div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classScatteringProblem.html">  222</a></span>&#160;<span class="keyword">class </span><a class="code" href="classScatteringProblem.html">ScatteringProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"> /// Constructor</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> <a class="code" href="classScatteringProblem.html">ScatteringProblem</a>();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a0a9838027d0286f22706fe6945bbac0a">  231</a></span>&#160;<span class="comment"></span> <a class="code" href="classScatteringProblem.html#a0a9838027d0286f22706fe6945bbac0a">~ScatteringProblem</a>(){}</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> /// \short Doc the solution. DocInfo object stores flags/labels for where the</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> /// output gets written to</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo&amp; doc_info);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"> /// \short Update the problem specs before solve (empty)</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a91ce14b928ec6edbb9d85515a310b1fb">  238</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#a91ce14b928ec6edbb9d85515a310b1fb">actions_before_newton_solve</a>(){} </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"> /// Update the problem specs after solve (empty)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#abf1e7b97518c94e12802205dec08b15e">  241</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#abf1e7b97518c94e12802205dec08b15e">actions_after_newton_solve</a>(){}</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> /// Recompute gamma integral before checking Newton residuals</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#ad096c311ee474d23514656d2ba76a4b8">  244</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#ad096c311ee474d23514656d2ba76a4b8">actions_before_newton_convergence_check</a>()</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">GlobalParameters::DtN_BC</a>)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;     Helmholtz_outer_boundary_mesh_pt-&gt;setup_gamma();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> /// Actions before adapt: Wipe the mesh of prescribed flux elements</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> actions_before_adapt();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> /// Actions after adapt: Rebuild the mesh of prescribed flux elements</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> actions_after_adapt();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"> /// \short Create BC elements on boundary b of the Mesh pointed</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"> /// to by bulk_mesh_pt and add them to the specified survace Mesh </span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> create_outer_bc_elements(</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;b, Mesh* <span class="keyword">const</span> &amp;bulk_mesh_pt,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  Mesh* <span class="keyword">const</span> &amp; helmholtz_outer_boundary_mesh_pt);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> /// \short Create Helmholtz flux elements on boundary b of the Mesh pointed</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> /// to by bulk_mesh_pt and add them to the specified surface Mesh </span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="scattering_8txt.html#adf96798a41c029db39789a3f53d931b8">create_flux_elements</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;b, Mesh* <span class="keyword">const</span> &amp;bulk_mesh_pt,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                           Mesh* <span class="keyword">const</span> &amp; helmholtz_inner_boundary_mesh_pt);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> /// \short Delete boundary face elements and wipe the surface mesh</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> delete_face_elements( Mesh* <span class="keyword">const</span> &amp; boundary_mesh_pt);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"> /// \short Set pointer to prescribed-flux function for all</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> /// elements in the surface mesh on the surface of the unit disk</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> set_prescribed_incoming_flux_pt();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> /// \short Set up boundary condition elements on outer boundary</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> setup_outer_boundary();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">/// Pointer to the &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a8c61657a1d09ce49a5871ca3febe5658">  282</a></span>&#160;<span class="comment"></span> RefineableTwoDAnnularMesh&lt;ELEMENT&gt;* <a class="code" href="classScatteringProblem.html#a8c61657a1d09ce49a5871ca3febe5658">Bulk_mesh_pt</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"> /// Pointer to the &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#aac3ed9baf77bc66421a7d980ca359bf9">  287</a></span>&#160;<span class="comment"></span> TwoDAnnularMesh&lt;ELEMENT&gt;* <a class="code" href="classScatteringProblem.html#aac3ed9baf77bc66421a7d980ca359bf9">Bulk_mesh_pt</a>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> /// \short Pointer to mesh containing the DtN (or ABC) boundary</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> /// condition elements</span></div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a9692c8592b57a4363e557e5b012c744b">  293</a></span>&#160;<span class="comment"></span> HelmholtzDtNMesh&lt;ELEMENT&gt;* <a class="code" href="classScatteringProblem.html#a9692c8592b57a4363e557e5b012c744b">Helmholtz_outer_boundary_mesh_pt</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> /// \short Pointer to the mesh containing </span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> /// the Helmholtz inner boundary condition elements </span></div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a56b5fc73bbb51b701a43dc38f9815104">  297</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classScatteringProblem.html#a56b5fc73bbb51b701a43dc38f9815104">Helmholtz_inner_boundary_mesh_pt</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}; <span class="comment">// end of problem class</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">//=======start_of_constructor=============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">/// Constructor for Helmholtz problem</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<a class="code" href="classScatteringProblem.html#a94710f5d2ee52abc3df9dc8d1fd3eb71">ScatteringProblem&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a94710f5d2ee52abc3df9dc8d1fd3eb71">  308</a></span>&#160;<a class="code" href="classScatteringProblem.html#a94710f5d2ee52abc3df9dc8d1fd3eb71">ScatteringProblem</a>()</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{ </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; <span class="comment">// Setup &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; <span class="comment">// # of elements in theta</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; <span class="keywordtype">unsigned</span> n_theta=15;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; <span class="comment">// # of elements in radius</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; <span class="keywordtype">unsigned</span> n_r=5;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; <span class="comment">// Inner radius</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; <span class="keywordtype">double</span> a=1.0;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; <span class="comment">// Thickness of annular computational domain</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; <span class="keywordtype">double</span> h=0.5; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; <span class="comment">// Set outer radius</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; <a class="code" href="namespaceGlobalParameters.html#a61b086072a6b8fd38af1a85f1dd1674a">GlobalParameters::Outer_radius</a>=a+h;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; <span class="comment">// Mesh is periodic</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; <span class="keywordtype">bool</span> periodic=<span class="keyword">true</span>; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; <span class="comment">// Full circle</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; <span class="keywordtype">double</span> azimuthal_fraction=1.0;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; <span class="comment">// Build &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; Bulk_mesh_pt=</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keyword">new</span> RefineableTwoDAnnularMesh&lt;ELEMENT&gt;(periodic,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                         azimuthal_fraction,n_theta,n_r,a,h);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; <span class="comment">// Create/set error estimator</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; Bulk_mesh_pt-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; <span class="comment">// Choose error tolerances to force some uniform refinement</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; Bulk_mesh_pt-&gt;min_permitted_error()=0.004;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; Bulk_mesh_pt-&gt;max_permitted_error()=0.01;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; <span class="comment">// Build &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; Bulk_mesh_pt=</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keyword">new</span> TwoDAnnularMesh&lt;ELEMENT&gt;(periodic,</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                               azimuthal_fraction,n_theta,n_r,a,h);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; <span class="comment">// Pointer to mesh containing the Helmholtz outer boundary condition</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; <span class="comment">// elements. Specify outer radius and number of Fourier terms to be</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; <span class="comment">// used in gamma integral</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; Helmholtz_outer_boundary_mesh_pt = </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keyword">new</span> HelmholtzDtNMesh&lt;ELEMENT&gt;(a+h,<a class="code" href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">GlobalParameters::N_fourier</a>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; <span class="comment">// Pointer to mesh containing the Helmholtz inner boundary condition</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; <span class="comment">// elements. Specify outer radius</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; Helmholtz_inner_boundary_mesh_pt = <span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; <span class="comment">// Create prescribed-flux elements from all elements that are </span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; <span class="comment">// adjacent to the inner boundary , but add them to a separate mesh.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; <a class="code" href="scattering_8txt.html#adf96798a41c029db39789a3f53d931b8">create_flux_elements</a>(0,Bulk_mesh_pt,Helmholtz_inner_boundary_mesh_pt);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; <span class="comment">// Create outer boundary elements from all elements that are </span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; <span class="comment">// adjacent to the outer boundary , but add them to a separate mesh.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; create_outer_bc_elements(2,Bulk_mesh_pt,Helmholtz_outer_boundary_mesh_pt);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; <span class="comment">// Add the several  sub meshes to the problem</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; add_sub_mesh(Bulk_mesh_pt);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; add_sub_mesh(Helmholtz_outer_boundary_mesh_pt); </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; add_sub_mesh(Helmholtz_inner_boundary_mesh_pt);   </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; <span class="comment">// Build the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; build_global_mesh();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; <span class="comment">// Complete the build of all elements so they are fully functional</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; <span class="comment">// Loop over the Helmholtz bulk elements to set up element-specific </span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; <span class="comment">// things that cannot be handled by constructor: Pass pointer to </span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; <span class="comment">// wave number squared</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; <span class="keywordtype">unsigned</span> n_element = Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to Helmholtz bulk element</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="comment">//Set the k_squared  pointer</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   el_pt-&gt;k_squared_pt() = &amp;<a class="code" href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">GlobalParameters::K_squared</a>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; <span class="comment">// Set up elements on outer boundary</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; setup_outer_boundary();</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; <span class="comment">// Set pointer to prescribed flux function for flux elements</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; set_prescribed_incoming_flux_pt();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;} <span class="comment">// end of constructor</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">//=====================start_of_actions_before_adapt======================</span><span class="comment"></span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">/// Actions before adapt: Wipe the mesh of face elements</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#aca1b756a307f9c1d8a70c7b7e68a296b">  413</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#aca1b756a307f9c1d8a70c7b7e68a296b">ScatteringProblem&lt;ELEMENT&gt;::actions_before_adapt</a>()</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{ </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; <span class="comment">// Kill the flux elements and wipe the boundary meshs</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; delete_face_elements(Helmholtz_outer_boundary_mesh_pt);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; delete_face_elements(Helmholtz_inner_boundary_mesh_pt);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; rebuild_global_mesh();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}<span class="comment">// end of actions_before_adapt</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">//=====================start_of_actions_after_adapt=======================</span><span class="comment"></span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">///  Actions after adapt: Rebuild the face element meshes</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a13d8f85e74666c260de7364917359ed5">  429</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#a13d8f85e74666c260de7364917359ed5">ScatteringProblem&lt;ELEMENT&gt;::actions_after_adapt</a>()</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;{</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; <span class="comment">// Create prescribed-flux elements and BC elements </span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; <span class="comment">// from all elements that are adjacent to the boundaries and add them to </span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; <span class="comment">// Helmholtz_boundary_meshes</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; create_outer_bc_elements(2,Bulk_mesh_pt,Helmholtz_outer_boundary_mesh_pt);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; <a class="code" href="scattering_8txt.html#adf96798a41c029db39789a3f53d931b8">create_flux_elements</a>(0,Bulk_mesh_pt,Helmholtz_inner_boundary_mesh_pt);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; rebuild_global_mesh();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; <span class="comment">// Set pointer to prescribed flux function and DtN mesh</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; setup_outer_boundary();</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; set_prescribed_incoming_flux_pt(); </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}<span class="comment">// end of actions_after_adapt</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">//==================start_of_setup_outer_boundary=========================</span><span class="comment"></span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">/// Set pointers for elements on outer boundary</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a76bd8299ea7ed559681b294acfb2aad4">  451</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#a76bd8299ea7ed559681b294acfb2aad4">ScatteringProblem&lt;ELEMENT&gt;::setup_outer_boundary</a>()</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;{ </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; <span class="comment">// Loop over the flux elements to pass pointer to DtN</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; <span class="comment">// BC for the outer boundary</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; <span class="keywordtype">unsigned</span> n_element=Helmholtz_outer_boundary_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="comment">// Dirichlet to Neumann BC</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">GlobalParameters::DtN_BC</a>)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;     <span class="comment">// Upcast from GeneralisedElement to Helmholtz flux element</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;     HelmholtzDtNBoundaryElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keyword">dynamic_cast&lt;</span> HelmholtzDtNBoundaryElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;       Helmholtz_outer_boundary_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;     </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;     <span class="comment">// Set pointer to the mesh that contains all the boundary condition</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;     <span class="comment">// elements on this boundary</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;     el_pt-&gt;set_outer_boundary_mesh_pt(Helmholtz_outer_boundary_mesh_pt);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="comment">// ABCs BC</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;     <span class="comment">// Upcast from GeneralisedElement to appropriate type</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;     HelmholtzAbsorbingBCElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keyword">dynamic_cast&lt;</span> HelmholtzAbsorbingBCElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;       Helmholtz_outer_boundary_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;     </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;     <span class="comment">// Set pointer to outer radius of artificial boundary</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;     el_pt-&gt;outer_radius_pt()=&amp;<a class="code" href="namespaceGlobalParameters.html#a61b086072a6b8fd38af1a85f1dd1674a">GlobalParameters::Outer_radius</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;     </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;     <span class="comment">// Set order of absorbing boundary condition</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;     el_pt-&gt;abc_order_pt()=&amp;<a class="code" href="namespaceGlobalParameters.html#a552eed3548a269715a95161ad3c4b96a">GlobalParameters::ABC_order</a>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }    </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">//==================start_of_set_prescribed_incoming_flux_pt==============</span><span class="comment"></span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">/// Set pointer to prescribed incoming-flux function for all</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">/// elements in the inner boundary</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#ae75307dde909513a0f11057c96cdd622">  493</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#ae75307dde909513a0f11057c96cdd622">ScatteringProblem&lt;ELEMENT&gt;::set_prescribed_incoming_flux_pt</a>()</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;{</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; <span class="comment">// Loop over the flux elements to pass pointer to prescribed </span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; <span class="comment">// flux function for the inner boundary </span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; <span class="keywordtype">unsigned</span> n_element=Helmholtz_inner_boundary_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to Helmholtz flux element</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   HelmholtzFluxElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>  HelmholtzFluxElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;     Helmholtz_inner_boundary_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <span class="comment">// Set the pointer to the prescribed flux function</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   el_pt-&gt;flux_fct_pt() =</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    &amp;<a class="code" href="namespaceGlobalParameters.html#a5183de63b992338ee60bb4da78a45039">GlobalParameters::prescribed_incoming_flux</a>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}<span class="comment">// end of set prescribed_incoming_flux pt</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">//=====================start_of_doc=======================================</span><span class="comment"></span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">/// Doc the solution: doc_info contains labels/output directory etc.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#af83ab14c4f4750ea17c21466f6c6364f">  516</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#af83ab14c4f4750ea17c21466f6c6364f">ScatteringProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                              doc_info) </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;{ </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; ofstream some_file,some_file2;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; npts=5; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; <span class="comment">// Compute/output the radiated power</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; <span class="comment">//----------------------------------</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/power%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; <span class="comment">// Accumulate contribution from elements</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; <span class="keywordtype">double</span> <a class="code" href="scattering_8txt.html#a649ec8dc57f56a2947bb323f273049ca">power</a>=0.0;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; <span class="keywordtype">unsigned</span> nn_element=Helmholtz_outer_boundary_mesh_pt-&gt;nelement(); </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;nn_element;e++)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   HelmholtzBCElementBase&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keyword">dynamic_cast&lt;</span> HelmholtzBCElementBase&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;     Helmholtz_outer_boundary_mesh_pt-&gt;element_pt(e)); </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <a class="code" href="scattering_8txt.html#a649ec8dc57f56a2947bb323f273049ca">power</a> += el_pt-&gt;global_power_contribution(some_file);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; some_file.close();</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; oomph_info &lt;&lt; <span class="stringliteral">&quot;Total radiated power: &quot;</span> &lt;&lt; <a class="code" href="scattering_8txt.html#a649ec8dc57f56a2947bb323f273049ca">power</a> &lt;&lt; std::endl; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; <span class="comment">// Output solution </span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; <span class="comment">//-----------------</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; Bulk_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; some_file.close();</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// Output exact solution </span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; <span class="comment">//----------------------</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/exact_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; Bulk_mesh_pt-&gt;output_fct(some_file,npts,<a class="code" href="namespaceGlobalParameters.html#ae2320da6053f5527b2af5ebb362a8a07">GlobalParameters::get_exact_u</a>); </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; some_file.close();</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; <span class="keywordtype">double</span> error,norm;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/error%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; Bulk_mesh_pt-&gt;compute_error(some_file,<a class="code" href="namespaceGlobalParameters.html#ae2320da6053f5527b2af5ebb362a8a07">GlobalParameters::get_exact_u</a>,</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                             error,norm); </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; some_file.close();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; <span class="comment">// Doc L2 error and norm of solution</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; oomph_info &lt;&lt; <span class="stringliteral">&quot;\nNorm of error   : &quot;</span> &lt;&lt; sqrt(error) &lt;&lt; std::endl; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; oomph_info &lt;&lt; <span class="stringliteral">&quot;Norm of solution: &quot;</span> &lt;&lt; sqrt(norm) &lt;&lt; std::endl &lt;&lt; std::endl;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; <span class="comment">// Do animation of Helmholtz solution</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; <span class="comment">//-----------------------------------</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; <span class="keywordtype">unsigned</span> nstep=40;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;nstep;i++)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   sprintf(filename,<span class="stringliteral">&quot;%s/helmholtz_animation%i_frame%i.dat&quot;</span>,</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;           doc_info.directory().c_str(),</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;           doc_info.number(),i);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   some_file.open(filename);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   sprintf(filename,<span class="stringliteral">&quot;%s/exact_helmholtz_animation%i_frame%i.dat&quot;</span>,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;           doc_info.directory().c_str(),</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;           doc_info.number(),i);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   some_file2.open(filename);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <span class="keywordtype">double</span> phi=2.0*MathematicalConstants::Pi*double(i)/double(nstep-1);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <span class="keywordtype">unsigned</span> nelem=Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nelem;e++)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;     ELEMENT* el_pt=<span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      Bulk_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;     el_pt-&gt;output_real(some_file,phi,npts);    </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;     el_pt-&gt;output_real_fct(some_file2,phi,npts,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                            <a class="code" href="namespaceGlobalParameters.html#ae2320da6053f5527b2af5ebb362a8a07">GlobalParameters::get_exact_u</a>); </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   some_file.close();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   some_file2.close();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;} <span class="comment">// end of doc</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">//============start_of_create_flux_elements==================================</span><span class="comment"></span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">/// Create Helmholtz inner Flux Elements on the b-th boundary of </span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">/// the Mesh object pointed to by bulk_mesh_pt and add the elements </span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">/// to the Mesh object  pointed to by helmholtz_inner_boundary_mesh_pt</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#af06ff518ad3250f914c0c659af3001c8">ScatteringProblem&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00611"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#af06ff518ad3250f914c0c659af3001c8">  611</a></span>&#160;<a class="code" href="classScatteringProblem.html#af06ff518ad3250f914c0c659af3001c8">create_flux_elements</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;b, Mesh* <span class="keyword">const</span> &amp;bulk_mesh_pt,</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                     Mesh* <span class="keyword">const</span> &amp; helmholtz_inner_boundary_mesh_pt)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;{</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; <span class="keywordtype">unsigned</span> n_element = bulk_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    bulk_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   <span class="comment">//Find the index of the face of element e along boundary b </span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <span class="keywordtype">int</span> face_index = bulk_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <span class="comment">// Build the corresponding prescribed incoming-flux element</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   HelmholtzFluxElement&lt;ELEMENT&gt;* flux_element_pt = <span class="keyword">new</span> </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    HelmholtzFluxElement&lt;ELEMENT&gt;(bulk_elem_pt,face_index);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="comment">//Add the prescribed incoming-flux element to the surface mesh</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   helmholtz_inner_boundary_mesh_pt-&gt;add_element_pt(flux_element_pt);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  } <span class="comment">//end of loop over bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;} <span class="comment">// end of create_flux_elements</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">//============start_of_create_outer_bc_elements==============================</span><span class="comment"></span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">/// Create outer BC elements on the b-th boundary of </span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">/// the Mesh object pointed to by bulk_mesh_pt and add the elements </span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">/// to the Mesh object pointed to by helmholtz_outer_boundary_mesh_pt.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span><span class="comment">//===========================================================================</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#a408e05fbe1f1456ab7013a7e8ab29ccc">ScatteringProblem&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#a408e05fbe1f1456ab7013a7e8ab29ccc">  645</a></span>&#160;<a class="code" href="classScatteringProblem.html#a408e05fbe1f1456ab7013a7e8ab29ccc">create_outer_bc_elements</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;b, Mesh* <span class="keyword">const</span> &amp;bulk_mesh_pt,</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                         Mesh* <span class="keyword">const</span> &amp; helmholtz_outer_boundary_mesh_pt)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;{</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; <span class="comment">// Loop over the bulk elements adjacent to boundary b?</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; <span class="keywordtype">unsigned</span> n_element = bulk_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    bulk_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   <span class="comment">//Find the index of the face of element e along boundary b </span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordtype">int</span> face_index = bulk_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <span class="comment">// Build the corresponding outer flux element</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="comment">// Dirichlet to Neumann boundary conditon</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">GlobalParameters::DtN_BC</a>)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;     HelmholtzDtNBoundaryElement&lt;ELEMENT&gt;* flux_element_pt = <span class="keyword">new</span> </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      HelmholtzDtNBoundaryElement&lt;ELEMENT&gt;(bulk_elem_pt,face_index);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;     </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     <span class="comment">//Add the flux boundary element to the  helmholtz_outer_boundary_mesh</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;     helmholtz_outer_boundary_mesh_pt-&gt;add_element_pt(flux_element_pt);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <span class="comment">//  ABCs BC</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;     HelmholtzAbsorbingBCElement&lt;ELEMENT&gt;* flux_element_pt = <span class="keyword">new</span> </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      HelmholtzAbsorbingBCElement&lt;ELEMENT&gt;(bulk_elem_pt,face_index);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;     </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;     <span class="comment">//Add the flux boundary element to the  helmholtz_outer_boundary_mesh</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;     helmholtz_outer_boundary_mesh_pt-&gt;add_element_pt(flux_element_pt);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  } <span class="comment">//end of loop over bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;} <span class="comment">// end of create_outer_bc_elements</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">//============start_of_delete_face_elements================</span><span class="comment"></span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">/// Delete face elements and wipe the boundary mesh</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span><span class="comment">//==========================================================</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classScatteringProblem.html#aaef8a78e317333ddadd0be6a500c1134">ScatteringProblem&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00688"></a><span class="lineno"><a class="line" href="classScatteringProblem.html#aaef8a78e317333ddadd0be6a500c1134">  688</a></span>&#160;<a class="code" href="classScatteringProblem.html#aaef8a78e317333ddadd0be6a500c1134">delete_face_elements</a>(Mesh* <span class="keyword">const</span> &amp; boundary_mesh_pt)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;{</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; <span class="comment">// Loop over the surface elements</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; <span class="keywordtype">unsigned</span> n_element = boundary_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   <span class="comment">// Kill surface element</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <span class="keyword">delete</span>  boundary_mesh_pt-&gt;element_pt(e);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; <span class="comment">// Wipe the mesh</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; boundary_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;} <span class="comment">// end of delete_outer_face_elements</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">//==========start_of_main=================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">/// Solve 2D Helmholtz problem for scattering of a planar wave from a </span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">/// unit disk </span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="scattering_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">  709</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="scattering_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;{</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; <span class="comment">// Store command line arguments</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; CommandLineArgs::setup(argc,argv);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; <span class="comment">// Define case to be run</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; <span class="keywordtype">unsigned</span> i_case=0;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--case&quot;</span>,&amp;i_case);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; <span class="comment">// Parse command line</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; CommandLineArgs::parse_and_assign(); </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; <span class="comment">// Doc what has actually been specified on the command line</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; CommandLineArgs::doc_specified_flags();</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; <span class="comment">// Now set flags accordingly</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; <span class="keywordflow">switch</span>(i_case)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <a class="code" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">GlobalParameters::DtN_BC</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <a class="code" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">GlobalParameters::DtN_BC</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <a class="code" href="namespaceGlobalParameters.html#a552eed3548a269715a95161ad3c4b96a">GlobalParameters::ABC_order</a>=1;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <a class="code" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">GlobalParameters::DtN_BC</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   <a class="code" href="namespaceGlobalParameters.html#a552eed3548a269715a95161ad3c4b96a">GlobalParameters::ABC_order</a>=2;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   <a class="code" href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">GlobalParameters::DtN_BC</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <a class="code" href="namespaceGlobalParameters.html#a552eed3548a269715a95161ad3c4b96a">GlobalParameters::ABC_order</a>=3;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; <span class="comment">//Set up the problem</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; <span class="comment">//------------------</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; <span class="comment">//Set up the problem with 2D nine-node elements from the</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; <span class="comment">//QHelmholtzElement family.</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; <a class="code" href="classScatteringProblem.html">ScatteringProblem&lt;RefineableQHelmholtzElement&lt;2,3&gt;</a> &gt; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <a class="code" href="scattering_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; <span class="comment">//Set up the problem with 2D nine-node elements from the</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; <span class="comment">//QHelmholtzElement family. </span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; <a class="code" href="classScatteringProblem.html">ScatteringProblem&lt;QHelmholtzElement&lt;2,3&gt;</a> &gt; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <a class="code" href="scattering_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; <span class="comment">// Create label for output</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; <span class="comment">//------------------------</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; <span class="comment">// Set output directory</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; <span class="comment">// Max. number of adaptations</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; <span class="keywordtype">unsigned</span> max_adapt=1;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   <span class="comment">// Solve the problem with Newton&#39;s method, allowing</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <span class="comment">// up to max_adapt mesh adaptations after every solve.</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <a class="code" href="scattering_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>.newton_solve(max_adapt);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <span class="comment">// Solve the problem with Newton&#39;s method</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <a class="code" href="scattering_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>.newton_solve();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; <span class="comment">//Output solution</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; <a class="code" href="scattering_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a>.doc_solution(doc_info);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;} <span class="comment">//end of main</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="ascattering_8txt_html_adf96798a41c029db39789a3f53d931b8"><div class="ttname"><a href="scattering_8txt.html#adf96798a41c029db39789a3f53d931b8">create_flux_elements</a></div><div class="ttdeci">we complete the build of the various elements by by passing pointers to the relevant quantities to and assign the equation numbers dontinclude scattering cc skipline until The problem is now ready to be solved&lt; HR &gt;&lt; HR &gt; subsection before_adapt Actions before adapt The mesh adaptation is driven by the error estimates for the bulk elements The various c FaceElements must therefore be removed from the global mesh before the adaptation takes place We do this by calling the function c before rebuilding the Problem s global mesh dontinclude scattering cc skipline start_of_actions_before_adapt until&lt; HR &gt;&lt; HR &gt; subsection after_adapt Actions after adapt After the flux elements must be re attached This is done by calling the functions c create_flux_elements(...) and \c create_outer_bc_elements</div></div>
<div class="ttc" id="ascattering_8txt_html_a8c816198c8bd9c7829d875346c691800"><div class="ttname"><a href="scattering_8txt.html#a8c816198c8bd9c7829d875346c691800">u</a></div><div class="ttdeci">bigg[ik-\frac {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg u)</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00150">scattering.txt:150</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a408e05fbe1f1456ab7013a7e8ab29ccc"><div class="ttname"><a href="classScatteringProblem.html#a408e05fbe1f1456ab7013a7e8ab29ccc">ScatteringProblem::create_outer_bc_elements</a></div><div class="ttdeci">void create_outer_bc_elements(const unsigned &amp;b, Mesh *const &amp;bulk_mesh_pt, Mesh *const &amp;helmholtz_outer_boundary_mesh_pt)</div><div class="ttdoc">Create BC elements on boundary b of the Mesh pointed to by bulk_mesh_pt and add them to the specified...</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00645">scattering.cc:645</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a56b5fc73bbb51b701a43dc38f9815104"><div class="ttname"><a href="classScatteringProblem.html#a56b5fc73bbb51b701a43dc38f9815104">ScatteringProblem::Helmholtz_inner_boundary_mesh_pt</a></div><div class="ttdeci">Mesh * Helmholtz_inner_boundary_mesh_pt</div><div class="ttdoc">Pointer to the mesh containing the Helmholtz inner boundary condition elements</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00297">scattering.cc:297</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ae4df03bf0ffa55b741ac846ca7b6c155"><div class="ttname"><a href="namespaceGlobalParameters.html#ae4df03bf0ffa55b741ac846ca7b6c155">GlobalParameters::N_fourier</a></div><div class="ttdeci">unsigned N_fourier</div><div class="ttdoc">Number of terms used in the computation of the exact solution.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00068">scattering.cc:68</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a94710f5d2ee52abc3df9dc8d1fd3eb71"><div class="ttname"><a href="classScatteringProblem.html#a94710f5d2ee52abc3df9dc8d1fd3eb71">ScatteringProblem::ScatteringProblem</a></div><div class="ttdeci">ScatteringProblem()</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00308">scattering.cc:308</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a649ec8dc57f56a2947bb323f273049ca"><div class="ttname"><a href="scattering_8txt.html#a649ec8dc57f56a2947bb323f273049ca">power</a></div><div class="ttdeci">bigg[ik-\frac {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg] d Newton s method will converge in one iteration In such cases the unnecessary recomputation of f gamma f after the one and only Newton iteration can be suppressed by setting c Problem::Problem_is_nonlinear to c false&lt; HR &gt;&lt; HR &gt; section scattering A specific impermeable obstacle as shown in this I w textwidth scattering Scattering of an incoming wave from a sound hard obstacle the scatterer we wish to find the wave field that is scattered from the body For this purpose we denote the time dependent displacement of the fluid particle in the acoustic medium by the normal displacement of the fluid has to vanish on f partial non dimensionalise the potential as f Phi f t f power[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{bound}}=- \left. \frac{\partial \phi_{inc}}{\partial n}\right|_{\partial D_{bound}}.\ \ \ \ \ \ \ \ \ \ \ \ \ @E[non_pen_bc_for_scattered]@\f] For the special case of the incoming wave being a planar propagating along the x the incoming field can be written in polar coordinates as f[\phi_{inc}(r, \varphi)=\sum_{n=-\infty}^{+\infty} i^n J_n(kr) e^{in\varphi}, \f] where f J_n f is the Bessel function of the first kind of order f n f The exact solution for the scattering of such a wave from a circular disk is given by the series f[u_{ex}(r,\varphi)=-\sum_{n=-\infty}^{+\infty} i^n \frac{H^{'}_{n}(k)}{J^{'}_{n}(k)} H_n(kr) e^{in\varphi},\ \ \ \ \ \ \ \ \ \ \ \ \ @E[exact_scattered]@\f] where we have chosen the disk s f a as the lengthscale by setting f H_n f denotes the Hankel function of the first kind of order f n f and the prime denotes differentiation with respect to the function s argument A quantity that is of particular interest in wave propagation problems is the time average of the power radiated by the f[\overline{\cal P}^ *=\frac{\omega}{2\pi} \int_{0}^{2\pi/\omega} {\cal P}^ *(t) \ dt^ *.\f] In the context of an acoustic the total instantaneous</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00323">scattering.txt:323</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a8d895bb93cd829890aa4c1a2d5682792"><div class="ttname"><a href="scattering_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00005">scattering.txt:5</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html"><div class="ttname"><a href="namespaceGlobalParameters.html">GlobalParameters</a></div><div class="ttdoc">Namespace for &quot;global&quot; problem parameters.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00044">barrel.cc:44</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a5183de63b992338ee60bb4da78a45039"><div class="ttname"><a href="namespaceGlobalParameters.html#a5183de63b992338ee60bb4da78a45039">GlobalParameters::prescribed_incoming_flux</a></div><div class="ttdeci">void prescribed_incoming_flux(const Vector&lt; double &gt; &amp;x, complex&lt; double &gt; &amp;flux)</div><div class="ttdoc">Flux (normal derivative) on the unit disk for a planar incoming wave.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00156">scattering.cc:156</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a6e2308ba2b055a80cdd4c2a0469b7d60"><div class="ttname"><a href="scattering_8txt.html#a6e2308ba2b055a80cdd4c2a0469b7d60">flux</a></div><div class="ttdeci">namespace ::The main physical parameter is f k f c N_fourier is the number of(Fourier) terms to be used in evaluation of the series in equations( @R[gamma]@) and( @R[exact_scattered]@). The remaining parameters determine how the Sommerfeld radiation condition is applied. \dontinclude scattering.cc \skipline start_of_namespace \until std The function c get_exact_u returns the exact solution for the scattering problem We will use this function for the validation of our results dontinclude scattering cc skipline Exact solution for scattered until Next we provide a function that computes the prescribed flux(normal derivative) of the solution</div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a552eed3548a269715a95161ad3c4b96a"><div class="ttname"><a href="namespaceGlobalParameters.html#a552eed3548a269715a95161ad3c4b96a">GlobalParameters::ABC_order</a></div><div class="ttdeci">unsigned ABC_order</div><div class="ttdoc">Flag to choose wich order to use.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00076">scattering.cc:76</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a8c61657a1d09ce49a5871ca3febe5658"><div class="ttname"><a href="classScatteringProblem.html#a8c61657a1d09ce49a5871ca3febe5658">ScatteringProblem::Bulk_mesh_pt</a></div><div class="ttdeci">RefineableTwoDAnnularMesh&lt; ELEMENT &gt; * Bulk_mesh_pt</div><div class="ttdoc">Pointer to the &quot;bulk&quot; mesh.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00282">scattering.cc:282</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_aca1b756a307f9c1d8a70c7b7e68a296b"><div class="ttname"><a href="classScatteringProblem.html#aca1b756a307f9c1d8a70c7b7e68a296b">ScatteringProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the mesh of prescribed flux elements.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00413">scattering.cc:413</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html"><div class="ttname"><a href="classScatteringProblem.html">ScatteringProblem</a></div><div class="ttdoc">Problem class to compute scattering of planar wave from unit disk.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00222">scattering.cc:222</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_aaef8a78e317333ddadd0be6a500c1134"><div class="ttname"><a href="classScatteringProblem.html#aaef8a78e317333ddadd0be6a500c1134">ScatteringProblem::delete_face_elements</a></div><div class="ttdeci">void delete_face_elements(Mesh *const &amp;boundary_mesh_pt)</div><div class="ttdoc">Delete boundary face elements and wipe the surface mesh.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00688">scattering.cc:688</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_af83ab14c4f4750ea17c21466f6c6364f"><div class="ttname"><a href="classScatteringProblem.html#af83ab14c4f4750ea17c21466f6c6364f">ScatteringProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution. DocInfo object stores flags/labels for where the output gets written to.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00516">scattering.cc:516</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ae2320da6053f5527b2af5ebb362a8a07"><div class="ttname"><a href="namespaceGlobalParameters.html#ae2320da6053f5527b2af5ebb362a8a07">GlobalParameters::get_exact_u</a></div><div class="ttdeci">void get_exact_u(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;u)</div><div class="ttdoc">Exact solution for scattered field (vector returns real and impaginary parts).</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00086">scattering.cc:86</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_aae73cb63b27d51a87845c3392cd944eb"><div class="ttname"><a href="namespaceGlobalParameters.html#aae73cb63b27d51a87845c3392cd944eb">GlobalParameters::K_squared</a></div><div class="ttdeci">double K_squared</div><div class="ttdoc">Square of the wavenumber.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00064">scattering.cc:64</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a0a9838027d0286f22706fe6945bbac0a"><div class="ttname"><a href="classScatteringProblem.html#a0a9838027d0286f22706fe6945bbac0a">ScatteringProblem::~ScatteringProblem</a></div><div class="ttdeci">~ScatteringProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00231">scattering.cc:231</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a7642bd7303d39de0d680340586b7df60"><div class="ttname"><a href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">GlobalParameters::I</a></div><div class="ttdeci">std::complex&lt; double &gt; I(0.0, 1.0)</div><div class="ttdoc">Imaginary unit.</div></div>
<div class="ttc" id="aclassScatteringProblem_html_ad096c311ee474d23514656d2ba76a4b8"><div class="ttname"><a href="classScatteringProblem.html#ad096c311ee474d23514656d2ba76a4b8">ScatteringProblem::actions_before_newton_convergence_check</a></div><div class="ttdeci">void actions_before_newton_convergence_check()</div><div class="ttdoc">Recompute gamma integral before checking Newton residuals.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00244">scattering.cc:244</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a91ce14b928ec6edbb9d85515a310b1fb"><div class="ttname"><a href="classScatteringProblem.html#a91ce14b928ec6edbb9d85515a310b1fb">ScatteringProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00238">scattering.cc:238</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a61b086072a6b8fd38af1a85f1dd1674a"><div class="ttname"><a href="namespaceGlobalParameters.html#a61b086072a6b8fd38af1a85f1dd1674a">GlobalParameters::Outer_radius</a></div><div class="ttdeci">double Outer_radius</div><div class="ttdoc">Radius of outer boundary (must be a circle!)</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00079">scattering.cc:79</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a76bd8299ea7ed559681b294acfb2aad4"><div class="ttname"><a href="classScatteringProblem.html#a76bd8299ea7ed559681b294acfb2aad4">ScatteringProblem::setup_outer_boundary</a></div><div class="ttdeci">void setup_outer_boundary()</div><div class="ttdoc">Set up boundary condition elements on outer boundary.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00451">scattering.cc:451</a></div></div>
<div class="ttc" id="ascattering_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="scattering_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00709">scattering.cc:709</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_aac3ed9baf77bc66421a7d980ca359bf9"><div class="ttname"><a href="classScatteringProblem.html#aac3ed9baf77bc66421a7d980ca359bf9">ScatteringProblem::Bulk_mesh_pt</a></div><div class="ttdeci">TwoDAnnularMesh&lt; ELEMENT &gt; * Bulk_mesh_pt</div><div class="ttdoc">Pointer to the &quot;bulk&quot; mesh.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00287">scattering.cc:287</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_af06ff518ad3250f914c0c659af3001c8"><div class="ttname"><a href="classScatteringProblem.html#af06ff518ad3250f914c0c659af3001c8">ScatteringProblem::create_flux_elements</a></div><div class="ttdeci">void create_flux_elements(const unsigned &amp;b, Mesh *const &amp;bulk_mesh_pt, Mesh *const &amp;helmholtz_inner_boundary_mesh_pt)</div><div class="ttdoc">Create Helmholtz flux elements on boundary b of the Mesh pointed to by bulk_mesh_pt and add them to t...</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00611">scattering.cc:611</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a13d8f85e74666c260de7364917359ed5"><div class="ttname"><a href="classScatteringProblem.html#a13d8f85e74666c260de7364917359ed5">ScatteringProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the mesh of prescribed flux elements.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00429">scattering.cc:429</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a6e2bba1769e86a5d3db88e2c7062bc63"><div class="ttname"><a href="namespaceGlobalParameters.html#a6e2bba1769e86a5d3db88e2c7062bc63">GlobalParameters::DtN_BC</a></div><div class="ttdeci">bool DtN_BC</div><div class="ttdoc">Flag to choose the Dirichlet to Neumann BC or ABC BC.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00072">scattering.cc:72</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_abf1e7b97518c94e12802205dec08b15e"><div class="ttname"><a href="classScatteringProblem.html#abf1e7b97518c94e12802205dec08b15e">ScatteringProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the problem specs after solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00241">scattering.cc:241</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_ae75307dde909513a0f11057c96cdd622"><div class="ttname"><a href="classScatteringProblem.html#ae75307dde909513a0f11057c96cdd622">ScatteringProblem::set_prescribed_incoming_flux_pt</a></div><div class="ttdeci">void set_prescribed_incoming_flux_pt()</div><div class="ttdoc">Set pointer to prescribed-flux function for all elements in the surface mesh on the surface of the un...</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00493">scattering.cc:493</a></div></div>
<div class="ttc" id="aclassScatteringProblem_html_a9692c8592b57a4363e557e5b012c744b"><div class="ttname"><a href="classScatteringProblem.html#a9692c8592b57a4363e557e5b012c744b">ScatteringProblem::Helmholtz_outer_boundary_mesh_pt</a></div><div class="ttdeci">HelmholtzDtNMesh&lt; ELEMENT &gt; * Helmholtz_outer_boundary_mesh_pt</div><div class="ttdoc">Pointer to mesh containing the DtN (or ABC) boundary condition elements.</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8cc_source.html#l00293">scattering.cc:293</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 9 2021 00:33:51
        </div>
      </div>
    </footer>
</body>
</html>

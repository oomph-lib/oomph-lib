<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: scattering.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">scattering.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="scattering_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: The Helmholtz equation -- scattering problems</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">In this document we discuss the finite-element-based solution of the </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">Helmholtz equation, an elliptic PDE that describes time-harmonic wave propagation </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">problems. We start by  reviewing the relevant theory and then </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">present the solution of a simple model problem -- the scattering of a</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">planar wave from a circular cylinder.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">&lt;TABLE BORDER=1, WIDTH=500px&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">&lt;B&gt;Acknowledgement:&lt;/B&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">This tutorial and the associated driver codes were developed jointly</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">with Tarak Kharrat (EnstaParisTech, Paris).</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">\section theory Theory: The Helmholtz equation for time-harmonic scattering problems</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">The Helmholtz equation governs time-harmonic solutions of problems</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">governed by the linear wave equation</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">\nabla^2 U(x,y,t) = \frac{1}{c^2} \frac{\partial^2 U(x,y,t)}{\partial t^2},</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">where \f$ c \f$ is the wavespeed. Assuming that \f$ U(x,y,t) \f$</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">is time-harmonic, with frequency \f$ \omega \f$, we write the real</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">function \f$ U(x,y,t) \f$ as</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">U(x,y,t) =Re (u(x,y) \ e^{-i \omega t})</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">where \f$ u(x,y) \f$ is complex-valued. This transforms </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">(1) into the Helmholtz equation</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">\nabla^2 u(x,y) + k^2 u(x,y) = 0</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">k = \frac{\omega}{c}</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">is the wave number. Like other elliptic PDEs the Helmholtz equation</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">admits Dirichlet, Neumann (flux) and Robin boundary conditions.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">If the equation is solved in an infinite domain (e.g. in scattering</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">problems) the solution must satisfy the so-called</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">&lt;a href=&quot;http://en.wikipedia.org/wiki/Sommerfeld_radiation_condition&quot;&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">Sommerfeld radiation condition&lt;/a&gt; which in 2D has the form</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\lim_{r\to \infty} \sqrt{r} \left(\frac{\partial u}{\partial r} - iku</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\right) =0. </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">Mathematically, this conditions is required to ensure the uniqueness</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">of the solution (and hence the well-posedness of the problem).</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">In a physical context, such as a scattering problem, the condition </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">ensures that scattering of an incoming wave only produces outgoing not </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">incoming waves from infinity.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">\section discr Discretisation by finite elements</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">The discretisation of the Helmholtz equation itself only requires a trivial</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">modification of \c oomph-lib&#39;s Poisson elements -- we simply add</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">the term  \f$ k^2 u \f$ to the residual. Since most practical applications</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">of the Helmholtz equation involve complex-valued solutions, we provide </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">separate storage for the real and imaginary parts of the solution -- </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">each \c Node therefore stores two unknowns values. By default,</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">the real and imaginary parts are stored as values 0 and 1,</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">respectively; see the section \ref numbering for details.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">The application of Dirichlet and Neumann boundary conditions is </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">straightforward and follows the pattern employed for the solution</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">of the Poisson equation: </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">- Dirichlet conditions are imposed by pinning the relevant nodal</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">  values and setting them to the appropriate prescribed values. </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">- Neumann (flux) boundary conditions are imposed via </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">  \c FaceElements (here the \c HelmholtzFluxElements). </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">   &lt;a href=&quot;../../../poisson/two_d_poisson_flux_bc/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">  As usual&lt;/a&gt; we attach these to the faces of the &quot;bulk&quot; elements</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">  that are subject to the Neumann boundary conditions.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">The imposition of the Sommerfeld radiation condition for problems in</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">infinite domains is slightly more complicated. In the following </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">discussion we will restrict ourselves to two dimensions and assume </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">that the infinite domain is truncated at a circular artificial</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">boundary \f$ \Gamma \f$ of radius \f$ R. \f$ [This assumption is also </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">made in the implementation of \c oomph-lib&#39;s \c FaceElements</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">that allow the (approximate) imposition of the Sommerfeld radiation</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">condition. The methodology can easily be modified to deal with other </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">geometries but this has not been done yet -- any volunteers?]</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">All methods exploit the fact that the relevant solution of the </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">Helmholtz equation can be written in polar coordinates as</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">u(r,\varphi) = \sum_{n=-\infty}^{+\infty} A_n \ H_n^{(1)}(kr)  </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">\ e^{i n \varphi}, \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">where the \f$A_n \f$ are suitable coefficients and</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">\f$ H_n^{(1)}(r) \f$ is the \f$ n \f$-th-order </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">Hankel function of the first kind.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">\subsection ABCs Approximate/absorbing boundary conditions (ABCs)</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">It is possible to derive approximate versions of the Sommerfeld</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">radiation condition in which the normal derivative of the</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">solution on the artificial boundary is related to its</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">value and possibly its tangential derivatives. Such boundary</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">conditions (sometimes referred to as approximate or absorbing </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">boundary conditions -- ABCs) are typically derived from asymptotic expansions</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">of the solution at large distances from the origin and become</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">more accurate the larger the radius \f$ R \f$ of the artificial boundary</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">\f$ \Gamma \f$ is. Higher accuracy can therefore only be achieved </span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">by increasing the size of the computational domain, with an </span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">associated increase in computational cost.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> \c oomph-lib provides an implementation of the following three </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">boundary conditions (all taken from</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">J. J. Shirron &amp; I. Babuska&#39;s paper &quot;A comparison of approximate boundary </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">conditions and infinite element methods for exterior Helmholtz</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">problems&quot;, Computer Methods in Applied Mechanics and Engineering</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">&lt;b&gt;164&lt;/b&gt; 121-139 (1998), in which the authors</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">compare the accuracy of these and many other approximate boundary</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">conditions).</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">- &lt;b&gt;Feng&#39;s first order ABC:&lt;/b&gt;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> \frac {\partial u}{\partial n}-\bigg( ik - \frac{1}{2R}\bigg) u</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> =0   \mbox{\ \ \  \ \  on\ }\Gamma  </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">(This is identical to the first-order Bayliss and Turkel boundary condition).</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">- &lt;b&gt;Feng&#39;s second order ABC:&lt;/b&gt;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> \frac{\partial u}{\partial n}-\bigg[ik-\frac</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> \varphi^{2}}\bigg)\bigg]u</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">=0  \mbox{\ \ \  \ \  on\ }\Gamma  </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">- &lt;b&gt;Feng&#39;s third order ABC:&lt;/b&gt;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> \frac {\partial u}{\partial n}-\bigg[ik-\frac</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> {1}{2R}+\frac{1}{8k^{2}R^{2}}\bigg(ik+ \frac {1}{R}\bigg)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> \bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg]u</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">=0   \mbox{\ \ \  \ \  on\ }\Gamma  </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">All three boundary conditions are implemented in the class</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">\c HelmholtzAbsorbingBCElement. The order of the approximation </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">can be set via the member function</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">\c HelmholtzAbsorbingBCElement::abc_order(). All three boundary</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">conditions are local (relating the function to its normal derivative)</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">and do therefore not change the sparsity of the resulting finite</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">element equations.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">\subsection DtN The Dirichlet-to-Neumann mapping (DtN)</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">Using (4), it is easy to show (see, e.g., </span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">J. Jin &quot;The Finite Element Method in Electromagnetics (second</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">edition)&quot;, Wiley (2002) p. 501ff -- but note that Jin assumes that</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">the potential varies like \f$ \exp(i\omega t)\f$ rather than</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">\f$ \exp(-i\omega t)\f$ as assumed here) that the </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">normal (radial) derivative, \f$ \partial u / \partial n =   </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">\partial u / \partial r, \f$ on the artificial boundary </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">\f$ \Gamma \f$ is given by</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> \frac {\partial u}{\partial r}\bigg|_{r=R} =</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> \frac {\partial u}{\partial n}\bigg|_{r=R} =</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> \gamma (u) \ \ \ \ \ \ \ (5)   </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">\gamma (u) = \frac {k}{2 \pi} \sum_{n=-\infty}^{+\infty} </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">\frac {H_n^{(1)^{&#39;}}(kR)}{H_n^{(1)}(kR)} \quad </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">\int_0^{2\pi}u(R,\varphi^{&#39;}) \ e^{in(\varphi-\varphi^{&#39;})}</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">\,d\varphi^{&#39;}.  </span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> \ \ \ \ \ \ \ (6)   </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">Equation (5) again provides a condition on the</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">normal derivative of the solution along the artificial boundary </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">and is implemented in the \c HelmholtzDtNBoundaryElement class.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">Since \f$ \gamma \f$ depends on the solution everywhere </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">along the artificial boundary (see (6)), the application of the </span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">boundary condition (5) introduces a non-local coupling</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">between all the degrees of freedom located on that boundary.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">This is handled by classifying the unknowns that affect \f$ \gamma \f$ </span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">but are not associated with the element&#39;s own nodes as external \c Data. </span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">To facilitate the setup of the interaction between the </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">\c HelmholtzDtNBoundaryElements, \c oomph-lib provides the</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">class \c HelmholtzDtNMesh which provides storage for </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">(the pointers to) the  \c HelmholtzDtNBoundaryElements </span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">that discretise the artificial boundary. The </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">member function \c HelmholtzDtNMesh::setup_gamma() pre-computes the </span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">\f$ \gamma \f$ values required for the imposition of equation (5).</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">The radius \f$ R \f$ of the artificial boundary and the (finite) number of</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">(Fourier) terms used in the sum in (6) are specified</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">as arguments to the constructor of the \c HelmholtzDtNMesh.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">&lt;b&gt;NOTE:&lt;/b&gt; Since \f$ \gamma \f$  depends on the solution, </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">it must be recomputed whenever the unknowns are updated during</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">the Newton iteration. This is best done by adding a call to</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">\c HelmholtzDtNMesh::setup_gamma() to </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">\c Problem::actions_before_newton_convergence_check().</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">[If Helmholtz&#39;s equation is solved in isolation (or within</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">a coupled, but linear problem), Newton&#39;s method will converge </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">in one iteration. In such cases the unnecessary recomputation of </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">\f$ \gamma \f$ after the one-and-only Newton iteration can be </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">suppressed by setting \c Problem::Problem_is_nonlinear to </span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">\c false.]</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">\section scattering A specific example: Scattering of an acoustic wave from a sound-hard obstacle</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">We will now demonstrate the methodology for a specific example:</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">the scattering of sound waves in an acoustic medium </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">of density \f$ \rho  \f$ and bulk modulus \f$ B \f$.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">Assuming that an incoming sound wave impacts a rigid, impermeable</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">obstacle as shown in this sketch,</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">\image html scattering.gif &quot;Scattering of an incoming wave from a sound-hard obstacle -- the scatterer. &quot; </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">\image latex scattering.eps &quot;Scattering of an incoming wave from a sound-hard obstacle -- the scatterer. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">we wish to find the wave field that is scattered from the body.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">For this purpose we denote the time-dependent displacement</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">of the fluid particle in the acoustic medium by </span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">\f$ {\bf u}^*(x^*,y^*,t^*) \f$ and introduce a displacement</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">potential \f$ \Phi^*(x^*,y^*,t^*) \f$ such that</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">{\bf u}^* = \nabla^* \Phi^*.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">(As usual we employ asterisks to distinguish dimensional quantities</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">from their non-dimensional equivalents, to be introduced below.) </span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">It is easy to show that \f$ \Phi^* \f$ satisfies the linear wave</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">equation (1) with wave speed \f$ c = \sqrt{B/\rho}\f$.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">Since the surface \f$ \partial D_{bound}\f$ of the scatterer is</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">impenetrable, the normal displacement of the fluid has to vanish</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">on  \f$ \partial D_{bound}\f$  and the boundary condition for the </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">displacement potential becomes</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">\left. \frac{\partial \Phi^*}{\partial n^*}\right|_{\partial D_{bound}} = 0.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \  (7)</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">We non-dimensionalise all lengths and displacements on some problem-dependent</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">lengthscale \f$ {\cal L}\f$ (e.g. the radius of the scatterer),</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">non-dimensionalise the potential as \f$ \Phi^* =  a^2 \Phi \f$ and</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">scale time on the period of the oscillation,</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">\f$ t^* = \frac{2\pi}{\omega} t.\f$ The governing equation</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">then becomes</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">\nabla^2 \Phi + k^2 \Phi = 0, \ \ \ \ \ \ \ \ \ \ \ (8)</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">where the square of the wavenumber  is given by</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">k^2  = \frac{\rho (a\omega)^2}{B}.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">Assuming that the incoming wave (already satisfying (8))</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">is described by a (known) non-dimensional displacement potential of the form</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">\Phi_{inc}(x,y,t) = \phi_{inc}(x,y) \  e^{-i 2\pi t},</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">we write the total potential as</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">\Phi(x,y,t) = \bigg( \phi_{inc}(x,y) + u(x,y) \bigg) \ e^{-i 2\pi t},</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">where \f$ u(x,y) \  e^{-i 2\pi t} \f$ represents the displacement potential </span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">associated with the scattered field which must satisfy (2). </span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">The boundary condition (7) then becomes a Neumann </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">(flux) boundary condition for the scattered field,</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">\left. \frac{\partial u}{\partial n}\right|_{\partial D_{bound}} =</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">- \left. \frac{\partial \phi_{inc}}{\partial n}\right|_{\partial D_{bound}}.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \  (9)</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">For the special case of the incoming wave being a planar wave,</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">propagating along the x-axis, the incoming field can be written </span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">in polar coordinates as</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">  \phi_{inc}(r, \varphi)  </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">= \sum_{n=-\infty}^{+\infty} i^n  J_n(kr) e^{in\varphi}, </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">where \f$ J_n \f$ is the Bessel function of the first kind</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">of order \f$ n \f$. The exact solution for the scattering</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">of such a wave from a circular disk is given by the series</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">  u_{ex}(r,\varphi) </span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">= -\sum_{n=-\infty}^{+\infty} i^n \frac</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">{H^{&#39;}_{n}(k)}{J^{&#39;}_{n}(k)}  H_n(kr) e^{in\varphi},</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \  (10)</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">where we have chosen the disk&#39;s radius, \f$ a \f$,  as the</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">lengthscale by setting \f$ {\cal L} = a\f$. In the above expression,</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">\f$ H_n \f$ denotes the Hankel function of the first kind</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">of order \f$ n \f$ and the prime denotes differentiation with respect </span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">to the function&#39;s argument.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">A quantity that is of particular interest in wave propagation</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">problems is the time-average of the power radiated by the scatterer,</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">\overline{\cal P}^* = </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">\frac{\omega}{2\pi} \int_{0}^{2\pi/\omega} {\cal P}^*(t) \ dt^*.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">In the context of an acoustic wave, the total instantaneous power,</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">\f$ {\cal P}^*(t), \f$ radiated over a closed boundary is</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">{\cal P}^*(t) = \oint \frac{\partial {\bf u^*} }{\partial t^*} </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">\cdot p^* {\bf n} \ dS^*,</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">where the pressure is related to the displacement potential via</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">p^* = \rho \omega^2 \Phi^*.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">The non-dimensional time-averaged radiated power can be expressed in </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">terms of the complex potential \f$ \phi \f$ as</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">\overline{\cal P} = \frac{\overline{\cal P}^*}{\rho \omega^3 {\cal L}^4} =</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">\frac{1}{2}</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">\oint\bigg[Im\bigg(\frac{\partial \phi}{\partial n}\bigg) \ Re(\phi) -</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">           Re\bigg(\frac{\partial \phi}{\partial n}\bigg) \ Im(\phi)</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">           \bigg]</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"> \ dS.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">The figure below shows an animation of the displacement potential</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">\f$ Re(u(x,y,t)) \f$ for scattering from a circular disk </span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">for a non-dimensional wavenumber of \f$ k=1 \f$ over one </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">period of the oscillation. The simulation was performed in an </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">annular computational domain, bounded by the outer surface the </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">(unit) disk and an artificial outer boundary of non-dimensional </span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">radius \f$ R=1.5. \f$ The Sommerfeld radiation</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">condition was imposed using the DtN mapping and the simulation</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">was performed with spatial adaptivity (note the non-uniform </span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">refinement).</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">The &quot;carpet plot&quot; compares the exact (green) and computed (red)</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">solutions for the displacement potential. The colours in the contour </span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">plot at the bottom of the figure provide an alternative</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">visualisation of the magnitude of the scattered field. </span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">\image html scattering_animation.gif &quot;The displacement potential associated with the scattered wave, animated over one period of the oscillation. &quot; </span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">\image latex scattering_animation.eps &quot;The displacement potential associated with the scattered wave, animated over one period of the oscillation. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">\section num_soln The numerical solution</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">\subsection namespace The global namespace</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">As usual, we define the problem parameters in a global namespace.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">The main physical parameter is the (square of the) wave number,</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">\f$ k^2 \f$. \c N_fourier is the number of</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">(Fourier) terms  to be used in evaluation of the </span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">series in equations (6) and (10).</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">The remaining parameters determine how the Sommerfeld radiation</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">condition is applied. </span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">\until std::complex&lt;double&gt; I(0.0,1.0);  </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">The function \c get_exact_u</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">returns the exact solution for the scattering problem.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">We will use this function for the validation of our results.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">\skipline  Exact solution for scattered</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">\until  }// end of get_exact_u</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">Next we provide a function that computes the prescribed flux </span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">(normal derivative) of the solution, \f$ \partial u/\partial n =</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">-\partial \phi_{inc}/\partial n \f$, evaluated on the surface of the</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">unit disk.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">\skipline Flux (normal derivative)</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">\until // end of namespace</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">\subsection main The driver code</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">The driver code is very straightforward. We parse the command line</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">to determine which boundary condition to use and set the </span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">flags in the global namespace accordingly.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">Next we build the problem, either with or without enabling spatial</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">adaptivity and define the output directory.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">\until RESLT</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">Finally, we solve the problem and document the results.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">\until } //end of main</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">\subsection class The problem class</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">The problem class is very similar to that employed for </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">the &lt;a href=&quot;../../../poisson/two_d_poisson_flux_bc_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">adaptive solution of the 2D Poisson equation with flux boundary</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">conditions.&lt;/a&gt; The only difference is that we provide </span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">two separate meshes of \c FaceElements: one for the </span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">inner boundary where the \c HelmholtzFluxElements apply the</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">Neumann condition (9), and one for </span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">the outer boundary where we apply the (approximate) Sommerfeld </span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">radiation condition. As discussed in section \ref DtN , we use the function</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">\c actions_before_newton_convergence_check() to recompute the</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">\f$ \gamma \f$ integral whenever the unknowns are updated</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">during the Newton iteration.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">\until }; // end of problem class</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">\subsection constr The problem constructor</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">We start by building the bulk mesh, using the refineable or</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">non-refineable version of the \c TwoDAnnularMesh, depending on the</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">macro \c ADAPTIVE. (The error tolerances for the adaptive version</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">are chosen such that the mesh is refined non-uniformly -- with the</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">default tolerances, \c oomph-lib&#39;s automatic mesh adaptation</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">procedure refine the mesh uniformly.)</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">\skipline start_of_constructo</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">\until #endif</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">Next we create the two (empty) meshes for the \c FaceElements,</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">\skipline  // Pointer to mesh containing the Helmholtz outer boundary condition</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">\until  new Mesh; </span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">and populate them using the functions \c create_flux_elements(...) and \c</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">create_outer_bc_elements(...).</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">\skipline // Create prescribed </span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">\until outer_boundary_mesh_pt);</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">We add the various (sub-)meshes to the problem and build the global</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">mesh</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">\skipline // Add the several  sub</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">\until build_global_mesh();</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">Finally, we complete the build of the various elements by</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">by passing pointers to the relevant quantities to them,</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">and assign the equation numbers. </span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">\skipline  // Complete the build</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">\until } // end of constructor</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">The problem is now ready to be solved.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">\subsection before_adapt Actions before adapt</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">The mesh adaptation is driven by the error estimates for the bulk</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">elements. The various \c FaceElements must therefore be removed from</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">the global mesh before the adaptation takes place. We do this by </span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">calling the function \c delete_flux_elements(...) for the two</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">face meshes, before rebuilding the Problem&#39;s global mesh.</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">\skipline start_of_actions_before_adapt</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">\until }// end of actions_before_adapt</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">\subsection after_adapt Actions after adapt</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">After the (bulk-)mesh has been adapted, the flux elements must </span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">be re-attached. This is done by calling the functions</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">\c create_flux_elements(...) and \c create_outer_bc_elements,</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">followed by rebuilding the Problem&#39;s global mesh. Finally, </span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">we complete the build of the \c FaceElements by calling</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">the functions \c setup_outer_boundary() and</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">\c set_prescribed_incoming_flux_pt().</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">\skipline start_of_actions_after_adapt</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">\until }// end of actions_after_adapt</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">\subsection delete Delete flux elements</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">The helper function \c delete_face_elements() is used</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">to delete all \c FaceElements in a given surface mesh</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">before the mesh adaptation.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">\skipline start_of_delete</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">\until } // end of delete_outer_face_elements</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">\subsection create_flux Creating the face elements</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">The functions \c create_flux_elements(...) and </span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">\c create_outer_bc_elements(...) create the \c FaceElements</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">required to apply the boundary conditions on the inner and</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">outer boundaries of the annular computational domain.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">They both loop over the bulk elements that are adjacent to the appropriate</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">mesh boundary and attach the required \c FaceElements to their</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">faces. The newly created \c FaceElements are then added</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">to the appropriate mesh.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">\skipline start_of_create_outer</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">\until } // end of create_outer</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">(We omit the listing of the function \c create_flux_elements(...) because</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">it is very similar.  Feel free to inspect in the </span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/helmholtz/scattering/scattering.cc&quot;&gt;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">source code.&lt;/A&gt;)</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">\subsection doc Post-processing</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">The post-processing function \c doc_solution(...) computes and outputs </span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">the total radiated power, and plots the computed and exact solutions</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">(real and complex parts). </span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">\dontinclude scattering.cc</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">\skipline start_of_doc</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">\until Norm of solution</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">Finally, we create the data required to produce an animation of </span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">the actual (real) potential at 40 instants during a period of the</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">oscillation.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">\until } // end of doc</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">\section comm_ex Comments and Exercises</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">\subsection numbering The enumeration of the unknowns</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">As discussed in the introduction, most practically relevant</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">solutions of the Helmholtz equation are complex valued. Since \c oomph-lib&#39;s </span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">solvers only deal with real (double precision) unknowns, the equations</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">are separated into their real and imaginary parts.</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">In the implementation of the Helmholtz elements, we store the real</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">and imaginary parts of the solution as two separate values at each </span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">node. By default, the real and imaginary parts are accessible via </span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">\c Node::value(0) and \c Node::value(1). However, to facilitate the use of the elements</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">in multi-physics problems we avoid accessing the unknowns</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">directly in this manner but provide the virtual function</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">std::complex&lt;unsigned&gt; HelmholtzEquations&lt;DIM&gt;::u_index_helmholtz()</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">which returns a complex number made of the two unsigneds that indicate</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">which nodal value represents the real and imaginary parts of the solution.</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">This function may be overloaded in combined multi-physics elements</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">in which a Helmholtz element is combined (by multiple inheritance) </span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">with another element, using the strategy described in </span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">&lt;a href=&quot;../../../multi_physics/b_convection/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">the Boussinesq convection tutorial&lt;/a&gt;.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">\subsection ex Exercises</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">\subsubsection lin Exploiting linearity</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">Confirm that the (costly) re-computation of the </span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">\f$ \gamma \f$ integral in </span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">\c actions_before_newton_convergence_check() after the</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">first (and only) linear solve in the Newton iteration can be </span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">avoided by declaring the problem to be linear.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">\subsubsection acc The accuracy of the boundary condition elements</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">Explore the accuracy (and computational cost) of the various</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">\c FaceElements that apply the Sommmerfeld radiation condition.</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">In particular, confirm that the accuracy of the DtN boundary </span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">condition is (nearly) independent of the radius of the artificial outer</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">boundary, whereas the accuracy of the ABC boundary condition can</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">only be improved by increasing the size of the computational domain.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">  &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../../demo_drivers/helmholtz/scattering&quot;&gt;</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">  demo_drivers/helmholtz/scattering/</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">  &lt;/A&gt;</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">- The driver code is: </span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">  &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../../demo_drivers/helmholtz/scattering/scattering.cc&quot;&gt;</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">  demo_drivers/helmholtz/scattering/scattering.cc</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">  &lt;/A&gt;</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="ascattering_8txt_html_a6c9da97221e3126b6342045fa1715a85"><div class="ttname"><a href="scattering_8txt.html#a6c9da97221e3126b6342045fa1715a85">varphi</a></div><div class="ttdeci">see the section ref numbering for details The application of Dirichlet and Neumann boundary conditions is straightforward and follows the pattern employed for the solution of the Poisson varphi</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00107">scattering.txt:107</a></div></div>
<div class="ttc" id="ascattering_8txt_html_afe70452dff2c3cb8032050f5e42e78dd"><div class="ttname"><a href="scattering_8txt.html#afe70452dff2c3cb8032050f5e42e78dd">t</a></div><div class="ttdeci">mainpage Example an elliptic PDE that describes time harmonic wave propagation problems We start by reviewing the relevant theory and then present the solution of a simple model problem the scattering of a planar wave from a circular cylinder&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Paris&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section theory t</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00033">scattering.txt:33</a></div></div>
<div class="ttc" id="ascattering_8txt_html_adf96798a41c029db39789a3f53d931b8"><div class="ttname"><a href="scattering_8txt.html#adf96798a41c029db39789a3f53d931b8">create_flux_elements</a></div><div class="ttdeci">we complete the build of the various elements by by passing pointers to the relevant quantities to and assign the equation numbers dontinclude scattering cc skipline until The problem is now ready to be solved&lt; HR &gt;&lt; HR &gt; subsection before_adapt Actions before adapt The mesh adaptation is driven by the error estimates for the bulk elements The various c FaceElements must therefore be removed from the global mesh before the adaptation takes place We do this by calling the function c before rebuilding the Problem s global mesh dontinclude scattering cc skipline start_of_actions_before_adapt until&lt; HR &gt;&lt; HR &gt; subsection after_adapt Actions after adapt After the flux elements must be re attached This is done by calling the functions c create_flux_elements(...) and \c create_outer_bc_elements</div></div>
<div class="ttc" id="ascattering_8txt_html_a8c816198c8bd9c7829d875346c691800"><div class="ttname"><a href="scattering_8txt.html#a8c816198c8bd9c7829d875346c691800">u</a></div><div class="ttdeci">bigg[ik-\frac {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg u)</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00150">scattering.txt:150</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a649ec8dc57f56a2947bb323f273049ca"><div class="ttname"><a href="scattering_8txt.html#a649ec8dc57f56a2947bb323f273049ca">power</a></div><div class="ttdeci">bigg[ik-\frac {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg] d Newton s method will converge in one iteration In such cases the unnecessary recomputation of f gamma f after the one and only Newton iteration can be suppressed by setting c Problem::Problem_is_nonlinear to c false&lt; HR &gt;&lt; HR &gt; section scattering A specific impermeable obstacle as shown in this I w textwidth scattering Scattering of an incoming wave from a sound hard obstacle the scatterer we wish to find the wave field that is scattered from the body For this purpose we denote the time dependent displacement of the fluid particle in the acoustic medium by the normal displacement of the fluid has to vanish on f partial non dimensionalise the potential as f Phi f t f power[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{bound}}=- \left. \frac{\partial \phi_{inc}}{\partial n}\right|_{\partial D_{bound}}.\ \ \ \ \ \ \ \ \ \ \ \ \ @E[non_pen_bc_for_scattered]@\f] For the special case of the incoming wave being a planar propagating along the x the incoming field can be written in polar coordinates as f[\phi_{inc}(r, \varphi)=\sum_{n=-\infty}^{+\infty} i^n J_n(kr) e^{in\varphi}, \f] where f J_n f is the Bessel function of the first kind of order f n f The exact solution for the scattering of such a wave from a circular disk is given by the series f[u_{ex}(r,\varphi)=-\sum_{n=-\infty}^{+\infty} i^n \frac{H^{'}_{n}(k)}{J^{'}_{n}(k)} H_n(kr) e^{in\varphi},\ \ \ \ \ \ \ \ \ \ \ \ \ @E[exact_scattered]@\f] where we have chosen the disk s f a as the lengthscale by setting f H_n f denotes the Hankel function of the first kind of order f n f and the prime denotes differentiation with respect to the function s argument A quantity that is of particular interest in wave propagation problems is the time average of the power radiated by the f[\overline{\cal P}^ *=\frac{\omega}{2\pi} \int_{0}^{2\pi/\omega} {\cal P}^ *(t) \ dt^ *.\f] In the context of an acoustic the total instantaneous</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00323">scattering.txt:323</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a8d895bb93cd829890aa4c1a2d5682792"><div class="ttname"><a href="scattering_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00005">scattering.txt:5</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a3f868e5db42f5290d08c41246011dcde"><div class="ttname"><a href="scattering_8txt.html#a3f868e5db42f5290d08c41246011dcde">H_n</a></div><div class="ttdeci">see the section ref numbering for details The application of Dirichlet and Neumann boundary conditions is straightforward and follows the pattern employed for the solution of the Poisson E[polar_soln] f where the f $A_n f are suitable coefficients and f H_n</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00111">scattering.txt:111</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a6e2308ba2b055a80cdd4c2a0469b7d60"><div class="ttname"><a href="scattering_8txt.html#a6e2308ba2b055a80cdd4c2a0469b7d60">flux</a></div><div class="ttdeci">namespace ::The main physical parameter is f k f c N_fourier is the number of(Fourier) terms to be used in evaluation of the series in equations( @R[gamma]@) and( @R[exact_scattered]@). The remaining parameters determine how the Sommerfeld radiation condition is applied. \dontinclude scattering.cc \skipline start_of_namespace \until std The function c get_exact_u returns the exact solution for the scattering problem We will use this function for the validation of our results dontinclude scattering cc skipline Exact solution for scattered until Next we provide a function that computes the prescribed flux(normal derivative) of the solution</div></div>
<div class="ttc" id="ascattering_8txt_html_a7d4c3450d2e4709cd1f29e52b7e160f6"><div class="ttname"><a href="scattering_8txt.html#a7d4c3450d2e4709cd1f29e52b7e160f6">delete_flux_elements</a></div><div class="ttdeci">we complete the build of the various elements by by passing pointers to the relevant quantities to and assign the equation numbers dontinclude scattering cc skipline until The problem is now ready to be solved&lt; HR &gt;&lt; HR &gt; subsection before_adapt Actions before adapt The mesh adaptation is driven by the error estimates for the bulk elements The various c FaceElements must therefore be removed from the global mesh before the adaptation takes place We do this by calling the function c delete_flux_elements(...) for the two face meshes</div></div>
<div class="ttc" id="ascattering_8txt_html_abb43e24ffbad96376034cc06ac800594"><div class="ttname"><a href="scattering_8txt.html#abb43e24ffbad96376034cc06ac800594">Theory</a></div><div class="ttdeci">mainpage Example an elliptic PDE that describes time harmonic wave propagation problems We start by reviewing the relevant theory and then present the solution of a simple model problem the scattering of a planar wave from a circular cylinder&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Paris&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section theory Theory</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00033">scattering.txt:33</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a62ed9ad377f502b275eb867fe684f131"><div class="ttname"><a href="scattering_8txt.html#a62ed9ad377f502b275eb867fe684f131">them</a></div><div class="ttdeci">we complete the build of the various elements by by passing pointers to the relevant quantities to them</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00486">scattering.txt:486</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a92386f0d3f3d25bcff4deb0ac893ebaa"><div class="ttname"><a href="scattering_8txt.html#a92386f0d3f3d25bcff4deb0ac893ebaa">Finally</a></div><div class="ttdeci">namespace ::The main physical parameter is f k f c N_fourier is the number of(Fourier) terms to be used in evaluation of the series in equations( @R[gamma]@) and( @R[exact_scattered]@). The remaining parameters determine how the Sommerfeld radiation condition is applied. \dontinclude scattering.cc \skipline start_of_namespace \until std The function c get_exact_u returns the exact solution for the scattering problem We will use this function for the validation of our results dontinclude scattering cc skipline Exact solution for scattered until Next we provide a function that computes the prescribed f partial u partial evaluated on the surface of the unit disk dontinclude scattering cc skipline either with or without enabling spatial adaptivity and define the output directory until RESLT Finally</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00420">scattering.txt:420</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a1fd070157d712392fe18f5dce154ff2d"><div class="ttname"><a href="scattering_8txt.html#a1fd070157d712392fe18f5dce154ff2d">Re</a></div><div class="ttdeci">bigg[ik-\frac {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg] d Newton s method will converge in one iteration In such cases the unnecessary recomputation of f gamma f after the one and only Newton iteration can be suppressed by setting c Problem::Problem_is_nonlinear to c false&lt; HR &gt;&lt; HR &gt; section scattering A specific impermeable obstacle as shown in this I w textwidth scattering Scattering of an incoming wave from a sound hard obstacle the scatterer we wish to find the wave field that is scattered from the body For this purpose we denote the time dependent displacement of the fluid particle in the acoustic medium by the normal displacement of the fluid has to vanish on f partial non dimensionalise the potential as f Phi f t f Re[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{bound}}=- \left. \frac{\partial \phi_{inc}}{\partial n}\right|_{\partial D_{bound}}.\ \ \ \ \ \ \ \ \ \ \ \ \ @E[non_pen_bc_for_scattered]@\f] For the special case of the incoming wave being a planar propagating along the x the incoming field can be written in polar coordinates as f[\phi_{inc}(r, \varphi)=\sum_{n=-\infty}^{+\infty} i^n J_n(kr) e^{in\varphi}, \f] where f J_n f is the Bessel function of the first kind of order f n f The exact solution for the scattering of such a wave from a circular disk is given by the series f[u_{ex}(r,\varphi)=-\sum_{n=-\infty}^{+\infty} i^n \frac{H^{'}_{n}(k)}{J^{'}_{n}(k)} H_n(kr) e^{in\varphi},\ \ \ \ \ \ \ \ \ \ \ \ \ @E[exact_scattered]@\f] where we have chosen the disk s f a as the lengthscale by setting f H_n f denotes the Hankel function of the first kind of order f n f and the prime denotes differentiation with respect to the function s argument A quantity that is of particular interest in wave propagation problems is the time average of the power radiated by the f[\overline{\cal P}^ *=\frac{\omega}{2\pi} \int_{0}^{2\pi/\omega} {\cal P}^ *(t) \ dt^ *.\f] In the context of an acoustic the total instantaneous f radiated over a closed boundary is f[{\cal P}^ *(t)=\oint \frac{\partial {\bf u^ *} }{\partial t^ *} \cdot p^ *{\bf n} \ dS^ *,\f] where the pressure is related to the displacement potential via f[p^ *=\rho \omega^2 \Phi^ *.\f] The non dimensional time averaged radiated power can be expressed in terms of the complex potential f phi f as f[\overline{\cal P}=\frac{\overline{\cal P}^ *}{\rho \omega^3 {\cal L}^4}=\frac{1}{2}\oint\bigg[Im\bigg(\frac{\partial \phi}{\partial n}\bigg) \ Re(\phi) - Re\bigg(\frac{\partial \phi}{\partial n}\bigg) \ Im(\phi) \bigg] \ dS.\f]&lt; HR &gt;&lt; HR &gt; section results Results The figure below shows an animation of the displacement potential f(u(x, y, t)) \f$ for scattering from a circular disk for a non-dimensional wavenumber of \f$ k</div></div>
<div class="ttc" id="ascattering_8txt_html_ab1533d7dc1455f2a3218d7551ee7d307"><div class="ttname"><a href="scattering_8txt.html#ab1533d7dc1455f2a3218d7551ee7d307">various</a></div><div class="ttdeci">We add the various(sub-) meshes to the problem and build the global mesh \dontinclude scattering.cc \skipline \until build_global_mesh()</div></div>
<div class="ttc" id="ascattering_8txt_html_a9e7c000a908a3b5ad70587e891b488aa"><div class="ttname"><a href="scattering_8txt.html#a9e7c000a908a3b5ad70587e891b488aa">n</a></div><div class="ttdeci">namespace ::The main physical parameter is f k f c N_fourier is the number of(Fourier) terms to be used in evaluation of the series in equations( @R[gamma]@) and( @R[exact_scattered]@). The remaining parameters determine how the Sommerfeld radiation condition is applied. \dontinclude scattering.cc \skipline start_of_namespace \until std The function c get_exact_u returns the exact solution for the scattering problem We will use this function for the validation of our results dontinclude scattering cc skipline Exact solution for scattered until Next we provide a function that computes the prescribed f partial u partial n</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00395">scattering.txt:395</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a81b73f484efe28ca9ef38a6644af317e"><div class="ttname"><a href="scattering_8txt.html#a81b73f484efe28ca9ef38a6644af317e">the</a></div><div class="ttdeci">bigg[ik-\frac {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg] d Newton s method will converge in one iteration In such cases the unnecessary recomputation of f gamma f after the one and only Newton iteration can be suppressed by setting c Problem::Problem_is_nonlinear to c false&lt; HR &gt;&lt; HR &gt; section scattering A specific impermeable obstacle as shown in this I w textwidth scattering Scattering of an incoming wave from a sound hard obstacle the scatterer we wish to find the wave field that is scattered from the body For this purpose we denote the time dependent displacement of the fluid particle in the acoustic medium by the normal displacement of the fluid has to vanish on f partial non dimensionalise the potential as f Phi f t f the[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{bound}}=- \left. \frac{\partial \phi_{inc}}{\partial n}\right|_{\partial D_{bound}}.\ \ \ \ \ \ \ \ \ \ \ \ \ @E[non_pen_bc_for_scattered]@\f] For the special case of the incoming wave being a planar propagating along the x the incoming field can be written in polar coordinates as f[\phi_{inc}(r, \varphi)=\sum_{n=-\infty}^{+\infty} i^n J_n(kr) e^{in\varphi}, \f] where f J_n f is the Bessel function of the first kind of order f n f The exact solution for the scattering of such a wave from a circular disk is given by the series f[u_{ex}(r,\varphi)=-\sum_{n=-\infty}^{+\infty} i^n \frac{H^{'}_{n}(k)}{J^{'}_{n}(k)} H_n(kr) e^{in\varphi},\ \ \ \ \ \ \ \ \ \ \ \ \ @E[exact_scattered]@\f] where we have chosen the disk s f a as the lengthscale by setting f H_n f denotes the Hankel function of the first kind of order f n f and the prime denotes differentiation with respect to the function s argument A quantity that is of particular interest in wave propagation problems is the time average of the power radiated by the f[\overline{\cal P}^ *=\frac{\omega}{2\pi} \int_{0}^{2\pi/\omega} {\cal P}^ *(t) \ dt^ *.\f] In the context of an acoustic the total instantaneous f radiated over a closed boundary is f[{\cal P}^ *(t)=\oint \frac{\partial {\bf u^ *} }{\partial t^ *} \cdot p^ *{\bf n} \ dS^ *,\f] where the pressure is related to the displacement potential via f[p^ *=\rho \omega^2 \Phi^ *.\f] The non dimensional time averaged radiated power can be expressed in terms of the complex potential f phi f as f[\overline{\cal P}=\frac{\overline{\cal P}^ *}{\rho \omega^3 {\cal L}^4}=\frac{1}{2}\oint\bigg[Im\bigg(\frac{\partial \phi}{\partial n}\bigg) \ Re(\phi) - Re\bigg(\frac{\partial \phi}{\partial n}\bigg) \ Im(\phi) \bigg] \ dS.\f]&lt; HR &gt;&lt; HR &gt; section results Results The figure below shows an animation of the displacement potential f bounded by the outer surface(unit) disk and an artificial outer boundary of non-dimensional radius \f$ R</div></div>
<div class="ttc" id="ascattering_8txt_html_a28c248f2a2f37216b5e1af7687d4a827"><div class="ttname"><a href="scattering_8txt.html#a28c248f2a2f37216b5e1af7687d4a827">bigg</a></div><div class="ttdeci">bigg(ik - \frac{1}{2R}\bigg) u=0\mbox</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00141">scattering.txt:141</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a68841c31de7e2ddf9987db078384d4d4"><div class="ttname"><a href="scattering_8txt.html#a68841c31de7e2ddf9987db078384d4d4">equation</a></div><div class="ttdeci">see the section ref numbering for details The application of Dirichlet and Neumann boundary conditions is straightforward and follows the pattern employed for the solution of the Poisson equation</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00107">scattering.txt:107</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a1d0d961a8f8ea33c6e37232372ffdd62"><div class="ttname"><a href="scattering_8txt.html#a1d0d961a8f8ea33c6e37232372ffdd62">Acknowledgement</a></div><div class="ttdeci">mainpage Example an elliptic PDE that describes time harmonic wave propagation problems We start by reviewing the relevant theory and then present the solution of a simple model problem the scattering of a planar wave from a circular cylinder&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Acknowledgement</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00018">scattering.txt:18</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a18fa02139527b1f3377b544aca0a2275"><div class="ttname"><a href="scattering_8txt.html#a18fa02139527b1f3377b544aca0a2275">conditions</a></div><div class="ttdeci">see the section ref numbering for details The application of Dirichlet and Neumann boundary conditions is straightforward and follows the pattern employed for the solution of the Poisson E[polar_soln] f where the f $A_n f are suitable coefficients and f with an associated increase in computational cost c oomph lib provides an implementation of the following three boundary conditions(all taken from J. J. Shirron &amp;I. Babuska 's paper &quot;A comparison of approximate boundary 
conditions and infinite element methods for exterior Helmholtz
problems&quot;, Computer Methods in Applied Mechanics and Engineering&lt; b &gt;164&lt;/b &gt; 121-139(1998), in which the authors compare the accuracy of these and many other approximate boundary conditions). -&lt; b &gt;Feng 's first order ABC</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00131">scattering.txt:131</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a0f9229bdf8d2fef3c6d206cd5e50449e"><div class="ttname"><a href="scattering_8txt.html#a0f9229bdf8d2fef3c6d206cd5e50449e">radius</a></div><div class="ttdeci">bigg[ik-\frac {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg] d Newton s method will converge in one iteration In such cases the unnecessary recomputation of f gamma f after the one and only Newton iteration can be suppressed by setting c Problem::Problem_is_nonlinear to c false&lt; HR &gt;&lt; HR &gt; section scattering A specific impermeable obstacle as shown in this I w textwidth scattering Scattering of an incoming wave from a sound hard obstacle the scatterer we wish to find the wave field that is scattered from the body For this purpose we denote the time dependent displacement of the fluid particle in the acoustic medium by the normal displacement of the fluid has to vanish on f partial non dimensionalise the potential as f Phi f t f radius[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{bound}}=- \left. \frac{\partial \phi_{inc}}{\partial n}\right|_{\partial D_{bound}}.\ \ \ \ \ \ \ \ \ \ \ \ \ @E[non_pen_bc_for_scattered]@\f] For the special case of the incoming wave being a planar propagating along the x the incoming field can be written in polar coordinates as f[\phi_{inc}(r, \varphi)=\sum_{n=-\infty}^{+\infty} i^n J_n(kr) e^{in\varphi}, \f] where f J_n f is the Bessel function of the first kind of order f n f The exact solution for the scattering of such a wave from a circular disk is given by the series f[u_{ex}(r,\varphi)=-\sum_{n=-\infty}^{+\infty} i^n \frac{H^{'}_{n}(k)}{J^{'}_{n}(k)} H_n(kr) e^{in\varphi},\ \ \ \ \ \ \ \ \ \ \ \ \ @E[exact_scattered]@\f] where we have chosen the disk s</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00311">scattering.txt:311</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a7642bd7303d39de0d680340586b7df60"><div class="ttname"><a href="namespaceGlobalParameters.html#a7642bd7303d39de0d680340586b7df60">GlobalParameters::I</a></div><div class="ttdeci">std::complex&lt; double &gt; I(0.0, 1.0)</div><div class="ttdoc">Imaginary unit.</div></div>
<div class="ttc" id="ascattering_8txt_html_a5dffdf98cbe653b28efd295e7fb2afc5"><div class="ttname"><a href="scattering_8txt.html#a5dffdf98cbe653b28efd295e7fb2afc5">f</a></div><div class="ttdeci">mainpage Example an elliptic PDE that describes time harmonic wave propagation problems We start by reviewing the relevant theory and then present the solution of a simple model problem the scattering of a planar wave from a circular cylinder&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Paris&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section theory E[lin_wave] f where f c f is the wavespeed Assuming that f with frequency f omega f</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00037">scattering.txt:37</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a92eea6031e56d61acdba9c8dbf4d4cb8"><div class="ttname"><a href="scattering_8txt.html#a92eea6031e56d61acdba9c8dbf4d4cb8">mesh</a></div><div class="ttdeci">&lt; HR &gt;&lt; HR &gt; subsection constr The problem constructor We start by building the bulk mesh</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00428">scattering.txt:428</a></div></div>
<div class="ttc" id="ascattering_8txt_html_a4b322bb0edcb5d58c626dff1f94d65a8"><div class="ttname"><a href="scattering_8txt.html#a4b322bb0edcb5d58c626dff1f94d65a8">U</a></div><div class="ttdeci">mainpage Example an elliptic PDE that describes time harmonic wave propagation problems We start by reviewing the relevant theory and then present the solution of a simple model problem the scattering of a planar wave from a circular cylinder&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Paris&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section theory E[lin_wave] f where f c f is the wavespeed Assuming that f U(x, y, t) \f$ is time-harmonic</div></div>
<div class="ttc" id="ascattering_8txt_html_a80f6898a93b1f8d2a72f9da4e2041dfd"><div class="ttname"><a href="scattering_8txt.html#a80f6898a93b1f8d2a72f9da4e2041dfd">y</a></div><div class="ttdeci">mainpage Example an elliptic PDE that describes time harmonic wave propagation problems We start by reviewing the relevant theory and then present the solution of a simple model problem the scattering of a planar wave from a circular cylinder&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Paris&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section theory y</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00033">scattering.txt:33</a></div></div>
<div class="ttc" id="ascattering_8txt_html_ac2741ea814ebd65c7baf7bd9e45db83a"><div class="ttname"><a href="scattering_8txt.html#ac2741ea814ebd65c7baf7bd9e45db83a">wave</a></div><div class="ttdeci">bigg[ik-\frac {1}{2R}+\frac{i}{8kR^{2}}\bigg(1+4 \frac {\partial^{2}}{\partial \varphi^{2}}\bigg)\bigg] d Newton s method will converge in one iteration In such cases the unnecessary recomputation of f gamma f after the one and only Newton iteration can be suppressed by setting c Problem::Problem_is_nonlinear to c false&lt; HR &gt;&lt; HR &gt; section scattering A specific impermeable obstacle as shown in this I w textwidth scattering Scattering of an incoming wave from a sound hard obstacle the scatterer we wish to find the wave field that is scattered from the body For this purpose we denote the time dependent displacement of the fluid particle in the acoustic medium by the normal displacement of the fluid has to vanish on f partial non dimensionalise the potential as f Phi f t f wave[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{bound}}=- \left. \frac{\partial \phi_{inc}}{\partial n}\right|_{\partial D_{bound}}.\ \ \ \ \ \ \ \ \ \ \ \ \ @E[non_pen_bc_for_scattered]@\f] For the special case of the incoming wave being a planar</div><div class="ttdef"><b>Definition:</b> <a href="scattering_8txt_source.html#l00266">scattering.txt:266</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 16 2021 19:30:31
        </div>
      </div>
    </footer>
</body>
</html>

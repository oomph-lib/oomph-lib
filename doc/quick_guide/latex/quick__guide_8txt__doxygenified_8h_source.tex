\hypertarget{quick__guide_8txt__doxygenified_8h_source}{}\doxysection{quick\+\_\+guide.\+txt\+\_\+doxygenified.\+h}
\mbox{\hyperlink{quick__guide_8txt__doxygenified_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00001}00001 \textcolor{comment}{/**}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00002}00002 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00003}00003 \textcolor{comment}{\(\backslash\)mainpage (Not-\/So-\/)Quick Users Guide}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00004}00004 \textcolor{comment}{The purpose of this document is to provide a "{}quick"{} introduction to the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00005}00005 \textcolor{comment}{fundamental objects in \(\backslash\)c oomph-\/lib. Assuming that you }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00006}00006 \textcolor{comment}{-\/ have a basic understanding of the finite element method}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00007}00007 \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00008}00008 \textcolor{comment}{and}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00009}00009 \textcolor{comment}{-\/ are reasonably familiar with object-\/oriented programming in C++,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00010}00010 \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00011}00011 \textcolor{comment}{the Quick Guide should enable you to solve basic PDE }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00012}00012 \textcolor{comment}{problems using \(\backslash\)c oomph-\/lib. You should also consult}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00013}00013 \textcolor{comment}{the extensive <A HREF="{}../../example\_code\_list/html/index.html"{}>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00014}00014 \textcolor{comment}{list of example codes</A> distributed with the library. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00015}00015 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00016}00016 \textcolor{comment}{\(\backslash\)section main\_how\_to How to solve simple PDEs with oomph-\/lib}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00017}00017 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00018}00018 \textcolor{comment}{  To solve a given PDE with \(\backslash\)c oomph-\/lib, its discretisation }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00019}00019 \textcolor{comment}{needs to be specified in a \(\backslash\)c Problem object. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00020}00020 \textcolor{comment}{This usually involves the specification of the \(\backslash\)c Mesh and }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00021}00021 \textcolor{comment}{the element types, followed by the application of the boundary conditions. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00022}00022 \textcolor{comment}{If these steps are performed in the \(\backslash\)c Problem constructor,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00023}00023 \textcolor{comment}{the driver code itself can be as simple as:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00024}00024 \textcolor{comment}{\(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00025}00025 \textcolor{comment}{\(\backslash\)skipline main(}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00026}00026 \textcolor{comment}{\(\backslash\)until \} }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00027}00027 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00028}00028 \textcolor{comment}{The amount of work required to represent a given PDE as}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00029}00029 \textcolor{comment}{a \(\backslash\)c Problem object is problem-\/dependent:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00030}00030 \textcolor{comment}{-\/ If \(\backslash\)c oomph-\/lib's existing \(\backslash\)c Mesh objects and element types}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00031}00031 \textcolor{comment}{  are sufficient to discretise the problem, the generation of}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00032}00032 \textcolor{comment}{  a fully-\/functional \(\backslash\)c Problem object is straightforward. We shall discuss}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00033}00033 \textcolor{comment}{  this case in the section \(\backslash\)ref problem. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00034}00034 \textcolor{comment}{-\/ If \(\backslash\)c oomph-\/lib provides the required element type but none of the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00035}00035 \textcolor{comment}{  available meshes are suitable, }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00036}00036 \textcolor{comment}{  you will have to write your own \(\backslash\)c Mesh object. We shall discuss this in }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00037}00037 \textcolor{comment}{  the section \(\backslash\)ref mesh. It is also possible to create}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00038}00038 \textcolor{comment}{  \(\backslash\)c oomph-\/lib meshes based on the output from third-\/party (commercial)}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00039}00039 \textcolor{comment}{  mesh generators. This is illustrated in }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00040}00040 \textcolor{comment}{  <A HREF="{}../../meshes/third\_party\_meshes/html/index.html"{}>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00041}00041 \textcolor{comment}{  another example.</A> }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00042}00042 \textcolor{comment}{-\/ Finally, the problem might involve a PDE for which \(\backslash\)c oomph-\/lib}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00043}00043 \textcolor{comment}{  does not provide any suitable elements. In this case you }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00044}00044 \textcolor{comment}{  will need to write your own element. When implementing elements}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00045}00045 \textcolor{comment}{  in \(\backslash\)c oomph-\/lib the element formulation is generally sub-\/divided into }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00046}00046 \textcolor{comment}{  (at least) two levels. Geometric elements implement the element geometry}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00047}00047 \textcolor{comment}{  (e.g. 2D quad elements, 3D brick elements, etc); these geometric elements}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00048}00048 \textcolor{comment}{  act as base classes for specific \(\backslash\)c FiniteElements that implement}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00049}00049 \textcolor{comment}{  the discretisation of particular PDEs. We discuss the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00050}00050 \textcolor{comment}{  implementation of the two types of elements in two separate sections:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00051}00051 \textcolor{comment}{  -\/ In the section \(\backslash\)ref FEequations we describe how to}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00052}00052 \textcolor{comment}{    discretise a new system of equations, using existing}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00053}00053 \textcolor{comment}{    geometric elements.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00054}00054 \textcolor{comment}{  -\/ In the section \(\backslash\)ref FEgeom we discuss how to formulate new geometric}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00055}00055 \textcolor{comment}{    elements.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00056}00056 \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00057}00057 \textcolor{comment}{  }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00058}00058 \textcolor{comment}{In all cases, we start with a brief description of}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00059}00059 \textcolor{comment}{the minimum functionality that must be implemented for the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00060}00060 \textcolor{comment}{various objects. The general principles are then illustrated}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00061}00061 \textcolor{comment}{by considering the discretisation of the model problem}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00062}00062 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00063}00063 \textcolor{comment}{<CENTER>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00064}00064 \textcolor{comment}{<TABLE class="{}oomph-\/table"{}>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00065}00065 \textcolor{comment}{<TR>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00066}00066 \textcolor{comment}{<TD class="{}panel panel-\/default"{}>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00067}00067 \textcolor{comment}{<CENTER class="{}panel-\/heading"{}>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00068}00068 \textcolor{comment}{<B>One-\/dimensional model Poisson problem</B>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00069}00069 \textcolor{comment}{</CENTER>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00070}00070 \textcolor{comment}{<div class="{}panel-\/body"{}>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00071}00071 \textcolor{comment}{Solve}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00072}00072 \textcolor{comment}{\(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00073}00073 \textcolor{comment}{\(\backslash\)frac\{\(\backslash\)mbox\{d\}\string^2u\}\{\(\backslash\)mbox\{d\}x\string^2\} = \(\backslash\)pm 30 \(\backslash\)sin(\(\backslash\)sqrt\{30\} x),}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00074}00074 \textcolor{comment}{ \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) (1)}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00075}00075 \textcolor{comment}{\(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00076}00076 \textcolor{comment}{in the one-\/dimensional domain \(\backslash\)f\$x\(\backslash\)in[0,1]\(\backslash\)f\$, subject to }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00077}00077 \textcolor{comment}{\(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00078}00078 \textcolor{comment}{u(0)=0 \(\backslash\) \(\backslash\)mbox\{\(\backslash\) \(\backslash\) \(\backslash\) and \(\backslash\) \(\backslash\) \(\backslash\) \} \(\backslash\) \(\backslash\) u(1)=\(\backslash\)mp 1, }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00079}00079 \textcolor{comment}{\(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) (2)}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00080}00080 \textcolor{comment}{\(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00081}00081 \textcolor{comment}{</div>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00082}00082 \textcolor{comment}{</TD>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00083}00083 \textcolor{comment}{</TR>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00084}00084 \textcolor{comment}{</TABLE>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00085}00085 \textcolor{comment}{</CENTER>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00086}00086 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00087}00087 \textcolor{comment}{by isoparametric two-\/node elements. (Please consult the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00088}00088 \textcolor{comment}{<A HREF="{}../../intro/html/index.html"{}>Introduction</A> for a review of}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00089}00089 \textcolor{comment}{the relevant finite element theory.) The source code for this example}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00090}00090 \textcolor{comment}{(<A HREF="{}../../../demo\_drivers/poisson/one\_d\_poisson\_generic\_only/one\_d\_poisson\_generic\_only.cc"{}>one\_d\_poisson\_generic\_only.cc</A>)}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00091}00091 \textcolor{comment}{is  self-\/contained and uses only objects from the "{}generic"{} part of}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00092}00092 \textcolor{comment}{the \(\backslash\)c oomph-\/lib library. [\(\backslash\)c oomph-\/lib does, of course, provide }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00093}00093 \textcolor{comment}{1D meshes and Poisson elements but we deliberately ignore these }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00094}00094 \textcolor{comment}{because we wish to illustrate how to build such objects from scratch.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00095}00095 \textcolor{comment}{The alternative example code }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00096}00096 \textcolor{comment}{<A HREF="{}../../../demo\_drivers/poisson/one\_d\_poisson/one\_d\_poisson.cc"{}>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00097}00097 \textcolor{comment}{one\_d\_poisson.cc</A>,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00098}00098 \textcolor{comment}{discussed in <A HREF="{}../../poisson/one\_d\_poisson/html/index.html"{}>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00099}00099 \textcolor{comment}{another example</A> illustrates the implementation of the same problem using }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00100}00100 \textcolor{comment}{existing library objects.]}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00101}00101 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00102}00102 \textcolor{comment}{The main purpose of this document is to }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00103}00103 \textcolor{comment}{provide a \(\backslash\)e "{}quick"{} introduction to \(\backslash\)c oomph-\/lib's fundamental objects,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00104}00104 \textcolor{comment}{so the example classes presented below are fully-\/functional but very}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00105}00105 \textcolor{comment}{basic. We provide exercises at the end of each section}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00106}00106 \textcolor{comment}{to allow the reader to explore various straightforward improvements,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00107}00107 \textcolor{comment}{most of which are implemented in the corresponding objects}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00108}00108 \textcolor{comment}{in the library. Finally, the section \(\backslash\)ref comments provides a }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00109}00109 \textcolor{comment}{discussion of some general design principles that should}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00110}00110 \textcolor{comment}{be respected when creating new classes for use with the library. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00111}00111 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00112}00112 \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00113}00113 \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00114}00114 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00115}00115 \textcolor{comment}{\(\backslash\)section problem How to build a Problem}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00116}00116 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00117}00117 \textcolor{comment}{All specific \(\backslash\)c Problems should be implemented as }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00118}00118 \textcolor{comment}{objects that inherit from the generic \(\backslash\)c Problem class. These}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00119}00119 \textcolor{comment}{specific \(\backslash\)c Problem objects will vary considerably depending}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00120}00120 \textcolor{comment}{on the exact details of the problem being solved. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00121}00121 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00122}00122 \textcolor{comment}{Only a few member functions \(\backslash\)e must be implemented for each specific}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00123}00123 \textcolor{comment}{\(\backslash\)c Problem class:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00124}00124 \textcolor{comment}{-\/ The problem constructor \(\backslash\)code SomeSpecificProblem(...) \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00125}00125 \textcolor{comment}{-\/ and the member functions}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00126}00126 \textcolor{comment}{  \(\backslash\)code Problem::actions\_before\_newton\_solve() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00127}00127 \textcolor{comment}{  \(\backslash\)code Problem::actions\_after\_newton\_solve() \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00128}00128 \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00129}00129 \textcolor{comment}{\(\backslash\)subsection spec The constructor: SomeSpecificProblem(...)}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00130}00130 \textcolor{comment}{The Problem constructor  \(\backslash\)c SomeSpecificProblem(...) }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00131}00131 \textcolor{comment}{usually contains the following steps:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00132}00132 \textcolor{comment}{-\/ Construction of the timestepper (if required), e.g. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00133}00133 \textcolor{comment}{  \(\backslash\)code Problem::add\_time\_stepper\_pt(new SomeTimeStepper()); \(\backslash\)endcode   }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00134}00134 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00135}00135 \textcolor{comment}{-\/ Construction of the \(\backslash\)c Mesh (which may involve passing a particular}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00136}00136 \textcolor{comment}{  element type as a template parameter), e.g.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00137}00137 \textcolor{comment}{  \(\backslash\)code Problem::mesh\_pt() = new SomeMesh<SomeElement>(...); \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00138}00138 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00139}00139 \textcolor{comment}{-\/ Specification of the boundary conditions. By default, all nodal}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00140}00140 \textcolor{comment}{  values are assumed to be free and their values are initialised to zero. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00141}00141 \textcolor{comment}{  Therefore, we only need to "{}pin"{} the values that are prescribed}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00142}00142 \textcolor{comment}{  by boundary conditions and assign any nonzero boundary values.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00143}00143 \textcolor{comment}{  For instance, the following instruction "{}pins"{} the (single) nodal }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00144}00144 \textcolor{comment}{  value at node "{}0"{}:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00145}00145 \textcolor{comment}{  \(\backslash\)code Problem::mesh\_pt()-\/>node\_pt(0)-\/>pin(0); \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00146}00146 \textcolor{comment}{  A non-\/zero boundary value can be set by}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00147}00147 \textcolor{comment}{  \(\backslash\)code Problem::mesh\_pt()-\/>node\_pt(0)-\/>set\_value(0,1.0); \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00148}00148 \textcolor{comment}{  This statement sets the first (= zero-\/th in C++'s zero-\/based indexing)}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00149}00149 \textcolor{comment}{  nodal value to 1.0.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00150}00150 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00151}00151 \textcolor{comment}{-\/ Completion of the build of the elements: Elements are typically}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00152}00152 \textcolor{comment}{  constructed during the mesh generation process. To allow a }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00153}00153 \textcolor{comment}{  generic implementation of this process, mesh constructors }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00154}00154 \textcolor{comment}{  use an argument-\/free constructor to}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00155}00155 \textcolor{comment}{  create the elements. Thus, element constructors must not}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00156}00156 \textcolor{comment}{  have any arguments. (See the section `\(\backslash\)ref new\_mesh', below, for an }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00157}00157 \textcolor{comment}{  illustration of this process.) If an element requires any global parameters}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00158}00158 \textcolor{comment}{  (such as pointers to physical parameters, function pointers }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00159}00159 \textcolor{comment}{  to source functions, etc.), these parameters should be passed to the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00160}00160 \textcolor{comment}{  element via suitable access functions, \(\backslash\)e after the element has been }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00161}00161 \textcolor{comment}{  created by the mesh constructor.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00162}00162 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00163}00163 \textcolor{comment}{-\/ Assignment of the global and local equation numbers }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00164}00164 \textcolor{comment}{  \(\backslash\)code Problem::assign\_eqn\_numbers(); \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00165}00165 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00166}00166 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00167}00167 \textcolor{comment}{\(\backslash\)subsection actbef The function Problem::actions\_before\_newton\_solve()}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00168}00168 \textcolor{comment}{\(\backslash\)c oomph-\/lib treats all problems as non-\/linear problems and }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00169}00169 \textcolor{comment}{employs Newton's method to solve the system of nonlinear algebraic}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00170}00170 \textcolor{comment}{equations that results from its spatial (and, in time-\/dependent}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00171}00171 \textcolor{comment}{problems, temporal) discretisation. Within this framework, linear}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00172}00172 \textcolor{comment}{problems are special cases for which Newton's method converges}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00173}00173 \textcolor{comment}{in one step.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00174}00174 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00175}00175 \textcolor{comment}{The (pure virtual) member function \(\backslash\)c Problem::actions\_before\_newton\_solve() }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00176}00176 \textcolor{comment}{should contain everything that \(\backslash\)e must be done before a nonlinear }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00177}00177 \textcolor{comment}{solve to complete the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00178}00178 \textcolor{comment}{specification of the problem. For example, the function may contain a call to}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00179}00179 \textcolor{comment}{update the boundary conditions.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00180}00180 \textcolor{comment}{\(\backslash\)code void actions\_before\_newton\_solve() \{update\_boundary\_conditions();\}}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00181}00181 \textcolor{comment}{\(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00182}00182 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00183}00183 \textcolor{comment}{If desired, finer granularity may be obtained by overloading the }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00184}00184 \textcolor{comment}{empty virtual }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00185}00185 \textcolor{comment}{functions \(\backslash\)c Problem::actions\_before\_newton\_convergence\_check(),}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00186}00186 \textcolor{comment}{\(\backslash\)c Problem::actions\_before\_newton\_step() and/or }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00187}00187 \textcolor{comment}{\(\backslash\)c Problem::actions\_before\_implicit\_timestep(), which are executed }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00188}00188 \textcolor{comment}{before each calculation of the maximum value of the residuals,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00189}00189 \textcolor{comment}{each Newton step or each timestep, respectively. We refer to a }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00190}00190 \textcolor{comment}{<A HREF="{}../../order\_of\_action\_functions/html/index.html"{}>separate}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00191}00191 \textcolor{comment}{document</A> for a more detailed discussion of the various}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00192}00192 \textcolor{comment}{"{}action functions"{} executed by \(\backslash\)c oomph-\/lib's Newton solver. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00193}00193 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00194}00194 \textcolor{comment}{\(\backslash\)subsection actafter The function Problem::actions\_after\_newton\_solve()}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00195}00195 \textcolor{comment}{The (pure virtual) member function \(\backslash\)c Problem::actions\_after\_newton\_solve() }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00196}00196 \textcolor{comment}{should contain}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00197}00197 \textcolor{comment}{everything that is to take place after each nonlinear solve. For}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00198}00198 \textcolor{comment}{example, the function might}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00199}00199 \textcolor{comment}{contain commands to update the values of any "{}dependent"{} variables, or }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00200}00200 \textcolor{comment}{post-\/processing commands.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00201}00201 \textcolor{comment}{\(\backslash\)code }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00202}00202 \textcolor{comment}{void actions\_after\_newton\_solve()}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00203}00203 \textcolor{comment}{ \{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00204}00204 \textcolor{comment}{  //Update value of the slave variable in namespace GlobalVariables}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00205}00205 \textcolor{comment}{  GlobalVariables::slave = node\_pt(0)-\/>value(0) + node\_pt(0)-\/>value(1);}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00206}00206 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00207}00207 \textcolor{comment}{  //Call the output function}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00208}00208 \textcolor{comment}{  ofstream output\_file("{}result.dat"{});}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00209}00209 \textcolor{comment}{  output(output\_file); }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00210}00210 \textcolor{comment}{ \}}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00211}00211 \textcolor{comment}{ \(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00212}00212 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00213}00213 \textcolor{comment}{Again, the finer-\/grained member functions }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00214}00214 \textcolor{comment}{\(\backslash\)c Problem::actions\_after\_newton\_step() and  }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00215}00215 \textcolor{comment}{\(\backslash\)c Problem::actions\_after\_implicit\_timestep() are provided.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00216}00216 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00217}00217 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00218}00218 \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00219}00219 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00220}00220 \textcolor{comment}{\(\backslash\)subsection full An example of a "{}complete"{} specific Problem}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00221}00221 \textcolor{comment}{Here is the full specification for the \(\backslash\)c DemoPoissonProblem class}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00222}00222 \textcolor{comment}{(taken from <A HREF="{}../../../demo\_drivers/poisson/one\_d\_poisson\_generic\_only/one\_d\_poisson\_generic\_only.cc"{}>one\_d\_poisson\_generic\_only.cc</A>)}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00223}00223 \textcolor{comment}{which implements the discretisation of the 1D Poisson problem}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00224}00224 \textcolor{comment}{described above, using a \(\backslash\)c Mesh of type  \(\backslash\)c OneDimMesh, with }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00225}00225 \textcolor{comment}{elements of type \(\backslash\)c TwoNodePoissonElements.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00226}00226 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00227}00227 \textcolor{comment}{\(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00228}00228 \textcolor{comment}{\(\backslash\)skipline DemoPoissonProblem}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00229}00229 \textcolor{comment}{\(\backslash\)until End of problem }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00230}00230 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00231}00231 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00232}00232 \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00233}00233 \textcolor{comment}{\(\backslash\)subsection problem\_exercise Exercises:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00234}00234 \textcolor{comment}{-\/ Compile and run the example code }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00235}00235 \textcolor{comment}{  <A HREF="{}../../../demo\_drivers/poisson/one\_d\_poisson\_generic\_only/one\_d\_poisson\_generic\_only.cc"{}>one\_d\_poisson\_generic\_only.cc</A> and compare the numerical }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00236}00236 \textcolor{comment}{  results against the (fish-\/shaped) exact solution}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00237}00237 \textcolor{comment}{  \(\backslash\)f[}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00238}00238 \textcolor{comment}{  u\_\{fish\}(x) =  }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00239}00239 \textcolor{comment}{  \(\backslash\)pm \(\backslash\)left[ \(\backslash\)left(\(\backslash\)sin(\(\backslash\)sqrt\{30\})-\/1\(\backslash\)right) x -\/ \(\backslash\)sin(\(\backslash\)sqrt\{30\} x)\(\backslash\)right].}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00240}00240 \textcolor{comment}{  \(\backslash\)f]}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00241}00241 \textcolor{comment}{  (The sign of the source function is an optional argument to the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00242}00242 \textcolor{comment}{  problem constructor. If no argument is specified, the + sign}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00243}00243 \textcolor{comment}{  is used.)  Modify the \(\backslash\)c actions\_after\_newton\_solve() function so that it}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00244}00244 \textcolor{comment}{  writes the exact solution into another file, "{}exact\_solution.dat"{}, say.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00245}00245 \textcolor{comment}{-\/ Vary the number of elements and observe how the numerical results}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00246}00246 \textcolor{comment}{  converge to the exact solution.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00247}00247 \textcolor{comment}{-\/ Adjust the boundary conditions:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00248}00248 \textcolor{comment}{  -\/ Change the boundary condition at the left end of the domain }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00249}00249 \textcolor{comment}{    to \(\backslash\)f\$ u(0)=1\(\backslash\)f\$.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00250}00250 \textcolor{comment}{  -\/ What happens when you don't apply a boundary condition }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00251}00251 \textcolor{comment}{    at \(\backslash\)f\$ x=1  \(\backslash\)f\$? (Hint: What are the natural boundary conditions}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00252}00252 \textcolor{comment}{    for the Poisson equation?) }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00253}00253 \textcolor{comment}{  -\/ What happens when no boundary conditions are applied?}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00254}00254 \textcolor{comment}{  .}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00255}00255 \textcolor{comment}{-\/ Suppress the assignment of the equation numbers in the problem}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00256}00256 \textcolor{comment}{  constructor and observe what happens. Check the error messages}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00257}00257 \textcolor{comment}{  produced by \(\backslash\)c Problem::self\_test().}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00258}00258 \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00259}00259 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00260}00260 \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00261}00261 \textcolor{comment}{<HR>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00262}00262 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00263}00263 \textcolor{comment}{\(\backslash\)section mesh How to build a Mesh}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00264}00264 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00265}00265 \textcolor{comment}{\(\backslash\)c oomph-\/lib provides a large number of fully-\/functional \(\backslash\)c Mesh objects. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00266}00266 \textcolor{comment}{Many of these meshes can easily be adapted to discretise other}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00267}00267 \textcolor{comment}{domains, provided the domain has the same topology as the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00268}00268 \textcolor{comment}{original \(\backslash\)c Mesh. We shall illustrate this in section \(\backslash\)ref distorted\_mesh }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00269}00269 \textcolor{comment}{below.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00270}00270 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00271}00271 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00272}00272 \textcolor{comment}{\(\backslash\)subsection new\_mesh How to build a completely new Mesh}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00273}00273 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00274}00274 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00275}00275 \textcolor{comment}{If the domain is too different from any of the existing meshes, a new,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00276}00276 \textcolor{comment}{customised \(\backslash\)c Mesh object, \(\backslash\)c SpecificMesh, say, must be created. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00277}00277 \textcolor{comment}{The specific mesh should be created as an object that inherits from the }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00278}00278 \textcolor{comment}{generic \(\backslash\)c Mesh class. To maximise the potential for code-\/reuse, we}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00279}00279 \textcolor{comment}{recommended making the element type a template parameter}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00280}00280 \textcolor{comment}{of the \(\backslash\)c SpecificMesh class.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00281}00281 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00282}00282 \textcolor{comment}{\(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00283}00283 \textcolor{comment}{template<class ELEMENT>}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00284}00284 \textcolor{comment}{class SpecificMesh : public Mesh}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00285}00285 \textcolor{comment}{\(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00286}00286 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00287}00287 \textcolor{comment}{This allows the \(\backslash\)c SpecificMesh to be used}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00288}00288 \textcolor{comment}{with any \(\backslash\)c FiniteElement that is based on the same geometric}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00289}00289 \textcolor{comment}{element type (see the section \(\backslash\)ref FEgeom for a more detailed discussion of }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00290}00290 \textcolor{comment}{geometric elements).}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00291}00291 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00292}00292 \textcolor{comment}{The minimum requirements for a specific mesh object are that it must:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00293}00293 \textcolor{comment}{-\/ Construct the elements and the \(\backslash\)c Nodes,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00294}00294 \textcolor{comment}{-\/ Store pointers to the elements in the \(\backslash\)c Mesh::Element\_pt vector,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00295}00295 \textcolor{comment}{-\/ Store pointers to the \(\backslash\)c Nodes in the \(\backslash\)c Mesh::Node\_pt vector,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00296}00296 \textcolor{comment}{-\/ Set the elements' pointers to their local \(\backslash\)c Nodes}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00297}00297 \textcolor{comment}{-\/ Set the positions of the \(\backslash\)c Nodes.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00298}00298 \textcolor{comment}{.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00299}00299 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00300}00300 \textcolor{comment}{We suggest that all specific \(\backslash\)c Mesh constructors also set up }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00301}00301 \textcolor{comment}{an auxiliary lookup scheme that stores information about the mesh}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00302}00302 \textcolor{comment}{boundaries. While this is not strictly required, it greatly facilitates}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00303}00303 \textcolor{comment}{the application of boundary conditions in complex domains. Firstly,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00304}00304 \textcolor{comment}{the function \(\backslash\)c Mesh::set\_nboundary(...) must be called to specify the}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00305}00305 \textcolor{comment}{number of mesh boundaries. In addition, the generic \(\backslash\)c Mesh class }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00306}00306 \textcolor{comment}{provides a function \(\backslash\)c Mesh::add\_boundary\_node(i,node\_pt), }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00307}00307 \textcolor{comment}{which adds the \(\backslash\)c Node pointed to by \(\backslash\)c node\_pt to the \(\backslash\)c Mesh's i-\/th }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00308}00308 \textcolor{comment}{boundary and constructs the required}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00309}00309 \textcolor{comment}{look-\/up schemes, including a reverse lookup scheme that informs all }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00310}00310 \textcolor{comment}{\(\backslash\)c Nodes which mesh boundaries (if any) they are located on. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00311}00311 \textcolor{comment}{(In our simple 1D example there are only}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00312}00312 \textcolor{comment}{two boundaries, each consisting of a single Node.) }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00313}00313 \textcolor{comment}{Although this step is optional, it \(\backslash\)e is required }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00314}00314 \textcolor{comment}{during mesh adaptation -\/-\/ if the reverse lookup scheme has not been }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00315}00315 \textcolor{comment}{set up, a warning is issued and the code execution stops when any mesh }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00316}00316 \textcolor{comment}{adaptation is attempted. \(\backslash\)b Implementation \(\backslash\)b detail: \(\backslash\)c Nodes that are}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00317}00317 \textcolor{comment}{located on mesh boundaries must be defined as \(\backslash\)c BoundaryNodes.  }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00318}00318 \textcolor{comment}{ }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00319}00319 \textcolor{comment}{The majority of the work required to build a specific \(\backslash\)c Mesh}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00320}00320 \textcolor{comment}{takes place in its constructor. Typically, the constructor creates}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00321}00321 \textcolor{comment}{the elements (of the type specified by the template parameter \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00322}00322 \textcolor{comment}{ELEMENT)  and uses the elements' member function \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00323}00323 \textcolor{comment}{FiniteElement::construct\_node(...) to create the new \(\backslash\)c Nodes. The}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00324}00324 \textcolor{comment}{equivalent member function \(\backslash\)c}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00325}00325 \textcolor{comment}{FiniteElement::construct\_boundary\_node(...) }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00326}00326 \textcolor{comment}{is used to create new \(\backslash\)c BoundaryNodes. }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00327}00327 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00328}00328 \textcolor{comment}{Here is the complete class definition for a simple, one-\/dimensional }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00329}00329 \textcolor{comment}{(line) mesh which discretises the 1D domain \(\backslash\)f\$x\(\backslash\)in [0,1]\(\backslash\)f\$ using }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00330}00330 \textcolor{comment}{a specified number of equally-\/spaced elements.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00331}00331 \textcolor{comment}{\(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00332}00332 \textcolor{comment}{\(\backslash\)skipline template<}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00333}00333 \textcolor{comment}{\(\backslash\)until \};}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00334}00334 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00335}00335 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00336}00336 \textcolor{comment}{To build a \(\backslash\)c OneDimMesh with ten elements of type \(\backslash\)c SomeElement, say, the }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00337}00337 \textcolor{comment}{\(\backslash\)c Problem constructor would contain the following}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00338}00338 \textcolor{comment}{\(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00339}00339 \textcolor{comment}{Problem::mesh\_pt() = new OneDimMesh<SomeElement>(10);}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00340}00340 \textcolor{comment}{\(\backslash\)endcode}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00341}00341 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00342}00342 \textcolor{comment}{\(\backslash\)subsection distorted\_mesh How to adapt an existing Mesh to a different domain shape}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00343}00343 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00344}00344 \textcolor{comment}{Given that mesh generation tends to be a fairly tedious process, one should}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00345}00345 \textcolor{comment}{always check whether it is possible to deform an existing \(\backslash\)c Mesh}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00346}00346 \textcolor{comment}{into a shape that matches the required domain. Provided that the }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00347}00347 \textcolor{comment}{new domain has the same topology as the domain represented }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00348}00348 \textcolor{comment}{by the original \(\backslash\)c Mesh, this can always be done by }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00349}00349 \textcolor{comment}{re-\/positioning the Nodes. Such "{}deformed"{} \(\backslash\)c Meshes should be implemented}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00350}00350 \textcolor{comment}{via inheritance, by deriving the new \(\backslash\)c Mesh from an existing one.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00351}00351 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00352}00352 \textcolor{comment}{Here is an example that illustrates the procedure. Assume we wish to }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00353}00353 \textcolor{comment}{solve an equation in the 2D annular domain bounded (in polar}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00354}00354 \textcolor{comment}{coordinates) by \(\backslash\)f\$ r \(\backslash\)in [r\_\{min\}, r\_\{max\}] \(\backslash\)f\$ and  \(\backslash\)f\$ \(\backslash\)varphi \(\backslash\)in }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00355}00355 \textcolor{comment}{[\(\backslash\)varphi\_\{min\}, \(\backslash\)varphi\_\{max\}] \(\backslash\)f\$. Inspection of the }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00356}00356 \textcolor{comment}{<A HREF="{}../../meshes/mesh\_list/html/index.html"{}> list of available}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00357}00357 \textcolor{comment}{meshes </A> shows that \(\backslash\)c oomph-\/lib does not provide a mesh for }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00358}00358 \textcolor{comment}{this geometry. However, there is a \(\backslash\)c Mesh object,}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00359}00359 \textcolor{comment}{ \(\backslash\)c SimpleRectangularMesh, which provides a uniform }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00360}00360 \textcolor{comment}{discretisation of a 2D rectangular domain \(\backslash\)f\$ x\(\backslash\)in [0,L\_x] \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00361}00361 \textcolor{comment}{and \(\backslash\)f\$ y \(\backslash\)in [0,L\_y] \(\backslash\)f\$ with \(\backslash\)f\$ N\_x \(\backslash\)times N\_y \(\backslash\)f\$}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00362}00362 \textcolor{comment}{quadrilateral elements. Since the topology of the two domains}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00363}00363 \textcolor{comment}{is identical, the annular mesh can be implemented in a few }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00364}00364 \textcolor{comment}{lines of code:}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00365}00365 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00366}00366 \textcolor{comment}{\(\backslash\)code}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00367}00367 \textcolor{comment}{//====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00368}00368 \textcolor{comment}{/// AnnularQuadMesh, derived from SimpleRectangularQuadMesh.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00369}00369 \textcolor{comment}{}//====================================================================}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00370}00370 template<class ELEMENT> }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00371}00371 class AnnularQuadMesh : public SimpleRectangularQuadMesh<ELEMENT>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00372}00372 \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00373}00373  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00374}00374   public:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00375}00375 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00376}00376 \textcolor{comment}{ /// \(\backslash\)short Constructor for angular mesh with n\_r x n\_phi }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00377}00377 \textcolor{comment}{ /// 2D quad elements. Calls constructor for the underlying }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00378}00378 \textcolor{comment}{ /// SimpleRectangularQuadMesh; then deforms the mesh so that it fits }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00379}00379 \textcolor{comment}{ /// into the annular region bounded by the radii r\_min and r\_max}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00380}00380 \textcolor{comment}{ /// and angles (in degree) of phi\_min and phi\_max.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00381}00381 \textcolor{comment}{} AnnularQuadMesh(const unsigned\& n\_r, const unsigned\& n\_phi,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00382}00382                  const double\& r\_min, const double\& r\_max,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00383}00383                  const double\& phi\_min, const double\& phi\_max) :}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00384}00384   SimpleRectangularQuadMesh<ELEMENT>(n\_r,n\_phi,1.0,1.0)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00385}00385   \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00386}00386 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00387}00387    // The constructor for the  SimpleRectangularQuadMesh has}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00388}00388    // built the mesh with n\_x x n\_y = n\_r x n\_phi elements in the unit}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00389}00389    // square. Let's reposition the nodal points so that the mesh}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00390}00390    // gets mapped into the required annular region:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00391}00391 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00392}00392    // Find out how many nodes there are}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00393}00393    unsigned n\_node=nnode();}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00395}00395    // Calculate the value of pi}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00396}00396    const double pi = 4.0*atan(1.0);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00397}00397 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00398}00398    // Loop over all nodes}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00399}00399    for (unsigned n=0;n<n\_node;n++)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00400}00400     \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00401}00401      // Pointer to node:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00402}00402      Node* nod\_pt=node\_pt(n);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00403}00403 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00404}00404      // Get the x/y coordinates}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00405}00405      double x\_old=nod\_pt-\/>x(0);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00406}00406      double y\_old=nod\_pt-\/>x(1);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00408}00408      // Map from the old x/y to the new r/phi:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00409}00409      double r=r\_min+(r\_max-\/r\_min)*x\_old;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00410}00410      double phi=(phi\_min+(phi\_max-\/phi\_min)*y\_old)*pi/180.0;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00411}00411 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00412}00412      // Set new nodal coordinates}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00413}00413      nod\_pt-\/>x(0)=r*cos(phi);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00414}00414      nod\_pt-\/>x(1)=r*sin(phi);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00415}00415     \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00416}00416   \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00417}00417 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00418}00418 \};}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00419}00419 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00420}00420 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00421}00421 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00422}00422 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00423}00423 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00424}00424 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00425}00425 \(\backslash\)subsection mes\_exercise Exercise:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00426}00426 Modify the \(\backslash\)c OneDimMesh object so that it provides a piecewise }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00427}00427 uniform discretisation of the domain}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00428}00428 \(\backslash\)f\$ x \(\backslash\)in [0,1]\(\backslash\)f\$: \(\backslash\)f\$ N\_0 \(\backslash\)f\$ equally spaced elements }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00429}00429 are to be placed in the the region \(\backslash\)f\$ x \(\backslash\)in [0,\(\backslash\)hat\{x\}]\(\backslash\)f\$, while}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00430}00430 \(\backslash\)f\$ N\_1 \(\backslash\)f\$ elements are to be placed in the the region \(\backslash\)f\$ x \(\backslash\)in}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00431}00431 [\(\backslash\)hat\{x\},1]\(\backslash\)f\$. Pass the parameters \(\backslash\)f\$ N\_0, N\_1  \(\backslash\)f\$}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00432}00432 and \(\backslash\)f\$\(\backslash\)hat\{x\} \(\backslash\)f\$ to the mesh constructor.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00433}00433 Construct the modified mesh via inheritance from the basic \(\backslash\)c OneDimMesh}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00434}00434 and include an error check to confirm that \(\backslash\)f\$ 0 < \(\backslash\)hat\{x\} < 1 \(\backslash\)f\$. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00435}00435 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00436}00436 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00437}00437 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00438}00438 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00439}00439  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00440}00440 \(\backslash\)section finiteelement How to build a FiniteElement}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00441}00441 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00442}00442 \(\backslash\)c oomph-\/lib provides fully-\/functional \(\backslash\)c FiniteElements for }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00443}00443 the discretisation of a wide range of PDEs. Most of the existing}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00444}00444 elements are constructed in a}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00445}00445 three-\/level hierarchy, the base being the generic }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00446}00446 \(\backslash\)c FiniteElement class. The next level in the hierarchy contains}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00447}00447 geometric elements (e.g. 1D line elements, 2D quad or triangular}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00448}00448 elements, 3D brick elements, etc.). These geometric}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00449}00449 classes form the bases for elements that implement}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00450}00450 the discretisation of particular PDEs. This hierarchy maximises}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00451}00451 the potential for code-\/reuse, because it allows many different}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00452}00452 specific elements to be derived from the same geometric element.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00453}00453  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00454}00454 We shall discuss the implementation of new element types in}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00455}00455 two sections:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00456}00456 -\/ \(\backslash\)ref FEequations}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00457}00457 -\/ \(\backslash\)ref FEgeom}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00458}00458 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00459}00459 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00460}00460 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00461}00461 \(\backslash\)subsection FEequations How to implement a new system of equations as a specific FiniteElement}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00462}00462 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00463}00463 Assume that we wish to design a new element type, \(\backslash\)c SpecificElement,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00464}00464 say, that implements the discretisation of a system of PDEs on an existing}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00465}00465 geometric element. The \(\backslash\)c SpecificElement class needs to implement}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00466}00466 the following functions:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00467}00467 -\/ The function that specifies the number of nodal values}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00468}00468   required at each of the element's nodes:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00469}00469   \(\backslash\)code FiniteElement::required\_nvalue(n) \(\backslash\)endcode }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00470}00470 -\/ The function that computes the element's residual vector:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00471}00471   \(\backslash\)code FiniteElement::get\_residuals(residuals) \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00472}00472 -\/ The function that computes the element's Jacobian matrix and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00473}00473   its residual vector:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00474}00474   \(\backslash\)code FiniteElement::get\_jacobian(residuals,jacobian) \(\backslash\)endcode }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00475}00475 -\/ The output function:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00476}00476   \(\backslash\)code FiniteElement::output(ostream) \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00477}00477 .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00479}00479 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00480}00480 Most specific finite element classes will contain further}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00481}00481 member functions and member data to provide }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00482}00482 additional, problem-\/specific functionality.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00483}00483 As a concrete example, we consider the \(\backslash\)c TwoNodePoissonElement,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00484}00484 a specific \(\backslash\)c FiniteElement that provides an isoparametric}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00485}00485 discretisation of the 1D Poisson equation (1), based on }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00486}00486 the geometric element \(\backslash\)c TwoNodeGeometricElement, to be discussed below:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00487}00487 \(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00488}00488 \(\backslash\)skipline TwoNodePoisson}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00489}00489 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00490}00490 In addition to the \(\backslash\)c FiniteElement member functions discussed above, }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00491}00491 this element provides a function that defines the source function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00492}00492 \(\backslash\)f\$ f(x) \(\backslash\)f\$,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00493}00493 \(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00494}00494 \(\backslash\)skipline f(}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00495}00495 \(\backslash\)until \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00496}00496 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00497}00497 where the sign of the source function is stored as private member data}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00498}00498 \(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00499}00499 \(\backslash\)skipline int Sign}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00500}00500 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00501}00501 and can be set by the access function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00502}00502 \(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00503}00503 \(\backslash\)skipline sign(}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00504}00504 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00505}00505 We provide a member function that returns the (single) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00506}00506 nodal value stored at a specified local node in the element,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00507}00507 \(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00508}00508 \(\backslash\)skipline u(}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00509}00509 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00510}00510 Finally, it is good practice to implement a self-\/test function }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00511}00511 that provides a sanity check of all data before}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00512}00512 the problem is solved. \(\backslash\)c oomph-\/lib already provides self-\/test functions}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00513}00513 for all fundamental objects. Additional tests can be added}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00514}00514 by overloading these. For instance, in our Poisson element, the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00515}00515 \(\backslash\)c Sign variable should only take the values \(\backslash\)f\$ \(\backslash\)pm 1 \(\backslash\)f\$.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00516}00516 This can be tested with the following function,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00517}00517 which also executes the \(\backslash\)c self\_test() function of the underlying}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00518}00518 \(\backslash\)c FiniteElement:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00519}00519 \(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00520}00520 \(\backslash\)skip Self test function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00521}00521 \(\backslash\)until End of self test}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00522}00522 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00523}00523 We will now discuss the implementation of the generic \(\backslash\)c FiniteElement }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00524}00524 member functions for the specific \(\backslash\)c TwoNodePoissonElement:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00525}00525 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00526}00526 \(\backslash\)subsubsection Fereq\_nvalue The function FiniteElement::required\_nvalue(n)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00527}00527 The function returns the number of values that are stored at the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00528}00528 element's \(\backslash\)c n-\/th}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00529}00529 local node. In our scalar Poisson problem, each node stores one value:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00530}00530 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00531}00531 \(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00532}00532 \(\backslash\)skip For the Poisson }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00533}00533 \(\backslash\)until required\_nvalue(}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00534}00534 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00535}00535 The function is used by \(\backslash\)c FiniteElement::construct\_node(...) to}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00536}00536 determine the amount of storage to be allocated at}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00537}00537 each of the element's \(\backslash\)c Nodes.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00538}00538 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00539}00539 \(\backslash\)subsubsection residuals The function FiniteElement::get\_residuals(residuals)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00540}00540 This function calculates the element's residual vector whose entries}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00541}00541 are labelled by the \(\backslash\)e local equation numbers. (Consult the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00542}00542 <A HREF="{}../../intro/html/index.html"{}>Introduction</A> for}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00543}00543 a detailed discussion of the weak form of Poisson's equation and its finite}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00544}00544 element discretisation which produces the discrete residual}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00545}00545 implemented here.) The spatial integration over the element is }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00546}00546 performed by the (default) integration scheme specified in the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00547}00547 underlying geometric element. Note that it should (must) not be}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00548}00548 assumed that the residuals vector has been set to zero before the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00549}00549 function call.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00550}00550 \(\backslash\)skipline get\_residuals(}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00551}00551 \(\backslash\)until End of function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00552}00552 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00553}00553 \(\backslash\)subsubsection jac The function FiniteElement::get\_jacobian(residuals,jacobian)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00554}00554 This function calculates the element's Jacobian matrix and its }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00555}00555 residual vector, performing the spatial integration with the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00556}00556 (default) integration scheme defined in the underlying geometric element. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00557}00557 The entries in the Jacobian matrix and the residual vector are labelled }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00558}00558 by the \(\backslash\)e local equation numbers. Note that neither the residuals}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00559}00559 vector nor the Jacobian matrix should be assumed to have been initialised to}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00560}00560 zero before the function call.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00561}00561 \(\backslash\)skipline get\_jacobian(}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00562}00562 \(\backslash\)until End of function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00563}00563 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00564}00564 \(\backslash\)b Note: There is a large amount of code duplication between }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00565}00565 the \(\backslash\)c get\_residuals()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00566}00566 and \(\backslash\)c get\_jacobian() functions. To avoid this, we usually }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00567}00567 implement the computation of the residual vector and the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00568}00568 Jacobian matrix in a single}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00569}00569 function containing the loop over the integration points. We then}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00570}00570 use a boolean flag as an additional argument to determine whether the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00571}00571 Jacobian matrix should be assembled, e.g.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00572}00572 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00573}00573 void get\_generic\_residual\_contribution(Vector<double>\& residuals,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00574}00574                                        DenseMatrix<double>\& jacobian,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00575}00575                                        bool flag)         }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00576}00576 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00577}00577 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00578}00578 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00579}00579 \(\backslash\)subsubsection FEout The function FiniteElement::output(out\_stream)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00580}00580 The output function is used to print the nodal values over the element}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00581}00581 \(\backslash\)skipline output(}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00582}00582 \(\backslash\)until End of function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00583}00583 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00584}00584 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00585}00585 \(\backslash\)subsection FE\_exercise Exercises:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00586}00586 -\/ Implement the function \(\backslash\)c get\_generic\_residual\_contribution(...) as a private}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00587}00587   member function of the \(\backslash\)c TwoNodePoissonElement. Use the function to avoid}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00588}00588   the large amount of code duplication between \(\backslash\)c get\_residuals(...) and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00589}00589   \(\backslash\)c get\_jacobian(...) by re-\/writing these functions as follows:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00590}00590   \(\backslash\)code\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00591}00591 \textcolor{comment}{  /// \(\backslash\)short Calculate the elemental contributions to the residuals for }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00592}00592 \textcolor{comment}{  /// the weak form of the Poisson equation}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00593}00593 \textcolor{comment}{}  void get\_residuals(Vector<double> \&residuals)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00594}00594    \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00595}00595     // Set flag for not computing the Jacobian}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00596}00596     bool flag=false;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00597}00597 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00598}00598     // Dummy Jacobian}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00599}00599     DenseMatrix<double> jacobian;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00600}00600 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00601}00601     // Compute the residuals only:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00602}00602     get\_generic\_residual\_contribution(residuals,jacobian,flag);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00603}00603    \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00604}00604   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00605}00605   and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00606}00606   \(\backslash\)code\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00607}00607 \textcolor{comment}{  /// \(\backslash\)short Calculate the elemental contribution to the Jacobian }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00608}00608 \textcolor{comment}{  /// matrix dR\_\{i\}/du\_\{j\} used in the Newton method}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00609}00609 \textcolor{comment}{}  void get\_jacobian(Vector<double> \&residuals, DenseMatrix<double> \&jacobian)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00610}00610    \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00611}00611     // Set flag for computing the Jacobian matrix}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00612}00612     bool flag=true;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00613}00613 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00614}00614     // Compute the residuals and the Jacobian matrix:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00615}00615     get\_generic\_residual\_contribution(residuals,jacobian,flag);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00616}00616    \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00617}00617   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00618}00618 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00619}00619 -\/ The implementation of the specific source function  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00620}00620   \(\backslash\)f\$ f(x) \(\backslash\)f\$ in \(\backslash\)c TwoNodePoissonElement::f(...) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00621}00621   makes it impossible to use the \(\backslash\)c TwoNodePoissonElement to solve}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00622}00622   the Poisson equation with any other source functions, even though}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00623}00623   the discretisation of the ODE would otherwise be completely identical. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00624}00624   A better implementation would allow the "{}user"{} to specify a different source}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00625}00625   function without having to change the implementation of the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00626}00626   element class itself. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00627}00627   \(\backslash\)n \(\backslash\)n}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00628}00628   Here is a suggestion for an improved implementation, which illustrates the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00629}00629   procedure employed in the existing elements in \(\backslash\)c oomph-\/lib:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00630}00630   -\/ Introduce a public typedef into the element class to define}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00631}00631     the required format of the function pointer:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00632}00632     \(\backslash\)code\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00633}00633 \textcolor{comment}{    /// \(\backslash\)short Function pointer to source function: }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00634}00634 \textcolor{comment}{    /// The source function returns the value of the }}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00635}00635 \textcolor{comment}{    /// source function at the global coordinate x.}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00636}00636 \textcolor{comment}{}    typedef double (*PoissonSourceFctPt)(const double\& x);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00637}00637     \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00638}00638   -\/ Add a function pointer to the private data of the \(\backslash\)c}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00639}00639     TwoNodePoissonElement class and initialise it to NULL}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00640}00640     in the constructor:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00641}00641     \(\backslash\)code\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00642}00642 \textcolor{comment}{    /// \(\backslash\)short Function pointer to source function (initialised to}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00643}00643 \textcolor{comment}{    /// NULL in the constructor)}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00644}00644 \textcolor{comment}{}    PoissonSourceFctPt Source\_fct\_pt;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00645}00645     \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00646}00646   -\/ Provide an access function for the source function pointer:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00647}00647     \(\backslash\)code\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00648}00648 \textcolor{comment}{    /// \(\backslash\)short Access function to pointer to source function}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00649}00649 \textcolor{comment}{}    PoissonSourceFctPt\& source\_fct\_pt() \{return Source\_fct\_pt;\}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00650}00650     \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00651}00651   -\/ Re-\/write the \(\backslash\)c TwoNodePoissonElement::f(...) function,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00652}00652     so that it evaluates the (global) function pointed to by}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00653}00653     the source function pointer.  If possible, provide a default value }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00654}00654     for the case when the function pointer has not been set:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00655}00655     \(\backslash\)code\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00656}00656 \textcolor{comment}{    /// Evaluate source function at Eulerian position x}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00657}00657 \textcolor{comment}{}    double f(const double\& x) const}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00658}00658      \{ }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00659}00659       //If no source function has been set, return zero}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00660}00660       //so that the Poisson equation defaults to a Laplace equation.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00661}00661       double source=0.0;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00662}00662       if(Source\_fct\_pt!=0)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00663}00663        \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00664}00664         // Evaluate source function }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00665}00665         source = (*Source\_fct\_pt)(x);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00666}00666        \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00667}00667       return source;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00668}00668      \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00669}00669     \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00670}00670   .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00671}00671   The pointer to the source function (typically defined in a suitable}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00672}00672   namespace in the "{}user's"{} driver code) can now be set in the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00673}00673   Problem constructor.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00674}00674 -\/ Generalise the \(\backslash\)c TwoNodePoissonElement to a \(\backslash\)c}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00675}00675   TwoNodeSelfAdjointElement that implements the isoparametric}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00676}00676   discretisation of the self-\/adjoint ODE}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00677}00677   \(\backslash\)f[}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00678}00678   \(\backslash\)frac\{\(\backslash\)mbox\{d\}\}\{\(\backslash\)mbox\{d\}x\} }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00679}00679   \(\backslash\)left( a(x) \(\backslash\)frac\{\(\backslash\)mbox\{d\}u\}\{\(\backslash\)mbox\{d\}x\} \(\backslash\)right) + b(x) u(x)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00680}00680   = f(x). \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\)  (3)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00681}00681   \(\backslash\)f]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00682}00682   Use function pointers to allow the "{}user"{} to specify }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00683}00683   the coefficient functions \(\backslash\)f\$ a(x), \(\backslash\) b(x) \(\backslash\)f\$ and \(\backslash\)f\$ f(x) \(\backslash\)f\$.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00684}00684 .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00685}00685 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00686}00686 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00687}00687 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00688}00688 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00689}00689 \(\backslash\)subsection FEgeom How to build a new geometric element}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00690}00690 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00691}00691 Geometric elements define the geometry of a \(\backslash\)c FiniteElement. They are}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00692}00692 usually implemented as distinct classes that can then be used to create}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00693}00693 a number of \(\backslash\)c FiniteElements each discretising a specific PDE, but }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00694}00694 with the same underlying geometrical representation. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00695}00695 For this purpose, each geometric \(\backslash\)c FiniteElement must }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00696}00696 implement the following functions:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00697}00697 -\/ The constructor}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00698}00698   \(\backslash\)code SomeGeometricFiniteElement::SomeGeometricFiniteElement() \(\backslash\)endcode }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00699}00699   must perform the following actions:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00700}00700   -\/ Set the number of Nodes by calling the protected member function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00701}00701     \(\backslash\)code FiniteElement::set\_n\_node(n\_node). \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00702}00702   -\/ Set the dimension of the element by calling the protected member}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00703}00703   function \(\backslash\)code FiniteElement::set\_dimension(dim)\(\backslash\)endcode }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00704}00704   Here the dimension of the element is defined as the number of }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00705}00705   local coordinates required to parametrise its shape.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00706}00706   (Note that this is not necessarily the same as the spatial dimension}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00707}00707   of the problem -\/-\/ we can have one-\/dimensional \(\backslash\)c FiniteElements }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00708}00708   in 3D space, say.) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00709}00709   -\/ \(\backslash\)b Optional: }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00710}00710   Set the spatial integration scheme by calling the protected member}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00711}00711   function \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00712}00712   FiniteElement::set\_integration\_scheme(\&integration\_scheme) \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00713}00713   -\/ \(\backslash\)b Optional: }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00714}00714   If the spatial dimension (= the number of Eulerian coordinates)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00715}00715   required at all Nodes in the element is different from the spatial}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00716}00716   dimension of the element then set the "{}nodal dimension"{} }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00717}00717   by calling the protected }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00718}00718   member function \(\backslash\)code FiniteElement::set\_nodal\_dimension(dim)\(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00719}00719   For example in shell elements, a two-\/dimensional surface is embedded}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00720}00720   in a three-\/dimensional space, so the elemental dimension is two, but}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00721}00721   the nodal dimension is three.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00722}00722   -\/ \(\backslash\)b Optional: If the Eulerian coordinate (position) is interpolated using}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00723}00723   generalised coordinates, e.g. vector-\/valued shape functions, or}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00724}00724   Hermite-\/type interpolation, set the number of generalised}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00725}00725   coordinates or "{}position types"{}  by using the protected member function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00726}00726   \(\backslash\)code FiniteElement::set\_n\_nodal\_position\_type(n\_position\_type)\(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00727}00727 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00728}00728 -\/ The function that computes the element's (geometric) shape functions}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00729}00729   at specified values of the local coordinates. These shape}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00730}00730   functions are primarily used to implement the mapping between the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00731}00731   element's local coordinates and the global (Eulerian) coordinates.  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00732}00732   The geometric shape functions \(\backslash\)e can be (and often are) also used in }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00733}00733   specific \(\backslash\)c FiniteElements to interpolate the unknown }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00734}00734   function(s) between the nodal values. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00735}00735   \(\backslash\)code FiniteElement::shape(s,psi) \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00736}00736 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00737}00737 It is usually necessary to implement the following additional functions:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00738}00738 -\/ The function that computes the derivatives of the element's shape}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00739}00739   functions with respect to the local coordinates,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00740}00740   \(\backslash\)code FiniteElement::dshape\_local(s,psi,dpsids) \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00741}00741 -\/ The function that specifies the number of Nodes along the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00742}00742   element's 1D "{}edges"{}  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00743}00743   \(\backslash\)code FiniteElement::nnode\_1d() \(\backslash\)endcode }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00744}00744 .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00745}00745 Further member functions and member data may be defined as and when required.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00746}00746 For instance, all specific \(\backslash\)c FiniteElements must store a pointer to an}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00747}00747 (instantiated) spatial integration scheme. It is good practice to}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00748}00748 provide a default integration scheme for each geometric element and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00749}00749 to ensure its instantiation by making it}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00750}00750 a static data member of the geometric element class. This allows the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00751}00751 constructor of the geometric element to set the pointer to the default }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00752}00752 integration scheme. If the default is not appropriate for a }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00753}00753 specific derived \(\backslash\)c FiniteElement, the default assignment}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00754}00754 can be over-\/written in the constructor of the derived class.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00755}00755 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00756}00756 As a concrete example, we consider the implementation of the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00757}00757 one-\/dimensional, two-\/node geometric element, \(\backslash\)c TwoNodeGeometricElement, }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00758}00758 that uses linear shape functions to define the mapping between}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00759}00759 the element's local and global coordinates. The element is derived}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00760}00760 from the \(\backslash\)c FiniteElement base class,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00761}00761 \(\backslash\)dontinclude one\_d\_poisson\_generic\_only.cc}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00762}00762 \(\backslash\)skipline TwoNodeGeometric}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00763}00763  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00764}00764 and it uses a one-\/dimensional, two-\/point Gauss rule}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00765}00765 as the default spatial integration scheme }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00766}00766 \(\backslash\)skipline Integration}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00767}00767 \(\backslash\)until static }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00768}00768 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00769}00769 Here is the implementation of the generic \(\backslash\)c FiniteElement member}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00770}00770 functions for our specific geometric \(\backslash\)c FiniteElement:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00771}00771 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00772}00772 \(\backslash\)subsubsection Geomconst The constructor: TwoNodeGeometricElement()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00773}00773 The constructor sets the number of local nodes in the element (2),}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00774}00774 sets the dimension of the element (1) and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00775}00775 sets the pointer to the spatial integration scheme }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00776}00776 to be the default that is defined and instantiated as a static data}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00777}00777 member of the class: }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00778}00778 \(\backslash\)skipline TwoNodeGeometric}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00779}00779 \(\backslash\)until \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00780}00780 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00781}00781 \(\backslash\)subsubsection shape The function FiniteElement::shape(s,psi)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00782}00782 This function returns the shape functions at the local}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00783}00783 element coordinate, s. The shape functions are used}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00784}00784 to interpolate the position, and also, any data values stored at }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00785}00785 nodes in derived, isoparametric elements.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00786}00786 \(\backslash\)skipline shape(}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00787}00787 \(\backslash\)until \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00788}00788 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00789}00789 \(\backslash\)subsubsection dshape The function FiniteElement::dshape\_local(s,psi,dpsids)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00790}00790 This function returns the shape functions and their derivatives with}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00791}00791 respect to the local coordinates}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00792}00792 \(\backslash\)skipline dshape\_}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00793}00793 \(\backslash\)until \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00794}00794 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00795}00795 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00796}00796 \(\backslash\)subsubsection nnode\_1d The function FiniteElement::nnode\_1d()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00797}00797 Return the number of nodes along the element's 1d "{}edge"{} -\/-\/ for}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00798}00798 a one-\/dimensional element, this is obviously the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00799}00799 same as the number of nodes:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00800}00800 \(\backslash\)skipline nnode\_1d()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00801}00801 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00802}00802 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00803}00803 \(\backslash\)subsection geom\_element\_exercise Exercises:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00804}00804 -\/ Change the \(\backslash\)c TwoNodeGeometricElement to a \(\backslash\)c}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00805}00805   ThreeNodeGeometricElement in which quadratic interpolation}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00806}00806   is used to interpolate the Eulerian coordinates}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00807}00807   between the nodal points. Use this element as a basis}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00808}00808   for a \(\backslash\)c ThreeNodePoissonElement and convince yourself that}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00809}00809   changing the \(\backslash\)c TwoNodePoissonElement }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00810}00810   to a  \(\backslash\)c ThreeNodePoissonElement only requires the change of}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00811}00811   a single line of code!}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00812}00812 -\/ Use templating to generalise the geometric elements to }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00813}00813   an arbitrary number of nodes so that the class}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00814}00814   \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00815}00815   template <unsigned NNODE>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00816}00816   class GeometricLineElement : public FiniteElement}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00817}00817   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00818}00818   represents 1D line elements with \(\backslash\)c NNODE nodes. Consider carefully}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00819}00819   which member functions you can implement in generality and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00820}00820   which member functions require specialised implementations.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00821}00821   Provide the specialised member functions for elements}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00822}00822   with two, three and four nodes.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00823}00823 -\/ Use the templated  \(\backslash\)c GeometricLineElements to implement an equivalent}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00824}00824   generalisation of the \(\backslash\)c TwoNodePoissonElement and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00825}00825   \(\backslash\)c ThreeNodePoissonElement classes to the general class}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00826}00826   \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00827}00827   template <unsigned NNODE>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00828}00828   class PoissonLineElement : public GeometricLineElement<NNODE>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00829}00829   \(\backslash\)endcode }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00830}00830 -\/ Validate all elements against the exact solution and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00831}00831   confirm the theoretical error estimate which predicts that }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00832}00832   if the domain \(\backslash\)f\$ x \(\backslash\)in [0,1]\(\backslash\)f\$ is discretised with \(\backslash\)f\$ N \(\backslash\)f\$}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00833}00833   equally spaced \(\backslash\)f\$n\(\backslash\)f\$-\/node line elements, we have}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00834}00834   \(\backslash\)f[}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00835}00835   e = \(\backslash\)sqrt\{ \(\backslash\)int\_0\string^1 \(\backslash\)left( u\_\{FE\}(x) -\/ u\_\{exact\}(x)  \(\backslash\)right) \string^2 dx \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00836}00836   \(\backslash\)sim h\string^\{(n-\/1)\} \(\backslash\)mbox\{ \(\backslash\) \(\backslash\) \(\backslash\) \(\backslash\) as \$N \(\backslash\)to \(\backslash\)infty\$\}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00837}00837   \(\backslash\)f]       }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00838}00838   where \(\backslash\)f\$ h = 1/N \(\backslash\)f\$.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00839}00839 .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00840}00840 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00841}00841 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00842}00842 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00843}00843 \(\backslash\)section comments Further comments}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00844}00844 We reiterate that the main purpose of this document is to }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00845}00845 provide a \(\backslash\)e quick introduction to \(\backslash\)c oomph-\/lib's fundamental objects.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00846}00846 The exercises have already highlighted several undesirable features}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00847}00847 of the simple example classes which could easily be improved to }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00848}00848 facilitate the (re-\/)use of the classes in different problems. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00849}00849 Here we shall briefly discuss some further modifications that }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00850}00850 we regard as good practice, and which tend to be implemented }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00851}00851 in the existing classes in \(\backslash\)c oomph-\/lib:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00852}00852 -\/ \(\backslash\)ref dim\_independent}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00853}00853 -\/ \(\backslash\)ref pre\_compute\_psi}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00854}00854 -\/ \(\backslash\)ref equation\_classes}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00855}00855 -\/ \(\backslash\)ref paranoia }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00856}00856 -\/ \(\backslash\)ref magic}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00857}00857 -\/ \(\backslash\)ref multi\_physics}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00858}00858 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00859}00859 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00860}00860 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00861}00861 \(\backslash\)subsection dim\_independent Dimension-\/independent implementation}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00862}00862 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00863}00863 The exercises in the section \(\backslash\)ref FEgeom suggest the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00864}00864 use of templating to implement families of objects. This idea}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00865}00865 also permits the implementation of (geometric and specific)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00866}00866 \(\backslash\)c FiniteElements in arbitrary spatial dimensions. For instance,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00867}00867 \(\backslash\)c oomph-\/lib's \(\backslash\)c QElement class represents the family of }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00868}00868 (line/quadrilateral/brick-\/shaped) geometric elements}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00869}00869 with an arbitrary number of nodes along the elements' 1D edges.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00870}00870 Thus, a \(\backslash\)c QElement<1,3> is a three-\/node 1D line element,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00871}00871 a  \(\backslash\)c QElement<3,2> is an eight-\/node 3D brick element, etc.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00872}00872 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00873}00873 These geometric elements naturally form the basis for }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00874}00874 corresponding specific elements, such as the \(\backslash\)c QPoissonElement family}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00875}00875 which provides an isoparametric discretisation of the Poisson}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00876}00876 equation (in an arbitrary spatial dimension), based on the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00877}00877 \(\backslash\)c QElements with the same template parameters.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00878}00878 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00879}00879 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00880}00880 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00881}00881 \(\backslash\)subsection pre\_compute\_psi Using pre-\/computed shape functions and the StorableShapeElement<ELEMENT> class}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00882}00882 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00883}00883  The computation of the element's residual vector and the Jacobian}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00884}00884 matrix requires the evaluation of the element's shape functions,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00885}00885 \(\backslash\)f\$ \(\backslash\)psi\_j \(\backslash\)f\$, and their derivatives with respect to the global}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00886}00886 coordinate, \(\backslash\)f\$ \(\backslash\)mbox\{d\}\(\backslash\)psi\_j/\(\backslash\)mbox\{d\}x \(\backslash\)f\$, at the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00887}00887 element's integration points. In our simple example class, }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00888}00888 \(\backslash\)c TwoNodePoissonElement, we (re-\/)compute these functions}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00889}00889 "{}on the fly"{}, using the function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00890}00890 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00891}00891 FiniteElement::dshape\_eulerian(s,psi,dpsidx)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00892}00892 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00893}00893 where the local coordinate of the integration point is passed}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00894}00894 in the (one-\/dimensional) vector \(\backslash\)c s.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00895}00895 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00896}00896   The re-\/computation is wasteful because:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00897}00897 -\/ The values of the shape functions and their derivatives, evaluated}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00898}00898   at the integration point, are independent of the value of the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00899}00899   \(\backslash\)c Sign variable. Their re-\/computation during the second}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00900}00900   solve could therefore be avoided if we stored their values}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00901}00901   in a suitable container.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00902}00902 -\/ The values of the shape functions at the integration points}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00903}00903   are identical for all elements. Therefore we only need to provide}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00904}00904   storage for the shape function values in a single, representative}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00905}00905   element. The other elements can access the values via pointers.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00906}00906 .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00907}00907 To circumvent these potential inefficiencies, \(\backslash\)c oomph-\/lib }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00908}00908 provides alternative interfaces for various functions that compute}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00909}00909 shape functions and their derivatives:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00910}00910 -\/ Calls to the function }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00911}00911   \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00912}00912   FiniteElement::shape(s,psi)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00913}00913   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00914}00914   which computes the shape function at a given local coordinate, \(\backslash\)c s,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00915}00915   can be replaced by}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00916}00916   \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00917}00917   FiniteElement::shape\_at\_knot(int\_point,psi)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00918}00918   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00919}00919   where the \(\backslash\)c unsigned argument \(\backslash\)c int\_point identifies}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00920}00920   the integration point (as specified by the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00921}00921   element's spatial integration scheme).}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00922}00922  In "{}standard"{} \(\backslash\)c FiniteElements the function }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00923}00923  \(\backslash\)c FiniteElement::shape\_at\_knot(...) simply determines the position}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00924}00924  of the integration point and calls \(\backslash\)c FiniteElement::shape(...) and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00925}00925  so the shape functions are still computed "{}on the fly"{}. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00926}00926  The templated class \(\backslash\)c StorableShapeElement<ELEMENT>, however,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00927}00927   may be used to}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00928}00928  upgrade any class derived from \(\backslash\)c FiniteElement into a class that \(\backslash\)b}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00929}00929  can store the values of the shape functions and their derivatives at}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00930}00930  the integration points. The function \(\backslash\)c shape\_at\_knot(...) is}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00931}00931  overloaded so that when called for the first}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00932}00932  time, it computes the values of the shape function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00933}00933  at all integration points and stores them for future reference.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00934}00934  In subsequent calls, the function returns the stored values, rather }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00935}00935  than re-\/computing them. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00936}00936 -\/ There are equivalent alternatives for the functions that}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00937}00937   compute the shape functions and their derivatives with respect}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00938}00938   to the local coordinates:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00939}00939   \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00940}00940   FiniteElement::dshape(s,psi,dpsids)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00941}00941   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00942}00942   can be replaced by}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00943}00943   \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00944}00944   FiniteElement::dshape\_at\_knot(int\_point,psi,dpsids)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00945}00945   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00946}00946   while}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00947}00947   \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00948}00948   FiniteElement::d2shape(s,psi,dpsids,d2psids)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00949}00949   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00950}00950   can be replaced by}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00951}00951   \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00952}00952   FiniteElement::d2shape\_at\_knot(int\_point,psi,dpsids,d2psids)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00953}00953   \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00954}00954 .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00955}00955 These functions are all overloaded in the \(\backslash\)c}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00956}00956 StorableShapeElement<ELEMENT> class and by default the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00957}00957 overloaded functions store the pre-\/computed values of the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00958}00958 shape functions and their derivatives locally within each element. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00959}00959 This implementation ensures data locality and should increase }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00960}00960 the speed of access to the stored values. However, it}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00961}00961 can also create significant storage overheads. \(\backslash\)c oomph-\/lib }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00962}00962 therefore provides the function }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00963}00963 \(\backslash\)code }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00964}00964 StorableShapeElement<ELEMENT>::set\_shape\_local\_stored\_from\_element(...)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00965}00965 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00966}00966 which frees up the storage in the element and replaces it by }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00967}00967 pointer-\/based access to the values stored in another element.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00968}00968 Typically, all elements in a mesh are of the same type and use}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00969}00969 the same spatial integration scheme and so the values of the shape}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00970}00970 functions need only be stored in one element.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00971}00971 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00972}00972 Derivatives of the element's shape functions with respect to }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00973}00973 the global Eulerian coordinates are generally}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00974}00974 computed by}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00975}00975 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00976}00976 FiniteElement::dshape\_eulerian(s,psi,dpsidx)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00977}00977 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00978}00978 and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00979}00979 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00980}00980 FiniteElement::d2shape\_eulerian(s,psi,dpsidx,d2psidx)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00981}00981 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00982}00982 These functions also return the Jacobian of the mapping between}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00983}00983 the local and global coordinates -\/-\/ the Jacobian can also be}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00984}00984 computed independently from }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00985}00985 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00986}00986 FiniteElement::J\_eulerian(s)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00987}00987 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00988}00988 The derivatives of the shape functions with respect the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00989}00989 global coordinates depend on the nodal positions, and it is not safe}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00990}00990 to assume that they will remain constant. For instance}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00991}00991 in moving boundary problems, the position of the nodes is}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00992}00992 determined as part of the solution. By default, the functions }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00993}00993 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00994}00994 StorableShapeElement<ELEMENT>::dshape\_eulerian\_at\_knot(int\_point,psi,dpsidx)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00995}00995 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00996}00996 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00997}00997 StorableShapeElement<ELEMENT>::d2shape\_eulerian\_at\_knot(int\_point,psi,dpsidx,d2psidx)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00998}00998 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l00999}00999 and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01000}01000 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01001}01001 StorableShapeElement<ELEMENT>::J\_eulerian\_at\_knot(int\_point)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01002}01002 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01003}01003 re-\/compute the derivatives at the specified integration }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01004}01004 point "{}on the fly"{}. If the "{}user"{} is confident}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01005}01005 that in his/her problem, the nodal positions will not change, the values}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01006}01006 can be pre-\/computed by calling }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01007}01007 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01008}01008 StorableShapeElement<ELEMENT>::pre\_compute\_dshape\_eulerian\_at\_knots()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01009}01009 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01010}01010 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01011}01011 StorableShapeElement<ELEMENT>::pre\_compute\_d2shape\_eulerian\_at\_knots()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01012}01012 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01013}01013 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01014}01014 StorableShapeElement<ELEMENT>::pre\_compute\_J\_eulerian\_at\_knots()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01015}01015 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01016}01016 Once these functions have been called, any subsequent calls to }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01017}01017 the \(\backslash\)c *\_eulerian\_at\_knot(...) functions return the stored values.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01018}01018 To revert to the case in which the derivatives are re-\/computed}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01019}01019 "{}on the fly"{}, the storage for the derivatives must be deleted by  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01020}01020 calling }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01021}01021 \(\backslash\)code }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01022}01022 StorableShapeElement<ELEMENT>::delete\_dshape\_eulerian\_stored()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01023}01023 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01024}01024 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01025}01025 \(\backslash\)b Notes: }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01026}01026 -\/ In the (unlikely!) case that an element's spatial integration}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01027}01027   scheme is changed during the code execution, all stored}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01028}01028   values are automatically re-\/computed.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01029}01029 -\/ The class }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01030}01030   \(\backslash\)c StorableShapeSolidElement<ELEMENT> provides equivalent overloaded}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01031}01031   functions for derivatives}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01032}01032   with respect to the element's Lagrangian coordinates that are used in solid}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01033}01033   mechanics problems. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01034}01034 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01035}01035 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01036}01036 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01037}01037 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01038}01038 \(\backslash\)subsection equation\_classes Further sub-\/division of specific element classes -\/-\/ equation classes.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01039}01039 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01040}01040 We suggested that any newly developed elements should be constructed}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01041}01041 in a three-\/level hierarchy, \(\backslash\)c FiniteElement -\/-\/ Geometric Element -\/-\/}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01042}01042 Specific \(\backslash\)c FiniteElement. Most finite elements in \(\backslash\)c oomph-\/lib}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01043}01043 incorporate an additional intermediate "{}equation class"{} which implements the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01044}01044 computation of the element residual vector and the element Jacobian}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01045}01045 matrix in terms of abstract shape and test functions, defined}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01046}01046 as pure virtual functions in the "{}equation class"{}. This makes it}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01047}01047 easy to change the specific element formulation, without having to}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01048}01048 re-\/implement the weak form of the governing equation. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01049}01049 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01050}01050 Note that different element types may store the same physical variable at}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01051}01051 different locations. For example, the pressure in the Navier-\/-\/Stokes}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01052}01052 equations may be stored as internal \(\backslash\)c Data (discontinuous) or nodal}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01053}01053 \(\backslash\)c Data}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01054}01054 (continuous). Particular equation classes may require }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01055}01055 internal numbering schemes that store the appropriate }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01056}01056 local equation numbers for each physical variable. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01057}01057 These schemes must be assembled for each specific element in}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01058}01058 the function }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01059}01059 \(\backslash\)c GeneralisedElement::assign\_additional\_local\_eqn\_numbers(), which is called}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01060}01060 from within \(\backslash\)c Problem::assign\_eqn\_numbers(). }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01061}01061 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01062}01062   As an example, consider the weak form of the 2D advection diffusion}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01063}01063 equation}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01064}01064 \(\backslash\)f[}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01065}01065 \(\backslash\)int \(\backslash\)left(\(\backslash\)mbox\{Pe\} \(\backslash\) \(\backslash\)sum\_\{i=1\}\string^2 w\_i \(\backslash\)frac\{\(\backslash\)partial u\}\{\(\backslash\)partial x\_i\} \(\backslash\)psi\string^\{(test)\}\_l  + }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01066}01066 \(\backslash\)sum\_\{i=1\}\string^2 \(\backslash\)frac\{\(\backslash\)partial u\}\{\(\backslash\)partial x\_i\}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01067}01067              \(\backslash\)frac\{\(\backslash\)partial \(\backslash\)psi\string^\{(test)\}\_l\}\{\(\backslash\)partial x\_i\} \(\backslash\)right) dA}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01068}01068              = 0,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01069}01069 \(\backslash\)f]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01070}01070 where the Peclet number, \(\backslash\)f\$ Pe \(\backslash\)f\$ , and the "{}wind"{} \(\backslash\)f\$w\_i \(\backslash\) (i=1,2)\(\backslash\)f\$}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01071}01071 are given. We expand the unknown function \(\backslash\)f\$u(x\_1,x\_2)\(\backslash\)f\$ in terms of }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01072}01072 the (global) basis functions  \(\backslash\)f\$ \(\backslash\)psi\string^\{(basis)\}\_k(x\_1,x\_2), \(\backslash\) (k=1,...,N)\(\backslash\)f\$,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01073}01073 \(\backslash\)f[}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01074}01074 u(x\_1,x\_2) = \(\backslash\)sum\_\{k=1\}\string^N U\_k \(\backslash\) \(\backslash\)psi\string^\{(basis)\}\_k(x\_1,x\_2),}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01075}01075 \(\backslash\)f]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01076}01076 where \(\backslash\)f\$N\(\backslash\)f\$ is the total number of nodes in the mesh. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01077}01077 The mapping between the element's local and global coordinates}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01078}01078 is represented in terms of the local shape functions}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01079}01079 \(\backslash\)f\$\(\backslash\)psi\string^\{(shape)\}\_j(s\_1,s\_2)\(\backslash\)f\$ as}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01080}01080 \(\backslash\)f[}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01081}01081 x\_i = \(\backslash\)sum\_\{j=1\}\string^n X\_\{ij\} \(\backslash\) \(\backslash\)psi\string^\{(shape)\}\_j(s\_1,s\_2)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01082}01082 \(\backslash\)f]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01083}01083 where \(\backslash\)f\$ n \(\backslash\)f\$ is the number of nodes in the element. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01084}01084 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01085}01085  The following sketch illustrates how  this discretisation}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01086}01086 is implemented in \(\backslash\)c oomph-\/lib's \(\backslash\)c QAdvectionDiffusionElement -\/-\/}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01087}01087 an isoparametric, quadrilateral element, based on the Galerkin}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01088}01088 discretisation of the weak form with}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01089}01089 \(\backslash\)f\$ \(\backslash\)psi\string^\{(shape)\}\_j =   \(\backslash\)psi\string^\{(test)\}\_j =   \(\backslash\)psi\string^\{(basis)\}\_j \(\backslash\)f\$}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01090}01090 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01091}01091 \(\backslash\)image html advection\_diffusion\_element\_inheritance.gif "{}Typical inheritance diagram for oomph-\/lib elements "{} }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01092}01092 \(\backslash\)image latex advection\_diffusion\_element\_inheritance.eps "{}Typical inheritance diagram for oomph-\/lib elements "{} width=0.75\(\backslash\)textwidth}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01093}01093 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01094}01094 At large Peclet number, the Galerkin discretisation of the advection}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01095}01095 diffusion equation is well-\/known to  produce spurious "{}wiggles"{} in the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01096}01096 solution. These can be suppressed by SUPG stabilisation which }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01097}01097 employs test functions,  \(\backslash\)f\$ \(\backslash\)psi\_j\string^\{(test)\}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01098}01098 \(\backslash\)f\$, that differ from the basis function, \(\backslash\)f\$ \(\backslash\)psi\_j\string^\{(basis)\} \(\backslash\)f\$,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01099}01099 \(\backslash\)f[}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01100}01100 \(\backslash\)psi\_j\string^\{(test)\} = \(\backslash\)psi\_j\string^\{(basis)\} + }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01101}01101 \(\backslash\)tau\string^\{(SUPG)\} \(\backslash\)sum\_\{i=1\}\string^2 w\_i \(\backslash\)frac\{\(\backslash\)partial}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01102}01102 \(\backslash\)psi\_j\string^\{(basis)\}\}\{\(\backslash\)partial x\_i\},}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01103}01103 \(\backslash\)f]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01104}01104 where \(\backslash\)f\$ \(\backslash\)tau\string^\{(SUPG)\} \(\backslash\)f\$ is a stabilisation parameter.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01105}01105 This can be implemented with a trivial change to the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01106}01106 \(\backslash\)c QAdvectionDiffusionElement class -\/-\/ the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01107}01107 \(\backslash\)c QSUPGAdvectionDiffusionElement simply provides a different}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01108}01108 implementation of the test functions.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01109}01109 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01110}01110 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01111}01111 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01112}01112 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01113}01113 \(\backslash\)subsection paranoia Implement extensive (but optional) self tests in all classes}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01114}01114 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01115}01115 We have already illustrated the use of \(\backslash\)c oomph-\/lib's generic \(\backslash\)c self\_test()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01116}01116 functions. The top-\/level \(\backslash\)c Problem::self\_test() function }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01117}01117 performs a systematic test of all fundamental objects}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01118}01118 involved in a specific problem and can be used to diagnose}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01119}01119 any problems. It is good practise to implement }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01120}01120 further \(\backslash\)c self\_test() functions in any newly developed classes.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01121}01121 The generic \(\backslash\)c self\_test() functions are defined to be virtual}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01122}01122 functions in \(\backslash\)c oomph-\/lib's fundamental objects and can}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01123}01123 be overloaded. Obviously, the \(\backslash\)c self\_test() function in a}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01124}01124 specific derived object should still call the \(\backslash\)c self\_test()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01125}01125 function of the underlying fundamental object. The }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01126}01126 \(\backslash\)c TwoNodePoissonElement::self\_test() function, listed in}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01127}01127 in the section \(\backslash\)ref FEequations illustrates the procedure. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01128}01128 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01129}01129   While frequent sanity checks are helpful during code-\/development,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01130}01130 they can introduce significant overheads into the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01131}01131 code execution. \(\backslash\)c oomph-\/lib therefore provides a compiler flag PARANOID,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01132}01132 which allows the execution of sanity checks to be switched on}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01133}01133 or off. When developing new classes, sanity checks should}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01134}01134 be implemented to catch any potential problems, but the relevant}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01135}01135 code should be surrounded by <CODE>ifdef/endif</CODE> statements to allow}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01136}01136 the tests to be disabled. Here is an example:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01137}01137 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01138}01138 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01139}01139  \#include <typeinfo>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01140}01140 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01141}01141   [...]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01142}01142 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01143}01143   // Recast to a different pointer type}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01144}01144   SomeOtherObject* other\_pt=dynamic\_cast<SomeOtherObject*>(some\_pt);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01145}01145 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01146}01146  \#ifdef PARANOID}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01147}01147   if (other\_pt==0)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01148}01148    \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01149}01149    std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01150}01150      error\_stream << "{}Failed to cast some\_pt to SomeOtherObject* "{}  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01151}01151                   << std::endl;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01152}01152      error\_stream << "{}The pointer some\_pt points to an object of type: "{} <<}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01153}01153                   << typeid(some\_pt).name() << std::endl; }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01154}01154      throw OomphLibError(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01155}01155                          OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01156}01156                          OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01157}01157     \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01158}01158  \#endif }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01159}01159 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01160}01160 [...]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01161}01161 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01162}01162 \(\backslash\)endcode }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01163}01163 Note that we throw a specific \(\backslash\)c OomphLibError object after catching }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01164}01164 the error -\/-\/ this allows the provision of more explicit (and hopefully more}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01165}01165 meaningful) error messages.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01166}01166 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01167}01167    Many access functions that provide indexed access to}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01168}01168 a private container, do, in fact, access a private STL vector.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01169}01169 Explicit range checking for these (frequent!) cases can be avoided}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01170}01170 by changing the container to \(\backslash\)c oomph-\/lib's \(\backslash\)c Vector class. The }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01171}01171 \(\backslash\)c Vector class}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01172}01172 performs automatic range checking, if \(\backslash\)c oomph-\/lib's \(\backslash\)c generic library is compiled}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01173}01173 with the \(\backslash\)c RANGE\_CHECKING flag set (i.e. if}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01174}01174 \(\backslash\)c -\/DRANGE\_CHECKING is specified as a compilation flag for the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01175}01175 C++ compiler). For access functions that do not use the \(\backslash\)c Vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01176}01176 class you should implement your own range checks using the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01177}01177 RANGE\_CHECKING compiler flag.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01178}01178 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01179}01179 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01180}01180 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01181}01181 \(\backslash\)subsection magic The use of "{}magic numbers"{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01182}01182 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01183}01183  In general, we set the equation number to -\/1 to indicate }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01184}01184 that a nodal value is }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01185}01185 pinned, i.e. prescribed by boundary conditions. This convention is used}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01186}01186 throughout \(\backslash\)c oomph-\/lib, but the direct use of -\/1 as a (bad!) "{}magic number"{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01187}01187 is generally avoided. Instead we refer to the static data member of }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01188}01188 the \(\backslash\)c Data class}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01189}01189 \(\backslash\)code static long Data::Is\_pinned \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01190}01190 which is (of course) set to -\/1. Similarly, when nodes are created,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01191}01191 the equation numbers of their value(s) are initialised to a value of -\/10,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01192}01192 represented by the static data member }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01193}01193 \(\backslash\)code static int Data::Is\_unclassified \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01194}01194 This allows the function \(\backslash\)c Problem::self\_test() to check if}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01195}01195 any values have not been classified as pinned or free.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01196}01196 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01197}01197 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01198}01198 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01199}01199 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01200}01200 \(\backslash\)subsection multi\_physics Facilitating the use of specific elements in multi-\/physics problems}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01201}01201 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01202}01202 As the name of the library suggests, \(\backslash\)c oomph-\/lib's existing}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01203}01203 "{}single-\/physics"{} elements are (and any newly designed ones should be) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01204}01204 designed so that they can easily be used in multi-\/physics problems. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01205}01205 We anticipate two types of multi-\/physics interactions:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01206}01206 -\/ The solution of one system of equations affects the geometry of }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01207}01207   the domain in which another equation is solved -\/-\/ this }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01208}01208   occurs, for instance, in fluid-\/structure interaction problems.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01209}01209 -\/ Two physical phenomena occur in the same domain and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01210}01210   interact with each other, so that forcing terms in one}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01211}01211   equation depend on the solution of another -\/-\/ this occurs, for}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01212}01212   instance, in thermo-\/elasticity problems where the temperature}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01213}01213   distribution (determined by the solution of an unsteady heat}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01214}01214   equation, say) affects the "{}growth term"{} in the equations of}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01215}01215   elasticity. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01216}01216 .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01217}01217 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01218}01218  Multi-\/physics elements for such problems are usually implemented by combining}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01219}01219 two (or more) single-\/physics elements via multiple inheritance. The combined, }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01220}01220 multi-\/physics element will obviously have a larger number of degrees}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01221}01221 of freedom than the constituent single-\/physics elements. The combined element}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01222}01222 typically calls the \(\backslash\)c get\_residuals(...) function of the two }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01223}01223 constituent elements and concatenates their residual vectors. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01224}01224 When computing the Jacobian matrix, the "{}single physics"{} elements }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01225}01225 provide the diagonal blocks for the Jacobian matrix of the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01226}01226 multi-\/physics element, while the off-\/diagonal interaction blocks must }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01227}01227 be computed separately. The details of the implementation vary}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01228}01228 from problem to problem. However, any single-\/physics element }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01229}01229 must satisfy the following requirements if it is to be used}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01230}01230 as a base class for derived multi-\/physics elements: }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01231}01231 -\/ \(\backslash\)ref dont\_wipe }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01232}01232 -\/ \(\backslash\)ref virtual }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01233}01233 -\/ \(\backslash\)ref index\_fcts }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01234}01234 -\/ \(\backslash\)ref mesh\_movement }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01235}01235 .}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01236}01236 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01237}01237 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01238}01238 <HR>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01239}01239 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01240}01240 \(\backslash\)subsubsection dont\_wipe Rule 1: Elements must only initialise their own entries in the element residual vector and the element Jacobian matrix}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01241}01241 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01242}01242 The computation of the element residual vector and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01243}01243 the element Jacobian matrix typically involves a loop over the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01244}01244 element's integration points, in which each integration point adds}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01245}01245 a further contribution to the entries. In multi-\/physics problems}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01246}01246 it is crucial that the initialisation of the residual vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01247}01247 and the Jacobian matrix only sets  the element's "{}own"{} entries to zero. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01248}01248 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01249}01249 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01250}01250 To illustrate this point, consider what would happen if we used }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01251}01251 the \(\backslash\)c TwoNodePoissonElement::get\_jacobian(...) function,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01252}01252 discussed in the section \(\backslash\)ref jac, in a derived multi-\/physics element,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01253}01253 which combines the  \(\backslash\)c TwoNodePoissonElement with another}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01254}01254 element,  \(\backslash\)c TwoNodeSomeOtherEquationElement, say. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01255}01255 Assume that we implement the function \(\backslash\)c get\_jacobian(...) of the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01256}01256 combined element so that it first calls the function \(\backslash\)c}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01257}01257 TwoNodeSomeOtherEquationElement::get\_jacobian(...) to determine}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01258}01258 the first diagonal block in the combined Jacobian matrix.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01259}01259 When we call  \(\backslash\)c TwoNodePoissonElement::get\_jacobian(...)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01260}01260 to compute the entries in the second diagonal block,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01261}01261 the initialisation loop}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01262}01262 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01263}01263 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01264}01264 //Find the number of degrees of freedom (unpinned values) in the element}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01265}01265  unsigned n\_dof = ndof();}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01266}01266 //Initialise all entries of the Jacobian matrix to zero}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01267}01267 for(unsigned i=0;i<n\_dof;i++) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01268}01268  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01269}01269   for(unsigned j=0;j<n\_dof;j++) \{jacobian(i,j) = 0.0;\}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01270}01270  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01271}01271 \(\backslash\)endcode }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01272}01272 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01273}01273 would initialise the \(\backslash\)e entire Jacobian matrix, thus wiping out}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01274}01274 the entries that were already computed by  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01275}01275 \(\backslash\)c TwoNodeSomeOtherEquationElement::get\_jacobian(...).}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01276}01276 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01277}01277  The strategy used in \(\backslash\)c oomph-\/lib to permit the easy combination of}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01278}01278  elements is to use the two protected member functions of the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01279}01279  \(\backslash\)c GeneralisedElement class:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01280}01280 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01281}01281 virtual void GeneralisedElement::fill\_in\_contribution\_to\_residuals(Vector<double>\&residuals);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01282}01282 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01283}01283 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01284}01284 and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01285}01285 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01286}01286 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01287}01287 virtual void GeneralisedElement::fill\_in\_contribution\_to\_jacobian(Vector<double> \&residuals,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01288}01288                                                                   DenseMatrix<double> \&jacobian); }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01289}01289 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01290}01290 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01291}01291  These functions DO NOT initialise the entries of the residuals vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01292}01292  or the Jacobian matrix. Instead, the functions merely add the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01293}01293  appropriate contributions to the vector and the matrix entries. The}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01294}01294  default version of}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01295}01295  the \(\backslash\)c get\_residuals() and \(\backslash\)c get\_jacobian() functions, defined in}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01296}01296  \(\backslash\)c GeneralisedElement, are simple}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01297}01297  wrappers that initialise the residuals and Jacobian to zero and then}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01298}01298  call the appropriate \(\backslash\)c fill\_in\_contribution... function.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01299}01299 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01300}01300   virtual void GeneralisedElement::get\_residuals(Vector<double> \&residuals) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01301}01301   \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01302}01302    //Zero the residuals vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01303}01303    residuals.initialise(0.0);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01304}01304 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01305}01305    //Add the elemental contribution to the residuals vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01306}01306    fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01307}01307   \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01308}01308 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01309}01309   virtual void GeneralisedElement::get\_jacobian(Vector<double> \&residuals, }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01310}01310                                                 DenseMatrix<double> \&jacobian) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01311}01311   \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01312}01312    //Zero the residuals vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01313}01313    residuals.initialise(0.0);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01314}01314 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01315}01315    //Zero the Jacobian matrix}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01316}01316    jacobian.initialise(0.0);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01317}01317 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01318}01318    //Add the elemental contribution to the residuals vector and Jacobian}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01319}01319    fill\_in\_contribution\_to\_jacobian(residuals,jacobian);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01320}01320   \} }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01321}01321 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01322}01322 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01323}01323  The \(\backslash\)c get\_residuals function, for example, can thus be overloaded }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01324}01324  in a multi-\/physics element, as follows:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01325}01325 \(\backslash\)code }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01326}01326 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01327}01327 \textcolor{comment}{ /// Multi-\/physics element, created by multiple inheritance}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01328}01328 \textcolor{comment}{} class SomeMultiPhysicsElement : public virtual TwoNodePoissonElement,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01329}01329                                  public virtual TwoNodeSomeOtherEquationElement}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01330}01330  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01331}01331 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01332}01332   [...]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01333}01333 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01334}01334 \textcolor{comment}{  /// Residual vector of the combined element is made from the entries}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01335}01335 \textcolor{comment}{  /// of the constituent single-\/physics elements}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01336}01336 \textcolor{comment}{}  virtual void get\_residuals(Vector<double> \&residuals) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01337}01337    \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01338}01338     //Zero the residuals vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01339}01339     residuals.initialise(0.0);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01340}01340 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01341}01341    //Add the first elemental contribution to the residuals vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01342}01342    TwoNodePoissonElement::fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01343}01343 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01344}01344     //Add the second elemental contribution to the residuals vector}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01345}01345     TwoNodeSomeOtherEquationElement::fill\_in\_contribution\_to\_residuals(residuals);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01346}01346    \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01347}01347 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01348}01348 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01349}01349    [...]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01350}01350 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01351}01351   \};}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01352}01352  }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01353}01353 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01354}01354 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01355}01355  It is, therefore, recommended that authors of "{}single-\/physics"{}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01356}01356  elements, overload \(\backslash\)c fill\_in\_contribution\_to\_residuals(...) and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01357}01357  \(\backslash\)c fill\_in\_contribution\_to\_jacobian(...), rather than \(\backslash\)c}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01358}01358  get\_residuals() and \(\backslash\)c get\_jacobian(...), respectively. A further}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01359}01359  advantage of the implementation is that the author need not}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01360}01360  worry about initialisation of the residuals vector or the Jacobian }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01361}01361  matrix when using the \(\backslash\)c "{}fill\_in\_"{} rather than the \(\backslash\)c "{}get\_"{} functions.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01362}01362 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01363}01363 \(\backslash\)subsubsection virtual Rule 2: Forcing functions, etc. should be implemented as  uniquely-\/named virtual functions}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01364}01364 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01365}01365 To allow for an interaction between multiple equations, any}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01366}01366 forcing functions (such as the source function in the Poisson}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01367}01367 equation) should be implemented as virtual functions. This allows}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01368}01368 them to be overloaded in derived, multi-\/physics elements where the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01369}01369 forcing function in one equation might depend on the unknowns in}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01370}01370 another one.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01371}01371 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01372}01372 Furthermore, to avoid clashes of function names that may occur when two}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01373}01373 single-\/physics elements are combined, member functions that can }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01374}01374 be expected to have counterparts in the context of other equations should }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01375}01375 be given suitable modifiers. For instance, }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01376}01376 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01377}01377 AdvectionDiffusionEquation::source\_fct\_adv\_diff(...)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01378}01378 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01379}01379 is a better name for a member function that returns the source function}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01380}01380 in the advection-\/diffusion equations than}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01381}01381 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01382}01382 AdvectionDiffusionEquation::source\_fct(...)}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01383}01383 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01384}01384 since many other equations are likely to have source functions, too. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01385}01385 It is obviously impossible to completely avoid such clashes but}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01386}01386 this strategy makes them less likely to occur. We are fairly confident}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01387}01387 that the relevant member functions of all existing elements }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01388}01388 in \(\backslash\)c oomph-\/lib have been given suitable modifiers  to avoid}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01389}01389 clashes of this type. Therefore, you should be able to combine any}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01390}01390 element with any other element in the library. If you find a counter-\/example }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01391}01391  <A HREF="{}../../contact/html/index.html"{}>let us know</A>, and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01392}01392 we will rectify this in the next release. In the meantime}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01393}01393 exploit the fact that \(\backslash\)c oomph-\/lib is an open source library; you can}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01394}01394 change anything you want!}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01395}01395 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01396}01396 \(\backslash\)subsubsection index\_fcts Rule 3: Nodal values should only be accessed indirectly via index functions that can be overloaded in derived multi-\/physics elements}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01397}01397 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01398}01398 When implementing the single-\/physics \(\backslash\)c TwoNodePoissonElement,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01399}01399 discussed above, we provided an access function \(\backslash\)c u(n) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01400}01400 that returns the (single) nodal value, stored at the element's}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01401}01401 \(\backslash\)c n -\/th \(\backslash\)c Node. The function was implemented as a simple wrapper }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01402}01402 that followed the pointer to the element's \(\backslash\)c n -\/th \(\backslash\)c Node and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01403}01403 returned the zero-\/th nodal value stored at that \(\backslash\)c Node:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01404}01404 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01405}01405 double TwoNodePoissonElement::u(const unsigned \&n) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01406}01406  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01407}01407   return node\_pt(n)-\/>value(0);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01408}01408  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01409}01409 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01410}01410 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01411}01411 In a single-\/physics context, this implementation is perfectly}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01412}01412 acceptable since we know \(\backslash\)e a \(\backslash\)e priori that in a scalar problem}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01413}01413 each \(\backslash\)c Node only stores a single value. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01414}01414 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01415}01415 The same logic suggests that a \(\backslash\)c TwoNodeAdvectionDiffusionElement}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01416}01416 would have a member function }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01417}01417 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01418}01418 double TwoNodeAdvectionDiffusionElement::u(const unsigned \&n) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01419}01419  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01420}01420   return node\_pt(n)-\/>value(0);}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01421}01421  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01422}01422 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01423}01423 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01424}01424 However, merging these two elements via multiple inheritance}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01425}01425 creates two problems. First we have clash of names which could}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01426}01426 have been avoided by following rule 2 above and calling the two functions}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01427}01427 \(\backslash\)c TwoNodePoissonElement::u\_poisson(...) and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01428}01428 \(\backslash\)c TwoNodeAdvectionDiffusionElement::u\_adv\_diff(...), say.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01429}01429 More serious is that both elements regard the zero-\/th nodal value}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01430}01430 as "{}their own"{}. This can (and should!) be avoided}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01431}01431 by the following re-\/implementation:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01432}01432 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01433}01433 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01434}01434 double TwoNodePoissonElement::u(const unsigned \&n) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01435}01435  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01436}01436   return node\_pt(n)-\/>value(u\_index\_poisson());}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01437}01437  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01438}01438 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01439}01439 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01440}01440 where the virtual function \(\backslash\)c u\_index\_poisson() provides the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01441}01441 default index at which the Poisson nodal values are stored in a }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01442}01442 single-\/physics context:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01443}01443 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01444}01444 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01445}01445 virtual unsigned TwoNodePoissonElement::u\_index\_poisson()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01446}01446  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01447}01447   // By default (i.e. in a single-\/physics context) the Poisson }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01448}01448   // value is stored at the zero-\/th nodal value:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01449}01449   return 0;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01450}01450  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01451}01451 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01452}01452 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01453}01453 The advection-\/diffusion element can be modified in the same way:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01454}01454 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01455}01455 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01456}01456 double TwoNodeAdvectionDiffusionElement::u(const unsigned \&n) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01457}01457  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01458}01458   return node\_pt(n)-\/>value(u\_index\_adv\_diff());}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01459}01459  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01460}01460 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01461}01461 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01462}01462 with}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01463}01463 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01464}01464 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01465}01465 virtual unsigned TwoNodeAdvectionDiffusionElement::u\_index\_adv\_diff()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01466}01466  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01467}01467   // By default (i.e. in a single-\/physics context) the advection-\/diffusion}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01468}01468   // value is stored at the zero-\/th nodal value:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01469}01469   return 0;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01470}01470  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01471}01471 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01472}01472 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01473}01473 In a combined multi-\/physics problem, we can now merge the two elements by}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01474}01474 multiple inheritance,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01475}01475 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01476}01476 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01477}01477 class TwoNodeAdvDiffAndPoissonElement : }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01478}01478        public virtual TwoNodePoissonElement,}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01479}01479        public virtual TwoNodeAdvectionDiffusionElement}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01480}01480 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01481}01481 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01482}01482 Name clashes are already avoided, so we only have to  overwrite the two index }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01483}01483 functions to indicate which (scalar) value is stored as which }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01484}01484 nodal value:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01485}01485 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01486}01486 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01487}01487 unsigned TwoNodeAdvDiffAndPoissonElement::u\_index\_adv\_diff()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01488}01488  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01489}01489   // In the combined multi-\/physics element we continue to store the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01490}01490   // advection-\/diffusion value at the zero-\/th nodal value}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01491}01491   // [as a result it is not actually necessary to re-\/implement this}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01492}01492   // function!]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01493}01493   return 0;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01494}01494  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01495}01495 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01496}01496 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01497}01497 and }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01498}01498 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01499}01499 \(\backslash\)code}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01500}01500 unsigned TwoNodeAdvDiffAndPoissonElement::u\_index\_poisson()}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01501}01501  \{}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01502}01502   // In the combined multi-\/physics element we store the Poisson}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01503}01503   // value at the first nodal value:}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01504}01504   return 1;}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01505}01505  \}}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01506}01506 \(\backslash\)endcode}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01507}01507 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01508}01508 Specific examples that illustrate the creation of (non-\/trivial) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01509}01509 multi-\/physics elements by multiple inheritance are provided}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01510}01510 in the <A HREF="{}../../example\_code\_list/html/index.html\#multi"{}>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01511}01511 list of example codes.</A>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01512}01512 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01513}01513 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01514}01514 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01515}01515 \(\backslash\)subsubsection mesh\_movement Rule 4: Time derivatives should be implemented in the ALE formulation to allow for moving meshes. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01516}01516 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01517}01517 In moving mesh problems, the time-\/derivative of a nodal value }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01518}01518 (approximated by the Node's \(\backslash\)c TimeStepper) is not the same as}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01519}01519 the Eulerian time-\/derivative \(\backslash\)f\$ \(\backslash\)partial/ \(\backslash\)partial t \(\backslash\)f\$}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01520}01520 that "{}usually"{} occurs in the governing equation.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01521}01521 The former represents the rate of change when following the }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01522}01522 moving node; the latter is the rate of change evaluated at a fixed }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01523}01523 Eulerian position.  The two time-\/derivatives are related to each other}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01524}01524 via the ALE relation}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01525}01525 \(\backslash\)f[}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01526}01526 \(\backslash\)left. \(\backslash\)frac\{\(\backslash\)partial (.)\}\{\(\backslash\)partial t\} \(\backslash\)right|\_\{Eulerian\} }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01527}01527 = \(\backslash\)left. \(\backslash\)frac\{\(\backslash\)partial (.) \}\{\(\backslash\)partial t\} \(\backslash\)right|\_\{at \(\backslash\) node\} -\/ \(\backslash\) }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01528}01528 \(\backslash\)sum\_\{i=1\}\string^D v\_i\string^\{(Mesh)\} \(\backslash\)  \(\backslash\)frac\{\(\backslash\)partial (.) \}\{ \(\backslash\)partial x\_i\} }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01529}01529 \(\backslash\)f]}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01530}01530 where \(\backslash\)f\$ D \(\backslash\)f\$ is the spatial dimension of the problem and}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01531}01531 \(\backslash\)f\$ v\_i\string^\{(Mesh)\}  \(\backslash\) (i=1,...,D) \(\backslash\)f\$ is the velocity of the node. }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01532}01532 Any Eulerian time-\/derivatives in the governing equation should}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01533}01533 be implemented in the above form to ensure that the}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01534}01534 element remains functional in moving mesh problems.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01535}01535 See the <A HREF="{}../../unsteady\_heat/two\_d\_unsteady\_heat\_ALE/html/index.html"{}>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01536}01536 example describing the solution of the unsteady heat equation in a}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01537}01537 moving domain</A> for further details.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01538}01538 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01539}01539 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01540}01540 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01541}01541 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01542}01542 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01543}01543 }
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01544}01544 <hr>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01545}01545 <hr>}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01546}01546 \(\backslash\)section pdf PDF file}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01547}01547 A <a href="{}../latex/refman.pdf"{}>pdf version</a> of this document is available.}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01548}01548 **/}
\DoxyCodeLine{\Hypertarget{quick__guide_8txt__doxygenified_8h_source_l01549}01549 }

\end{DoxyCode}

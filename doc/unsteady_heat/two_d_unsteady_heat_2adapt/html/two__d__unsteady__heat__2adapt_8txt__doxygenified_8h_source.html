<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: two_d_unsteady_heat_2adapt.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">two_d_unsteady_heat_2adapt.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="two__d__unsteady__heat__2adapt_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: Spatially and temporally adaptive solution of the 2D unsteady heat equation with flux boundary conditions in a moving domain.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This is the final and most complex problem in our series of</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">demo codes for the unsteady heat equation. We re-visit the</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">moving domain problem considered in the </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">&lt;A HREF=&quot;../../two_d_unsteady_heat_ALE/html/index.html&quot;&gt; previous</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">example &lt;/A&gt; and solve it with a \e combination of spatial and</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">temporal adaptivity. </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">&lt;B&gt;The two-dimensional unsteady heat equation with flux boundary</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">conditions in a moving domain.&lt;/B&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">\sum_{i=1}^2\frac{\partial^2 u}{\partial x_i^2} </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">= \frac{\partial u}{\partial t} + f\left(x_1,x_2,t\right),</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">in the domain \f$ D \f$, bounded by the coordinate axes</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">and the time-dependent ellipse</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">\mathbf{r}_{ellipse}(\xi,t) = </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">\left( \begin{array}{c}</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> \right),</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">subject to Neumann boundary conditions,</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">g_0, </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">along the horizontal domain boundary \f$ \partial D_{Neumann} = </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">\{ (x_1,x_2) | x_1 \in [0,1], x_2=0 \} \f$, and to Dirichlet </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">boundary conditions,</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\left. u\right|_{\partial D_{Dirichlet}}=h_0, </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">elsewhere.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\image html domain.gif &quot;Sketch of the time-dependent domain and the boundary conditions. &quot; </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">\image latex domain.eps &quot;Sketch of the time-dependent domain and the boundary conditions. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">The initial conditions are given by</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">u(x_1,x_2,t=0)=k_0(x_1,x_2),</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (5)</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">where the functions \f$ f, g_0, \ h_0\f$ and  \f$ k_0\f$ are given. </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">We choose the functions \f$ f, g_0, \ h_0\f$ and  \f$ k_0\f$ </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">so that</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">u_0(x_1,x_2,t) = \tanh\bigg[1-\alpha\bigg(\tan\Phi</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">\big(x_1-\beta\tanh[ \gamma\cos\left(2\pi</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">t\right)]\big)- x_2\bigg)\bigg]</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (6)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">is the exact solution.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">The solution represents the &quot;usual&quot; tanh profile, whose steepness</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">is controlled by the parameter \f$ \alpha \f$ so that for \f$ \alpha</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">\gg 1 \f$ the solution approaches a step. The step is oriented</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">at an angle \f$ \Phi \f$ against the \f$ x_1-\f$-axis and its position varies</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">periodically. The parameter \f$ \beta \f$ controls the amplitude</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">of the step&#39;s lateral displacement, while \f$ \gamma \f$ determines the</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">rate at which its position changes. For \f$ \gamma \gg 1\f$,</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">the step remains stationary for most of the period and then</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">translates rapidly parallel to the \f$ x_1-\f$-axis, making this a very </span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">challenging problem.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">\section comb Background: Combined spatial and temporal adaptivity</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">When  &lt;A HREF=&quot;../../two_d_unsteady_heat_ALE/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">solving the above problem with pure spatial adaptivity,&lt;/A&gt; we</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">observed that the error of the computed solution increased noticeably </span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">during phases when the &quot;step&quot; moved rapidly through the</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">domain, suggesting that the error is due to the temporal rather</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">than the spatial discretisation. If you attempted the exercises suggested</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">at the end of that demo problem, you will have confirmed this by</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">observing that the error is reduced when the time-integration is performed</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">with a smaller timestep. Since the solution only undergoes rapid</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">changes during short periods of time, the use of temporal adaptivity </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">is highly desirable. Before demonstrating that the combined use</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">of temporal and spatial adaptivity only requires trivial changes to </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">the driver code with purely spatial adaptivity, we </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">briefly comment on the strategy employed by \c oomph-lib&#39;s</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">doubly-adaptive unsteady Newton solver</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">doubly_adaptive_unsteady_newton_solve(dt,epsilon_t,max_adapt,first)</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">This Newton solver performs the spatial and temporal </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">adaptations sequentially, as follows:</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">-# Given a mesh and the solution on that mesh at time \f$ t \f$, we first</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">   advance the solution to time \f$ t + dt\f$, adjusting the timestep</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">   \f$ dt \f$ until the global temporal error norm computed by</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">   \c Problem::global_temporal_error_norm() falls below the target</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">   error specified by the (\c double) argument \c epsilon_t. The</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">   (\c double) argument \c dt, specifies the suggestion for the timestep.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">-# Once a temporally accurate solution has been computed on that</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">   mesh, we perform up to \c max_adapt spatial adaptations to reduce</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">   the spatial error. We re-compute the solution on the adapted</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">   meshes, using the (fixed)</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">   timestep selected previously by the temporal adaptation. Once the spatial </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">   adaptations are complete, we could, in principle, re-evaluate</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">   the temporal error and, if required, re-compute the timestep yet</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">   again -- at a significant additional cost. We omit this further adjustment</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">   and accept the solution &quot;as is&quot;.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">As before, the boolean argument \c first indicates</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">if the first timestep is being computed (see the  </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">&lt;A HREF=&quot;../../two_d_unsteady_heat_adapt/html/index.html&quot;&gt;example</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">without temporal adaptivity&lt;/A&gt; for more information on this important</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">issue). As in the </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> &lt;A HREF=&quot;../../two_d_unsteady_heat_t_adapt/html/index.html&quot;&gt;case of pure </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">temporal adaptivity&lt;/A&gt;, the adaptive unsteady Newton solver </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">returns a suggestion for the size of the next timestep. </span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\section impl The implementation</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">Since the spatial and temporal adaptations are performed independently,</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">adding &quot;double adaptivity&quot; to the existing </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">&lt;A HREF=&quot;../../two_d_unsteady_heat_ALE/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">driver code with pure spatial adaptivity&lt;/A&gt; only requires the</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">implementation of the additional</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">member function \c Problem::global_temporal_error_norm().</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">In the current problem we can use the one that we created for </span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">the  &lt;A HREF=&quot;../../two_d_unsteady_heat_t_adapt/html/index.html&quot;&gt;example with pure temporal adaptivity&lt;/A&gt;. Furthermore, we </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">pass a true boolean flag to the constructor of the \c BDF&lt;2&gt; </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">timestepper, to make it adaptive.  That&#39;s all! Apart from</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">a few (optional) improvements to the dump/restart functions (discussed below),</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/unsteady_heat/two_d_unsteady_heat_2adapt/two_d_unsteady_heat_2adapt.cc&quot;&gt;the</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">code&lt;/A&gt; does not require any other changes. </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">\section reslt Some results</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">The figure below shows a snapshot of the &lt;A HREF=&quot;../figures/step_soln.avi&quot;&gt;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">animated solution&lt;/A&gt;, obtained from the doubly adaptive simulation.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">\image html step_soln.gif &quot;Snapshot of the solution. &quot; </span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">\image latex step_soln.eps &quot;Snapshot of the solution. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">When viewing the  &lt;A HREF=&quot;../figures/step_soln.avi&quot;&gt;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">animation of the solution&lt;/A&gt;, note how the time-bar grows much more rapidly</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">during phases when the solution only changes slowly, reflecting</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">the larger timestep used during these phases. </span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">The time-traces shown below compare the exact and computed solutions,</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">and document the variations in timestep and the norm of the error</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">throughout the simulation, for a temporal error target of \c</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">epsilon_t = \f$ 10^{-2}. \f$ The plots show clearly how the adaptive </span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">timestepper selects a much larger timestep during the phases when </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">the solution only changes slowly. However, the error during phases </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">of rapid change is still relatively large -- the comparison</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">between the exact and computed solution shows that the two are not</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">graphically indistinguishable. We ought to do better!</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">\image html trace.gif &quot;Time trace of the solution, the error and the timestep chosen by the adaptive timestepper for a temporal error target of 1E-2. &quot; </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">\image latex trace.eps &quot;Time trace of the solution, the error and the timestep chosen by the adaptive timestepper for a temporal error target of 1E-2. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">The time-traces below show the results from a second simulation with a</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">smaller target error of \c epsilon_t = \f$ 10^{-3} \f$. The exact </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">and computed solutions are now graphically indistinguishable and the</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">error has been reduced significantly -- at the cost of having to take</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">much smaller timesteps throughout the simulation. Without adaptive </span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">time-stepping, this simulation would become \e very expensive as </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">timesteps as small as \f$ dt = 2 \times 10^{-4}\f$ are required to </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">properly resolve the solution during the phases of rapid change. </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">\image html trace_target1e-3.gif &quot;Time trace of the solution, the error and the timestep chosen by the adaptive timestepper for a temporal error target of 1E-3. &quot; </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">\image latex trace_target1e-3.eps &quot;Time trace of the solution, the error and the timestep chosen by the adaptive timestepper for a temporal error target of 1E-3. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">\section comments Comments and Exercises</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">\subsection cust Customising the dump/restart procedure</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">In two earlier examples, we commented on two undesirable features of the</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">default dump/restart procedures: </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">- The restart files do not record the counter (stored in a</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">  \c DocInfo object) that we typically use to label the output files.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">  Therefore the output files produced in the restarted run start </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">  with label &quot;0&quot;, making it difficult to merge the data files from the </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">  original and restarted simulations.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">- In an adaptive simulation, the restart files do not record the adaptive</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">  timestepper&#39;s suggestion for the next timestep, therefore the</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">  first timestep in the restarted simulation </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">  is performed with the timestep that was used when the </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  solution was dumped to disk, leading to slight differences</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">  in the history of the timesteps chosen; see the plot shown at the end of</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">  the discussion of the </span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../two_d_unsteady_heat_t_adapt/html/index.html&quot;&gt; </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">  example with purely temporal adaptivity. &lt;/A&gt;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">To address these problems, we modified the \c Problem class </span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">for the present example slightly: We added the \c DocInfo object </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">which stores the label for the output file to the \c Problem&#39;s private</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">member data, and provide storage for the size of the next timestep</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">suggested by the adaptive timestepper.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_2adapt.cc     </span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">\skipline private:</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">\until double Next_dt;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">[We also provide a public access function, \c double \c next_dt(), </span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">to the suggested next timestep; see \ref no_pub .]</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">We initialise the output label in the \c Problem constructor,</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_2adapt.cc     </span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">\until number()=0;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">and set \c Next_dt to the initial timestep when the </span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">initial condition is assigned in \c set_initial_condition():</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_2adapt.cc     </span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">\skipline Choose initial timestep</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">\until Next_dt</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">We modify the timestepping loop so that the adaptive timestepper&#39;s</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">suggestion for the next timestep is stored in the \c Problem&#39;s</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">private data member \c Next_dt, which is accessible via</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">the public member function \c next_dt():</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_2adapt.cc     </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">\skipline Timestepping loop</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">Since the \c Problem now has access to the \c DocInfo object (and</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">therefore to the label that we use to identify the output files), and </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">to the suggested next timestep, we write both to the</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">restart file, adding brief comments behind the &quot;raw&quot; data.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_2adapt.cc     </span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">\skipline start_of_dump_it</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">\until end of dump_it</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">These values are then read during the restart:</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_2adapt.cc     </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">\skipline start_of_restart</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">\until end of restart</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">[The slightly clumsy read procedure is required to ensure that</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">the comments that follow the &quot;raw&quot; data are ignored.]</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">Following the assignment of the initial conditions, the first</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">timestep for the timestepping loop in the \c main function </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">can now be obtained from \c next_dt() since \c Next_dt will either</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">have been set to the actual first timestep used when setting up</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">the initial conditions at time \f$ t=0\f$, or to the next</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">timestep that had been suggested by the adaptive timestepper when the restart</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">file was created. </span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">Here are the time-traces for the solution and the timesteps from the</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">original and the restarted simulations -- apart from the (very small) </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">roundoff errors due to the finite precision in which all data is</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">recorded in the restart files, they are now in perfect agreement.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">\image html restart_trace.gif &quot;Time-traces of the solution and the timestep for the original (green) and restarted (red) simulations with the customised dump/restart procedure. &quot; </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">\image latex restart_trace.eps &quot;Time-traces of the solution and the timestep for the original (green) and restarted (red) simulations with the customised dump/restart procedure. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">\subsection no_pub Do NOT use public member data in any classes</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">A little aside: Yes, we really do recommend storing the suggestion for the</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">size of the next timestep as private member data and providing </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">an access function to it. This must seem like (and indeed is) slight </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">overkill in the present context: Why can&#39;t we just store it as</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">public member data and avoid having to write the access function?</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">The answer is: Because public data is bad and it&#39;s a good habit</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">to avoid it as a matter of principle -- even in trivial examples.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/unsteady_heat/two_d_unsteady_heat_2adapt/&quot;&gt;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">demo_drivers/unsteady_heat/two_d_unsteady_heat_2adapt/</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">- The driver code is:</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/unsteady_heat/two_d_unsteady_heat_2adapt/two_d_unsteady_heat_2adapt.cc&quot;&gt;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">demo_drivers/unsteady_heat/two_d_unsteady_heat_2adapt/two_d_unsteady_heat_2adapt.cc</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_ae60b76ed8f7a8a77f2e7ee1748832f59"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#ae60b76ed8f7a8a77f2e7ee1748832f59">meshes</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem&lt; HR &gt;&lt; HR &gt; section comb&lt;/A &gt; we observed that the error of the computed solution increased noticeably during phases when the step moved rapidly through the suggesting that the error is due to the temporal rather than the spatial discretisation If you attempted the exercises suggested at the end of that demo you will have confirmed this by observing that the error is reduced when the time integration is performed with a smaller timestep Since the solution only undergoes rapid changes during short periods of the use of temporal adaptivity is highly desirable Before demonstrating that the combined use of temporal and spatial adaptivity only requires trivial changes to the driver code with purely spatial we briefly comment on the strategy employed by c oomph lib s doubly adaptive unsteady Newton solver code as we first advance the solution to time f t dt adjusting the timestep f dt f until the global temporal error norm computed by c specifies the suggestion for the timestep we perform up to c max_adapt spatial adaptations to reduce the spatial error We re compute the solution on the adapted meshes</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00120">two_d_unsteady_heat_2adapt.txt:120</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_ad724132cd4dc36ddb2f0ee00eac00f50"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#ad724132cd4dc36ddb2f0ee00eac00f50">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00021">two_d_unsteady_heat_2adapt.txt:21</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_aa9bfac6e8f4abd7e98fcfdcfb37cd212"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#aa9bfac6e8f4abd7e98fcfdcfb37cd212">axis</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f axis</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00080">two_d_unsteady_heat_2adapt.txt:80</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a33fad790560ed582b3fb898d4ec1067d"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a33fad790560ed582b3fb898d4ec1067d">HREF</a></div><div class="ttdeci">&quot;../../two_d_unsteady_heat_adapt/html/index.html&quot;&gt;example without temporal adaptivity&lt;/A &gt; for more information on this important issue). As in the&lt; A HREF=&quot;../../two_d_unsteady_heat_t_adapt/html/index.html&quot;&gt;case of pure temporal adaptivity&lt;/A &gt;, the adaptive unsteady Newton solver returns a suggestion for the size of the next timestep.&lt; HR &gt;&lt; HR &gt; \section impl The implementation Since the spatial and temporal adaptations are performed independently, adding &quot;double adaptivity&quot; to the existing&lt; A HREF=&quot;../../two_d_unsteady_heat_ALE/html/index.html&quot;&gt; driver code with pure spatial adaptivity&lt;/A &gt; only requires the implementation of the additional member function \c Problem::global_temporal_error_norm(). In the current problem we can use the one that we created for the&lt; A HREF=&quot;../../two_d_unsteady_heat_t_adapt/html/index.html&quot;&gt;example with pure temporal adaptivity&lt;/A &gt;. Furthermore, we pass a true boolean flag to the constructor of the \c BDF&lt; 2 &gt; timestepper, to make it adaptive. That 's all! Apart from a few(optional) improvements to the dump/restart functions(discussed below),&lt; A HREF=&quot;../../../../demo_drivers/unsteady_heat/two_d_unsteady_heat_2adapt/two_d_unsteady_heat_2adapt.cc&quot;&gt;the code&lt;/A &gt; does not require any other changes.&lt; HR &gt;&lt; HR &gt; \section reslt Some results The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated solution&lt;/A &gt;, obtained from the doubly adaptive simulation. @I w 0.75\textwidth step_soln &quot;Snapshot of the solution. &quot; When viewing the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animation of the solution&lt;/A &gt;, note how the time-bar grows much more rapidly during phases when the solution only changes slowly, reflecting the larger timestep used during these phases. The time-traces shown below compare the exact and computed solutions, and document the variations in timestep and the norm of the error throughout the simulation, for a temporal error target of \c epsilon_t=\f$ 10^{-2}. \f$ The plots show clearly how the adaptive timestepper selects a much larger timestep during the phases when the solution only changes slowly. However, the error during phases of rapid change is still relatively large -- the comparison between the exact and computed solution shows that the two are not graphically indistinguishable. We ought to do better! @I w 0.75\textwidth trace &quot;Time trace of the solution, the error and the timestep chosen by the adaptive timestepper for a temporal error target of 1E-2. &quot; The time-traces below show the results from a second simulation with a smaller target error of \c epsilon_t=\f$ 10^{-3} \f$. The exact and computed solutions are now graphically indistinguishable and the error has been reduced significantly -- at the cost of having to take much smaller timesteps throughout the simulation. Without adaptive time-stepping, this simulation would become \e very expensive as timesteps as small as \f$ dt=2 \times 10^{-4}\f$ are required to properly resolve the solution during the phases of rapid change. @I w 0.75\textwidth trace_target1e-3 &quot;Time trace of the solution, the error and the timestep chosen by the adaptive timestepper for a temporal error target of 1E-3. &quot;&lt; HR &gt;&lt; HR &gt; \section comments Comments and Exercises \subsection cust Customising the dump/restart procedure In two earlier examples, we commented on two undesirable features of the default dump/restart procedures:- The restart files do not record the counter(stored in a \c DocInfo object) that we typically use to label the output files. Therefore the output files produced in the restarted run start with label &quot;0&quot;, making it difficult to merge the data files from the original and restarted simulations. - In an adaptive simulation, the restart files do not record the adaptive timestepper 's suggestion for the next timestep, therefore the first timestep in the restarted simulation is performed with the timestep that was used when the solution was dumped to disk, leading to slight differences in the history of the timesteps chosen HREF</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00213">two_d_unsteady_heat_2adapt.txt:213</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_ab668da37b3c4eb0d63c888be07b855af"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#ab668da37b3c4eb0d63c888be07b855af">D_</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial D_</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00042">two_d_unsteady_heat_2adapt.txt:42</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a86126d9f359414c3f3080f8057707720"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a86126d9f359414c3f3080f8057707720">constructor</a></div><div class="ttdeci">We initialise the output label in the c Problem constructor</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00219">two_d_unsteady_heat_2adapt.txt:219</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a9765f7db51ced56cf3bfc8cf49610fe9"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a9765f7db51ced56cf3bfc8cf49610fe9">mesh</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem&lt; HR &gt;&lt; HR &gt; section comb&lt;/A &gt; we observed that the error of the computed solution increased noticeably during phases when the step moved rapidly through the suggesting that the error is due to the temporal rather than the spatial discretisation If you attempted the exercises suggested at the end of that demo you will have confirmed this by observing that the error is reduced when the time integration is performed with a smaller timestep Since the solution only undergoes rapid changes during short periods of the use of temporal adaptivity is highly desirable Before demonstrating that the combined use of temporal and spatial adaptivity only requires trivial changes to the driver code with purely spatial we briefly comment on the strategy employed by c oomph lib s doubly adaptive unsteady Newton solver code as we first advance the solution to time f t dt adjusting the timestep f dt f until the global temporal error norm computed by c specifies the suggestion for the timestep mesh</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00118">two_d_unsteady_heat_2adapt.txt:118</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a6ba9238572e01f028a73086f7961115c"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a6ba9238572e01f028a73086f7961115c">conditions</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary conditions</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00035">two_d_unsteady_heat_2adapt.txt:35</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_aa22034e038f07c7e249ad69406112ea2"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#aa22034e038f07c7e249ad69406112ea2">time</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem&lt; HR &gt;&lt; HR &gt; section comb&lt;/A &gt; we observed that the error of the computed solution increased noticeably during phases when the step moved rapidly through the suggesting that the error is due to the temporal rather than the spatial discretisation If you attempted the exercises suggested at the end of that demo you will have confirmed this by observing that the error is reduced when the time integration is performed with a smaller timestep Since the solution only undergoes rapid changes during short periods of time</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00098">two_d_unsteady_heat_2adapt.txt:98</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a5ae5ca8f94856d3369541bb4bce9f49e"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a5ae5ca8f94856d3369541bb4bce9f49e">profile</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh profile</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00072">two_d_unsteady_heat_2adapt.txt:72</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_ab33cabe1cb837fef21dec97203e39931"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#ab33cabe1cb837fef21dec97203e39931">number</a></div><div class="ttdeci">We initialise the output label in the c Problem dontinclude two_d_unsteady_heat_2adapt cc skipline start_of_constructor until number()=0</div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_adc710e2cd42f86966973a17b74708edc"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#adc710e2cd42f86966973a17b74708edc">doubly_adaptive_unsteady_newton_solve</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem&lt; HR &gt;&lt; HR &gt; section comb&lt;/A &gt; we observed that the error of the computed solution increased noticeably during phases when the step moved rapidly through the suggesting that the error is due to the temporal rather than the spatial discretisation If you attempted the exercises suggested at the end of that demo you will have confirmed this by observing that the error is reduced when the time integration is performed with a smaller timestep Since the solution only undergoes rapid changes during short periods of the use of temporal adaptivity is highly desirable Before demonstrating that the combined use of temporal and spatial adaptivity only requires trivial changes to the driver code with purely spatial we briefly comment on the strategy employed by c oomph lib s doubly adaptive unsteady Newton solver code doubly_adaptive_unsteady_newton_solve(dt, epsilon_t, max_adapt, first) \endcode This Newton solver performs the spatial and temporal adaptations sequentially</div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8cc_source.html#l01054">two_d_unsteady_heat_2adapt.cc:1054</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a3346ca6572f0a692ba50fed07425ebee"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a3346ca6572f0a692ba50fed07425ebee">x_2</a></div><div class="ttdeci">mainpage Example x_2</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00021">two_d_unsteady_heat_2adapt.txt:21</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_aa692256d151410a96ce740173bb29d54"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#aa692256d151410a96ce740173bb29d54">f</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D f</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00024">two_d_unsteady_heat_2adapt.txt:24</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_afd8ea5d38fad56a1c7577d2f0c1008f5"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#afd8ea5d38fad56a1c7577d2f0c1008f5">g_0</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f g_0</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00056">two_d_unsteady_heat_2adapt.txt:56</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a20ad21fb38f0c6d92db41aca9c3a95b0"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a20ad21fb38f0c6d92db41aca9c3a95b0">domain</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem&lt; HR &gt;&lt; HR &gt; section comb&lt;/A &gt; we observed that the error of the computed solution increased noticeably during phases when the step moved rapidly through the domain</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00093">two_d_unsteady_heat_2adapt.txt:93</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a3fe57b5473efd5df8b399d22c38f21b8"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a3fe57b5473efd5df8b399d22c38f21b8">right</a></div><div class="ttdeci">mainpage Example t right</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00021">two_d_unsteady_heat_2adapt.txt:21</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a0a072d895053e5dac85e1764a5a567db"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a0a072d895053e5dac85e1764a5a567db">follows</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem&lt; HR &gt;&lt; HR &gt; section comb&lt;/A &gt; we observed that the error of the computed solution increased noticeably during phases when the step moved rapidly through the suggesting that the error is due to the temporal rather than the spatial discretisation If you attempted the exercises suggested at the end of that demo you will have confirmed this by observing that the error is reduced when the time integration is performed with a smaller timestep Since the solution only undergoes rapid changes during short periods of the use of temporal adaptivity is highly desirable Before demonstrating that the combined use of temporal and spatial adaptivity only requires trivial changes to the driver code with purely spatial we briefly comment on the strategy employed by c oomph lib s doubly adaptive unsteady Newton solver code as follows</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00111">two_d_unsteady_heat_2adapt.txt:111</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_aee3cf9e15aa753b8cf03b5e0f1163a63"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#aee3cf9e15aa753b8cf03b5e0f1163a63">problems</a></div><div class="ttdeci">see the plot shown at the end of the discussion of the&lt; A HREF=&quot;../../two_d_unsteady_heat_t_adapt/html/index.html&quot;&gt; example with purely temporal adaptivity&lt;/A &gt; To address these problems</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00219">two_d_unsteady_heat_2adapt.txt:219</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__2adapt_8txt_html_a803ff4ff8fd23c355e472d893ee347f3"><div class="ttname"><a href="two__d__unsteady__heat__2adapt_8txt.html#a803ff4ff8fd23c355e472d893ee347f3">adaptivity</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T})\big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T})\big) \sin(\xi)\end{array} \right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem&lt; HR &gt;&lt; HR &gt; section comb&lt;/A &gt; we observed that the error of the computed solution increased noticeably during phases when the step moved rapidly through the suggesting that the error is due to the temporal rather than the spatial discretisation If you attempted the exercises suggested at the end of that demo you will have confirmed this by observing that the error is reduced when the time integration is performed with a smaller timestep Since the solution only undergoes rapid changes during short periods of the use of temporal adaptivity is highly desirable Before demonstrating that the combined use of temporal and spatial adaptivity only requires trivial changes to the driver code with purely spatial adaptivity</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__2adapt_8txt_source.html#l00101">two_d_unsteady_heat_2adapt.txt:101</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Tue Jul 27 2021 11:11:11
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: two_d_unsteady_heat.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">two_d_unsteady_heat.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="two__d__unsteady__heat_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: Solution of the 2D unsteady heat equation.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This is our first time-dependent example problem. We will demonstrate</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">that, compared to the solution of steady problems, the solution of </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">time-dependent problems only requires a few additional steps:</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">- The creation of a suitable \c TimeStepper object and its addition </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">  to the \c Problem&#39;s list of timesteppers. (\c Problems may </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  employ multiple \c TimeSteppers -- a key requirement for the simulation</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">  of multiphysics problems.)</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">- The initialisation of the timestep, \c dt.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">- Setting the initial conditions by assigning suitable values for</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">  the \c Data objects&#39; &quot;history values&quot; and the \c Nodes&#39; &quot;positional</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">  history values&quot;.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">- Optionally: (Re-)implementing the empty virtual functions</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">  \c Problem::actions_before_implicit_timestep() and </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">  \c Problem::actions_after_implicit_timestep(), e.g. to update time-dependent</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">  boundary conditions before each timestep.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">Once these steps have been performed, \c oomph-lib&#39;s unsteady Newton</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">solver, \c Problem::unsteady_newton_solve(...), may be called to advance </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">the solution from its state at time \f$ t \f$ to its new state at</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> \f$ t \ + \f$ \c dt.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">\section example The example problem</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">We will illustrate the basic timestepping procedures by considering</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">the solution of the 2D unsteady heat equation in a square domain:</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">&lt;B&gt;The two-dimensional unsteady heat equation in a square domain.&lt;/B&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\sum_{i=1}^2\frac{\partial^2 u}{\partial x_i^2} </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">= \frac{\partial u}{\partial t} + f\left(x_1,x_2,t\right),</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">in the square domain \f$ D = \{x_i \in [0,1]; i=1,2 \} \f$,</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">subject to the Dirichlet boundary conditions</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">\left. u\right|_{\partial D}=g_0</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">and initial conditions</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">u(x_1,x_2,t=0)=h_0(x_1,x_2),</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">where the functions \f$ g_0 \f$ and  \f$ h_0 \f$ are given.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">Here we consider the unforced case, \f$ f=0 \f$, and choose boundary</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">and initial conditions that are consistent with the exact solution</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">u_0(x_1,x_2,t) = e^{-Kt}\sin\left( \sqrt{K} \left( x_1 \cos \Phi + x_2 \sin</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\Phi\right)\right),</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">where \f$ K \f$ and \f$ \Phi \f$ are constants, controlling the</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">decay rate of the solution and its spatial orientation, respectively.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">The figure below shows a plot of computed and exact solutions at</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">time \f$ t = 0.01 \f$ (for an animation  </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">&lt;A HREF=&quot;../figures/unsteady_heat_soln.avi&quot;&gt; click</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">here&lt;/A&gt;). </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">\image html unsteady_heat_soln.gif &quot;Plot of the exact and computed solutions. &quot; </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">\image latex unsteady_heat_soln.eps &quot;Plot of the exact and computed solutions. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">\image html trace.gif &quot;Time evolution of the computed and exact solutions at a control node, the global error norm and the norm of the solution. &quot; </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">\image latex trace.eps &quot;Time evolution of the computed and exact solutions at a control node, the global error norm and the norm of the solution. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">\section namespace Global parameters and functions</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">As usual, we store the problem parameters in a namespace. </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat.cc</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">\skipline start_of_ExactSolnForUnsteadyHeat</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\until end of ExactSolnForUnsteadyHeat</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">We start by building the \c Problem object, create a \c  DocInfo</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">object to label the output files, and open a trace file in which we</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">will record the time evolution of the solution and the error. </span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">We choose the length \c t_max of the simulation and </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">the (constant) timestep, \c dt.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">\until dt=</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">Before using any of \c oomph-lib&#39;s timestepping functions, </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">the timestep \c dt \b must be passed to the \c Problem&#39;s</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">timestepping routines by calling the function</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">\c Problem::initialise_dt(...) which sets the weights for </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">all timesteppers in the problem.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">Next we assign the initial conditions by calling </span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">\c set_initial_condition(), to be discussed in more detail below,</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">and document the initial conditions. </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">\skipline Initialise</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">\until number()++</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">Finally, we execute the timestepping loop and document the computed</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">solutions. </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">\skipline Find number</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">In this loop, each call to the unsteady Newton solver, </span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">\c Problem::unsteady_newton_solve(...), advances the solution</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">from its current state, at time \f$ t = \f$ \c Problem::time_pt()-&gt;time(),</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">to \f$ t \ + \f$ \c dt. The unsteady Newton solver automatically</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">&quot;shifts&quot; the history values &quot;backwards&quot; and advances the</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">value of the continuous time. </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\section problem The problem class </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">The \c Problem classes for time-dependent problems are very similar </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">to those for steady problems. The most important </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">additional member functions are \c Problem::actions_before_implicit_timestep()</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">and  \c Problem::actions_after_implicit_timestep() (both defined as empty</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">virtual functions in the \c Problem base class) and </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">\c set_initial_condition(). The functions </span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">\c Problem::actions_before_implicit_timestep() and  \c Problem::actions_after_implicit_timestep()</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">are called automatically by \c oomph-lib&#39;s unsteady Newton solver</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">\c Problem::unsteady_newton_solve() and may be used to update any</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">time-dependent boundary conditions before the Newton solve, or to perform</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">any postprocessing steps after a timestep has been completed. </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">Here we only use the first of these two functions. </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">We note that the (self-explanatory) function \c</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">set_initial_condition() overwrites an empty virtual function </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">in the \c Problem base class. While the assignment of initial </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">conditions could, in principle, be performed by any other function, </span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">e.g. the \c Problem constructor, we strongly recommend using</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">this function to facilitate the extension to spatial </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">adaptivity. (In spatially adaptive computations of time-dependent</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">problems, a standard interface for the re-assignment of </span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">initial conditions following mesh adaptations is required; we will</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">discuss this aspect in  </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">another example&lt;/A&gt;).</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">Finally, the private member data \c Control_node_pt provides</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">storage for a pointer to a control \c Node  at which we shall </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">document the evolution of the solution. </span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat.cc</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">\until end of problem class</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">\section constructor The problem constructor</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">We start by constructing the \c TimeStepper, the second-order accurate</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">\c BDF&lt;2&gt; timestepper from the \c BDF family, and pass a pointer to it</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">to the \c Problem, using the member function</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">\c Problem::add_time_stepper_pt(...).</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">As the name of this function indicates, \c oomph-lib can operate with</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">multiple timesteppers -- an essential feature in multi-physics</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">problems. (For instance, in fluid-structure interaction-problems</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">timestepping for the solid equations might be performed with a</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">timestepper from the \c Newmark family, while a \c BDF timestepper</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">might be used for the Navier--Stokes equations.)</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">When called for the first time, the function  </span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">\c Problem::add_time_stepper_pt(...) creates the</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">\c Problem&#39;s \c Time object (accessible via \c Problem::time_pt())</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">with sufficient storage for the history of previous </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">timesteps. This is required if the timestep is adjusted during the </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">simulation, e.g. when an adaptive timestepper is used. </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">(If further \c TimeSteppers which require more storage are added </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">subsequently, \c Problem::add_time_stepper(...) updates the amount of </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">storage in the \c Problem&#39;s \c Time object accordingly).</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat.cc</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">\until add_time_stepper_pt</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">Next we set the problem parameters and build the mesh, passing the</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">pointer to the \c TimeStepper as the \e last argument to the mesh</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">constructor.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">\skipline Setup parameters for exact solution</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">\until mesh_pt()</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">The position of the pointer to the timestepper in the list of</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">arguments to the mesh constructor reflects another \c oomph-lib</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">convention:</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">\anchor conv_mesh_const</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">&lt;CENTER&gt;&lt;B&gt;A general convention&lt;/B&gt;&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">Recall that all \c Data objects store a pointer to a \c TimeStepper</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">that translates their &quot;history values&quot; into approximations of</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">the values&#39; time derivatives. The required number of &quot;history values&quot; </span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">depends on the specific timestepper. For instance, </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">a BDF&lt;1&gt; timestepper (the backward Euler scheme) requires storage</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">of the solution at the previous timestep; the BDF&lt;2&gt; timestepper computes</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">an approximation of the time-derivative, based on the solution at two</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">previous timesteps, etc. </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">\c Nodes (which \e are \c Data!) are typically built by the \c Mesh</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">constructor using the \c FiniteElement&#39;s member function</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">\c FiniteElement::construct_node(...). This function takes</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">a pointer to the timestepper from which the required amount of storage</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">for the &quot;history values&quot; is extracted. To facilitate the (re-)use of</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">meshes in steady and time-dependent problems, we adopt the convention </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">that</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">&lt;TD WIDTH=500 bgcolor=&quot;pink&quot;&gt;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">The final argument of all mesh</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">constructors should be the pointer to a \c TimeStepper which </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">defaults to \c &amp;Mesh::Default_TimeStepper -- a (static) instantiation</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">of \c oomph-lib&#39;s dummy steady timestepper, \c Steady. </span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">This convention allows the use of meshes in steady problems</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">without having to (artificially) create a timestepper. </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">The following code fragment illustrates the implementation</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">of this approach in a mesh constructor:</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">//=======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/// Some mesh class</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span>//=======================================================================</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;template &lt;class ELEMENT&gt;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;class SomeMesh : public virtual Mesh</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;public:</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">  /// \short Constructor: Pass number of elements and pointer to timestepper.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">  /// Note that the timestepper defaults to the Steady default timestepper.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span>  SomeMesh(const unsigned&amp; n_element, TimeStepper* time_stepper_pt=</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;           &amp;Mesh::Default_TimeStepper)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;     [...]</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     // Allocate storage for all n_element elements in the mesh</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     Element_pt.resize(n_element); </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;     // Create first element and store it (in its incarnation as        </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     // a GeneralisedElement) in the Mesh&#39;s Element_pt[] array</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;     Element_pt[0] = new ELEMENT;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;     // Create the element&#39;s first node and store it in the</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;     // Mesh&#39;s Node_pt[] array. [The member function</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;     // Mesh::finite_element_pt(...) recasts the pointer to the</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;     // GeneralisedElement to a pointer to a FiniteElement -- only      </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;     // FiniteElements have a member function construct_node(...)]</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;     Node_pt[0] = finite_element_pt(0)-&gt;construct_node(0,time_stepper_pt);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;     [...]</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;[...]</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;};</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;\endcode</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;Next, we apply the boundary conditions, pinning the values</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;at all boundary nodes.</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;\skipline Set the boundary</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;\until end of set boundary conditions </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;Finally, we loop over the elements and pass the pointer to the source</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;function.</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;\skipline Complete the build of all elements so they are fully</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;\until end of constructor</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;\section before_timestep Actions before (implicit) timestep</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;We overload the (empty) virtual function </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;\c Problem::actions_before_implicit_timestep() to update the time-dependent</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;boundary conditions (2), using the current </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;value of the continuous time from the \c Problem&#39;s \c Time object.</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;\skipline start of actions_before_implicit_timestep</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;\until end of actions_before_implicit_timestep</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;\section IC Set initial condition</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;Before starting a time-dependent simulation, </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;the current and history values of all \c Data objects must be </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;initialised. In a \c BDF timestepping scheme, the history values</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;represent the solution at previous discrete timesteps. In the</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;present problem (where the exact solution is known -- admittedly,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;a somewhat artificial situation) we can therefore assign the history</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;values by looping over the previous timesteps</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;and setting the history values with \c Data::set_value(...).</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  \b Important: \c oomph-lib&#39;s \c UnsteadyHeatEquations are based on the</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;Arbitrary-Lagrangian-Eulerian (ALE) formulation of the unsteady </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;heat equation to permit computations in moving domains; we will </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;illustrate this capability in  </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;&lt;A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat_ALE/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;another example. &lt;/a&gt;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;In such problems, the nodal positions may </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;vary as a function of time. In the present problem, the computation </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;is performed in a fixed domain, therefore we initialise the previous </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;nodal positions with their current values, accessed via</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;the member function \c Node::x(t,i) which returns (a reference to) </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;the \c i -th nodal coordinate at previous timestep \c t.</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;&lt;TABLE&gt;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;&lt;TR&gt;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;\anchor conv_t_arg</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;&lt;CENTER&gt;&lt;B&gt;A general convention&lt;/B&gt;&lt;/CENTER&gt; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;Many functions in \c oomph-lib have steady and time-dependent</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;versions which usually differ in their first argument. Typically,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;the first argument of the time-dependent function is an </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;additional (unsigned) integer, \c t, </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;say. As a general convention, the time-dependent versions return</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;values (or perform actions) that are appropriate for the current </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;time if called with \c t=0, and return values (or perform actions) that are </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;appropriate for previous time levels if the argument is set to \c</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;t&gt;0. Note that we refer</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;to previous time levels, rather than previous timesteps, because  history</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;values do not necessarily represent values at previous timesteps,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;as they do for \c BDF schemes. For instance, in \c Newmark</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;timestepping schemes, the history values include approximations of</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;the first and second time-derivatives at the previous timestep. </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;\anchor conv_hist_vals</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;&lt;CENTER&gt;&lt;B&gt;Another general convention&lt;/B&gt;&lt;/CENTER&gt; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;While, in general, not all &quot;history values&quot; represent</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;the solution at previous timesteps, the &quot;history values&quot;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;that do, should be (and, for any existing \c TimeSteppers, are) </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;listed before those that represent other quantities.</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;The number of history values required/used by a \c TimeStepper</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;may be obtained from its member function</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;\code</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;TimeStepper::nprev_values()</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;\endcode</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;As an example, \c BDF&lt;4&gt;::nprev_values() returns 4. </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;The total number of history values (including the current value!)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;is returned by</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;\code</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;TimeStepper::ntstorage()</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;\endcode</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;As an example, \c BDF&lt;4&gt;::ntstorage() returns 5.</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;&lt;/TD&gt;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;&lt;/TR&gt;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;&lt;/TABLE&gt;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;Here is the source code for the \c  set_initial_condition() function:</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;\skipline start_of_set_initial_condition</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;\until end of set_initial_condition  </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;&lt;HR&gt; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;\section doc Post-processing</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;As in many previous examples, this member function outputs </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;the computed solution, the exact solution and the error. </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;We augment the solution data by tecplot text and geometries</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;to facilitate the visualisation and record the time evolution of</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;the solution and the error in the trace file.</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;\skipline start_of_doc_solution</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;\until end of doc_solution</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;\section comments Comments and Exercises</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;The current example only illustrates the most basic timestepping procedures.</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;In subsequent examples we will demonstrate </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;\c oomph-lib&#39;s  </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;&lt;A HREF=&quot;../../two_d_unsteady_heat2/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;dump and restart functions,&lt;/A&gt; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;&lt;A HREF=&quot;../../two_d_unsteady_heat_t_adapt/html/index.html&quot;&gt;the use of adaptive</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;timestepping,&lt;/A&gt; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;&lt;A HREF=&quot;../../two_d_unsteady_heat_adapt/html/index.html&quot;&gt;the use of spatial</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;adaptivity,&lt;/A&gt; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;&lt;A HREF=&quot;../../two_d_unsteady_heat_ALE/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;computations in moving domains,&lt;/A&gt; and </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;&lt;A HREF=&quot;../../two_d_unsteady_heat_2adapt/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;the combination of temporal and spatial adaptivity&lt;/A&gt;.</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;We stress that setting the initial conditions in a &quot;real&quot; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;problem often presents a delicate step, especially if </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;higher-order timesteppers from the BDF family</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;are used. This is because in the absence of a known exact solution,</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;the initial condition (3) only provides enough </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;information to determine a single &quot;history value&quot; at each node -- the </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;value at the initial time. \c oomph-lib&#39;s timestepping procedures </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;provide several functions that allow the simulation to be initiated</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;with an &quot;impulsive start&quot;, corresponding to a past history in which</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;the boundary condition (3) describes the system&#39;s</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;state for all \f$ t \le 0\f$ rather than only \e at \f$ t =</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;0\f$ . For instance, the top-level function \c</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;Problem::assign_initial_values_impulsive() sets the  &quot;history values&quot;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;of all \c Data objects and the \c Nodes&#39; &quot;positional history values&quot; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;to values that are appropriate for an impulsive start from the</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;currently assigned nodal values and positions. </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;The following exercises aim to explore this functionality.</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;\subsection exercises Exercises</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;-# Replace the call to \c problem.set_initial_condition() </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   in the main function by a call to </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   \c Problem::assign_initial_values_impulsive() and analyse</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   the results. [Hint: When \c Data objects are created, their </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   values are initialised to zero.]</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;-# Confirm that the loop over the coordinate directions</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   \dontinclude two_d_unsteady_heat.cc </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   \skipline Loop over coordinate directions</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   \until }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   in \c set_initial_condition(), can be replaced by</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   \code</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   time_stepper_pt()-&gt;assign_initial_positions_impulsive(</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        mesh_pt()-&gt;node_pt(n));</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   \endcode</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   [This statement could then be moved outside the loop </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   over the previous time levels.] </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;-# Confirm that the initialisation of the previous nodal positions</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   is essential by commenting out this step -- see the  </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   &lt;A HREF=&quot;../../two_d_unsteady_heat_ALE/html/index.html&quot;&gt;ALE </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   example&lt;/A&gt; for further details on computations in moving domains.</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;-# Overwrite the correct assignment of the &quot;history values&quot; in</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   \c set_initial_condition() by adding the statement</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   \c Problem::assign_initial_values_impulsive() at the end</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   of this function (rather than bypassing the assignment</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   completely as in the first exercise). Repeat this with the \c BDF&lt;1&gt;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   and \c BDF&lt;4&gt; timesteppers and explain the different behaviour. </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;-# Examine the accuracy of the various \c BDF timesteppers by</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   re-running the simulations with various timesteppers and with</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   different timesteps.</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;\section sources Source files for this tutorial</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;- The source files for this tutorial are located in the directory:</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;&lt;A HREF=&quot;../../../../demo_drivers/unsteady_heat/two_d_unsteady_heat/&quot;&gt;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;demo_drivers/unsteady_heat/two_d_unsteady_heat/</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;&lt;/A&gt;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;- The driver code is:</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;&lt;A HREF=&quot;../../../../demo_drivers/unsteady_heat/two_d_unsteady_heat/two_d_unsteady_heat.cc&quot;&gt;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;demo_drivers/unsteady_heat/two_d_unsteady_heat/two_d_unsteady_heat.cc</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;&lt;/A&gt;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;.</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;&lt;hr&gt;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;&lt;hr&gt;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;\section pdf PDF file</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;**/</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a2a7d5d19465f5011a24ad86f0f0728a4"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a2a7d5d19465f5011a24ad86f0f0728a4">state</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until we execute the timestepping loop and document the computed solutions skipline Find number until end of main In this each call to the unsteady Newton c advances the solution from its current state</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00127">two_d_unsteady_heat.txt:127</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_ad5984e4c059a564ceba033747647feb1"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#ad5984e4c059a564ceba033747647feb1">t</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton c may be called to advance the solution from its state at time f t f to its new state at f t f c dt&lt; HR &gt;&lt; HR &gt; section example The example problem We will illustrate the basic timestepping procedures by considering the solution of the unsteady heat equation in a square t E[2DHeat] f in the square domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] and initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f g_0 f and f h_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced f and choose boundary and initial conditions that are consistent with the exact solution f[u_0(x_1, x_2, t)=e^{-Kt}\sin\left(\sqrt{K} \left(x_1 \cos \Phi+x_2 \sin\Phi\right)\right), \ \ \ \ \ \ \ \ \ \ @E[ExactSoln1]@\f] where f K f and f Phi f are controlling the decay rate of the solution and its spatial respectively The figure below shows a plot of computed and exact solutions at time f t</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00073">two_d_unsteady_heat.txt:73</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a104a2466fc8d49e294a0bf3439ca4858"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a104a2466fc8d49e294a0bf3439ca4858">solver</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton solver</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00021">two_d_unsteady_heat.txt:21</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a97e17bb43032bf938232fec46e752b02"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a97e17bb43032bf938232fec46e752b02">f</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton c may be called to advance the solution from its state at time f t f to its new state at f t f c dt&lt; HR &gt;&lt; HR &gt; section example The example problem We will illustrate the basic timestepping procedures by considering the solution of the unsteady heat equation in a square t E[2DHeat] f in the square domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] and initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f g_0 f and f h_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced f f</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00062">two_d_unsteady_heat.txt:62</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_ad570585248dc2d18882f000173e7503c"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#ad570585248dc2d18882f000173e7503c">derivative</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until we execute the timestepping loop and document the computed solutions skipline Find number until end of main In this each call to the unsteady Newton c advances the solution from its current at time f to f t f c dt The unsteady Newton solver automatically shifts the history values backwards and advances the value of the continuous time&lt; HR &gt;&lt; HR &gt; section problem The problem class The c Problem classes for time dependent problems are very similar to those for steady problems The most important additional member functions are c Problem::actions_before_implicit_timestep() and \c Problem the BDF&lt; 2 &gt; timestepper computes an approximation of the time derivative</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00139">two_d_unsteady_heat.txt:139</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a87442051561f61cdbd884a896f0ba3a2"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a87442051561f61cdbd884a896f0ba3a2">x_2</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton c may be called to advance the solution from its state at time f t f to its new state at f t f c dt&lt; HR &gt;&lt; HR &gt; section example The example problem We will illustrate the basic timestepping procedures by considering the solution of the unsteady heat equation in a square x_2</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00042">two_d_unsteady_heat.txt:42</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a203a9797caf30556a7521d86d0048f1c"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a203a9797caf30556a7521d86d0048f1c">orientation</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton c may be called to advance the solution from its state at time f t f to its new state at f t f c dt&lt; HR &gt;&lt; HR &gt; section example The example problem We will illustrate the basic timestepping procedures by considering the solution of the unsteady heat equation in a square t E[2DHeat] f in the square domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] and initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f g_0 f and f h_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced f and choose boundary and initial conditions that are consistent with the exact solution f[u_0(x_1, x_2, t)=e^{-Kt}\sin\left(\sqrt{K} \left(x_1 \cos \Phi+x_2 \sin\Phi\right)\right), \ \ \ \ \ \ \ \ \ \ @E[ExactSoln1]@\f] where f K f and f Phi f are controlling the decay rate of the solution and its spatial orientation</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00070">two_d_unsteady_heat.txt:70</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_abc13967d4ca7047e9cdbad176a5e1900"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#abc13967d4ca7047e9cdbad176a5e1900">the</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and the(constant) timestep</div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a88366b019e6859c43b9f25e37fda6421"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a88366b019e6859c43b9f25e37fda6421">Next</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until we execute the timestepping loop and document the computed solutions skipline Find number until end of main In this each call to the unsteady Newton c advances the solution from its current at time f to f t f c dt The unsteady Newton solver automatically shifts the history values backwards and advances the value of the continuous time&lt; HR &gt;&lt; HR &gt; section problem The problem class The c Problem classes for time dependent problems are very similar to those for steady problems The most important additional member functions are c Problem::actions_before_implicit_timestep() and \c Problem the BDF&lt; 2 &gt; timestepper computes an approximation of the time based on the solution at two previous etc c Nodes(which \e are \c Data!) are typically built by the \c Mesh const ructor using the \c FiniteElement 's member function \c FiniteElement endcode&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt; Next</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00228">two_d_unsteady_heat.txt:228</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_adced30751afc80977e3047b28d4220fe"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#adced30751afc80977e3047b28d4220fe">right</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton c may be called to advance the solution from its state at time f t f to its new state at f t f c dt&lt; HR &gt;&lt; HR &gt; section example The example problem We will illustrate the basic timestepping procedures by considering the solution of the unsteady heat equation in a square t right</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00042">two_d_unsteady_heat.txt:42</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a86b85e72d6c63eeaa3e9ddd1be283f8e"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a86b85e72d6c63eeaa3e9ddd1be283f8e">dt</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until dt</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00103">two_d_unsteady_heat.txt:103</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a00832ebef54c9ba21194fd4f78a56f17"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a00832ebef54c9ba21194fd4f78a56f17">constants</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton c may be called to advance the solution from its state at time f t f to its new state at f t f c dt&lt; HR &gt;&lt; HR &gt; section example The example problem We will illustrate the basic timestepping procedures by considering the solution of the unsteady heat equation in a square t E[2DHeat] f in the square domain f subject to the Dirichlet boundary conditions f[\left. u\right|_{\partial D}=g_0\ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] and initial conditions f[u(x_1, x_2, t=0)=h_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f g_0 f and f h_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; Here we consider the unforced f and choose boundary and initial conditions that are consistent with the exact solution f[u_0(x_1, x_2, t)=e^{-Kt}\sin\left(\sqrt{K} \left(x_1 \cos \Phi+x_2 \sin\Phi\right)\right), \ \ \ \ \ \ \ \ \ \ @E[ExactSoln1]@\f] where f K f and f Phi f are constants</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00069">two_d_unsteady_heat.txt:69</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_ac44b6be4574b9141f82b7d81797a7a93"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#ac44b6be4574b9141f82b7d81797a7a93">D</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton c may be called to advance the solution from its state at time f t f to its new state at f t f c dt&lt; HR &gt;&lt; HR &gt; section example The example problem We will illustrate the basic timestepping procedures by considering the solution of the unsteady heat equation in a square t E[2DHeat] f in the square domain f D</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00045">two_d_unsteady_heat.txt:45</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_acf1bb1344e80ea59d0654f51c7d217b1"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#acf1bb1344e80ea59d0654f51c7d217b1">steps</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional steps</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00010">two_d_unsteady_heat.txt:10</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a323f3b7e34cc0cc4b69847e829f622d7"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a323f3b7e34cc0cc4b69847e829f622d7">performed</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been performed</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00020">two_d_unsteady_heat.txt:20</a></div></div>
<div class="ttc" id="anamespaceExactSolnForUnsteadyHeat_html"><div class="ttname"><a href="namespaceExactSolnForUnsteadyHeat.html">ExactSolnForUnsteadyHeat</a></div><div class="ttdoc">Namespace for unforced exact solution for UnsteadyHeat equation.</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8cc_source.html#l00051">two_d_unsteady_heat.cc:51</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_ab3758e90a18734ecfb607433b41a46f5"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#ab3758e90a18734ecfb607433b41a46f5">loop</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until we execute the timestepping loop and document the computed solutions skipline Find number until end of main In this loop</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00125">two_d_unsteady_heat.txt:125</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_aaff9a073880a8a1831a6f9563f872749"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#aaff9a073880a8a1831a6f9563f872749">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00004">two_d_unsteady_heat.txt:4</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a2b54b2134cf9d911759f541768994e0e"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a2b54b2134cf9d911759f541768994e0e">problems</a></div><div class="ttdeci">mainpage Example compared to the solution of steady problems</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00004">two_d_unsteady_heat.txt:4</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a4b9eb29d816eda232815ca9d69d3e473"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a4b9eb29d816eda232815ca9d69d3e473">timesteps</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until we execute the timestepping loop and document the computed solutions skipline Find number until end of main In this each call to the unsteady Newton c advances the solution from its current at time f to f t f c dt The unsteady Newton solver automatically shifts the history values backwards and advances the value of the continuous time&lt; HR &gt;&lt; HR &gt; section problem The problem class The c Problem classes for time dependent problems are very similar to those for steady problems The most important additional member functions are c Problem::actions_before_implicit_timestep() and \c Problem the BDF&lt; 2 &gt; timestepper computes an approximation of the time based on the solution at two previous timesteps</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00226">two_d_unsteady_heat.txt:226</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a4885e5c4cff89f1b9814ea4f5013d06b"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a4885e5c4cff89f1b9814ea4f5013d06b">values</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until we execute the timestepping loop and document the computed solutions skipline Find number until end of main In this each call to the unsteady Newton c advances the solution from its current at time f to f t f c dt The unsteady Newton solver automatically shifts the history values backwards and advances the value of the continuous time&lt; HR &gt;&lt; HR &gt; section problem The problem class The c Problem classes for time dependent problems are very similar to those for steady problems The most important additional member functions are c Problem::actions_before_implicit_timestep() and \c Problem the BDF&lt; 2 &gt; timestepper computes an approximation of the time based on the solution at two previous etc c Nodes(which \e are \c Data!) are typically built by the \c Mesh const ructor using the \c FiniteElement 's member function \c FiniteElement endcode&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt; we apply the boundary pinning the values at all boundary nodes skipline Set the boundary until end of set boundary conditions we loop over the elements and pass the pointer to the source function skipline Complete the build of all elements so they are fully until end of constructor&lt; HR &gt;&lt; HR &gt; section before_timestep Actions before(implicit) timestep We overload the(empty) virtual function \c Problem we will illustrate this capability in&lt; A HREF=&quot;../../../unsteady_heat/two_d_unsteady_heat_ALE/html/index.html&quot;&gt; another example&lt;/a &gt; In such the nodal positions may vary as a function of time In the present the computation is performed in a fixed therefore we initialise the previous nodal positions with their current values</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00351">two_d_unsteady_heat.txt:351</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a1e7cf38cdcb34cefa2e78ff30fed63fb"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a1e7cf38cdcb34cefa2e78ff30fed63fb">number</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until number()++Finally</div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_aa9b98f6de64a744f17dc981fbe440824"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#aa9b98f6de64a744f17dc981fbe440824">Finally</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until we execute the timestepping loop and document the computed solutions skipline Find number until end of main In this each call to the unsteady Newton c advances the solution from its current at time f to f t f c dt The unsteady Newton solver automatically shifts the history values backwards and advances the value of the continuous time&lt; HR &gt;&lt; HR &gt; section problem The problem class The c Problem classes for time dependent problems are very similar to those for steady problems The most important additional member functions are c Problem::actions_before_implicit_timestep() and \c Problem the BDF&lt; 2 &gt; timestepper computes an approximation of the time based on the solution at two previous etc c Nodes(which \e are \c Data!) are typically built by the \c Mesh const ructor using the \c FiniteElement 's member function \c FiniteElement endcode&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt; we apply the boundary pinning the values at all boundary nodes skipline Set the boundary until end of set boundary conditions Finally</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00309">two_d_unsteady_heat.txt:309</a></div></div>
<div class="ttc" id="anamespaceExactSolnForUnsteadyHeat_html_a630f9e8d892cfcc41cdaef25bfc87ca1"><div class="ttname"><a href="namespaceExactSolnForUnsteadyHeat.html#a630f9e8d892cfcc41cdaef25bfc87ca1">ExactSolnForUnsteadyHeat::Phi</a></div><div class="ttdeci">double Phi</div><div class="ttdoc">Angle of bump.</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8cc_source.html#l00058">two_d_unsteady_heat.cc:58</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="two__d__unsteady__heat_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver code for unsteady heat equation.</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8cc_source.html#l00414">two_d_unsteady_heat.cc:414</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a68b21893a49b8730ecc3404da9665505"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a68b21893a49b8730ecc3404da9665505">domain</a></div><div class="ttdeci">mainpage Example compared to the solution of steady the solution of time dependent problems only requires a few additional c dt Setting the initial conditions by assigning suitable values for the c Data objects history values and the c Nodes positional history values e g to update time dependent boundary conditions before each timestep Once these steps have been c oomph lib s unsteady Newton c may be called to advance the solution from its state at time f t f to its new state at f t f c dt&lt; HR &gt;&lt; HR &gt; section example The example problem We will illustrate the basic timestepping procedures by considering the solution of the unsteady heat equation in a square domain</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00042">two_d_unsteady_heat.txt:42</a></div></div>
<div class="ttc" id="anamespaceExactSolnForUnsteadyHeat_html_a20d04bcf14546becd4bcdf45446be756"><div class="ttname"><a href="namespaceExactSolnForUnsteadyHeat.html#a20d04bcf14546becd4bcdf45446be756">ExactSolnForUnsteadyHeat::K</a></div><div class="ttdeci">double K</div><div class="ttdoc">Decay factor.</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8cc_source.html#l00055">two_d_unsteady_heat.cc:55</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_a4bd98749739faf5e4afef3cae34e92b1"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#a4bd98749739faf5e4afef3cae34e92b1">below</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail below</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00112">two_d_unsteady_heat.txt:112</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat_8txt_html_af74be0cf126e592fa9a19b44cee1d823"><div class="ttname"><a href="two__d__unsteady__heat_8txt.html#af74be0cf126e592fa9a19b44cee1d823">conditions</a></div><div class="ttdeci">namespace dontinclude two_d_unsteady_heat cc skipline start_of_ExactSolnForUnsteadyHeat until end of ExactSolnForUnsteadyHeat&lt; HR &gt;&lt; HR &gt; section main The driver code We start by building the c Problem object create a c DocInfo object to label the output files and open a trace file in which we will record the time evolution of the solution and the error We choose the length c t_max of the simulation and c dt skipline start_of_main until the timestep c dt b must be passed to the c Problem s timestepping routines by calling the function c to be discussed in more detail and document the initial conditions skipline Initialise until we execute the timestepping loop and document the computed solutions skipline Find number until end of main In this each call to the unsteady Newton c advances the solution from its current at time f to f t f c dt The unsteady Newton solver automatically shifts the history values backwards and advances the value of the continuous time&lt; HR &gt;&lt; HR &gt; section problem The problem class The c Problem classes for time dependent problems are very similar to those for steady problems The most important additional member functions are c Problem::actions_before_implicit_timestep() and \c Problem the BDF&lt; 2 &gt; timestepper computes an approximation of the time based on the solution at two previous etc c Nodes(which \e are \c Data!) are typically built by the \c Mesh const ructor using the \c FiniteElement 's member function \c FiniteElement endcode&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt; we apply the boundary conditions</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat_8txt_source.html#l00304">two_d_unsteady_heat.txt:304</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 19:13:26
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: two_d_unsteady_heat_ALE.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">two_d_unsteady_heat_ALE.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="two__d__unsteady__heat__ALE_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: Spatially adaptive solution of the 2D unsteady heat equation with flux boundary conditions in a moving domain: ALE methods.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In this example we consider the solution of the unsteady heat</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">equation in a domain with moving boundaries. We demonstrate</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">that the presence of moving boundaries only requires trivial changes</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">to driver codes for corresponding fixed-mesh computations.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">&lt;B&gt;The two-dimensional unsteady heat equation with flux boundary</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">conditions in a moving domain.&lt;/B&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">\sum_{i=1}^2\frac{\partial^2 u}{\partial x_i^2} </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">= \frac{\partial u}{\partial t} + f\left(x_1,x_2,t\right),</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">in the domain \f$ D \f$ , bounded by the coordinate axes</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">and the time-dependent ellipse</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">\mathbf{r}_{ellipse}(\xi,t) = </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">\big( a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">\big( b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">\right),</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">subject to Neumann boundary conditions,</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">g_0, </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">along the horizontal domain boundary \f$ \partial D_{Neumann} = </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">\{ (x_1,x_2) | x_1 \in [0,1], x_2=0 \} \f$ , and to Dirichlet </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">boundary conditions,</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\left. u\right|_{\partial D_{Dirichlet}}=h_0, </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">elsewhere.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\image html domain.gif &quot;Sketch of the time-dependent domain and the boundary conditions. &quot; </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">\image latex domain.eps &quot;Sketch of the time-dependent domain and the boundary conditions. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">The initial conditions are given by</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">u(x_1,x_2,t=0)=k_0(x_1,x_2),</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (5)</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">where the functions \f$ f, g_0, \ h_0 \f$ and  \f$ k_0 \f$ are given. </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">We choose the functions \f$ f, g_0, \ h_0 \f$ and  \f$ k_0 \f$ </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">so that</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">u_0(x_1,x_2,t) = \tanh\bigg[ 1-\alpha\bigg( \tan\Phi</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">\big(x_1-\beta\tanh[ \gamma\cos\left(2\pi</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">t\right)]\big)- x_2\bigg)\bigg]</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (6)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">is the exact solution.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">The solution represents the &quot;usual&quot; tanh profile, whose steepness</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">is controlled by the parameter \f$ \alpha \f$ so that for \f$ \alpha</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">\gg 1 \f$ the solution approaches a step. The step is oriented</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">at an angle \f$ \Phi \f$ against the \f$ x_1- \f$ axis and its position varies</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">periodically. The parameter \f$ \beta \f$ controls the amplitude</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">of the step&#39;s lateral displacement, while \f$ \gamma \f$ determines the</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">rate at which its position changes. For \f$ \gamma \gg 1 \f$ ,</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">the step remains stationary for most of the period and then</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">translates rapidly parallel to the \f$ x_1- \f$ axis, making this a very </span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">challenging problem.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">The figure below shows a snapshot of the &lt;A HREF=&quot;../figures/step_soln.avi&quot;&gt;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">animated solution&lt;/A&gt;, obtained from the spatially adaptive simulation</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">discussed below, for the parameter values \f$ \alpha=10, \ </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">\Phi=45^o, \ \beta=-0.3, \ \gamma=5. \f$</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">\image html step_soln.gif &quot;Snapshot of the solution. &quot; </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">\image latex step_soln.eps &quot;Snapshot of the solution. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">  The mesh adaptation in response to the translation of the step can be</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">seen more clearly in this contour plot, taken from</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">&lt;A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">another animation of the solution&lt;/A&gt;.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">\image html unsteady_heat_contour.gif &quot;Contour plot of the solution. &quot; </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">\image latex unsteady_heat_contour.eps &quot;Contour plot of the solution. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">\section ale Background: ALE methods and the evaluation of time-derivatives in moving domains</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">\c oomph-lib&#39;s \c UnsteadyHeatEquations, the equation class that forms the</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">basis for the isoparametric \c QUnsteadyHeatElements, is based</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">on the Arbitrary Lagrangian Eulerian (ALE) formulation of the </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">weak form of the governing PDE, (1). Within each element, the</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">solution is represented by interpolation between the </span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">element&#39;s  \f$ N_{node}^{(E)} \f$ nodal values \f$ U_j^{(E)}(t) \ </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">(i=1,..., N_{node}^{(E)})\f$ , i.e. </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">u = \sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \  \psi_{j}(s_1,s_2),</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (7)</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">where \f$ s_1 \f$ and \f$ s_2 \f$ are the element&#39;s two local coordinates.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">The mapping between the local and global (Eulerian) coordinates is based on </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">the interpolation between the nodal coordinates,</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">x_i(s_1,s_2) = \sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \  </span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">\psi_{j}(s_1,s_2),</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">\ \ \ \ (i=1,2) \ \ \ \ \ \  (8)</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">where \f$ X_{ij}^{(E)}(t) \f$ is the i-th global (Eulerian) coordinate of </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">node j in the element. In moving-domain problems, where the nodal positions vary as</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">function of time, the time-derivative of the nodal value, </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">\f$ dU_j(t)/dt \f$ , represents the rate-of-change of  \f$ u \f$ </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">at the moving node, rather than the time-derivative </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">of \f$ u \f$ at a fixed Eulerian position,  </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">\f$ \partial u/\partial t, \f$ the quantity required in the </span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">PDE, (1).</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">The rate of change of \f$ u \f$ at a moving node,</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">\f$ dU_j(t)/dt \f$ , may also be expressed by the material derivative,</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">\left. \frac{D u}{Dt}\right|_{\mbox{\small node} \ j} =  </span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">\frac{\partial u}{\partial t}</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">+ \sum_{i=1}^2 v_{ij} \ \frac{\partial u}{\partial x_i}</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">where</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> \f[</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">v_{ij} =  \frac{dX_{ij}^{(E)}}{dt}</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">is the i-th velocity component of node j, often referred to </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">as the &quot;mesh velocity&quot;. The rate of change of  \f$ u \f$ , </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">experienced at the (fixed) spatial position that coincides with </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">the current position  of node j is therefore given by</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">\frac{\partial u}{\partial t} =</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">\frac{d U_j^{(E)}}{dt}</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">- \sum_{i=1}^2 </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">\left( </span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">\frac{dX_{ij}^{(E)}}{dt}</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">\ \sum_{k=1}^{N_{node}^{(E)}} U_k^{(E)} \</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">\frac{\partial \psi_{k}}{\partial x_i}</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">\right) .</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">This is the form in which the time-derivative in  (1)</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">is implemented in \c oomph-lib&#39;s unsteady heat elements. The mesh</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">velocity is determined automatically, using the \c Node&#39;s positional</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">\c TimeStepper and the history values of the nodal positions.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">[By  default, the positional \c TimeStepper is the same as the \c TimeStepper</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">used for the evaluation of the time-derivatives of the nodal values;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">a different one  may be assigned with the access function</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">\c Node::position_time_stepper_pt().] This is why it is important</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">to initialise the &quot;previous nodal positions&quot; in computations</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">on fixed meshes, as demonstrated in the </span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">&lt;A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">exercise in our earlier</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">example:&lt;/A&gt; The previous nodal positions are</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">initialised to zero when a \c Node is first created. Therefore, if the previous</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">positions are not overwritten with the actual nodal positions,</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">the positional \c TimeStepper would compute non-zero mesh velocities,</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">even though the \c Nodes are stationary.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> \c oomph-lib&#39;s unsteady Newton solvers automatically</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">advance the time-history of the nodal positions when computing</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">a new timestep. Performing computations on moving meshes</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">is  therefore extremely straightforward: The only task to be performed</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">by the &quot;user&quot; is to update the nodal positions before a new</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">timestep is taken. This is best done in the function</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">\c Problem::actions_before_implicit_timestep(). </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">  The update of the nodal positions may be performed &quot;manually&quot;,</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">by assigning new nodal positions directly, using the function</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">\c Node::x(...). However, in most cases, the deformation of the domain</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">will be driven by the motion of its boundaries. We discussed</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">in an &lt;A HREF=&quot;../../../poisson/fish_poisson2/html/index.html&quot;&gt;earlier</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">example,&lt;/A&gt; that in \c oomph-lib curvilinear, moving boundaries are typically </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">represented by (time-dependent) \c GeomObjects which define the</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">\c MacroElement boundaries of the \c Domain object associated with</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">the \c Mesh. In this case, the update of the nodal positions may be</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">performed by updating the parameters that control the shape of the</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">\c GeomObject and calling the \c Mesh&#39;s node-update function </span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">\c Mesh::node_update(), as illustrated</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">in the &lt;A HREF=&quot;../../../poisson/fish_poisson2/html/index.html&quot;&gt;earlier</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">example.&lt;/A&gt;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">It is also possible (and, in fact, much easier) to include the</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">time-dependence of the domain boundaries into the definition of </span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">the \c GeomObject, by making its shape, described by </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">\c GeomObject::position(...), a function of time.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">In that case, the update of the nodal positions in response to the</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">boundary motion merely requires a call to  \c Mesh::node_update() in</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">\c Problem::actions_before_implicit_timestep(). This is the approach we take</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">in the present problem.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">\section namespace Global parameters and functions</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">As usual, we store the problem parameters in a namespace,</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">\c TanhSolnForUnsteadyHeat, in which we also specify the </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">source function, the prescribed flux along the Neumann boundary </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">and the exact solution. The namespace is identical to that</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">used in &lt;A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">the fixed domain example.&lt;/A&gt; </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">\section ellipse Representing the moving curvilinear domain boundary by a time-dependent GeomObject</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">As discussed above, we will incorporate the time-dependence of the</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">moving curvilinear boundary into the specification of the \c GeomObject</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">that defines that boundary. For this purpose we represent the</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">elliptical boundary by the \c GeomObject \c MyEllipse.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">Its constructor stores the geometric parameters (the</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">mean values of the ellipse&#39;s half axes, \f$ a \f$ and \f$ b \f$ , the </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">amplitude of their temporal variations \f$ \hat{a} \f$ and</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">\f$ \hat{b} \f$ , and the period of the</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">oscillation, \f$ \hat{T} \f$ , in its private member data. We also store a </span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">pointer to a \c Time  object to give the \c GeomObject access to the </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">&quot;current&quot; and &quot;previous&quot; values of the &quot;continuous time&quot;. </span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">The destructor can remain empty.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_ALE.cc</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">\skipline start_of_MyEllipse</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">\until ~MyEllipse</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">The &quot;steady&quot; version of the \c position(...) function must return</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">the position vector to the point on the \c GeomObject, identified</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">by its intrinsic coordinate \c xi, and evaluated at the current </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">value of the continuous time, which we extract from \c Time::time():</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">\skipline Current position</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">\until end of position</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">The &quot;time-dependent&quot; version of the \c position(...) function must return</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">the position vector to the \c GeomObject, evaluated at the</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">\c t - th previous timestep. The value of the continuous time at that timestep</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">is available from from \c Time::time(t):</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\skipline Parametrised</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">\until end of position</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">We omit the code that defines the private member data.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">\section main The main function</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">Since the deformation of the domain and the update of the nodal</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">positions will be handled automatically by adding a call to</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">\c Mesh::node_update() to \c Problem::actions_before_implicit_timestep(), the</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">driver code for this problem is exactly the same as that in the </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">&lt;A HREF=&quot;../../two_d_unsteady_heat_adapt/html/index.html&quot;&gt; previous</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">example in a fixed domain. &lt;/A&gt; </span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\section problem_class The Problem class</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">The \c Problem class and most of its member functions are exactly the same </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">as in the &lt;A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">previous example.&lt;/A&gt;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">\section constructor The Problem constructor</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">The \c Problem constructor is identical to the fixed-mesh version </span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">in the &lt;A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">previous example,&lt;/A&gt; apart from the fact that we use the \c MyEllipse \c</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">GeomObject to define the curvilinear \c Mesh boundary. Here is the relevant</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">code fragment:</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_ALE.cc</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">\skipline Setup mesh</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">\until time_stepper_pt()</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">\section actions_before_implicit_timestep Actions before timestep</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">As discussed above, the addition of a single line to </span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">\c Problem::actions_before_implicit_timestep() suffices to update</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">the nodal positions in response to the changes in the domain boundary.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">\dontinclude two_d_unsteady_heat_ALE.cc</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">\skipline start of actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">\until Bulk_mesh_pt-&gt;node_update();</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">The rest of this function is identical to the that in the</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">&lt;A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">fixed-domain version&lt;/A&gt; and updates the nodal values on the</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">Dirichlet boundaries according to the values given by the </span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">exact solution.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">\section set_init Setting the initial condition</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">The only other change to the code occurs in the assignment of</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">the initial conditions. The \c Nodes&#39; positional history values </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">are given by the positions at which the \c Nodes would have been at </span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">previous timesteps. Similarly, the history values themselves</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">must be computed by evaluating the exact solution at the position </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">at which the \c Nodes would have been at those timesteps.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">This is achieved with a few minor changes to the previous version </span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">of this function. We loop over the previous timesteps, reconstruct</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">the value of the continuous time at that timestep, and temporarily</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">over-write the value of the continuous time stored in \c</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">Time::time(). This ensures that the call to \c</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">MyEllipse::position(...) during the node update</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">operation returns the position vector to the domain boundary</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">at that timestep. Following the update of the nodal positions (which moves them</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">into the position they would have occupied at the previous timestep)</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">we copy their positions and the value of the exact solution</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">into the appropriate history values. Here is the relevant code</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">fragment from the \c set_initial_condition() function:</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">\skipline Loop over current &amp; previous timesteps </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">\until  end of loop over previous timesteps</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">\section comm Comments and Exercises</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">While the spatial adaptivity resolves the rapid spatial variations</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">in the solution, the time-integration with a fixed timestep</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">introduces errors during the phases when the solution undergoes</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">rapid temporal variations. The &lt;A HREF=&quot;../figures/step_soln.avi&quot;&gt;</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">animations&lt;/A&gt; of the exact and computed solutions show clearly</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">that the computed solution lags behind the exact one during these</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">phases. In the &lt;A HREF=&quot;../../two_d_unsteady_heat_2adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">next example&lt;/A&gt; we will therefore demonstrate how to combine</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">temporal and spatial adaptivity.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/unsteady_heat/two_d_unsteady_heat_ALE/&quot;&gt;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">demo_drivers/unsteady_heat/two_d_unsteady_heat_ALE/</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">- The driver code is:</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/unsteady_heat/two_d_unsteady_heat_ALE/two_d_unsteady_heat_ALE.cc&quot;&gt;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">demo_drivers/unsteady_heat/two_d_unsteady_heat_ALE/two_d_unsteady_heat_ALE.cc</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a8d895bb93cd829890aa4c1a2d5682792"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a8d895bb93cd829890aa4c1a2d5682792">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00020">two_d_unsteady_heat_ALE.txt:20</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a26516243c30cc272bd124f6d70d0b1a0"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a26516243c30cc272bd124f6d70d0b1a0">D_</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial D_</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00042">two_d_unsteady_heat_ALE.txt:42</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a0304ad48f5799545a8dc7f36bbbeb179"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a0304ad48f5799545a8dc7f36bbbeb179">directly</a></div><div class="ttdeci">a different one may be assigned with the access function c as demonstrated in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; exercise in our earlier if the previous positions are not overwritten with the actual nodal the positional c TimeStepper would compute non zero mesh even though the c Nodes are stationary c oomph lib s unsteady Newton solvers automatically advance the time history of the nodal positions when computing a new timestep Performing computations on moving meshes is therefore extremely by assigning new nodal positions directly</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00187">two_d_unsteady_heat_ALE.txt:187</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_aedc10c21e221656425a5c4893de105dd"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#aedc10c21e221656425a5c4893de105dd">N_</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f N_</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00112">two_d_unsteady_heat_ALE.txt:112</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a0527fcb3ba8324da07731acfafdaa797"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a0527fcb3ba8324da07731acfafdaa797">t</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f i e f[u=\sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \ \ \ \ \ \ \ @E[fe_exp]@\f] where f s_1 f and f s_2 f are the element s two coordinates The mapping between the and f[x_i(s_1, s_2)=\sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \(i=1, 2) \ \ \ \ \ \ @E[x_fe_exp]@\f] where f where the nodal positions vary as function of the time derivative of the nodal f represents the rate of change of f u f at the moving rather than the time derivative of f u f at a fixed Eulerian f partial u partial t</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00132">two_d_unsteady_heat_ALE.txt:132</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_ad9c2070486bcbe0bc885f49048e5b6db"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#ad9c2070486bcbe0bc885f49048e5b6db">positions</a></div><div class="ttdeci">a different one may be assigned with the access function c as demonstrated in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; exercise in our earlier if the previous positions are not overwritten with the actual nodal positions</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00174">two_d_unsteady_heat_ALE.txt:174</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a2c2e6941648531d5aaf64859b1d9dd86"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a2c2e6941648531d5aaf64859b1d9dd86">gamma</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f gamma</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00086">two_d_unsteady_heat_ALE.txt:86</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a235b56994d5c6720de2235d7f30ba236"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a235b56994d5c6720de2235d7f30ba236">straightforward</a></div><div class="ttdeci">a different one may be assigned with the access function c as demonstrated in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; exercise in our earlier if the previous positions are not overwritten with the actual nodal the positional c TimeStepper would compute non zero mesh even though the c Nodes are stationary c oomph lib s unsteady Newton solvers automatically advance the time history of the nodal positions when computing a new timestep Performing computations on moving meshes is therefore extremely straightforward</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00186">two_d_unsteady_heat_ALE.txt:186</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_ad496ee60a143d720cf4339a928087c7e"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#ad496ee60a143d720cf4339a928087c7e">values</a></div><div class="ttdeci">the positional c TimeStepper is the same as the c TimeStepper used for the evaluation of the time derivatives of the nodal values</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00151">two_d_unsteady_heat_ALE.txt:151</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a6f5f4e911ccd3d58a269b0744cc88e05"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a6f5f4e911ccd3d58a269b0744cc88e05">time</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f i e f[u=\sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \ \ \ \ \ \ \ @E[fe_exp]@\f] where f s_1 f and f s_2 f are the element s two coordinates The mapping between the and f[x_i(s_1, s_2)=\sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \(i=1, 2) \ \ \ \ \ \ @E[x_fe_exp]@\f] where f where the nodal positions vary as function of time</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00128">two_d_unsteady_heat_ALE.txt:128</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a72ecd37e21d6e3953f9b2730ea6b8e2d"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a72ecd37e21d6e3953f9b2730ea6b8e2d">Similarly</a></div><div class="ttdeci">The rest of this function is identical to the that in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; fixed domain version&lt;/A &gt; and updates the nodal values on the Dirichlet boundaries according to the values given by the exact solution&lt; HR &gt;&lt; HR &gt; section set_init Setting the initial condition The only other change to the code occurs in the assignment of the initial conditions The c Nodes positional history values are given by the positions at which the c Nodes would have been at previous timesteps Similarly</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00331">two_d_unsteady_heat_ALE.txt:331</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a6eab5df7af84e6aba0fca3cb3dc693e0"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a6eab5df7af84e6aba0fca3cb3dc693e0">PDE</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f i e f[u=\sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \ \ \ \ \ \ \ @E[fe_exp]@\f] where f s_1 f and f s_2 f are the element s two coordinates The mapping between the and f[x_i(s_1, s_2)=\sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \(i=1, 2) \ \ \ \ \ \ @E[x_fe_exp]@\f] where f where the nodal positions vary as function of the time derivative of the nodal f represents the rate of change of f u f at the moving rather than the time derivative of f u f at a fixed Eulerian f partial u partial f the quantity required in the PDE</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00133">two_d_unsteady_heat_ALE.txt:133</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_ade9d0d4b277355158e822edc5faaf129"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#ade9d0d4b277355158e822edc5faaf129">j</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f i e f[u=\sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \ \ \ \ \ \ \ @E[fe_exp]@\f] where f s_1 f and f s_2 f are the element s two coordinates The mapping between the and f[x_i(s_1, s_2)=\sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \(i=1, 2) \ \ \ \ \ \ @E[x_fe_exp]@\f] where f where the nodal positions vary as function of the time derivative of the nodal f represents the rate of change of f u f at the moving rather than the time derivative of f u f at a fixed Eulerian f partial u partial f the quantity required in the R[2DHeat] The rate of change of f u f at a moving f may also be expressed by the material f[\left. \frac{D u}{Dt}\right|_{\mbox{\small node} \ j}=\frac{\partial u}{\partial t}+\sum_{i=1}^2 v_{ij} \ \frac{\partial u}{\partial x_i}\f] where f[v_{ij}=\frac{dX_{ij}^{(E)}}{dt}\f] is the i th velocity component of node j</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00146">two_d_unsteady_heat_ALE.txt:146</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a3fe57b5473efd5df8b399d22c38f21b8"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a3fe57b5473efd5df8b399d22c38f21b8">right</a></div><div class="ttdeci">mainpage Example t right</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00020">two_d_unsteady_heat_ALE.txt:20</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a21a4f557c68498245dc3903df5e96ce7"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a21a4f557c68498245dc3903df5e96ce7">position</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f i e f[u=\sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \ \ \ \ \ \ \ @E[fe_exp]@\f] where f s_1 f and f s_2 f are the element s two coordinates The mapping between the and f[x_i(s_1, s_2)=\sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \(i=1, 2) \ \ \ \ \ \ @E[x_fe_exp]@\f] where f where the nodal positions vary as function of the time derivative of the nodal f represents the rate of change of f u f at the moving rather than the time derivative of f u f at a fixed Eulerian position</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00131">two_d_unsteady_heat_ALE.txt:131</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_af92c410d8193584256d7c9bc148195b8"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#af92c410d8193584256d7c9bc148195b8">Eulerian</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian Eulerian(ALE) formulation of the weak form of the governing PDE</div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8cc_source.html#l00952">two_d_unsteady_heat_ALE.cc:952</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_adeef8ccfea1fad79c6113de1009c3075"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#adeef8ccfea1fad79c6113de1009c3075">element</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each element</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00110">two_d_unsteady_heat_ALE.txt:110</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_aec91c85df44f9495b32f8b1dfc2ef3d2"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#aec91c85df44f9495b32f8b1dfc2ef3d2">g_0</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f g_0</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00056">two_d_unsteady_heat_ALE.txt:56</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a9803e67c0688925dff8f92eb241ea83e"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a9803e67c0688925dff8f92eb241ea83e">the</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f i e f[u=\sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \ \ \ \ \ \ \ @E[fe_exp]@\f] where f s_1 f and f s_2 f are the element s two coordinates The mapping between the and f[x_i(s_1, s_2)=\sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \(i=1, 2) \ \ \ \ \ \ @E[x_fe_exp]@\f] where f where the nodal positions vary as function of the time derivative of the nodal f represents the rate of change of f u f at the moving rather than the time derivative of f u f at a fixed Eulerian f partial u partial f the quantity required in the R[2DHeat] The rate of change of f u f at a moving f may also be expressed by the material f[\left. \frac{D u}{Dt}\right|_{\mbox{\small node} \ j}=\frac{\partial u}{\partial t}+\sum_{i=1}^2 v_{ij} \ \frac{\partial u}{\partial x_i}\f] where f[v_{ij}=\frac{dX_{ij}^{(E)}}{dt}\f] is the i th velocity component of node often referred to as the mesh velocity The rate of change of f u experienced at the(fixed) spatial position that coincides with the current position of node j is therefore given by \f[\frac</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00148">two_d_unsteady_heat_ALE.txt:148</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a11c023c4b279a721c5993871b7511b04"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a11c023c4b279a721c5993871b7511b04">value</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f i e f[u=\sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \ \ \ \ \ \ \ @E[fe_exp]@\f] where f s_1 f and f s_2 f are the element s two coordinates The mapping between the and f[x_i(s_1, s_2)=\sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \(i=1, 2) \ \ \ \ \ \ @E[x_fe_exp]@\f] where f where the nodal positions vary as function of the time derivative of the nodal value</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00128">two_d_unsteady_heat_ALE.txt:128</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a894ed108f0b1a06cb19d6a9f137f4067"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a894ed108f0b1a06cb19d6a9f137f4067">HREF</a></div><div class="ttdeci">&quot;../../../poisson/fish_poisson2/html/index.html&quot;&gt;earlier example,&lt;/A &gt; that in \c oomph-lib curvilinear, moving boundaries are typically represented by(time-dependent) \c GeomObjects which define the \c MacroElement boundaries of the \c Domain object associated with the \c Mesh. In this case, the update of the nodal positions may be performed by updating the parameters that control the shape of the \c GeomObject and calling the \c Mesh 's node-update function \c Mesh::node_update(), as illustrated in the&lt; A HREF=&quot;../../../poisson/fish_poisson2/html/index.html&quot;&gt;earlier example.&lt;/A &gt; It is also possible(and, in fact, much easier) to include the time-dependence of the domain boundaries into the definition of the \c GeomObject, by making its shape, described by \c GeomObject::position(...), a function of time. In that case, the update of the nodal positions in response to the boundary motion merely requires a call to \c Mesh::node_update() in \c Problem::actions_before_implicit_timestep(). This is the approach we take in the present problem.&lt; HR &gt;&lt; HR &gt; \section namespace Global parameters and functions As usual, we store the problem parameters in a namespace, \c TanhSolnForUnsteadyHeat, in which we also specify the source function, the prescribed flux along the Neumann boundary and the exact solution. The namespace is identical to that used in&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; the fixed domain example.&lt;/A &gt;&lt; HR &gt;&lt; HR &gt; \section ellipse Representing the moving curvilinear domain boundary by a time-dependent GeomObject As discussed above, we will incorporate the time-dependence of the moving curvilinear boundary into the specification of the \c GeomObject that defines that boundary. For this purpose we represent the elliptical boundary by the \c GeomObject \c MyEllipse. Its constructor stores the geometric parameters(the mean values of the ellipse 's half axes, \f$ a \f$ and \f$ b \f$, the amplitude of their temporal variations \f$ \hat{a} \f$ and \f$ \hat{b} \f$, and the period of the oscillation, \f$ \hat{T} \f$, in its private member data. We also store a pointer to a \c Time object to give the \c GeomObject access to the &quot;current&quot; and &quot;previous&quot; values of the &quot;continuous time&quot;. The destructor can remain empty. \dontinclude two_d_unsteady_heat_ALE.cc \skipline start_of_MyEllipse \until ~MyEllipse The &quot;steady&quot; version of the \c position(...) function must return the position vector to the point on the \c GeomObject, identified by its intrinsic coordinate \c xi, and evaluated at the current value of the continuous time, which we extract from \c Time::time():\skipline Current position \until end of position The &quot;time-dependent&quot; version of the \c position(...) function must return the position vector to the \c GeomObject, evaluated at the \c t - th previous timestep. The value of the continuous time at that timestep is available from from \c Time::time(t):\skipline Parametrised \until end of position We omit the code that defines the private member data.&lt; HR &gt;&lt; HR &gt; \section main The main function Since the deformation of the domain and the update of the nodal positions will be handled automatically by adding a call to \c Mesh::node_update() to \c Problem::actions_before_implicit_timestep(), the driver code for this problem is exactly the same as that in the&lt; A HREF=&quot;../../two_d_unsteady_heat_adapt/html/index.html&quot;&gt; previous example in a fixed domain.&lt;/A &gt;&lt; HR &gt;&lt; HR &gt; \section problem_class The Problem class The \c Problem class and most of its member functions are exactly the same as in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; previous example.&lt;/A &gt;&lt; HR &gt;&lt; HR &gt; \section constructor The Problem constructor The \c Problem constructor is identical to the fixed-mesh version in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; previous example,&lt;/A &gt; apart from the fact that we use the \c MyEllipse \c GeomObject to define the curvilinear \c Mesh boundary. Here is the relevant code fragment:\dontinclude two_d_unsteady_heat_ALE.cc \skipline Setup mesh \until time_stepper_pt()&lt; HR &gt;&lt; HR &gt; \section actions_before_implicit_timestep Actions before timestep As discussed above, the addition of a single line to \c Problem::actions_before_implicit_timestep() suffices to update the nodal positions in response to the changes in the domain boundary. \dontinclude two_d_unsteady_heat_ALE.cc \skipline start of actions_before_implicit_timestep \until Bulk_mesh_pt-&gt;node_update() HREF</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00315">two_d_unsteady_heat_ALE.txt:315</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a1a2ded44bec5eca120d5a3aa8b21c3de"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a1a2ded44bec5eca120d5a3aa8b21c3de">timesteps</a></div><div class="ttdeci">The rest of this function is identical to the that in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; fixed domain version&lt;/A &gt; and updates the nodal values on the Dirichlet boundaries according to the values given by the exact solution&lt; HR &gt;&lt; HR &gt; section set_init Setting the initial condition The only other change to the code occurs in the assignment of the initial conditions The c Nodes positional history values are given by the positions at which the c Nodes would have been at previous timesteps the history values themselves must be computed by evaluating the exact solution at the position at which the c Nodes would have been at those timesteps This is achieved with a few minor changes to the previous version of this function We loop over the previous timesteps</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00336">two_d_unsteady_heat_ALE.txt:336</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_ace2d98af3eb8dafa130cdd1e9b1531c7"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#ace2d98af3eb8dafa130cdd1e9b1531c7">profile</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh profile</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00072">two_d_unsteady_heat_ALE.txt:72</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a3346ca6572f0a692ba50fed07425ebee"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a3346ca6572f0a692ba50fed07425ebee">x_2</a></div><div class="ttdeci">mainpage Example x_2</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00020">two_d_unsteady_heat_ALE.txt:20</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a448dcd1dd90b3b10accce75be65dd8c3"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a448dcd1dd90b3b10accce75be65dd8c3">Phi</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f Phi</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00086">two_d_unsteady_heat_ALE.txt:86</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_ab24abbad52665f6997a41b59d1e7557b"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#ab24abbad52665f6997a41b59d1e7557b">conditions</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary conditions</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00035">two_d_unsteady_heat_ALE.txt:35</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a3ab31bea61ba3fd05c3e77863edb8e8d"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a3ab31bea61ba3fd05c3e77863edb8e8d">example</a></div><div class="ttdeci">a different one may be assigned with the access function c as demonstrated in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; exercise in our earlier example</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00173">two_d_unsteady_heat_ALE.txt:173</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_aa1498410ff21f68b351178f28ccac084"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#aa1498410ff21f68b351178f28ccac084">node</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f taken from&lt; A HREF=&quot;../figures/unsteady_heat_contour.avi&quot;&gt; another animation of the solution&lt;/A &gt; I w textwidth unsteady_heat_contour Contour plot of the solution&lt; HR &gt;&lt; HR &gt; section ale the equation class that forms the basis for the isoparametric c QUnsteadyHeatElements is based on the Arbitrary Lagrangian R[2DHeat] Within each the solution is represented by interpolation between the element s f i e f[u=\sum_{j=1}^{N_{node}^{(E)}} U_j^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \ \ \ \ \ \ \ @E[fe_exp]@\f] where f s_1 f and f s_2 f are the element s two coordinates The mapping between the and f[x_i(s_1, s_2)=\sum_{j=1}^{N_{node}^{(E)}} X_{ij}^{(E)}(t) \ \psi_{j}(s_1, s_2),\ \ \ \(i=1, 2) \ \ \ \ \ \ @E[x_fe_exp]@\f] where f where the nodal positions vary as function of the time derivative of the nodal f represents the rate of change of f u f at the moving node</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00130">two_d_unsteady_heat_ALE.txt:130</a></div></div>
<div class="ttc" id="aclassMyEllipse_html"><div class="ttname"><a href="classMyEllipse.html">MyEllipse</a></div><div class="ttdoc">Oscillating ellipse.</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8cc_source.html#l00049">two_d_unsteady_heat_ALE.cc:49</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_ad36ea271dcbff4d1bbe96cad1941e8ab"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#ad36ea271dcbff4d1bbe96cad1941e8ab">f</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D f</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00023">two_d_unsteady_heat_ALE.txt:23</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a48453bddea50060c4a5495d525e48632"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a48453bddea50060c4a5495d525e48632">timestep</a></div><div class="ttdeci">The rest of this function is identical to the that in the&lt; A HREF=&quot;../../two_d_unsteady_heat/html/index.html&quot;&gt; fixed domain version&lt;/A &gt; and updates the nodal values on the Dirichlet boundaries according to the values given by the exact solution&lt; HR &gt;&lt; HR &gt; section set_init Setting the initial condition The only other change to the code occurs in the assignment of the initial conditions The c Nodes positional history values are given by the positions at which the c Nodes would have been at previous timesteps the history values themselves must be computed by evaluating the exact solution at the position at which the c Nodes would have been at those timesteps This is achieved with a few minor changes to the previous version of this function We loop over the previous reconstruct the value of the continuous time at that timestep</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00337">two_d_unsteady_heat_ALE.txt:337</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a28adcfef067a9d977a8c19fc52de4444"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a28adcfef067a9d977a8c19fc52de4444">axis</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f axis</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00080">two_d_unsteady_heat_ALE.txt:80</a></div></div>
<div class="ttc" id="atwo__d__unsteady__heat__ALE_8txt_html_a17afc54b07ea07dfae88632849d5a071"><div class="ttname"><a href="two__d__unsteady__heat__ALE_8txt.html#a17afc54b07ea07dfae88632849d5a071">beta</a></div><div class="ttdeci">mainpage Example t E[2DHeat] f in the domain f D bounded by the coordinate axes and the time dependent ellipse f[\mathbf{r}_{ellipse}(\xi, t)=\left(\begin{array}{c}\big(a+\hat{a}\sin(2\pi t/\hat{T}) \big) \cos(\xi) \\\big(b+\hat{b}\sin(2\pi t/\hat{T}) \big) \sin(\xi)\end{array}\right), \ \ \ \ \ \ \ \ \ \ @E[Domain]@\f] subject to Neumann boundary f[\left. \frac{\partial u}{\partial n}\right|_{\partial D_{Neumann}}=- \left. \frac{\partial u}{\partial x_2}\right|_{\partial D_{Neumann}}=g_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC2]@\f] along the horizontal domain boundary f partial and to Dirichlet boundary f[\left. u\right|_{\partial D_{Dirichlet}}=h_0, \ \ \ \ \ \ \ \ \ \ @E[2DHeat_BC1]@\f] elsewhere I w textwidth domain Sketch of the time dependent domain and the boundary conditions The initial conditions are given by f[u(x_1, x_2, t=0)=k_0(x_1, x_2),\ \ \ \ \ \ \ \ \ \ @E[2DHeat_IC1]@\f] where the functions f h_0 f and f k_0 f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the functions f h_0 f and f k_0 f so that f[u_0(x_1, x_2, t)=\tanh\bigg[1-\alpha\bigg(\tan\Phi\big(x_1-\beta\tanh[\gamma\cos\left(2\pit\right)]\big) - x_2\bigg)\bigg] \ \ \ \ \ \ \ \ \ \ @E[ExactSoln2]@\f] is the exact solution The solution represents the usual tanh whose steepness is controlled by the parameter f alpha f so that for f alpha gg f the solution approaches a step The step is oriented at an angle f Phi f against the f x_1 f axis and its position varies periodically The parameter f beta f controls the amplitude of the step s lateral while f gamma f determines the rate at which its position changes For f gamma gg the step remains stationary for most of the period and then translates rapidly parallel to the f x_1 f making this a very challenging problem The figure below shows a snapshot of the&lt; A HREF=&quot;../figures/step_soln.avi&quot;&gt; animated obtained from the spatially adaptive simulation discussed for the parameter values f beta</div><div class="ttdef"><b>Definition:</b> <a href="two__d__unsteady__heat__ALE_8txt_source.html#l00086">two_d_unsteady_heat_ALE.txt:86</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 13 2021 15:03:27
        </div>
      </div>
    </footer>
</body>
</html>

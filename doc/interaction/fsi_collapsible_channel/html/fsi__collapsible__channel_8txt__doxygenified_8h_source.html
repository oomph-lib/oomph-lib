<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: fsi_collapsible_channel.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fsi_collapsible_channel.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fsi__collapsible__channel_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage A fluid-structure-interaction problem: Flow in a 2D collapsible channel</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">In this document we discuss the solution of a standard </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">fluid-structure interaction problem -- finite-Reynolds-number flow </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">in a 2D collapsible channel. We shall demonstrate that the driver code</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">for this multi-physics problem is a straightforward combination of the driver</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">codes for the two corresponding single-physics problems</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">discussed earlier:</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">- &lt;B&gt;&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">  Flow in a 2D channel with prescribed wall motion:&lt;/A&gt;&lt;/B&gt;\n\n</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">  In this single-physics problem, we represented the moving wall by</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">  a \c GeomObject, and created a \c Domain object to provide     </span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">  an analytical representation of the domain boundary.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">  We discretised the Navier-Stokes equations with 2D</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">  Crouzeix-Raviart elements and updated their nodal positions</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">  (in response to the prescribed changes in the wall position) by their</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">  \c MacroElement representation.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">- &lt;B&gt;&lt;A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">  The deformation of a pressure-loaded elastic beam:&lt;/A&gt;&lt;/B&gt; \n\n</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">  In this single-physics problem, we discretised the elastic</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">  beam with \c HermiteBeamElements and computed its deformation</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">  (determined by the positional degrees of freedom, stored</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">  at the \c HermiteBeamElement&#39;s \c SolidNodes) in response to the prescribed</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">  pressure load.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\section problem The problem </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">&lt;B&gt;Flow in a 2D collapsible channel &lt;/B&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">The figure below shows a sketch of the problem: Flow is driven by a </span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">prescribed pressure drop through a 2D channel of width </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">\f$ H^* \f$ and total length</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\f$ L^*_{total} = L^*_{up} + L^*_{collapsible} + L^*_{down}. \f$</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">The upstream and downstream lengths of the channel are rigid, whereas</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">the upper wall in the central section is an elastic membrane whose</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">shape is parametrised by a Lagrangian coordinate, \f$ \xi^* \f$ , so </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">that the position vector to the moving wall is given by </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">\f$ {\bf R}_w^*(\xi^*,t^*) \f$ . The wall is loaded by the</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">external pressure \f$ p_{ext}^* \f$ and by the traction </span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">that the viscous fluid exerts on it. The components of the load </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">vector \f$ {\bf f}^* \f$ that acts on the wall are </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">therefore given by </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\f[  </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">f^*_{i} = (p^* - p^*_{ext}) N_i -</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\mu \left(</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\frac{\partial u^*_i}{\partial x^*_j} +</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\frac{\partial u^*_j}{\partial x^*_i} </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">\right)</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">N_j \ \ \ \ \ \ \mbox{for $i=1,2$,}</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">where \f$ N_i \ (\mbox{\ for \ } i=1,2) \f$ are </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">the components of the outer unit normal on the fluid domain. </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">\image html collapsible_channel_sketch.gif &quot;Sketch of the problem. &quot; </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">\image latex collapsible_channel_sketch.eps &quot;Sketch of the problem. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">We scale all lengths on the channel width, \f$ H^* \f$ , use the</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">average velocity through the undeformed </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">channel, \f$ U =P^*_{up} H^{*2}/(12 \mu L^*_{total}) \f$ , to scale </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">the velocities, and use \f$ H^{*}/U \f$ to non-dimensionalise</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">time. Finally, the fluid pressure is non-dimensionalised on the viscous scale </span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">\f$ p^{*} = p \mu U/H^{*}\f$.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">(As usual, asterisks distinguish dimensional </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">parameters from their non-dimensional equivalents.) </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">With this non-dimensionalisation, the Navier-Stokes equations have</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">the same form as in the &lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;earlier</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">example with prescribed wall motion:&lt;/A&gt;</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">Re\left(St\frac{\partial u_i}{\partial t} +  </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">u_j\frac{\partial u_i}{\partial x_j}\right) =</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i} +</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left(</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0,</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">with \f$ St=1 \f$. As </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">before&lt;/A&gt;, the flow is subject to the following boundary and initial</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">conditions:</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">- Initial condition: Poiseuille flow, i.e. </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">  {\bf u}(x_1,x_2,t=0) = {\bf u}_{Poiseuille}(x_1,x_2) =   </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">  6 \ x_2 \  (1-x_2) \ {\bf e}_1.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">  \ \ \ \ \ \ \ \ \ \ (3)</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">- Parallel inflow, \f$ {\bf u} \cdot {\bf e}_2 = {\bf 0}, \f$</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">  and an applied axial traction of \f$ {\bf t} \cdot {\bf e}_1 = </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">  p_{up} = 12 \ L_{total} \f$ at the upstream end, \f$ x_1=0\f$.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">- Parallel, axially traction-free outflow at the downstream end, i.e.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">  \f$ {\bf u} \cdot {\bf e}_2 = {\bf 0} \f$ and  </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">  \f$ {\bf t} \cdot {\bf e}_1 = p_{down} = 0  \f$ at  \f$</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">  x_1=L_{total}. \f$ </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">- No slip on all channel walls, i.e.  \f$ {\bf u} = {\bf 0} \f$ on </span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">  the rigid walls and </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">  {\bf u} = \frac{\partial {\bf R}_w}{\partial t}</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">  \mbox{\ \ \ \ on the moving wall,}</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">  \ \ \ \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">These boundary conditions are identical to those in the problem with</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">prescribed wall motion, apart from the fact that in the present</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">problem the wall motion, described by \f$ {\bf R}_w(\xi, t), \f$</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">has to be determined as part of the solution.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">We model the elastic membrane as a thin-walled elastic Kirchhoff-Love</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">beam of wall thickness \f$ h^* \f$ , subject to an axial (2nd Piola-Kirchhoff)</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">pre-stress \f$ \sigma^*_0. \f$ The beam&#39; effective (1D) elastic modulus</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">is given by \f$ E_{eff} = E/(1-\nu^2), \f$ where \f$ E \f$ and \f$ \nu \f$</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">are its 3D Young&#39;s modulus and Poisson&#39;s ratio, respectively.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">The beam&#39;s deformation is governed by the principle of virtual</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">displacements, discussed in detail </span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt;elsewhere.&lt;/A&gt; </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">As in the Navier-Stokes equations, we scale all lengths in</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">the beam problem on the channel&#39;s width, \f$ H^*. \f$ The</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">non-dimensional position vector</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">\f$ {\bf r}_w(\xi) \f$ to the undeformed wall is then given by</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">{\bf r}_w(\xi) = </span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">L_{up} + \xi  \\</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">1 </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">\right) \ \ \ \ \ \ \mbox{where $\xi \in [0,L_{collapsible}].$}</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (5)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">Our non-dimensionalisation of the principle of virtual displacements</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">requires all stresses and tractions to be non-dimensionalised </span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">on the beam&#39;s (effective 1D) elastic modulus, \f$ E_{eff} \f$ ,</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">therefore we define the non-dimensional external pressure</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">as \f$ p_{ext} = p_{ext}^{*}/E_{eff}. \f$ The non-dimensional </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">load vector \f$ {\bf f} = {\bf f}^{*}/E_{eff} \f$ </span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">that acts on the wall is then given by</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">f_i = - p_{ext} N_i  + Q \left( p N_i -</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} </span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">\right) N_j \right) </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">\ \ \ \ \ \ \mbox{for $i=1,2,$}</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">Q = \frac{\mu U^*}{E_{eff} H^*_{tot}}</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">is the ratio of the fluid pressure scale, \f$ \mu U/H^* \f$ ,</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">used to non-dimensionalise the Navier-Stokes equations, to the</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">beam&#39;s effective elastic modulus, \f$ E_{eff} \f$. The parameter \f$ Q</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">\f$ therefore indicates the strength of the fluid-structure</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">interaction. In particular, if \f$ Q=0 \f$ the wall deformation is </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">not affected by the fluid flow. </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">\section reslt Results</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">The figure below shows a snapshot of the flow field, taken from </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">&lt;A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt;the animation of the</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">computational results&lt;/A&gt;. The first four figures show (from top left to bottom</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">right) &quot;carpet plots&quot; of the axial and transverse velocities,</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">the axial component of the perturbation velocity </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">\f$ {\bf u} - {\bf u}_{Poiseuille} \f$ , and the pressure</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">distribution. The 2D contour plot at the bottom</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">of the figure shows a contour plot of the pressure and a few</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">instantaneous streamlines.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">The overall structure of the flow field is very similar to that observed</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">in the corresponding  </span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">problem with prescribed wall motion:&lt;/A&gt; The wall oscillation generates</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">a large-amplitude sloshing flow that is superimposed on the pressure-driven</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">Poiseuille flow. At the instant shown in this figure, the wall is moving</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">inwards. Consequently, the sloshing flow generated in the upstream </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">(downstream)  rigid sections is directed against (in the same)  </span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">direction as that of the pressure-driven mean flow.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">\image html fsi_taylor_hood_flow.gif &quot;Snapshot from the animation of the flow field. &quot; </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">\image latex fsi_taylor_hood_flow.eps &quot;Snapshot from the animation of the flow field. &quot; width=0.8\textwidth</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">In the present problem, the wall motion is, of course, not prescribed</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">but determined as part of the overall solution. </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">&lt;A HREF=&quot;http://www.maths.man.ac.uk/~mheil/MATTHIAS/PDF/JensenHeil2003.pdf&quot;&gt;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">Jensen \&amp; Heil&#39;s (2003)&lt;/A&gt; asymptotic analysis of the problem shows that</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">the period of the oscillations is determined by the balance between fluid</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">inertia and the elastic restoring forces.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">In certain parameter regimes (at sufficiently large Reynolds number), </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">the wall can extract energy from the pressure-driven mean flow, </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">causing the oscillations to grow in amplitude. In the present</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">example, the Reynolds number is too small for this to happen and</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">viscous dissipation causes the oscillations to decay, as shown in this</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">plot.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">\image html trace_fsi_taylor_hood.gif &quot;Time-trace of the axial velocities at two control points in the upstream and downstream cross-sections, and the vertical position of a control point on the wall. &quot; </span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">\image latex trace_fsi_taylor_hood.eps &quot;Time-trace of the axial velocities at two control points in the upstream and downstream cross-sections, and the vertical position of a control point on the wall. &quot; width=0.20\textwidth</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">\section overview Overview: How to solve fluid-structure interaction problems with oomph-lib</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">Before attempting to solve a fluid-structure interaction problem,</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">we generally recommend to first study the constituent</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">single-physics problems in isolation, i.e.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">- Discretise the solid mechanics problem with a suitable </span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">  \c SolidFiniteElement (e.g.  a \c HermiteBeamElement) and determine the</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">  wall deformation in response to a prescribed external load. If possible,</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">  choose a load that is vaguely &quot;representative&quot; of the loads expected</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">  in the actual fluid-structure interaction problem. </span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">- Discretise the fluid mechanics problem in a domain in which </span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">  the deformation of the &quot;elastic boundary&quot; is described by </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">  a \c GeomObject that performs a prescribed motion. </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">  Choose a suitable node-update strategy to adjust the position</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">  of the fluid nodes in response to the (prescribed) motion of the </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  &quot;elastic boundary&quot;. (As demonstrated in many previous examples,</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">  a \c Domain/MacroElement - based node-update method is</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">  very easy to implement.) If possible, try to impose a wall </span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">  motion that is &quot;representative&quot; of the type of wall motion expected in </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">  the actual fluid-structure interaction problem.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">Once the behaviour of the two isolated single-physics problems is </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">sufficiently well understood (e.g. what spatial discretisations are</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">required, etc.), combine the two single-physics problems to a</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">fully-coupled problem. The coupling introduces two types of interactions </span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">that must be incorporated into the computational framework:</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">-# The position of the nodes in the fluid mesh depends on the wall</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">   shape. Since the wall shape is now determined by the degrees of</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">   freedom in the \c SolidFiniteElements that we use to discretise the</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">   wall, we must ensure that: </span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">   -# The node-update operations that we developed for problems</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">      with prescribed wall motion (in which the position of the</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">      curvilinear domain boundaries is determined by \c GeomObjects)</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">      also work for problems in which the curvilinear domain</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">      boundaries are represented by \c SolidFiniteElements.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">   -# The dependence of the residuals of the fluid elements</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">      on the solid-mechanics degrees of freedom that affect the</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">      positions of the fluid nodes (via the node-update </span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">      operation) are taken into account when computing </span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">      the fluid elements&#39; Jacobian matrices. (See the discussion of</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">      the &quot;shape derivatives&quot; in the </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">      &lt;A HREF=&quot;../../macro_element_free_boundary_poisson/html/index.html&quot;&gt; </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">      &quot;toy&quot; free-boundary Poisson problem&lt;/A&gt; for details.)  </span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">-# The \c SolidFiniteElements are not only loaded by the external load</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">   but also by the traction that the fluid exerts on</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">   them. When computing the residuals of the</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">   \c SolidFiniteElements we have to evaluate the combined load </span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">   vector at the \c SolidFiniteElement&#39;s Gauss points. We therefore </span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">   have to provide a lookup scheme that specifies: </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">   -# which fluid element is adjacent to </span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">      a given Gauss point in the \c SolidFiniteElements, and</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">   -# which (fluid) degrees of freedom affect the fluid traction at that </span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">      point. </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">   .</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">   The dependence of the residuals of the \c SolidFiniteElements on these</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">   (fluid) degrees of freedom must be taken into account when </span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">   computing the \c SolidFiniteElement&#39;s Jacobian matrix.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">. </span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">\c oomph-lib provides a number of high-level functions that</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">allow the required lookup schemes to be generated completely</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">automatically. In the following sections we shall provide a brief </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">discussion of the methodology but we stress that the details</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">are not particularly important for the &quot;user&quot;. If you just</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">want to &quot;use&quot; \c oomph-lib&#39;s fluid-structure interaction </span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">capabilities and don&#39;t care too much about the technical</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">details, you may wish to skip the next few sections and continue with the \ref</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">driver_code, where we demonstrate that, apart from a few trivial </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">modifications,  the driver code for the</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">fully-coupled fluid-structure interaction problem is</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">a straightforward combination of the two single-physics driver codes.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">\section how_its_done Brief discussion of the implementation</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">\subsection mesh MacroElement-based (fluid-)node updates in FSI problems </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">\subsubsection shape_deriv The shape derivatives</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">When discussing our </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">&lt;A HREF=&quot;../../macro_element_free_boundary_poisson/html/index.html&quot;&gt; &quot;toy&quot;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">free-boundary Poisson problem&lt;/A&gt; we demonstrated how</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">a &quot;bulk&quot; element&#39;s \c MacroElement - representation allows the efficient </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">automatic evaluation of the &quot;shape derivatives&quot; -- the derivatives of the </span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">&quot;bulk&quot; equations (here the Navier-Stokes equations) with </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">respect to the \c Data values (here the nodal positions in the beam elements) </span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">that determine the shape of the domain boundary. The methodology </span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">discussed in  the context of the &quot;toy&quot; problem may also be used </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">for genuine fluid-structure interaction problems, such as the problem </span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">considered here, provided</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">-# A \c MacroElement/Domain - based Mesh is used to discretise the</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">   fluid domain.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">-# The moving boundary is represented by a \c GeomObject whose </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">   member function \c GeomObject::geom_data_pt(...) provides</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">   access to its &quot;geometric&quot; \c Data, i.e. the \c Data that affects </span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">   its shape.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">Condition 1 is satisfied as the &lt;A HREF=&quot;../../../meshes/mesh_list/html/index.html#collapsible_channel&quot;&gt;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">&lt;CODE&gt;CollapsibleChannelMesh&lt;/CODE&gt;&lt;/A&gt; used for the simulation of the</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">single-physics fluids problem with prescribed wall motion&lt;/A&gt; employs the \c</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">CollapsibleChannelDomain to perform the node update in response to </span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">changes in the domain boundary. Multiple inheritance may therefore</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">be used to upgrade the existing &lt;A HREF=&quot;../../../meshes/mesh_list/html/index.html#collapsible_channel&quot;&gt;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">&lt;CODE&gt;CollapsibleChannelMesh&lt;/CODE&gt;&lt;/A&gt; to a mesh that is derived</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">from the \c MacroElementNodeUpdateMesh base class. The dependence</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">of the residuals of the &quot;bulk&quot; (fluid) elements on the geometric \c</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">Data that affects its nodal positions is automatically taken into </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">account if the &quot;bulk&quot; (fluid) elements (of type \c BULK_ELEMENT, say)</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">are &quot;upgraded&quot; to the &quot;wrapped&quot; class </span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">\c MacroElementNodeUpdateElement&lt;BULK_ELEMENT&gt;. We refer to the discussion</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">of the &lt;A HREF=&quot;../../macro_element_free_boundary_poisson/html/index.html&quot;&gt; </span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">&quot;toy&quot; free-boundary Poisson problem&lt;/A&gt; for details of this methodology. </span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">\subsubsection wall_geom_object Representing the wall mesh as a GeomObject</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">What remains to be done is to represent the wall (discretised</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">by the \c SolidFiniteElements contained in the wall mesh) as a \c GeomObject.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">For this purpose, \c oomph-lib provides the class </span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">\code </span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">class MeshAsGeomObject : public GeomObject</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">\endcode </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">whose constructor takes a pointer to the \c Mesh that is to be</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">represented as a \c GeomObject. The Lagrangian and Eulerian dimensions </span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">of the mesh are taken to be the dimension of elements and the dimension</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">of the nodes, respectively. The conversion from \c Mesh into \c</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">GeomObject only makes sense if the element is derived from a </span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">\c FiniteElement, itself a \c GeomObject, which has</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">associated Lagrangian (local) and Eulerian coordinate systems.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">In our collapsible channel problem, the Lagrangian dimension is one </span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">because the wall </span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">is parametrised by a single intrinsic coordinate (the shape of the</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">mesh&#39;s constituent elements is parametrised</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">by a single local coordinate), and the Eulerian dimension is two </span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">because the nodes</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">in the wall mesh have two Eulerian coordinates. Assuming</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">that \c Wall_mesh_pt stores a pointer to the wall mesh, the</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">code</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">\dontinclude fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">\skipline Build a geometric object</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">\until new MeshAsGeomObject</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">creates a \c GeomObject representation of the wall mesh that</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">allows us to obtain the position of a material point on the wall</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">(parametrised by its Lagrangian coordinate \f$\xi \f$) from</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">the \c GeomObject::position(...) function. For instance,</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">the following code computes the position vector \f$ {\bf r} \f$ to the</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">material point on the deformed wall, located at  \f$ \xi=0.5. \f$</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">Vector&lt;double&gt; xi(1);</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">xi[0]=0.5;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">Vector&lt;double&gt; r(2);</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">wall_geom_object-&gt;position(xi,r);</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">Here is a graphical illustration of the various representations of</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">the domain boundary:</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">&lt;B&gt;1. A &quot;normal&quot; GeomObject&lt;/B&gt;</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">In single-physics problems with prescribed boundary motion</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">the domain boundary may be represented by a \c GeomObject. </span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">The \c GeomObject provides a parametrisation of its shape</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">in terms of an intrinsic coordinate, \f$ \zeta \f$ , as shown in this</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">sketch:</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">\image html wall_mesh_geometry_sketch1.gif &quot;A geometric object parametrised by an intrinsic coordinate. &quot; </span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">\image latex wall_mesh_geometry_sketch1.eps &quot;A geometric object parametrised by an intrinsic coordinate. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">The function \c GeomObject::position(zeta,r)</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">computes the position vector \c r to a point on the \c GeomObject,</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">as identified by its intrinsic coordinate \c zeta.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">&lt;B&gt;2. A beam/shell structure&lt;/B&gt;</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">In beam/shell problems, the shape of the deformed structure</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">is parametrised by its Lagrangian coordinate , \f$\xi. \f$</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">\image html wall_mesh_geometry_sketch2.gif &quot;A (continuous) beam structure, parametrised by a Lagrangian coordinate. &quot; </span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">\image latex wall_mesh_geometry_sketch2.eps &quot;A (continuous) beam structure, parametrised by a Lagrangian coordinate. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">Beam/shell structures may therefore act as \c GeomObjects if</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">we interpret their Lagrangian coordinate, \f$ \xi \f$ , as the</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">\c GeomObject&#39;s intrinsic coordinate, \f$ \zeta \f$. </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">&lt;B&gt;3. A discretised beam/shell structure&lt;/B&gt;</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">In an \c oomph-lib computation, the beam/shell structure will,</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">of course, have been discretised by a number of \c SolidFiniteElements. The \c</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">MeshAsGeomObject discussed above, is therefore a &quot;compound&quot; </span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">\c GeomObject that contains a number of sub-objects -- the </span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">mesh&#39;s constituent \c SolidFiniteElements. Within the &quot;compound&quot;</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">\c GeomObject each sub-object acts as a \c GeomObject in its own </span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">right -- the shape of a \c SolidFiniteElement is parametrised </span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">by its local coordinate \c s. </span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">\image html wall_mesh_geometry_sketch3.gif &quot;A discretised beam structure. &quot; </span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">\image latex wall_mesh_geometry_sketch3.eps &quot;A discretised beam structure. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">The \c MeshAsGeomObject::position(...) function therefore determines</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">the position vector to the point labelled by the Lagrangian coordinate</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">\f$ \xi \f$ (i.e. the \c GeomObject&#39;s intrinsic coordinate, \f$ \zeta \f$) in</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">a two-stage process: First it determines which of its constituent</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">\c SolidFiniteElements &quot;contains&quot; the relevant material point (This is possible</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">because the function \c SolidFiniteElement::interpolated_xi(...)</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">provides access to the Lagrangian coordinate inside the element)</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">and then uses the \c SolidFiniteElement::interpolated_x(...)</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">function to determine the Eulerian coordinates of that point.</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">\subsection fsi_wall_elements Applying the fluid-traction to the wall elements: FSIWallElements</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">Next, we shall discuss how the fluid traction is added to the load terms</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">in the wall equations. As mentioned above, the computation of the</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">residuals of the wall equations requires the evaluation of the</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">combined load vector at the Gauss points in the wall elements. Furthermore,</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">the dependence of the residuals on those (fluid) degrees of freedom</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">that affect the traction must be taken into account when computing</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">the wall element&#39;s Jacobian matrix. Storage for the various lookup schemes </span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">required for such computations is provided in the virtual base class</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">\c FSIWallElement whose inheritance structure is as follows:</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">class FSIWallElement : public virtual SolidFiniteElement, </span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">                       public virtual ElementWithExternalElement</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">The \c FiniteElement class inherits from \c GeomObject and by</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">default the \c GeomObject::position(...) function calls the function \c</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">FiniteElement::interpolate_x(..); in other words,</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">the element&#39;s local coordinate is</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">regarded as the intrinsic</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">coordinate that parametrises its shape. Thus we already have a standard </span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">interface through which an \c FSIWallElement can be used to parametrise </span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">the shape of (part of) the domain boundary. </span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">By inheriting from the \c SolidFiniteElement class,</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">we establish that the shape of the \c FSIWallElement is determined </span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">by the positional \c Data stored at its constituent \c SolidNodes. Recall that </span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">this information is required during the computation of the shape </span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">derivatives of the fluid equations.</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">The \c ElementWithExternalElement class provides the generic storage and helper</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">functions required to keep track of the external elements that are</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">adjacent to Gauss points in any \c FiniteElement, see also the</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">tutorial on </span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">&lt;a href=&quot;../../../multi_physics/multi_domain_ref_b_convect/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">Boussinesq convection with a multi-domain approach. &lt;/a&gt;</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">In the \c</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">FSIWallElement, it is the fluid elements that load the structure which</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">are adjacent to the Gauss points.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">The various lookup schemes required to determine these fluid elements</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">may be generated completely automatically by the helper function</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">template&lt;class FLUID_ELEMENT, unsigned DIM_FLUID&gt;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">void FSI_functions::setup_fluid_load_info_for_solid_elements(</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">     Problem* problem_pt,</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">     const unsigned &amp;boundary_in_fluid_mesh,</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">     Mesh* const&amp; fluid_mesh_pt,</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">     Mesh* const&amp; solid_mesh_pt);</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">which is defined in the namespace \c FSI_functions. The template</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">parameters \c FLUID_ELEMENT and \c DIM_FLUID specify the type of </span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">the fluid element and its spatial (Eulerian) dimension, respectively. </span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">The arguments are the pointer to the problem, the number of the</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">boundary in the fluid mesh adjacent to the elastic wall, and the </span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">pointers to the fluid and wall meshes. The function assumes that </span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">boundary coordinates have been set for the fluid nodes on the mesh </span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">boundary specified by the argument \c boundary_in_fluid_mesh, and </span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">that these boundary coordinates are consistent with the</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">parametrisation of the wall mesh by its Lagrangian coordinate. (See </span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../poisson/fish_poisson2/html/index.html#boundary_coords&quot;&gt;the</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">discussion of the mesh generation procedures for domains with</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">curvilinear boundaries&lt;/A&gt; for a more detailed discussion </span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">of boundary coordinates for nodes.)</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">The \c FSIWallElement provides the protected member function</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">\c FSIWallElement::fluid_load_vector(...) which may be used</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">in a specific \c FSIWallElement (such as the \c FSIHermiteBeamElement)</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">to compute the fluid traction (on the solid mechanics stress scale), </span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">and to add it to any external load that may already be acting on </span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">the element. The conversion from the fluid to the solid </span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">non-dimensionalisation of the traction is performed automatically </span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">by multiplying the traction vector (on the fluid stress scale) </span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">obtained from the &quot;adjacent&quot; \c FSIFluidElement by the stress </span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">ratio \f$ Q \f$ which has a default value of \f$ Q=1. \f$ This </span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">default assignment may be overwritten by setting a pointer to a</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">variable that specifies \f$ Q \f$ by using the function </span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">\c FSIWallElement::q_pt().</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">The class also overloads the </span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">\c SolidFiniteElement::fill_in_contribution_to_jacobian(...) function</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">so that the derivatives of the residuals with </span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">respect to those unknowns that affect the fluid traction on the wall</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">are included when computing the element&#39;s Jacobian matrix. </span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">In the driver code, discussed below, we will discretise the wall</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">with \c FSHermiteBeamElements, a class that is composed</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">(by multiple inheritance) from the single-physics </span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">\c HermiteBeamElement and the \c FSIWallElement base class:</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">class FSIHermiteBeamElement : public virtual HermiteBeamElement, </span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">                              public virtual FSIWallElement</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">\subsubsection fsi_fluid_elements Obtaining the fluid traction from &quot;adjacent&quot; fluid elements: FSIFluidElements</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">Having provided a function that allows us to determine which </span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">fluid elements are located next to a given \c FSIWallElement, we have </span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">to define standard interfaces through which we can obtain the traction </span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">that the &quot;adjacent&quot; fluid element exerts onto the wall. Furthermore,</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">we have to determine which unknowns affect the fluid traction to</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">enable us to evaluate the derivatives of the wall residuals with</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">respect to these unknowns. Interfaces for the relevant functions </span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">are provided in the base class \c FSIFluidElement, whose most </span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">important member function (for the purpose of the present discussion) is </span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">\c FSIFluidElement::get_load(...). The purpose of this function is</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">to compute the traction exerted by the \c FSIFluidElement </span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">onto the adjacent \c FSIWallElement, given the outer unit</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">vector onto the \c FSIFluidElement. The \c FSIFluidElement class</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">has two further pure virtual member functions whose role is to </span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">determine the unknowns (e.g. velocity and pressure values) that </span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">affect the fluid traction. For newly developed fluid elements</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">these functions have to implemented on a case-by-case basis.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">However, all existing fluid elements in \c oomph-lib are already derived</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">from the \c FSIFluidElement class and therefore provide</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">a suitable implementation of these functions. It is therefore</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">not necessary to explicitly &quot;upgrade&quot; \c oomph-lib&#39;s fluid elements </span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">before using them in FSI computations.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">\section driver_code Overview of the driver code</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">The driver code for the fully-coupled</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">fluid-structure interaction problem is a straightforward</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">combination of the two single-physics codes with a few</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">trivial additional steps. The main steps in the problem setup are:</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">-# Create the wall mesh, using \c FSIHermiteBeamElements instead of</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">   \c HermiteBeamElements. </span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">-# &lt;B&gt;NEW:&lt;/B&gt; Create a \c GeomObject representation of the wall mesh, using</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">   the \c MeshAsGeomObject class. </span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">-# Create the fluid mesh, using elements of type</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">   \c MacroElementNodeUpdateElement&lt;QCrouzeixRaviartElement&lt;2&gt;&gt; instead of</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">   \c QCrouzeixRaviartElement&lt;2&gt;. Use the \c MeshAsGeomObject</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">   representation of the elastic wall, created in the previous step</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">   to represent the curvilinear domain boundary.</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">-# Build a mesh of traction elements that apply the</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">   prescribed-traction boundary condition at the inflow. </span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">   Add all three meshes (fluid, solid and traction mesh)</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">   to the \c Problem&#39;s collection of sub-meshes and build the global</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">   mesh.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">-# Pass the relevant function pointers (for Reynolds number, </span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">   external loads, etc) to the various elements and apply the boundary </span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">   conditions. </span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">-# &lt;B&gt;NEW:&lt;/B&gt; Call the function </span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">   \c FSI_functions::setup_fluid_load_info_for_solid_elements(...) to</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">   set up the lookup scheme that establishes which fluid</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">   elements affect the traction on the wall. </span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">-# Set up the equation numbering scheme. </span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">-# Done! . </span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">Most steps in this sequence are either identical to those </span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">in the corresponding single-physics codes, or require only trivial</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">modifications. Each of the two new steps (2 and 6) can be implemented</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">with a single line of code. Consequently, most of the driver</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">code, discussed in detail below, contains verbatim copies of code</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">segments from the respective single-physics codes. </span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">\section variables  Namespace for the global physical variables</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">The namespace for the &quot;global&quot; physical parameters contains</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">the same fluid parameters as in the &lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;collapsible</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">channel problem with prescribed wall motion&lt;/A&gt;: We define the Reynolds and</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">Womersley numbers and the fluid pressure at the upstream end, and</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">provide a function that specifies the applied traction at the inflow:</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">\dontinclude fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">\skipline start_of_physical_parameters</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">\until end traction</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">Next we define the wall parameters (wall thickness, prestress and</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">external pressure) and assign default values. Note that the function</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">that specifies the load on the wall contains only the load due to </span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">the external pressure -- the additional load due to the fluid traction</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">will be added automatically by the \c FSIWallElements, using the</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">lookup scheme set up by the function </span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">\c FSI_functions::setup_fluid_load_info_for_solid_elements(...)</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">discussed earlier.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">\until end of load</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">Finally, we define the interaction parameter \f$ Q \f$ and give it </span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">a default value. </span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">\until end of namespace </span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">\section undeformed The undeformed wall</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">We represent the undeformed geometry of the elastic wall, defined by </span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">equation (5), as a \c GeomObject, specifying</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">the \f$ x \f$-coordinate of its left end and its (constant) </span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">\f$ y \f$-coordinate as arguments to the constructor:</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">\dontinclude fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">\skipline start_of_underformed_wall</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">\until  }</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">The two versions of the \c position(...) function are straightforward:</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">\until end of position</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">Since the \c GeomObject is used to specify the undeformed shape of a</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">\c HermiteBeamElement, the function \c</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">GeomObject::d2position(...) must be implemented to define</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">the beam&#39;s curvature in the undeformed configuration. </span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">\until end of d2position</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">The private member data contains the two geometric parameters.</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">\until end_of_undeformed_wall</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment"> As with most previous time-dependent codes, we use command line</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">arguments to indicate if the code is run during \c oomph-lib&#39;s</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">self-test procedures. If command line arguments are specified, we use a</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">coarser discretisation and perform fewer timesteps.</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">After storing the command line arguments, we choose the number </span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">of elements in the mesh, and set the lengths of the domain.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">\dontinclude fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">\until  double ly=1.0;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">We assign values for the external pressure (on the</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">wall stiffness scale) and for the upstream fluid pressure (on the</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">fluid pressure scale). The latter is again chosen so that</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">in the absence of any wall deformation, the applied pressure </span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">difference would drive steady Poiseuille flow through the channel.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">\until P_up</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">We build the problem with 2D quadrilateral Crouzeix-Raviart elements, </span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">&quot;upgraded&quot; to \c MacroElementNodeUpdateElements. This ensures that the &quot;shape</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">derivatives&quot; (the derivatives of the fluid residuals with respect</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">to the solid mechanics degrees of freedom that affect the nodal </span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">positions in the fluid elements), are incorporated into the</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">fluid elements&#39; Jacobian matrices.</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">\skipline Build the problem with QCrouzeixRaviartElements</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">\until ly);</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">We choose the timestepping parameters before assigning the</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">initial conditions. (Preliminary computations showed that</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">the system performs oscillations with approximately  </span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">unit period, so the chosen value for the timestep \c dt</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">corresponds to a time-integration with about 40 timesteps per</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">period.)</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">\skipline Timestep.</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">\until  set_initial_condition()</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">Next we specify the output directory, open a trace file </span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">and document the initial conditions</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">\until doc_info.number()++;</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">The timestepping loop is identical to that in </span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">the problem with prescribed wall motion:&lt;/A&gt;</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">\section problemclass The problem class</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">The problem class is very similar to that used for the </span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;problem</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">with prescribed wall motion&lt;/A&gt;. We specify the type of the fluid</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">element as a template parameter and pass the number of</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">elements and the lengths of the domain to the constructor:</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">\dontinclude fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">\until  }</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">We provide access functions to the (pointers to) the fluid mesh,</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">\skipline Access function</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">and the wall mesh:</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">\skipline Access function for the wall mesh</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">\until end of access to wall mesh</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">Unlike the &lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;problem</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">with prescribed wall motion,&lt;/A&gt; the FSI problem does not</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">have any time-dependent boundary conditions, therefore the</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">pure virtual functions \c Problem::action_before_solve() and </span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">\c Problem::action_after_solve() can remain empty, and the</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">function \c Problem::actions_before_implicit_timestep() is not needed.</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">\until actions_after_newton_solve</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">However, since the wall displacement (which is determined as part of </span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">the solution!) affects the nodal positions in the fluid mesh</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">via the \c MacroElement/\c Domain - based node-update,</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">the position of the fluid nodes must be updated whenever</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">the Newton solver updates the unknowns. This is precisely</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">what the function \c Problem::actions_before_newton_convergence_check()</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">is for; see &lt;A HREF=&quot;../../../order_of_action_functions/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">the discussion of \c oomph-lib&#39;s various &quot;action&quot; functions&lt;/A&gt; </span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">for more details.</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">The functions \c doc_solution(...) and \c set_initial_condition()</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">do what they always do. </span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">\until set_initial_condition()</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">The private member function \c create_traction_elements(...) </span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">is used to attach the applied traction elements to the upstream end of</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">the channel, exactly as in the &lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;problem</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">with prescribed wall motion.&lt;/A&gt;</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">\until &amp;traction_mesh_pt</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">The private member data stores the problem parameters,</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">\until  double Ly;</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">the pointers to the fluid mesh,</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">\skipline Pointer to the &quot;bulk&quot;</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">\until MacroElementNode</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">the surface mesh that contains the applied-traction elements,</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">\skipline Pointer to the &quot;surface</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">\until Applied_fluid</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">and the wall mesh,</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">\until OneDLagrangian</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">as well as pointers to various control nodes</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">\until end of problem class</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">\section problemcontr The problem constructor</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">We copy the various mesh parameters to the Problem&#39;s private data</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">\dontinclude fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">\until  Ly=ly;</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">and increase the maximum value of the residual that is permitted </span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">during the Newton iteration to accommodate possible poor initial</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">guesses for the solution.</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">\until Max_residual</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">We construct a \c BDF&lt;2&gt; - timestepper for the time-integration </span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">of the fluid equations and add it to the Problem&#39;s collection of</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">timesteppers:</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">\until  add_time_stepper_pt(new BDF&lt;2&gt;);</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">The wall mesh is built as in the corresponding </span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">single-physics beam problem:&lt;/A&gt; We create the \c GeomObject that </span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">describes the undeformed wall shape and construct the wall mesh,</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">this time with \c FSIHermiteBeamElements:</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">\until (Ncollapsible</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">We note that even though the same number of fluid and beam elements</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">are used to discretise the common boundary, the discretisation of</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">the two domains is \b not matching as the shape of the domain boundary is </span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">represented by piecewise cubic Hermite polynomials within the beam</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">elements, and by piecewise quadratic Lagrange polynomials within the</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">fluid elements. Mathematically, this does not cause any problems as </span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">both representations converge to the same boundary shape</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">as the meshes are refined further and further. We stress that \c oomph-lib</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">does not even require the number of elements along the interface</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">to match; see \ref ex .</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">The \c MacroElement/Domain - based</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">fluid-mesh update requires the wall shape (which is now parametrised</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">by the wall mesh&#39;s constituent elements) to be represented</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">by single \c GeomObject. We create the required &quot;compound&quot; \c</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">GeomObject using the \c MeshAsGeomObject class:</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">\until new MeshAsGeomObject</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">This &quot;compound&quot; \c GeomObject can now be used to build the </span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">fluid mesh, exactly as in  </span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">the corresponding single-physics fluids problem.&lt;/A&gt; (The</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">\c MacroElementNodeUpdateCollapsibleChannelMesh is a trivial</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">extension of the \c CollapsibleChannelMesh from which it is </span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">derived; see the discussion of the </span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">&lt;A HREF=&quot;../../macro_element_free_boundary_poisson/html/index.html#mesh&quot;&gt; </span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">&quot;toy&quot; free-boundary Poisson problem&lt;/A&gt; for details.)</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">\skipline Build bulk (fluid)</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">\until time_stepper_pt()</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">As in &lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">the fluids problem with prescribed wall motion &lt;/A&gt; we use a</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">&quot;boundary-layer squash function&quot; to distribute the fluid elements</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">non-uniformly across the channel so that more elements are located</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">inside the thin Stokes layers that are likely to develop near the wall.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">\until node_update();</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">We create the sub-mesh that stores the applied traction elements</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">and attach the elements to the upstream end of the channel. The</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">three sub-meshes are then combined into the \c Problem&#39;s single </span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">global mesh.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">\skipline Create &quot;surface mesh&quot;</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">\until build_global_mesh()</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">We complete the build process for the fluid elements</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">by passing the pointers to the relevant problem parameters to the</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">elements,</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">\until   } // end loop over elements</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">then we apply the boundary conditions for the fluid velocities:</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">- both axial and transverse velocities are pinned along the bottom</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">  and the top boundaries (boundaries 0, 2, 3 and 4)</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">- the transverse velocity is pinned along the in- and outflow</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">  (boundaries 1 and 5).</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">\until pin_velocity</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">The applied traction elements require a pointer to the prescribed</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">traction function:</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">The wall elements require pointers to the various problem parameters</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">and the pointer to the \c GeomObject that defines the beam&#39;s</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">undeformed shape. Depending on the relative orientation of the fluid</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">and solid meshes, the normal vector used by the \c FSIWallElement</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">to determine the traction exerted by the adjacent \c FSIFluidElement</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">may either point into or out of the fluid domain. </span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">By default, it is assumed that the normal points into the</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">fluid -- in this case the traction computed by the</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">adjacent \c FSIFluidElement is added to the </span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">external load that acts on the \c FSIWallElement. </span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">Evaluating the direction of the normal (e.g by plotting the vector</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">obtained from \c FSIHermiteBeamElement::get_normal(...) ) in the </span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">present problem shows that the normal to the wall elements actually </span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">points out of the fluid domain, therefore the fluid traction acts in</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">the opposite direction to that assumed in the original</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">formulation. This may be rectified</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">by setting the boolean flag </span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">\c FSIHermiteBeamElement::normal_points_into_fluid() </span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">to \c false.</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">\until   } // end of loop over elements</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">Both ends of the beam are pinned:</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">We choose two fluid control nodes in the middle of the </span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">inflow and outflow cross-sections to document the velocities,</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">and choose a central node in the wall mesh to document its</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">displacement.</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">\until node_pt(Ncollapsible/2);</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">Finally, we set up the remaining fluid-structure interaction: </span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">The fluid nodes that are located on the moving</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">wall remain attached to material particles on the wall. The no-slip</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">condition (4) therefore implies that</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">the fluid velocity at each of these nodes must be equal to the </span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">nodes&#39; velocity. Hence the fluid velocity</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">must be updated whenever a node update function</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">changes the nodal position. This is done most easily by means of</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">the auxiliary node update function -- a function that is executed</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">automatically whenever a  node&#39;s \c node_update() function</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">is called. To achieve this we pass a function pointer to the</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">\c FSI_functions::apply_no_slip_on_moving_wall() function</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">to the nodes on the fluid mesh&#39;s boundary 3: </span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">Next, the \c FSIHermiteBeamElements have to be &quot;told&quot; which fluid</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">elements are located next to their Gauss points to allow them</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">to work out the fluid traction. The required lookup tables are</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">created by the function </span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">\c FSI_functions::setup_fluid_load_info_for_solid_elements(...):</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">\until    (this,3,Bulk_mesh_pt,Wall_mesh_pt);</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">Finally, we set up the equation numbering scheme.</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">&lt;HR&gt;  </span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">\section doc Post processing</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">The function \c doc_solution(...) outputs the velocity</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">and wall displacement fields and  records the time-trace of </span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">the axial velocity at the control nodes and the position of the wall&#39;s</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">midpoint. The function \c FSI_functions::doc_fsi(...)</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">is a helper function that can be used to document/validate the</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">various FSI lookup schemes; see \ref comments_and_ex for an</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">illustration of their output.</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">\dontinclude fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">\skipline start_of_doc_solution</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">\until {</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">\skipline Doc fsi</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">\skipline FSI_functions</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">\skipline ofstream</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">\until end_of_doc_solution</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment"> \section tractioncre Creation of the traction elements</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">This function is the same as the one used in </span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;the</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">problem with prescribed wall motion&lt;/A&gt;. </span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment"> \section IC Applying the initial conditions</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">This function is the same as the one used in </span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt;the</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">problem with prescribed wall motion&lt;/A&gt;. </span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">\section comments_and_ex Comments and Exercises</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">\subsection comments Comments</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">- &lt;B&gt;Variables that affect the fluid traction are not just velocities</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">  and pressures!&lt;/B&gt; \n\n</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">  In the section \ref fsi_wall_elements we briefly discussed</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">  how the function </span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">  \c FSI_functions::setup_fluid_load_info_for_solid_elements(...)</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">  determines the variables that affect the fluid traction </span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">  onto the \c FSIWallElements. For a Newtonian fluid, </span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">  the components of the fluid traction vector (on the viscous scale) </span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">  onto the wall is given by</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">  t_i = -p N_i + \left(\frac{\partial u_i}{\partial x_j} + </span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">                       \frac{\partial u_j}{\partial x_i} \right) N_j</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">  \mbox{ \ \ \ for $i=1,2[,3]$} </span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">  where \f$ N_i \ (\mbox{for } i=1,2[,3]) \f$ are the components of the</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">  normal to the fluid domain, pointing into the fluid. This equation</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">  shows that the fluid traction is primarily affected by the</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">  velocity and pressure degrees of freedom in the </span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">  fluid elements that are &quot;adjacent&quot; to a given \c FSIWallElement.</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">  However, since the traction involves derivatives of the</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">  velocity, the traction is also affected by changes to the  </span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">  geometry of the fluid element. Therefore, the list of</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">  variables that affect the fluid traction must (and indeed does) </span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">  include all those \c Data objects that are involved in the adjacent </span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">  fluid elements&#39; node update operations.</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">  Here is an animation that illustrates these dependencies for</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">  a relatively coarse discretisation in which the collapsible section</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">  of the fluid mesh is discretised with 10 &quot;vertical columns&quot; of </span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">  \c QCrouzeixRaviartElement&lt;2&gt; elements, while the wall is</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">  discretised with 22 \c FSIHermiteBeamElements, each of which</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">  contains 3 Gauss points. The animation shows the region of the fluid</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">  mesh close to the (strongly deformed) elastic wall.</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">  Each different frame illustrates the FSI lookup schemes</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">  for a different wall element. </span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">  - The position of the wall Gauss points are displayed by &quot;gradient&quot; </span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">    markers while the corresponding points in the adjacent fluid</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">    elements (i.e. the points at which the fluid traction is computed) </span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">    are displayed by </span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">    &quot;delta&quot; markers. Since the fluid and solid discretisations are </span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">    non-matching the points do not coincide exactly though they </span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">    will continue to approach each other under further mesh</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">    refinement. </span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">  - The coloured numbers indicate the number of values that affect</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">    the fluid traction on this \c FSIWallElement: </span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">    - The red numbers represent the number of nodal values at the</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">      nodes of the adjacent fluid element(s) that affect the traction: For a</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">      2D Crouzeix-Raviart element, each fluid node stores two velocity</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">      degrees of freedom, both of which affect the traction.  </span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">    - The blue numbers represent the number of internal \c Data values</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">      stored in an adjacent fluid element that affect the traction:</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">      In a 2D Crouzeix-Raviart element, each element stores three</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">      pressure values in its internal \c Data and all three</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">      pressure values affect the traction. </span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">    - Finally, the green numbers indicate the number of \c Data values </span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">      that are (potentially) involved in the node-update operation for</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">      the nodes in the adjacent fluid elements. Recall that during the</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">      \c MacroElement - based node-update we only refer to the wall via</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">      its representation as a \c WallAsGeomObject, i.e. as a</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">      &quot;compound&quot; \c GeomObject. The geometric \c Data of a compound</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">      \c GeomObject is given by the geometric \c Data of \e all</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">      its sub-objects. Therefore, the geometric \c Data </span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">      of the \c WallAsGeomObject includes the positional</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">      \c Data of all \c SolidNodes stored in this mesh.</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">      In an \c FSIHermiteBeamElement, each \c SolidNode stores</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">      four values, representing the node&#39;s x- and y-positions</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">      and their derivatives with respect to the element&#39;s local coordinate. </span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">    .</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">\image html crozier_raviart_fsi_macro.gif &quot;Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh. (The fluid elements are 2D Crouzeix-Raviart elements.) &quot; </span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">\image latex crozier_raviart_fsi_macro.eps &quot;Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh. (The fluid elements are 2D Crouzeix-Raviart elements.) &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">   Here is the corresponding animation for a discretisation with</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">   2D Taylor-Hood elements. These elements have no internal \c Data but</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">   the pressure degrees of freedom are stored at the fluid element&#39;s</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">   corner nodes:</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">\image html taylor_hood_fsi_macro.gif &quot;Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh. (The fluid elements are 2D Taylor-Hood elements.) &quot; </span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">\image latex taylor_hood_fsi_macro.eps &quot;Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh. (The fluid elements are 2D Taylor-Hood elements.) &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">Finally, here is an animation that shows the (wall) degrees of freedom</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">that affect the node-update of a given fluid node. </span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">The red square marker shows the fluid node; the green numbers</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">show the number of the degrees of freedom at the \c SolidNodes</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">that are involved that fluid node&#39;s node update. Again it is </span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">clear that the \c MacroElement/Domain-based node update </span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">procedure in which the wall mesh is represented by a compound</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">\c GeomObject does not result in a sparse node-update procedure:</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">Each \c SolidNode in the wall mesh is assumed to affect the</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">position of all fluid nodes.</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">\image html fsi_nodes.gif &quot;Animation of the Data values that affect the node update of the fluid nodes. &quot; </span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">\image latex fsi_nodes.eps &quot;Animation of the Data values that affect the node update of the fluid nodes. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">- &lt;B&gt;(In-)efficiency of the MacroElement-based node-update&lt;/B&gt; \n\n</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">  The animations shown above illustrate very graphically</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">  that the implementation of the fluid-structure interaction</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">  via \c MacroElement/Domain - based node updates does not lead to</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">  a particularly efficient algorithm. The current approach suffers</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">  from two main problems: </span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">  -# The fluid-node update is not sparse: Since we cannot distinguish between</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">     the various sub-objects in the &quot;compound&quot; \c GeomObject, we can do</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">     no better than assuming the worst-case scenario, namely </span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">     that \e all </span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">     positional degrees of freedom of \e all \c SolidNodes in the wall </span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">      mesh potentially affect the nodal position in the fluid elements</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">     adjacent to the wall. Consequently, each \c FSIHermiteBeamElement</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">     in the wall mesh depends on all solid mechanics degrees of </span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">     freedom in the wall mesh. As a result, the wall discretisation </span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">     completely loses its sparsity!</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">  -# When updating the position of the fluid nodes via the fluid element&#39;s</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">     \c Domain/MacroElement representation, we obtain the wall</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">     shape from the \c GeomObject::position(...) function of the</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">     &quot;compound&quot; \c GeomObject, using the wall&#39;s Lagrangian coordinate</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">     \f$ \xi \f$ as the &quot;compound&quot; \c GeomObject&#39;s intrinsic</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">     coordinate. As discussed in the section \ref wall_geom_object, this</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">     is a very costly operation, since we first have to determine</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">     which of the constituent \c FSIHermiteBeamElements &quot;contains&quot;</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">     the required Lagrangian coordinate, and then evaluate the</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">     Eulerian position of the relevant point in the element.</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">  In &lt;A HREF=&quot;../../../interaction/fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">  the next  example&lt;/A&gt; we will demonstrate how the use of the algebraic node update</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">  procedure, described in </span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">  an earlier example&lt;/A&gt;, allows us to avoid both problems, resulting</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">  in a much more efficient code.</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">\subsection ex Exercises</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">-# Use the function \c FSIHermiteBeamElement::get_normal(...) to plot </span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">   the unit normal vector to the wall and thus confirm that the value</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">   for \c FSIHermiteBeamElement::normal_points_into_fluid() is correct.</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">   [\b Hint: Another way to sanity-check that the correct value for this flag</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">   has been set is to change the velocity boundary conditions at the upstream </span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">   end to a pure Dirichlet condition by prescribing the axial velocity</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">   profile. With Dirichlet conditions everywhere, one fluid pressure degree </span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">   of freedom, \f$ p_{fix} \f$ , say, can (indeed must!) then be assigned </span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">   arbitrarily. Now set the inflow velocity to zero and increase the value of </span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">   \f$ p_{fix} \f$ from zero, say. If the wall collapses inwards</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">   as \f$ p_{fix} \f$ is increased the </span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">   direction of normal was chosen wrongly!] </span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">-# In section \ref fsi_wall_elements we mentioned that the function</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">   \c FSI_functions::setup_fluid_load_info_for_solid_elements(...)</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">   assumes that the fluid nodes on the FSI boundary store </span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">   the boundary coordinate. Investigate what happens if this </span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">   step is omitted, e.g. by commenting out the assignment of boundary</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">   coordinates with \c Node::set_coordinates_on_boundary(...) in </span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../../../src/meshes/collapsible_channel_mesh.template.cc&quot;&gt;</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">   collapsible_channel_mesh.template.cc&lt;/A&gt;. </span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">-# In section \ref undeformed we mentioned that the function </span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">   \c GeomObject::d2position(...) must be implemented for all \c</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">   GeomObjects that specify the undeformed shape of a beam element.</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">   Check what happens if this function is not implemented, e.g. by      </span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">   commenting out its definition in the \c UndeformedWall class. </span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">-# In section \ref problemcontr we commented that \c oomph-lib</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">   does not require the discretisations of the fluid and solid</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">   meshes to match along the common boundary. Confirm this, e.g., by </span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">   increasing the number of elements in the wall mesh. </span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">.   </span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/fsi_collapsible_channel/&quot;&gt;</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">demo_drivers/interaction/fsi_collapsible_channel/</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">- The driver code is: </span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/fsi_collapsible_channel/fsi_collapsible_channel.cc&quot;&gt;</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">demo_drivers/interaction/fsi_collapsible_channel/fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a7e66f2585ac5b71dc7ec72c5aad80fd8"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a7e66f2585ac5b71dc7ec72c5aad80fd8">wall</a></div><div class="ttdeci">namespace c FSI_functions The template parameters c FLUID_ELEMENT and c DIM_FLUID specify the type of the fluid element and its respectively The arguments are the pointer to the the number of the boundary in the fluid mesh adjacent to the elastic wall</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00512">fsi_collapsible_channel.txt:512</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_acb3c14e1a95c8df5ab7b09eb7c8c3940"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#acb3c14e1a95c8df5ab7b09eb7c8c3940">will</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian f xi f I w textwidth wall_mesh_geometry_sketch2 parametrised by a Lagrangian coordinate Beam shell structures may therefore act as c GeomObjects if we interpret their Lagrangian f xi as the c GeomObject s intrinsic f zeta f&lt; B &gt; A discretised beam shell structure&lt;/B &gt; In an c oomph lib the beam shell structure will</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00432">fsi_collapsible_channel.txt:432</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a642635cd331d6593d509df8a30f575e3"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a642635cd331d6593d509df8a30f575e3">f</a></div><div class="ttdeci">mainpage A fluid structure interaction we represented the moving wall by a c and created a c Domain object to provide an analytical representation of the domain boundary We discretised the Navier Stokes equations with Crouzeix Raviart elements and updated their nodal E[Continuity] f with f the flow is subject to the following boundary and initial i e f[{\bf u}(x_1, x_2, t=0)={\bf u}_{Poiseuille}(x_1, x_2)=6 \ x_2 \(1-x_2) \ {\bf e}_1. \ \ \ \ \ \ \ \ \ \ @E[Poiseuille]@ \f] Parallel f</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00113">fsi_collapsible_channel.txt:113</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a6388e0fc50060e394b2f90c6f28a376c"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a6388e0fc50060e394b2f90c6f28a376c">ratio</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s ratio</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00137">fsi_collapsible_channel.txt:137</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a2cef67ccba3b1a5328862c09ef7c6cd8"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a2cef67ccba3b1a5328862c09ef7c6cd8">position</a></div><div class="ttdeci">wall_geom_object position(xi, r)</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a2744537ce86dfb459bebbef1ccf6d4ad"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a2744537ce86dfb459bebbef1ccf6d4ad">representation</a></div><div class="ttdeci">the green numbers show the number of the degrees of freedom at the c SolidNodes that are involved that fluid node s node update Again it is clear that the c MacroElement Domain based node update procedure in which the wall mesh is represented by a compound c GeomObject does not result in a sparse node update we can do no better than assuming the worst case namely that e all positional degrees of freedom of e all c SolidNodes in the wall mesh potentially affect the nodal position in the fluid elements adjacent to the wall each c FSIHermiteBeamElement in the wall mesh depends on all solid mechanics degrees of freedom in the wall mesh As a the wall discretisation completely loses its sparsity c Domain MacroElement representation</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l01148">fsi_collapsible_channel.txt:1148</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a784d8b0bee7df38165386926b8f3a3b5"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a784d8b0bee7df38165386926b8f3a3b5">coordinate</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian coordinate</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00420">fsi_collapsible_channel.txt:420</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ac2e59f25d9b074b519b847bd5d5aeede"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ac2e59f25d9b074b519b847bd5d5aeede">Q</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f Q</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00179">fsi_collapsible_channel.txt:179</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_af5cc641589f7abffa2fdb770d1aa5f2c"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#af5cc641589f7abffa2fdb770d1aa5f2c">pressure</a></div><div class="ttdeci">namespace c FSI_functions The template parameters c FLUID_ELEMENT and c DIM_FLUID specify the type of the fluid element and its respectively The arguments are the pointer to the the number of the boundary in the fluid mesh adjacent to the elastic and the pointers to the fluid and wall meshes The function assumes that boundary coordinates have been set for the fluid nodes on the mesh boundary specified by the argument c and that these boundary coordinates are consistent with the parametrisation of the wall mesh by its Lagrangian coordinate(See&lt; A HREF=&quot;../../../poisson/fish_poisson2/html/index.html#boundary_coords&quot;&gt;the discussion of the mesh generation procedures for domains with curvilinear boundaries&lt;/A &gt; for a more detailed discussion of boundary coordinates for nodes.) The \c FSIWallElement provides the protected member function \c FSIWallElement We assign values for the external pressure(on the wall stiffness scale) and for the upstream fluid pressure(on the fluid pressure scale). The latter is again chosen so that in the absence of any wall deformation</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a463ce628541c1eb0ad6099c7ab8492df"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a463ce628541c1eb0ad6099c7ab8492df">flow</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean flow</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00223">fsi_collapsible_channel.txt:223</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a4effc71843d8c45a5a3fb3f9d5cd3415"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a4effc71843d8c45a5a3fb3f9d5cd3415">process</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian f xi f I w textwidth wall_mesh_geometry_sketch2 parametrised by a Lagrangian coordinate Beam shell structures may therefore act as c GeomObjects if we interpret their Lagrangian f xi as the c GeomObject s intrinsic f zeta f&lt; B &gt; A discretised beam shell structure&lt;/B &gt; In an c oomph lib the beam shell structure of have been discretised by a number of c SolidFiniteElements The c MeshAsGeomObject discussed is therefore a compound c GeomObject that contains a number of sub objects the mesh s constituent c SolidFiniteElements Within the compound c GeomObject each sub object acts as a c GeomObject in its own right the shape of a c SolidFiniteElement is parametrised by its coordinate c s I w textwidth wall_mesh_geometry_sketch3 A discretised beam structure The c f zeta f in a two stage process</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00457">fsi_collapsible_channel.txt:457</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a32f2cc9e42e896f1abe5144a35102149"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a32f2cc9e42e896f1abe5144a35102149">Overview</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview Overview</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00237">fsi_collapsible_channel.txt:237</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a75d5902f188a00f87f010a7c28461e35"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a75d5902f188a00f87f010a7c28461e35">parameters</a></div><div class="ttdeci">The timestepping loop is identical to that in&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; the problem with prescribed wall skipline Access function until and the wall&lt;/A &gt; the FSI problem does not have any time dependent boundary therefore the virtual pure functions c Problem::action_before_solve() and \c Problem see&lt; A HREF=&quot;../../../order_of_action_functions/html/index.html&quot;&gt; the discussion of c oomph lib s various action functions&lt;/A &gt; for more details until The functions c exactly as in the&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall motion&lt;/A &gt; until &amp;traction_mesh_pt The private member data stores the problem parameters</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00803">fsi_collapsible_channel.txt:803</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ace84824a93aa406e4d4b6c8d4ed570fc"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ace84824a93aa406e4d4b6c8d4ed570fc">spatial</a></div><div class="ttdeci">namespace c FSI_functions The template parameters c FLUID_ELEMENT and c DIM_FLUID specify the type of the fluid element and its spatial(Eulerian) dimension</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a7236677056b1e475a019ad7b02040677"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a7236677056b1e475a019ad7b02040677">E_</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f E_</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00158">fsi_collapsible_channel.txt:158</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a8e520d065ea90fd4ae04f62043e0182f"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a8e520d065ea90fd4ae04f62043e0182f">possible</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview we generally recommend to first study the constituent single physics problems in i e Discretise the solid mechanics problem with a suitable c choose a load that is vaguely representative of the loads expected in the actual fluid structure interaction problem Discretise the fluid mechanics problem in a domain in which the deformation of the elastic boundary is described by a c GeomObject that performs a prescribed motion Choose a suitable node update strategy to adjust the position of the fluid nodes in response to a c Domain MacroElement based node update method is very easy to implement If possible</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00252">fsi_collapsible_channel.txt:252</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a5e5868933fbe526b6ba1a44f7c087ea4"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a5e5868933fbe526b6ba1a44f7c087ea4">inflow</a></div><div class="ttdeci">mainpage A fluid structure interaction we represented the moving wall by a c and created a c Domain object to provide an analytical representation of the domain boundary We discretised the Navier Stokes equations with Crouzeix Raviart elements and updated their nodal E[Continuity] f with f the flow is subject to the following boundary and initial i e f[{\bf u}(x_1, x_2, t=0)={\bf u}_{Poiseuille}(x_1, x_2)=6 \ x_2 \(1-x_2) \ {\bf e}_1. \ \ \ \ \ \ \ \ \ \ @E[Poiseuille]@ \f] Parallel inflow</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00113">fsi_collapsible_channel.txt:113</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a24d2c262edd3f8e43474f75e96f7d97d"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a24d2c262edd3f8e43474f75e96f7d97d">velocities</a></div><div class="ttdeci">see ref ex The c MacroElement Domain based fluid mesh update requires the wall shape(which is now parametrised by the wall mesh 's constituent elements) to be represented by single \c GeomObject. We create the required &quot;compound&quot; \c GeomObject using the \c MeshAsGeomObject class We create the sub mesh that stores the applied traction elements and attach the elements to the upstream end of the channel The three sub meshes are then combined into the c Problem s single global mesh skipline Create surface mesh until until then we apply the boundary conditions for the fluid velocities</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00914">fsi_collapsible_channel.txt:914</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a94e1c7b35ff88a6dd7fb0a8752f2fde4"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a94e1c7b35ff88a6dd7fb0a8752f2fde4">interaction</a></div><div class="ttdeci">see ref ex The c MacroElement Domain based fluid mesh update requires the wall shape(which is now parametrised by the wall mesh 's constituent elements) to be represented by single \c GeomObject. We create the required &quot;compound&quot; \c GeomObject using the \c MeshAsGeomObject class We create the sub mesh that stores the applied traction elements and attach the elements to the upstream end of the channel The three sub meshes are then combined into the c Problem s single global mesh skipline Create surface mesh until until then we apply the boundary conditions for the fluid and the transverse velocity is pinned along the in and outflow(boundaries 1 and 5). . \until pin_velocity The applied traction elements require a pointer to the prescribed traction function we set up the remaining fluid structure interaction</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00978">fsi_collapsible_channel.txt:978</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_acb1c75ce579feac2f20489b489791588"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#acb1c75ce579feac2f20489b489791588">displacements</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of displacements</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00140">fsi_collapsible_channel.txt:140</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a321267e1efb30b5d586302509354fb07"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a321267e1efb30b5d586302509354fb07">Global_Physical_Variables::load</a></div><div class="ttdeci">void load(const Vector&lt; double &gt; &amp;xi, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;N, Vector&lt; double &gt; &amp;load)</div><div class="ttdoc">Load function: Apply a constant external pressure to the wall. Note: This is the load without the flu...</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8cc_source.html#l00209">fsi_collapsible_channel.cc:209</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a5bd739ada31f2426bbb015fb7fd4bcb1"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a5bd739ada31f2426bbb015fb7fd4bcb1">doc_solution</a></div><div class="ttdeci">The timestepping loop is identical to that in&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; the problem with prescribed wall skipline Access function until and the wall&lt;/A &gt; the FSI problem does not have any time dependent boundary therefore the virtual pure functions c Problem::action_before_solve() and \c Problem see&lt; A HREF=&quot;../../../order_of_action_functions/html/index.html&quot;&gt; the discussion of c oomph lib s various action functions&lt;/A &gt; for more details until The functions c doc_solution(...) and \c set_initial_condition() do what they always do. \until set_initial_condition() The private member function \c create_traction_elements(...) is used to attach the applied traction elements to the upstream end of the channel</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a033d3e059708cac41cc92c6dc045262f"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a033d3e059708cac41cc92c6dc045262f">motion</a></div><div class="ttdeci">mainpage A fluid structure interaction we represented the moving wall by a c and created a c Domain object to provide an analytical representation of the domain boundary We discretised the Navier Stokes equations with Crouzeix Raviart elements and updated their nodal E[Continuity] f with f the flow is subject to the following boundary and initial i e f[{\bf u}(x_1, x_2, t=0)={\bf u}_{Poiseuille}(x_1, x_2)=6 \ x_2 \(1-x_2) \ {\bf e}_1. \ \ \ \ \ \ \ \ \ \ @E[Poiseuille]@ \f] Parallel f and an applied axial traction of f axially traction free outflow at the downstream i e i e apart from the fact that in the present problem the wall motion</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00131">fsi_collapsible_channel.txt:131</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a86c04ce7cdf31c01242f4278927def58"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a86c04ce7cdf31c01242f4278927def58">ly</a></div><div class="ttdeci">namespace c FSI_functions The template parameters c FLUID_ELEMENT and c DIM_FLUID specify the type of the fluid element and its respectively The arguments are the pointer to the the number of the boundary in the fluid mesh adjacent to the elastic and the pointers to the fluid and wall meshes The function assumes that boundary coordinates have been set for the fluid nodes on the mesh boundary specified by the argument c and that these boundary coordinates are consistent with the parametrisation of the wall mesh by its Lagrangian coordinate(See&lt; A HREF=&quot;../../../poisson/fish_poisson2/html/index.html#boundary_coords&quot;&gt;the discussion of the mesh generation procedures for domains with curvilinear boundaries&lt;/A &gt; for a more detailed discussion of boundary coordinates for nodes.) The \c FSIWallElement provides the protected member function \c FSIWallElement We assign values for the external the applied pressure difference would drive steady Poiseuille flow through the channel until P_up We build the problem with quadrilateral Crouzeix Raviart upgraded to c MacroElementNodeUpdateElements This ensures that the shape are incorporated into the fluid elements Jacobian matrices skipline Build the problem with QCrouzeixRaviartElements until ly</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00718">fsi_collapsible_channel.txt:718</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a662e1bd37bd31188f0d8539376e0efa3"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a662e1bd37bd31188f0d8539376e0efa3">Ly</a></div><div class="ttdeci">The timestepping loop is identical to that in&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; the problem with prescribed wall skipline Access function until and the wall&lt;/A &gt; the FSI problem does not have any time dependent boundary therefore the virtual pure functions c Problem::action_before_solve() and \c Problem see&lt; A HREF=&quot;../../../order_of_action_functions/html/index.html&quot;&gt; the discussion of c oomph lib s various action functions&lt;/A &gt; for more details until The functions c exactly as in the&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall motion&lt;/A &gt; until &amp;traction_mesh_pt The private member data stores the problem until double Ly</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00805">fsi_collapsible_channel.txt:805</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a341ee3511f621f71bee72ee55d11f3c1"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a341ee3511f621f71bee72ee55d11f3c1">modulus</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic modulus</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00177">fsi_collapsible_channel.txt:177</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_af6d619a456e67f879350b1c9ca9c17b2"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#af6d619a456e67f879350b1c9ca9c17b2">SolidFiniteElement</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview we generally recommend to first study the constituent single physics problems in i e Discretise the solid mechanics problem with a suitable c SolidFiniteElement(e.g. a \c HermiteBeamElement) and determine the wall deformation in response to a prescribed external load. If possible</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_aeb3d42d5cecf8555a37e11e22b3ad361"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#aeb3d42d5cecf8555a37e11e22b3ad361">the</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview we generally recommend to first study the constituent single physics problems in i e Discretise the solid mechanics problem with a suitable c choose a load that is vaguely representative of the loads expected in the actual fluid structure interaction problem Discretise the fluid mechanics problem in a domain in which the deformation of the elastic boundary is described by a c GeomObject that performs a prescribed motion Choose a suitable node update strategy to adjust the position of the fluid nodes in response to the(prescribed) motion of the &quot;elastic boundary&quot;.(As demonstrated in many previous examples</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a177a43da2fdfbd13361ff3a5b44eef56"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a177a43da2fdfbd13361ff3a5b44eef56">conditions</a></div><div class="ttdeci">mainpage A fluid structure interaction we represented the moving wall by a c and created a c Domain object to provide an analytical representation of the domain boundary We discretised the Navier Stokes equations with Crouzeix Raviart elements and updated their nodal E[Continuity] f with f the flow is subject to the following boundary and initial conditions</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00106">fsi_collapsible_channel.txt:106</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ab7e862a87f6d89d4fb60486fb237f809"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ab7e862a87f6d89d4fb60486fb237f809">words</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian f xi f I w textwidth wall_mesh_geometry_sketch2 parametrised by a Lagrangian coordinate Beam shell structures may therefore act as c GeomObjects if we interpret their Lagrangian f xi as the c GeomObject s intrinsic f zeta f&lt; B &gt; A discretised beam shell structure&lt;/B &gt; In an c oomph lib the beam shell structure of have been discretised by a number of c SolidFiniteElements The c MeshAsGeomObject discussed is therefore a compound c GeomObject that contains a number of sub objects the mesh s constituent c SolidFiniteElements Within the compound c GeomObject each sub object acts as a c GeomObject in its own right the shape of a c SolidFiniteElement is parametrised by its coordinate c s I w textwidth wall_mesh_geometry_sketch3 A discretised beam structure The c f zeta f in a two stage we shall discuss how the fluid traction is added to the load terms in the wall equations As mentioned the computation of the residuals of the wall equations requires the evaluation of the combined load vector at the Gauss points in the wall elements the dependence of the residuals on those(fluid) degrees of freedom that affect the traction must be taken into account when computing the wall element 's Jacobian matrix. Storage for the various lookup schemes required for such computations is provided in the virtual base class \c FSIWallElement whose inheritance structure is as follows in other words</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00461">fsi_collapsible_channel.txt:461</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ab105fe5f7d28f79b02c427173794fd6c"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ab105fe5f7d28f79b02c427173794fd6c">equations</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes equations</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00142">fsi_collapsible_channel.txt:142</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a8ff39de4273e2d8a9c986e4e6be780b4"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a8ff39de4273e2d8a9c986e4e6be780b4">elements</a></div><div class="ttdeci">namespace c FSI_functions The template parameters c FLUID_ELEMENT and c DIM_FLUID specify the type of the fluid element and its respectively The arguments are the pointer to the the number of the boundary in the fluid mesh adjacent to the elastic and the pointers to the fluid and wall meshes The function assumes that boundary coordinates have been set for the fluid nodes on the mesh boundary specified by the argument c and that these boundary coordinates are consistent with the parametrisation of the wall mesh by its Lagrangian coordinate(See&lt; A HREF=&quot;../../../poisson/fish_poisson2/html/index.html#boundary_coords&quot;&gt;the discussion of the mesh generation procedures for domains with curvilinear boundaries&lt;/A &gt; for a more detailed discussion of boundary coordinates for nodes.) The \c FSIWallElement provides the protected member function \c FSIWallElement We assign values for the external the applied pressure difference would drive steady Poiseuille flow through the channel until P_up We build the problem with quadrilateral Crouzeix Raviart elements</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00710">fsi_collapsible_channel.txt:710</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a95e2f1f681ceb4155d4f08b9da6c126b"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a95e2f1f681ceb4155d4f08b9da6c126b">GeomObject</a></div><div class="ttdeci">mainpage A fluid structure interaction we represented the moving wall by a c GeomObject</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00014">fsi_collapsible_channel.txt:14</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a82f408641cf5e3f953fe6356c37bb374"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a82f408641cf5e3f953fe6356c37bb374">timesteppers</a></div><div class="ttdeci">and increase the maximum value of the residual that is permitted during the Newton iteration to accommodate possible poor initial guesses for the solution until Max_residual We construct a c BDF&lt; 2 &gt; timestepper for the time integration of the fluid equations and add it to the Problem s collection of timesteppers</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00847">fsi_collapsible_channel.txt:847</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ade134364569238cdc1e1963ed7ad5b52"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ade134364569238cdc1e1963ed7ad5b52">based</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview we generally recommend to first study the constituent single physics problems in i e Discretise the solid mechanics problem with a suitable c choose a load that is vaguely representative of the loads expected in the actual fluid structure interaction problem Discretise the fluid mechanics problem in a domain in which the deformation of the elastic boundary is described by a c GeomObject that performs a prescribed motion Choose a suitable node update strategy to adjust the position of the fluid nodes in response to a c Domain MacroElement based node update method is very easy to implement If try to impose a wall motion that is representative of the type of wall motion expected in the actual fluid structure interaction problem Once the behaviour of the two isolated single physics problems is sufficiently well combine the two single physics problems to a fully coupled problem The coupling introduces two types of interactions that must be incorporated into the computational we must ensure and point The dependence of the residuals of the c SolidFiniteElements on you may wish to skip the next few sections and continue with the ref where we demonstrate apart from a few trivial the driver code for the fully coupled fluid structure interaction problem is a straightforward combination of the two single physics driver codes&lt;HR&gt;&lt;HR&gt; section how_its_done Brief discussion of the implementation subsection mesh MacroElement based(fluid-) node updates in FSI problems \subsubsection shape_deriv The shape derivatives When discussing our&lt; A HREF</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a157b9ddaaa4e96c2331fa0d3391bbb82"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a157b9ddaaa4e96c2331fa0d3391bbb82">that</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview we generally recommend to first study the constituent single physics problems in i e Discretise the solid mechanics problem with a suitable c choose a load that is vaguely representative of the loads expected in the actual fluid structure interaction problem Discretise the fluid mechanics problem in a domain in which the deformation of the elastic boundary is described by a c GeomObject that performs a prescribed motion Choose a suitable node update strategy to adjust the position of the fluid nodes in response to a c Domain MacroElement based node update method is very easy to implement If try to impose a wall motion that is representative of the type of wall motion expected in the actual fluid structure interaction problem Once the behaviour of the two isolated single physics problems is sufficiently well combine the two single physics problems to a fully coupled problem The coupling introduces two types of interactions that must be incorporated into the computational we must ensure that</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00287">fsi_collapsible_channel.txt:287</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a32d5d6aa331e255414692037f0445732"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a32d5d6aa331e255414692037f0445732">driver_code</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview we generally recommend to first study the constituent single physics problems in i e Discretise the solid mechanics problem with a suitable c choose a load that is vaguely representative of the loads expected in the actual fluid structure interaction problem Discretise the fluid mechanics problem in a domain in which the deformation of the elastic boundary is described by a c GeomObject that performs a prescribed motion Choose a suitable node update strategy to adjust the position of the fluid nodes in response to a c Domain MacroElement based node update method is very easy to implement If try to impose a wall motion that is representative of the type of wall motion expected in the actual fluid structure interaction problem Once the behaviour of the two isolated single physics problems is sufficiently well combine the two single physics problems to a fully coupled problem The coupling introduces two types of interactions that must be incorporated into the computational we must ensure and point The dependence of the residuals of the c SolidFiniteElements on you may wish to skip the next few sections and continue with the ref driver_code</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00306">fsi_collapsible_channel.txt:306</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ad72c40f47a1f0d014c06738901205c4c"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ad72c40f47a1f0d014c06738901205c4c">derivatives</a></div><div class="ttdeci">namespace c FSI_functions The template parameters c FLUID_ELEMENT and c DIM_FLUID specify the type of the fluid element and its respectively The arguments are the pointer to the the number of the boundary in the fluid mesh adjacent to the elastic and the pointers to the fluid and wall meshes The function assumes that boundary coordinates have been set for the fluid nodes on the mesh boundary specified by the argument c and that these boundary coordinates are consistent with the parametrisation of the wall mesh by its Lagrangian coordinate(See&lt; A HREF=&quot;../../../poisson/fish_poisson2/html/index.html#boundary_coords&quot;&gt;the discussion of the mesh generation procedures for domains with curvilinear boundaries&lt;/A &gt; for a more detailed discussion of boundary coordinates for nodes.) The \c FSIWallElement provides the protected member function \c FSIWallElement We assign values for the external the applied pressure difference would drive steady Poiseuille flow through the channel until P_up We build the problem with quadrilateral Crouzeix Raviart upgraded to c MacroElementNodeUpdateElements This ensures that the shape derivatives(the derivatives of the fluid residuals with respect to the solid mechanics degrees of freedom that affect the nodal positions in the fluid elements)</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a0785d7fda857fdaf80b83b318a9821af"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a0785d7fda857fdaf80b83b318a9821af">sections</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross sections</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00230">fsi_collapsible_channel.txt:230</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ab035a1ff1ce0ed404262eadd361ef58a"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ab035a1ff1ce0ed404262eadd361ef58a">these</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview we generally recommend to first study the constituent single physics problems in i e Discretise the solid mechanics problem with a suitable c choose a load that is vaguely representative of the loads expected in the actual fluid structure interaction problem Discretise the fluid mechanics problem in a domain in which the deformation of the elastic boundary is described by a c GeomObject that performs a prescribed motion Choose a suitable node update strategy to adjust the position of the fluid nodes in response to a c Domain MacroElement based node update method is very easy to implement If try to impose a wall motion that is representative of the type of wall motion expected in the actual fluid structure interaction problem Once the behaviour of the two isolated single physics problems is sufficiently well combine the two single physics problems to a fully coupled problem The coupling introduces two types of interactions that must be incorporated into the computational we must ensure and point The dependence of the residuals of the c SolidFiniteElements on these(fluid) degrees of freedom must be taken into account when computing the \c SolidFiniteElement 's Jacobian matrix. . \c oomph-lib provides a number of high-level functions that allow the required lookup schemes to be generated completely automatically. In the following sections we shall provide a brief discussion of the methodology but we stress that the details are not particularly important for the &quot;user&quot;. If you just want to &quot;use&quot; \c oomph-lib 's fluid-structure interaction capabilities and don 't care too much about the technical details</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a042fb7b9f49f98bfd4e120120379ee72"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a042fb7b9f49f98bfd4e120120379ee72">until</a></div><div class="ttdeci">see ref ex The c MacroElement Domain based fluid mesh update requires the wall shape(which is now parametrised by the wall mesh 's constituent elements) to be represented by single \c GeomObject. We create the required &quot;compound&quot; \c GeomObject using the \c MeshAsGeomObject class We create the sub mesh that stores the applied traction elements and attach the elements to the upstream end of the channel The three sub meshes are then combined into the c Problem s single global mesh skipline Create surface mesh until until then we apply the boundary conditions for the fluid and the transverse velocity is pinned along the in and outflow(boundaries 1 and 5). . \until pin_velocity The applied traction elements require a pointer to the prescribed traction function we set up the remaining fluid structure the c FSIHermiteBeamElements have to be told which fluid elements are located next to their Gauss points to allow them to work out the fluid traction The required lookup tables are created by the function c FSI_functions::setup_fluid_load_info_for_solid_elements(...) we set up the equation numbering scheme until end of constructor&lt; HR &gt;&lt; HR &gt; section doc Post processing The function c doc_solution(...) outputs the velocity and wall displacement fields and records the time-trace of the axial velocity at the control nodes and the position of the wall 's midpoint. The function \c FSI_functions see ref comments_and_ex for an illustration of their output dontinclude fsi_collapsible_channel cc skipline start_of_doc_solution until</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l01005">fsi_collapsible_channel.txt:1005</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a07c9fbcbdeea5cc9bd651c11164810f4"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a07c9fbcbdeea5cc9bd651c11164810f4">is</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion is</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00216">fsi_collapsible_channel.txt:216</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_aa71f53de194b70a9d2a6a2dd3b4c02bd"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#aa71f53de194b70a9d2a6a2dd3b4c02bd">number</a></div><div class="ttdeci">We choose the timestepping parameters before assigning the initial open a trace file and document the initial conditions until doc_info number()++</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a5aa8bfee49d9b633bfddf9ef2696b288"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a5aa8bfee49d9b633bfddf9ef2696b288">axial</a></div><div class="ttdeci">mainpage A fluid structure interaction we represented the moving wall by a c and created a c Domain object to provide an analytical representation of the domain boundary We discretised the Navier Stokes equations with Crouzeix Raviart elements and updated their nodal E[Continuity] f with f the flow is subject to the following boundary and initial i e f[{\bf u}(x_1, x_2, t=0)={\bf u}_{Poiseuille}(x_1, x_2)=6 \ x_2 \(1-x_2) \ {\bf e}_1. \ \ \ \ \ \ \ \ \ \ @E[Poiseuille]@ \f] Parallel f and an applied axial traction of f axially traction free outflow at the downstream i e i e apart from the fact that in the present problem the wall described by f has to be determined as part of the solution We model the elastic membrane as a thin walled elastic Kirchhoff Love beam of wall thickness f h subject to an axial(2nd Piola-Kirchhoff) pre-stress \f$ \sigma^ *_0. \f$ The beam' effective(1D) elastic modulus is given by \f$ E_</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00135">fsi_collapsible_channel.txt:135</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a715c4452a60b00223d86dccd32a6cec6"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a715c4452a60b00223d86dccd32a6cec6">Consequently</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards Consequently</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00209">fsi_collapsible_channel.txt:209</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ab16a4fa66ce3cf2f1d2bd0be9857a574"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ab16a4fa66ce3cf2f1d2bd0be9857a574">end</a></div><div class="ttdeci">mainpage A fluid structure interaction we represented the moving wall by a c and created a c Domain object to provide an analytical representation of the domain boundary We discretised the Navier Stokes equations with Crouzeix Raviart elements and updated their nodal E[Continuity] f with f the flow is subject to the following boundary and initial i e f[{\bf u}(x_1, x_2, t=0)={\bf u}_{Poiseuille}(x_1, x_2)=6 \ x_2 \(1-x_2) \ {\bf e}_1. \ \ \ \ \ \ \ \ \ \ @E[Poiseuille]@ \f] Parallel f and an applied axial traction of f axially traction free outflow at the downstream end</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00117">fsi_collapsible_channel.txt:117</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_aadfd2a35de74106b3643f6bc624cf42a"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#aadfd2a35de74106b3643f6bc624cf42a">positions</a></div><div class="ttdeci">mainpage A fluid structure interaction we represented the moving wall by a c and created a c Domain object to provide an analytical representation of the domain boundary We discretised the Navier Stokes equations with Crouzeix Raviart elements and updated their nodal positions(in response to the prescribed changes in the wall position) by their \c MacroElement representation. . and -&lt; B &gt;&lt; A HREF</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a3aa3645a38be8e3c89f62129b0f45109"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a3aa3645a38be8e3c89f62129b0f45109">course</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of course</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00216">fsi_collapsible_channel.txt:216</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="fsi__collapsible__channel_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8cc_source.html#l00811">fsi_collapsible_channel.cc:811</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ad3aeb7b88ba2c043f83077bee41407bd"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ad3aeb7b88ba2c043f83077bee41407bd">computation</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian f xi f I w textwidth wall_mesh_geometry_sketch2 parametrised by a Lagrangian coordinate Beam shell structures may therefore act as c GeomObjects if we interpret their Lagrangian f xi as the c GeomObject s intrinsic f zeta f&lt; B &gt; A discretised beam shell structure&lt;/B &gt; In an c oomph lib computation</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00432">fsi_collapsible_channel.txt:432</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a99a1dd56d10752a3b0cc9e2dbf52f6b4"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a99a1dd56d10752a3b0cc9e2dbf52f6b4">width</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s width</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00143">fsi_collapsible_channel.txt:143</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ad8007cc2dbef4f33f47302bac269c745"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ad8007cc2dbef4f33f47302bac269c745">problem</a></div><div class="ttdeci">mainpage A fluid structure interaction problem</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00013">fsi_collapsible_channel.txt:13</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a75824323a969230857d33d67cb17d083"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a75824323a969230857d33d67cb17d083">show</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures show(from top left to bottom right) &quot;carpet plots&quot; of the axial and transverse velocities</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a1ba69e044238a99bd109e3158404a5bb"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a1ba69e044238a99bd109e3158404a5bb">xi</a></div><div class="ttdeci">xi[0]</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00395">fsi_collapsible_channel.txt:395</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_af98171c5199df9e818676546ab948366"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#af98171c5199df9e818676546ab948366">of</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian f xi f I w textwidth wall_mesh_geometry_sketch2 parametrised by a Lagrangian coordinate Beam shell structures may therefore act as c GeomObjects if we interpret their Lagrangian f xi as the c GeomObject s intrinsic f zeta f&lt; B &gt; A discretised beam shell structure&lt;/B &gt; In an c oomph lib the beam shell structure of have been discretised by a number of c SolidFiniteElements The c MeshAsGeomObject discussed is therefore a compound c GeomObject that contains a number of sub objects the mesh s constituent c SolidFiniteElements Within the compound c GeomObject each sub object acts as a c GeomObject in its own right the shape of a c SolidFiniteElement is parametrised by its coordinate c s I w textwidth wall_mesh_geometry_sketch3 A discretised beam structure The c f zeta f in a two stage we shall discuss how the fluid traction is added to the load terms in the wall equations As mentioned the computation of the residuals of the wall equations requires the evaluation of the combined load vector at the Gauss points in the wall elements the dependence of the residuals on those(fluid) degrees of freedom that affect the traction must be taken into account when computing the wall element 's Jacobian matrix. Storage for the various lookup schemes required for such computations is provided in the virtual base class \c FSIWallElement whose inheritance structure is as follows in other the element s coordinate is regarded as the intrinsic coordinate that parametrises its shape Thus we already have a standard interface through which an c FSIWallElement can be used to parametrise the shape of(part of) the domain boundary. By inheriting from the \c SolidFiniteElement class</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_aa585fa33b2cf3d0fc750b5096d2a4c4c"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#aa585fa33b2cf3d0fc750b5096d2a4c4c">mesh</a></div><div class="ttdeci">The timestepping loop is identical to that in&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; the problem with prescribed wall skipline Access function until and the wall mesh</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00770">fsi_collapsible_channel.txt:770</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a5b9028786281fadc8fba083cbc62074d"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a5b9028786281fadc8fba083cbc62074d">boundary</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain boundary</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00408">fsi_collapsible_channel.txt:408</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a3b46a8855e723be62480f97b105e8569"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a3b46a8855e723be62480f97b105e8569">boundary_in_fluid_mesh</a></div><div class="ttdeci">namespace c FSI_functions The template parameters c FLUID_ELEMENT and c DIM_FLUID specify the type of the fluid element and its respectively The arguments are the pointer to the the number of the boundary in the fluid mesh adjacent to the elastic and the pointers to the fluid and wall meshes The function assumes that boundary coordinates have been set for the fluid nodes on the mesh boundary specified by the argument c boundary_in_fluid_mesh</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00515">fsi_collapsible_channel.txt:515</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af6e07423e22c0991084d9a2f43727805"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Non-dimensional wall thickness. As in Jensen &amp; Heil (2003) paper.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8cc_source.html#l00198">fsi_collapsible_channel.cc:198</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_af995de27075ee75da5cbfa222bb37f2e"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#af995de27075ee75da5cbfa222bb37f2e">A</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian f xi f I w textwidth wall_mesh_geometry_sketch2 A(continuous) beam structure</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ab363876de014048ff18a32d05617ae98"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ab363876de014048ff18a32d05617ae98">modifications</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the the wall motion of not prescribed but determined as part of the overall solution&lt; A HREF=&quot;http: Jensen \&amp; Heil's (2003)&lt;/A&gt; asymptotic analysis of the problem shows that the period of the oscillations is determined by the balance between fluid inertia and the elastic restoring forces In certain parameter the wall can extract energy from the pressure driven mean causing the oscillations to grow in amplitude In the present the Reynolds number is too small for this to happen and viscous dissipation causes the oscillations to as shown in this plot I w textwidth trace_fsi_taylor_hood Time trace of the axial velocities at two control points in the upstream and downstream cross and the vertical position of a control point on the wall&lt;HR&gt;&lt;HR&gt; section overview we generally recommend to first study the constituent single physics problems in i e Discretise the solid mechanics problem with a suitable c choose a load that is vaguely representative of the loads expected in the actual fluid structure interaction problem Discretise the fluid mechanics problem in a domain in which the deformation of the elastic boundary is described by a c GeomObject that performs a prescribed motion Choose a suitable node update strategy to adjust the position of the fluid nodes in response to a c Domain MacroElement based node update method is very easy to implement If try to impose a wall motion that is representative of the type of wall motion expected in the actual fluid structure interaction problem Once the behaviour of the two isolated single physics problems is sufficiently well combine the two single physics problems to a fully coupled problem The coupling introduces two types of interactions that must be incorporated into the computational we must ensure and point The dependence of the residuals of the c SolidFiniteElements on you may wish to skip the next few sections and continue with the ref where we demonstrate apart from a few trivial modifications</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00307">fsi_collapsible_channel.txt:307</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a02434016390de18f76210036d6910611"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a02434016390de18f76210036d6910611">problems</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell problems</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00419">fsi_collapsible_channel.txt:419</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a8e7e207ad7181df3307ddb31d62de767"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a8e7e207ad7181df3307ddb31d62de767">r</a></div><div class="ttdeci">Vector&lt; double &gt; r(2)</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a1f6d0300aad22d99fde5f60a19839958"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a1f6d0300aad22d99fde5f60a19839958">FSIHermiteBeamElements</a></div><div class="ttdeci">The wall mesh is built as in the corresponding&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; single physics beam this time with c FSIHermiteBeamElements</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00858">fsi_collapsible_channel.txt:858</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a921ac49d4aca3f6cd6390293dadaf1ce"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a921ac49d4aca3f6cd6390293dadaf1ce">Furthermore</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian f xi f I w textwidth wall_mesh_geometry_sketch2 parametrised by a Lagrangian coordinate Beam shell structures may therefore act as c GeomObjects if we interpret their Lagrangian f xi as the c GeomObject s intrinsic f zeta f&lt; B &gt; A discretised beam shell structure&lt;/B &gt; In an c oomph lib the beam shell structure of have been discretised by a number of c SolidFiniteElements The c MeshAsGeomObject discussed is therefore a compound c GeomObject that contains a number of sub objects the mesh s constituent c SolidFiniteElements Within the compound c GeomObject each sub object acts as a c GeomObject in its own right the shape of a c SolidFiniteElement is parametrised by its coordinate c s I w textwidth wall_mesh_geometry_sketch3 A discretised beam structure The c f zeta f in a two stage we shall discuss how the fluid traction is added to the load terms in the wall equations As mentioned the computation of the residuals of the wall equations requires the evaluation of the combined load vector at the Gauss points in the wall elements Furthermore</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00460">fsi_collapsible_channel.txt:460</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_ab0df284e935662242e05891f500a2f7c"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#ab0df284e935662242e05891f500a2f7c">above</a></div><div class="ttdeci">endcode Here is a graphical illustration of the various representations of the domain f zeta as shown in this r computes the position vector c r to a point on the c as identified by its intrinsic coordinate c zeta&lt; B &gt; A beam shell structure&lt;/B &gt; In beam shell the shape of the deformed structure is parametrised by its Lagrangian f xi f I w textwidth wall_mesh_geometry_sketch2 parametrised by a Lagrangian coordinate Beam shell structures may therefore act as c GeomObjects if we interpret their Lagrangian f xi as the c GeomObject s intrinsic f zeta f&lt; B &gt; A discretised beam shell structure&lt;/B &gt; In an c oomph lib the beam shell structure of have been discretised by a number of c SolidFiniteElements The c MeshAsGeomObject discussed above</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00434">fsi_collapsible_channel.txt:434</a></div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_a7281199adfb98d1c5ec3330a2c722579"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#a7281199adfb98d1c5ec3330a2c722579">upstream</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; elsewhere&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H *f The non dimensional position vector f therefore we define the non dimensional external pressure as f f mu U H used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f taken from&lt; A HREF=&quot;../figures/fsi_taylor_hood_flow8.avi&quot;&gt; the animation of the computational results&lt;/A &gt; The first four figures the axial component of the perturbation velocity and the pressure distribution The contour plot at the bottom of the figure shows a contour plot of the pressure and a few instantaneous streamlines The overall structure of the flow field is very similar to that observed in the corresponding&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; problem with prescribed wall the wall is moving inwards the sloshing flow generated in the upstream(downstream) rigid sections is directed against(in the same) direction as that of the pressure-driven mean flow. @I w 0.8\textwidth fsi_taylor_hood_flow &quot;Snapshot from the animation of the flow field. &quot; In the present problem</div></div>
<div class="ttc" id="afsi__collapsible__channel_8txt_html_afd9d5eeb008370b7185b141daf24b335"><div class="ttname"><a href="fsi__collapsible__channel_8txt.html#afd9d5eeb008370b7185b141daf24b335">Finally</a></div><div class="ttdeci">see ref ex The c MacroElement Domain based fluid mesh update requires the wall shape(which is now parametrised by the wall mesh 's constituent elements) to be represented by single \c GeomObject. We create the required &quot;compound&quot; \c GeomObject using the \c MeshAsGeomObject class We create the sub mesh that stores the applied traction elements and attach the elements to the upstream end of the channel The three sub meshes are then combined into the c Problem s single global mesh skipline Create surface mesh until until then we apply the boundary conditions for the fluid and the transverse velocity is pinned along the in and outflow(boundaries 1 and 5). . \until pin_velocity The applied traction elements require a pointer to the prescribed traction function Finally</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8txt_source.html#l00916">fsi_collapsible_channel.txt:916</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ae1a493695b7f4619af32f405b0b28861"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ae1a493695b7f4619af32f405b0b28861">Global_Physical_Variables::P_up</a></div><div class="ttdeci">double P_up</div><div class="ttdoc">Default pressure on the left boundary.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8cc_source.html#l00183">fsi_collapsible_channel.cc:183</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 19:30:38
        </div>
      </div>
    </footer>
</body>
</html>

Detailed documentation to be written. Here\textquotesingle{}s a plot of the result and the already fairly well documented driver code...

 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{elastic_fish}
\doxyfigcaption{Adaptive solution of Poisson\textquotesingle{}s equation in a fish-\/shaped domain for various \`{}widths\textquotesingle{} of the domain. }
\end{DoxyImage}


 
\begin{DoxyImage}
\includegraphics[width=0.75\textwidth]{trace}
\doxyfigcaption{Solution of Poisson\textquotesingle{}s equation at a control node as a function of the \`{}width\textquotesingle{} of the domain. }
\end{DoxyImage}



\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//LIC// ====================================================================}}
\DoxyCodeLine{\textcolor{comment}{//LIC// This file forms part of oomph-\/lib, the object-\/oriented, }}
\DoxyCodeLine{\textcolor{comment}{//LIC// multi-\/physics finite-\/element library, available }}
\DoxyCodeLine{\textcolor{comment}{//LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// Copyright (C) 2006-\/2024 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\textcolor{comment}{//LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\textcolor{comment}{//LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\textcolor{comment}{//LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\textcolor{comment}{//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\textcolor{comment}{//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\textcolor{comment}{//LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\textcolor{comment}{//LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\textcolor{comment}{//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\textcolor{comment}{//LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC//====================================================================}}
\DoxyCodeLine{\textcolor{comment}{// Driver for solution of "{}free boundary"{} 2D Poisson equation in }}
\DoxyCodeLine{\textcolor{comment}{// fish-\/shaped domain with adaptivity}}
\DoxyCodeLine{}
\DoxyCodeLine{ }
\DoxyCodeLine{\textcolor{comment}{// Generic oomph-\/lib headers}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}generic.h"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// The Poisson equations}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}poisson.h"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// The fish mesh }}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}meshes/fish\_mesh.h"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Circle as generalised element:}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{circle__as__generalised__element_8h}{circle\_as\_generalised\_element.h}}"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{using namespace }\mbox{\hyperlink{namespaceoomph}{oomph}};}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Namespace for const source term in Poisson equation}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceConstSourceForPoisson}{ConstSourceForPoisson}}}
\DoxyCodeLine{\{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Strength of source function: default value 1.0}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceConstSourceForPoisson_add351c5acab2561d68d1fc9ec3d5fc5e}{Strength}}=1.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Const source function}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceConstSourceForPoisson_a40ef79083874b58ed42b4df2ca0f4c10}{get\_source}}(\textcolor{keyword}{const} Vector<double>\& x, \textcolor{keywordtype}{double}\& source)}
\DoxyCodeLine{ \{}
\DoxyCodeLine{  source = -\/\mbox{\hyperlink{namespaceConstSourceForPoisson_add351c5acab2561d68d1fc9ec3d5fc5e}{Strength}}*(1.0+x[0]*x[1]);}
\DoxyCodeLine{ \}}
\DoxyCodeLine{ }
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//====================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Refineable Poisson problem in deformable fish-\/shaped domain.}}
\DoxyCodeLine{\textcolor{comment}{/// Template parameter identify the elements.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\textcolor{keyword}{class }\mbox{\hyperlink{classRefineableFishPoissonProblem}{RefineableFishPoissonProblem}} : \textcolor{keyword}{public} Problem}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ ///  Constructor: Bool flag specifies if position of fish back is}}
\DoxyCodeLine{\textcolor{comment}{ /// prescribed or computed from the coupled problem. String specifies}}
\DoxyCodeLine{\textcolor{comment}{ /// output directory.}}
\DoxyCodeLine{\textcolor{comment}{} \mbox{\hyperlink{classRefineableFishPoissonProblem}{RefineableFishPoissonProblem}}(}
\DoxyCodeLine{  \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& fix\_position, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& directory\_name,}
\DoxyCodeLine{  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& i\_case);}
\DoxyCodeLine{  \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Destructor}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keyword}{virtual} \string~\mbox{\hyperlink{classRefineableFishPoissonProblem}{RefineableFishPoissonProblem}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Update after Newton step: Update mesh in response to }}
\DoxyCodeLine{\textcolor{comment}{ /// possible changes in the wall shape}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} actions\_before\_newton\_convergence\_check()}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   fish\_mesh\_pt()-\/>node\_update();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Update the problem specs after solve (empty)}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} actions\_after\_newton\_solve()\{\}}
\DoxyCodeLine{  \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Update the problem specs before solve: Update mesh}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} actions\_before\_newton\_solve() }
\DoxyCodeLine{  \{}
\DoxyCodeLine{   fish\_mesh\_pt()-\/>node\_update();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Access function for the fish mesh}}
\DoxyCodeLine{ AlgebraicRefineableFishMesh<ELEMENT>* fish\_mesh\_pt() }
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{keywordflow}{return} Fish\_mesh\_pt;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Return value of the "{}load"{} on the elastically supported ring}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{double}\& load()}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{keywordflow}{return} *Load\_pt-\/>value\_pt(0);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Return value of the vertical displacement of the ring that}}
\DoxyCodeLine{\textcolor{comment}{ /// represents the fish's back}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{double}\& y\_c()}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}ElasticallySupportedRingElement*\textcolor{keyword}{>}(fish\_mesh\_pt()-\/>}
\DoxyCodeLine{                                                        fish\_back\_pt())-\/>y\_c();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Doc the solution}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} doc\_solution();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Access to DocInfo object}}
\DoxyCodeLine{\textcolor{comment}{} DocInfo\& doc\_info() \{\textcolor{keywordflow}{return} Doc\_info;\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Helper fct to set method for evaluation of shape derivs}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} set\_shape\_deriv\_method()}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{keywordtype}{bool} done=\textcolor{keyword}{false};}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{//Loop over elements and set pointers to source function}}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} n\_element = fish\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_element;i++)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     \textcolor{comment}{// Upcast from FiniteElement to the present element}}
\DoxyCodeLine{     ELEMENT *el\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(fish\_mesh\_pt()-\/>element\_pt(i));}
\DoxyCodeLine{     }
\DoxyCodeLine{     \textcolor{comment}{// Direct FD}}
\DoxyCodeLine{     \textcolor{keywordflow}{if} (Case\_id==0)}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       el\_pt-\/>evaluate\_shape\_derivs\_by\_direct\_fd();       }
\DoxyCodeLine{       \textcolor{keywordflow}{if} (!done) std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n [CR residuals] Direct FD"{}} << std::endl;}
\DoxyCodeLine{      \}}
\DoxyCodeLine{     \textcolor{comment}{// Chain rule with/without FD}}
\DoxyCodeLine{     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (Case\_id==1) ||  (Case\_id==2) )}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       \textcolor{comment}{// It's broken but let's call it anyway to keep self-\/test alive}}
\DoxyCodeLine{       \textcolor{keywordtype}{bool} i\_know\_what\_i\_am\_doing=\textcolor{keyword}{true};}
\DoxyCodeLine{       el\_pt-\/>evaluate\_shape\_derivs\_by\_chain\_rule(i\_know\_what\_i\_am\_doing);}
\DoxyCodeLine{       \textcolor{keywordflow}{if} (Case\_id==1)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         el\_pt-\/>enable\_always\_evaluate\_dresidual\_dnodal\_coordinates\_by\_fd();}
\DoxyCodeLine{         \textcolor{keywordflow}{if} (!done) std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n [CR residuals] Chain rule and FD"{}} }
\DoxyCodeLine{                              << std::endl;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{       \textcolor{keywordflow}{else}}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         el\_pt-\/>disable\_always\_evaluate\_dresidual\_dnodal\_coordinates\_by\_fd();}
\DoxyCodeLine{         \textcolor{keywordflow}{if} (!done) std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n [CR residuals] Chain rule and analytic"{}} }
\DoxyCodeLine{                              << std::endl;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{      \}}
\DoxyCodeLine{     \textcolor{comment}{// Fastest with/without FD}}
\DoxyCodeLine{     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (Case\_id==3) ||  (Case\_id==4) )}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       \textcolor{comment}{// It's broken but let's call it anyway to keep self-\/test alive}}
\DoxyCodeLine{       \textcolor{keywordtype}{bool} i\_know\_what\_i\_am\_doing=\textcolor{keyword}{true};}
\DoxyCodeLine{       el\_pt-\/>evaluate\_shape\_derivs\_by\_fastest\_method(i\_know\_what\_i\_am\_doing);}
\DoxyCodeLine{       \textcolor{keywordflow}{if} (Case\_id==3)}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         el\_pt-\/>enable\_always\_evaluate\_dresidual\_dnodal\_coordinates\_by\_fd();}
\DoxyCodeLine{         \textcolor{keywordflow}{if} (!done) std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n [CR residuals] Fastest and FD"{}} }
\DoxyCodeLine{                              << std::endl;}
\DoxyCodeLine{        \}}
\DoxyCodeLine{       \textcolor{keywordflow}{else}}
\DoxyCodeLine{        \{}
\DoxyCodeLine{         el\_pt-\/>disable\_always\_evaluate\_dresidual\_dnodal\_coordinates\_by\_fd();}
\DoxyCodeLine{         \textcolor{keywordflow}{if} (!done) std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n [CR residuals] Fastest and analytic"{}} }
\DoxyCodeLine{                              << std::endl;}
\DoxyCodeLine{         }
\DoxyCodeLine{        \}}
\DoxyCodeLine{      \}}
\DoxyCodeLine{     done=\textcolor{keyword}{true};}
\DoxyCodeLine{    \}}
\DoxyCodeLine{   }
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Node at which the solution of the Poisson equation is documented}}
\DoxyCodeLine{\textcolor{comment}{} Node* Doc\_node\_pt;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Trace file}}
\DoxyCodeLine{\textcolor{comment}{} ofstream Trace\_file;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Pointer to fish mesh}}
\DoxyCodeLine{\textcolor{comment}{} AlgebraicRefineableFishMesh<ELEMENT>* Fish\_mesh\_pt;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Pointer to single-\/element mesh that stores the GeneralisedElement}}
\DoxyCodeLine{\textcolor{comment}{ /// that represents the fish back}}
\DoxyCodeLine{\textcolor{comment}{} Mesh* Fish\_back\_mesh\_pt;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Pointer to data item that stores the "{}load"{} on the fish back}}
\DoxyCodeLine{\textcolor{comment}{} Data* Load\_pt;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Is the position of the fish back prescribed?}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{bool} Fix\_position;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Doc info object}}
\DoxyCodeLine{\textcolor{comment}{} DocInfo Doc\_info;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Case id}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{unsigned} Case\_id;}
\DoxyCodeLine{}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Constructor for adaptive Poisson problem in deformable fish-\/shaped}}
\DoxyCodeLine{\textcolor{comment}{/// domain. Pass flag if position of fish back is fixed, and the output}}
\DoxyCodeLine{\textcolor{comment}{/// directory. }}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\mbox{\hyperlink{classRefineableFishPoissonProblem_a2585d906fab348e09bfb9b4c111ac161}{RefineableFishPoissonProblem<ELEMENT>::RefineableFishPoissonProblem}}(}
\DoxyCodeLine{ \textcolor{keyword}{const} \textcolor{keywordtype}{bool}\& fix\_position, \textcolor{keyword}{const} \textcolor{keywordtype}{string}\& directory\_name,}
\DoxyCodeLine{ \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& i\_case) : Fix\_position(fix\_position), Case\_id(i\_case)}
\DoxyCodeLine{\{ }
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set output directory}}
\DoxyCodeLine{ Doc\_info.set\_directory(directory\_name); }
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Initialise step number}}
\DoxyCodeLine{ Doc\_info.number()=0;}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Open trace file}}
\DoxyCodeLine{ \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{ sprintf(filename,\textcolor{stringliteral}{"{}\%s/trace.dat"{}},directory\_name.c\_str());}
\DoxyCodeLine{ Trace\_file.open(filename);}
\DoxyCodeLine{}
\DoxyCodeLine{ Trace\_file }
\DoxyCodeLine{  << \textcolor{stringliteral}{"{}VARIABLES=\(\backslash\)"{}load\(\backslash\)"{},\(\backslash\)"{}y<sub>circle</sub>\(\backslash\)"{},\(\backslash\)"{}u<sub>control</sub>\(\backslash\)"{}"{}}}
\DoxyCodeLine{  << std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set coordinates and radius for the circle that will become the fish back}}
\DoxyCodeLine{ \textcolor{keywordtype}{double} x\_c=0.5;}
\DoxyCodeLine{ \textcolor{keywordtype}{double} y\_c=0.0;}
\DoxyCodeLine{ \textcolor{keywordtype}{double} r\_back=1.0;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Build geometric element that will become the fish back}}
\DoxyCodeLine{ GeomObject* fish\_back\_pt=\textcolor{keyword}{new} ElasticallySupportedRingElement(x\_c,y\_c,r\_back);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Build fish mesh with geometric object that specifies the fish back }}
\DoxyCodeLine{ Fish\_mesh\_pt=\textcolor{keyword}{new} AlgebraicRefineableFishMesh<ELEMENT>(fish\_back\_pt);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Add the fish mesh to the problem's collection of submeshes:}}
\DoxyCodeLine{ add\_sub\_mesh(Fish\_mesh\_pt);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Build mesh that will store only the geometric wall element}}
\DoxyCodeLine{ Fish\_back\_mesh\_pt=\textcolor{keyword}{new} Mesh;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// So far, the mesh is completely empty. Let's add the }}
\DoxyCodeLine{ \textcolor{comment}{// one (and only!) GeneralisedElement which represents the shape}}
\DoxyCodeLine{ \textcolor{comment}{// of the fish's back to it:}}
\DoxyCodeLine{ Fish\_back\_mesh\_pt-\/>add\_element\_pt(\textcolor{keyword}{dynamic\_cast<}GeneralisedElement*\textcolor{keyword}{>}(}
\DoxyCodeLine{                                    Fish\_mesh\_pt-\/>fish\_back\_pt()));}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Add the fish back mesh to the problem's collection of submeshes:}}
\DoxyCodeLine{ add\_sub\_mesh(Fish\_back\_mesh\_pt);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Now build global mesh from the submeshes}}
\DoxyCodeLine{ build\_global\_mesh();}
\DoxyCodeLine{}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Create/set error estimator}}
\DoxyCodeLine{ fish\_mesh\_pt()-\/>spatial\_error\_estimator\_pt()=\textcolor{keyword}{new} Z2ErrorEstimator;}
\DoxyCodeLine{  }
\DoxyCodeLine{ \textcolor{comment}{// Choose a node at which the solution is documented: Choose}}
\DoxyCodeLine{ \textcolor{comment}{// the central node that is shared by all four elements in}}
\DoxyCodeLine{ \textcolor{comment}{// the base mesh because it exists at all refinement levels.}}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// How many nodes does element 0 have?}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nnod=fish\_mesh\_pt()-\/>finite\_element\_pt(0)-\/>nnode();}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// The central node is the last node in element 0:}}
\DoxyCodeLine{ Doc\_node\_pt=fish\_mesh\_pt()-\/>finite\_element\_pt(0)-\/>node\_pt(nnod-\/1);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Doc}}
\DoxyCodeLine{ cout << std::endl <<  \textcolor{stringliteral}{"{}Control node is located at: "{}} }
\DoxyCodeLine{      << Doc\_node\_pt-\/>x(0) << \textcolor{stringliteral}{"{} "{}} << Doc\_node\_pt-\/>x(1) }
\DoxyCodeLine{      << std::endl << std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Position of fish back is prescribed}}
\DoxyCodeLine{ \textcolor{keywordflow}{if} (Fix\_position)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{comment}{// Create the load data object}}
\DoxyCodeLine{   Load\_pt=\textcolor{keyword}{new} Data(1);}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{// Pin the prescribed load}}
\DoxyCodeLine{   Load\_pt-\/>pin(0);}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{// Pin the vertical displacement}}
\DoxyCodeLine{   \textcolor{keyword}{dynamic\_cast<}ElasticallySupportedRingElement*\textcolor{keyword}{>}(}
\DoxyCodeLine{    Fish\_mesh\_pt-\/>fish\_back\_pt())-\/>pin\_yc();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{comment}{// Coupled problem: The position of the fish back is determined}}
\DoxyCodeLine{ \textcolor{comment}{// via the solution of the Poisson equation: The solution at}}
\DoxyCodeLine{ \textcolor{comment}{// the control node acts as the load for the displacement of the}}
\DoxyCodeLine{ \textcolor{comment}{// fish back}}
\DoxyCodeLine{ \textcolor{keywordflow}{else}}
\DoxyCodeLine{  \{   }
\DoxyCodeLine{   \textcolor{comment}{// Use the solution (value 0) at the control node as the load}}
\DoxyCodeLine{   \textcolor{comment}{// that acts on the ring. [Note: Node == Data by inheritance]}}
\DoxyCodeLine{   Load\_pt=Doc\_node\_pt;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set the pointer to the Data object that specifies the }}
\DoxyCodeLine{ \textcolor{comment}{// load on the fish's back}}
\DoxyCodeLine{ \textcolor{keyword}{dynamic\_cast<}ElasticallySupportedRingElement*\textcolor{keyword}{>}(Fish\_mesh\_pt-\/>fish\_back\_pt())-\/>}
\DoxyCodeLine{  set\_load\_pt(Load\_pt);}
\DoxyCodeLine{ }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set the boundary conditions for this problem: All nodes are}}
\DoxyCodeLine{ \textcolor{comment}{// free by default -\/-\/ just pin the ones that have Dirichlet conditions}}
\DoxyCodeLine{ \textcolor{comment}{// here. }}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} num\_bound = fish\_mesh\_pt()-\/>nboundary();}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} ibound=0;ibound<num\_bound;ibound++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} num\_nod= fish\_mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     fish\_mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>pin(0); }
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set homogeneous boundary conditions on all boundaries }}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} ibound=0;ibound<num\_bound;ibound++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{comment}{// Loop over the nodes on boundary}}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} num\_nod=fish\_mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     fish\_mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>set\_value(0,0.0);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Loop over elements and set pointers to source function}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{unsigned} n\_element = fish\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_element;i++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{comment}{// Upcast from FiniteElement to the present element}}
\DoxyCodeLine{   ELEMENT *el\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(fish\_mesh\_pt()-\/>element\_pt(i));}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{//Set the source function pointer}}
\DoxyCodeLine{   el\_pt-\/>source\_fct\_pt() = \&\mbox{\hyperlink{namespaceConstSourceForPoisson_a40ef79083874b58ed42b4df2ca0f4c10}{ConstSourceForPoisson::get\_source}};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set shape derivative method}}
\DoxyCodeLine{ set\_shape\_deriv\_method();}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Do equation numbering}}
\DoxyCodeLine{ cout <<\textcolor{stringliteral}{"{}Number of equations: "{}} << assign\_eqn\_numbers() << std::endl; }
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Destructor for Poisson problem in deformable fish-\/shaped domain.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\mbox{\hyperlink{classRefineableFishPoissonProblem_a7039a3409520850908940927b91af9ab}{RefineableFishPoissonProblem<ELEMENT>::\string~RefineableFishPoissonProblem}}()}
\DoxyCodeLine{\{ }
\DoxyCodeLine{ \textcolor{comment}{// Close trace file}}
\DoxyCodeLine{ Trace\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Doc the solution in tecplot format.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{classRefineableFishPoissonProblem_a6db25ff0bd3014aa531d9f0e8b385beb}{RefineableFishPoissonProblem<ELEMENT>::doc\_solution}}()}
\DoxyCodeLine{\{ }
\DoxyCodeLine{}
\DoxyCodeLine{ ofstream some\_file;}
\DoxyCodeLine{ \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Number of plot points in each coordinate direction.}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} npts;}
\DoxyCodeLine{ npts=5; }
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Output solution }}
\DoxyCodeLine{ \textcolor{keywordflow}{if} (Case\_id!=0)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   sprintf(filename,\textcolor{stringliteral}{"{}\%s/soln\_\%i\_\%i.dat"{}},Doc\_info.directory().c\_str(),}
\DoxyCodeLine{           Case\_id,Doc\_info.number());}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{keywordflow}{else}}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   sprintf(filename,\textcolor{stringliteral}{"{}\%s/soln\%i.dat"{}},Doc\_info.directory().c\_str(),}
\DoxyCodeLine{           Doc\_info.number());}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ some\_file.open(filename);}
\DoxyCodeLine{ fish\_mesh\_pt()-\/>output(some\_file,npts);}
\DoxyCodeLine{ some\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Write "{}load"{}, vertical position of the fish back, and solution at }}
\DoxyCodeLine{ \textcolor{comment}{// control node to trace file}}
\DoxyCodeLine{ Trace\_file }
\DoxyCodeLine{  << \textcolor{keyword}{static\_cast<}ElasticallySupportedRingElement*\textcolor{keyword}{>}(fish\_mesh\_pt()-\/>}
\DoxyCodeLine{                                          fish\_back\_pt())-\/>load()}
\DoxyCodeLine{  << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{  << \textcolor{keyword}{static\_cast<}ElasticallySupportedRingElement*\textcolor{keyword}{>}(fish\_mesh\_pt()-\/>}
\DoxyCodeLine{                                          fish\_back\_pt())-\/>y\_c()}
\DoxyCodeLine{  << \textcolor{stringliteral}{"{} "{}} << Doc\_node\_pt-\/>value(0) << std::endl;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{ }
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Demonstrate how to solve 2D Poisson problem in deformable}}
\DoxyCodeLine{\textcolor{comment}{/// fish-\/shaped domain with mesh adaptation.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{algebraic__free__boundary__poisson_8cc_abb923e967929c29b3a4fa1693604952a}{demo\_fish\_poisson}}(\textcolor{keyword}{const} \textcolor{keywordtype}{string}\& directory\_name)}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set up the problem with prescribed displacement of fish back}}
\DoxyCodeLine{ \textcolor{keywordtype}{bool} fix\_position=\textcolor{keyword}{true};}
\DoxyCodeLine{ \mbox{\hyperlink{classRefineableFishPoissonProblem}{RefineableFishPoissonProblem<ELEMENT>}} problem(fix\_position,directory\_name,0);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Doc refinement targets}}
\DoxyCodeLine{ problem.fish\_mesh\_pt()-\/>doc\_adaptivity\_targets(cout);}
\DoxyCodeLine{  }
\DoxyCodeLine{ \textcolor{comment}{// Do some uniform mesh refinement first}}
\DoxyCodeLine{ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{ problem.refine\_uniformly();}
\DoxyCodeLine{ problem.refine\_uniformly(); }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Initial value for the vertical displacement of the fish's back}}
\DoxyCodeLine{ problem.y\_c()=-\/0.3;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Loop for different fish shapes}}
\DoxyCodeLine{ \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Number of steps}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nstep=5;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Increment in displacement}}
\DoxyCodeLine{ \textcolor{keywordtype}{double} dyc=0.6/double(nstep-\/1);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Valiation: Just do one step}}
\DoxyCodeLine{ \textcolor{keywordflow}{if} (CommandLineArgs::Argc>1) nstep=1;}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} istep=0;istep<nstep;istep++)}
\DoxyCodeLine{  \{    }
\DoxyCodeLine{   \textcolor{comment}{// Solve/doc}}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} max\_solve=2; }
\DoxyCodeLine{   problem.newton\_solve(max\_solve);}
\DoxyCodeLine{   problem.doc\_solution();}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{//Increment counter for solutions }}
\DoxyCodeLine{   problem.doc\_info().number()++;    }
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{// Change vertical displacement}}
\DoxyCodeLine{   problem.y\_c()+=dyc;}
\DoxyCodeLine{  \} }
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Demonstrate how to solve "{}elastic"{} 2D Poisson problem in deformable}}
\DoxyCodeLine{\textcolor{comment}{/// fish-\/shaped domain with mesh adaptation.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{algebraic__free__boundary__poisson_8cc_a28565f965d7ffb7f92f3773a6333023b}{demo\_elastic\_fish\_poisson}}(\textcolor{keyword}{const} \textcolor{keywordtype}{string}\& directory\_name)}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Loop over all cases}}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_case=0;i\_case<5;i\_case++)}
\DoxyCodeLine{  \textcolor{comment}{//unsigned i\_case=1;}}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   std::cout << \textcolor{stringliteral}{"{}[CR residuals] "{}} << std::endl;}
\DoxyCodeLine{   std::cout << \textcolor{stringliteral}{"{}[CR residuals]=================================================="{}} }
\DoxyCodeLine{             << std::endl;}
\DoxyCodeLine{   std::cout << \textcolor{stringliteral}{"{}[CR residuals] "{}} << std::endl;}
\DoxyCodeLine{   \textcolor{comment}{//Set up the problem with "{}elastic"{} fish back}}
\DoxyCodeLine{   \textcolor{keywordtype}{bool} fix\_position=\textcolor{keyword}{false};}
\DoxyCodeLine{   \mbox{\hyperlink{classRefineableFishPoissonProblem}{RefineableFishPoissonProblem<ELEMENT>}} problem(fix\_position,}
\DoxyCodeLine{                                                 directory\_name,}
\DoxyCodeLine{                                                 i\_case);}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{// Doc refinement targets}}
\DoxyCodeLine{   problem.fish\_mesh\_pt()-\/>doc\_adaptivity\_targets(cout);}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{// Do some uniform mesh refinement first}}
\DoxyCodeLine{   \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{   problem.refine\_uniformly();}
\DoxyCodeLine{   problem.refine\_uniformly();}
\DoxyCodeLine{   }
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{// Initial value for load on fish back}}
\DoxyCodeLine{   problem.load()=0.0;}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{// Solve/doc}}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} max\_solve=2; }
\DoxyCodeLine{   problem.newton\_solve(max\_solve);}
\DoxyCodeLine{   problem.doc\_solution();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Driver for "{}elastic"{} fish poisson solver with adaptation.}}
\DoxyCodeLine{\textcolor{comment}{/// If there are any command line arguments, we regard this as a }}
\DoxyCodeLine{\textcolor{comment}{/// validation run and perform only a single step.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keywordtype}{int} \mbox{\hyperlink{algebraic__free__boundary__poisson_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}}(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}* argv[]) }
\DoxyCodeLine{\{}
\DoxyCodeLine{ \textcolor{comment}{// Store command line arguments}}
\DoxyCodeLine{ CommandLineArgs::setup(argc,argv);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Shorthand for element type}}
\DoxyCodeLine{  \textcolor{keyword}{typedef} AlgebraicElement<RefineableQPoissonElement<2,3> > ELEMENT;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Compute solution of Poisson equation in various domains}}
\DoxyCodeLine{  demo\_fish\_poisson<ELEMENT>(\textcolor{stringliteral}{"{}RESLT"{}});}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Compute "{}elastic"{} coupled solution directly}}
\DoxyCodeLine{  demo\_elastic\_fish\_poisson<ELEMENT>(\textcolor{stringliteral}{"{}RESLT\_coupled"{}}); }
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{PDF file}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}

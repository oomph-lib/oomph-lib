<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: unstructured_adaptive_fsi.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">unstructured_adaptive_fsi.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="unstructured__adaptive__fsi_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: 2D FSI on unstructured meshes with adaptivity</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This tutorial demonstrates the use of unstructured meshes</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">in 2D fluid-structure interaction problems with adaptivity. The</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">formulation is extremely similar to that used in </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">&lt;a href=&quot;../../../interaction/unstructured_fsi/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">unstructured fsi without adaptivity, &lt;/a&gt; but the geometry of the </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">problem is closely related to the </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">&lt;a href=&quot;../../fsi_channel_with_leaflet/html/index.html&quot;&gt; flow in a</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">channel with a leaflet using structured adaptivity. &lt;/a&gt; </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">The solid mechanics problem is exactly the same as that described in</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">the </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">&lt;a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">unstructured solid mechanics with adaptivity tutorial. &lt;/a&gt; The fluid</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">mechanics problem is new, but is a simple extension of the </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">previous problems. The key realisation is that the unstructured</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">refinement can take place independently for the fluid and solid</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">domains provided that the common boundary between them has a common</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">parametrisation. Moreover, the common boundary &lt;b&gt;must&lt;/b&gt; have the</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">same parametrisation in order for the fluid-structure interaction to</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">be set up in the first place. Thus, setting up unstructured adaptivity</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">for fsi problems is no more difficult than setting up the original</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">unstructured problem using \c oomph-lib&#39;s </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;a href=&quot;../../../meshes/mesh_from_inline_triangle/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">inline unstructured mesh generation &lt;/a&gt; procedures.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">\section the_problem The problem</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">The figure below shows a sketch of the problem. A 2D channel</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">is partly obstructed by an elastic bar and has an imposed parabolic</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">inlet velocity profile.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\image html fsi_sketch.gif &quot;Sketch of the problem showing fluid and solid boundary &quot; </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\image latex fsi_sketch.eps &quot;Sketch of the problem showing fluid and solid boundary &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> The non-dimension formulation is the same as described in </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">&lt;a href=&quot;../../unstructured_fsi/html/index.html&quot;&gt; the related</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> non-adaptive problem. &lt;/a&gt; The fluid structure interaction parameter</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> \f$Q \f$ is the ratio of viscous fluid stress to the reference stress</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> (Young&#39;s modulus) of the solid.  </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> The figure below shows streamlines and pressure contours for the</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> steady solution when \f$Q = 3\times 10^{-4} \f$ and \f$ Re = 0 \f$</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">\image html res.gif &quot;The flow field (streamlines and pressure contours) and the deformation of the elastic obstacle. &quot; </span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">\image latex res.eps &quot;The flow field (streamlines and pressure contours) and the deformation of the elastic obstacle. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\section overview_implementation Overview of the implementation</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> The implementation is exactly the same as described in the</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">&lt;a href=&quot;../../unstructured_fsi/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">non-adaptive unstructured mesh fluid-structure interaction problem. &lt;/a&gt;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">The only difference is that the meshes are constructed using \c</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">oomph-lib&#39;s &lt;a href=&quot;../../../meshes/mesh_from_inline_triangle/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">inline mesh generation procedures. &lt;/a&gt;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> For simplicity the common boundaries between the fluid and solid mesh</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> are assigned the same boundary ids, but this is not necessary. The</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> boundary ids for each domain are shown in the sketch above.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">\section namespace Problem Parameters</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">The various problem parameters are defined in a </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">global namespace. We define the Reynolds number, \f$ Re \f$, and</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">the FSI interaction parameter \f$ Q \f$.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">\dontinclude unstructured_adaptive_2d_fsi.cc</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">\skipline start_namespace</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">\until Q =</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">We specify the Poisson ratio of the solid and </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">provide a pointer to the constitutive equation for the</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">solid. </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">\until Constitutive_law_pt</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">The Poisson&#39;s ratio and pointer to a constitutive law for the mesh</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">deformation is specified separately.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\until end namespace </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">We set an output directory, trace file and instantiate the </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">constitutive laws for the real and mesh solid mechanics computations</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">with the appropriate Poisson ratios:</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">\dontinclude unstructured_adaptive_2d_fsi.cc</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\skipline DocInfo doc_info</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">\until ::Mesh_Nu);</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">We then create the \c Problem object and output the initial guess for</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">the solution</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">\until ()++</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">Initially \f$ Q=0 \f$ and \f$ Re=0 \f$, so the solid should remain</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">undeformed and the fluid problem is linear. We expect to obtain the</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">solution in one Newton iteration and so we perform one steady solve with</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">the default mesh and output the result. We also output the strain</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">energy of the solid and dissipation of the fluid as global measures of</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">the solution that can be used for validation. (The unstructured meshes </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">generated are not guaranteed to be exactly the same on different</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">computers.)</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">\until dissipation(trace);</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">Finally, we perform a parameter study by increasing \f$ Q \f$,</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">computing the result with one round of adaptivity and then writing the</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">results to output files.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\skipline Crank</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">\section class The Problem class</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">The \c Problem class has a constructor, destructor and a post-processing</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">member function. The class also includes the standard member</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">functions \c actions_before_adapt() and \c</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">actions_after_adapt(). There are private member </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">functions that create and destroy the</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">required \c FSISolidTractionElements that apply the load from the</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">fluid on the solid and the \c</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">ImposeDisplacementByLagrangeMultiplierElements that are used to</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">(weakly) align the boundary of the fluid mesh with the solid</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">domain. There are also private member functions to compute the fluid</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">dissipation, solid strain energy and a public member function that </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">outputs the computed strain and dissipation to a specified trace file.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">The class provided storage for pointers to the Solid Mesh, the Fluid</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">Mesh and vectors of pointers to meshes of \c FaceElements on</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">the boundaries over which the interaction takes place. There is also</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">storage for the \c GeomObject incarnations of fsi boundaries of the</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">solid mesh  and polygonal representations of the boundaries of the</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">fluid and solid meshes.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">\section constructor The Problem constructor</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> We start by building the solid mesh, an associated error estimator</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> and then writing the boundaries and mesh to output files. These steps</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> are exactly the same as in the </span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">&lt;a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; </span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> unstructured adaptive solid mechanics tutorial. &lt;/a&gt;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> \dontinclude unstructured_adaptive_2d_fsi.cc</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> \skipline start_constructor</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> \until output(&quot;solid_mesh.dat&quot;)</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> We next apply the boundary conditions to the solid mesh, by pinning</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> the positions of the nodes on the lower boundary (boundary 3)</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> \until end_solid_boundary</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> and complete the build of the solid elements by passing the pointer</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> to the constitutive law to all elements in the solid mesh.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> \until }</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> The next task is to build the fluid mesh, which uses three of the </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">boundary segments  already constructed for the solid mesh for the</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">common boundaries</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> before constructing the remaining boundaries, building the mesh, an</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> associated error estimator and writing the boundaries and mesh to</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> output files.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">\until output(&quot;fluid_mesh.dat&quot;) </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> We then apply boundary conditions to the fluid mesh by pinning</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> velocity everywhere apart from at the outflow (boundary 4) and</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> pinning all nodal positions on all boundaries that are not in contact</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> with the solid.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">\until end loop over boundaries</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> We next complete the build of the fluid elements by passing the</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> Reynolds number and mesh constitutive law to all fluid elements</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">\until end loop over elements</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> and then set the Dirichlet boundary conditions for the fluid velocity</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> on the inlet and channel walls.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">\until end Poiseuille</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> We then build three meshes of traction elements corresponding to the</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> solid boundaries 0,1 and 2 that bound the fluid</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">\until create_fsi_traction</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> and three analogous meshes of Lagrange multiplier elements.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">\until create_lagrange_multiplier</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> The order matters because the Lagrange multiplier elements need</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"> pointers to the \c GeomObject incarnation of the \c</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"> FSITractionElements. Thus the traction elements must be created</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> first.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"> We then combine all the sub meshes into a global mesh.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">\until build_global_mesh()</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"> Finally, we setup the fluid-structure interaction for all three</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"> boundaries 0, 1 and 2 and then assign the equation numbers.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> \until end constructor</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">\section actions_before Actions before adaptation</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">Before any adaptation takes place all surface meshes are deleted and</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">the global mesh is rebuilt.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">\dontinclude unstructured_adaptive_2d_fsi.cc</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">\skipline Actions before adapt</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">\section actions_after Actions after adaptation</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> The adaptation is performed separately on the fluid and solid meshes</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> and the order does not matter. In fact, the first mesh to be refined</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> will be the first that is added as a sub mesh (in this case the fluid</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"> mesh). After adaptation of all meshes, we first reset the Lagrangian</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"> coordinates of the Fluid mesh to ensure that the mesh deformation is</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"> as robust as possible.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> \until nodal_coordinates()</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> Note that we &lt;b&gt; must &lt;/b&gt; not reset the Lagrangian coordinates of</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> the solid mesh because that would change the undeformed configuration</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> of the solid. </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> We then reapply the solid boundary conditions and pass the</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> constitutive law to the solid elements.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> \until complete solid build</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"> Next, the fluid boundary conditions are reapplied and the Reynolds</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> number and mesh constitutive law are passed to all fluid elements., </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> \until end Poiseuille</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> We then create the traction and Lagrange multiplier</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> elements and rebuild the global mesh. </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> Again the traction elements must be created first because</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"> they are used by the Lagrange multiplier elements. </span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">\until rebuild_global_mesh()</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"> Finally, we setup the FSI on the three boundaries that are in common</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"> between the fluid and the solid.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> \until }</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">\section fsi_traction Creating and destroying the FSI traction and Lagrange multiplier elements</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"> These functions are exactly the same (apart from the obvious changes</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"> in boundary id) as those described in the </span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">&lt;a href=&quot;../../unstructured_fsi/html/index.html&quot;&gt; non-adaptive</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">unstructured fsi tutorial. &lt;/a&gt; and are not repeated here.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">\section doc_solution Post-processing</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">The post-processing routine simply executes the output functions for </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">the fluid and solid meshes and writes the results into separate</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">files. Again this is exactly the same as in the </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">&lt;a href=&quot;../../unstructured_fsi/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">non-adaptive &lt;/a&gt; case.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">\section comm_ex Comments and Exercises</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> The majority of comments in the </span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">&lt;a href=&quot;../../unstructured_fsi/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> non-adaptive unstructured FSI tutorial &lt;/a&gt; also apply here. As</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> mentioned above, the reason why the methodology works so</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> straightforwardly is because the</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> parametrisation of common boundaries must be the </span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> same in the fluid and solid meshes. If not, setting up the</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> fluid-structure interaction will not work even before any adaptation</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"> takes place. Thus, provided that your unstructured FSI problem has been</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> correctly set up in the case without adaptivity, adding adaptivity is</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> completely straightforward. </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">\subsection ex Exercises</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">-# Confirm that the order in which the sub-meshes are added does not</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">   affect the results.  </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">-# Investigate the behaviour of the system under increasing Reynolds</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">   number.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">-# Compare the results of the present (two-d elastic) problem </span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">to that of the </span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> &lt;a href=&quot;../../fsi_channel_with_leaflet/html/index.html&quot;&gt; </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">  (one-d) beam immersed within a channel. &lt;/a&gt; Do the results agree as</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">   the thickness of the two-d elastic bar decreases?</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">-# Modify your driver to perform unsteady runs and again compare your</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">   results to the one-dimensional beam code.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/unstructured_adaptive_fsi&quot;&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">demo_drivers/interaction/unstructured_adaptive_fsi</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">&lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/unstructured_adaptive_fsi/unstructured_adaptive_2d_fsi.cc&quot;&gt;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">demo_drivers/interaction/unstructured_adaptive_fsi/unstructured_adaptive_2d_fsi.cc</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_aacb2e10a0cde0accbf6f8d9926f3694e"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#aacb2e10a0cde0accbf6f8d9926f3694e">rebuild_global_mesh</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until by pinning the positions of the nodes on the lower which uses three of the boundary segments already constructed for the solid mesh for the common boundaries until before constructing the remaining building the an associated error estimator and writing the boundaries and mesh to output files until and that bound the fluid until create_fsi_traction and three analogous meshes of Lagrange multiplier elements until create_lagrange_multiplier The order matters because the Lagrange multiplier elements need pointers to the c GeomObject incarnation of the c FSITractionElements Thus the traction elements must be created first We then combine all the sub meshes into a global mesh until we setup the fluid structure interaction for all three and and then assign the equation numbers until end constructor&lt; HR &gt;&lt; HR &gt; section actions_before Actions before adaptation Before any adaptation takes place all surface meshes are deleted and the global mesh is rebuilt dontinclude unstructured_adaptive_2d_fsi cc skipline Actions before adapt until&lt; HR &gt;&lt; HR &gt; section actions_after Actions after adaptation The adaptation is performed separately on the fluid and solid meshes and the order does not matter In the first mesh to be refined will be the first that is added as a sub we first reset the Lagrangian coordinates of the Fluid mesh to ensure that the mesh deformation is as robust as possible until the fluid boundary conditions are reapplied and the Reynolds number and mesh constitutive law are passed to all fluid until end Poiseuille We then create the traction and Lagrange multiplier elements and rebuild the global mesh Again the traction elements must be created first because they are used by the Lagrange multiplier elements until rebuild_global_mesh() Finally</div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_ab1de6bba12cf02b89aef37032980d827"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#ab1de6bba12cf02b89aef37032980d827">build_global_mesh</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until by pinning the positions of the nodes on the lower which uses three of the boundary segments already constructed for the solid mesh for the common boundaries until before constructing the remaining building the an associated error estimator and writing the boundaries and mesh to output files until and that bound the fluid until create_fsi_traction and three analogous meshes of Lagrange multiplier elements until create_lagrange_multiplier The order matters because the Lagrange multiplier elements need pointers to the c GeomObject incarnation of the c FSITractionElements Thus the traction elements must be created first We then combine all the sub meshes into a global mesh until build_global_mesh() Finally</div></div>
<div class="ttc" id="aunstructured__adaptive__2d__fsi_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="unstructured__adaptive__2d__fsi_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Demonstrate how to solve an unstructured solid problem.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__2d__fsi_8cc_source.html#l00922">unstructured_adaptive_2d_fsi.cc:922</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a1f99b6c2737ad04828e18c698288a575"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a1f99b6c2737ad04828e18c698288a575">output</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until output(&quot;solid_mesh.dat&quot;) We next apply the boundary conditions to the solid mesh</div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a73d1d4f5dea4cd08cadd6cb7cb89b562"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a73d1d4f5dea4cd08cadd6cb7cb89b562">actions_before_adapt</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c actions_before_adapt() and \c actions_after_adapt(). There are private member functions that create and destroy the required \c FSISolidTractionElements that apply the load from the fluid on the solid and the \c ImposeDisplacementByLagrangeMultiplierElements that are used to(weakly) align the boundary of the fluid mesh with the solid domain. There are also private member functions to compute the fluid dissipation</div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a4f95c4b5171b92a96cf116858f3f23f6"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a4f95c4b5171b92a96cf116858f3f23f6">elements</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until by pinning the positions of the nodes on the lower which uses three of the boundary segments already constructed for the solid mesh for the common boundaries until before constructing the remaining building the an associated error estimator and writing the boundaries and mesh to output files until and that bound the fluid until create_fsi_traction and three analogous meshes of Lagrange multiplier elements until create_lagrange_multiplier The order matters because the Lagrange multiplier elements need pointers to the c GeomObject incarnation of the c FSITractionElements Thus the traction elements must be created first We then combine all the sub meshes into a global mesh until we setup the fluid structure interaction for all three and and then assign the equation numbers until end constructor&lt; HR &gt;&lt; HR &gt; section actions_before Actions before adaptation Before any adaptation takes place all surface meshes are deleted and the global mesh is rebuilt dontinclude unstructured_adaptive_2d_fsi cc skipline Actions before adapt until&lt; HR &gt;&lt; HR &gt; section actions_after Actions after adaptation The adaptation is performed separately on the fluid and solid meshes and the order does not matter In the first mesh to be refined will be the first that is added as a sub we first reset the Lagrangian coordinates of the Fluid mesh to ensure that the mesh deformation is as robust as possible until the fluid boundary conditions are reapplied and the Reynolds number and mesh constitutive law are passed to all fluid elements</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__fsi_8txt_source.html#l00269">unstructured_adaptive_fsi.txt:269</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_ad6ee9ecc4134c4adc35d73497f3f863f"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#ad6ee9ecc4134c4adc35d73497f3f863f">f</a></div><div class="ttdeci">we perform a parameter study by increasing f Q f</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__fsi_8txt_source.html#l00124">unstructured_adaptive_fsi.txt:124</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a14220603f1a05ca8da59da181fd867ce"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a14220603f1a05ca8da59da181fd867ce">until</a></div><div class="ttdeci">We then create the c Problem object and output the initial guess for the solution until()++Initially \f$ Q=0\f$ and \f$ Re=0\f$</div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a8b148fdc4c825e1b1d89b45b543c92a3"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a8b148fdc4c825e1b1d89b45b543c92a3">mesh</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until by pinning the positions of the nodes on the lower which uses three of the boundary segments already constructed for the solid mesh for the common boundaries until before constructing the remaining building the mesh</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__fsi_8txt_source.html#l00186">unstructured_adaptive_fsi.txt:186</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_aa3912fe923e56442a33abed852d2673f"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#aa3912fe923e56442a33abed852d2673f">fact</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until by pinning the positions of the nodes on the lower which uses three of the boundary segments already constructed for the solid mesh for the common boundaries until before constructing the remaining building the an associated error estimator and writing the boundaries and mesh to output files until and that bound the fluid until create_fsi_traction and three analogous meshes of Lagrange multiplier elements until create_lagrange_multiplier The order matters because the Lagrange multiplier elements need pointers to the c GeomObject incarnation of the c FSITractionElements Thus the traction elements must be created first We then combine all the sub meshes into a global mesh until we setup the fluid structure interaction for all three and and then assign the equation numbers until end constructor&lt; HR &gt;&lt; HR &gt; section actions_before Actions before adaptation Before any adaptation takes place all surface meshes are deleted and the global mesh is rebuilt dontinclude unstructured_adaptive_2d_fsi cc skipline Actions before adapt until&lt; HR &gt;&lt; HR &gt; section actions_after Actions after adaptation The adaptation is performed separately on the fluid and solid meshes and the order does not matter In fact</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__fsi_8txt_source.html#l00250">unstructured_adaptive_fsi.txt:250</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a317a2b0490add38c4119d64c511a9045"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a317a2b0490add38c4119d64c511a9045">href</a></div><div class="ttdeci">&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured solid mechanics with adaptivity tutorial.&lt;/a &gt; The fluid mechanics problem is new, but is a simple extension of the previous problems. The key realisation is that the unstructured refinement can take place independently for the fluid and solid domains provided that the common boundary between them has a common parametrisation. Moreover, the common boundary&lt; b &gt;must&lt;/b &gt; have the same parametrisation in order for the fluid-structure interaction to be set up in the first place. Thus, setting up unstructured adaptivity for fsi problems is no more difficult than setting up the original unstructured problem using \c oomph-lib 's&lt; a href=&quot;../../../meshes/mesh_from_inline_triangle/html/index.html&quot;&gt; inline unstructured mesh generation&lt;/a &gt; procedures.&lt; HR &gt;&lt; HR &gt; \section the_problem The problem The figure below shows a sketch of the problem. A 2D channel is partly obstructed by an elastic bar and has an imposed parabolic inlet velocity profile. @I w 0.75\textwidth fsi_sketch &quot;Sketch of the problem showing fluid and solid boundary ids.&quot; The non-dimension formulation is the same as described in&lt; a href=&quot;../../unstructured_fsi/html/index.html&quot;&gt; the related non-adaptive problem.&lt;/a &gt; The fluid structure interaction parameter \f $Q \f$ is the ratio of viscous fluid stress to the reference stress(Young 's modulus) of the solid.&lt; HR &gt;&lt; HR &gt; \section results Results The figure below shows streamlines and pressure contours for the steady solution when \f $Q=3\times 10^{-4} \f$ and \f$ Re=0 \f$ @I w 0.75\textwidth res &quot;The flow field (streamlines and pressure contours) and the deformation of the elastic obstacle. &quot;&lt; HR &gt;&lt; HR &gt; \section overview_implementation Overview of the implementation The implementation is exactly the same as described in the&lt; a href=&quot;../../unstructured_fsi/html/index.html&quot;&gt; non-adaptive unstructured mesh fluid-structure interaction problem.&lt;/a &gt; The only difference is that the meshes are constructed using \c oomph-lib 's&lt; a href=&quot;../../../meshes/mesh_from_inline_triangle/html/index.html&quot;&gt; inline mesh generation procedures.&lt;/a &gt; For simplicity the common boundaries between the fluid and solid mesh are assigned the same boundary ids, but this is not necessary. The boundary ids for each domain are shown in the sketch above.&lt; HR &gt;&lt; HR &gt; \section namespace Problem Parameters The various problem parameters are defined in a global namespace. We define the Reynolds number, \f$ Re \f$, and the FSI interaction parameter \f$ Q \f$. \dontinclude unstructured_adaptive_2d_fsi.cc \skipline start_namespace \until Q=We specify the Poisson ratio of the solid and provide a pointer to the constitutive equation for the solid. \until Constitutive_law_pt The Poisson 's ratio and pointer to a constitutive law for the mesh deformation is specified separately. \until end namespace&lt; HR &gt;&lt; HR &gt; \section main The driver code We set an output directory, trace file and instantiate the constitutive laws for the real and mesh solid mechanics computations with the appropriate Poisson ratios:\dontinclude unstructured_adaptive_2d_fsi.cc \skipline DocInfo doc_info \until ::Mesh_Nu) href</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__fsi_8txt_source.html#l00105">unstructured_adaptive_fsi.txt:105</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0f1535b448627cbfa0acfb742120d96f"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0f1535b448627cbfa0acfb742120d96f">Global_Physical_Variables::Mesh_Nu</a></div><div class="ttdeci">double Mesh_Nu</div><div class="ttdoc">Mesh poisson ratio.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__2d__fsi_8cc_source.html#l00095">unstructured_adaptive_2d_fsi.cc:95</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a1bfac226ea28b06c3ee4360f3c07dbfb"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a1bfac226ea28b06c3ee4360f3c07dbfb">boundary</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until by pinning the positions of the nodes on the lower boundary(boundary 3) \until end_solid_boundary and complete the build of the solid elements by passing the pointer to the const itutive law to all elements in the solid mesh. \until } The next task is to build the fluid mesh</div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_ad929b1cb755dfec91450fd4b3154900e"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a></div><div class="ttdeci">Finally</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__fsi_8txt_source.html#l00124">unstructured_adaptive_fsi.txt:124</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a387f383cbf285245f4f8fc3e6d9f9a98"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a387f383cbf285245f4f8fc3e6d9f9a98">boundaries</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until by pinning the positions of the nodes on the lower which uses three of the boundary segments already constructed for the solid mesh for the common boundaries until before constructing the remaining boundaries</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__fsi_8txt_source.html#l00186">unstructured_adaptive_fsi.txt:186</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__fsi_8txt_source.html#l00007">unstructured_adaptive_fsi.txt:7</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_aee0b52edca6ab42b1eb31bfbb8686c2a"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#aee0b52edca6ab42b1eb31bfbb8686c2a">nodal_coordinates</a></div><div class="ttdeci">we perform a parameter study by increasing f Q computing the result with one round of adaptivity and then writing the results to output files skipline Crank until&lt; HR &gt;&lt; HR &gt; section class The Problem class The c Problem class has a constructor destructor and a post processing member function The class also includes the standard member functions c solid strain energy and a public member function that outputs the computed strain and dissipation to a specified trace file The class provided storage for pointers to the Solid Mesh the Fluid Mesh and vectors of pointers to meshes of c FaceElements on the boundaries over which the interaction takes place There is also storage for the c GeomObject incarnations of fsi boundaries of the solid mesh and polygonal representations of the boundaries of the fluid and solid meshes&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by building the solid mesh an associated error estimator and then writing the boundaries and mesh to output files These steps are exactly the same as in the&lt; a href=&quot;../../../solid/unstructured_adaptive_solid/html/index.html&quot;&gt; unstructured adaptive solid mechanics tutorial&lt;/a &gt; dontinclude unstructured_adaptive_2d_fsi cc skipline start_constructor until by pinning the positions of the nodes on the lower which uses three of the boundary segments already constructed for the solid mesh for the common boundaries until before constructing the remaining building the an associated error estimator and writing the boundaries and mesh to output files until and that bound the fluid until create_fsi_traction and three analogous meshes of Lagrange multiplier elements until create_lagrange_multiplier The order matters because the Lagrange multiplier elements need pointers to the c GeomObject incarnation of the c FSITractionElements Thus the traction elements must be created first We then combine all the sub meshes into a global mesh until we setup the fluid structure interaction for all three and and then assign the equation numbers until end constructor&lt; HR &gt;&lt; HR &gt; section actions_before Actions before adaptation Before any adaptation takes place all surface meshes are deleted and the global mesh is rebuilt dontinclude unstructured_adaptive_2d_fsi cc skipline Actions before adapt until&lt; HR &gt;&lt; HR &gt; section actions_after Actions after adaptation The adaptation is performed separately on the fluid and solid meshes and the order does not matter In the first mesh to be refined will be the first that is added as a sub we first reset the Lagrangian coordinates of the Fluid mesh to ensure that the mesh deformation is as robust as possible until nodal_coordinates() Note that we&lt; b &gt; must&lt;/b &gt; not reset the Lagrangian coordinates of the solid mesh because that would change the undeformed configuration of the solid. We then reapply the solid boundary conditions and pass the const itutive law to the solid elements. \until complete solid build Next</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a66cb7ecda9ba0cd72367dd697f154545"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a66cb7ecda9ba0cd72367dd697f154545">Global_Physical_Variables::Q</a></div><div class="ttdeci">double Q</div><div class="ttdoc">FSI parameter.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__2d__fsi_8cc_source.html#l00086">unstructured_adaptive_2d_fsi.cc:86</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__adaptive__2d__fsi_8cc_source.html#l00083">unstructured_adaptive_2d_fsi.cc:83</a></div></div>
<div class="ttc" id="aunstructured__adaptive__fsi_8txt_html_a0197addb08ddcd8d75cee1fd59ada094"><div class="ttname"><a href="unstructured__adaptive__fsi_8txt.html#a0197addb08ddcd8d75cee1fd59ada094">validation</a></div><div class="ttdeci">We then create the c Problem object and output the initial guess for the solution so the solid should remain undeformed and the fluid problem is linear We expect to obtain the solution in one Newton iteration and so we perform one steady solve with the default mesh and output the result We also output the strain energy of the solid and dissipation of the fluid as global measures of the solution that can be used for validation(The unstructured meshes generated are not guaranteed to be exactly the same on different computers.) \until dissipation(trace)</div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Tue Jul 27 2021 11:27:43
        </div>
      </div>
    </footer>
</body>
</html>

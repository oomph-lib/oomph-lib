<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: simple_segregated_driver.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_e04e7117dd418a6eb6e24eeac048a60a.html">interaction</a></li><li class="navelem"><a class="el" href="dir_514612591f05a8c488d5db31a2726201.html">fsi_channel_seg_and_precond</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">simple_segregated_driver.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="simple__segregated__driver_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Generic oomph-lib includes</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;navier_stokes.h&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;beam.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;multi_physics.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// The wall mesh</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;meshes/one_d_lagrangian_mesh.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//Include the fluid mesh</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;meshes/collapsible_channel_mesh.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">// Include the general-purpose fsi collapsible channel problem</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fsi__chan__problem_8h.html">fsi_chan_problem.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//====Namespace_for_flags================================</span><span class="comment"></span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">/// Extend namespace for control flags</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span><span class="comment">//======================================================</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="namespaceFlags.html">   50</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceFlags.html">Flags</a></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> /// Use Newton solver (0) or segregated solver (1)?</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="namespaceFlags.html#a2cdfa6b776b959a060a1f2e8d4918789">   54</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceFlags.html#a2cdfa6b776b959a060a1f2e8d4918789">Use_segregated_solver</a>=1;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> /// Use pointwise Aitken extrapolation (1) or not (0)</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespaceFlags.html#aabfbfdb3e91e4df3fc2ec6e2a2e3567d">   57</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceFlags.html#aabfbfdb3e91e4df3fc2ec6e2a2e3567d">Use_pointwise_aitken</a>=0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> /// Under-relaxation parameter (1.0: no under-relaxation; 0.0: freeze) </span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="namespaceFlags.html#a6c3895aecba834ceda5fe1c3ecb13bba">   60</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceFlags.html#a6c3895aecba834ceda5fe1c3ecb13bba">Omega_under_relax</a>=1.0;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> /// Use Irons and Tuck extrapolation (1) or not (0)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="namespaceFlags.html#a9d92a2ec6ebd4e2ea66605c063e53915">   63</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceFlags.html#a9d92a2ec6ebd4e2ea66605c063e53915">Use_irons_and_tuck_extrapolation</a>=0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> /// Convergence criterion: 0: global resmax; 1: abs. change; 2: rel. change</span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="namespaceFlags.html#aba930ff1e462e642a27904df95baab7c">   66</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceFlags.html#aba930ff1e462e642a27904df95baab7c">Convergence_criterion</a>=0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> /// Convergence tolerance</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="namespaceFlags.html#a5550ee43b27fd03898a6718246b44e4a">   69</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceFlags.html#a5550ee43b27fd03898a6718246b44e4a">Convergence_tolerance</a>=1.0e-8;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//====start_of_problem_class==========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">/// Problem class -- add segregated solver capability to an existing</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">/// problem.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="classSegregatedFSICollapsibleChannelProblem.html">   86</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSegregatedFSICollapsibleChannelProblem.html">SegregatedFSICollapsibleChannelProblem</a> : </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; <span class="keyword">public</span> <span class="keyword">virtual</span> <a class="code" href="classFSICollapsibleChannelProblem.html">FSICollapsibleChannelProblem</a>&lt;ELEMENT&gt;,</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; <span class="keyword">public</span> <span class="keyword">virtual</span> SegregatableFSIProblem</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;public :</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> /// \short Constructor: The arguments are the same as the original</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> /// (non-segregated) problem, namely, numbers of elements and lengths</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> /// of different sections of the domain.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> <a class="code" href="classSegregatedFSICollapsibleChannelProblem.html">SegregatedFSICollapsibleChannelProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nup, </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ncollapsible,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ndown,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ny,</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lup,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lcollapsible, </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; ldown,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; ly,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; displ_control,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; steady_flag);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> /// Empty Destructor </span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classSegregatedFSICollapsibleChannelProblem.html#aa51bac3f0323fafcc86ff0bf0f6c010c">  108</a></span>&#160;<span class="comment"></span> <a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#aa51bac3f0323fafcc86ff0bf0f6c010c">~SegregatedFSICollapsibleChannelProblem</a>(){}</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> /// \short Identify the fluid and solid Data and meshes that</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> /// contain only elements involved in the respective sub-problems. </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> /// This is a specific implementation of a pure virtual function in the </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> /// SegregatableFSIProblem base class.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> identify_fluid_and_solid_dofs(Vector&lt;Data*&gt;&amp; fluid_data_pt,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                    Vector&lt;Data*&gt;&amp; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a47a833f5612182bfbef339f78a1f71b3">solid_data_pt</a>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                    Mesh*&amp; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a82a0bb94ec85811cb7be74852c922714">fluid_mesh_pt</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                    Mesh*&amp; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a37d0fc0ef332d4eae72596e277d5acdd">solid_mesh_pt</a>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; <span class="comment">// start_of_convergence_checks</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> /// \short Update nodal positions in the fluid mesh in</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> /// response to changes in the wall displacement field after every</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> /// Newton step in a monolithic or segregated solid solve. Note</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> /// the use of the (protected) flag Solve_type, which can take the</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> /// values Full_solve, Fluid_solve or Solid_solve. This flag is used</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> /// to allow specification of different actions depending on the</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> /// precise solve taking place.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classSegregatedFSICollapsibleChannelProblem.html#a2613090b2abf3809de381da12f1cd0d2">  129</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#a2613090b2abf3809de381da12f1cd0d2">actions_before_newton_convergence_check</a>()</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="comment">//For a &quot;true&quot; segregated solver, we would not do this in fluid or solid</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="comment">//solves, but adding the bulk node update to the solid solve phase aids</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="comment">//convergence and makes it possible for larger values of Q. Of course,</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <span class="comment">//there is a small cost associated with doing this.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keywordflow">if</span>(Solve_type!=Fluid_solve) {this-&gt;Bulk_mesh_pt-&gt;node_update();}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> /// Update nodal positions in the fluid mesh</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> /// in response to any changes in the wall displacement field after every </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> /// segregated solve. This is not strictly necessary because we</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> /// do the solid solve last, which performs its own node update before the </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> /// convergence check of the sub problem. It remains here because if we</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> /// were solving in a completely segregated fashion a node update would be </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> /// required for the fluid mesh in the final converged solution to be</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> /// consistent with the solid positions.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classSegregatedFSICollapsibleChannelProblem.html#a8ee14a1d4ab159c9b28dfcb177dc7c57">  147</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#a8ee14a1d4ab159c9b28dfcb177dc7c57">actions_before_segregated_convergence_check</a>()</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  { </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   this-&gt;Bulk_mesh_pt-&gt;node_update();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  } </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; <span class="comment">// end_of_convergence_checks</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> /// Document the solution</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo&amp; doc_info);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> /// Perform a steady run</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> steady_run();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;};</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">//=====start_of_constructor======================================</span><span class="comment"></span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">/// Constructor for the collapsible channel problem</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span><span class="comment">//===============================================================</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#ac762b472c2baafa23dae6b9ce38f31da">SegregatedFSICollapsibleChannelProblem&lt; ELEMENT&gt;::</a></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classSegregatedFSICollapsibleChannelProblem.html#ac762b472c2baafa23dae6b9ce38f31da">  168</a></span>&#160;<a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#ac762b472c2baafa23dae6b9ce38f31da">SegregatedFSICollapsibleChannelProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nup, </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ncollapsible,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ndown,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ny,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lup,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lcollapsible, </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; ldown,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; ly,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; displ_control,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; steady_flag) :</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; <a class="code" href="classFSICollapsibleChannelProblem.html">FSICollapsibleChannelProblem</a>&lt;ELEMENT&gt;(nup, </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                       ncollapsible,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                       ndown,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                       ny,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                       lup,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                       lcollapsible, </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                       ldown,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                       ly,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                       displ_control,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                       steady_flag) </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; <span class="comment">// Choose convergence criterion based on Flag::Convergence criterion</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; <span class="comment">// with tolerance given by Flag::Convergence_tolerance</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; <span class="keywordflow">if</span> (<a class="code" href="namespaceFlags.html#aba930ff1e462e642a27904df95baab7c">Flags::Convergence_criterion</a>==0)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   assess_convergence_based_on_max_global_residual(</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="namespaceFlags.html#a5550ee43b27fd03898a6718246b44e4a">Flags::Convergence_tolerance</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceFlags.html#aba930ff1e462e642a27904df95baab7c">Flags::Convergence_criterion</a>==1)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   assess_convergence_based_on_absolute_solid_change(</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="namespaceFlags.html#a5550ee43b27fd03898a6718246b44e4a">Flags::Convergence_tolerance</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceFlags.html#aba930ff1e462e642a27904df95baab7c">Flags::Convergence_criterion</a>==2)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   assess_convergence_based_on_relative_solid_change(</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="namespaceFlags.html#a5550ee43b27fd03898a6718246b44e4a">Flags::Convergence_tolerance</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; <span class="comment">//Select a convergence-acceleration technique based on control flags</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; <span class="comment">// Pointwise Aitken extrapolation</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; <span class="keywordflow">if</span>(<a class="code" href="namespaceFlags.html#aabfbfdb3e91e4df3fc2ec6e2a2e3567d">Flags::Use_pointwise_aitken</a>)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   this-&gt;<a class="code" href="fsi__channel__segregated__solver_8txt.html#ab4ad2ae336b426e1442b38e7e9ffd6b7">enable_pointwise_aitken</a>();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; <span class="keywordflow">else</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   this-&gt;disable_pointwise_aitken();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; <span class="comment">// Under-relaxation</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; this-&gt;enable_under_relaxation(<a class="code" href="namespaceFlags.html#a6c3895aecba834ceda5fe1c3ecb13bba">Flags::Omega_under_relax</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; <span class="comment">// Irons and Tuck&#39;s extrapolation</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; <span class="keywordflow">if</span>(<a class="code" href="namespaceFlags.html#a9d92a2ec6ebd4e2ea66605c063e53915">Flags::Use_irons_and_tuck_extrapolation</a>)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   this-&gt;enable_irons_and_tuck_extrapolation();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; <span class="keywordflow">else</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   this-&gt;disable_irons_and_tuck_extrapolation();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;} <span class="comment">//end_of_constructor</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">//=====start_of_identify_fluid_and_solid======================================</span><span class="comment"></span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">/// Identify the fluid and solid Data and the meshes that</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">/// contain only elements that are involved in the respective sub-problems. </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">/// This implements a pure virtual function in the </span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">/// SegregatableFSIProblem base class.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#a7b277b9583bb10e72655010dc653023e">SegregatedFSICollapsibleChannelProblem&lt;ELEMENT&gt;::</a></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="classSegregatedFSICollapsibleChannelProblem.html#a7b277b9583bb10e72655010dc653023e">  244</a></span>&#160;<a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#a7b277b9583bb10e72655010dc653023e">identify_fluid_and_solid_dofs</a>(Vector&lt;Data*&gt;&amp; fluid_data_pt,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                              Vector&lt;Data*&gt;&amp; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a47a833f5612182bfbef339f78a1f71b3">solid_data_pt</a>,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                              Mesh*&amp; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a82a0bb94ec85811cb7be74852c922714">fluid_mesh_pt</a>,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                              Mesh*&amp; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a37d0fc0ef332d4eae72596e277d5acdd">solid_mesh_pt</a>)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; <span class="comment">//FLUID DATA: </span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; <span class="comment">//All fluid elements are stored in the Mesh addressed by bulk_mesh_pt() </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; <span class="comment">//Reset the storage</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; fluid_data_pt.clear();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; <span class="comment">//Find number of fluid elements</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; <span class="keywordtype">unsigned</span> n_fluid_elem=this-&gt;bulk_mesh_pt()-&gt;nelement();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; <span class="comment">//Loop over fluid elements and add internal data to fluid_data_ptt</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_fluid_elem;e++)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   GeneralisedElement* el_pt=this-&gt;bulk_mesh_pt()-&gt;element_pt(e);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="keywordtype">unsigned</span> n_internal=el_pt-&gt;ninternal_data();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_internal;i++)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     fluid_data_pt.push_back(el_pt-&gt;internal_data_pt(i));</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; <span class="comment">//Find number of nodes in fluid mesh</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; <span class="keywordtype">unsigned</span> n_fluid_node=this-&gt;bulk_mesh_pt()-&gt;nnode();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; <span class="comment">//Loop over nodes and add the nodal data to fluid_data_pt</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n=0;n&lt;n_fluid_node;n++)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   fluid_data_pt.push_back(this-&gt;bulk_mesh_pt()-&gt;node_pt(n));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; <span class="comment">// The bulk_mesh_pt() is a mesh that contains only fluid elements</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a82a0bb94ec85811cb7be74852c922714">fluid_mesh_pt</a> = this-&gt;bulk_mesh_pt(); </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; <span class="comment">//SOLID DATA</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; <span class="comment">//All solid elements are stored in the Mesh addressed by wall_mesh_pt()</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; <span class="comment">//Reset the storage</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a47a833f5612182bfbef339f78a1f71b3">solid_data_pt</a>.clear();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; <span class="comment">//Find number of nodes in the solid mesh</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; <span class="keywordtype">unsigned</span> n_solid_node=this-&gt;wall_mesh_pt()-&gt;nnode();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; <span class="comment">//Loop over nodes and add nodal position data to solid_data_pt</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_solid_node;n++)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <a class="code" href="fsi__channel__segregated__solver_8txt.html#a47a833f5612182bfbef339f78a1f71b3">solid_data_pt</a>.push_back(</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    this-&gt;wall_mesh_pt()-&gt;node_pt(n)-&gt;variable_position_pt());</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; <span class="comment">//If we are using displacement control then the displacement control element</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; <span class="comment">//and external pressure degree of freedom should be treated as part</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; <span class="comment">//of the solid problem</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; <span class="comment">//We will assemble a single solid mesh from a vector of pointers to meshes</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; Vector&lt;Mesh*&gt; s_mesh_pt(1);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; <span class="comment">//The wall_mesh_pt() contains all solid elements and is the first</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; <span class="comment">//entry in our vector</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; s_mesh_pt[0]=this-&gt;wall_mesh_pt();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; <span class="comment">//If we are using displacement control</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; <span class="keywordflow">if</span> (this-&gt;Displ_control)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="comment">//Add the external pressure data to solid_data_pt</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <a class="code" href="fsi__channel__segregated__solver_8txt.html#a47a833f5612182bfbef339f78a1f71b3">solid_data_pt</a>.push_back(<a class="code" href="namespaceGlobal__Physical__Variables.html#ad31ed4ea9a7fce4c20c2230d26047f6f">Global_Physical_Variables::P_ext_data_pt</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <span class="comment">//Add a pointer to a Mesh containing the displacement control element</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="comment">//to the vector of pointers to meshes</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   s_mesh_pt.push_back(this-&gt;Displ_control_mesh_pt);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  } </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; <span class="comment">// Build &quot;combined&quot; mesh from our vector of solid meshes</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; <a class="code" href="fsi__channel__segregated__solver_8txt.html#a37d0fc0ef332d4eae72596e277d5acdd">solid_mesh_pt</a> = <span class="keyword">new</span> Mesh(s_mesh_pt);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;} <span class="comment">//end_of_identify_fluid_and_solid</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">//====start_of_doc_solution============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">/// Document the solution</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="classSegregatedFSICollapsibleChannelProblem.html#a0f7364ea880f2e740e1960830246e028">  326</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#a0f7364ea880f2e740e1960830246e028">SegregatedFSICollapsibleChannelProblem&lt;ELEMENT&gt;:: doc_solution</a>(</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; DocInfo&amp; doc_info)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{ </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; <span class="comment">//Output stream filenames</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; <span class="keywordtype">unsigned</span> npts=5;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; <span class="comment">// Output fluid solution </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; this-&gt;bulk_mesh_pt()-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; some_file.close();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; <span class="comment">// Document the wall shape</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/beam%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; this-&gt;wall_mesh_pt()-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; some_file.close();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;} <span class="comment">// end_of_doc_solution</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">//====steady_run==============================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">/// Perform a steady run in which the external pressure </span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">/// (or presribed displacement) is varied causing the channel to collapse.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="classSegregatedFSICollapsibleChannelProblem.html#a9a6b0dfeda9eb0d4c50e195768c93e37">  359</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSegregatedFSICollapsibleChannelProblem.html#a9a6b0dfeda9eb0d4c50e195768c93e37">SegregatedFSICollapsibleChannelProblem&lt;ELEMENT&gt;::steady_run</a>()</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{ </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; <span class="comment">// Set initial value for external pressure (on the wall stiffness scale). </span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; <span class="comment">// This can be overwritten in set_initial_condition.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#ad31ed4ea9a7fce4c20c2230d26047f6f">Global_Physical_Variables::P_ext_data_pt</a>-&gt;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  set_value(0,<a class="code" href="namespaceGlobal__Physical__Variables.html#ae6b6b04387b165c0da5160865170c0e7">Global_Physical_Variables::Pmin</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; <span class="comment">// Apply initial condition</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; set_initial_condition();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; <span class="comment">//Set output directory</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; <span class="comment">// Output the initial solution</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; doc_solution(doc_info);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; <span class="comment">// Increment step number</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; doc_info.number()++;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; <span class="comment">// Increment for external pressure (on the wall stiffness scale)</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; <span class="keywordtype">double</span> delta_p=(<a class="code" href="namespaceGlobal__Physical__Variables.html#a3e094a3c45284edb77a880f49c93f94b">Global_Physical_Variables::Pmax</a>-</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                 <a class="code" href="namespaceGlobal__Physical__Variables.html#ae6b6b04387b165c0da5160865170c0e7">Global_Physical_Variables::Pmin</a>)/<span class="keywordtype">double</span>(<a class="code" href="namespaceFlags.html#a8a6ffdb261330ef89965624209ab7b00">Flags::Nsteps</a>-1);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; <span class="comment">// Initial and final values for control position</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#afd29cc714595594020831c7c54387883">Global_Physical_Variables::Yprescr</a>=1.0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; <span class="comment">// Final value of prescribed displacement </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; <span class="keywordtype">double</span> y_min=0.65;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; <span class="comment">//Change in y-coordinate to attain the minimum position in a given</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; <span class="comment">//number of steps</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; <span class="keywordtype">double</span> delta_y=(y_min-<a class="code" href="namespaceGlobal__Physical__Variables.html#afd29cc714595594020831c7c54387883">Global_Physical_Variables::Yprescr</a>)/</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keywordtype">double</span>(<a class="code" href="namespaceFlags.html#a8a6ffdb261330ef89965624209ab7b00">Flags::Nsteps</a>-1);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; <span class="comment">// Parameter study (loop over the number of steps)</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;<a class="code" href="namespaceFlags.html#a8a6ffdb261330ef89965624209ab7b00">Flags::Nsteps</a>;istep++)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="comment">// Setup segregated solver </span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="comment">//(Default behaviour will identify the fluid and solid dofs and</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="comment">// allocate memory, etc every time. This is a bit inefficient in </span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="comment">// this case, but it is safe and will always work)</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <a class="code" href="fsi__channel__segregated__solver_8txt.html#a7db15b3153f424f5d06f38eb669ec399">setup_segregated_solver</a>();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="comment">// SEGREGATED SOLVER</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="keywordflow">if</span>(<a class="code" href="namespaceFlags.html#a2cdfa6b776b959a060a1f2e8d4918789">Flags::Use_segregated_solver</a>)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;     <span class="comment">//Set the maximum number of Picard steps</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;     Max_picard =50;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;     </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;     <span class="comment">// Solve ignoring return type (convergence data)</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;     (void)steady_segregated_solve();</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="comment">// NEWTON SOLVER</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;     <span class="comment">//Explit call to the steady Newton solve.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;     steady_newton_solve();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="comment">// Output the solution</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   doc_solution(doc_info);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <span class="comment">//Increase the Step number</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   doc_info.number()++;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="comment">// Adjust control parameters</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   <span class="comment">//If displacment control increment position</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="keywordflow">if</span> (this-&gt;Displ_control)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;     <a class="code" href="namespaceGlobal__Physical__Variables.html#afd29cc714595594020831c7c54387883">Global_Physical_Variables::Yprescr</a>+=delta_y;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="comment">//Otherwise increment external pressure</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;     <span class="keywordtype">double</span> old_p=<a class="code" href="namespaceGlobal__Physical__Variables.html#ad31ed4ea9a7fce4c20c2230d26047f6f">Global_Physical_Variables::P_ext_data_pt</a>-&gt;value(0);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;     <a class="code" href="namespaceGlobal__Physical__Variables.html#ad31ed4ea9a7fce4c20c2230d26047f6f">Global_Physical_Variables::P_ext_data_pt</a>-&gt;set_value(0,old_p+delta_p);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  } <span class="comment">// End of parameter study</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">//============start_of_main====================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">/// Driver code for a segregated collapsible channel problem with FSI.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"></span><span class="comment">//=============================================================================</span></div>
<div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="simple__segregated__driver_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">  445</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="simple__segregated__driver_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;{</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; <span class="comment">// Number of elements in the domain</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; <span class="keywordtype">unsigned</span> nup=4*<a class="code" href="namespaceFlags.html#a7c2437aa0b6a4f27df951f1cbcef7337">Flags::Resolution_factor</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; <span class="keywordtype">unsigned</span> ncollapsible=20*<a class="code" href="namespaceFlags.html#a7c2437aa0b6a4f27df951f1cbcef7337">Flags::Resolution_factor</a>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; <span class="keywordtype">unsigned</span> ndown=40*<a class="code" href="namespaceFlags.html#a7c2437aa0b6a4f27df951f1cbcef7337">Flags::Resolution_factor</a>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; <span class="keywordtype">unsigned</span> ny=4*<a class="code" href="namespaceFlags.html#a7c2437aa0b6a4f27df951f1cbcef7337">Flags::Resolution_factor</a>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; <span class="comment">// Geometry of the domain</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; <span class="keywordtype">double</span> lup=1.0;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; <span class="keywordtype">double</span> lcollapsible=5.0;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; <span class="keywordtype">double</span> ldown=10.0;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; <span class="keywordtype">double</span> ly=1.0;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; <span class="comment">// Steady run by default</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; <span class="keywordtype">bool</span> steady_flag=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; <span class="comment">// with displacement control</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; <span class="keywordtype">bool</span> displ_control=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; <span class="comment">// Build the problem with QTaylorHoodElements</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; <a class="code" href="classSegregatedFSICollapsibleChannelProblem.html">SegregatedFSICollapsibleChannelProblem</a></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  &lt;AlgebraicElement&lt;QTaylorHoodElement&lt;2&gt; &gt; &gt; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  problem(nup, ncollapsible, ndown, ny, </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          lup, lcollapsible, ldown, ly, displ_control,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          steady_flag);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; <span class="comment">//Perform a steady run</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; problem.steady_run();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;}<span class="comment">//end of main</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespaceFlags_html_a7c2437aa0b6a4f27df951f1cbcef7337"><div class="ttname"><a href="namespaceFlags.html#a7c2437aa0b6a4f27df951f1cbcef7337">Flags::Resolution_factor</a></div><div class="ttdeci">unsigned Resolution_factor</div><div class="ttdoc">Resolution factor (multiplier for number of elements across channel)</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__problem_8h_source.html#l00236">fsi_chan_problem.h:236</a></div></div>
<div class="ttc" id="afsi__channel__segregated__solver_8txt_html_a82a0bb94ec85811cb7be74852c922714"><div class="ttname"><a href="fsi__channel__segregated__solver_8txt.html#a82a0bb94ec85811cb7be74852c922714">fluid_mesh_pt</a></div><div class="ttdeci">&lt;/A &gt; and we shall assume that the standard monolithic problem has already been written In the present the monolithic problem class c FSICollapsibleChannelProblem is specified in the header file&lt; A HREF=&quot;../../../../demo_drivers/interaction/fsi_channel_seg_and_precond/fsi_chan_problem.h&quot;&gt; fsi_chan_problem h&lt;/A &gt; Having specified the our segregated solution strategy proceeds by alternating between fluid and solid the degrees of freedom associated with solve the fluid equations with a frozen wall shape the degrees of freedom associated with i e we provide the option to increment the solid mechanics degrees of freedom by a fraction of the change computed by the Newton solver These two steps are repeated in a fixed point iteration which continues until a given convergence criterion is or a maximum number of iterations is exceeded We note that different linear solvers preconditioners may be specified for solution of the linear systems arising during the Newton iteration for the isolated fluid and solid allowing the re use of optimal solution methods for individual sub problems This is generally perceived to be one of the key advantages of segregated solvers&lt; HR &gt;&lt; HR &gt; section how_its_done Brief discussion of the implementation subsection seg_problem The SegregatableFSIProblem&lt; b &gt; a Overall structure&lt;/b &gt; The&lt; A HREF=&quot;../../../the_data_structure/html/classoomph_1_1SegregatableFSIProblem.html&quot;&gt; c SegregatableFSIProblem&lt;/A &gt; class is used to implement our segregated solution strategy within c oomph lib The most important problem specific task is to divide all the problem data into distinct fluid and solid degrees of freedom and to partition the monolithic mesh into a mesh of fluid elements and a mesh of solid elements The problem specific partitioning should be implemented in Vector&lt; Data * &gt; Mesh *&amp; fluid_mesh_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__segregated__solver_8txt_source.html#l00202">fsi_channel_segregated_solver.txt:202</a></div></div>
<div class="ttc" id="anamespaceFlags_html_a9d92a2ec6ebd4e2ea66605c063e53915"><div class="ttname"><a href="namespaceFlags.html#a9d92a2ec6ebd4e2ea66605c063e53915">Flags::Use_irons_and_tuck_extrapolation</a></div><div class="ttdeci">unsigned Use_irons_and_tuck_extrapolation</div><div class="ttdoc">Use Irons and Tuck extrapolation (1) or not (0)</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00063">simple_segregated_driver.cc:63</a></div></div>
<div class="ttc" id="anamespaceFlags_html"><div class="ttname"><a href="namespaceFlags.html">Flags</a></div><div class="ttdoc">Extend namespace for control flags.</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00050">simple_segregated_driver.cc:50</a></div></div>
<div class="ttc" id="anamespaceFlags_html_a5550ee43b27fd03898a6718246b44e4a"><div class="ttname"><a href="namespaceFlags.html#a5550ee43b27fd03898a6718246b44e4a">Flags::Convergence_tolerance</a></div><div class="ttdeci">double Convergence_tolerance</div><div class="ttdoc">Convergence tolerance.</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00069">simple_segregated_driver.cc:69</a></div></div>
<div class="ttc" id="afsi__channel__segregated__solver_8txt_html_a37d0fc0ef332d4eae72596e277d5acdd"><div class="ttname"><a href="fsi__channel__segregated__solver_8txt.html#a37d0fc0ef332d4eae72596e277d5acdd">solid_mesh_pt</a></div><div class="ttdeci">&lt;/A &gt; and we shall assume that the standard monolithic problem has already been written In the present the monolithic problem class c FSICollapsibleChannelProblem is specified in the header file&lt; A HREF=&quot;../../../../demo_drivers/interaction/fsi_channel_seg_and_precond/fsi_chan_problem.h&quot;&gt; fsi_chan_problem h&lt;/A &gt; Having specified the our segregated solution strategy proceeds by alternating between fluid and solid the degrees of freedom associated with solve the fluid equations with a frozen wall shape the degrees of freedom associated with i e we provide the option to increment the solid mechanics degrees of freedom by a fraction of the change computed by the Newton solver These two steps are repeated in a fixed point iteration which continues until a given convergence criterion is or a maximum number of iterations is exceeded We note that different linear solvers preconditioners may be specified for solution of the linear systems arising during the Newton iteration for the isolated fluid and solid allowing the re use of optimal solution methods for individual sub problems This is generally perceived to be one of the key advantages of segregated solvers&lt; HR &gt;&lt; HR &gt; section how_its_done Brief discussion of the implementation subsection seg_problem The SegregatableFSIProblem&lt; b &gt; a Overall structure&lt;/b &gt; The&lt; A HREF=&quot;../../../the_data_structure/html/classoomph_1_1SegregatableFSIProblem.html&quot;&gt; c SegregatableFSIProblem&lt;/A &gt; class is used to implement our segregated solution strategy within c oomph lib The most important problem specific task is to divide all the problem data into distinct fluid and solid degrees of freedom and to partition the monolithic mesh into a mesh of fluid elements and a mesh of solid elements The problem specific partitioning should be implemented in Vector&lt; Data * &gt; Mesh Mesh *&amp; solid_mesh_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__segregated__solver_8txt_source.html#l00203">fsi_channel_segregated_solver.txt:203</a></div></div>
<div class="ttc" id="aclassSegregatedFSICollapsibleChannelProblem_html_a0f7364ea880f2e740e1960830246e028"><div class="ttname"><a href="classSegregatedFSICollapsibleChannelProblem.html#a0f7364ea880f2e740e1960830246e028">SegregatedFSICollapsibleChannelProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Document the solution.</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00326">simple_segregated_driver.cc:326</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_afd29cc714595594020831c7c54387883"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#afd29cc714595594020831c7c54387883">Global_Physical_Variables::Yprescr</a></div><div class="ttdeci">double Yprescr</div><div class="ttdoc">Current prescribed vertical position of control point (only used for displacement control)</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__problem_8h_source.html#l00066">fsi_chan_problem.h:66</a></div></div>
<div class="ttc" id="aclassFSICollapsibleChannelProblem_html"><div class="ttname"><a href="classFSICollapsibleChannelProblem.html">FSICollapsibleChannelProblem</a></div><div class="ttdoc">Problem class.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__problem_8h_source.html#l00314">fsi_chan_problem.h:314</a></div></div>
<div class="ttc" id="anamespaceFlags_html_a6c3895aecba834ceda5fe1c3ecb13bba"><div class="ttname"><a href="namespaceFlags.html#a6c3895aecba834ceda5fe1c3ecb13bba">Flags::Omega_under_relax</a></div><div class="ttdeci">double Omega_under_relax</div><div class="ttdoc">Under-relaxation parameter (1.0: no under-relaxation; 0.0: freeze)</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00060">simple_segregated_driver.cc:60</a></div></div>
<div class="ttc" id="aclassSegregatedFSICollapsibleChannelProblem_html_a7b277b9583bb10e72655010dc653023e"><div class="ttname"><a href="classSegregatedFSICollapsibleChannelProblem.html#a7b277b9583bb10e72655010dc653023e">SegregatedFSICollapsibleChannelProblem::identify_fluid_and_solid_dofs</a></div><div class="ttdeci">void identify_fluid_and_solid_dofs(Vector&lt; Data * &gt; &amp;fluid_data_pt, Vector&lt; Data * &gt; &amp;solid_data_pt, Mesh *&amp;fluid_mesh_pt, Mesh *&amp;solid_mesh_pt)</div><div class="ttdoc">Identify the fluid and solid Data and meshes that contain only elements involved in the respective su...</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00244">simple_segregated_driver.cc:244</a></div></div>
<div class="ttc" id="aclassSegregatedFSICollapsibleChannelProblem_html_ac762b472c2baafa23dae6b9ce38f31da"><div class="ttname"><a href="classSegregatedFSICollapsibleChannelProblem.html#ac762b472c2baafa23dae6b9ce38f31da">SegregatedFSICollapsibleChannelProblem::SegregatedFSICollapsibleChannelProblem</a></div><div class="ttdeci">SegregatedFSICollapsibleChannelProblem(const unsigned &amp;nup, const unsigned &amp;ncollapsible, const unsigned &amp;ndown, const unsigned &amp;ny, const double &amp;lup, const double &amp;lcollapsible, const double &amp;ldown, const double &amp;ly, const bool &amp;displ_control, const bool &amp;steady_flag)</div><div class="ttdoc">Constructor: The arguments are the same as the original (non-segregated) problem, namely,...</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00168">simple_segregated_driver.cc:168</a></div></div>
<div class="ttc" id="aclassSegregatedFSICollapsibleChannelProblem_html_a2613090b2abf3809de381da12f1cd0d2"><div class="ttname"><a href="classSegregatedFSICollapsibleChannelProblem.html#a2613090b2abf3809de381da12f1cd0d2">SegregatedFSICollapsibleChannelProblem::actions_before_newton_convergence_check</a></div><div class="ttdeci">void actions_before_newton_convergence_check()</div><div class="ttdoc">Update nodal positions in the fluid mesh in response to changes in the wall displacement field after ...</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00129">simple_segregated_driver.cc:129</a></div></div>
<div class="ttc" id="aclassSegregatedFSICollapsibleChannelProblem_html"><div class="ttname"><a href="classSegregatedFSICollapsibleChannelProblem.html">SegregatedFSICollapsibleChannelProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00086">simple_segregated_driver.cc:86</a></div></div>
<div class="ttc" id="asimple__segregated__driver_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="simple__segregated__driver_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver code for a segregated collapsible channel problem with FSI.</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00445">simple_segregated_driver.cc:445</a></div></div>
<div class="ttc" id="anamespaceFlags_html_aabfbfdb3e91e4df3fc2ec6e2a2e3567d"><div class="ttname"><a href="namespaceFlags.html#aabfbfdb3e91e4df3fc2ec6e2a2e3567d">Flags::Use_pointwise_aitken</a></div><div class="ttdeci">unsigned Use_pointwise_aitken</div><div class="ttdoc">Use pointwise Aitken extrapolation (1) or not (0)</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00057">simple_segregated_driver.cc:57</a></div></div>
<div class="ttc" id="anamespaceFlags_html_aba930ff1e462e642a27904df95baab7c"><div class="ttname"><a href="namespaceFlags.html#aba930ff1e462e642a27904df95baab7c">Flags::Convergence_criterion</a></div><div class="ttdeci">unsigned Convergence_criterion</div><div class="ttdoc">Convergence criterion: 0: global resmax; 1: abs. change; 2: rel. change.</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00066">simple_segregated_driver.cc:66</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ae6b6b04387b165c0da5160865170c0e7"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ae6b6b04387b165c0da5160865170c0e7">Global_Physical_Variables::Pmin</a></div><div class="ttdeci">double Pmin</div><div class="ttdoc">Min. pressure. Only used in steady runs during parameter incrementation. Use 1.5 for values of Re to ...</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__problem_8h_source.html#l00053">fsi_chan_problem.h:53</a></div></div>
<div class="ttc" id="afsi__chan__problem_8h_html"><div class="ttname"><a href="fsi__chan__problem_8h.html">fsi_chan_problem.h</a></div></div>
<div class="ttc" id="afsi__channel__segregated__solver_8txt_html_a47a833f5612182bfbef339f78a1f71b3"><div class="ttname"><a href="fsi__channel__segregated__solver_8txt.html#a47a833f5612182bfbef339f78a1f71b3">solid_data_pt</a></div><div class="ttdeci">&lt;/A &gt; and we shall assume that the standard monolithic problem has already been written In the present the monolithic problem class c FSICollapsibleChannelProblem is specified in the header file&lt; A HREF=&quot;../../../../demo_drivers/interaction/fsi_channel_seg_and_precond/fsi_chan_problem.h&quot;&gt; fsi_chan_problem h&lt;/A &gt; Having specified the our segregated solution strategy proceeds by alternating between fluid and solid the degrees of freedom associated with solve the fluid equations with a frozen wall shape the degrees of freedom associated with i e we provide the option to increment the solid mechanics degrees of freedom by a fraction of the change computed by the Newton solver These two steps are repeated in a fixed point iteration which continues until a given convergence criterion is or a maximum number of iterations is exceeded We note that different linear solvers preconditioners may be specified for solution of the linear systems arising during the Newton iteration for the isolated fluid and solid allowing the re use of optimal solution methods for individual sub problems This is generally perceived to be one of the key advantages of segregated solvers&lt; HR &gt;&lt; HR &gt; section how_its_done Brief discussion of the implementation subsection seg_problem The SegregatableFSIProblem&lt; b &gt; a Overall structure&lt;/b &gt; The&lt; A HREF=&quot;../../../the_data_structure/html/classoomph_1_1SegregatableFSIProblem.html&quot;&gt; c SegregatableFSIProblem&lt;/A &gt; class is used to implement our segregated solution strategy within c oomph lib The most important problem specific task is to divide all the problem data into distinct fluid and solid degrees of freedom and to partition the monolithic mesh into a mesh of fluid elements and a mesh of solid elements The problem specific partitioning should be implemented in Vector&lt; Data * &gt; &amp; solid_data_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__segregated__solver_8txt_source.html#l00201">fsi_channel_segregated_solver.txt:201</a></div></div>
<div class="ttc" id="aclassSegregatedFSICollapsibleChannelProblem_html_a8ee14a1d4ab159c9b28dfcb177dc7c57"><div class="ttname"><a href="classSegregatedFSICollapsibleChannelProblem.html#a8ee14a1d4ab159c9b28dfcb177dc7c57">SegregatedFSICollapsibleChannelProblem::actions_before_segregated_convergence_check</a></div><div class="ttdeci">void actions_before_segregated_convergence_check()</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00147">simple_segregated_driver.cc:147</a></div></div>
<div class="ttc" id="anamespaceFlags_html_a8a6ffdb261330ef89965624209ab7b00"><div class="ttname"><a href="namespaceFlags.html#a8a6ffdb261330ef89965624209ab7b00">Flags::Nsteps</a></div><div class="ttdeci">unsigned Nsteps</div><div class="ttdoc">Number of steps in parameter study.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__problem_8h_source.html#l00245">fsi_chan_problem.h:245</a></div></div>
<div class="ttc" id="anamespaceFlags_html_a2cdfa6b776b959a060a1f2e8d4918789"><div class="ttname"><a href="namespaceFlags.html#a2cdfa6b776b959a060a1f2e8d4918789">Flags::Use_segregated_solver</a></div><div class="ttdeci">unsigned Use_segregated_solver</div><div class="ttdoc">Use Newton solver (0) or segregated solver (1)?</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00054">simple_segregated_driver.cc:54</a></div></div>
<div class="ttc" id="afsi__channel__segregated__solver_8txt_html_a7db15b3153f424f5d06f38eb669ec399"><div class="ttname"><a href="fsi__channel__segregated__solver_8txt.html#a7db15b3153f424f5d06f38eb669ec399">setup_segregated_solver</a></div><div class="ttdeci">endcode which returns vectors of fluid and solid data and the meshes of fluid and solid elements virtual This function is called within the member function code void setup_segregated_solver(const bool &amp;full_setup_of_fluid_and_solid_dofs=true) \endcode which \em must be called immediately before every segregated solve. The optional boolean flag may be set to \c false if the solid and fluid meshes have not changed between solves(i.e. if no spatial adaptation was performed since the last call to the segregated solver). The \c setup_segregated_solver(...) function must still be called</div><div class="ttdoc">Set up segregated solver. The optional boolean argument defaults to true and causes the identify_flui...</div></div>
<div class="ttc" id="afsi__channel__segregated__solver_8txt_html_ab4ad2ae336b426e1442b38e7e9ffd6b7"><div class="ttname"><a href="fsi__channel__segregated__solver_8txt.html#ab4ad2ae336b426e1442b38e7e9ffd6b7">enable_pointwise_aitken</a></div><div class="ttdeci">endcode All three functions return an instance of a c PicardConvergenceData object which stores the convergence statistics of the segregated solve In virtual the member functions code SegregatedFSIProblem::actions_before_segregated_solve() \endcode \code SegregatedFSIProblem see B M R C A version of the Aitken accelerator for computer iteration International Journal of Numerical Methods in Engineering&lt; b &gt;&lt;/b &gt; n n code void enable_pointwise_aitken(const unsigned &amp;pointwise_aitken_start) \endcode If this function is called</div></div>
<div class="ttc" id="aclassSegregatedFSICollapsibleChannelProblem_html_a9a6b0dfeda9eb0d4c50e195768c93e37"><div class="ttname"><a href="classSegregatedFSICollapsibleChannelProblem.html#a9a6b0dfeda9eb0d4c50e195768c93e37">SegregatedFSICollapsibleChannelProblem::steady_run</a></div><div class="ttdeci">void steady_run()</div><div class="ttdoc">Perform a steady run.</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00359">simple_segregated_driver.cc:359</a></div></div>
<div class="ttc" id="aclassSegregatedFSICollapsibleChannelProblem_html_aa51bac3f0323fafcc86ff0bf0f6c010c"><div class="ttname"><a href="classSegregatedFSICollapsibleChannelProblem.html#aa51bac3f0323fafcc86ff0bf0f6c010c">SegregatedFSICollapsibleChannelProblem::~SegregatedFSICollapsibleChannelProblem</a></div><div class="ttdeci">~SegregatedFSICollapsibleChannelProblem()</div><div class="ttdoc">Empty Destructor.</div><div class="ttdef"><b>Definition:</b> <a href="simple__segregated__driver_8cc_source.html#l00108">simple_segregated_driver.cc:108</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ad31ed4ea9a7fce4c20c2230d26047f6f"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ad31ed4ea9a7fce4c20c2230d26047f6f">Global_Physical_Variables::P_ext_data_pt</a></div><div class="ttdeci">Data * P_ext_data_pt</div><div class="ttdoc">Pointer to Data object that stores external pressure.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__problem_8h_source.html#l00048">fsi_chan_problem.h:48</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a3e094a3c45284edb77a880f49c93f94b"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a3e094a3c45284edb77a880f49c93f94b">Global_Physical_Variables::Pmax</a></div><div class="ttdeci">double Pmax</div><div class="ttdoc">Max. pressure. Only used in steady runs during parameter incrementation. Use 2.0 for Re=250; 3....</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__problem_8h_source.html#l00058">fsi_chan_problem.h:58</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 6 2021 15:09:38
        </div>
      </div>
    </footer>
</body>
</html>

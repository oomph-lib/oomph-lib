<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: fsi_chan_alg.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fsi_chan_alg.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fsi__chan__alg_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Flow in a 2D collapsible channel revisited -- sparse algebraic node updates</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In an &lt;A HREF=&quot;../../fsi_collapsible_channel/html/index.html&quot;&gt;earlier</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">example,&lt;/A&gt; we demonstrated how the \c MacroElement/Domain - based</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">node-update procedure that we originally developed for problems </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">with moving, curvilinear domain boundaries may also be used in</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">fluid-structure interaction problems in which the position of the </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">domain boundary has to be determined as part of the solution. </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">We demonstrated that the driver code for the coupled multi-physics</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">problem was a straightforward combination of the driver codes</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">for the two constituent single-physics problems. The two key </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">steps required to couple the two single-physics codes were:</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">-# Recast the wall mesh to a \c GeomObject, using the \c</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   MeshAsGeomObject class. This class turns an existing solid</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">   mechanics mesh</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">   into a &quot;compound&quot; \c GeomObject in which material points on the      </span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">   wall are identified by their Lagrangian coordinate, \f$ \xi \f$ ,</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">   which doubles as the \c GeomObject&#39;s intrinsic coordinate,</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">   \f$ \zeta \f$ . \n\n</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">-# Use the &quot;compound&quot; \c GeomObject </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">   to represent the moving boundary of the fluid mesh. &quot;Upgrade&quot; the</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">   fluid elements (of type \c FLUID_ELEMENT, say) to the &quot;wrapped&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">   version \c MacroElementNodeUpdateElement&lt;FLUID_ELEMENT&gt; to allow the</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">   the node-update to be performed node-by-node, and to automatically</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">   evaluate the &quot;shape derivatives&quot; -- the derivatives of the fluid</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">   equations with respect to the (solid mechanics) degrees of freedom</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">   that determine their nodal positions. \n\n</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">While the implementation of these steps is very straightforward, we</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">pointed out that the resulting code was not particularly efficient </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">as the fluid-node update is not as sparse as it could (should!)</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">be: Since it is impossible to distinguish between the various sub-objects in </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">the &quot;compound&quot; \c GeomObject, we can do no better than to assume the </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">worst-case scenario, namely that the positional degrees </span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">of freedom of all \c SolidNodes in the wall mesh potentially affect </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">the nodal position in all fluid elements. This dramatically increases </span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">the size of the elemental Jacobian matrices, and creates many</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">nonzero entries in the off-diagonal blocks in the global Jacobian </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">matrix.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">\section alg_sparse Sparse algebraic node updates in FSI problems</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">To avoid this problem we need a node-update strategy in which the</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">position of each fluid node is determined by only a small number</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">of solid mechanics degrees of freedom. The algebraic node-update</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">strategy discussed in the </span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">non-FSI version of the collapsible channel problem,&lt;/A&gt; </span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">provides an ideal framework for this, as </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">it allows each node to update its own position, using a node-specific</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">update function. Recall that in the \c AlgebraicMesh - version of the</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">\c CollapsibleChannelMesh, each \c AlgebraicNode stored a pointer</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">to the (single) \c GeomObject that represented the moving curvilinear</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">boundary, and the Lagrangian coordinate of a reference point on this</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\c GeomObject. The node&#39;s node-update function then placed the node </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">at a fixed vertical fraction on the line connecting the reference</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">point on the &quot;elastic&quot; wall to a second reference point on the fixed</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">lower channel wall.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">Furthermore, the &quot;wrapped&quot; element, \c AlgebraicElement&lt;FLUID_ELEMENT&gt;, </span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">automatically computes the &quot;shape derivatives&quot; by finite-differencing the </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">fluid residuals with respect to the degrees of freedom stored</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">in the \c GeomObject&#39;s geometric \c Data, just as in the</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">case of the \c MacroElement - based node-update procedure. </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">If used in the form discussed in the </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">earlier example,&lt;/A&gt; this methodology does not (yet!) improve</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">the sparsity of the node update: The geometric \c Data of the</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">&quot;compound&quot; \c GeomObject that represents the wall still contains</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">the positional degrees of freedom of \e all of the mesh&#39;s constituent</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">\c FSIHermiteBeamElements. This is wasteful because the position of a material</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">point on the (discretised) wall depends only on the positional degrees </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">of freedom of the element that this point is located in. The </span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">(costly-to-compute) derivatives with respect to all other solid mechanics </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">degree of freedom are zero. We will therefore modify the node-update </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">procedure as follows: Each \c AlgebraicNode stores a pointer to the \c</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">FSIHermiteBeamElement that its reference point is located in.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">This is possible because \c FSIHermiteBeamElements are derived from the</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">\c FiniteElement class which, in turn, is derived from</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">the \c GeomObject class. In other words, the sub-objects of</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">the compound \c MeshAsGeomObject are \c GeomObjects themselves. </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">Their shape is parametrised by the \c FSIHermiteBeamElement&#39;s</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">local coordinate, \f$ s \f$ , which acts as the (sub-)\c GeomObject&#39;s </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">intrinsic coordinate, \f$ \zeta \f$ . </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">Given a pointer to a compound \c GeomObject, \c geom_obj_pt, say, and </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">the intrinsic coordinate \f$ \zeta_{compound} \f$ = \c zeta_compound </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">of a point in that \c GeomObject, the function \c GeomObject::locate_zeta(...)</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">may be used to determine a pointer, \c sub_obj_pt, to the sub-object</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">that this point is located in, and the vector of intrinsic </span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">coordinates \c zeta_sub_obj of the point in this sub-object.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">This procedure is illustrated in this code fragment:</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> [...] </span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">// Vector containing the (1D) intrinsic coordinate in the </span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">// compound GeomObject:</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">Vector&lt;double&gt; zeta_compound(1);</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">zeta_compound[0]=0.3;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">// Pointer to the sub-GeomObject:</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">GeomObject* sub_geom_obj_pt;</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// Vector containing the (1D) intrinsic coordinate in the </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">// sub-GeomObject:</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">Vector&lt;double&gt; zeta_sub_obj(1);</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">// Get it...</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">geom_obj_pt-&gt;locate_zeta(zeta_compound, sub_geom_obj_pt, zeta_sub_obj);</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">// Check the result: </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// Position vector to the point when viewed from</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">// the compound GeomObject</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">Vector&lt;double&gt; r_compound(2);</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">geom_obj_pt-&gt;position(zeta_compound,r_compound);</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">// Position vector to the point when viewed from</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">// the sub-GeomObject</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">Vector&lt;double&gt; r_sub(2);</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">sub_geom_obj_pt-&gt;position(zeta_sub,r_sub);</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">// With a bit of luck we should now have r_sub == r_compound...</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">[...]</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">Here is an illustration of the relation between the various</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">coordinates and \c GeomObjects:</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">\image html locate_zeta.gif &quot;Sketch of the various coordinates and GeomObjects. The (continuous) beam is parametrised by its Lagrangian coordinate xi which doubles as the intrinsic coordinate zeta for its role as a GeomObject. The (discretised) beam is a compound GeomObject, parametrised by the Lagrangian coordinate xi; its constituent FSI beam elements are sub-GeomObjects that are parametrised by their local coordinates, s. &quot; </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">\image latex locate_zeta.eps &quot;Sketch of the various coordinates and GeomObjects. The (continuous) beam is parametrised by its Lagrangian coordinate xi which doubles as the intrinsic coordinate zeta for its role as a GeomObject. The (discretised) beam is a compound GeomObject, parametrised by the Lagrangian coordinate xi; its constituent FSI beam elements are sub-GeomObjects that are parametrised by their local coordinates, s. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">We note that the \c GeomObject base class provides a default</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">implementation for the \c GeomObject::locate_zeta(...) function</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">as a virtual member function which returns the \c GeomObject&#39;s </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">&lt;CODE&gt;&quot;this&quot;&lt;/CODE&gt; pointer and sets \f$ \zeta_{compound} =</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">\zeta_{sub} \f$ . Unless the function is overloaded in a</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">specific derived class, the \c GeomObject therefore acts as its own </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">sub-object. This is a sensible default as it ensures that</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">(\c geom_obj_pt, \f$ \zeta_{compound}\f$ ) and (\c sub_geom_obj_pt, \c</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">\f$ \zeta_{sub}\f$ ) always identify the same point, regardless of </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">whether nor not the \c GeomObject pointed to by \c geom_obj_pt is a </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">&quot;compound&quot; \c GeomObject.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">\section impl The implementation</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">The implementation of the sparse node-update strategy requires only</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">a few minor modifications to the \c</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">AlgebraicCollapsibleChannelMesh, first discussed in the </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">non-FSI example.&lt;/A&gt;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">\subsection mesh The AlgebraicCollapsibleChannelMesh</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">We construct the mesh by multiple inheritance, combining the</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">already existing \c CollapsibleChannelMesh with the \c AlgebraicMesh</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">base class:</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">\dontinclude collapsible_channel_mesh.template.h</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">\skipline start_of_algebraic_collapsible_channel_mesh</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">\until {</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">The constructor calls the constructor of the underlying</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">\c CollapsibleChannelMesh and then calls the private member function</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">\c setup_algebraic_node_update() to initialise the data for the </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">algebraic node update procedures.  (The initialisation is implemented in </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">a separate function so it can be called from additional</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">mesh constructors that are not discussed here.) The destructor</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">remains empty.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">\until virtual ~AlgebraicCollapsibleChannelMesh(){}</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">The function \c algebraic_node_update(...) is defined as a pure virtual</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">function in the \c AlgebraicMesh base class and therefore must be </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">implemented, whereas the virtual function \c update_node_update(...)</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">is only required for refineable meshes and can remain</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">empty.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">\skipline Update nodal position at time level t</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">\until };</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">The setup of the algebraic node update is very similar to that</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">used in the </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">non-FSI example discussed earlier.&lt;/A&gt; The main difference between the</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">two versions of the mesh is that we use the function </span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">\c GeomObject::locate_zeta(...) to determine</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">the sub-\c GeomObject within which the reference point on the wall</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">is located. As discussed above, the default implementation of this</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">function in the \c GeomObject base class ensures that the mesh</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">can be used with compound and non-compound \c GeomObjects.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">We start by determining the x and y-coordinates of the nodes and</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">decide if they are located in the collapsible part of</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">the mesh. (The positions of nodes that are located in the rigid upstream </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">and downstream channel segments do not have to be updated; for such</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">nodes we skip the assignment of the node-update data. See the</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">discussion in the </span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">non-FSI example&lt;/A&gt; for details.) </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">\dontinclude collapsible_channel_mesh.template.cc</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">\skipline start_setup</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">\until x&lt;=(l_up+l_collapsible)  </span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">Assuming that the wall is in its undeformed position (we&#39;ll check</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">this in a second...), we determine the intrinsic coordinate </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">of the reference point on the upper wall (taking the offset </span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">between \f$ x\f$ and \f$ \zeta\f$ into account: The left end of</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">the elastic wall is located at\f$ \zeta=0\f$ and at \f$ x = L_{up}</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">\f$ ), and identify the sub - \c GeomObject within which the reference </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">point is located. </span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">\until locate_zeta</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">Just to be on the safe side, we double check that the wall</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">is still in its undeformed position:</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">\until #endif</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">Now we can create the node update data for the present \c</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">AlgebraicNode. The node update function involves a single \c</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">GeomObject: The (sub-)\c GeomObject within which the reference</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">point on the upper wall is located.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">\until geom_object_pt[0]=</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">As in the mesh used in the </span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">non-FSI example&lt;/A&gt; we store the x-coordinate of the reference</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">point on the lower wall, the fractional height of the node, and its intrinsic</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">coordinate in the (sub-)\c GeomObject on the upper wall.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">We also store the intrinsic coordinate of the reference point </span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">in the compound \c GeomObject (i.e. the Lagrangian coordinate of the</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">reference point in the continuous beam). This will turn out to be useful in </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">the refineable version of this mesh, to be discussed in </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">&lt;A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt;the next</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">example.&lt;/A&gt;</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">\until ref_value[3]</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">Finally, we create the node update information by passing the pointer </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">to the mesh, the pointer to the \c GeomObject and the reference</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">values to the \c AlgebraicNode.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\until  end of setup_algebraic_node_update </span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">\section driver The driver code</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">Since \c oomph-lib&#39;s various node update procedures use the same</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">interfaces, changing the node update strategy from the </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">\c Domain/MacroElement - based procedure, discussed in the </span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">&lt;A HREF=&quot;../../fsi_collapsible_channel/html/index.html&quot;&gt;previous example,&lt;/A&gt;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">to the procedure implemented in the \c AlgebraicCollapsibleChannelMesh, </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">only requires minimal changes to the driver code. In fact, the</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">changes are so trivial, that both versions are implemented in the</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">same driver code, </span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/fsi_collapsible_channel/fsi_collapsible_channel.cc&quot;&gt;fsi_collapsible_channel.cc&lt;/A&gt;,</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">using compiler flags to switch from one version to the other. </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">If the code is compiled with the flag \c -DMACRO_ELEMENT_NODE_UPDATE</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">the \c Domain/MacroElement - based node-update procedure, implemented in the</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\c  MacroElementNodeUpdateCollapsibleChannelMesh is used, otherwise</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">the code uses the  \c AlgebraicCollapsibleChannelMesh, discussed</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">above. Here is one of the few portions of the code where </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">the distinction between the two versions is required: The access</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">function to the &quot;bulk&quot; (fluid) mesh in the problem class.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">\dontinclude fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">\skipline #ifdef MACRO_ELEMENT</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">\until #endif</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">Incidentally, the driver code also uses compiler flags to switch</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">between Crouzeix-Raviart and Taylor-Hood elements for the</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">discretisation of the Navier-Stokes equations. By default,</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">Crouzeix-Raviart elements are used; Taylor-Hood elements are used</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">if the code is compiled with with the flag \c -DTAYLOR_HOOD.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">The animations shown below illustrate the interaction between fluid and </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">solid mechanics degrees of freedom in the computations with the</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">algebraic node update. Comparison with the corresponding animations</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">for the \c Domain/MacroElement - based procedures, shown in the</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">&lt;A HREF=&quot;../../fsi_collapsible_channel/html/index.html#comments&quot;&gt;earlier</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">example&lt;/A&gt; demonstrates the greatly improved sparsity of the</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">node update. With the algebraic node-update procedures, the residuals </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">of the \c FSIHermiteBeamElements now only depend on the fluid degrees</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">of freedom in the adjacent fluid elements and on the solid mechanics </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">degree of freedom in the  \c FSIHermiteBeamElements that affect the </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">nodal position in these fluid elements.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">\image html cr_alg.gif &quot;Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh. (The fluid elements are 2D Crouzeix-Raviart elements.) &quot; </span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">\image latex cr_alg.eps &quot;Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh. (The fluid elements are 2D Crouzeix-Raviart elements.) &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">Here is the corresponding animation for a discretisation with</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">2D Taylor-Hood elements. These elements have no internal \c Data but</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">the pressure degrees of freedom are stored at the fluid element&#39;s</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">corner nodes:</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">\image html th_alg.gif &quot;Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh. (The fluid elements are 2D Taylor-Hood elements.) &quot; </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">\image latex th_alg.eps &quot;Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh. (The fluid elements are 2D Taylor-Hood elements.) &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">Finally, here is an animation that shows the (solid mechanics) degrees</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">of freedom that affect the node-update of a given fluid node. </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">The red square marker shows the fluid node; the green numbers</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">show the number of the degrees of freedom at the \c SolidNodes</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">that are involved that fluid node&#39;s node update. With the</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">algebraic node update, the position of each fluid node is</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">only affected by the solid mechanics degree of freedom </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">in the \c FSIHermiteBeamElement that contains its reference point.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">\image html fsi_fluid_nodes.gif &quot;Animation of the Data values that affect the node update of the fluid nodes. &quot; </span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">\image latex fsi_fluid_nodes.eps &quot;Animation of the Data values that affect the node update of the fluid nodes. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">The improved sparsity leads to a very significant speedup compared</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">to the \c MacroElement/Domain - based node update procedure. </span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">\section ex Exercises</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">-# Demonstrate that the dramatically improved execution speed</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">   achieved with the \c AlgebraicCollapsibleChannelMesh is mainly due to the</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">   improved sparsity of the node update, achieved by using the </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">   \c GeomObject::locate_zeta(...) function. \n\n \b Hint: You can either</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">   copy the basic \c MyAlgebraicCollapsibleChannelMesh in the file </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../../../demo_drivers/navier_stokes/collapsible_channel/my_alg_channel_mesh.h&quot;&gt;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">   my_algebraic_collapsible_channel_mesh.h&lt;/A&gt;,</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">   developed for the </span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">   non-FSI version of the collapsible channel problem,&lt;/A&gt; into </span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">   the FSI driver code</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../../../demo_drivers/interaction/fsi_collapsible_channel/fsi_collapsible_channel.cc&quot;&gt;fsi_collapsible_channel.cc&lt;/A&gt; and use that mesh</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">   instead of the \c  AlgebraicCollapsibleChannelMesh, or</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">   replace the line</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">   \code</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">   this-&gt;Wall_pt-&gt;locate_zeta(zeta,geom_obj_pt,s);</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">   \endcode</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">   in the function \c </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">   AlgebraicCollapsibleChannelMesh&lt;ELEMENT&gt;::setup_algebraic_node_update()</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">   in &lt;A HREF=&quot;../../../../src/meshes/collapsible_channel_mesh.template.cc&quot;&gt;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">   collapsible_channel_mesh.template.cc&lt;/A&gt; by \n\n</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">   \code</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">   this-&gt;Wall_pt-&gt;GeomObject::locate_zeta(zeta,geom_obj_pt,s);</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">   \endcode</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">   thus bypassing the &quot;sparsification&quot;.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">-# Explore how the speedup achievable with the algebraic node</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">   update procedure depends on the mesh resolution. A speedup by a</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">   factor of ten is typical for computations on the coarse mesh</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">   used for the validation runs; much more dramatic speedups </span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">   tend to be obtained on finer meshes. \n\n        </span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/fsi_collapsible_channel/&quot;&gt;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">demo_drivers/interaction/fsi_collapsible_channel/</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">&lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/fsi_collapsible_channel/fsi_collapsible_channel.cc&quot;&gt;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">demo_drivers/interaction/fsi_collapsible_channel/fsi_collapsible_channel.cc</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="afsi__chan__alg_8txt_html_a15260a3f5b30cbcc81d55c4a113abbea"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a15260a3f5b30cbcc81d55c4a113abbea">moving</a></div><div class="ttdeci">mainpage Flow in a collapsible channel revisited sparse algebraic node updates In an&lt; A HREF=&quot;../../fsi_collapsible_channel/html/index.html&quot;&gt; earlier&lt;/A &gt; we demonstrated how the c MacroElement Domain based node update procedure that we originally developed for problems with moving</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00006">fsi_chan_alg.txt:6</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_abe424f08e66f27c7f8d1d33f53631f01"><div class="ttname"><a href="fsi__chan__alg_8txt.html#abe424f08e66f27c7f8d1d33f53631f01">position</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe we double check that the wall is still in its undeformed position</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00244">fsi_chan_alg.txt:244</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a9fc5c1b668c9519cd120b01ba19b2cd5"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a9fc5c1b668c9519cd120b01ba19b2cd5">code</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe we double check that the wall is still in its undeformed the fractional height of the and its intrinsic coordinate in to be discussed in&lt; A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt; the next example&lt;/A &gt; until ref_value[3] we create the node update information by passing the pointer to the the pointer to the c GeomObject and the reference values to the c AlgebraicNode until end of setup_algebraic_node_update&lt; HR &gt; section driver The driver code Since c oomph lib s various node update procedures use the same changing the node update strategy from the c Domain MacroElement based discussed in the&lt; A HREF=&quot;../../fsi_collapsible_channel/html/index.html&quot;&gt; previous&lt;/A &gt; to the procedure implemented in the c only requires minimal changes to the driver code In the changes are so that both versions are implemented in the same driver code</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00273">fsi_chan_alg.txt:273</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a497b58055d7cdb8f7e0ef32f6d3d167e"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a497b58055d7cdb8f7e0ef32f6d3d167e">Finally</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe we double check that the wall is still in its undeformed the fractional height of the and its intrinsic coordinate in to be discussed in&lt; A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt; the next example&lt;/A &gt; until ref_value[3] Finally</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00255">fsi_chan_alg.txt:255</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_af4beeb649aa44db35b6ca8913e274082"><div class="ttname"><a href="fsi__chan__alg_8txt.html#af4beeb649aa44db35b6ca8913e274082">example</a></div><div class="ttdeci">mainpage Flow in a collapsible channel revisited sparse algebraic node updates In an&lt; A HREF=&quot;../../fsi_collapsible_channel/html/index.html&quot;&gt; earlier example</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00004">fsi_chan_alg.txt:4</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a75f15746e5758321c4131e0c2146346f"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a75f15746e5758321c4131e0c2146346f">coordinates</a></div><div class="ttdeci">its constituent FSI beam elements are sub GeomObjects that are parametrised by their coordinates</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00138">fsi_chan_alg.txt:138</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_aa2e64dadd5785de956c5614f2a2361df"><div class="ttname"><a href="fsi__chan__alg_8txt.html#aa2e64dadd5785de956c5614f2a2361df">were</a></div><div class="ttdeci">mainpage Flow in a collapsible channel revisited sparse algebraic node updates In an&lt; A HREF=&quot;../../fsi_collapsible_channel/html/index.html&quot;&gt; earlier&lt;/A &gt; we demonstrated how the c MacroElement Domain based node update procedure that we originally developed for problems with curvilinear domain boundaries may also be used in fluid structure interaction problems in which the position of the domain boundary has to be determined as part of the solution We demonstrated that the driver code for the coupled multi physics problem was a straightforward combination of the driver codes for the two constituent single physics problems The two key steps required to couple the two single physics codes were</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00013">fsi_chan_alg.txt:13</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_aa43e523967b0dcec342177b1dbb08d1a"><div class="ttname"><a href="fsi__chan__alg_8txt.html#aa43e523967b0dcec342177b1dbb08d1a">GeomObjects</a></div><div class="ttdeci">endcode Here is an illustration of the relation between the various coordinates and c GeomObjects</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00138">fsi_chan_alg.txt:138</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a2dc95730cea9740281d7b3a7a90137df"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a2dc95730cea9740281d7b3a7a90137df">r_compound</a></div><div class="ttdeci">Vector&lt; double &gt; r_compound(2)</div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_ae2974d93e2656a48c371c6aca495ddf4"><div class="ttname"><a href="fsi__chan__alg_8txt.html#ae2974d93e2656a48c371c6aca495ddf4">r_sub</a></div><div class="ttdeci">Vector&lt; double &gt; r_sub(2)</div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a9c643fb0acaa3a34d216629f5f948111"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a9c643fb0acaa3a34d216629f5f948111">side</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe side</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00229">fsi_chan_alg.txt:229</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a0728ecef1ef280a6dcb336cd142dc907"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a0728ecef1ef280a6dcb336cd142dc907">xi</a></div><div class="ttdeci">endcode Here is an illustration of the relation between the various coordinates and c parametrised by the Lagrangian coordinate xi</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00138">fsi_chan_alg.txt:138</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a0a0d4ba6149e87b8c0b0c4e8e33f7e11"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a0a0d4ba6149e87b8c0b0c4e8e33f7e11">wall</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper wall(taking the offset between \f$ x\f$ and \f$ \zeta\f$ into account:The left end of the elastic wall is located at\f$ \zeta=0\f$ and at \f$ x=L_{up} \f$)</div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_abca4540e04f8687cabf04143bf73db5c"><div class="ttname"><a href="fsi__chan__alg_8txt.html#abca4540e04f8687cabf04143bf73db5c">update</a></div><div class="ttdeci">Taylor Hood elements are used if the code is compiled with with the flag c DTAYLOR_HOOD&lt; HR &gt;&lt; HR &gt; section results Results The animations shown below illustrate the interaction between fluid and solid mechanics degrees of freedom in the computations with the algebraic node update Comparison with the corresponding animations for the c Domain MacroElement based shown in the&lt; A HREF=&quot;../../fsi_collapsible_channel/html/index.html#comments&quot;&gt; earlier example&lt;/A &gt; demonstrates the greatly improved sparsity of the node update With the algebraic node update the residuals of the c FSIHermiteBeamElements now only depend on the fluid degrees of freedom in the adjacent fluid elements and on the solid mechanics degree of freedom in the c FSIHermiteBeamElements that affect the nodal position in these fluid elements I w textwidth cr_alg Animation of the Data values that affect the fluid traction that the adjacent fluid elements exert onto the various FSIHermiteBeamElements in the wall mesh(The fluid elements are 2D Crouzeix-Raviart elements.) &quot; Here is the corresponding animation for a discretisation with 2D Taylor-Hood elements. These elements have no internal \c Data but the pressure degrees of freedom are stored at the fluid element's corner nodes the green numbers show the number of the degrees of freedom at the c SolidNodes that are involved that fluid node s node update With the algebraic node update</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00314">fsi_chan_alg.txt:314</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a42ff147ea3ee4393965a831c4768789f"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a42ff147ea3ee4393965a831c4768789f">zeta_</a></div><div class="ttdeci">the c GeomObject therefore acts as its own sub object This is a sensible default as it ensures c f zeta_</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00148">fsi_chan_alg.txt:148</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="annular__domain_8h_source.html#l00034">annular_domain.h:34</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a111a14ecff1fffc597af7c6628b4ea9e"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a111a14ecff1fffc597af7c6628b4ea9e">node</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe we double check that the wall is still in its undeformed the fractional height of the node</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00244">fsi_chan_alg.txt:244</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a80e505bc0da4bc3534da2c6dbf7ae379"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a80e505bc0da4bc3534da2c6dbf7ae379">locate_zeta</a></div><div class="ttdeci">geom_obj_pt locate_zeta(zeta_compound, sub_geom_obj_pt, zeta_sub_obj)</div></div>
<div class="ttc" id="afsi__collapsible__channel_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="fsi__collapsible__channel_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel_8cc_source.html#l00811">fsi_collapsible_channel.cc:811</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_afc49789983100562230d075740cde55a"><div class="ttname"><a href="fsi__chan__alg_8txt.html#afc49789983100562230d075740cde55a">HREF</a></div><div class="ttdeci">&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non-FSI version of the collapsible channel problem,&lt;/A &gt; provides an ideal framework for this, as it allows each node to update its own position, using a node-specific update function. Recall that in the \c AlgebraicMesh - version of the \c CollapsibleChannelMesh, each \c AlgebraicNode stored a pointer to the(single) \c GeomObject that represented the moving curvilinear boundary, and the Lagrangian coordinate of a reference point on this \c GeomObject. The node 's node-update function then placed the node at a fixed vertical fraction on the line connecting the reference point on the &quot;elastic&quot; wall to a second reference point on the fixed lower channel wall. Furthermore, the &quot;wrapped&quot; element, \c AlgebraicElement&lt; FLUID_ELEMENT &gt;, automatically computes the &quot;shape derivatives&quot; by finite-differencing the fluid residuals with respect to the degrees of freedom stored in the \c GeomObject 's geometric \c Data, just as in the case of the \c MacroElement - based node-update procedure. If used in the form discussed in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; earlier example,&lt;/A &gt; this methodology does not(yet!) improve the sparsity of the node update:The geometric \c Data of the &quot;compound&quot; \c GeomObject that represents the wall still contains the positional degrees of freedom of \e all of the mesh 's constituent \c FSIHermiteBeamElements. This is wasteful because the position of a material point on the(discretised) wall depends only on the positional degrees of freedom of the element that this point is located in. The(costly-to-compute) derivatives with respect to all other solid mechanics degree of freedom are zero. We will therefore modify the node-update procedure as follows:Each \c AlgebraicNode stores a pointer to the \c FSIHermiteBeamElement that its reference point is located in. This is possible because \c FSIHermiteBeamElements are derived from the \c FiniteElement class which, in turn, is derived from the \c GeomObject class. In other words, the sub-objects of the compound \c MeshAsGeomObject are \c GeomObjects themselves. Their shape is parametrised by the \c FSIHermiteBeamElement 's local coordinate, \f$ s \f$, which acts as the(sub-)\c GeomObject 's intrinsic coordinate, \f$ \zeta \f$ . Given a pointer to a compound \c GeomObject, \c geom_obj_pt, say, and the intrinsic coordinate \f$ \zeta_{compound} \f$=\c zeta_compound of a point in that \c GeomObject, the function \c GeomObject::locate_zeta(...) may be used to determine a pointer, \c sub_obj_pt, to the sub-object that this point is located in, and the vector of intrinsic coordinates \c zeta_sub_obj of the point in this sub-object. This procedure is illustrated in this code fragment:\code[...] Vector&lt; double &gt; zeta_compound(1) HREF</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00102">fsi_chan_alg.txt:102</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a28366a9775c6f52fb8596c1d643ab794"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a28366a9775c6f52fb8596c1d643ab794">that</a></div><div class="ttdeci">the c GeomObject therefore acts as its own sub object This is a sensible default as it ensures that(\c geom_obj_pt, \f$ \zeta_{compound}\f$) and(\c sub_geom_obj_pt</div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_af1ca369cf5d9c84bb9d78787e09be829"><div class="ttname"><a href="fsi__chan__alg_8txt.html#af1ca369cf5d9c84bb9d78787e09be829">the</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe we double check that the wall is still in its undeformed the fractional height of the and its intrinsic coordinate in the(sub-)\c GeomObject on the upper wall. We also store the intrinsic coordinate of the reference point in the compound \c GeomObject(i.e. the Lagrangian coordinate of the reference point in the continuous beam). This will turn out to be useful in the refineable version of this mesh</div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a73dc4d7a158acc2ebc9f736aafcb28bd"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a73dc4d7a158acc2ebc9f736aafcb28bd">zeta_sub_obj</a></div><div class="ttdeci">Vector&lt; double &gt; zeta_sub_obj(1)</div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_aca079575d0144ef6ba13e8891b9a0c2d"><div class="ttname"><a href="fsi__chan__alg_8txt.html#aca079575d0144ef6ba13e8891b9a0c2d">procedure</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe we double check that the wall is still in its undeformed the fractional height of the and its intrinsic coordinate in to be discussed in&lt; A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt; the next example&lt;/A &gt; until ref_value[3] we create the node update information by passing the pointer to the the pointer to the c GeomObject and the reference values to the c AlgebraicNode until end of setup_algebraic_node_update&lt; HR &gt; section driver The driver code Since c oomph lib s various node update procedures use the same changing the node update strategy from the c Domain MacroElement based procedure</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00268">fsi_chan_alg.txt:268</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a16fef6cd1987967ced451b0496a690bd"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a16fef6cd1987967ced451b0496a690bd">zeta_compound</a></div><div class="ttdeci">zeta_compound[0]</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00103">fsi_chan_alg.txt:103</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a2eb1f6b91aaf3fcc2ea27a0b39ab52fe"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a2eb1f6b91aaf3fcc2ea27a0b39ab52fe">AlgebraicCollapsibleChannelMesh</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe we double check that the wall is still in its undeformed the fractional height of the and its intrinsic coordinate in to be discussed in&lt; A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt; the next example&lt;/A &gt; until ref_value[3] we create the node update information by passing the pointer to the the pointer to the c GeomObject and the reference values to the c AlgebraicNode until end of setup_algebraic_node_update&lt; HR &gt; section driver The driver code Since c oomph lib s various node update procedures use the same changing the node update strategy from the c Domain MacroElement based discussed in the&lt; A HREF=&quot;../../fsi_collapsible_channel/html/index.html&quot;&gt; previous&lt;/A &gt; to the procedure implemented in the c AlgebraicCollapsibleChannelMesh</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00270">fsi_chan_alg.txt:270</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a49a7da910a72a527e23d6b33b01d817b"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a49a7da910a72a527e23d6b33b01d817b">sub_geom_obj_pt</a></div><div class="ttdeci">GeomObject * sub_geom_obj_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00106">fsi_chan_alg.txt:106</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_a5cf48d3c1c120daafec0fad9aeab9fdb"><div class="ttname"><a href="fsi__chan__alg_8txt.html#a5cf48d3c1c120daafec0fad9aeab9fdb">mesh</a></div><div class="ttdeci">The setup of the algebraic node update is very similar to that used in the&lt; A HREF=&quot;../../../navier_stokes/algebraic_collapsible_channel/html/index.html&quot;&gt; non FSI example discussed earlier&lt;/A &gt; The main difference between the two versions of the mesh is that we use the function c the default implementation of this function in the c GeomObject base class ensures that the mesh can be used with compound and non compound c GeomObjects We start by determining the x and y coordinates of the nodes and decide if they are located in the collapsible part of the we determine the intrinsic coordinate of the reference point on the upper and identify the sub c GeomObject within which the reference point is located until locate_zeta Just to be on the safe we double check that the wall is still in its undeformed the fractional height of the and its intrinsic coordinate in to be discussed in&lt; A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt; the next example&lt;/A &gt; until ref_value[3] we create the node update information by passing the pointer to the mesh</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00256">fsi_chan_alg.txt:256</a></div></div>
<div class="ttc" id="afsi__chan__alg_8txt_html_ae2baaba8da8dc30eeaac49ff97506b03"><div class="ttname"><a href="fsi__chan__alg_8txt.html#ae2baaba8da8dc30eeaac49ff97506b03">procedures</a></div><div class="ttdeci">Taylor Hood elements are used if the code is compiled with with the flag c DTAYLOR_HOOD&lt; HR &gt;&lt; HR &gt; section results Results The animations shown below illustrate the interaction between fluid and solid mechanics degrees of freedom in the computations with the algebraic node update Comparison with the corresponding animations for the c Domain MacroElement based procedures</div><div class="ttdef"><b>Definition:</b> <a href="fsi__chan__alg_8txt_source.html#l00304">fsi_chan_alg.txt:304</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Aug 4 2021 20:26:53
        </div>
      </div>
    </footer>
</body>
</html>

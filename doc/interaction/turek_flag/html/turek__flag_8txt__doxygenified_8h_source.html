<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: turek_flag.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">turek_flag.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="turek__flag_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: Turek &amp; Hron&#39;s FSI benchmark problem</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In this example we consider the flow in a 2D channel past a cylinder</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">with an attached elastic &quot;flag&quot;. This is the FSI benchmark problem</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">proposed by Turek &amp; Hron,</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">&quot;Proposal for Numerical Benchmarking of</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">Fluid-Structure Interaction between an Elastic Object and a Laminar</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">Incompressible Flow&quot;, S. Turek &amp; J. Hron, pp. 371-385. In: </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">&quot;Fluid-Structure Interaction&quot; Springer Lecture Notes in </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">Computational Science and Engineering \b 53. Ed. H.-J. Bungartz &amp; </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">M. Schaefer. Springer Verlag 2006.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">The problem combines the two single-physics problems of \n\n</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">- &lt;A href=&quot;../../../navier_stokes/turek_flag_non_fsi/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">  Flow past a cylinder with a &quot;flag&quot; whose motion is prescribed.&lt;/A&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">- &lt;A href=&quot;../../../solid/airy_cantilever/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">  The deformation of a finite-thickness cantilever beam (modelled</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">   as a 2D solid), loaded by surface tractions.&lt;/A&gt; \n\n</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">This is our first example problem that involves the coupling between</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">a fluid and &quot;proper&quot; solid (rather than beam structure) and also</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">includes both fluid and wall inertia. </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">The problem presented here was used as one of the test cases</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">for \c oomph-lib&#39;s FSI preconditioner; see \n\n</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">&lt;A href=&quot;http://www.maths.man.ac.uk/~mheil/oomph_lib_additional_material/HeilHazelBoyleCompMech/HeilHazelBoyleCompMech.pdf&quot;&gt;Heil, M., Hazel, A.L. &amp; Boyle, J. (2008): Solvers for large-displacement fluid-structure interaction problems: Segregated vs. monolithic approaches. Computational Mechanics.&lt;/A&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">\n\n</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">In this tutorial we concentrate on the problem formulation. </span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">The application of the preconditioner is discussed </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt;elsewhere&lt;/a&gt; --</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">the required source code is contained in the</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">&lt;A href=&quot;../../../../demo_drivers/interaction/turek_flag/turek_flag.cc&quot;&gt;driver code.&lt;/A&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\section the_problem The Problem</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">The figure below shows a sketch of the problem: A 2D channel of</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">height \f$ H^*\f$  and length \f$ L^* \f$ conveys fluid of</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">density \f$ \rho_f \f$ and dynamic viscosity \f$ \mu \f$ and contains </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">a cylinder of diameter \f$ d^* \f$, centred at </span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\f$ (X^*_c, Y^*_c) \f$ to which a linearly elastic &quot;flag&quot; of thickness </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">\f$ H^*_{flag}\f$  and length \f$ L^*_{flag} \f$ is attached.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">Steady Poiseuille flow with average velocity \f$ U^* \f$</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">is imposed at the left end of the channel while we assume the </span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">outflow to be parallel and axially traction-free. </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">We model the flag as a linearly elastic Hookean solid with elastic </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">modulus \f$ E^* \f$, density \f$ \rho_s \f$ and Poisson&#39;s ratio \f$ \nu. \f$</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\image html turek_flag_dim.gif &quot;Sketch of the problem in dimensional variables. &quot; </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\image latex turek_flag_dim.eps &quot;Sketch of the problem in dimensional variables. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">We non-dimensionalise all length and coordinates </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">on the diameter of the cylinder, \f$ d^* \f$, the</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">velocities on the mean velocity,  \f$ U^* \f$, and the fluid pressure</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">on the viscous scale. To facilitate comparisons with</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">Turek &amp; Hron&#39;s dimensional benchmark data (particularly for </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">the period of the self-excited oscillations), we use a timescale of </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\f$ T^* = 1 \ \mbox{sec} \f$ to non-dimensionalise time. The </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">fluid flow is then governed by the non-dimensional Navier-Stokes equations</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">Re \left( St \frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">u_j \frac{\partial u_i}{\partial x_j} \right) =</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i}  +</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left[ \left(</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right) \right],</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">where \f$ Re = \rho U^* H_0^* / \mu \f$ and \f$ St = d^* / (U^* T^*) \f$,</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0,</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">subject to parabolic inflow</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">{\bf u} = 6 x_2 (1-x_2) {\bf e}_1</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">at the inflow cross-section; parallel, axially-traction-free outflow</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">at the outlet; and no-slip on the stationary channel walls</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">and the surface of the cylinder, \f$ {\bf u} = {\bf 0} \f$. </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">The no-slip condition on the moving flag is</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">{\bf u} = St \ \frac{\partial {\bf R}_w(\xi_{[top,tip,bottom]},t)}{\partial t}</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">where \f$ \xi_{[top,tip,bottom]} \f$ are Lagrangian coordinates </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">parametrising the three faces of the flag.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">We describe the deformation of the elastic flag by the non-dimensional</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">position vector \f$ {\bf R}(\xi^1, \xi^2, t) \f$ which is determined</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">by the principle of virtual displacements</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\int_{v} \left\{ \sigma^{ij} \ \delta \gamma_{ij} - \left( {\bf f} - </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> \Lambda^2 \frac{\partial^2 {\bf R}}{\partial t^{2}} \right) \cdot </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> \delta {\bf R} \right\} \ dv </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> -\oint_{A_{tract}} {\bf t} \cdot \delta {\bf R} \ dA =0,</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">  \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> \f]</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">where all solid stresses and tractions have been non-dimensionalised on </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">Young&#39;s modulus, \f$ E^* \f$; see the </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">&lt;A href=&quot;../../../solid/solid_theory/html/index.html&quot;&gt;Solid Mechanics</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">Tutorial&lt;/A&gt; for details. The solid mechanics timescale ratio (the ratio of the</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">timescale \f$ T^* \f$ chosen to non-dimensionalise time, to the</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">intrinsic timescale of the solid) can be expressed in terms of</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">the Reynolds and Strouhal numbers, the density ratio, and the</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">FSI interaction parameter as</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">\Lambda^2 = \left( \frac{d^*}{T^*} \sqrt{\frac{\rho_s}{E^*}} \right)^2</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">= St^2 \left( \frac{\rho_s}{\rho_f} \right) Re \ Q.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">Here is a sketch of the non-dimensional version of the problem:</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\image html turek_flag.gif &quot;Sketch of the fluid problem in dimensionless variables, showing the Lagrangian coordinates that parametrise the three faces of the flag. &quot; </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\image latex turek_flag.eps &quot;Sketch of the fluid problem in dimensionless variables, showing the Lagrangian coordinates that parametrise the three faces of the flag. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\section parameters Parameter values for the benchmark problems</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">The (dimensional) parameter values given in Turek &amp; Hron&#39;s benchmark</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">correspond to the following non-dimensional parameters:</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">\subsection geom Geometry</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">- Cylinder diameter \f$ d = 1 \f$</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">- Centre of cylinder \f$ X_c = Y_c = 2 \f$</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">- Channel length \f$ L= 25 \f$</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">- Channel width \f$ H = 4.1 \f$</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">- Thickness of the undeformed flag \f$ H_{flag} = 0.2 \f$</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">- Right end of undeformed flag \f$ x_{tip} = 6 \f$ </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">\subsection nd_params Non-dimensional parameters</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">The three FSI test cases correspond to the following</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">non-dimensional parameters:</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">&lt;TABLE BORDER=1&gt;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">..</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">\f$ Re = U^* d^* \rho_f/\mu \f$</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">\f$ St = d^* /(U^* T^*) \f$</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">\f$ Q = \mu U^* / (E^* d^*) \f$</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">\f$ \rho_s/\rho_f \f$</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">\f$ \Lambda^2 = (d^* /T^* \sqrt{\rho_s/E^*})^2 = </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">St^2 (\rho_s/\rho_f) Re \ Q \f$</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">&lt;B&gt;FSI1&lt;/B&gt;</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">\f$ 20 \f$</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">\f$ 0.5 \f$</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">\f$ 1.429 \times 10^{-6} \f$</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">\f$ 1 \f$</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">\f$ 7.145 \times 10^{-6} \f$</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">&lt;B&gt;FSI2&lt;/B&gt;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">\f$ 100 \f$</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">\f$ 0.1 \f$</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">\f$ 7.143 \times 10^{-6} \f$</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">\f$ 10 \f$</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">\f$ 7.143 \times 10^{-6} \f$</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">&lt;B&gt;FSI3&lt;/B&gt;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">\f$ 200 \f$</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">\f$ 0.05 \f$</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">\f$ 3.571 \times 10^{-6} \f$</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">\f$ 1 \f$</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">&lt;TD ALIGN=&quot;CENTER&quot;&gt;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">\f$ 1.786 \times 10^{-6} \f$</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">The test cases FSI2 and FSI3 are the most interesting because</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">the system develops large-amplitude self-excited oscillations</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">\subsection fsi2_results FSI2</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">Following an initial transient period the system settles into</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">large-amplitude self-excited oscillations during which the</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">oscillating flag generates a regular vortex pattern that is advected</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">along the channel. This is illustrated in the figure below which</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">shows a snapshot of the flow field  (pressure contours and </span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">instantaneous streamlines) at \f$ t=6.04. \f$</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">\image html fsi2_flow605_cropped.gif &quot;Snapshot of the flow field (instantaneous streamlines and pressure contours) &quot; </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">\image latex fsi2_flow605_cropped.eps &quot;Snapshot of the flow field (instantaneous streamlines and pressure contours) &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">The constantly adapted mesh contains and average</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">of 65,000 degrees of freedom. A relatively large timestep</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">of \f$ \Delta t = 0.01 \f$ -- corresponding to about 50 timesteps</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">per period of the oscillation --  was used in this computation. </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">With this discretisation the system settles into oscillations with </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">a period of \f$ \approx 0.52</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">\f$ and an amplitude of the tip-displacement of \f$ 0.01 \pm 0.83. \f$</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">\image html fsi2_trace_cropped.gif &quot;Time trace of the tip displacement. &quot; </span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">\image latex fsi2_trace_cropped.eps &quot;Time trace of the tip displacement. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">\subsection fsi3_results FSI3</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">The figures below shows the corresponding results for the case FSI3</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">in which the fluid and solid densities are equal and the Reynolds number</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">twice as large as in the FSI2 case. The system performs</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">oscillations of much higher frequency and smaller amplitude.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">This is illustrated in the figure below which</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">shows a snapshot of the flow field  (pressure contours and </span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">instantaneous streamlines) at \f$ t=3.615. \f$</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">\image html fsi3_flow724_cropped.gif &quot;Snapshot of the flow field (instantaneous streamlines and pressure contours) &quot; </span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">\image latex fsi3_flow724_cropped.eps &quot;Snapshot of the flow field (instantaneous streamlines and pressure contours) &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">This computation was performed with a timestep of \f$ \Delta t = 0.005</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">\f$ and resulted in oscillations with a period of \f$ \approx 0.19</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">\f$ and an amplitude of the tip-displacement of \f$ 0.01 \pm 0.36. \f$</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">The increase in frequency and Reynolds number leads to the development</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">of thinner boundary and shear layers which require a finer spatial</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">resolution, involving an average of 84,000 degrees of freedom.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">\image html fsi3_trace_cropped.gif &quot;Time trace of the tip displacement. &quot; </span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">\image latex fsi3_trace_cropped.eps &quot;Time trace of the tip displacement. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">\section overview Overview of the driver code</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">Since the driver code is somewhat lengthy we start by providing a brief</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">overview of the main steps in the \c Problem construction:</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">-# We start by discretising the flag with 2D solid elements,</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">   as in the corresponding </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">   &lt;A href=&quot;../../../solid/airy_cantilever/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">   single-physics solid mechanics example.&lt;/A&gt; \n\n</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">-# Next we attach \c FSISolidTractionElements to the </span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">   three solid mesh boundaries that are exposed to the</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">   fluid traction. These elements are used to compute and impose the fluid</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">   traction onto the solid elements, using the flow field</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">   from the adjacent fluid elements. \n\n</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">-# We now combine the three sets of \c FSISolidTractionElements</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">   into three individual (sub-)meshes and convert these to \c GeomObjects, </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">   using the \c MeshAsGeomObject class.  \n\n</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">-# The \c GeomObject representation of the three surface meshes </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">   is then passed to the constructor of the fluid mesh.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">   The &lt;A href=&quot;../../../interaction/fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;algebraic node-update methodology&lt;/a&gt;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">   provided in the \c AlgebraicMesh base class is used to</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">   update its nodal positions in response to the motion of its </span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">   bounding \c GeomObjects. \n\n</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">-# Finally, we use the helper function</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">   \c FSI_functions::setup_fluid_load_info_for_solid_elements(...)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">   to set up the fluid-structure interaction -- this function</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">   determines which fluid elements are adjacent to the Gauss points</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">   in the  \c FSISolidTractionElements that apply the fluid traction</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">   to the solid. \n\n</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">-# Done! \n\n</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">\section parameters The global parameters</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">As usual, We use a namespace to define the (many) global parameters,</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">using default assignments for the FSI1 test case.</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">\dontinclude turek_flag.cc</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">\skipline start_of_global_parameters</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">\until double Nu=0.4; </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">We also include a gravitational body force for the solid. (This</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">is only used for the solid mechanics test cases, CSM1 and CSM2,</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">which will not be discussed here.)</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">The domain geometry and flow field are fairly complex and it</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">is difficult to construct a good initial guess for the Newton</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">iteration. To ensure its convergence at the beginning of the simulation</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">we therefore employ the method suggested by Turek &amp; Hron: We start the flow </span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">from rest and ramp up the inflow profile from zero to its maximum value.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">The parameters for the time-dependent increase in the influx</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">are defined here:</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">\until  end of specification of ramped influx</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">Finally, we provide a helper function that assigns the</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">parameters for the various test cases, depending on their</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">ID (&quot;FSI1&quot;, &quot;FSI2&quot;, &quot;FSI3&quot;, &quot;CSM1&quot; or &quot;CSM2&quot;). Here is the assignment </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">for the case FSI1:</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">In the interest of brevity we omit the listings of the assignments </span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">for the other cases. Finally, we select the length of the time interval</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">over which the influx is ramped up from zero to its maximum value</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">to be equal to 20 timesteps, create a constitutive equation for</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">the solid, and document the parameter values used in the simulation:</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">\skipline Ramp period</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">\until // end_of_namespace</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">\section driver The driver code</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">The driver code has the usual structure, though in this case</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">we use the command line arguments to indicate which case</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">(FSI1, FSI2, FSI3, CSM1 or CSM2) to run. The absence of</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">a command line argument is interpreted as the code being</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">run as part of \c oomph-lib&#39;s self-test procedure in which case</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">we perform a computation with the parameter values for case FSI1</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">and perform only a few timesteps.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">\until Running case</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">We set up the global parameter values, create a \c DocInfo</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">object and trace file to record the output, and build the problem.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">\until problem(length, height);</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">Next, we choose the number of timesteps (using a smaller</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">number for a validation run, and for the case FSI1 in which the system rapidly</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">approaches a steady state) and</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">initialise the time-stepping for an impulsive</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">start from the zero flow solution.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">\until assign_initial_values_impulsive</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">Finally, we document the initial condition and start the</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">time-stepping procedure, setting the \c first flag to \c false</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">because we have not specified an analytical expression for the</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">initial conditions that could be re-assigned after the</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">mesh adaptation when computing the first timestep.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">\section problem The Problem class</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">The \c Problem class contains the usual member functions, such as </span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">access functions to the various meshes. Because the nodal positions</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">are updated by an algebraic node-update procedure, the function </span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">\c actions_before_newton_convergence_check() is employed to</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">update the nodal positions in response to changes in the (solid)</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">variables during the Newton iteration.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">The function \c actions_before_implicit_timestep() is used to</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">adjust the influx during the start-up period.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">\dontinclude turek_flag.cc</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">\until end_of_problem_class</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">\section constructor The problem constructor</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">We start by building the solid mesh, using an initial discretisation</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">with 20 x 2 elements in the x- and y-directions. (The length of</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">the flag is determined such that it emanates from its intersection</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">with the cylinder and ends at x=6; The \c origin vector shifts the</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">&quot;lower left&quot; vertex of the solid mesh so that its centreline</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">is aligned with the cylinder.)</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">\until n_x,n_y,l_x,l_y,origin,flag_time_stepper_pt);</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">We create an error estimator for the solid mesh and identify a control</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">node at the tip of the flag to track its motion.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">\until  Solid_control_node_pt-&gt;x(1) &lt;&lt; </span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">Finally, we perform one uniform mesh refinement and disable</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">any further mesh adaptation.</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">\until disable_adaptation()</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">Next, we attach \c  FSISolidTractionElements to the boundaries </span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">of the solid mesh that are exposed to the fluid. </span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">We complete their build by specifying which boundary </span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">of the bulk mesh they are attached to, as this information</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">is required when setting up the fluid-structure interaction;</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">see \ref com_ex.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">\until // build of FSISolidTractionElements is complete</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">Finally, we create \c GeomObject representations of the three</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">surface meshes of \c FSISolidTractionElements. We will use these to </span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">represent the curvilinear, moving boundaries of the fluid mesh.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">\until (Traction_mesh_pt[2]);</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">The final mesh to be built is the fluid mesh whose constructor</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">requires pointers to the four \c GeomObjects that represent the</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">cylinder and three fluid-loaded faces of the flag, respectively.</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">We represent the cylinder by a \c Circle object:</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">\until Global_Parameters::Radius);</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">We build the mesh and identify a control node (a node</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">at the upstream face of the cylinder), before creating an error </span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">estimator and performing one uniform mesh refinement.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">\until  Fluid_mesh_pt-&gt;refine_uniformly();</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">We now add the various meshes to the \c Problem&#39;s collection</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">of sub-meshes and combine them to a global mesh</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">\until build_global_mesh();</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">The application of boundary conditions for the solid are</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">straightforward: All displacements of the flag&#39;s left end</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">(mesh boundary 3) are suppressed; the other faces are free. Strictly speaking,</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">the pinning of the redundant solid pressure nodes is superfluous</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">since the \c RefineableQPVDElement used for the discretisation of the</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">flag employ a displacement-based</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">formulation, but it is good practise to perform this step anyway</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">to &quot;future-proof&quot; the code for the use of other element types.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">\until solid_mesh_pt()-&gt;element_pt());</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">The fluid has Dirichlet boundary conditions (prescribed velocity)</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">everywhere apart from the outflow where only the horizontal</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">velocity is unknown. </span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">\until pin_redundant_nodal_pressures(fluid_mesh_pt()-&gt;element_pt());</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"> We impose a parabolic inflow profile with the current value of</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">the influx at the inlet (fluid mesh boundary 3).</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">We complete the build of the solid elements by passing them the</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">pointer to the constitutive equation, the gravity vector and</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">the timescale ratio:</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">The fluid elements require pointers to the Reynolds and Womersley</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">(product of Reynolds and Strouhal) numbers:</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">Setting up the fluid-structure interaction is done from &quot;both&quot; sides&quot;</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">of the fluid-solid interface: First we ensure that the no-slip</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">condition is automatically applied to all fluid nodes that are </span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">located on the three faces of the flag (mesh boundaries 5, 6 and 7).</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">This is done by passing the function pointer to the  </span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">\c FSI_functions::apply_no_slip_on_moving_wall() function</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">to the relevant fluid nodes (&lt;A href=&quot;../../../navier_stokes/osc_ellipse/html/index.html&quot;&gt;recall&lt;/A&gt;</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">that the auxiliary node update</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">functions are automatically executed whenever the position of a node </span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">is updated by the algebraic node update).</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">Since the no-slip condition (1) involves the Strouhal number</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">(which, in the current problem, is not equal to the default value of</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">\c FSI_functions::Strouhal_for_no_slip=1.0), we overwrite</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">the default assignment with the actual Strouhal number in the problem.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">\until // done automatic application of no-slip</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">Next, we set up the lookup schemes required by the</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">\c FSISolidTractionElements to establish which fluid</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">elements affect the traction onto the solid:</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">All interactions have now been specified and we conclude by</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">assigning the equation numbers</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">\skipline // Assign equation numbers</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">\until //end_of_constructor</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">\section set_traction Create traction elements</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">This is a helper function that attaches \c FSISolidTractionElement</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">to the solid elements that are exposed to the fluid traction.</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">We store the elements in three distinct sub-meshes -- one for</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">each face. (Yet another mesh, pointed to by \c</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">Combined_traction_mesh_pt, is created for post-processing </span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">purposes.)</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">\skipline start_of_create_traction_elements</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">\until  // end of create_traction_elements</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">\section check Actions before Newton convergence check</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">The algebraic node-update procedure updates the positions</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">in response to changes in the solid displacements but this</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">is not done automatically when the Newton solver updates</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">the solid mechanics degrees of freedom. We therefore</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">force a node-update before the Newton convergence check.</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">\dontinclude turek_flag.cc</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">\skipline start_of_actions_before_newton_convergence_check</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">\section timestep Actions before the timestep</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">Before each timestep we update the inflow profile for all fluid nodes</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">on mesh boundary 3.</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">\skipline start_of_actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">\until end_of_actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">\section after_adapt Actions after adapt</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">After each adaptation, we unpin and re-pin all redundant</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">pressures degrees of freedom. This is necessary because their</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">&quot;redundant-ness&quot; may have been altered by changes in the refinement </span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">pattern; see</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">&lt;A href=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">another tutorial&lt;/A&gt; for details. We ensure the automatic application of the</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">no-slip condition on fluid nodes that are located on the</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">faces of the flag, and re-setup the FSI lookup scheme</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">that tells \c FSISolidTractionElements which fluid elements</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">are located next to their Gauss points.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">\skipline actions_after_adapt</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">\until end of actions_after_adapt</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">\section doc Post-processing</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">The function \c doc_solution(...) produces the output</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">for the fluid, solid and traction meshes and writes</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">selected data to the trace file.</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">\skipline start_of_doc_solution</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">\until end_of_doc_solution</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">\section com_ex Further comments and exercises</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">- When completing the build of the \c FSISolidTractionElements</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">  (the elements that apply the fluid traction to the </span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">  solid elements that are exposed to the fluid) we specified the </span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">  number of the solid mesh boundary they are located on, using</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">  elem_pt-&gt;set_boundary_number_in_bulk_mesh(bound);</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">  \endcode</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">  This information is required when setting up the fluid-structure</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">  interaction because the \c MeshAsGeomObject representation of the</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">  mesh of \c FSISolidTractionElements is parametrised by the </span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">  boundary coordinate in the solid mesh. Explore the details of</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">  the implementation by commenting out the relevant line of </span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">  code and use the debugger to find out how and where the code</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">  fails. \b Note: Since this step is somewhat subtle and therefore</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">  easily forgotten, the  \c FSISolidTractionElements issue</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">  an explicit warning if the bulk boundary number has not been set --</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">  but only if the the library is compiled in PARANOID mode.</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">- When comparing our results against those in Turek &amp; Hron&#39;s</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">  benchmark, we only focused on the period and amplitude of the</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">  fully-developed self-excited oscillations. The benchmark data also </span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">  provides data on the time-dependent variations of the drag and lift</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">  coefficients. Design suitable \c FaceElements (to be attached</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">  to the faces of the Navier-Stokes elements that are adjacent</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">  to the flag or the cylinder) to compute these quantities.</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">  The </span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">  &lt;a href=&quot;../../../the_data_structure/html/classoomph_1_1NavierStokesSurfacePowerElement.html&quot;&gt;</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">  &lt;code&gt;NavierStokesSurfacePowerElements&lt;/code&gt;&lt;/a&gt;</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">  should provide a good basis for these.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">\section ackn Acknowledgements</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">- This code was originally developed by </span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">  Stefan Kollmannsberger and his students Iason Papaioannou and  </span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">  Orkun Oezkan Doenmez. It was completed by Floraine Cordier.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">&lt;A href=&quot;../../../../demo_drivers/interaction/turek_flag/&quot;&gt;</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">demo_drivers/interaction/turek_flag/</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">&lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">&lt;A href=&quot;../../../../demo_drivers/interaction/turek_flag/turek_flag.cc&quot;&gt;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">demo_drivers/interaction/turek_flag/turek_flag.cc</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aturek__flag_8txt_html_acdd098bc82b9d35854b3a4959e4291f9"><div class="ttname"><a href="turek__flag_8txt.html#acdd098bc82b9d35854b3a4959e4291f9">solid_mesh_pt</a></div><div class="ttdeci">the other faces are free Strictly the pinning of the redundant solid pressure nodes is superfluous since the c RefineableQPVDElement used for the discretisation of the flag employ a displacement based but it is good practise to perform this step anyway to future proof the code for the use of other element types until solid_mesh_pt() -&gt; element_pt())</div></div>
<div class="ttc" id="aturek__flag_8txt_html_a707bb6a8631b727d6729c895a1be6ba5"><div class="ttname"><a href="turek__flag_8txt.html#a707bb6a8631b727d6729c895a1be6ba5">formulation</a></div><div class="ttdeci">the other faces are free Strictly the pinning of the redundant solid pressure nodes is superfluous since the c RefineableQPVDElement used for the discretisation of the flag employ a displacement based formulation</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00496">turek_flag.txt:496</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_ad88db755434ec936650d1c02021f682d"><div class="ttname"><a href="turek__flag_8txt.html#ad88db755434ec936650d1c02021f682d">In</a></div><div class="ttdeci">mainpage Demo&lt; CENTER &gt; Proposal for Numerical Benchmarking of Fluid Structure Interaction between an Elastic Object and a Laminar Incompressible S Turek &amp;J pp In</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00021">turek_flag.txt:21</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_abe136565f9a9a75ef3a0b95f7d5aa38c"><div class="ttname"><a href="turek__flag_8txt.html#abe136565f9a9a75ef3a0b95f7d5aa38c">origin</a></div><div class="ttdeci">The c origin vector shifts the lower left vertex of the solid mesh so that its centreline is aligned with the cylinder skipline start_of_constructor until origin</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00445">turek_flag.txt:445</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a2e9c8e9cbfb2b10635929d81ea38a6b5"><div class="ttname"><a href="turek__flag_8txt.html#a2e9c8e9cbfb2b10635929d81ea38a6b5">conditions</a></div><div class="ttdeci">The fluid has Dirichlet boundary conditions(prescribed velocity) everywhere apart from the outflow where only the horizontal velocity is unknown. \until pin_redundant_nodal_pressures(fluid_mesh_pt() -&gt; element_pt())</div></div>
<div class="ttc" id="aturek__flag_8txt_html_ad3931fbf34037096bdb4ab6e3b4609f9"><div class="ttname"><a href="turek__flag_8txt.html#ad3931fbf34037096bdb4ab6e3b4609f9">timesteps</a></div><div class="ttdeci">We also include a gravitational body force for the solid(This is only used for the solid mechanics test cases, CSM1 and CSM2, which will not be discussed here.) \until } The domain geometry and flow field are fairly complex and it is difficult to const ruct a good initial guess for the Newton iteration. To ensure its convergence at the beginning of the simulation we therefore employ the method suggested by Turek &amp;Hron we choose the number of timesteps(using a smaller number for a validation run, and for the case FSI1 in which the system rapidly approaches a steady state) and initialise the time-stepping for an impulsive start from the zero flow solution. \until assign_initial_values_impulsive Finally</div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_af1af40a0df651e86bc1be273fafa98da"><div class="ttname"><a href="namespaceGlobal__Parameters.html#af1af40a0df651e86bc1be273fafa98da">Global_Parameters::St</a></div><div class="ttdeci">double St</div><div class="ttdoc">Strouhal number (default assignment for FSI1 test case)</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8cc_source.html#l00061">turek_flag.cc:61</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_ac0b8807ec5508753b05bd5259716c84c"><div class="ttname"><a href="turek__flag_8txt.html#ac0b8807ec5508753b05bd5259716c84c">inlet</a></div><div class="ttdeci">We impose a parabolic inflow profile with the current value of the influx at the inlet(fluid mesh boundary 3). \until } We complete the build of the solid elements by passing them the pointer to the const itutive equation</div></div>
<div class="ttc" id="aturek__flag_8txt_html_a0c27ffb758561db31897a5a358d8e2ed"><div class="ttname"><a href="turek__flag_8txt.html#a0c27ffb758561db31897a5a358d8e2ed">elements</a></div><div class="ttdeci">f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f degrees of freedom A relatively large timestep of f Delta involving an average degrees of freedom I w textwidth fsi3_trace_cropped Time trace of the tip displacement&lt; HR &gt;&lt; HR &gt; section overview Overview of the driver code Since the driver code is somewhat lengthy we start by providing a brief overview of the main steps in the c Problem as in the corresponding&lt; A href=&quot;../../../solid/airy_cantilever/html/index.html&quot;&gt; single physics solid mechanics example&lt;/A &gt; n n three solid mesh boundaries that are exposed to the fluid traction These elements are used to compute and impose the fluid traction onto the solid elements</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00311">turek_flag.txt:311</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a2732b6c9ab551852cafd9ab8b4625b5e"><div class="ttname"><a href="turek__flag_8txt.html#a2732b6c9ab551852cafd9ab8b4625b5e">section</a></div><div class="ttdeci">f and length f L density f rho_s f and Poisson s ratio f nu f I w textwidth turek_flag_dim Sketch of the problem in dimensional variables We non dimensionalise all length and coordinates on the diameter of the f d the velocities on the mean f U and the fluid pressure on the viscous scale To facilitate comparisons with Turek &amp;Hron s dimensional benchmark we use a timescale of f T and&lt; CENTER &gt; f[\frac{\partial u_i}{\partial x_i}=0,\f]&lt;/CENTER &gt; subject to parabolic inflow&lt; CENTER &gt; f[{\bf u}=6 x_2(1-x_2) {\bf e}_1\f]&lt;/CENTER &gt; at the inflow cross section</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00068">turek_flag.txt:68</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ab360628e7830e43e355ce5768f6d6a6c"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ab360628e7830e43e355ce5768f6d6a6c">Global_Parameters::H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Height of flag.</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8cc_source.html#l00075">turek_flag.cc:75</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_ad98d16bb30a4047b469d4cc0d612cf4f"><div class="ttname"><a href="turek__flag_8txt.html#ad98d16bb30a4047b469d4cc0d612cf4f">Hron</a></div><div class="ttdeci">mainpage Demo&lt; CENTER &gt; Proposal for Numerical Benchmarking of Fluid Structure Interaction between an Elastic Object and a Laminar Incompressible S Turek &amp;J Hron</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00009">turek_flag.txt:9</a></div></div>
<div class="ttc" id="aturek__flag_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="turek__flag_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdoc">Driver.</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8cc_source.html#l01080">turek_flag.cc:1080</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a7ecee877e110d34c4de5131471cda53c"><div class="ttname"><a href="turek__flag_8txt.html#a7ecee877e110d34c4de5131471cda53c">solid</a></div><div class="ttdeci">mainpage Demo&lt; CENTER &gt; Proposal for Numerical Benchmarking of Fluid Structure Interaction between an Elastic Object and a Laminar Incompressible S Turek &amp;J pp loaded by surface tractions&lt;/A &gt; n n This is our first example problem that involves the coupling between a fluid and proper solid(rather than beam structure) and also includes both fluid and wall inertia. The problem presented here was used as one of the test cases for \c oomph-lib 's FSI preconditioner</div></div>
<div class="ttc" id="aturek__flag_8txt_html_adfa699c1fb198b4d5003250cd5ca3a33"><div class="ttname"><a href="turek__flag_8txt.html#adfa699c1fb198b4d5003250cd5ca3a33">parallel</a></div><div class="ttdeci">parallel</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00091">turek_flag.txt:91</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a1c8f2451d835b5ae77c101d4d3652d34"><div class="ttname"><a href="turek__flag_8txt.html#a1c8f2451d835b5ae77c101d4d3652d34">until</a></div><div class="ttdeci">see ref com_ex until we create c GeomObject representations of the three surface meshes of c FSISolidTractionElements We will use these to represent the moving boundaries of the fluid mesh until(Traction_mesh_pt[2])</div></div>
<div class="ttc" id="aturek__flag_8txt_html_a3d1b11b99f70a7e88e40b3d897bb47f0"><div class="ttname"><a href="turek__flag_8txt.html#a3d1b11b99f70a7e88e40b3d897bb47f0">times</a></div><div class="ttdeci">f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f times</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00193">turek_flag.txt:193</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a52da077d2f7f550f198cf26338502ee9"><div class="ttname"><a href="turek__flag_8txt.html#a52da077d2f7f550f198cf26338502ee9">href</a></div><div class="ttdeci">&quot;../../../interaction/fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;algebraic node-update methodology&lt;/a &gt; provided in the \c AlgebraicMesh base class is used to update its nodal positions in response to the motion of its bounding \c GeomObjects. \n\n -# Finally, we use the helper function \c FSI_functions::setup_fluid_load_info_for_solid_elements(...) to set up the fluid-structure interaction -- this function determines which fluid elements are adjacent to the Gauss points in the \c FSISolidTractionElements that apply the fluid traction to the solid. \n\n -# Done! \n\n .&lt; HR &gt;&lt; HR &gt; \section parameters The global parameters As usual, We use a namespace to define the(many) global parameters, using default assignments for the FSI1 test case. \dontinclude turek_flag.cc \skipline start_of_global_parameters \until double Nu=0.4 href</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00341">turek_flag.txt:341</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a363c10b7cb4b242fe881d6bedb6edec3"><div class="ttname"><a href="turek__flag_8txt.html#a363c10b7cb4b242fe881d6bedb6edec3">construction</a></div><div class="ttdeci">f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f degrees of freedom A relatively large timestep of f Delta involving an average degrees of freedom I w textwidth fsi3_trace_cropped Time trace of the tip displacement&lt; HR &gt;&lt; HR &gt; section overview Overview of the driver code Since the driver code is somewhat lengthy we start by providing a brief overview of the main steps in the c Problem construction</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00304">turek_flag.txt:304</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a3fd90421f7eb5253fa80b9673f1bd908"><div class="ttname"><a href="turek__flag_8txt.html#a3fd90421f7eb5253fa80b9673f1bd908">node</a></div><div class="ttdeci">We build the mesh and identify a control node(a node at the upstream face of the cylinder)</div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a7814fddf663e56168174a42d2cd6b4c1"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a></div><div class="ttdeci">double Q</div><div class="ttdoc">FSI parameter (default assignment for FSI1 test case)</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8cc_source.html#l00068">turek_flag.cc:68</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a290a2b85e23ed04b3dc4dfd848fad805"><div class="ttname"><a href="turek__flag_8txt.html#a290a2b85e23ed04b3dc4dfd848fad805">The</a></div><div class="ttdeci">see the&lt; A href=&quot;../../../solid/solid_theory/html/index.html&quot;&gt; Solid Mechanics Tutorial&lt;/A &gt; for details The solid mechanics timescale the density and the FSI interaction parameter as f[\Lambda^2=\left(\frac{d^ *}{T^ *} \sqrt{\frac{\rho_s}{E^ *}} \right)^2=St^2 \left(\frac{\rho_s}{\rho_f} \right) Re \ Q.\f] Here is a sketch of the non dimensional version of the showing the Lagrangian coordinates that parametrise the three faces of the flag&lt; HR &gt;&lt; HR &gt; section parameters Parameter values for the benchmark problems The(dimensional) parameter values given in Turek &amp;Hron 's benchmark correspond to the following non-dimensional parameters</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00137">turek_flag.txt:137</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a8ca531cc02b78238f62a21328719e48b"><div class="ttname"><a href="turek__flag_8txt.html#a8ca531cc02b78238f62a21328719e48b">procedure</a></div><div class="ttdeci">We also include a gravitational body force for the solid(This is only used for the solid mechanics test cases, CSM1 and CSM2, which will not be discussed here.) \until } The domain geometry and flow field are fairly complex and it is difficult to const ruct a good initial guess for the Newton iteration. To ensure its convergence at the beginning of the simulation we therefore employ the method suggested by Turek &amp;Hron we choose the number of we document the initial condition and start the time stepping procedure</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00405">turek_flag.txt:405</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a838b1a75bbaf13e686d961357717334e"><div class="ttname"><a href="turek__flag_8txt.html#a838b1a75bbaf13e686d961357717334e">flag_time_stepper_pt</a></div><div class="ttdeci">The c origin vector shifts the lower left vertex of the solid mesh so that its centreline is aligned with the cylinder skipline start_of_constructor until flag_time_stepper_pt</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00445">turek_flag.txt:445</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_aa3dfbdb1b2fd80d516850f66c96b6fd0"><div class="ttname"><a href="namespaceGlobal__Parameters.html#aa3dfbdb1b2fd80d516850f66c96b6fd0">Global_Parameters::E</a></div><div class="ttdeci">double E</div><div class="ttdoc">Elastic modulus.</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8cc_source.html#l00100">turek_flag.cc:100</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a42b0ea4b646fa7f5b71e67fc676333fe"><div class="ttname"><a href="turek__flag_8txt.html#a42b0ea4b646fa7f5b71e67fc676333fe">flag</a></div><div class="ttdeci">The final mesh to be built is the fluid mesh whose constructor requires pointers to the four c GeomObjects that represent the cylinder and three fluid loaded faces of the flag</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00474">turek_flag.txt:474</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_aad723a985e08e8bbfd526a76068f3fdf"><div class="ttname"><a href="turek__flag_8txt.html#aad723a985e08e8bbfd526a76068f3fdf">cylinder</a></div><div class="ttdeci">f and length f L density f rho_s f and Poisson s ratio f nu f I w textwidth turek_flag_dim Sketch of the problem in dimensional variables We non dimensionalise all length and coordinates on the diameter of the cylinder</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00063">turek_flag.txt:63</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a50919a2168306f8c3babbce4f46488ed"><div class="ttname"><a href="turek__flag_8txt.html#a50919a2168306f8c3babbce4f46488ed">object</a></div><div class="ttdeci">The final mesh to be built is the fluid mesh whose constructor requires pointers to the four c GeomObjects that represent the cylinder and three fluid loaded faces of the respectively We represent the cylinder by a c Circle object</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00477">turek_flag.txt:477</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a85c8ecbce8c645ada021a94495125fc2"><div class="ttname"><a href="turek__flag_8txt.html#a85c8ecbce8c645ada021a94495125fc2">ratio</a></div><div class="ttdeci">see the&lt; A href=&quot;../../../solid/solid_theory/html/index.html&quot;&gt; Solid Mechanics Tutorial&lt;/A &gt; for details The solid mechanics timescale the density ratio</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00120">turek_flag.txt:120</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a3e655f3477ba01c404fe8257d4d9d0bc"><div class="ttname"><a href="turek__flag_8txt.html#a3e655f3477ba01c404fe8257d4d9d0bc">doc_solution</a></div><div class="ttdeci">see&lt; A href=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details We ensure the automatic application of the no slip condition on fluid nodes that are located on the faces of the and re setup the FSI lookup scheme that tells c FSISolidTractionElements which fluid elements are located next to their Gauss points skipline actions_after_adapt until end of actions_after_adapt&lt; HR &gt;&lt; HR &gt; section doc Post processing The function c doc_solution(...) produces the output for the fluid</div></div>
<div class="ttc" id="aturek__flag_8txt_html_ab464d4166f1327609dd03bfa58290aec"><div class="ttname"><a href="turek__flag_8txt.html#ab464d4166f1327609dd03bfa58290aec">f</a></div><div class="ttdeci">f and length f L density f rho_s f and Poisson s ratio f nu f I w textwidth turek_flag_dim Sketch of the problem in dimensional variables We non dimensionalise all length and coordinates on the diameter of the f d * f</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00063">turek_flag.txt:63</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a8c2814c18eaefbc2bf343a34842af0cb"><div class="ttname"><a href="turek__flag_8txt.html#a8c2814c18eaefbc2bf343a34842af0cb">speaking</a></div><div class="ttdeci">the other faces are free Strictly speaking</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00492">turek_flag.txt:492</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a03279b742e5ee23f6d9f87572c38061e"><div class="ttname"><a href="turek__flag_8txt.html#a03279b742e5ee23f6d9f87572c38061e">interaction</a></div><div class="ttdeci">We create an error estimator for the solid mesh and identify a control node at the tip of the flag to track its motion until Solid_control_node_pt we perform one uniform mesh refinement and disable any further mesh adaptation until we attach c FSISolidTractionElements to the boundaries of the solid mesh that are exposed to the fluid We complete their build by specifying which boundary of the bulk mesh they are attached as this information is required when setting up the fluid structure interaction</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00461">turek_flag.txt:461</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a85a69cc532853b0453e0269031f79916"><div class="ttname"><a href="turek__flag_8txt.html#a85a69cc532853b0453e0269031f79916">actions_before_newton_convergence_check</a></div><div class="ttdeci">We also include a gravitational body force for the solid(This is only used for the solid mechanics test cases, CSM1 and CSM2, which will not be discussed here.) \until } The domain geometry and flow field are fairly complex and it is difficult to const ruct a good initial guess for the Newton iteration. To ensure its convergence at the beginning of the simulation we therefore employ the method suggested by Turek &amp;Hron we choose the number of we document the initial condition and start the time stepping setting the c first flag to c false because we have not specified an analytical expression for the initial conditions that could be re assigned after the mesh adaptation when computing the first timestep until end of main&lt; HR &gt;&lt; HR &gt; section problem The Problem class The c Problem class contains the usual member functions such as access functions to the various meshes Because the nodal positions are updated by an algebraic node update procedure the function c actions_before_newton_convergence_check() is employed to update the nodal positions in response to changes in the(solid) variables during the Newton iteration. The function \c actions_before_implicit_timestep() is used to adjust the influx during the start-up period. \dontinclude turek_flag.cc \skipline start_of_problem_class \until end_of_problem_class&lt; HR &gt;&lt; HR &gt; \section const ructor The problem const ructor We start by building the solid mesh</div></div>
<div class="ttc" id="aturek__flag_8txt_html_a21c82020934af5cae73962f591e2cb17"><div class="ttname"><a href="turek__flag_8txt.html#a21c82020934af5cae73962f591e2cb17">Finally</a></div><div class="ttdeci">see ref com_ex until Finally</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00466">turek_flag.txt:466</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a877c50f1fc4614564e6d0fa5420b7f5f"><div class="ttname"><a href="turek__flag_8txt.html#a877c50f1fc4614564e6d0fa5420b7f5f">Note</a></div><div class="ttdeci">endcode n This information is required when setting up the fluid structure interaction because the c MeshAsGeomObject representation of the mesh of c FSISolidTractionElements is parametrised by the boundary coordinate in the solid mesh Explore the details of the implementation by commenting out the relevant line of code and use the debugger to find out how and where the code fails b Note</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00653">turek_flag.txt:653</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a1f925d9ecbf558b273ec8b9f4fce2913"><div class="ttname"><a href="turek__flag_8txt.html#a1f925d9ecbf558b273ec8b9f4fce2913">x</a></div><div class="ttdeci">6 x</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00440">turek_flag.txt:440</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a30dbfe80a1da9c57dc1989f42ca2a3a1"><div class="ttname"><a href="turek__flag_8txt.html#a30dbfe80a1da9c57dc1989f42ca2a3a1">l_x</a></div><div class="ttdeci">The c origin vector shifts the lower left vertex of the solid mesh so that its centreline is aligned with the cylinder skipline start_of_constructor until l_x</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00445">turek_flag.txt:445</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a200109847bf4cc26da4d00e8d68d569e"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a200109847bf4cc26da4d00e8d68d569e">Global_Parameters::gravity</a></div><div class="ttdeci">void gravity(const double &amp;time, const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;b)</div><div class="ttdoc">Non-dimensional gravity as body force.</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8cc_source.html#l00109">turek_flag.cc:109</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_ab5a60b1de123a99846307cf3f4186828"><div class="ttname"><a href="turek__flag_8txt.html#ab5a60b1de123a99846307cf3f4186828">n_x</a></div><div class="ttdeci">The c origin vector shifts the lower left vertex of the solid mesh so that its centreline is aligned with the cylinder skipline start_of_constructor until n_x</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00445">turek_flag.txt:445</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a003657f3746d48ea9d13cdd6c7ac0db8"><div class="ttname"><a href="turek__flag_8txt.html#a003657f3746d48ea9d13cdd6c7ac0db8">data</a></div><div class="ttdeci">f and length f L density f rho_s f and Poisson s ratio f nu f I w textwidth turek_flag_dim Sketch of the problem in dimensional variables We non dimensionalise all length and coordinates on the diameter of the f d the velocities on the mean f U and the fluid pressure on the viscous scale To facilitate comparisons with Turek &amp;Hron s dimensional benchmark data(particularly for the period of the self-excited oscillations)</div></div>
<div class="ttc" id="aturek__flag_8txt_html_a071fd776ea385c462c363c9a3907169f"><div class="ttname"><a href="turek__flag_8txt.html#a071fd776ea385c462c363c9a3907169f">to</a></div><div class="ttdeci">We create an error estimator for the solid mesh and identify a control node at the tip of the flag to track its motion until Solid_control_node_pt we perform one uniform mesh refinement and disable any further mesh adaptation until we attach c FSISolidTractionElements to the boundaries of the solid mesh that are exposed to the fluid We complete their build by specifying which boundary of the bulk mesh they are attached to</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00460">turek_flag.txt:460</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_aa8fd477505e7a7face8194506141b6d7"><div class="ttname"><a href="turek__flag_8txt.html#aa8fd477505e7a7face8194506141b6d7">FSISolidTractionElements</a></div><div class="ttdeci">see&lt; A href=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details We ensure the automatic application of the no slip condition on fluid nodes that are located on the faces of the and re setup the FSI lookup scheme that tells c FSISolidTractionElements which fluid elements are located next to their Gauss points skipline actions_after_adapt until end of actions_after_adapt&lt; HR &gt;&lt; HR &gt; section doc Post processing The function c solid and traction meshes and writes selected data to the trace file skipline start_of_doc_solution until end_of_doc_solution&lt; HR &gt;&lt; HR &gt; section com_ex Further comments and exercises When completing the build of the c FSISolidTractionElements(the elements that apply the fluid traction to the solid elements that are exposed to the fluid) we specified the number of the solid mesh boundary they are located on</div></div>
<div class="ttc" id="aturek__flag_8txt_html_a8862c1c10f896d09569de1c3c2454432"><div class="ttname"><a href="turek__flag_8txt.html#a8862c1c10f896d09569de1c3c2454432">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00005">turek_flag.txt:5</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a0a36f08520ac390a30a3a6f94c337338"><div class="ttname"><a href="turek__flag_8txt.html#a0a36f08520ac390a30a3a6f94c337338">velocity</a></div><div class="ttdeci">f and length f L density f rho_s f and Poisson s ratio f nu f I w textwidth turek_flag_dim Sketch of the problem in dimensional variables We non dimensionalise all length and coordinates on the diameter of the f d the velocities on the mean velocity</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00064">turek_flag.txt:64</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a0e13eaa7c5f7694e71118ba0687a09ec"><div class="ttname"><a href="turek__flag_8txt.html#a0e13eaa7c5f7694e71118ba0687a09ec">t</a></div><div class="ttdeci">f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f degrees of freedom A relatively large timestep of f Delta t</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00263">turek_flag.txt:263</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a20fccdcfa2c15ad8b951b9ada3bb1661"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Poisson's ratio.</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8cc_source.html#l00103">turek_flag.cc:103</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_ae63090a397f60c30c9ca5e91af57f6b6"><div class="ttname"><a href="turek__flag_8txt.html#ae63090a397f60c30c9ca5e91af57f6b6">benchmark</a></div><div class="ttdeci">endcode n This information is required when setting up the fluid structure interaction because the c MeshAsGeomObject representation of the mesh of c FSISolidTractionElements is parametrised by the boundary coordinate in the solid mesh Explore the details of the implementation by commenting out the relevant line of code and use the debugger to find out how and where the code fails b the c FSISolidTractionElements issue an warning if the bulk boundary number has not been set but only if the the library is compiled in PARANOID mode n n When comparing our results against those in Turek &amp;Hron s benchmark</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00658">turek_flag.txt:658</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a8180485ff9e17af08ccc3181366d29de"><div class="ttname"><a href="turek__flag_8txt.html#a8180485ff9e17af08ccc3181366d29de">l_y</a></div><div class="ttdeci">The c origin vector shifts the lower left vertex of the solid mesh so that its centreline is aligned with the cylinder skipline start_of_constructor until l_y</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00445">turek_flag.txt:445</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_ad46ec1fccbb7aaccba226a0222f6f4a9"><div class="ttname"><a href="turek__flag_8txt.html#ad46ec1fccbb7aaccba226a0222f6f4a9">straightforward</a></div><div class="ttdeci">The application of boundary conditions for the solid are straightforward</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00492">turek_flag.txt:492</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a9d72e94a9305c6a310940a6a427ebe06"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a9d72e94a9305c6a310940a6a427ebe06">Global_Parameters::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number (default assignment for FSI1 test case)</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8cc_source.html#l00058">turek_flag.cc:58</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a1b26656bb9ec986a1e2e78eca382269a"><div class="ttname"><a href="turek__flag_8txt.html#a1b26656bb9ec986a1e2e78eca382269a">build_global_mesh</a></div><div class="ttdeci">We now add the various meshes to the c Problem s collection of sub meshes and combine them to a global mesh until build_global_mesh()</div></div>
<div class="ttc" id="aturek__flag_8txt_html_ade699c3053b3dd70b4ef68378f9001f8"><div class="ttname"><a href="turek__flag_8txt.html#ade699c3053b3dd70b4ef68378f9001f8">outlet</a></div><div class="ttdeci">axially traction free outflow at the outlet</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00092">turek_flag.txt:92</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a43c2ad697f7900737359f17d706c2d4c"><div class="ttname"><a href="turek__flag_8txt.html#a43c2ad697f7900737359f17d706c2d4c">of</a></div><div class="ttdeci">f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f f&lt;/TD &gt;&lt; TD ALIGN=&quot;CENTER&quot;&gt; f degrees of freedom A relatively large timestep of f Delta involving an average of</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00291">turek_flag.txt:291</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_ab796d783db5be5252c640f8415e2e37d"><div class="ttname"><a href="turek__flag_8txt.html#ab796d783db5be5252c640f8415e2e37d">refine_uniformly</a></div><div class="ttdeci">We build the mesh and identify a control before creating an error estimator and performing one uniform mesh refinement until Fluid_mesh_pt refine_uniformly()</div></div>
<div class="ttc" id="aturek__flag_8txt_html_a3d22db0f01d59531ccaa6b87399f0c4a"><div class="ttname"><a href="turek__flag_8txt.html#a3d22db0f01d59531ccaa6b87399f0c4a">n_y</a></div><div class="ttdeci">The c origin vector shifts the lower left vertex of the solid mesh so that its centreline is aligned with the cylinder skipline start_of_constructor until n_y</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00445">turek_flag.txt:445</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_a4d9e5c6e7472b63c0e39069d029b7c5b"><div class="ttname"><a href="turek__flag_8txt.html#a4d9e5c6e7472b63c0e39069d029b7c5b">Next</a></div><div class="ttdeci">We also include a gravitational body force for the solid(This is only used for the solid mechanics test cases, CSM1 and CSM2, which will not be discussed here.) \until } The domain geometry and flow field are fairly complex and it is difficult to const ruct a good initial guess for the Newton iteration. To ensure its convergence at the beginning of the simulation we therefore employ the method suggested by Turek &amp;Hron Next</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00343">turek_flag.txt:343</a></div></div>
<div class="ttc" id="aturek__flag_8txt_html_ae9a7b69a5f4403491ab6404a9888c78c"><div class="ttname"><a href="turek__flag_8txt.html#ae9a7b69a5f4403491ab6404a9888c78c">_</a></div><div class="ttdeci">f and length f L * _</div><div class="ttdef"><b>Definition:</b> <a href="turek__flag_8txt_source.html#l00051">turek_flag.txt:51</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 27 2021 17:43:01
        </div>
      </div>
    </footer>
</body>
</html>

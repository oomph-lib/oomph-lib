<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: unstructured_fsi.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">unstructured_fsi.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="unstructured__fsi_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: 2D FSI on unstructured meshes</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">This tutorial demonstrates the use of unstructured meshes</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">in 2D fluid-structure interaction problems. We combine two </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">single-physics problems, namely</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">- &lt;a href=&quot;../../../solid/unstructured_solid/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">  Large deformations of an elastic 2D solid, loaded</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  by surface tractions and a gravitational body force&lt;/a&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">- &lt;a href=&quot;../../../navier_stokes/unstructured_fluid/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">  Flow through a 2D channel that is partly obstructed by a </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">  rigid 2D solid body&lt;/a&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">for which we have already created unstructured 2D meshes, using the combination</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">of &lt;A HREF=&quot;http://en.wikipedia.org/wiki/Xfig&quot;&gt;xfig&lt;/A&gt;, \c oomph-lib&#39;s conversion </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">code &lt;a href=&quot;../../../meshes/mesh_from_xfig/html/index.html&quot;&gt;\c</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">fig2poly,&lt;/a&gt;  and the unstructured mesh generator </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">&lt;A HREF=&quot;http://www.cs.cmu.edu/~quake/triangle.html&quot;&gt;\c Triangle. &lt;/A&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">\section the_problem The problem</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">The figure below shows a sketch of the problem. A 2D channel</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">is partly obstructed by an odd-shaped elastic obstacle that</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">deforms in response to gravity and to the traction that the fluid </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">exerts onto it. The coupled problem is a straightforward combination of</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">the two single-physics problems shown at the top of the sketch: </span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">The flow through a channel with a rigid obstacle (shown on the top left), </span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">and the deformation of the elastic obstacle in response to </span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">a prescribed surface traction (shown on the top right). When the </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">two constituent single-physics problems interact, the </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">fluid provides the traction onto the solid while the</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">change in the solid&#39;s shape affects the fluid domain. </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\image html fsi_sketch.gif &quot;Sketch of the problem and its two single-physics constituents. &quot; </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">\image latex fsi_sketch.eps &quot;Sketch of the problem and its two single-physics constituents. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">As usual, we solve the problem in non-dimensional form. For this</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">purpose we non-dimensionalise all lengths on some reference </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">length \f$ {\cal L} \f$</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">and use the average inflow velocity, \f$ {\cal U}\f$, to</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">non-dimensionalise the velocities in the Navier-Stokes equations. </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">As discussed in the </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">&lt;a href=&quot;../../../navier_stokes/unstructured_fluid/html/index.html#reynolds&quot;&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">single-physics fluids tutorial,&lt;/a&gt; the Reynolds number of the flow</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">is then given by</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">Re = \frac{\rho {\cal U} {\cal L}}{\mu} \ ,</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">where \f$ \rho \f$ and \f$ \mu \f$ are the fluid density and viscosity,</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">respectively. \c oomph-lib&#39;s Navier Stokes elements non-dimensionalise</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">the fluid stresses, and in particular the pressure, on the</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">viscous scale, \f$ \mu {\cal U}/{\cal L} \f$.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">We assume that the solid&#39;s constitutive equation is given by</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\c oomph-lib&#39;s generalised Hookean constitutive law and</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">non-dimensionalise the solid-mechanics stresses and tractions</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">with Young&#39;s modulus \f$ E \f$. </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">The FSI interaction parameter \f$ Q \f$ which represents the ratio</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">of the (viscous) fluid stress scale to the reference stress used</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">to non-dimensionalise the solid stresses is therefore given by</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">Q = \frac{\mu {\cal U}}{{\cal L} E} \ .</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">The animation below shows a number of steady flow fields (streamlines </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">and pressure contours) and deformations, obtained in a parameter </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">study in which we first compute the solution of the coupled problem</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">at zero Reynolds number and for a vanishing FSI interaction parameter, </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">\f$ Q=0 \f$. For these parameter values, the structure is loaded </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">only by gravity  and does not feel the presence of the fluid, whereas</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">the fluid flow is affected by the changes to the fluid domain</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">when the obstacle deforms (first frame). Next, we increase the</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">Reynolds number to \f$ Re=10\f$ and re-compute the solution (second</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">frame), before increasing \f$ Q \f$ in small increments</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">(subsequent frames). The increase in  \f$ Q \f$ may be interpreted</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">as a reduction in the obstacle&#39;s stiffness and the animation shows</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">clearly how this increases its flow-induced deformation.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">\image html flow.gif &quot;Animation of the flow field (streamlines and pressure contours) and the deformation of the elastic obstacle. &quot; </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\image latex flow.eps &quot;Animation of the flow field (streamlines and pressure contours) and the deformation of the elastic obstacle. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">\section overview_implementation Overview of the implementation</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">The use of unstructured meshes</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">means that the design of an algebraic node update strategy for the </span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">deforming fluid mesh, as described for </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">&lt;a href=&quot;../../fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">fluid-structure interaction with structured meshes, &lt;/a&gt; is (almost)</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">impossible and would, in any case, defeat the point of using automatic mesh</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">generation tools. A slightly less efficient, but easily and generally </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">applicable strategy is to update the nodal positions within the fluid mesh</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">by treating the fluid domain as a pseudo-elastic solid. Apart from this</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">change in the node-update strategy, the majority of the steps described </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">below are the same as for fluid-structure-interaction problems on </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">structured meshes. </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> One important prerequisite for the use of the FSI helper functions</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">in \c oomph-lib&#39;s \c FSI_functions namespace is that each boundary </span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">at the FSI interface between the fluid and solid meshes must be </span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">parametrised by boundary coordinates. Moreover, the</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">boundary-coordinate representations in the fluid and</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">solid meshes &lt;b&gt; must &lt;/b&gt; be consistent. Once the appropriate </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">boundaries have been identified, \c oomph-lib&#39;s unstructured</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">meshes allow the automatic (and consistent) generation of these </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">boundary coordinates; see \ref boundary_coord. Unfortunately,</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">different third-party mesh generators use different strategies to </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">label mesh boundaries and a certain amount of &quot;manual labour&quot; tends</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">be required to identify boundaries after the mesh has been imported </span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">into \c oomph-lib. </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">Since the driver code, discussed in detail below, is somewhat lengthy</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">(partly because of the large number of self-tests and diagnostics</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">included), we provide a brief overview of the main steps</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">required to solve this problem:</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\n\n</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">-# Use the combination of</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">   &lt;A HREF=&quot;http://en.wikipedia.org/wiki/Xfig&quot;&gt;xfig&lt;/A&gt;,</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">   \c oomph-lib&#39;s conversion code</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">   &lt;a href=&quot;../../../meshes/mesh_from_xfig/html/index.html&quot;&gt;\c</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">   fig2poly,&lt;/a&gt; and the unstructured</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">   mesh generator &lt;A HREF=&quot;http://www.cs.cmu.edu/~quake/triangle.html&quot;&gt;\c </span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">   Triangle &lt;/A&gt; to generate the solid mesh, as already discussed in </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">   &lt;a href=&quot;../../../solid/unstructured_solid/html/index.html#mesh&quot;&gt;</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">   another tutorial.&lt;/a&gt;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">-# Use the same procedure to generate the fluid mesh, as discussed in </span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">   &lt;a href=&quot;../../../navier_stokes/unstructured_fluid/html/index.html#mesh&quot;&gt;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">   the single-physics fluids tutorial.&lt;/a&gt; Make sure that the </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">   fluid mesh is derived</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">   from the \c SolidMesh base class to allow the use of</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">   pseudo-elasticity to update the nodal positions in response</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">   to the deformation of the domain boundary.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">-# Ensure that boundary coordinates are set up (consistently) on the </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">   FSI interface between the two meshes. For meshes derived from </span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">   \c oomph-lib&#39;s \c TriangleMesh class, this may be done </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">   by calling the function \c</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">   TriangleMesh::setup_boundary_coordinates().</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">-# Attach \c FSISolidTractionElements to the faces of the &quot;bulk&quot;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">   solid elements that are exposed to the fluid flow. These</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">   elements will apply the fluid traction to the solid.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">-# Combine the \c FSISolidTractionElements into a compound \c GeomObject</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">   that provides a continuous representation of the solid&#39;s FSI </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">   boundary, required by the \c</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">   ImposeDisplacementByLagrangeMultiplierElements described below.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">-# Attach  \c ImposeDisplacementByLagrangeMultiplierElements to the</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">   faces of the &quot;bulk&quot; fluid elements that are adjacent to the</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">   solid. These elements will employ Lagrange multipliers</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">   to deform the pseudo-solid fluid mesh so that its shape remains</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">   consistent with the solid&#39;s FSI boundary</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">   (as described by the compound \c GeomObject created in the previous</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">   step).</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">-# Determine the &quot;bulk&quot; fluid elements that are adjacent to the</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">   integration points of the  \c FSISolidTractionElements,</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">   using the function \c</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">   FSI_functions::setup_fluid_load_info_for_solid_elements(...).</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">In our experience, the most error-prone part of this procedure is the</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">identification of the mesh boundaries in the</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">&lt;A HREF=&quot;http://en.wikipedia.org/wiki/Xfig&quot;&gt;xfig&lt;/a&gt;-based, unstructured meshes. </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">It is very easy to exclude a node at the end of the FSI boundary</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">in the fluid mesh, say, while &quot;remembering&quot; it in the solid mesh. If this</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">happens, the automatic matching of the unstructured fluid and solid meshes</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">will not work (see \ref boundary_coord for details). For </span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">this reason, the driver code presented below</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">generates a lot of output that can be used to identify and fix</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">such problems. See also the section \ref go_wrong at the end </span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">of this tutorial. </span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">\section namespace Problem Parameters</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">As usual we define the various problem parameters in a </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">global namespace. We define the Reynolds number, \f$ Re \f$, and</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">the FSI interaction parameter \f$ Q \f$.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">\dontinclude unstructured_two_d_fsi.cc</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">\until Q=</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">We define the gravitational body force that acts (only!) on the solid  </span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">(see \ref b_f to find out why this is odd...)</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">and provide a pointer to the constitutive equation for the</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">solid. For simplicity, this constitutive equation will also be used for </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">the (pseudo-)solid elements that determine the deformation of </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">the fluid mesh. In general, the constitutive law used to </span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">control the deformation of the fluid mesh need not have any physical</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">basis, it is more important that the elements do not become too deformed</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">during the mesh motion.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">\until Constitutive_law_pt</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">Finally, we provide a helper function that will be used </span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">to establish whether a node is located on the FSI boundary when the</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">mesh is in its undeformed configuration. This function uses a simple </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">&quot;brute force&quot; approach. It is required because currently our </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">&lt;A HREF=&quot;http://en.wikipedia.org/wiki/Xfig&quot;&gt;xfig&lt;/a&gt;-based</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">mesh generation procedures do not allow us to associate fractional</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">parts of a polygonal domain boundary as belonging to different</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">mesh boundaries. Hence, such boundaries have to be </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">identified a posteriori in the driver code. Although similar in form,</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">equivalent helper functions must be (re-)written for different domain </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">geometries.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">\until end_of_namespace </span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">\section mesh_code Creating the meshes</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">\subsection solid_mesh The solid mesh</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">Following the procedure discussed in the corresponding</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">&lt;a href=&quot;../../../solid/unstructured_solid/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">single-physics solid mechanics problem&lt;/a&gt; we create the mesh</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">for the elastic obstacle using multiple inheritance </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">from \c oomph-lib&#39;s \c TriangleMesh and the \c SolidMesh base</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">class.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">\skipline start_solid_mesh</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">\until {</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">As before, we set the Lagrangian coordinates to the current</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">nodal positions to make the initial configuration stress-free. </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">Initially all boundary nodes are located on the same boundary, </span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">corresponding to the single xfig polyline that defines the surface</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">of the elastic obstacle. In the current problem we have to identify</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">two additional boundaries: The &quot;bottom boundary&quot; (boundary 1) where</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">the  positions of the solid nodes will be pinned; and the nodes</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">that are located on the FSI boundary (boundary 2). </span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\until done boundary</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">Finally, we identify the elements that are located next to the</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">newly created domain boundaries and create boundary coordinates</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">along boundaries 1 and 2.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">\until };</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">\subsection fluid_mesh The fluid mesh</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">The creation of the fluid mesh follows the same process but uses</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">the mesh created for the  </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">&lt;a href=&quot;../../../navier_stokes/unstructured_fluid/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">single-physics fluids problem.&lt;/a&gt;</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">The use of multiple inheritance from the \c TriangleMesh and \c SolidMesh base</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">classes will allow us to employ pseudo-solid node-update techniques </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">to update the position of the fluid nodes in response to changes </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">in the domain boundary. </span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">\skipline start_fluid_mesh</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">\until set_lagrangian</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">The fluid problem requires the identification of three additional </span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">boundaries: The inflow boundary (boundary 1), the outflow boundary</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">(boundary 2) and the FSI boundary (boundary 3). </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">\until setup_boundary_element_info()</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">We create boundary coordinates along the three newly-created</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">mesh boundaries and document the process for the FSI boundary </span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">(boundary 3). See \ref go_wrong for a more detailed discussion of the</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">output created here.  </span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">\until };</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">We specify an output directory and instantiate the constitutive </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">equation for the solid mechanics computations, specifying the</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">Poisson ratio. </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">(&lt;a href=&quot;../../../solid/solid_theory/html/index.html#non-dim_solid&quot;&gt;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">Recall&lt;/a&gt; that the omission of Young&#39;s modulus \f$ E \f$ in the</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">constructor of the constitutive equation implies that all stresses</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">and tractions are non-dimensionalised on \f$ E \f$.)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">\dontinclude unstructured_two_d_fsi.cc</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">\until ::Nu);</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">We create the \c Problem object and output the domain boundaries</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">and the initial guess for the solution.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">\until ()++</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">Finally, we perform a two-stage parameter study. We start</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">by solving the problem at zero Reynolds number with </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">the FSI parameter \f$ Q \f$ set to zero. </span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">\until  ()++</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">Next we re-solve the problem at finite Reynolds number,</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">before slowly increasing the strength of the fluid-structure</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">interaction.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">\until end_of_main</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">\section class The Problem class</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">The \c Problem class has the usual members,</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">with access functions to the fluid and solid meshes,</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">and a post-processing routine.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">\dontinclude unstructured_two_d_fsi.cc</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">\until doc_solution</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">The class provides two private helper functions: one to create</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">the \c FaceElements that apply the fluid traction to the solid and one</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">to create the</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">\c FaceElements that use Lagrange multipliers to deform the fluid</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">mesh according to the motion of the solid boundary. </span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">\until create_lagrange</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">Another private helper function is provided to document the</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">boundary parametrisation of the solid&#39;s FSI interface:</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">\until doc_solid_boundary_coordinates()</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">The private member data includes pointers to the various</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">meshes and a \c GeomObject representation of the FSI boundary.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">\until };</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">\section constructor The Problem constructor</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">We start by building the fluid mesh, using the files created</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">by &lt;A HREF=&quot;http://www.cs.cmu.edu/~quake/triangle.html&quot;&gt;\c Triangle</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">&lt;/A&gt;; see the discussion in the corresponding</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">&lt;a href=&quot;../../../navier_stokes/unstructured_fluid/html/index.html#mesh&quot;&gt;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">single-physics fluids problem.&lt;/a&gt;</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">\until fluid_poly_file_name);</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">Next, we apply the boundary conditions for the fluid and the </span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">pseudo-solid equations. We pin the pseudo-solid nodes along</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">all domain boundaries, apart from the FSI boundary (boundary 3), </span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">apply a no-slip condition for the fluid velocity along the solid</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">channel walls (boundary 0) and the FSI boundary (boundary 3); </span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">pin the velocity at the inflow</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">(boundary 1, where we will impose a Poiseuille flow profile); and impose</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">parallel outflow at the downstream end (boundary 2). </span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">As mentioned before, the manual identification of</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">mesh boundaries in unstructured meshes that are generated by</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">third-party mesh generators is a relatively error-prone process.</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">Therefore we document the boundary conditions for the pseudo-solid </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">to allow an external sanity check.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">\until pseudo_solid_bc_file.close();</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">We complete the build of the elements by specifying</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">the Reynolds number and the constitutive equation used in the pseudo-solid</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">mesh deformation.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">Finally, we impose a Poiseuille profile at the inflow boundary (boundary</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">1) and assign the equation numbers.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">\until end Poiseuille</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">Next, we create the solid mesh, using the files created</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">by &lt;A HREF=&quot;http://www.cs.cmu.edu/~quake/triangle.html&quot;&gt;\c Triangle</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">&lt;/A&gt;; see the discussion in the corresponding</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">&lt;a href=&quot;../../../solid/unstructured_solid/html/index.html#mesh&quot;&gt;</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">single-physics solids problem.&lt;/a&gt;</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">\until solid_poly_file_name);</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">We complete the build of the solid elements by passing the pointer</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">to the constitutive equation and the function pointer to the</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">gravitational body force.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">We suppress the displacements of the nodes on boundary 1.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">Next, we create the \c FaceElements that apply the fluid traction</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">to the solid</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">\until create_fsi_traction_elements();</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">and the \c FaceElements that use Lagrange multipliers to deform</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">the fluid mesh to keep it aligned with the FSI boundary.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">\until create_lagrange</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">We combine the various sub-meshes into a global mesh.</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">\until build_global</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">Finally, we set up the fluid-structure interaction by determining</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">which &quot;bulk&quot; fluid elements are located next to the FSI traction elements</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">that apply the fluid load to the solid. We document the boundary </span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">coordinate along the FSI interface by opening the  \c</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">Multi_domain_functions::Doc_boundary_coordinate_file stream before</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">calling  \c</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">FSI_functions::setup_fluid_load_info_for_solid_elements(...)</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">If this stream is open, the setup routine writes the Eulerian </span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">coordinates of the points on the FSI interface and their </span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">intrinsic surface coordinate \f$ [ x, y, \zeta ] \f$ to the specified </span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">file. </span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">\until .close();</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">We use the private helper function \c doc_solid_boundary_coordinates()</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">to create the same output from the &quot;solid side&quot; of the FSI interface.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">This is useful for debugging purposes because it allows</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">us to check whether the fluid and solid meshes employ a matching</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">parametrisation of the FSI interface; see \ref go_wrong for more</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">details. </span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">\until doc_solid_boundary_coordinates();</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">All that&#39;s left to do is to set up the equation numbering scheme and </span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">the problem is ready to be solved.</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">\until end_of_constructor</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">\section fsi_traction Creating the FSI traction elements</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">The creation of the FSI traction elements adjacent to the</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">solid boundary 2 follows the usual procedure. We loop over the</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">relevant 2D &quot;bulk&quot; solid elements and attach the </span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">\c FSISolidTractionElements to the appropriate faces. </span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">\skipline start_of_create_traction_elements</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">\until new FSISolidTractionElement&lt;SOLID_ELEMENT,2&gt;(bulk_elem_pt,face_index);</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">Next we add the newly-created \c FaceElement to the mesh of traction</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">elements, specify which boundary of the bulk mesh it is attached to,</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">and pass the FSI interaction parameter \f$ Q \f$ to the element. </span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">\until  end of create_traction_elements</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">\section create_lagr Creating the Lagrange multiplier elements</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">The creation of the \c FaceElements that use Lagrange multipliers</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">to impose the boundary displacement of the pseudo-solid fluid mesh</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">is again fairly straightforward (the use of Lagrange multipliers</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">for the imposition of boundary displacements is explained</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">in &lt;a href=&quot;../../../solid/prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">another tutorial&lt;/a&gt;). We start by combining the</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"> \c FSISolidTractionElements attached to the</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">solid&#39;s FSI boundary to form a compound \c GeomObject. This \c GeomObject</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">provides a continuous representation of the FSI boundary (as determined</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">by the deformation of the solid) and is parametrised by the </span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">boundary coordinate assigned earlier. This continuous representation</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">will define the desired position of the boundary as enforced by </span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">the Lagrange multiplier elements.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">\until (Traction_mesh_pt);</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">Now we attach \c ImposeDisplacementByLagrangeMultiplierElements</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">to the appropriate faces of the &quot;bulk&quot; fluid elements that are </span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">adjacent to the FSI interface (boundary 3 in the fluid mesh). </span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">\until add_element_pt</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">Next we pass a pointer to the compound \c GeomObject that defines</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">the desired shape of the FSI interface and specify which boundary in the</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">&quot;bulk&quot; fluid mesh the element is attached to.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">\until set_boundary_shape</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">Finally, we apply boundary conditions for the Lagrange multipliers:</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">we pin the Lagrange multipliers for nodes that are located on </span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">boundary 0 where the nodal displacements are pinned. </span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">(&lt;a href=&quot;../../../solid/prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">Recall&lt;/a&gt; that the Lagrange multipliers are additional degrees of</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">freedom added to the &quot;bulk&quot; degrees of freedom</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">originally created by the &quot;bulk&quot; element.)</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">\until end of create_lagrange_multiplier_elements</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">\section doc_solution Post-processing</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">The post-processing routine simply executes the output functions for </span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">the fluid and solid meshes and writes the results into separate files. </span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">\skipline start_of_doc_solution</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">\until end_of_doc</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">\section doc_solid_zeta Sanity check: Documenting the solid boundary coordinates</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">The function \c doc_solid_boundary_conditions() </span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">documents the parametrisation of the</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">solid&#39;s FSI boundary in the file </span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">&lt;code&gt;solid_boundary_test.dat&lt;/code&gt;. The file contains the solid&#39;s </span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">counterpart of the \f$ [ x, y, \zeta ] \f$ data </span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">that we created for the fluid side of the FSI interface</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">when setting up the fluid-structure interaction with </span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">\c FSI_functions::setup_fluid_load_info_for_solid_elements(...).</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">The two parametrisations should be consistent; see</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">\ref go_wrong for more details. </span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">The function also writes the file </span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">&lt;code&gt;fsi_geom_object.dat&lt;/code&gt;, which may be used to </span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">check the integrity of the compound \c GeomObject  </span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">that represents the FSI interface of the solid: As \f$ \zeta \f$</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">sweeps along the  range used to parametrise the</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">boundary, the position vector \f$ {\bf R}(\zeta) \f$, returned</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">by \c GeomObject::position(...) should follow the</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">FSI interface.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">The implementation of the function is reasonably straightforward </span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">so we omit its listing here, see the </span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/unstructured_fsi/unstructured_two_d_fsi.cc&quot;&gt;source</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">code&lt;/a&gt; </span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">for details.</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">\section comm_ex Comments and Exercises</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">\subsection boundary_coord How the boundary coordinates are generated</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">The use of pseudo-elasticity for the node update in the fluid mesh </span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">makes the solution of FSI problems extremely straightforward. </span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">They key ingredient that allows the &quot;automatic&quot; coupling between the </span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">unstructured fluid and solid meshes  </span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">is the (consistent!) generation of the boundary coordinate  \f$ \zeta \f$</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">along the FSI interface. The function </span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">\c TriangleMesh::setup_boundary_coordinates(...) achieves this</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">automatically and exploits the facts that </span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">-# Meshes generated</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">   by  &lt;A HREF=&quot;http://www.cs.cmu.edu/~quake/triangle.html&quot;&gt;\c Triangle</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">   &lt;/A&gt; are bounded by polygonal line segments. </span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">-# Vertices in the polygonal domain boundary coincide with </span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">   vertex nodes of the triangular finite elements. </span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">The assignment of the boundary coordinate along mesh boundary \c b</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">is performed as follows:</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">-# Attach \c FaceElements to the relevant faces of the &quot;bulk&quot; elements</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">   that are adjacent to mesh boundary \c b. </span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">-# Establish the connectivity of the \c FaceElements using the fact</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">that they share common \c Nodes and sort the elements into &quot;connectivity&quot; order </span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">around the boundary.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">-# Locate the &quot;lowest left&quot; boundary node on the boundary and set</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">   its boundary coordinate to zero.</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">-# Step through the \c FaceElements (and their nodes) in order (taking</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">   into account that some \c FaceElements may be reversed relative</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">   to each other) and use the distance between adjacent nodes as the</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">   increment in the boundary coordinate. </span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">-# Delete the \c FaceElements. </span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">This procedure generates a consistent boundary parametrisation,</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">irrespective of how many fluid and solid elements meet at the</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">shared FSI boundary. This is because the nodes along all \c FaceElements </span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">are located along the same straight line segments. The method would not</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">work if the boundary was curvilinear! </span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">The method also fails, if the &quot;lower left&quot; boundary nodes identified</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">in the two meshes are not located at the same position. This tends to </span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">happen if boundary nodes are assigned inconsistently, e.g. because</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">the final node on the FSI interface was identified as being located</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">on the appropriate mesh boundary in the fluid mesh but not in the </span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">solid mesh. In that case the boundary coordinates of the two meshes </span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">are offset relatively to each other by an amount equal to the </span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">distance between the respective &quot;lower left&quot; nodes.</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">Here is a plot of the boundary coordinate \f$ \zeta \f$ generated from</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">the fluid (blue) and solid (red) sides, with \f$ \zeta \f$ being </span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">plotted &quot;on top&quot; of the unstructured solid mesh. </span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">\image html boundary_coordinate_check.gif &quot;Plot of the boundary coordinates generated from the fluid and solid sides of the FSI interface. &quot; </span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">\image latex boundary_coordinate_check.eps &quot;Plot of the boundary coordinates generated from the fluid and solid sides of the FSI interface. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">\subsection non_matching Fluid and solid meshes do not have to be matching</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">To demonstrate that the fluid and solid meshes to not have to </span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">be matching across the FSI interface, here are the results of </span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">another computation in which a much finer fluid mesh was used.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">This computation was performed by re-generating the mesh, running</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">triangle with a smaller maximum element size:</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">\code</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"> triangle -q -a0.01 fluid.fig.poly</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">\endcode</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">The driver code remained completely unchanged.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">\image html flow_fine.gif &quot;Animation of the flow field (streamlines and pressure contours) and the deformation, computed on a refined fluid mesh. &quot; </span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">\image latex flow_fine.eps &quot;Animation of the flow field (streamlines and pressure contours) and the deformation, computed on a refined fluid mesh. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">\subsection b_f Gravity only affects the solid -- really?</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">The computations presented above suffer from a rather embarrassing</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">modelling error. We have implicitly assumed that the solid is deformed</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">significantly by gravity whereas no body force acts in the fluid. </span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">This is extremely unlikely to be right but makes for a useful exercise. </span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">-# Formulate the problem properly, starting from the dimensional</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">   form of the governing equations, to determine the correct</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">   non-dimensional body forces for the fluid and the solid. </span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">-# Use your analysis to explain under what circumstances our &quot;error&quot; </span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">   could actually be a justifiable approximation to the real system.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">\subsection go_wrong What can go wrong?</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">As indicated above, the methodology employed in this tutorial makes the</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">formulation of 2D FSI problems extremely straightforward. The most</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">difficult part of the entire procedure is identifying the appropriate</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">boundaries in the mesh generated by third-party software. Here are a </span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">few things that can (and often do) go wrong, which </span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">result in the code being unable to set up</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">consistent boundary coordinates. </span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">- &lt;b&gt; Boundaries don&#39;t match in xfig:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">  When drawing the boundaries of the fluid and solid domains in</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">  &lt;A HREF=&quot;http://en.wikipedia.org/wiki/Xfig&quot;&gt;xfig&lt;/A&gt;, </span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">  it is important to ensure that the FSI boundary is the same. A</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">  simple way to achieve this is to draw </span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">   the fluid domain first and then make a copy of the</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">  resulting *.fig file. Once the file has been renamed it can be loaded into </span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">  &lt;A HREF=&quot;http://en.wikipedia.org/wiki/Xfig&quot;&gt;xfig&lt;/A&gt; </span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">  and the polygonal vertices that are not part of the FSI</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">  interface can be deleted, while new vertices that are only part of</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">  the solid boundary can then be added. Just make sure that you don&#39;t move</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">  any of the vertices that define the FSI interface!</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">- &lt;b&gt; The mesh is too coarse for the automatic generation of</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">  boundary-lookup schemes:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">  &lt;center&gt;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">  &lt;table border=1, width=500px&gt;</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">  &lt;tr&gt;</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">  &lt;td&gt;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">  &lt;b&gt;Note:&lt;/b&gt; We believe that the problem described here has now been fixed.</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">  However, it is possible/likely that there are particularly</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">  pathological meshes in which the scheme fails. If you encounter</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">  any such problems, please &lt;a href=&quot;../../../contact/html/index.html&quot;&gt;let </span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">  us know. &lt;/a&gt;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">  &lt;/td&gt;</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">  &lt;/tr&gt;</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">  &lt;/table&gt;</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">  &lt;/center&gt;</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">  Another problem arises if the mesh generated by </span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">  &lt;A HREF=&quot;http://www.cs.cmu.edu/~quake/triangle.html&quot;&gt; \c Triangle &lt;/a&gt; </span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">  is too coarse for the automatic identification</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">  of mesh boundaries by \c TriangleMeshBase::setup_boundary_element_info(). </span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">  This function gets (justifiably) confused when the mesh is so coarse</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">  that both vertex nodes on an element edge that crosses the interior</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">  of the domain are located on the same mesh boundary. </span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">  We do not intend to fix this problem -- if your mesh is that coarse,</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">  you should refine it! Anyway, if it happens, the problem may be</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">  diagnosed by plotting the output written to </span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">  \c Multi_domain_functions::Doc_boundary_coordinate_file if this stream is</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">  open when \c FSI_functions::setup_fluid_load_info_for_solid_elements(...)</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">  is called. The file (&lt;code&gt;fluid_boundary_test.dat&lt;/code&gt; in our</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">  driver code) contains the \c FaceElements that are attached</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">  to the (perceived) FSI boundary in the fluid mesh. (The file </span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">  &lt;code&gt;solid_boundary_test.dat&lt;/code&gt;, generated manually in our</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">  driver code, contains the same information for the solid mesh.)</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">  Here is what the plot should look like if the fluid mesh is</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">  sufficiently fine (the \c FaceElements are shown as thick red lines</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">  on top of the &quot;bulk&quot; fluid mesh): </span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">\image html boundary_generation_test.gif &quot;Correct FSI boundary. &quot; </span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">\image latex boundary_generation_test.eps &quot;Correct FSI boundary. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">  In the next figure, the fluid mesh is too coarse and the </span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">  boundary detection has failed spectacularly:</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">\image html boundary_generation_test_too_coarse.gif &quot;Wrongly identified FSI boundary on a (too) coarse fluid mesh. &quot; </span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">\image latex boundary_generation_test_too_coarse.eps &quot;Wrongly identified FSI boundary on a (too) coarse fluid mesh. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">- &lt;b&gt; The boundary coordinates on the fluid and solid side</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">  of the FSI interface don&#39;t match:&lt;/b&gt; </span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">  We have already alluded to this problem when discussing</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">  \ref boundary_coord. The problem arises mainly (only?) when </span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">  nodes at the &quot;end&quot; of the FSI interface are only</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">  added to the FSI boundary in one of the meshes but not the other.</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">  For this reason, we strongly recommend printing out the mesh</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">  boundaries and checking them carefully before proceeding.</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">  Here is a plot of the mesh boundaries for the current problem:</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">\image html boundaries.gif &quot;Boundary nodes in the fluid (triangle) and solid (square) meshes. &quot; </span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">\image latex boundaries.eps &quot;Boundary nodes in the fluid (triangle) and solid (square) meshes. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">  \n</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/unstructured_fsi&quot;&gt;</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">demo_drivers/interaction/unstructured_fsi</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">&lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/interaction/unstructured_fsi/unstructured_two_d_fsi.cc&quot;&gt;</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">demo_drivers/interaction/unstructured_fsi/unstructured_two_d_fsi.cc</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aunstructured__fsi_8txt_html_a10c273dc7961c7f9310ceef385b621ab"><div class="ttname"><a href="unstructured__fsi_8txt.html#a10c273dc7961c7f9310ceef385b621ab">meshes</a></div><div class="ttdeci">mainpage Demo namely&lt; a href=&quot;../../../solid/unstructured_solid/html/index.html&quot;&gt; Large deformations of an elastic loaded by surface tractions and a gravitational body force&lt;/a &gt; n n&lt; a href=&quot;../../../navier_stokes/unstructured_fluid/html/index.html&quot;&gt; Flow through a channel that is partly obstructed by a rigid solid body&lt;/a &gt; for which we have already created unstructured meshes</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fsi_8txt_source.html#l00014">unstructured_fsi.txt:14</a></div></div>
<div class="ttc" id="aunstructured__fsi_8txt_html_a4b641ad43f31d0cf4afec213d1d71d3e"><div class="ttname"><a href="unstructured__fsi_8txt.html#a4b641ad43f31d0cf4afec213d1d71d3e">code</a></div><div class="ttdeci">see ref boundary_coord different third party mesh generators use different strategies to label mesh boundaries and a certain amount of manual labour tends be required to identify boundaries after the mesh has been imported into c oomph lib Since the driver code</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fsi_8txt_source.html#l00124">unstructured_fsi.txt:124</a></div></div>
<div class="ttc" id="aunstructured__two__d__fsi_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="unstructured__two__d__fsi_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver for unstructured fsi problem.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__two__d__fsi_8cc_source.html#l00786">unstructured_two_d_fsi.cc:786</a></div></div>
<div class="ttc" id="aunstructured__fsi_8txt_html_aed16abd9b6817e13bf26e1ab942aac95"><div class="ttname"><a href="unstructured__fsi_8txt.html#aed16abd9b6817e13bf26e1ab942aac95">HREF</a></div><div class="ttdeci">&quot;http: code &lt;a href=&quot;../../../meshes/mesh_from_xfig/html/index.html&quot;&gt;\c fig2poly,&lt;/a&gt; and the unstructured mesh generator &lt;A HREF=&quot;http:&lt; HR &gt;&lt; HR &gt; \section the_problem The problem The figure below shows a sketch of the problem. A 2D channel is partly obstructed by an odd-shaped elastic obstacle that deforms in response to gravity and to the traction that the fluid exerts onto it. The coupled problem is a straightforward combination of the two single-physics problems shown at the top of the sketch:The flow through a channel with a rigid obstacle(shown on the top left), and the deformation of the elastic obstacle in response to a prescribed surface traction(shown on the top right). When the two constituent single-physics problems interact, the fluid provides the traction onto the solid while the change in the solid 's shape affects the fluid domain. @I w 0.75\textwidth fsi_sketch &quot;Sketch of the problem and its two single-physics constituents. &quot; As usual, we solve the problem in non-dimensional form. For this purpose we non-dimensionalise all lengths on some reference length \f$ {\cal L} \f$ and use the average inflow velocity, \f$ {\cal U}\f$, to non-dimensionalise the velocities in the Navier-Stokes equations. As discussed in the&lt; a href=&quot;../../../navier_stokes/unstructured_fluid/html/index.html#reynolds&quot;&gt; single-physics fluids tutorial,&lt;/a &gt; the Reynolds number of the flow is then given by \f[Re=\frac{\rho {\cal U} {\cal L}}{\mu} \, \f] where \f$ \rho \f$ and \f$ \mu \f$ are the fluid density and viscosity, respectively. \c oomph-lib 's Navier Stokes elements non-dimensionalise the fluid stresses, and in particular the pressure, on the viscous scale, \f$ \mu {\cal U}/{\cal L} \f$. We assume that the solid 's constitutive equation is given by \c oomph-lib 's generalised Hookean constitutive law and non-dimensionalise the solid-mechanics stresses and tractions with Young 's modulus \f$ E \f$. The FSI interaction parameter \f$ Q \f$ which represents the ratio of the(viscous) fluid stress scale to the reference stress used to non-dimensionalise the solid stresses is therefore given by \f[Q=\frac{\mu {\cal U}}{{\cal L} E} \ . \f]&lt; HR &gt;&lt; HR &gt; \section results Results The animation below shows a number of steady flow fields(streamlines and pressure contours) and deformations, obtained in a parameter study in which we first compute the solution of the coupled problem at zero Reynolds number and for a vanishing FSI interaction parameter, \f$ Q=0 \f$. For these parameter values, the structure is loaded only by gravity and does not feel the presence of the fluid, whereas the fluid flow is affected by the changes to the fluid domain when the obstacle deforms(first frame). Next, we increase the Reynolds number to \f$ Re=10\f$ and re-compute the solution(second frame), before increasing \f$ Q \f$ in small increments(subsequent frames). The increase in \f$ Q \f$ may be interpreted as a reduction in the obstacle 's stiffness and the animation shows clearly how this increases its flow-induced deformation. @I w 0.75\textwidth flow &quot;Animation of the flow field (streamlines and pressure contours) and the deformation of the elastic obstacle. &quot;&lt; HR &gt;&lt; HR &gt; \section overview_implementation Overview of the implementation The use of unstructured meshes means that the design of an algebraic node update strategy for the deforming fluid mesh, as described for&lt; a href=&quot;../../fsi_collapsible_channel_algebraic/html/index.html&quot;&gt; fluid-structure interaction with structured meshes,&lt;/a &gt; is(almost) impossible and would, in any case, defeat the point of using automatic mesh generation tools. A slightly less efficient, but easily and generally applicable strategy is to update the nodal positions within the fluid mesh by treating the fluid domain as a pseudo-elastic solid. Apart from this change in the node-update strategy, the majority of the steps described below are the same as for fluid-structure-interaction problems on structured meshes. One important prerequisite for the use of the FSI helper functions in \c oomph-lib 's \c FSI_functions namespace is that each boundary at the FSI interface between the fluid and solid meshes must be parametrised by boundary coordinates. Moreover, the boundary-coordinate representations in the fluid and solid meshes&lt; b &gt; must&lt;/b &gt; be consistent. Once the appropriate boundaries have been identified, \c oomph-lib 's unstructured meshes allow the automatic(and consistent) generation of these boundary coordinates HREF</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fsi_8txt_source.html#l00118">unstructured_fsi.txt:118</a></div></div>
<div class="ttc" id="aunstructured__fsi_8txt_html_a559b24adf0c5fc11da2b7f8c4c406c08"><div class="ttname"><a href="unstructured__fsi_8txt.html#a559b24adf0c5fc11da2b7f8c4c406c08">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fsi_8txt_source.html#l00005">unstructured_fsi.txt:5</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a7814fddf663e56168174a42d2cd6b4c1"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a></div><div class="ttdeci">double Q</div><div class="ttdoc">FSI parameter.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__two__d__fsi_8cc_source.html#l00049">unstructured_two_d_fsi.cc:49</a></div></div>
<div class="ttc" id="aunstructured__fsi_8txt_html_a336ff0d26064f153eda8ac34c7ca5f49"><div class="ttname"><a href="unstructured__fsi_8txt.html#a336ff0d26064f153eda8ac34c7ca5f49">solid</a></div><div class="ttdeci">mainpage Demo namely&lt; a href=&quot;../../../solid/unstructured_solid/html/index.html&quot;&gt; Large deformations of an elastic solid</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fsi_8txt_source.html#l00007">unstructured_fsi.txt:7</a></div></div>
<div class="ttc" id="aunstructured__fsi_8txt_html_a437b67a41ab1376505f17c94689107a2"><div class="ttname"><a href="unstructured__fsi_8txt.html#a437b67a41ab1376505f17c94689107a2">Unfortunately</a></div><div class="ttdeci">see ref boundary_coord Unfortunately</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fsi_8txt_source.html#l00118">unstructured_fsi.txt:118</a></div></div>
<div class="ttc" id="aunstructured__fsi_8txt_html_a1964cba3a57b7e750cf752d965114109"><div class="ttname"><a href="unstructured__fsi_8txt.html#a1964cba3a57b7e750cf752d965114109">below</a></div><div class="ttdeci">see ref boundary_coord different third party mesh generators use different strategies to label mesh boundaries and a certain amount of manual labour tends be required to identify boundaries after the mesh has been imported into c oomph lib Since the driver discussed in detail below</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__fsi_8txt_source.html#l00124">unstructured_fsi.txt:124</a></div></div>
<div class="ttc" id="aunstructured__fsi_8txt_html_aaa605e1f21686e0c1a099a964ca469ee"><div class="ttname"><a href="unstructured__fsi_8txt.html#aaa605e1f21686e0c1a099a964ca469ee">lengthy</a></div><div class="ttdeci">see ref boundary_coord different third party mesh generators use different strategies to label mesh boundaries and a certain amount of manual labour tends be required to identify boundaries after the mesh has been imported into c oomph lib Since the driver discussed in detail is somewhat lengthy(partly because of the large number of self-tests and diagnostics included)</div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a200109847bf4cc26da4d00e8d68d569e"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a200109847bf4cc26da4d00e8d68d569e">Global_Parameters::gravity</a></div><div class="ttdeci">void gravity(const double &amp;time, const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;b)</div><div class="ttdoc">Non-dimensional gravity as body force.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__two__d__fsi_8cc_source.html#l00055">unstructured_two_d_fsi.cc:55</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_adbd1f040f375c96fe56b3f475f7dbec2"><div class="ttname"><a href="namespaceGlobal__Parameters.html#adbd1f040f375c96fe56b3f475f7dbec2">Global_Parameters::Constitutive_law_pt</a></div><div class="ttdeci">ConstitutiveLaw * Constitutive_law_pt</div><div class="ttdoc">Constitutive law for the solid (and pseudo-solid) mechanics.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__two__d__fsi_8cc_source.html#l00067">unstructured_two_d_fsi.cc:67</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a9d72e94a9305c6a310940a6a427ebe06"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a9d72e94a9305c6a310940a6a427ebe06">Global_Parameters::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__two__d__fsi_8cc_source.html#l00046">unstructured_two_d_fsi.cc:46</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a335000b5db4206486a116ae0468d2d0c"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a335000b5db4206486a116ae0468d2d0c">Global_Parameters::Gravity</a></div><div class="ttdeci">double Gravity</div><div class="ttdoc">Non-dim gravity.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__two__d__fsi_8cc_source.html#l00052">unstructured_two_d_fsi.cc:52</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 16 2021 19:48:06
        </div>
      </div>
    </footer>
</body>
</html>

\hypertarget{unstructured__two__d__fsi_8cc_source}{}\doxysection{unstructured\+\_\+two\+\_\+d\+\_\+fsi.\+cc}
\label{unstructured__two__d__fsi_8cc_source}\index{unstructured\_two\_d\_fsi.cc@{unstructured\_two\_d\_fsi.cc}}
\mbox{\hyperlink{unstructured__two__d__fsi_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00001}00001 \textcolor{comment}{//LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00002}00002 \textcolor{comment}{//LIC// This file forms part of oomph-\/lib, the object-\/oriented, }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00003}00003 \textcolor{comment}{//LIC// multi-\/physics finite-\/element library, available }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00004}00004 \textcolor{comment}{//LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00005}00005 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00006}00006 \textcolor{comment}{//LIC// Copyright (C) 2006-\/2022 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00007}00007 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00008}00008 \textcolor{comment}{//LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00009}00009 \textcolor{comment}{//LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00010}00010 \textcolor{comment}{//LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00011}00011 \textcolor{comment}{//LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00012}00012 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00013}00013 \textcolor{comment}{//LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00014}00014 \textcolor{comment}{//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00015}00015 \textcolor{comment}{//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00016}00016 \textcolor{comment}{//LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00017}00017 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00018}00018 \textcolor{comment}{//LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00019}00019 \textcolor{comment}{//LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00020}00020 \textcolor{comment}{//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00021}00021 \textcolor{comment}{//LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00022}00022 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00023}00023 \textcolor{comment}{//LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00024}00024 \textcolor{comment}{//LIC// }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00025}00025 \textcolor{comment}{//LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00026}00026 \textcolor{comment}{//Driver for fsi on unstructured mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00028}00028 \textcolor{comment}{//Generic includes}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00029}00029 \textcolor{preprocessor}{\#include "{}generic.h"{}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00030}00030 \textcolor{preprocessor}{\#include "{}navier\_stokes.h"{}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00031}00031 \textcolor{preprocessor}{\#include "{}solid.h"{}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00032}00032 \textcolor{preprocessor}{\#include "{}constitutive.h"{}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00034}00034 \textcolor{comment}{// The meshes}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00035}00035 \textcolor{preprocessor}{\#include "{}meshes/triangle\_mesh.h"{}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00037}00037 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00038}00038 \textcolor{keyword}{using namespace }oomph; }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00039}00039 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00040}00040 \textcolor{comment}{//==start\_of\_namespace==============================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00041}00041 \textcolor{comment}{/// Namespace for physical parameters}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00042}00042 \textcolor{comment}{}\textcolor{comment}{//==================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00043}\mbox{\hyperlink{namespaceGlobal__Parameters}{00043}} \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceGlobal__Parameters}{Global\_Parameters}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00044}00044 \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00045}00045 \textcolor{comment}{ /// Reynolds number}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00046}\mbox{\hyperlink{namespaceGlobal__Parameters_a9d72e94a9305c6a310940a6a427ebe06}{00046}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceGlobal__Parameters_a9d72e94a9305c6a310940a6a427ebe06}{Re}}=0.0; }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00047}00047 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00048}00048 \textcolor{comment}{ /// FSI parameter}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00049}\mbox{\hyperlink{namespaceGlobal__Parameters_a7814fddf663e56168174a42d2cd6b4c1}{00049}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceGlobal__Parameters_a7814fddf663e56168174a42d2cd6b4c1}{Q}}=0.0;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00050}00050 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00051}00051 \textcolor{comment}{ /// Non-\/dim gravity}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00052}\mbox{\hyperlink{namespaceGlobal__Parameters_a335000b5db4206486a116ae0468d2d0c}{00052}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceGlobal__Parameters_a335000b5db4206486a116ae0468d2d0c}{Gravity}}=0.0;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00053}00053 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00054}00054 \textcolor{comment}{ /// Non-\/dimensional gravity as body force}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00055}\mbox{\hyperlink{namespaceGlobal__Parameters_a200109847bf4cc26da4d00e8d68d569e}{00055}} \textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceGlobal__Parameters_a200109847bf4cc26da4d00e8d68d569e}{gravity}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& time, }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00056}00056               \textcolor{keyword}{const} Vector<double> \&xi, }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00057}00057               Vector<double> \&b)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00058}00058  \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00059}00059   b[0]=0.0;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00060}00060   b[1]=-\/\mbox{\hyperlink{namespaceGlobal__Parameters_a335000b5db4206486a116ae0468d2d0c}{Gravity}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00061}00061  \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00062}00062 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00063}00063 \textcolor{comment}{ /// Pseudo-\/solid Poisson ratio}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00064}\mbox{\hyperlink{namespaceGlobal__Parameters_a20fccdcfa2c15ad8b951b9ada3bb1661}{00064}} \textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceGlobal__Parameters_a20fccdcfa2c15ad8b951b9ada3bb1661}{Nu}}=0.3;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00065}00065 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00066}00066 \textcolor{comment}{ /// Constitutive law for the solid (and pseudo-\/solid) mechanics}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00067}\mbox{\hyperlink{namespaceGlobal__Parameters_adbd1f040f375c96fe56b3f475f7dbec2}{00067}} \textcolor{comment}{} ConstitutiveLaw *\mbox{\hyperlink{namespaceGlobal__Parameters_adbd1f040f375c96fe56b3f475f7dbec2}{Constitutive\_law\_pt}}=0;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00068}00068 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00069}00069 \textcolor{comment}{ /// Boolean to identify if node is on fsi boundary}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00070}\mbox{\hyperlink{namespaceGlobal__Parameters_a655abf819eb3045dac883f2b7073ba22}{00070}} \textcolor{comment}{} \textcolor{keywordtype}{bool} \mbox{\hyperlink{namespaceGlobal__Parameters_a655abf819eb3045dac883f2b7073ba22}{is\_on\_fsi\_boundary}}(Node* nod\_pt)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00071}00071  \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00072}00072   \textcolor{keywordflow}{if} (}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00073}00073    (}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00074}00074     \textcolor{comment}{// Is it a boundary node?}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00075}00075     \textcolor{keyword}{dynamic\_cast<}BoundaryNodeBase*\textcolor{keyword}{>}(nod\_pt)!=0)\&\&}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00076}00076    (}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00077}00077     \textcolor{comment}{// Horizontal extent of main immersed obstacle}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00078}00078     (  (nod\_pt-\/>x(0)>1.6)\&\&(nod\_pt-\/>x(0)<4.75)\&\&}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00079}00079        \textcolor{comment}{// Vertical extent of main immersed obstacle}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00080}00080        (nod\_pt-\/>x(1)>0.1125)\&\&(nod\_pt-\/>x(1)<2.8) ) ||}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00081}00081     \textcolor{comment}{// Two nodes on the bottom wall are below y=0.3}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00082}00082     (  (nod\_pt-\/>x(1)<0.3)\&\&}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00083}00083        \textcolor{comment}{// ...and bracketed in these two x-\/ranges}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00084}00084        (  ( (nod\_pt-\/>x(0)>3.0)\&\&(nod\_pt-\/>x(0)<3.1) ) ||}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00085}00085           ( (nod\_pt-\/>x(0)<4.6)\&\&(nod\_pt-\/>x(0)>4.5) )   ) }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00086}00086      )}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00087}00087     )}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00088}00088    )}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00089}00089    \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00090}00090     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00091}00091    \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00092}00092   \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00093}00093    \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00094}00094     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00095}00095    \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00096}00096  \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00097}00097 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00098}00098 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00099}00099 \} \textcolor{comment}{// end\_of\_namespace}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00102}00102 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00103}00103 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00104}00104 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00105}00105 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00106}00106 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00108}00108 \textcolor{comment}{//========start\_solid\_mesh=================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00109}00109 \textcolor{comment}{/// Triangle-\/based mesh upgraded to become a solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00110}00110 \textcolor{comment}{}\textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00111}00111 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00112}\mbox{\hyperlink{classMySolidTriangleMesh}{00112}} \textcolor{keyword}{class }\mbox{\hyperlink{classMySolidTriangleMesh}{MySolidTriangleMesh}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} TriangleMesh<ELEMENT>, }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00113}00113                           \textcolor{keyword}{public} \textcolor{keyword}{virtual} SolidMesh }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00114}00114 \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00115}00115  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00116}00116 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00117}00117  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00118}00118 \textcolor{comment}{ /// Constructor: }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00119}\mbox{\hyperlink{classMySolidTriangleMesh_a13939dc0593c5707c0099e3586161ce6}{00119}} \textcolor{comment}{} \mbox{\hyperlink{classMySolidTriangleMesh_a13939dc0593c5707c0099e3586161ce6}{MySolidTriangleMesh}}(\textcolor{keyword}{const} std::string\& node\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00120}00120                      \textcolor{keyword}{const} std::string\& element\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00121}00121                      \textcolor{keyword}{const} std::string\& poly\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00122}00122                      TimeStepper* time\_stepper\_pt=}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00123}00123                      \&Mesh::Default\_TimeStepper) :}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00124}00124   TriangleMesh<ELEMENT>(node\_file\_name,element\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00125}00125                         poly\_file\_name, time\_stepper\_pt)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00126}00126   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00127}00127    \textcolor{comment}{//Assign the Lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00128}00128    set\_lagrangian\_nodal\_coordinates();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00130}00130    \textcolor{comment}{// Identify special boundaries}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00131}00131    set\_nboundary(3);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00132}00132 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00133}00133    \textcolor{keywordtype}{unsigned} n\_node=this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00134}00134    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<n\_node;j++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00135}00135     \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00136}00136      Node* nod\_pt=this-\/>node\_pt(j);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00138}00138      \textcolor{comment}{// Boundary 1 is lower boundary}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00139}00139      \textcolor{keywordflow}{if} (nod\_pt-\/>x(1)<0.15)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00140}00140       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00141}00141        this-\/>remove\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00142}00142        this-\/>add\_boundary\_node(1,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00143}00143       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00145}00145      \textcolor{comment}{// Boundary 2 is FSI interface}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00146}00146      \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceGlobal__Parameters_a655abf819eb3045dac883f2b7073ba22}{Global\_Parameters::is\_on\_fsi\_boundary}}(nod\_pt))}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00147}00147       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00148}00148        this-\/>remove\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00149}00149        this-\/>add\_boundary\_node(2,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00150}00150       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00151}00151     \}\textcolor{comment}{// done boundary assignment}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00152}00152 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00153}00153    \textcolor{comment}{// Identify the elements next to the newly created boundaries}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00154}00154    TriangleMesh<ELEMENT>::setup\_boundary\_element\_info();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00155}00155    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00156}00156    \textcolor{comment}{// Setup boundary coordinates for boundaries 1 and 2}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00157}00157    this-\/>\textcolor{keyword}{template} setup\_boundary\_coordinates<ELEMENT>(1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00158}00158    this-\/>\textcolor{keyword}{template} setup\_boundary\_coordinates<ELEMENT>(2);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00159}00159   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00160}00160  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00161}00161 \textcolor{comment}{ /// Empty Destructor}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00162}\mbox{\hyperlink{classMySolidTriangleMesh_a46ef4b04ede9bdeb053c25dbb742806a}{00162}} \textcolor{comment}{} \textcolor{keyword}{virtual} \mbox{\hyperlink{classMySolidTriangleMesh_a46ef4b04ede9bdeb053c25dbb742806a}{\string~MySolidTriangleMesh}}() \{ \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00163}00163 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00164}00164 \};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00166}00166 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00167}00167 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00168}00168 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00169}00169 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00170}00170 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00171}00171 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00172}00172 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00174}00174 \textcolor{comment}{//======================start\_fluid\_mesh===================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00175}00175 \textcolor{comment}{/// Triangle-\/based mesh upgraded to become a pseudo-\/solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00176}00176 \textcolor{comment}{}\textcolor{comment}{//=========================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00177}00177 \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00178}\mbox{\hyperlink{classFluidTriangleMesh}{00178}} \textcolor{keyword}{class }\mbox{\hyperlink{classFluidTriangleMesh}{FluidTriangleMesh}} : \textcolor{keyword}{public} \textcolor{keyword}{virtual} TriangleMesh<ELEMENT>,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00179}00179                           \textcolor{keyword}{public} \textcolor{keyword}{virtual} SolidMesh }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00180}00180 \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00181}00181  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00182}00182 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00183}00183  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00184}00184 \textcolor{comment}{ /// Constructor}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00185}\mbox{\hyperlink{classFluidTriangleMesh_ab86c8fd8ee699923f5a4b199981d8c76}{00185}} \textcolor{comment}{} \mbox{\hyperlink{classFluidTriangleMesh_ab86c8fd8ee699923f5a4b199981d8c76}{FluidTriangleMesh}}(\textcolor{keyword}{const} std::string\& node\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00186}00186                    \textcolor{keyword}{const} std::string\& element\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00187}00187                    \textcolor{keyword}{const} std::string\& poly\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00188}00188                    TimeStepper* time\_stepper\_pt=}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00189}00189                    \&Mesh::Default\_TimeStepper) :}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00190}00190   TriangleMesh<ELEMENT>(node\_file\_name,element\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00191}00191                         poly\_file\_name, time\_stepper\_pt)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00192}00192   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00193}00193    \textcolor{comment}{//Assign the Lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00194}00194    set\_lagrangian\_nodal\_coordinates();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00196}00196    \textcolor{comment}{// Identify special boundaries}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00197}00197    this-\/>set\_nboundary(4);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00198}00198 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00199}00199    \textcolor{keywordtype}{unsigned} n\_node=this-\/>nnode();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00200}00200    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<n\_node;j++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00201}00201     \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00202}00202      Node* nod\_pt=this-\/>node\_pt(j);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00204}00204      \textcolor{comment}{// Boundary 1 is left (inflow) boundary}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00205}00205      \textcolor{keywordflow}{if} (nod\_pt-\/>x(0)<0.226)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00206}00206       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00207}00207        this-\/>remove\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00208}00208        this-\/>add\_boundary\_node(1,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00209}00209 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00210}00210        \textcolor{comment}{// Add overlapping nodes back to boundary 0}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00211}00211        \textcolor{keywordflow}{if} (nod\_pt-\/>x(1)<0.2) this-\/>add\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00212}00212        \textcolor{keywordflow}{if} (nod\_pt-\/>x(1)>4.06) this-\/>add\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00213}00213       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00214}00214 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00215}00215      \textcolor{comment}{// Boundary 2 is right (outflow) boundary}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00216}00216      \textcolor{keywordflow}{if} (nod\_pt-\/>x(0)>8.28)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00217}00217       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00218}00218        this-\/>remove\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00219}00219        this-\/>add\_boundary\_node(2,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00220}00220 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00221}00221        \textcolor{comment}{// Add overlapping nodes back to boundary 0}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00222}00222        \textcolor{keywordflow}{if} (nod\_pt-\/>x(1)<0.2) this-\/>add\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00223}00223        \textcolor{keywordflow}{if} (nod\_pt-\/>x(1)>4.06) this-\/>add\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00225}00225       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00226}00226 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00227}00227      \textcolor{comment}{// Boundary 3 is FSI boundary}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00228}00228      \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceGlobal__Parameters_a655abf819eb3045dac883f2b7073ba22}{Global\_Parameters::is\_on\_fsi\_boundary}}(nod\_pt))}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00229}00229       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00230}00230        this-\/>remove\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00231}00231        this-\/>add\_boundary\_node(3,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00232}00232        }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00233}00233        \textcolor{comment}{//If it's below y=0.2 it's also on boundary 0 so stick it back on}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00234}00234        \textcolor{keywordflow}{if} (nod\_pt-\/>x(1)<0.2) this-\/>add\_boundary\_node(0,nod\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00235}00235       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00236}00236     \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00237}00237    TriangleMesh<ELEMENT>::setup\_boundary\_element\_info();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00238}00238    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00239}00239    \textcolor{comment}{// Open a file to doc the FaceElements that are used to}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00240}00240    \textcolor{comment}{// create the boundary coordinates. The elements must}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00241}00241    \textcolor{comment}{// form a simply-\/connected line. This may not work}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00242}00242    \textcolor{comment}{// if the mesh is too coarse so that, e.g. an element}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00243}00243    \textcolor{comment}{// that goes through the interior has endpoints that are}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00244}00244    \textcolor{comment}{// both located on the same boundary. Outputting the}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00245}00245    \textcolor{comment}{// FaceElements can help identify such cases.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00246}00246    ofstream some\_file(\textcolor{stringliteral}{"{}RESLT/boundary\_generation\_test.dat"{}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00247}00247    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00248}00248    \textcolor{comment}{// Setup boundary coordinates for boundaries 1, 2 and 3}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00249}00249    this-\/>\textcolor{keyword}{template} setup\_boundary\_coordinates<ELEMENT>(1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00250}00250    this-\/>\textcolor{keyword}{template} setup\_boundary\_coordinates<ELEMENT>(2);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00251}00251    this-\/>\textcolor{keyword}{template} setup\_boundary\_coordinates<ELEMENT>(3,some\_file);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00253}00253    \textcolor{comment}{// Close it again}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00254}00254    some\_file.close();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00255}00255   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00256}00256  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00257}00257 \textcolor{comment}{ /// Empty Destructor}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00258}\mbox{\hyperlink{classFluidTriangleMesh_adc38a903db4d9438e3cce8608f89be83}{00258}} \textcolor{comment}{} \textcolor{keyword}{virtual} \mbox{\hyperlink{classFluidTriangleMesh_adc38a903db4d9438e3cce8608f89be83}{\string~FluidTriangleMesh}}() \{ \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00259}00259 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00260}00260 \};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00261}00261 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00262}00262 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00263}00263 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00264}00264 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00265}00265 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00266}00266 \textcolor{comment}{/// ////////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00267}00267 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00269}00269 \textcolor{comment}{//==start\_of\_problem\_class============================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00270}00270 \textcolor{comment}{/// Unstructured FSI Problem}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00271}00271 \textcolor{comment}{}\textcolor{comment}{//====================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00272}00272 \textcolor{keyword}{template}<\textcolor{keyword}{class} FLUID\_ELEMENT, \textcolor{keyword}{class} SOLID\_ELEMENT>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00273}\mbox{\hyperlink{classUnstructuredFSIProblem}{00273}} \textcolor{keyword}{class }\mbox{\hyperlink{classUnstructuredFSIProblem}{UnstructuredFSIProblem}} : \textcolor{keyword}{public} Problem}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00274}00274 \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00275}00275 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00276}00276 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00277}00277 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00278}00278 \textcolor{comment}{ /// Constructor}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00279}00279 \textcolor{comment}{} \mbox{\hyperlink{classUnstructuredFSIProblem}{UnstructuredFSIProblem}}();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00280}00280 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00281}00281 \textcolor{comment}{ /// Destructor (empty)}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00282}\mbox{\hyperlink{classUnstructuredFSIProblem_a976a81e0dee902f6713bd8ca4d79d000}{00282}} \textcolor{comment}{} \mbox{\hyperlink{classUnstructuredFSIProblem_a976a81e0dee902f6713bd8ca4d79d000}{\string~UnstructuredFSIProblem}}()\{\}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00283}00283 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00284}00284 \textcolor{comment}{ /// Access function for the fluid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00285}\mbox{\hyperlink{classUnstructuredFSIProblem_a920c8629e5516bf916edd340d445100f}{00285}} \textcolor{comment}{} \mbox{\hyperlink{classFluidTriangleMesh}{FluidTriangleMesh<FLUID\_ELEMENT>}}*\& \mbox{\hyperlink{classUnstructuredFSIProblem_a920c8629e5516bf916edd340d445100f}{fluid\_mesh\_pt}}() }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00286}00286   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00287}00287    \textcolor{keywordflow}{return} Fluid\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00288}00288   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00289}00289 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00290}00290 \textcolor{comment}{ /// Access function for the solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00291}\mbox{\hyperlink{classUnstructuredFSIProblem_a3aeaaac80eca8d12a97bd7d268bccdb0}{00291}} \textcolor{comment}{} \mbox{\hyperlink{classMySolidTriangleMesh}{MySolidTriangleMesh<SOLID\_ELEMENT>}}*\& \mbox{\hyperlink{classUnstructuredFSIProblem_a3aeaaac80eca8d12a97bd7d268bccdb0}{solid\_mesh\_pt}}() }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00292}00292   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00293}00293    \textcolor{keywordflow}{return} Solid\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00294}00294   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00295}00295 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00296}00296 \textcolor{comment}{ /// Doc the solution}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00297}00297 \textcolor{comment}{} \textcolor{keywordtype}{void} doc\_solution(DocInfo\& doc\_info);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00298}00298 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00299}00299 \textcolor{keyword}{private}:}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00300}00300 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00301}00301 \textcolor{comment}{ /// Create FSI traction elements}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00302}00302 \textcolor{comment}{} \textcolor{keywordtype}{void} create\_fsi\_traction\_elements();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00303}00303 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00304}00304 \textcolor{comment}{ /// Create elements that enforce prescribed boundary motion}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00305}00305 \textcolor{comment}{ /// for the pseudo-\/solid fluid mesh by Lagrange multipliers}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00306}00306 \textcolor{comment}{} \textcolor{keywordtype}{void} create\_lagrange\_multiplier\_elements();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00307}00307 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00308}00308 \textcolor{comment}{ /// Sanity check: Doc boundary coordinates from solid side}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00309}00309 \textcolor{comment}{} \textcolor{keywordtype}{void} doc\_solid\_boundary\_coordinates();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00310}00310  \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00311}00311 \textcolor{comment}{ /// Fluid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00312}\mbox{\hyperlink{classUnstructuredFSIProblem_a33c3b4cd9923f8b25368ff20e4810b2c}{00312}} \textcolor{comment}{} \mbox{\hyperlink{classFluidTriangleMesh}{FluidTriangleMesh<FLUID\_ELEMENT>}}* \mbox{\hyperlink{classUnstructuredFSIProblem_a33c3b4cd9923f8b25368ff20e4810b2c}{Fluid\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00313}00313 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00314}00314 \textcolor{comment}{ /// Solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00315}\mbox{\hyperlink{classUnstructuredFSIProblem_aeb164665366e237ca311e448466d7c9d}{00315}} \textcolor{comment}{} \mbox{\hyperlink{classMySolidTriangleMesh}{MySolidTriangleMesh<SOLID\_ELEMENT>}}* \mbox{\hyperlink{classUnstructuredFSIProblem_aeb164665366e237ca311e448466d7c9d}{Solid\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00316}00316 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00317}00317 \textcolor{comment}{ /// Pointers to mesh of Lagrange multiplier elements}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00318}\mbox{\hyperlink{classUnstructuredFSIProblem_ab30c2bc8de791e91d0bba19b048b5219}{00318}} \textcolor{comment}{} SolidMesh* \mbox{\hyperlink{classUnstructuredFSIProblem_ab30c2bc8de791e91d0bba19b048b5219}{Lagrange\_multiplier\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00319}00319 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00320}00320 \textcolor{comment}{ /// Vector of pointers to mesh of FSI traction elements}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00321}\mbox{\hyperlink{classUnstructuredFSIProblem_ab7ada68f864e990b7b5e40000c289aa1}{00321}} \textcolor{comment}{} SolidMesh* \mbox{\hyperlink{classUnstructuredFSIProblem_ab7ada68f864e990b7b5e40000c289aa1}{Traction\_mesh\_pt}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00322}00322 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00323}00323 \textcolor{comment}{ /// GeomObject incarnation of fsi boundary in solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00324}00324 \textcolor{comment}{} MeshAsGeomObject* }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00325}\mbox{\hyperlink{classUnstructuredFSIProblem_aa7471e8fb88098faa147e1162480feff}{00325}}  \mbox{\hyperlink{classUnstructuredFSIProblem_aa7471e8fb88098faa147e1162480feff}{Solid\_fsi\_boundary\_pt}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00327}00327 \}; }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00328}00328 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00329}00329 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00330}00330 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00331}00331 \textcolor{comment}{//==start\_of\_constructor==================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00332}00332 \textcolor{comment}{/// Constructor for unstructured FSI problem.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00333}00333 \textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00334}00334 \textcolor{keyword}{template}<\textcolor{keyword}{class} FLUID\_ELEMENT, \textcolor{keyword}{class} SOLID\_ELEMENT>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00335}\mbox{\hyperlink{classUnstructuredFSIProblem_a6a31fd839e0215ef1312942cf7284bd2}{00335}} \mbox{\hyperlink{classUnstructuredFSIProblem_a6a31fd839e0215ef1312942cf7284bd2}{UnstructuredFSIProblem<FLUID\_ELEMENT,SOLID\_ELEMENT>::UnstructuredFSIProblem}}()}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00336}00336 \{ }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00337}00337 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00338}00338  \textcolor{comment}{// Fluid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00339}00339  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00340}00340 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00341}00341  \textcolor{comment}{//Create fluid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00342}00342  \textcolor{keywordtype}{string} fluid\_node\_file\_name=\textcolor{stringliteral}{"{}fluid.fig.1.node"{}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00343}00343  \textcolor{keywordtype}{string} fluid\_element\_file\_name=\textcolor{stringliteral}{"{}fluid.fig.1.ele"{}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00344}00344  \textcolor{keywordtype}{string} fluid\_poly\_file\_name=\textcolor{stringliteral}{"{}fluid.fig.1.poly"{}}; }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00345}00345  Fluid\_mesh\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classFluidTriangleMesh}{FluidTriangleMesh<FLUID\_ELEMENT>}}(fluid\_node\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00346}00346                                                       fluid\_element\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00347}00347                                                       fluid\_poly\_file\_name);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00348}00348  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00349}00349  \textcolor{comment}{// Doc pinned solid nodes}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00350}00350  std::ofstream pseudo\_solid\_bc\_file(\textcolor{stringliteral}{"{}pinned\_pseudo\_solid\_nodes.dat"{}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00351}00351 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00352}00352  \textcolor{comment}{// Set the boundary conditions for fluid problem: All nodes are}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00353}00353  \textcolor{comment}{// free by default -\/-\/ just pin the ones that have Dirichlet conditions}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00354}00354  \textcolor{comment}{// here. }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00355}00355  \textcolor{keywordtype}{unsigned} nbound=Fluid\_mesh\_pt-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00356}00356  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} ibound=0;ibound<nbound;ibound++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00357}00357   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00358}00358    \textcolor{keywordtype}{unsigned} num\_nod=Fluid\_mesh\_pt-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00359}00359    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00360}00360     \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00361}00361      \textcolor{comment}{// Pin velocity everywhere apart from outlet where we}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00362}00362      \textcolor{comment}{// have parallel outflow}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00363}00363      \textcolor{keywordflow}{if} (ibound!=2)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00364}00364       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00365}00365        Fluid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod)-\/>pin(0); }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00366}00366       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00367}00367      Fluid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod)-\/>pin(1); }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00368}00368 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00369}00369      \textcolor{comment}{// Pin pseudo-\/solid positions everywhere apart from boundary 3, }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00370}00370      \textcolor{comment}{// the fsi boundary }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00371}00371      \textcolor{keywordflow}{if} ((ibound==0)||(ibound==1)||(ibound==2))}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00372}00372       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00373}00373        \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<2;i++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00374}00374         \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00375}00375          \textcolor{comment}{// Pin the node}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00376}00376          SolidNode* nod\_pt=Fluid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00377}00377          nod\_pt-\/>pin\_position(i);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00378}00378 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00379}00379          \textcolor{comment}{// Doc it as pinned}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00380}00380          pseudo\_solid\_bc\_file << nod\_pt-\/>x(i) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00381}00381         \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00382}00382        pseudo\_solid\_bc\_file << std::endl;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00383}00383       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00384}00384     \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00385}00385   \} \textcolor{comment}{// end loop over boundaries}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00386}00386 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00387}00387  \textcolor{comment}{// Close}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00388}00388  pseudo\_solid\_bc\_file.close();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00389}00389 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00390}00390  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00391}00391  \textcolor{comment}{// Complete the build of the fluid elements so they are fully functional}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00392}00392  \textcolor{keywordtype}{unsigned} n\_element = Fluid\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00393}00393  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00394}00394   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00395}00395    \textcolor{comment}{// Upcast from GeneralisedElement to the present element}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00396}00396    FLUID\_ELEMENT* el\_pt = }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00397}00397     \textcolor{keyword}{dynamic\_cast<}FLUID\_ELEMENT*\textcolor{keyword}{>}(Fluid\_mesh\_pt-\/>element\_pt(e));}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00398}00398    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00399}00399    \textcolor{comment}{//Set the Reynolds number}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00400}00400    el\_pt-\/>re\_pt() = \&\mbox{\hyperlink{namespaceGlobal__Parameters_a9d72e94a9305c6a310940a6a427ebe06}{Global\_Parameters::Re}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00401}00401    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00402}00402    \textcolor{comment}{// Set the constitutive law for pseudo-\/elastic mesh deformation}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00403}00403    el\_pt-\/>constitutive\_law\_pt() =}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00404}00404     \mbox{\hyperlink{namespaceGlobal__Parameters_adbd1f040f375c96fe56b3f475f7dbec2}{Global\_Parameters::Constitutive\_law\_pt}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00405}00405    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00406}00406   \} \textcolor{comment}{// end loop over elements}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00408}00408 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00409}00409  \textcolor{comment}{// Apply fluid boundary conditions: Poiseuille at inflow}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00410}00410 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00411}00411  \textcolor{comment}{// Find max. and min y-\/coordinate at inflow}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00412}00412  \textcolor{keywordtype}{unsigned} ibound=1;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00413}00413  \textcolor{comment}{//Initialise both to the y-\/coordinate of the first boundary node}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00414}00414  \textcolor{keywordtype}{double} y\_min=fluid\_mesh\_pt()-\/>boundary\_node\_pt(ibound,0)-\/>x(1);;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00415}00415  \textcolor{keywordtype}{double} y\_max=y\_min;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00416}00416 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00417}00417  \textcolor{comment}{//Loop over the rest of the boundary nodes}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00418}00418  \textcolor{keywordtype}{unsigned} num\_nod= fluid\_mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00419}00419  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=1;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00420}00420   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00421}00421    \textcolor{keywordtype}{double} y=fluid\_mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>x(1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00422}00422    \textcolor{keywordflow}{if} (y>y\_max)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00423}00423     \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00424}00424      y\_max=y;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00425}00425     \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00426}00426    \textcolor{keywordflow}{if} (y<y\_min)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00427}00427     \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00428}00428      y\_min=y;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00429}00429     \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00430}00430   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00431}00431  \textcolor{keywordtype}{double} y\_mid=0.5*(y\_min+y\_max);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00432}00432  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00433}00433  \textcolor{comment}{// Loop over all boundaries}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00434}00434  \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_boundary = fluid\_mesh\_pt()-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00435}00435  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ibound=0;ibound<n\_boundary;ibound++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00436}00436   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00437}00437    \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} num\_nod= fluid\_mesh\_pt()-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00438}00438    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00439}00439     \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00440}00440      \textcolor{comment}{// Parabolic inflow at the left boundary (boundary 1)}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00441}00441      \textcolor{keywordflow}{if} (ibound==1)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00442}00442       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00443}00443        \textcolor{keywordtype}{double} y=fluid\_mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>x(1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00444}00444        \textcolor{keywordtype}{double} veloc=1.5/(y\_max-\/y\_min)*}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00445}00445         (y-\/y\_min)*(y\_max-\/y)/((y\_mid-\/y\_min)*(y\_max-\/y\_mid));}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00446}00446        fluid\_mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>set\_value(0,veloc);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00447}00447        fluid\_mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>set\_value(1,0.0);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00448}00448       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00449}00449      \textcolor{comment}{// Zero flow elsewhere }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00450}00450      \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00451}00451       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00452}00452        fluid\_mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>set\_value(0,0.0);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00453}00453        fluid\_mesh\_pt()-\/>boundary\_node\_pt(ibound,inod)-\/>set\_value(1,0.0);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00454}00454       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00455}00455     \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00456}00456   \} \textcolor{comment}{// end Poiseuille}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00457}00457  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00458}00458  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00459}00459  \textcolor{comment}{// Solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00460}00460  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00461}00461  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00462}00462  \textcolor{comment}{//Create solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00463}00463  \textcolor{keywordtype}{string} solid\_node\_file\_name=\textcolor{stringliteral}{"{}solid.fig.1.node"{}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00464}00464  \textcolor{keywordtype}{string} solid\_element\_file\_name=\textcolor{stringliteral}{"{}solid.fig.1.ele"{}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00465}00465  \textcolor{keywordtype}{string} solid\_poly\_file\_name=\textcolor{stringliteral}{"{}solid.fig.1.poly"{}}; }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00466}00466  Solid\_mesh\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classMySolidTriangleMesh}{MySolidTriangleMesh<SOLID\_ELEMENT>}}(solid\_node\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00467}00467                                                      solid\_element\_file\_name,}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00468}00468                                                      solid\_poly\_file\_name);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00469}00469 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00470}00470  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00471}00471  \textcolor{comment}{// Complete the build of all solid elements so they are fully functional}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00472}00472  n\_element = Solid\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00473}00473  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_element;i++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00474}00474   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00475}00475    \textcolor{comment}{//Cast to a solid element}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00476}00476    SOLID\_ELEMENT *el\_pt = }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00477}00477     \textcolor{keyword}{dynamic\_cast<}SOLID\_ELEMENT*\textcolor{keyword}{>}(Solid\_mesh\_pt-\/>element\_pt(i));}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00479}00479    \textcolor{comment}{// Set the constitutive law}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00480}00480    el\_pt-\/>constitutive\_law\_pt() =}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00481}00481     \mbox{\hyperlink{namespaceGlobal__Parameters_adbd1f040f375c96fe56b3f475f7dbec2}{Global\_Parameters::Constitutive\_law\_pt}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00482}00482    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00483}00483    \textcolor{comment}{//Set the body force}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00484}00484    el\_pt-\/>body\_force\_fct\_pt() = \mbox{\hyperlink{namespaceGlobal__Parameters_a200109847bf4cc26da4d00e8d68d569e}{Global\_Parameters::gravity}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00485}00485   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00486}00486  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00487}00487  \textcolor{comment}{// Pin both positions at lower boundary of solid mesh (boundary 1)}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00488}00488  ibound=1;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00489}00489  num\_nod=Solid\_mesh\_pt-\/>nboundary\_node(ibound);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00490}00490  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} inod=0;inod<num\_nod;inod++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00491}00491   \{    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00492}00492    Solid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod)-\/>pin\_position(0);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00493}00493    Solid\_mesh\_pt-\/>boundary\_node\_pt(ibound,inod)-\/>pin\_position(1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00494}00494   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00495}00495 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00496}00496 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00497}00497  \textcolor{comment}{// Create FSI Traction elements}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00498}00498  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00499}00499 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00500}00500  \textcolor{comment}{// Now construct the (empty) traction element mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00501}00501  Traction\_mesh\_pt=\textcolor{keyword}{new} SolidMesh;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00502}00502 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00503}00503   \textcolor{comment}{// Build the FSI traction elements and add them to the traction mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00504}00504  create\_fsi\_traction\_elements();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00505}00505 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00506}00506  \textcolor{comment}{// Create Lagrange multiplier mesh for boundary motion}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00507}00507  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00508}00508  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00509}00509  \textcolor{comment}{// Construct the mesh of elements that enforce prescribed boundary motion}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00510}00510  \textcolor{comment}{// of pseudo-\/solid fluid mesh by Lagrange multipliers}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00511}00511  Lagrange\_multiplier\_mesh\_pt=\textcolor{keyword}{new} SolidMesh;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00512}00512  create\_lagrange\_multiplier\_elements();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00514}00514 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00515}00515  \textcolor{comment}{// Combine meshes}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00516}00516  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00517}00517 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00518}00518  \textcolor{comment}{// Add sub meshes}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00519}00519  add\_sub\_mesh(Fluid\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00520}00520  add\_sub\_mesh(Solid\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00521}00521  add\_sub\_mesh(Traction\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00522}00522  add\_sub\_mesh(Lagrange\_multiplier\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00523}00523  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00524}00524  \textcolor{comment}{// Build global mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00525}00525  build\_global\_mesh();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00526}00526 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00528}00528  \textcolor{comment}{// Setup FSI}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00529}00529  \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00530}00530 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00531}00531  \textcolor{comment}{// Document the boundary coordinate  along the FSI interface }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00532}00532  \textcolor{comment}{// of the fluid mesh during call to}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00533}00533  \textcolor{comment}{// setup\_fluid\_load\_info\_for\_solid\_elements()}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00534}00534  Multi\_domain\_functions::Doc\_boundary\_coordinate\_file.open(}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00535}00535   \textcolor{stringliteral}{"{}fluid\_boundary\_test.dat"{}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00537}00537  \textcolor{comment}{// Work out which fluid dofs affect the residuals of the wall elements:}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00538}00538  \textcolor{comment}{// We pass the boundary between the fluid and solid meshes and }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00539}00539  \textcolor{comment}{// pointers to the meshes. The interaction boundary is boundary 3}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00540}00540  \textcolor{comment}{// of the 2D fluid mesh.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00541}00541  FSI\_functions::setup\_fluid\_load\_info\_for\_solid\_elements<FLUID\_ELEMENT,2>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00542}00542   (\textcolor{keyword}{this},3,Fluid\_mesh\_pt,Traction\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00543}00543  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00544}00544  \textcolor{comment}{// Close the doc file}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00545}00545  Multi\_domain\_functions::Doc\_boundary\_coordinate\_file.close();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00546}00546 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00547}00547  \textcolor{comment}{// Sanity check: Doc boundary coordinates from solid side}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00548}00548  doc\_solid\_boundary\_coordinates();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00549}00549 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00550}00550  \textcolor{comment}{// Setup equation numbering scheme}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00551}00551  cout <<\textcolor{stringliteral}{"{}Number of equations: "{}} << assign\_eqn\_numbers() << std::endl; }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00552}00552 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00553}00553 \} \textcolor{comment}{// end\_of\_constructor}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00554}00554 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00555}00555 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00556}00556 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00557}00557 \textcolor{comment}{//============start\_doc\_solid\_zeta=======================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00558}00558 \textcolor{comment}{/// Doc boundary coordinates in solid and plot GeomObject representation}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00559}00559 \textcolor{comment}{/// of FSI boundary.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00560}00560 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00561}00561 \textcolor{keyword}{template}<\textcolor{keyword}{class} FLUID\_ELEMENT,\textcolor{keyword}{class} SOLID\_ELEMENT>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00562}\mbox{\hyperlink{classUnstructuredFSIProblem_a6b86e58ba6cf2871a8e049dd91f6b8b9}{00562}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredFSIProblem_a6b86e58ba6cf2871a8e049dd91f6b8b9}{UnstructuredFSIProblem<FLUID\_ELEMENT,SOLID\_ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00563}00563 \mbox{\hyperlink{classUnstructuredFSIProblem_a6b86e58ba6cf2871a8e049dd91f6b8b9}{doc\_solid\_boundary\_coordinates}}()}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00564}00564 \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00565}00565 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00566}00566  \textcolor{comment}{// Doc boundary coordinates for fsi boundary in solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00567}00567  std::ofstream the\_file(\textcolor{stringliteral}{"{}solid\_boundary\_test.dat"{}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00569}00569  \textcolor{comment}{// Initialise max/min boundary coordinate}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00570}00570  \textcolor{keywordtype}{double} zeta\_min= 1.0e40;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00571}00571  \textcolor{keywordtype}{double} zeta\_max=-\/1.0e40;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00572}00572 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00573}00573  \textcolor{comment}{// Loop over FSI traction elements}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00574}00574  \textcolor{keywordtype}{unsigned} n\_face\_element = Traction\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00575}00575  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_face\_element;e++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00576}00576   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00577}00577    \textcolor{comment}{//Cast the element pointer}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00578}00578    FSISolidTractionElement<SOLID\_ELEMENT,2>* el\_pt=}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00579}00579     \textcolor{keyword}{dynamic\_cast<}FSISolidTractionElement<SOLID\_ELEMENT,2>*\textcolor{keyword}{>}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00580}00580     (Traction\_mesh\_pt-\/>element\_pt(e));}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00581}00581 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00582}00582    \textcolor{comment}{// Doc boundary coordinate}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00583}00583    Vector<double> s(1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00584}00584    Vector<double> zeta(1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00585}00585    Vector<double> x(2);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00586}00586    \textcolor{keywordtype}{unsigned} n\_plot=5;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00587}00587    the\_file << el\_pt-\/>tecplot\_zone\_string(n\_plot);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00588}00588    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00589}00589    \textcolor{comment}{// Loop over plot points}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00590}00590    \textcolor{keywordtype}{unsigned} num\_plot\_points=el\_pt-\/>nplot\_points(n\_plot);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00591}00591    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} iplot=0;iplot<num\_plot\_points;iplot++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00592}00592     \{         }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00593}00593      \textcolor{comment}{// Get local coordinates of plot point}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00594}00594      el\_pt-\/>get\_s\_plot(iplot,n\_plot,s);         }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00595}00595      el\_pt-\/>interpolated\_zeta(s,zeta);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00596}00596      el\_pt-\/>interpolated\_x(s,x);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00597}00597      \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<2;i++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00598}00598       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00599}00599        the\_file << x[i] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00600}00600       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00601}00601      the\_file << zeta[0] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00602}00602 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00603}00603      \textcolor{comment}{// Update max/min boundary coordinate}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00604}00604      \textcolor{keywordflow}{if} (zeta[0]<zeta\_min) zeta\_min=zeta[0];}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00605}00605      \textcolor{keywordflow}{if} (zeta[0]>zeta\_max) zeta\_max=zeta[0];}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00606}00606 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00607}00607      the\_file << std::endl;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00608}00608     \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00609}00609   \} }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00610}00610 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00611}00611  \textcolor{comment}{// Close doc file}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00612}00612  the\_file.close();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00613}00613 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00614}00614 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00615}00615  \textcolor{comment}{// Doc compound GeomObject}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00616}00616  the\_file.open(\textcolor{stringliteral}{"{}fsi\_geom\_object.dat"{}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00617}00617  \textcolor{keywordtype}{unsigned} nplot=10000;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00618}00618  Vector<double> zeta(1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00619}00619  Vector<double> r(2);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00620}00620  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<nplot;i++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00621}00621   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00622}00622    zeta[0]=zeta\_min+(zeta\_max-\/zeta\_min)*\textcolor{keywordtype}{double}(i)/double(nplot-\/1);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00623}00623    Solid\_fsi\_boundary\_pt-\/>position(zeta,r);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00624}00624    the\_file << r[0] << \textcolor{stringliteral}{"{} "{}} << r[1] << std::endl;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00625}00625   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00626}00626  the\_file.close();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00627}00627  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00628}00628 \} \textcolor{comment}{//end doc\_solid\_zeta}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00629}00629 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00630}00630 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00631}00631 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00632}00632 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00633}00633 \textcolor{comment}{//============start\_of\_create\_traction\_elements==========================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00634}00634 \textcolor{comment}{/// Create FSI traction elements }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00635}00635 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00636}00636 \textcolor{keyword}{template}<\textcolor{keyword}{class} FLUID\_ELEMENT,\textcolor{keyword}{class} SOLID\_ELEMENT>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00637}\mbox{\hyperlink{classUnstructuredFSIProblem_a934a587c99668fca969a72814b3142a7}{00637}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredFSIProblem_a934a587c99668fca969a72814b3142a7}{UnstructuredFSIProblem<FLUID\_ELEMENT,SOLID\_ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00638}00638 \mbox{\hyperlink{classUnstructuredFSIProblem_a934a587c99668fca969a72814b3142a7}{create\_fsi\_traction\_elements}}()}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00639}00639 \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00640}00640  \textcolor{comment}{// Traction elements are located on boundary 2 of solid bulk mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00641}00641  \textcolor{keywordtype}{unsigned} b=2;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00642}00642  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00643}00643  \textcolor{comment}{// How many bulk elements are adjacent to boundary b?}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00644}00644  \textcolor{keywordtype}{unsigned} n\_element = solid\_mesh\_pt()-\/>nboundary\_element(b);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00645}00645  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00646}00646  \textcolor{comment}{// Loop over the bulk elements adjacent to boundary b}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00647}00647  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00648}00648   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00649}00649    \textcolor{comment}{// Get pointer to the bulk element that is adjacent to boundary b}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00650}00650    SOLID\_ELEMENT* bulk\_elem\_pt = \textcolor{keyword}{dynamic\_cast<}SOLID\_ELEMENT*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00651}00651     solid\_mesh\_pt()-\/>boundary\_element\_pt(b,e));}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00652}00652    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00653}00653    \textcolor{comment}{//What is the index of the face of the element e along boundary b}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00654}00654    \textcolor{keywordtype}{int} face\_index = solid\_mesh\_pt()-\/>face\_index\_at\_boundary(b,e);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00655}00655   }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00656}00656    \textcolor{comment}{// Create new element }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00657}00657    FSISolidTractionElement<SOLID\_ELEMENT,2>* el\_pt=}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00658}00658     \textcolor{keyword}{new} FSISolidTractionElement<SOLID\_ELEMENT,2>(bulk\_elem\_pt,face\_index);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00659}00659    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00660}00660    \textcolor{comment}{// Add it to the mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00661}00661    Traction\_mesh\_pt-\/>add\_element\_pt(el\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00662}00662    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00663}00663    \textcolor{comment}{// Specify boundary number}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00664}00664    el\_pt-\/>set\_boundary\_number\_in\_bulk\_mesh(b);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00665}00665    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00666}00666    \textcolor{comment}{// Function that specifies the load ratios}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00667}00667    el\_pt-\/>q\_pt() = \&\mbox{\hyperlink{namespaceGlobal__Parameters_a7814fddf663e56168174a42d2cd6b4c1}{Global\_Parameters::Q}}; }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00668}00668   \} }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00669}00669 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00670}00670  \} \textcolor{comment}{// end of create\_traction\_elements}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00671}00671 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00672}00672 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00673}00673 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00674}00674 \textcolor{comment}{//============start\_of\_create\_lagrange\_multiplier\_elements===============}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00675}00675 \textcolor{comment}{/// Create elements that impose the prescribed boundary displacement}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00676}00676 \textcolor{comment}{/// for the pseudo-\/solid fluid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00677}00677 \textcolor{comment}{}\textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00678}00678 \textcolor{keyword}{template}<\textcolor{keyword}{class} FLUID\_ELEMENT, \textcolor{keyword}{class} SOLID\_ELEMENT>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00679}\mbox{\hyperlink{classUnstructuredFSIProblem_a6f810c300f373cfc79e23d58f95944e3}{00679}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredFSIProblem_a6f810c300f373cfc79e23d58f95944e3}{UnstructuredFSIProblem<FLUID\_ELEMENT,SOLID\_ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00680}00680 \mbox{\hyperlink{classUnstructuredFSIProblem_a6f810c300f373cfc79e23d58f95944e3}{create\_lagrange\_multiplier\_elements}}()}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00681}00681 \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00682}00682 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00683}00683  \textcolor{comment}{// Create  GeomObject incarnation of fsi boundary in solid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00684}00684  Solid\_fsi\_boundary\_pt=}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00685}00685   \textcolor{keyword}{new} MeshAsGeomObject}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00686}00686   (Traction\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00687}00687  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00688}00688  \textcolor{comment}{// Lagrange multiplier elements are located on boundary 3 of the fluid mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00689}00689  \textcolor{keywordtype}{unsigned} b=3;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00690}00690 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00691}00691  \textcolor{comment}{// How many bulk fluid elements are adjacent to boundary b?}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00692}00692  \textcolor{keywordtype}{unsigned} n\_element = Fluid\_mesh\_pt-\/>nboundary\_element(b);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00693}00693  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00694}00694  \textcolor{comment}{// Loop over the bulk fluid elements adjacent to boundary b?}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00695}00695  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00696}00696   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00697}00697    \textcolor{comment}{// Get pointer to the bulk fluid element that is adjacent to boundary b}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00698}00698    FLUID\_ELEMENT* bulk\_elem\_pt = \textcolor{keyword}{dynamic\_cast<}FLUID\_ELEMENT*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00699}00699     Fluid\_mesh\_pt-\/>boundary\_element\_pt(b,e));}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00700}00700    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00701}00701    \textcolor{comment}{//Find the index of the face of element e along boundary b}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00702}00702    \textcolor{keywordtype}{int} face\_index = Fluid\_mesh\_pt-\/>face\_index\_at\_boundary(b,e);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00703}00703       }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00704}00704    \textcolor{comment}{// Create new element}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00705}00705    ImposeDisplacementByLagrangeMultiplierElement<FLUID\_ELEMENT>* el\_pt =}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00706}00706     \textcolor{keyword}{new} ImposeDisplacementByLagrangeMultiplierElement<FLUID\_ELEMENT>(}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00707}00707      bulk\_elem\_pt,face\_index);   }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00708}00708    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00709}00709    \textcolor{comment}{// Add it to the mesh}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00710}00710    Lagrange\_multiplier\_mesh\_pt-\/>add\_element\_pt(el\_pt);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00711}00711 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00712}00712    \textcolor{comment}{// Set the GeomObject that defines the boundary shape and set}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00713}00713    \textcolor{comment}{// which bulk boundary we are attached to (needed to extract}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00714}00714    \textcolor{comment}{// the boundary coordinate from the bulk nodes)}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00715}00715    el\_pt-\/>set\_boundary\_shape\_geom\_object\_pt(Solid\_fsi\_boundary\_pt,b);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00716}00716    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00717}00717    \textcolor{comment}{// Loop over the nodes to apply boundary conditions}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00718}00718    \textcolor{keywordtype}{unsigned} nnod=el\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00719}00719    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<nnod;j++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00720}00720     \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00721}00721      Node* nod\_pt = el\_pt-\/>node\_pt(j);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00722}00722      }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00723}00723      \textcolor{comment}{// Is the node also on boundary 0? }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00724}00724      \textcolor{keywordflow}{if} (nod\_pt-\/>is\_on\_boundary(0))}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00725}00725       \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00726}00726        \textcolor{comment}{// How many nodal values were used by the "{}bulk"{} element}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00727}00727        \textcolor{comment}{// that originally created this node?}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00728}00728        \textcolor{keywordtype}{unsigned} n\_bulk\_value=el\_pt-\/>nbulk\_value(j);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00729}00729        }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00730}00730         \textcolor{comment}{// The remaining ones are Lagrange multipliers and we pin them.}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00731}00731        \textcolor{keywordtype}{unsigned} nval=nod\_pt-\/>nvalue();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00732}00732        \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=n\_bulk\_value;j<nval;j++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00733}00733         \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00734}00734          nod\_pt-\/>pin(j);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00735}00735         \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00736}00736       \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00737}00737     \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00738}00738   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00739}00739  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00740}00740 \} \textcolor{comment}{// end of create\_lagrange\_multiplier\_elements}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00741}00741 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00742}00742 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00743}00743 \textcolor{comment}{//==start\_of\_doc\_solution=================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00744}00744 \textcolor{comment}{/// Doc the solution}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00745}00745 \textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00746}00746 \textcolor{keyword}{template}<\textcolor{keyword}{class} FLUID\_ELEMENT, \textcolor{keyword}{class} SOLID\_ELEMENT>}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00747}\mbox{\hyperlink{classUnstructuredFSIProblem_a15f581318b505de07f50bd570da8c8d0}{00747}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classUnstructuredFSIProblem_a15f581318b505de07f50bd570da8c8d0}{UnstructuredFSIProblem<FLUID\_ELEMENT,SOLID\_ELEMENT>::}}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00748}00748 \mbox{\hyperlink{classUnstructuredFSIProblem_a15f581318b505de07f50bd570da8c8d0}{doc\_solution}}(DocInfo\& doc\_info)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00749}00749 \{ }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00750}00750  ofstream some\_file;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00751}00751  \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00752}00752 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00753}00753  \textcolor{comment}{// Number of plot points}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00754}00754  \textcolor{keywordtype}{unsigned} npts;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00755}00755  npts=5; }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00756}00756 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00757}00757  \textcolor{comment}{// Output fluid solution }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00758}00758  sprintf(filename,\textcolor{stringliteral}{"{}\%s/fluid\_soln\%i.dat"{}},doc\_info.directory().c\_str(),}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00759}00759          doc\_info.number());}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00760}00760  some\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00761}00761  Fluid\_mesh\_pt-\/>output(some\_file,npts);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00762}00762  some\_file.close();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00763}00763 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00764}00764 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00765}00765  \textcolor{comment}{// Output solid solution }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00766}00766  sprintf(filename,\textcolor{stringliteral}{"{}\%s/solid\_soln\%i.dat"{}},doc\_info.directory().c\_str(),}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00767}00767          doc\_info.number());}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00768}00768  some\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00769}00769  Solid\_mesh\_pt-\/>output(some\_file,npts);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00770}00770  some\_file.close();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00771}00771 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00772}00772 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00773}00773 \} \textcolor{comment}{// end\_of\_doc\_solution}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00774}00774 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00775}00775 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00776}00776 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00777}00777 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00778}00778 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00779}00779 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00780}00780 \textcolor{comment}{/// /////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00781}00781 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00782}00782 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00783}00783 \textcolor{comment}{//==start\_of\_main======================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00784}00784 \textcolor{comment}{/// Driver for unstructured fsi problem}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00785}00785 \textcolor{comment}{}\textcolor{comment}{//=====================================================================}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00786}\mbox{\hyperlink{unstructured__two__d__fsi_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{00786}} \textcolor{keywordtype}{int} \mbox{\hyperlink{unstructured__two__d__fsi_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}()}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00787}00787 \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00788}00788  \textcolor{comment}{// Label for output}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00789}00789  DocInfo doc\_info;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00790}00790  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00791}00791  \textcolor{comment}{// Set output directory}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00792}00792  doc\_info.set\_directory(\textcolor{stringliteral}{"{}RESLT"{}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00793}00793  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00794}00794  \textcolor{comment}{//Create the constitutive law}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00795}00795  \mbox{\hyperlink{namespaceGlobal__Parameters_adbd1f040f375c96fe56b3f475f7dbec2}{Global\_Parameters::Constitutive\_law\_pt}} = \textcolor{keyword}{new} GeneralisedHookean(}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00796}00796   \&\mbox{\hyperlink{namespaceGlobal__Parameters_a20fccdcfa2c15ad8b951b9ada3bb1661}{Global\_Parameters::Nu}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00797}00797  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00798}00798  \textcolor{comment}{// Build the problem with triangular Taylor Hood for fluid and solid}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00799}00799  \mbox{\hyperlink{classUnstructuredFSIProblem}{UnstructuredFSIProblem}}<}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00800}00800  PseudoSolidNodeUpdateElement<TTaylorHoodElement<2>, TPVDElement<2,3> >, }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00801}00801   TPVDElement<2,3> > problem;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00802}00802 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00803}00803  \textcolor{comment}{// Output boundaries }}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00804}00804  problem.\mbox{\hyperlink{classUnstructuredFSIProblem_a920c8629e5516bf916edd340d445100f}{fluid\_mesh\_pt}}()-\/>output\_boundaries(\textcolor{stringliteral}{"{}RESLT/fluid\_boundaries.dat"{}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00805}00805  problem.solid\_mesh\_pt()-\/>output\_boundaries(\textcolor{stringliteral}{"{}RESLT/solid\_boundaries.dat"{}});}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00806}00806  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00807}00807  \textcolor{comment}{// Output the initial guess for the solution}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00808}00808  problem.doc\_solution(doc\_info);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00809}00809  doc\_info.number()++;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00810}00810  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00811}00811  \textcolor{comment}{// Parameter study}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00812}00812  \mbox{\hyperlink{namespaceGlobal__Parameters_a335000b5db4206486a116ae0468d2d0c}{Global\_Parameters::Gravity}}=2.0e-\/4;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00813}00813  \textcolor{keywordtype}{double} q\_increment=1.0e-\/6;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00814}00814 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00815}00815  \textcolor{comment}{// Solve the problem at zero Re and Q}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00816}00816  problem.newton\_solve();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00817}00817  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00818}00818  \textcolor{comment}{// Output the solution}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00819}00819  problem.doc\_solution(doc\_info);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00820}00820  doc\_info.number()++;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00821}00821  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00822}00822  \textcolor{comment}{// Bump up Re}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00823}00823  \mbox{\hyperlink{namespaceGlobal__Parameters_a9d72e94a9305c6a310940a6a427ebe06}{Global\_Parameters::Re}}=10.0;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00824}00824 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00825}00825  \textcolor{comment}{// Now do proper parameter study with increase in Q}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00826}00826  \textcolor{keywordtype}{unsigned} nstep=2; \textcolor{comment}{// 10;}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00827}00827  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<nstep;i++)}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00828}00828   \{}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00829}00829    \textcolor{comment}{// Solve the problem}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00830}00830    problem.newton\_solve();}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00831}00831    }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00832}00832    \textcolor{comment}{// Output the solution}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00833}00833    problem.doc\_solution(doc\_info);}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00834}00834    doc\_info.number()++;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00835}00835 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00836}00836    \textcolor{comment}{// Bump up Q}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00837}00837    \mbox{\hyperlink{namespaceGlobal__Parameters_a7814fddf663e56168174a42d2cd6b4c1}{Global\_Parameters::Q}}+=q\_increment;}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00838}00838   \}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00839}00839  }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00840}00840 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00841}00841 \} \textcolor{comment}{// end\_of\_main}}
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00842}00842 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00843}00843 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00844}00844 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00845}00845 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00846}00846 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00847}00847 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00848}00848 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00849}00849 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00850}00850 }
\DoxyCodeLine{\Hypertarget{unstructured__two__d__fsi_8cc_source_l00851}00851 }

\end{DoxyCode}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: channel_with_leaflet_domain.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_6c67e72d2f29709d1e2582429aa24112.html">meshes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">channel_with_leaflet_domain.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="channel__with__leaflet__domain_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// LIC// This file forms part of oomph-lib, the object-oriented,</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// LIC// multi-physics finite-element library, available</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// LIC//</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#ifndef OOMPH_CHANNEL_WITH_LEAFLET_DOMAIN_HEADER</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#define OOMPH_CHANNEL_WITH_LEAFLET_DOMAIN_HEADER</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// Generic includes</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;../generic/geom_objects.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;../generic/domain.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;../generic/macro_element.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="comment">//===========================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">  /// Rectangular domain with a leaflet blocking the lower</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">  /// half</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"></span>  <span class="comment">//===========================================================</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html">   41</a></span>&#160;  <span class="keyword">class </span><a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html">ChannelWithLeafletDomain</a> : <span class="keyword">public</span> Domain</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">    ///\short Constructor: Pass pointer to GeomObject that represents the</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">    /// leaflet,</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">    /// the length of the domain to left and right of the leaflet, the</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">    /// height of the leaflet and the overall height of the channel,</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">    /// the number of element columns to the left and right of the leaflet,</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">    /// the number of rows of elements from the bottom of the channel to</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">    /// the end of the leaflet, the number of rows of elements above the</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">    /// end of the leaflet.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a6cca7d06136de0c76facec2a92b0939e">   52</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a6cca7d06136de0c76facec2a92b0939e">ChannelWithLeafletDomain</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a9c6741891789e8156d85c39d4e3adaa7">GeomObject</a>* <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a91d7d8d2f564c5e9d2ee07449b2653c9">leaflet_pt</a>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a5538092062970dbd2f02218a05639d49">lleft</a>,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aee74846110e70cd5538386e1ccb0ce7c">lright</a>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#af70ada72d505ebea468d1000b04c20e1">hleaflet</a>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaf195c688423473ed97af61f8a1467ab">htot</a>,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nleft,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nright,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ny1,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ny2)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="comment">// Copy assignments into private storage</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">Lleft</a> = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a5538092062970dbd2f02218a05639d49">lleft</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">Lright</a> = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aee74846110e70cd5538386e1ccb0ce7c">lright</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#af70ada72d505ebea468d1000b04c20e1">hleaflet</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaf195c688423473ed97af61f8a1467ab">htot</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a> = nleft;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a> = nright;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a> = ny1;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a> = ny2;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a> = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a91d7d8d2f564c5e9d2ee07449b2653c9">leaflet_pt</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="comment">// Store origin of leaflet for fast reference</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      Vector&lt;double&gt; zeta(1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      zeta[0] = 0.0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      Vector&lt;double&gt; r(2);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a>-&gt;position(zeta, r);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a> = r[0];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">// Number of macro elements</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordtype">unsigned</span> nmacro = (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      Macro_element_pt.resize(nmacro);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="comment">// Build the 2D macro elements</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nmacro; i++)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Macro_element_pt[i] = <span class="keyword">new</span> QMacroElement&lt;2&gt;(<span class="keyword">this</span>, i);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">    /// Destructor: Empty; cleanup done in base class</span></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a7f00e3d9ed53ca70519671446fe60510">   92</a></span>&#160;<span class="comment"></span>    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a7f00e3d9ed53ca70519671446fe60510">~ChannelWithLeafletDomain</a>() {}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    /// Total height of domain (width of channel)</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#aaf195c688423473ed97af61f8a1467ab">   95</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaf195c688423473ed97af61f8a1467ab">htot</a>()</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">    /// Height of leaflet</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#af70ada72d505ebea468d1000b04c20e1">  101</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#af70ada72d505ebea468d1000b04c20e1">hleaflet</a>()</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">    /// Length of domain to the left of leaflet</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a5538092062970dbd2f02218a05639d49">  107</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a5538092062970dbd2f02218a05639d49">lleft</a>()</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">Lleft</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">    /// Length of domain to the right of leaflet</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#aee74846110e70cd5538386e1ccb0ce7c">  113</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aee74846110e70cd5538386e1ccb0ce7c">lright</a>()</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">Lright</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">    /// Pointer to the wall</span></div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a91d7d8d2f564c5e9d2ee07449b2653c9">  119</a></span>&#160;<span class="comment"></span>    <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a9c6741891789e8156d85c39d4e3adaa7">GeomObject</a>*&amp; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a91d7d8d2f564c5e9d2ee07449b2653c9">leaflet_pt</a>()</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    };</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">    /// Parametrisation of macro element boundaries</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ae4b123847f4ab6e242a0409d72fe5cbd">macro_element_boundary</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; imacro,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; idirect,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                Vector&lt;double&gt;&amp; r);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08d97680e95f42a385a869d5c384e610">macro_bound_I_N</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                         <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                         Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a20898c8b6747cf01e3e92e4a5c6ff5e4">macro_bound_I_S</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                         <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                         Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a15e43fe342a04c8466a43112e3a48ff3">macro_bound_I_W</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                         <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                         Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ac0bc6edb7d09bfdb310de99f846f5093">macro_bound_I_E</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                         <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                         Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1402c0d3fe42a8ffd6c9fb1d6df9d460">macro_bound_II_N</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                          Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a565166bede89908189cc8e426a898859">macro_bound_II_S</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                          Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#afa35af75e7a60d3e5d4adf6a8097825e">macro_bound_II_W</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                          Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a9083a5ac562feb1cd33d78e6cc18b257">macro_bound_II_E</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                          Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a8b7f88fb218ceb09f0fde09ba22cd5b9">macro_bound_III_N</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                           <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                           Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aacdeafe878caadb3e6d0cf98a87df25a">macro_bound_III_S</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                           <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                           Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a06ccb5b6d160c3a31acf80174381a834">macro_bound_III_W</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                           <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                           Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#af17451c66c723d841aa6f16505c51be3">macro_bound_III_E</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                           <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                           Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ae8d9410d270e27677cb89c5dfe9cc136">macro_bound_IV_N</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                          Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a038eba8447f4d1643cd44642294bf43f">macro_bound_IV_S</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                          Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ab9da487d185f947a30e03b43d0fc0c9b">macro_bound_IV_W</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                          Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a16c8d718f5da2e6d9d73fe0455bacc0c">macro_bound_IV_E</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                          Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j);<span class="comment"></span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">    /// Helper function</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaca0af9c2a638c80bd8af783b9972599">slanted_bound_up</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                          <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                          Vector&lt;double&gt;&amp; r);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">    /// Length of the domain to the right of the leaflet</span></div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">  250</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">Lright</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">    /// Length of the domain to the left of the leaflet</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">  253</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">Lleft</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">    /// Lagrangian coordinate at end of leaflet</span></div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">  256</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    /// Total width of the channel</span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">  259</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">    /// Number of macro element columnns to the right of the leaflet</span></div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">  262</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">    /// Number of macro element columns to the left of the leaflet</span></div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">  265</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">    /// Number of macro element rows up to the end of the leaflet</span></div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">  268</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">    /// Number of macro element rows above the leaflet</span></div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">  271</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">    /// \short Center of the domain : origin of the leaflet, extracted</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">    /// from GeomObject and stored for fast access.</span></div>
<div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">  275</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">    /// Pointer to leaflet</span></div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">  278</a></span>&#160;<span class="comment"></span>    <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a9c6741891789e8156d85c39d4e3adaa7">GeomObject</a>* <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  };</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">//===================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">  /// Parametrisation of macro element boundaries</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span>  <span class="comment">//===================================================================</span></div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#ae4b123847f4ab6e242a0409d72fe5cbd">  285</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ae4b123847f4ab6e242a0409d72fe5cbd">ChannelWithLeafletDomain::macro_element_boundary</a>(</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; imacro,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; idirect,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    Vector&lt;double&gt;&amp; r)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">#ifdef WARN_ABOUT_SUBTLY_CHANGED_OOMPH_INTERFACES</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// Warn about time argument being moved to the front</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    OomphLibWarning(</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="stringliteral">&quot;Order of function arguments has changed between versions 0.8 and 0.85&quot;</span>,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="stringliteral">&quot;ChannelWithLeafletDomain::macro_element_boundary(...)&quot;</span>,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">using namespace </span>QuadTreeNames;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// Number of the line and of the colum in the whole domain</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// Beware : iline starts on zero</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordtype">unsigned</span> iline = int(floor(<span class="keywordtype">double</span>(imacro) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a>)));</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">unsigned</span> icol = imacro % (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// Number of the line and of the colum in the part considered</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">unsigned</span> i, j;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// Left low part of the domain : Part I</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">//------------------------------------</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> ((iline &lt; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>) &amp;&amp; (icol &lt; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>))</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      i = iline;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      j = icol;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">switch</span> (idirect)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordflow">case</span> N:</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08d97680e95f42a385a869d5c384e610">macro_bound_I_N</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">case</span> S:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a20898c8b6747cf01e3e92e4a5c6ff5e4">macro_bound_I_S</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">case</span> W:</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a15e43fe342a04c8466a43112e3a48ff3">macro_bound_I_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">case</span> E:</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ac0bc6edb7d09bfdb310de99f846f5093">macro_bound_I_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// Right low part of the domain : Part II</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">//--------------------------------------</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((iline &lt; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>) &amp;&amp; (icol &gt;= <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>))</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      i = iline;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      j = icol - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">switch</span> (idirect)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">case</span> N:</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1402c0d3fe42a8ffd6c9fb1d6df9d460">macro_bound_II_N</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">case</span> S:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a565166bede89908189cc8e426a898859">macro_bound_II_S</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">case</span> W:</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#afa35af75e7a60d3e5d4adf6a8097825e">macro_bound_II_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">case</span> E:</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a9083a5ac562feb1cd33d78e6cc18b257">macro_bound_II_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// Left upper part of the domain : Part III</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">//----------------------------------------</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((iline &gt;= <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>) &amp;&amp; (icol &lt; <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>))</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      i = iline - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      j = icol;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordflow">switch</span> (idirect)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">case</span> N:</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a8b7f88fb218ceb09f0fde09ba22cd5b9">macro_bound_III_N</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">case</span> S:</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aacdeafe878caadb3e6d0cf98a87df25a">macro_bound_III_S</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">case</span> W:</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a06ccb5b6d160c3a31acf80174381a834">macro_bound_III_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">case</span> E:</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#af17451c66c723d841aa6f16505c51be3">macro_bound_III_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// Right upper part of the domain : Part IV</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">//-----------------------------------------</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((iline &gt;= <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>) &amp;&amp; (icol &gt;= <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>))</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      i = iline - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      j = icol - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">switch</span> (idirect)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">case</span> N:</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ae8d9410d270e27677cb89c5dfe9cc136">macro_bound_IV_N</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">case</span> S:</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a038eba8447f4d1643cd44642294bf43f">macro_bound_IV_S</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">case</span> W:</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ab9da487d185f947a30e03b43d0fc0c9b">macro_bound_IV_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">case</span> E:</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a16c8d718f5da2e6d9d73fe0455bacc0c">macro_bound_IV_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, zeta, r, i, j);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span>  <span class="comment">// Helper functions for region I (lower left region)</span><span class="comment"></span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">  /// Helper function for eastern boundary in lower left region</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#ac0bc6edb7d09bfdb310de99f846f5093">  415</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ac0bc6edb7d09bfdb310de99f846f5093">ChannelWithLeafletDomain::macro_bound_I_E</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                                 <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                                 Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// Find x,y on the wall corresponding to the position of the macro element</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// xi_wall varies from xi0 to xi1 on the wall</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">double</span> xi0, xi1;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    xi0 = double(i) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    xi1 = double(i + 1) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    Vector&lt;double&gt; xi_wall(1);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    xi_wall[0] = xi0 + (1.0 + zeta[0]) / 2.0 * (xi1 - xi0);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    Vector&lt;double&gt; r_wall(2);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi_wall, r_wall);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// Find x,y on a vertical line corresponding</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// to the position of the macro element</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// the vertical line goes from y0 to y1</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordtype">double</span> y0, y1;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    y0 = double(i) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    y1 = double(i + 1) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    Vector&lt;double&gt; r_vert(2);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    r_vert[0] = -<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">Lleft</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    r_vert[1] = y0 + (1.0 + zeta[0]) / 2.0 * (y1 - y0);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// Parameter with value 0 in -Lleft and value 1 on the wall.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> = double(j + 1) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">    /// Final expression of r</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span>    r[0] = r_vert[0] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_wall[0] - r_vert[0]);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    r[1] = r_vert[1] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_wall[1] - r_vert[1]);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">  /// Helper function for western boundary in lower left region</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a15e43fe342a04c8466a43112e3a48ff3">  458</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a15e43fe342a04c8466a43112e3a48ff3">ChannelWithLeafletDomain::macro_bound_I_W</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                                 <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                                 Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// Find x,y on the wall corresponding to the position of the macro element</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// xi_wall varies from xi0 to xi1 on the wall</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">double</span> xi0, xi1;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    xi0 = double(i) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    xi1 = double(i + 1) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    Vector&lt;double&gt; xi_wall(1);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    xi_wall[0] = xi0 + (1.0 + zeta[0]) / 2.0 * (xi1 - xi0);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    Vector&lt;double&gt; r_wall(2);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi_wall, r_wall);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// Find x,y on a vertical line corresponding</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// to the position of the macro element</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// the vertical line goes from y0 to y1</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordtype">double</span> y0, y1;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    y0 = double(i) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    y1 = double(i + 1) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    Vector&lt;double&gt; r_vert(2);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    r_vert[0] = -<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">Lleft</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    r_vert[1] = y0 + (1.0 + zeta[0]) / 2.0 * (y1 - y0);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// Parameter with value 0 in -Lleft and value 1 on the wall.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> = double(j) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">    /// Final expression of r</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span>    r[0] = r_vert[0] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_wall[0] - r_vert[0]);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    r[1] = r_vert[1] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_wall[1] - r_vert[1]);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">  /// Helper function for northern boundary in lower left region</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a08d97680e95f42a385a869d5c384e610">  501</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08d97680e95f42a385a869d5c384e610">ChannelWithLeafletDomain::macro_bound_I_N</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                                 <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                                 Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// Find the coordinates of the two corners of the north boundary</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    Vector&lt;double&gt; r_left(2);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    Vector&lt;double&gt; r_right(2);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    xi[0] = 1;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a15e43fe342a04c8466a43112e3a48ff3">macro_bound_I_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_left, i, j);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ac0bc6edb7d09bfdb310de99f846f5093">macro_bound_I_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_right, i, j);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// Connect those two points with a straight line</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    r[0] = r_left[0] + (1.0 + zeta[0]) / 2.0 * (r_right[0] - r_left[0]);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    r[1] = r_left[1] + (1.0 + zeta[0]) / 2.0 * (r_right[1] - r_left[1]);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">  /// Helper function for southern boundary in lower left region</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a20898c8b6747cf01e3e92e4a5c6ff5e4">  524</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a20898c8b6747cf01e3e92e4a5c6ff5e4">ChannelWithLeafletDomain::macro_bound_I_S</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                                 <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                                 Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  {<span class="comment"></span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">    /// Find the coordinates of the two corners of the south boundary</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span>    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    Vector&lt;double&gt; r_left(2);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    Vector&lt;double&gt; r_right(2);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    xi[0] = -1.0;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a15e43fe342a04c8466a43112e3a48ff3">macro_bound_I_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_left, i, j);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ac0bc6edb7d09bfdb310de99f846f5093">macro_bound_I_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_right, i, j);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">// Connect those two points with a straight line</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    r[0] = r_left[0] + (1.0 + zeta[0]) / 2.0 * (r_right[0] - r_left[0]);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    r[1] = r_left[1] + (1.0 + zeta[0]) / 2.0 * (r_right[1] - r_left[1]);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"></span>  <span class="comment">// Helper functions for region II (lower right region)</span><span class="comment"></span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  /// Helper function for eastern boundary in lower right region</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a9083a5ac562feb1cd33d78e6cc18b257">  554</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a9083a5ac562feb1cd33d78e6cc18b257">ChannelWithLeafletDomain::macro_bound_II_E</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                                  Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// Find x,y on the wall corresponding to the position of the macro element</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// xi_wall varies from xi0 to xi1 on the wall</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">double</span> xi0, xi1;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    xi0 = double(i) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    xi1 = double(i + 1) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    Vector&lt;double&gt; xi_wall(1);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    xi_wall[0] = xi0 + (1.0 + zeta[0]) / 2.0 * (xi1 - xi0);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    Vector&lt;double&gt; r_wall(2);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi_wall, r_wall);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// Find x,y on a vertical line corresponding</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// to the position of the macro element</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// the vertical line goes from y0 to y1</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordtype">double</span> y0, y1;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    y0 = double(i) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    y1 = double(i + 1) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    Vector&lt;double&gt; r_vert(2);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    r_vert[0] = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">Lright</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    r_vert[1] = y0 + (1.0 + zeta[0]) / 2.0 * (y1 - y0);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// Parameter with value 0 in Lright and value 1 on the wall.</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> = double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a> - j - 1) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a>); <span class="comment">/***Change****/</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">    /// Final expression of r</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment"></span>    r[0] = r_vert[0] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_wall[0] - r_vert[0]);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    r[1] = r_vert[1] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_wall[1] - r_vert[1]);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">  /// Helper function for western boundary in lower right region</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#afa35af75e7a60d3e5d4adf6a8097825e">  598</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#afa35af75e7a60d3e5d4adf6a8097825e">ChannelWithLeafletDomain::macro_bound_II_W</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                                  Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">// Abscissa of the origin of the boudary east</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">// Find x,y on the wall corresponding to the position of the macro element</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">// xi_wall varies from xi0 to xi1 on the wall</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">double</span> xi0, xi1;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    xi0 = double(i) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    xi1 = double(i + 1) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    Vector&lt;double&gt; xi_wall(1);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    xi_wall[0] = xi0 + (1.0 + zeta[0]) / 2.0 * (xi1 - xi0);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    Vector&lt;double&gt; r_wall(2);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi_wall, r_wall);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">// Find x,y on a vertical line corresponding</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// to the position of the macro element</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// the vertical line goes from y0 to y1</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordtype">double</span> y0, y1;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    y0 = double(i) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    y1 = double(i + 1) * <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a> / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">Ny1</a>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    Vector&lt;double&gt; r_vert(2);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    r_vert[0] = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">Lright</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    r_vert[1] = y0 + (1.0 + zeta[0]) / 2.0 * (y1 - y0);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// Parameter with value 0 in -Lleft and value 1 on the wall.</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> = double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a> - j) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a>); <span class="comment">/***Change****/</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">// Final expression of r</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    r[0] = r_vert[0] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_wall[0] - r_vert[0]);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    r[1] = r_vert[1] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_wall[1] - r_vert[1]);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">  /// Helper function for northern boundary in lower right region</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a1402c0d3fe42a8ffd6c9fb1d6df9d460">  643</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1402c0d3fe42a8ffd6c9fb1d6df9d460">ChannelWithLeafletDomain::macro_bound_II_N</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                                  Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">// Find the coordinates of the two corners of the north boundary</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    Vector&lt;double&gt; r_left(2);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    Vector&lt;double&gt; r_right(2);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    xi[0] = 1;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#afa35af75e7a60d3e5d4adf6a8097825e">macro_bound_II_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_left, i, j);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a9083a5ac562feb1cd33d78e6cc18b257">macro_bound_II_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_right, i, j);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">// Connect those two points with a straight line</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    r[0] = r_left[0] + (1.0 + zeta[0]) / 2.0 * (r_right[0] - r_left[0]);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    r[1] = r_left[1] + (1.0 + zeta[0]) / 2.0 * (r_right[1] - r_left[1]);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">  /// Helper function for southern boundary in lower right region</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a565166bede89908189cc8e426a898859">  666</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a565166bede89908189cc8e426a898859">ChannelWithLeafletDomain::macro_bound_II_S</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                                  Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment">// Find the coordinates of the two corners of the south boundary</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    Vector&lt;double&gt; r_left(2);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    Vector&lt;double&gt; r_right(2);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    xi[0] = -1.0;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#afa35af75e7a60d3e5d4adf6a8097825e">macro_bound_II_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_left, i, j);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a9083a5ac562feb1cd33d78e6cc18b257">macro_bound_II_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_right, i, j);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// Connect those two points with a straight line</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    r[0] = r_left[0] + (1.0 + zeta[0]) / 2.0 * (r_right[0] - r_left[0]);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    r[1] = r_left[1] + (1.0 + zeta[0]) / 2.0 * (r_right[1] - r_left[1]);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"></span>  <span class="comment">// Helper functions for region III (upper left region)</span><span class="comment"></span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">  /// Describe the line between the boundary north of the domain (at x=X_0)</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">  /// and the top of the wall, when zeta goes from 0 to 1.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00697"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#aaca0af9c2a638c80bd8af783b9972599">  697</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaca0af9c2a638c80bd8af783b9972599">ChannelWithLeafletDomain::slanted_bound_up</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                                  Vector&lt;double&gt;&amp; r)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// Coordinates of the point on the boundary beetween the upper</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// and the lower part, in the same column, at the east.</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    xi[0] = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    Vector&lt;double&gt; r_join(2);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">Leaflet_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_join);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    r[0] = r_join[0] + zeta[0] * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a> - r_join[0]);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    r[1] = r_join[1] + zeta[0] * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - r_join[1]);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">  /// Helper function for eastern boundary in upper left region</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#af17451c66c723d841aa6f16505c51be3">  718</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#af17451c66c723d841aa6f16505c51be3">ChannelWithLeafletDomain::macro_bound_III_E</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                                                   <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                                   Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">// Find x,y on the slanted straight line (SSL) corresponding to</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// the position of the macro element</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">// xi_line varies from xi0 to xi1 on the SSL</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordtype">double</span> xi0, xi1;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    xi0 = double(i) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    xi1 = double(i + 1) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    Vector&lt;double&gt; xi_line(1);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    xi_line[0] = xi0 + (1.0 + zeta[0]) / 2.0 * (xi1 - xi0);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    Vector&lt;double&gt; r_line(2);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaca0af9c2a638c80bd8af783b9972599">slanted_bound_up</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi_line, r_line);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// Find x,y on a vertical line corresponding</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">// to the position of the macro element</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160; </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">// the vertical line goes from y0 to y1</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordtype">double</span> y0, y1;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    y0 = double(i) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    y1 = double(i + 1) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    ;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    Vector&lt;double&gt; r_vert(2);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    r_vert[0] = -<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">Lleft</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    r_vert[1] = y0 + (1.0 + zeta[0]) / 2.0 * (y1 - y0);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="comment">// Parameter with value 0 in Lright and value 1 on the wall.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> = double(j + 1) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>); <span class="comment">/***Change****/</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">    /// Final expression of r</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"></span>    r[0] = r_vert[0] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_line[0] - r_vert[0]);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    r[1] = r_vert[1] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_line[1] - r_vert[1]);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">  /// Helper function for western boundary in upper left region</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00763"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a06ccb5b6d160c3a31acf80174381a834">  763</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a06ccb5b6d160c3a31acf80174381a834">ChannelWithLeafletDomain::macro_bound_III_W</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                                   <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                                   Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">// Find x,y on the slanted straight line (SSL) corresponding to</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">// the position of the macro element</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">// xi_line varies from xi0 to xi1 on the SSL</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordtype">double</span> xi0, xi1;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    xi0 = double(i) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    xi1 = double(i + 1) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    Vector&lt;double&gt; xi_line(1);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    xi_line[0] = xi0 + (1.0 + zeta[0]) / 2.0 * (xi1 - xi0);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    Vector&lt;double&gt; r_line(2);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaca0af9c2a638c80bd8af783b9972599">slanted_bound_up</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi_line, r_line);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="comment">// Find x,y on a vertical line corresponding</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// to the position of the macro element</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">// the vertical line goes from y0 to y1</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordtype">double</span> y0, y1;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    y0 = double(i) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    y1 = double(i + 1) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    ;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    Vector&lt;double&gt; r_vert(2);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    r_vert[0] = -<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">Lleft</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    r_vert[1] = y0 + (1.0 + zeta[0]) / 2.0 * (y1 - y0);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// Parameter with value 0 in Lright and value 1 on the wall.</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> = double(j) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">Nleft</a>); <span class="comment">/***Change****/</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">// Final expression of r</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    r[0] = r_vert[0] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_line[0] - r_vert[0]);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    r[1] = r_vert[1] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_line[1] - r_vert[1]);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">  /// Helper function for northern boundary in upper left region</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a8b7f88fb218ceb09f0fde09ba22cd5b9">  808</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a8b7f88fb218ceb09f0fde09ba22cd5b9">ChannelWithLeafletDomain::macro_bound_III_N</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                                   <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                                                   Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">// Find the coordinates of the two corners of the north boundary</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    Vector&lt;double&gt; r_left(2);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    Vector&lt;double&gt; r_right(2);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    xi[0] = 1;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a06ccb5b6d160c3a31acf80174381a834">macro_bound_III_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_left, i, j);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#af17451c66c723d841aa6f16505c51be3">macro_bound_III_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_right, i, j);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="comment">// Connect those two points with a straight line</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    r[0] = r_left[0] + (1.0 + zeta[0]) / 2.0 * (r_right[0] - r_left[0]);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    r[1] = r_left[1] + (1.0 + zeta[0]) / 2.0 * (r_right[1] - r_left[1]);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">  /// Helper function for southern boundary in upper left region</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#aacdeafe878caadb3e6d0cf98a87df25a">  831</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aacdeafe878caadb3e6d0cf98a87df25a">ChannelWithLeafletDomain::macro_bound_III_S</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                                   <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                                   Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// Find the coordinates of the two corners of the south boundary</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    Vector&lt;double&gt; r_left(2);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    Vector&lt;double&gt; r_right(2);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    xi[0] = -1;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a06ccb5b6d160c3a31acf80174381a834">macro_bound_III_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_left, i, j);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#af17451c66c723d841aa6f16505c51be3">macro_bound_III_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_right, i, j);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// Connect those two points with a straight line</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    r[0] = r_left[0] + (1.0 + zeta[0]) / 2.0 * (r_right[0] - r_left[0]);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    r[1] = r_left[1] + (1.0 + zeta[0]) / 2.0 * (r_right[1] - r_left[1]);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"></span>  <span class="comment">// Helper functions for region IV (upper right region)</span><span class="comment"></span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">  /////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">  /// Helper function for eastern boundary in upper right region</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a16c8d718f5da2e6d9d73fe0455bacc0c">  861</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a16c8d718f5da2e6d9d73fe0455bacc0c">ChannelWithLeafletDomain::macro_bound_IV_E</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                                  Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// Find x,y on the slanted straight line (SSL) corresponding to</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">// the position of the macro element</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// xi_line varies from xi0 to xi1 on the SSL</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordtype">double</span> xi0, xi1;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    xi0 = double(i) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    xi1 = double(i + 1) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    Vector&lt;double&gt; xi_line(1);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    xi_line[0] = xi0 + (1.0 + zeta[0]) / 2.0 * (xi1 - xi0);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    Vector&lt;double&gt; r_line(2);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaca0af9c2a638c80bd8af783b9972599">slanted_bound_up</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi_line, r_line);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">// Find x,y on a vertical line corresponding</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// to the position of the macro element</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="comment">// the vertical line goes from y0 to y1</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordtype">double</span> y0, y1;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    y0 = double(i) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    y1 = double(i + 1) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    ;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    Vector&lt;double&gt; r_vert(2);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    r_vert[0] = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">Lright</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    r_vert[1] = y0 + (1.0 + zeta[0]) / 2.0 * (y1 - y0);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">// Parameter with value 0 in Lright and value 1 on the wall.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> = double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a> - j - 1) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a>); <span class="comment">/***Change****/</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// Final expression of r</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    r[0] = r_vert[0] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_line[0] - r_vert[0]);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    r[1] = r_vert[1] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_line[1] - r_vert[1]);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">  /// Helper function for western boundary in upper right region</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00906"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#ab9da487d185f947a30e03b43d0fc0c9b">  906</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ab9da487d185f947a30e03b43d0fc0c9b">ChannelWithLeafletDomain::macro_bound_IV_W</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                                  Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">// Find x,y on the slanted straight line (SSL) corresponding to</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">// the position of the macro element</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">// xi_line varies from xi0 to xi1 on the SSL</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordtype">double</span> xi0, xi1;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    xi0 = double(i) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    xi1 = double(i + 1) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    Vector&lt;double&gt; xi_line(1);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    xi_line[0] = xi0 + (1.0 + zeta[0]) / 2.0 * (xi1 - xi0);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    Vector&lt;double&gt; r_line(2);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#aaca0af9c2a638c80bd8af783b9972599">slanted_bound_up</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi_line, r_line);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">// Find x,y on a vertical line corresponding</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// to the position of the macro element</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="comment">// The vertical line goes from y0 to y1</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordtype">double</span> y0, y1;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    y0 = double(i) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    y1 = double(i + 1) * (<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">Htot</a> - <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>) / <span class="keywordtype">double</span>(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">Ny2</a>) + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">Hleaflet</a>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    ;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    Vector&lt;double&gt; r_vert(2);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    r_vert[0] = <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">Lright</a> + <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">X_0</a>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    r_vert[1] = y0 + (1.0 + zeta[0]) / 2.0 * (y1 - y0);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="comment">// Parameter with value 0 in Lright and value 1 on the wall.</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> = double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a> - j) / double(<a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">Nright</a>); <span class="comment">/***Change****/</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="comment">// Final expression of r</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    r[0] = r_vert[0] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_line[0] - r_vert[0]);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    r[1] = r_vert[1] + <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a> * (r_line[1] - r_vert[1]);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">  /// Helper function for northern boundary in upper right region</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00951"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#ae8d9410d270e27677cb89c5dfe9cc136">  951</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ae8d9410d270e27677cb89c5dfe9cc136">ChannelWithLeafletDomain::macro_bound_IV_N</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                                                  Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  {</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">// Find the coordinates of the two corners of the north boundary</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    Vector&lt;double&gt; r_left(2);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    Vector&lt;double&gt; r_right(2);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    xi[0] = 1;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ab9da487d185f947a30e03b43d0fc0c9b">macro_bound_IV_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_left, i, j);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a16c8d718f5da2e6d9d73fe0455bacc0c">macro_bound_IV_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_right, i, j);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// Connect those two points with a straight line</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    r[0] = r_left[0] + (1.0 + zeta[0]) / 2.0 * (r_right[0] - r_left[0]);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    r[1] = r_left[1] + (1.0 + zeta[0]) / 2.0 * (r_right[1] - r_left[1]);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="comment">//=====================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">  /// Helper function for southern boundary in upper right region</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00974"></a><span class="lineno"><a class="line" href="classoomph_1_1ChannelWithLeafletDomain.html#a038eba8447f4d1643cd44642294bf43f">  974</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a038eba8447f4d1643cd44642294bf43f">ChannelWithLeafletDomain::macro_bound_IV_S</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                                                  <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                                  Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i,</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; j)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">// Find the coordinates of the two corners of the south boundary</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    Vector&lt;double&gt; r_left(2);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    Vector&lt;double&gt; r_right(2);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    xi[0] = -1;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#ab9da487d185f947a30e03b43d0fc0c9b">macro_bound_IV_W</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_left, i, j);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="classoomph_1_1ChannelWithLeafletDomain.html#a16c8d718f5da2e6d9d73fe0455bacc0c">macro_bound_IV_E</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, xi, r_right, i, j);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="comment">// Connect those two points with a straight line</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    r[0] = r_left[0] + (1.0 + zeta[0]) / 2.0 * (r_right[0] - r_left[0]);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    r[1] = r_left[1] + (1.0 + zeta[0]) / 2.0 * (r_right[1] - r_left[1]);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;} <span class="comment">// namespace oomph</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_ab9da487d185f947a30e03b43d0fc0c9b"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#ab9da487d185f947a30e03b43d0fc0c9b">oomph::ChannelWithLeafletDomain::macro_bound_IV_W</a></div><div class="ttdeci">void macro_bound_IV_W(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00906">channel_with_leaflet_domain.h:906</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a08d97680e95f42a385a869d5c384e610"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a08d97680e95f42a385a869d5c384e610">oomph::ChannelWithLeafletDomain::macro_bound_I_N</a></div><div class="ttdeci">void macro_bound_I_N(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00501">channel_with_leaflet_domain.h:501</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a06ccb5b6d160c3a31acf80174381a834"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a06ccb5b6d160c3a31acf80174381a834">oomph::ChannelWithLeafletDomain::macro_bound_III_W</a></div><div class="ttdeci">void macro_bound_III_W(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00763">channel_with_leaflet_domain.h:763</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_ac0bc6edb7d09bfdb310de99f846f5093"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#ac0bc6edb7d09bfdb310de99f846f5093">oomph::ChannelWithLeafletDomain::macro_bound_I_E</a></div><div class="ttdeci">void macro_bound_I_E(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00415">channel_with_leaflet_domain.h:415</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_ae4b123847f4ab6e242a0409d72fe5cbd"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#ae4b123847f4ab6e242a0409d72fe5cbd">oomph::ChannelWithLeafletDomain::macro_element_boundary</a></div><div class="ttdeci">void macro_element_boundary(const unsigned &amp;t, const unsigned &amp;imacro, const unsigned &amp;idirect, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r)</div><div class="ttdoc">Parametrisation of macro element boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00285">channel_with_leaflet_domain.h:285</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_aee74846110e70cd5538386e1ccb0ce7c"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#aee74846110e70cd5538386e1ccb0ce7c">oomph::ChannelWithLeafletDomain::lright</a></div><div class="ttdeci">double lright()</div><div class="ttdoc">Length of domain to the right of leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00113">channel_with_leaflet_domain.h:113</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_ad32b0daa71b42d34aec81c7e3d25cb98"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#ad32b0daa71b42d34aec81c7e3d25cb98">oomph::ChannelWithLeafletDomain::Htot</a></div><div class="ttdeci">double Htot</div><div class="ttdoc">Total width of the channel.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00259">channel_with_leaflet_domain.h:259</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_aaca0af9c2a638c80bd8af783b9972599"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#aaca0af9c2a638c80bd8af783b9972599">oomph::ChannelWithLeafletDomain::slanted_bound_up</a></div><div class="ttdeci">void slanted_bound_up(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00697">channel_with_leaflet_domain.h:697</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_ae8d9410d270e27677cb89c5dfe9cc136"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#ae8d9410d270e27677cb89c5dfe9cc136">oomph::ChannelWithLeafletDomain::macro_bound_IV_N</a></div><div class="ttdeci">void macro_bound_IV_N(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00951">channel_with_leaflet_domain.h:951</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a15e43fe342a04c8466a43112e3a48ff3"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a15e43fe342a04c8466a43112e3a48ff3">oomph::ChannelWithLeafletDomain::macro_bound_I_W</a></div><div class="ttdeci">void macro_bound_I_W(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00458">channel_with_leaflet_domain.h:458</a></div></div>
<div class="ttc" id="afsi__collapsible__channel__adapt_8txt_html_a152339e6ee653f666802b0f8708a0ec3"><div class="ttname"><a href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a></div><div class="ttdeci">t_0 \f$ and \f$ t=t_0+\Delta t \f$. At \f$ t=t_0+2 \Delta t \f$, the automatic mesh adaptation splits one of the fluid elements, creating the five new \c Nodes, shown in red(for simplicity we only show the fluid elements' vertex nodes). Their position is determined by the father element 's \c MacroElement mapping, using the current position of the \c MeshAsGeomObject, obtained from the interpolation between the nodal positions of its \c SolidNodes(shown as green circles). @I w 0.75\textwidth history_values &quot;Sketch illustrating the assignment of positional history values for newly-created nodes in FSI problems. The positional history values of the newly-created Nodes (shown in red) are given by the positions they would have had if they had already existed at previous timesteps. &quot; So far, so good! A subtle problem arises when we try to assign the positional history values for the newly-created \c Nodes. The evaluation of the \c MacroElement mapping at the previous timesteps(required to determine the positions the newly-created \c Nodes would have had, if they had already existed at previous timesteps) requires access to the previous wall shapes. In&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; the non-FSI problem discussed earlier&lt;/A &gt;, the wall shape was given analytically and could therefore be evaluated at arbitrary times. In the FSI problem considered here, the previous wall shape is not available as the previous positions of the \c SolidNodes are not required(and are therefore not stored) for the solution of the(steady!) wall equations.&lt; HR &gt; \subsection soln The solution:The Steady&lt; NSTEPS &gt; timestepper The solution to the problem is simple:Recall that the final entry in the argument list of \c oomph-lib 's mesh constructors specifies the \c TimeStepper to be used for the evaluation of any time-derivatives. The \c TimeStepper 's member function \c TimeStepper::ntstorage() specifies the total number of values(the current value plus the number of history values) required to evaluate the time-derivatives t</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel__adapt_8txt_source.html#l00100">fsi_collapsible_channel_adapt.txt:100</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a165703af81538c28bbbd780d65bbb333"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a165703af81538c28bbbd780d65bbb333">oomph::ChannelWithLeafletDomain::X_0</a></div><div class="ttdeci">double X_0</div><div class="ttdoc">Center of the domain : origin of the leaflet, extracted from GeomObject and stored for fast access.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00275">channel_with_leaflet_domain.h:275</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a5538092062970dbd2f02218a05639d49"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a5538092062970dbd2f02218a05639d49">oomph::ChannelWithLeafletDomain::lleft</a></div><div class="ttdeci">double lleft()</div><div class="ttdoc">Length of domain to the left of leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00107">channel_with_leaflet_domain.h:107</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_af17451c66c723d841aa6f16505c51be3"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#af17451c66c723d841aa6f16505c51be3">oomph::ChannelWithLeafletDomain::macro_bound_III_E</a></div><div class="ttdeci">void macro_bound_III_E(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00718">channel_with_leaflet_domain.h:718</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_afa35af75e7a60d3e5d4adf6a8097825e"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#afa35af75e7a60d3e5d4adf6a8097825e">oomph::ChannelWithLeafletDomain::macro_bound_II_W</a></div><div class="ttdeci">void macro_bound_II_W(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00598">channel_with_leaflet_domain.h:598</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a565166bede89908189cc8e426a898859"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a565166bede89908189cc8e426a898859">oomph::ChannelWithLeafletDomain::macro_bound_II_S</a></div><div class="ttdeci">void macro_bound_II_S(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00666">channel_with_leaflet_domain.h:666</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a20898c8b6747cf01e3e92e4a5c6ff5e4"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a20898c8b6747cf01e3e92e4a5c6ff5e4">oomph::ChannelWithLeafletDomain::macro_bound_I_S</a></div><div class="ttdeci">void macro_bound_I_S(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00524">channel_with_leaflet_domain.h:524</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a038eba8447f4d1643cd44642294bf43f"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a038eba8447f4d1643cd44642294bf43f">oomph::ChannelWithLeafletDomain::macro_bound_IV_S</a></div><div class="ttdeci">void macro_bound_IV_S(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00974">channel_with_leaflet_domain.h:974</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_aaf195c688423473ed97af61f8a1467ab"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#aaf195c688423473ed97af61f8a1467ab">oomph::ChannelWithLeafletDomain::htot</a></div><div class="ttdeci">double htot()</div><div class="ttdoc">Total height of domain (width of channel)</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00095">channel_with_leaflet_domain.h:95</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a91d7d8d2f564c5e9d2ee07449b2653c9"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a91d7d8d2f564c5e9d2ee07449b2653c9">oomph::ChannelWithLeafletDomain::leaflet_pt</a></div><div class="ttdeci">GeomObject *&amp; leaflet_pt()</div><div class="ttdoc">Pointer to the wall.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00119">channel_with_leaflet_domain.h:119</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a3c6393ef6e626d7a2f2a8ea70c8addbe"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a3c6393ef6e626d7a2f2a8ea70c8addbe">oomph::ChannelWithLeafletDomain::Ny1</a></div><div class="ttdeci">unsigned Ny1</div><div class="ttdoc">Number of macro element rows up to the end of the leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00268">channel_with_leaflet_domain.h:268</a></div></div>
<div class="ttc" id="afsi__collapsible__channel__adapt_8txt_html_a9c6741891789e8156d85c39d4e3adaa7"><div class="ttname"><a href="fsi__collapsible__channel__adapt_8txt.html#a9c6741891789e8156d85c39d4e3adaa7">GeomObject</a></div><div class="ttdeci">this is used if there is only a single node update as in the c AlgebraicCollapsibleChannelMesh n n A vector such as the intrinsic coordinates of reference points on the c GeomObjects n n By we assume that a newly created c AlgebraicNode is updated by the same node update function as the c AlgebraicNodes in its father element Therefore we pass the pointer to the c the node update function and the vector of pointers to c GeomObjects to the newly created c and interpolate the reference values between those stored at the c AlgebraicNodes in the father elements In most cases this provides a sensible default For it is hard to imagine a situation in which it would be sensible to update the position of newly created c AlgebraicNodes by a procedure that differs from that used for the surrounding c AlgebraicNodes that already existed in the father element since the reference values vary from node to in the c AlgebraicCollapsibleChannelMesh one of the reference values is the f x_1 f coordinate of the reference point on the fixed lower wall For the c AlgebraicNodes that already existed in the coarse base this value is given by the the c AlgebraicNodes f x_1 f coordinate in the undeformed mesh Interpolation of this value for the newly created c AlgebraicNodes results in an axially uniform subdivision of the refined elements The same procedure may be used to assign the reference value that represents the intrinsic coordinate of the reference point on the upper wall at least as long as the upper wall is only ever addressed as a compound c GeomObject</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel__adapt_8txt_source.html#l00226">fsi_collapsible_channel_adapt.txt:226</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="annular__domain_8h_source.html#l00034">annular_domain.h:34</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_ad0abd8837f9f0924b801d2fb78c69532"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#ad0abd8837f9f0924b801d2fb78c69532">oomph::ChannelWithLeafletDomain::Nleft</a></div><div class="ttdeci">unsigned Nleft</div><div class="ttdoc">Number of macro element columns to the left of the leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00265">channel_with_leaflet_domain.h:265</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a11aac62965f9bcb7d4c0043669b28f15"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a11aac62965f9bcb7d4c0043669b28f15">oomph::ChannelWithLeafletDomain::Nright</a></div><div class="ttdeci">unsigned Nright</div><div class="ttdoc">Number of macro element columnns to the right of the leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00262">channel_with_leaflet_domain.h:262</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a1596a538b4263b42d20f9c098c5f2752"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a1596a538b4263b42d20f9c098c5f2752">oomph::ChannelWithLeafletDomain::Ny2</a></div><div class="ttdeci">unsigned Ny2</div><div class="ttdoc">Number of macro element rows above the leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00271">channel_with_leaflet_domain.h:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a9083a5ac562feb1cd33d78e6cc18b257"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a9083a5ac562feb1cd33d78e6cc18b257">oomph::ChannelWithLeafletDomain::macro_bound_II_E</a></div><div class="ttdeci">void macro_bound_II_E(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00554">channel_with_leaflet_domain.h:554</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a7f00e3d9ed53ca70519671446fe60510"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a7f00e3d9ed53ca70519671446fe60510">oomph::ChannelWithLeafletDomain::~ChannelWithLeafletDomain</a></div><div class="ttdeci">~ChannelWithLeafletDomain()</div><div class="ttdoc">Destructor: Empty; cleanup done in base class.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00092">channel_with_leaflet_domain.h:92</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a8b7f88fb218ceb09f0fde09ba22cd5b9"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a8b7f88fb218ceb09f0fde09ba22cd5b9">oomph::ChannelWithLeafletDomain::macro_bound_III_N</a></div><div class="ttdeci">void macro_bound_III_N(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00808">channel_with_leaflet_domain.h:808</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a16c8d718f5da2e6d9d73fe0455bacc0c"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a16c8d718f5da2e6d9d73fe0455bacc0c">oomph::ChannelWithLeafletDomain::macro_bound_IV_E</a></div><div class="ttdeci">void macro_bound_IV_E(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00861">channel_with_leaflet_domain.h:861</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_aacdeafe878caadb3e6d0cf98a87df25a"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#aacdeafe878caadb3e6d0cf98a87df25a">oomph::ChannelWithLeafletDomain::macro_bound_III_S</a></div><div class="ttdeci">void macro_bound_III_S(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00831">channel_with_leaflet_domain.h:831</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html">oomph::ChannelWithLeafletDomain</a></div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00041">channel_with_leaflet_domain.h:41</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a0a50a8a7b274fb1dfc6d18c79ca884cd"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a0a50a8a7b274fb1dfc6d18c79ca884cd">oomph::ChannelWithLeafletDomain::Lleft</a></div><div class="ttdeci">double Lleft</div><div class="ttdoc">Length of the domain to the left of the leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00253">channel_with_leaflet_domain.h:253</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a08a8eb7078cdc788dc7643e09e7405fb"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a08a8eb7078cdc788dc7643e09e7405fb">oomph::ChannelWithLeafletDomain::Leaflet_pt</a></div><div class="ttdeci">GeomObject * Leaflet_pt</div><div class="ttdoc">Pointer to leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00278">channel_with_leaflet_domain.h:278</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a6c1a799bbedc5f0ff08f38088eaedc68"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a6c1a799bbedc5f0ff08f38088eaedc68">oomph::ChannelWithLeafletDomain::Lright</a></div><div class="ttdeci">double Lright</div><div class="ttdoc">Length of the domain to the right of the leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00250">channel_with_leaflet_domain.h:250</a></div></div>
<div class="ttc" id="afsi__collapsible__channel__adapt_8txt_html_abe1a872647b7cfc1c732b57adef7d1b9"><div class="ttname"><a href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a></div><div class="ttdeci">respectively The red arrow identifies the reference point for the newly created node VI whose reference coordinate f IV and i e the nodes in its father element I w textwidth update_single Illustration of the default update procedure for the node update IV and V in its father element the default assignment is not appropriate for nodes that are updated by and the values of the coordinate at which the reference points are located This is illustrated in the sketch below in which the sub c parametrised by their coordinates f s</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel__adapt_8txt_source.html#l00254">fsi_collapsible_channel_adapt.txt:254</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a6cca7d06136de0c76facec2a92b0939e"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a6cca7d06136de0c76facec2a92b0939e">oomph::ChannelWithLeafletDomain::ChannelWithLeafletDomain</a></div><div class="ttdeci">ChannelWithLeafletDomain(GeomObject *leaflet_pt, const double &amp;lleft, const double &amp;lright, const double &amp;hleaflet, const double &amp;htot, const unsigned &amp;nleft, const unsigned &amp;nright, const unsigned &amp;ny1, const unsigned &amp;ny2)</div><div class="ttdoc">Constructor: Pass pointer to GeomObject that represents the leaflet, the length of the domain to left...</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00052">channel_with_leaflet_domain.h:52</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a1402c0d3fe42a8ffd6c9fb1d6df9d460"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a1402c0d3fe42a8ffd6c9fb1d6df9d460">oomph::ChannelWithLeafletDomain::macro_bound_II_N</a></div><div class="ttdeci">void macro_bound_II_N(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, const unsigned &amp;i, const unsigned &amp;j)</div><div class="ttdoc">Helper function.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00643">channel_with_leaflet_domain.h:643</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_af70ada72d505ebea468d1000b04c20e1"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#af70ada72d505ebea468d1000b04c20e1">oomph::ChannelWithLeafletDomain::hleaflet</a></div><div class="ttdeci">double hleaflet()</div><div class="ttdoc">Height of leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00101">channel_with_leaflet_domain.h:101</a></div></div>
<div class="ttc" id="aclassoomph_1_1ChannelWithLeafletDomain_html_a75ce3248efae5c33a9c9989b2f310139"><div class="ttname"><a href="classoomph_1_1ChannelWithLeafletDomain.html#a75ce3248efae5c33a9c9989b2f310139">oomph::ChannelWithLeafletDomain::Hleaflet</a></div><div class="ttdeci">double Hleaflet</div><div class="ttdoc">Lagrangian coordinate at end of leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="channel__with__leaflet__domain_8h_source.html#l00256">channel_with_leaflet_domain.h:256</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Mon Aug 23 2021 17:40:08
        </div>
      </div>
    </footer>
</body>
</html>

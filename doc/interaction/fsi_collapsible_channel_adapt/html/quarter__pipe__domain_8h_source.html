<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: quarter_pipe_domain.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_6c67e72d2f29709d1e2582429aa24112.html">meshes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">quarter_pipe_domain.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="quarter__pipe__domain_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//Include guards</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef OOMPH_QUARTER_PIPE_DOMAIN_HEADER</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define OOMPH_QUARTER_PIPE_DOMAIN_HEADER</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// Generic oomph-lib includes</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;../generic/octree.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;../generic/domain.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;../generic/geom_objects.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/// Domain representing a quarter pipe</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html">   42</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1QuarterPipeDomain.html">QuarterPipeDomain</a> : <span class="keyword">public</span> Domain </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{ </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">public</span>: </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> /// \short Constructor: Pass number of elements in various directions,</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> /// the inner and outer radius and the length of the tube</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#afb9763dac929fd4371a6ef860d9a5caf">   49</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#afb9763dac929fd4371a6ef860d9a5caf">QuarterPipeDomain</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ntheta, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nr,</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nz,  </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;rmin, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;rmax,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;length) :</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">Ntheta</a>(ntheta), <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a18ac22546af74ac9b76a870d3f5abe3d">Nr</a>(nr), <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aab1bf3900c3537c44942e3fee0c3d24e">Nz</a>(nz), <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>(rmin), <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>(rmax), <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a0798f3962e840bdb3d31e4e0dada055d">Length</a>(length),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ada15e8a576d3715e8ed88ea9bef5508a">Axial_spacing_fct_pt</a>(&amp;<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a3b79d0bf40336f7961a8b2bb58080dba">default_axial_spacing_fct</a>)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="comment">// Number of macroelements</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordtype">unsigned</span> nmacro = nr*ntheta*nz;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="comment">// Resize</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   Macro_element_pt.resize(nmacro);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="comment">// Create macro elements</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;nmacro;i++)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;     Macro_element_pt[i]=<span class="keyword">new</span> QMacroElement&lt;3&gt;(<span class="keyword">this</span>,i);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="comment">// Make geom object representing the outer and inner boundaries of</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="comment">// the cross section</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>=<span class="keyword">new</span> Ellipse(rmin,rmin);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>=<span class="keyword">new</span> Ellipse(rmax,rmax);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  } </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">  /// Broken copy constructor</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a09e3620b090b3bae5d2bf8c2e6ac9812">   75</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a09e3620b090b3bae5d2bf8c2e6ac9812">QuarterPipeDomain</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html">QuarterPipeDomain</a>&amp;) </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   { </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    BrokenCopy::broken_copy(<span class="stringliteral">&quot;QuarterPipeDomain&quot;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   } </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">  /// Broken assignment operator</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#ab6aec719fb0b333abf3ef9a1bf0414ac">   82</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ab6aec719fb0b333abf3ef9a1bf0414ac">operator=</a>(<span class="keyword">const</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html">QuarterPipeDomain</a>&amp;) </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    BrokenCopy::broken_assign(<span class="stringliteral">&quot;QuarterPipeDomain&quot;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">  /// Destructor: </span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a872560e53bf73ef0bd1b69f2a40612c8">   88</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a872560e53bf73ef0bd1b69f2a40612c8">~QuarterPipeDomain</a>()</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// Note: macro elements are cleaned up in base class...</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">delete</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> /// \short Typedef for function pointer for function that implements</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> /// axial spacing of macro elements</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a540d441b38146aacb12938d5f885789c">   97</a></span>&#160;<span class="comment"></span> <span class="keyword">typedef</span> double (*<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a540d441b38146aacb12938d5f885789c">AxialSpacingFctPt</a>)(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; xi);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> /// \short Function pointer for function that  implements</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> /// axial spacing of macro elements</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#aa2731d4c5fb22dc0a5d2faa32f99505e">  101</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a540d441b38146aacb12938d5f885789c">AxialSpacingFctPt</a>&amp; <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aa2731d4c5fb22dc0a5d2faa32f99505e">axial_spacing_fct_pt</a>()</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ada15e8a576d3715e8ed88ea9bef5508a">Axial_spacing_fct_pt</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> /// \short Function that implements</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> /// axial spacing of macro elements</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a035e27884c0fa1bc31d1d9bed28c37bd">  108</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a035e27884c0fa1bc31d1d9bed28c37bd">axial_spacing_fct</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; xi)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ada15e8a576d3715e8ed88ea9bef5508a">Axial_spacing_fct_pt</a>(xi);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> /// \short Vector representation of the i_macro-th macro element</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> /// boundary i_direct (U/D/L/R/F/B) at time level t </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> /// (t=0: present; t&gt;0: previous): f(s).</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ae8cc6433c58dcfb265335744ed8a330a">macro_element_boundary</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i_macro,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i_direct,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                             <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                             Vector&lt;double&gt;&amp; f);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> /// Number of elements azimuthal direction</span></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">  125</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">Ntheta</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> /// Number of elements radial direction</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a18ac22546af74ac9b76a870d3f5abe3d">  128</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a18ac22546af74ac9b76a870d3f5abe3d">Nr</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> /// Number of elements axial direction</span></div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#aab1bf3900c3537c44942e3fee0c3d24e">  131</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aab1bf3900c3537c44942e3fee0c3d24e">Nz</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> /// Inner radius</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">  134</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> /// Outer radius</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">  137</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> /// Length</span></div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a0798f3962e840bdb3d31e4e0dada055d">  140</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a0798f3962e840bdb3d31e4e0dada055d">Length</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> /// \short Geom object representing the outer boundary of</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> /// the cross section</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">  144</a></span>&#160;<span class="comment"></span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a9c6741891789e8156d85c39d4e3adaa7">GeomObject</a>* <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> /// \short Geom object representing the inner boundary of</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> /// the cross section</span></div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">  148</a></span>&#160;<span class="comment"></span> <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a9c6741891789e8156d85c39d4e3adaa7">GeomObject</a>* <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> /// \short Function pointer for function that implements</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> /// axial spacing of macro elements</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#ada15e8a576d3715e8ed88ea9bef5508a">  152</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a540d441b38146aacb12938d5f885789c">AxialSpacingFctPt</a> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ada15e8a576d3715e8ed88ea9bef5508a">Axial_spacing_fct_pt</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> /// \short Default for function that  implements</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> /// axial spacing of macro elements</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a3b79d0bf40336f7961a8b2bb58080dba">  156</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a3b79d0bf40336f7961a8b2bb58080dba">default_axial_spacing_fct</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; xi)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="keywordflow">return</span> xi;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> /// \short Boundary of macro element zeta \f$ \in [-1,1]x[-1,1] \f$</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5c023c7a9d6e43d123566bc2f7bb21f0">r_U</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          Vector&lt;double&gt;&amp; f, </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> /// \short Boundary of macro element zeta \f$ \in [-1,1]x[-1,1] \f$</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a21c58b76f546300c308d6e1f303a3433">r_L</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          Vector&lt;double&gt;&amp; f, </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> /// \short Boundary of macro element zeta \f$ \in [-1,1]x[-1,1] \f$</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb6e4d3fbb8afb4ad2597601f1a46afd">r_D</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          Vector&lt;double&gt;&amp; f, </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> /// \short Boundary of macro element zeta \f$ \in [-1,1]x[-1,1] \f$</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aab6f3fd79bc6dea1eb267f3b55630a2b">r_R</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          Vector&lt;double&gt;&amp; f, </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> /// \short Boundary of macro element zeta \f$ \in [-1,1]x[-1,1] \f$</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a85aaa5d1217c49e2144bbfd37dbad0fd">r_F</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          Vector&lt;double&gt;&amp; f, </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> /// \short Boundary of macro element zeta \f$ \in [-1,1]x[-1,1] \f$</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aba1af5e7f1bc6e88ff8e9ee59e965630">r_B</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          Vector&lt;double&gt;&amp; f, </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}; <span class="comment">// endofclass</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">/// Vector representation of the  imacro-th macro element</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">/// boundary idirect (U/D/L/R/F/B) at time level t:</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/// f(s)</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#ae8cc6433c58dcfb265335744ed8a330a">  214</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#ae8cc6433c58dcfb265335744ed8a330a">QuarterPipeDomain::macro_element_boundary</a>(</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; imacro,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; idirect,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; Vector&lt;double&gt;&amp; f)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keyword">using namespace </span>OcTreeNames;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> pi=MathematicalConstants::Pi;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// Match the elements number with the position</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">unsigned</span> num_z=imacro/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a18ac22546af74ac9b76a870d3f5abe3d">Nr</a>*<a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">Ntheta</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordtype">unsigned</span> num_y=(imacro%(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a18ac22546af74ac9b76a870d3f5abe3d">Nr</a>*<a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">Ntheta</a>))/<a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">Ntheta</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">unsigned</span> num_x=imacro%<a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">Ntheta</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">// Define the extreme coordinates</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">// radial direction </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">double</span> rmin=<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>+(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)*<span class="keywordtype">double</span>(num_y)/double(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a18ac22546af74ac9b76a870d3f5abe3d">Nr</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">double</span> rmax=<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>+(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)*<span class="keywordtype">double</span>(num_y+1)/double(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a18ac22546af74ac9b76a870d3f5abe3d">Nr</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="comment">// theta direction</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">double</span> thetamin=(pi/2.0)*(1.0-double(num_x+1)/double(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">Ntheta</a>));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordtype">double</span> thetamax=(pi/2.0)*(1.0-double(num_x)/double(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">Ntheta</a>));</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// zdirection (tube)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordtype">double</span> zmin=double(num_z)*<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a0798f3962e840bdb3d31e4e0dada055d">Length</a>/double(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#aab1bf3900c3537c44942e3fee0c3d24e">Nz</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordtype">double</span> zmax=double(num_z+1)*<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a0798f3962e840bdb3d31e4e0dada055d">Length</a>/double(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#aab1bf3900c3537c44942e3fee0c3d24e">Nz</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="comment">// Which direction?</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">if</span> (idirect==U)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5c023c7a9d6e43d123566bc2f7bb21f0">r_U</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,f,rmin,rmax,thetamin,thetamax,zmin,zmax);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idirect==D)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb6e4d3fbb8afb4ad2597601f1a46afd">r_D</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,f,rmin,rmax,thetamin,thetamax,zmin,zmax);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idirect==L)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a21c58b76f546300c308d6e1f303a3433">r_L</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,f,rmin,rmax,thetamin,thetamax,zmin,zmax);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idirect==R)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aab6f3fd79bc6dea1eb267f3b55630a2b">r_R</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,f,rmin,rmax,thetamin,thetamax,zmin,zmax);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idirect==F)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a85aaa5d1217c49e2144bbfd37dbad0fd">r_F</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,f,rmin,rmax,thetamin,thetamax,zmin,zmax);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (idirect==B)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aba1af5e7f1bc6e88ff8e9ee59e965630">r_B</a>(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,f,rmin,rmax,thetamin,thetamax,zmin,zmax);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    std::ostringstream error_stream;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    error_stream &lt;&lt; <span class="stringliteral">&quot;idirect is &quot;</span> &lt;&lt; idirect </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; not one of U, D, L, R, F, B&quot;</span> &lt;&lt;  std::endl;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">throw</span> OomphLibError(</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;     error_stream.str(),</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// Now redistribute points in the axial direction</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordtype">double</span> z_frac=f[2]/<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a0798f3962e840bdb3d31e4e0dada055d">Length</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  f[2]=<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a0798f3962e840bdb3d31e4e0dada055d">Length</a>*<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a035e27884c0fa1bc31d1d9bed28c37bd">axial_spacing_fct</a>(z_frac);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">/// Left face of a macro element \f$ s \in [-1,1]*[-1,1] \f$</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a21c58b76f546300c308d6e1f303a3433">  292</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a21c58b76f546300c308d6e1f303a3433">QuarterPipeDomain::r_L</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                             <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                             Vector&lt;double&gt;&amp; f, </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  {                                   </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   Vector&lt;double&gt; x(1);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   x[0]=thetamax;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="comment">// Point on outer wall</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   Vector&lt;double&gt; r_outer(2);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_outer);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="comment">// Point on inner wall</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   Vector&lt;double&gt; r_inner(2);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_inner);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="comment">// Get layer boundaries</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   Vector&lt;double&gt; r_top(2);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   Vector&lt;double&gt; r_bot(2);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;     r_top[i]=r_inner[i]+(r_outer[i]-r_inner[i])*(rmax-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;     r_bot[i]=r_inner[i]+(r_outer[i]-r_inner[i])*(rmin-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <span class="comment">// Compute coordinates</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   f[0]=r_bot[0]+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[0]+1.0))*(r_top[0]-r_bot[0]);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   f[1]=r_bot[1]+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[0]+1.0))*(r_top[1]-r_bot[1]);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   f[2]=zmin+(zmax-zmin)*(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[1]+1.0));</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }                                                  </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/// Right face of a macro element \f$ s \in [-1,1]*[-1,1] \f$</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#aab6f3fd79bc6dea1eb267f3b55630a2b">  328</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aab6f3fd79bc6dea1eb267f3b55630a2b">QuarterPipeDomain::r_R</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                             <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                             Vector&lt;double&gt;&amp; f, </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  {                                   </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                      </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   Vector&lt;double&gt; x(1);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   x[0]=thetamin;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="comment">// Point on outer wall</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   Vector&lt;double&gt; r_outer(2);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_outer);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   <span class="comment">// Point on inner wall</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   Vector&lt;double&gt; r_inner(2);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_inner);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="comment">// Get layer boundaries</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   Vector&lt;double&gt; r_top(2);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   Vector&lt;double&gt; r_bot(2);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     r_top[i]=r_inner[i]+(r_outer[i]-r_inner[i])*(rmax-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;     r_bot[i]=r_inner[i]+(r_outer[i]-r_inner[i])*(rmin-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="comment">// Compute coordinates</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   f[0]=r_bot[0]+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[0]+1.0))*(r_top[0]-r_bot[0]);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   f[1]=r_bot[1]+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[0]+1.0))*(r_top[1]-r_bot[1]);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   f[2]=zmin+(zmax-zmin)*(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[1]+1.0));</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  }      </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">/// Left face of a macro element \f$s \in [-1,1]*[-1,1] \f$</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00368"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#aeb6e4d3fbb8afb4ad2597601f1a46afd">  368</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aeb6e4d3fbb8afb4ad2597601f1a46afd">QuarterPipeDomain::r_D</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,                              </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                             <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>, </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                             Vector&lt;double&gt;&amp; f,                        </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax)</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  {                                   </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   Vector&lt;double&gt; x(1);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   x[0]=thetamax+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[0]+1.0))*(thetamin-thetamax);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="comment">// Point on outer wall</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   Vector&lt;double&gt; r_outer(2);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_outer);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="comment">// Point on inner wall</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   Vector&lt;double&gt; r_inner(2);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_inner);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <span class="comment">// Get layer</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;     f[i]=r_inner[i]+(r_outer[i]-r_inner[i])*(rmin-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   f[2]=zmin+(zmax-zmin)*(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[1]+1.0));</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }                                                  </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">/// Right face of a macro element \f$ s \in [-1,1]*[-1,1] \f$</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a5c023c7a9d6e43d123566bc2f7bb21f0">  400</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5c023c7a9d6e43d123566bc2f7bb21f0">QuarterPipeDomain::r_U</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                             <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>, </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                             Vector&lt;double&gt;&amp; f,</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  {                                   </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   Vector&lt;double&gt; x(1);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   x[0]=thetamax+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[0]+1.0))*(thetamin-thetamax);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="comment">// Point on outer wall</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   Vector&lt;double&gt; r_outer(2);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_outer);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <span class="comment">// Point on inner wall</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   Vector&lt;double&gt; r_inner(2);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_inner);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="comment">// Get layer</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;     f[i]=r_inner[i]+(r_outer[i]-r_inner[i])*(rmax-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   f[2]=zmin+(zmax-zmin)*(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[1]+1.0));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }      </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">/// Front face of a macro element \f$ s \in [-1,1]*[-1,1] \f$</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#a85aaa5d1217c49e2144bbfd37dbad0fd">  433</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a85aaa5d1217c49e2144bbfd37dbad0fd">QuarterPipeDomain::r_F</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                             <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>, </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                             Vector&lt;double&gt;&amp; f,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  {                                   </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   Vector&lt;double&gt; x(1);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   x[0]=thetamax+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[0]+1.0))*(thetamin-thetamax);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="comment">// Point on outer wall</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   Vector&lt;double&gt; r_outer(2);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_outer);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="comment">// Point on inner wall</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   Vector&lt;double&gt; r_inner(2);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_inner);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="comment">// Get layer</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keywordtype">double</span> rad=rmin+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[1]+1.0))*(rmax-rmin); </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;     f[i]=r_inner[i]+(r_outer[i]-r_inner[i])*(rad-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   f[2]=zmax;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">//=================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">/// Back face of a macro element \f$ s \in [-1,1]*[-1,1] \f$</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="classoomph_1_1QuarterPipeDomain.html#aba1af5e7f1bc6e88ff8e9ee59e965630">  464</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1QuarterPipeDomain.html#aba1af5e7f1bc6e88ff8e9ee59e965630">QuarterPipeDomain::r_B</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>, </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                             <span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>, </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                             Vector&lt;double&gt;&amp; f,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; rmax,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; thetamax,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmin, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; zmax)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  { </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   Vector&lt;double&gt; x(1);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   x[0]=thetamax+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[0]+1.0))*(thetamin-thetamax);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="comment">// Point on outer wall</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   Vector&lt;double&gt; r_outer(2);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">Outer_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_outer);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="comment">// Point on inner wall</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   Vector&lt;double&gt; r_inner(2);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <a class="code" href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">Inner_boundary_cross_section_pt</a>-&gt;position(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a>,x,r_inner);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <span class="comment">// Get layer</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <span class="keywordtype">double</span> rad=rmin+(0.5*(<a class="code" href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a>[1]+1.0))*(rmax-rmin); </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;     f[i]=r_inner[i]+(r_outer[i]-r_inner[i])*(rad-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>)/(<a class="code" href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">Rmax</a>-<a class="code" href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">Rmin</a>);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   f[2]=zmin;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  } </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;}<span class="comment">// endofnamespace</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a035e27884c0fa1bc31d1d9bed28c37bd"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a035e27884c0fa1bc31d1d9bed28c37bd">oomph::QuarterPipeDomain::axial_spacing_fct</a></div><div class="ttdeci">double axial_spacing_fct(const double &amp;xi)</div><div class="ttdoc">Function that implements axial spacing of macro elements.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00108">quarter_pipe_domain.h:108</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_aa2731d4c5fb22dc0a5d2faa32f99505e"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#aa2731d4c5fb22dc0a5d2faa32f99505e">oomph::QuarterPipeDomain::axial_spacing_fct_pt</a></div><div class="ttdeci">AxialSpacingFctPt &amp; axial_spacing_fct_pt()</div><div class="ttdoc">Function pointer for function that implements axial spacing of macro elements.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00101">quarter_pipe_domain.h:101</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a18ac22546af74ac9b76a870d3f5abe3d"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a18ac22546af74ac9b76a870d3f5abe3d">oomph::QuarterPipeDomain::Nr</a></div><div class="ttdeci">unsigned Nr</div><div class="ttdoc">Number of elements radial direction.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00128">quarter_pipe_domain.h:128</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_aba1af5e7f1bc6e88ff8e9ee59e965630"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#aba1af5e7f1bc6e88ff8e9ee59e965630">oomph::QuarterPipeDomain::r_B</a></div><div class="ttdeci">void r_B(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;f, const double &amp;rmin, const double &amp;rmax, const double &amp;thetamin, const double &amp;thetamax, const double &amp;zmin, const double &amp;zmax)</div><div class="ttdoc">Boundary of macro element zeta .</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00464">quarter_pipe_domain.h:464</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_aeb6e4d3fbb8afb4ad2597601f1a46afd"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#aeb6e4d3fbb8afb4ad2597601f1a46afd">oomph::QuarterPipeDomain::r_D</a></div><div class="ttdeci">void r_D(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;f, const double &amp;rmin, const double &amp;rmax, const double &amp;thetamin, const double &amp;thetamax, const double &amp;zmin, const double &amp;zmax)</div><div class="ttdoc">Boundary of macro element zeta .</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00368">quarter_pipe_domain.h:368</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_adad2a4e638bb58eda89a19eaf5e18969"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#adad2a4e638bb58eda89a19eaf5e18969">oomph::QuarterPipeDomain::Outer_boundary_cross_section_pt</a></div><div class="ttdeci">GeomObject * Outer_boundary_cross_section_pt</div><div class="ttdoc">Geom object representing the outer boundary of the cross section.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00144">quarter_pipe_domain.h:144</a></div></div>
<div class="ttc" id="afsi__collapsible__channel__adapt_8txt_html_a152339e6ee653f666802b0f8708a0ec3"><div class="ttname"><a href="fsi__collapsible__channel__adapt_8txt.html#a152339e6ee653f666802b0f8708a0ec3">t</a></div><div class="ttdeci">t_0 \f$ and \f$ t=t_0+\Delta t \f$. At \f$ t=t_0+2 \Delta t \f$, the automatic mesh adaptation splits one of the fluid elements, creating the five new \c Nodes, shown in red(for simplicity we only show the fluid elements' vertex nodes). Their position is determined by the father element 's \c MacroElement mapping, using the current position of the \c MeshAsGeomObject, obtained from the interpolation between the nodal positions of its \c SolidNodes(shown as green circles). @I w 0.75\textwidth history_values &quot;Sketch illustrating the assignment of positional history values for newly-created nodes in FSI problems. The positional history values of the newly-created Nodes (shown in red) are given by the positions they would have had if they had already existed at previous timesteps. &quot; So far, so good! A subtle problem arises when we try to assign the positional history values for the newly-created \c Nodes. The evaluation of the \c MacroElement mapping at the previous timesteps(required to determine the positions the newly-created \c Nodes would have had, if they had already existed at previous timesteps) requires access to the previous wall shapes. In&lt; A HREF=&quot;../../../navier_stokes/collapsible_channel/html/index.html&quot;&gt; the non-FSI problem discussed earlier&lt;/A &gt;, the wall shape was given analytically and could therefore be evaluated at arbitrary times. In the FSI problem considered here, the previous wall shape is not available as the previous positions of the \c SolidNodes are not required(and are therefore not stored) for the solution of the(steady!) wall equations.&lt; HR &gt; \subsection soln The solution:The Steady&lt; NSTEPS &gt; timestepper The solution to the problem is simple:Recall that the final entry in the argument list of \c oomph-lib 's mesh constructors specifies the \c TimeStepper to be used for the evaluation of any time-derivatives. The \c TimeStepper 's member function \c TimeStepper::ntstorage() specifies the total number of values(the current value plus the number of history values) required to evaluate the time-derivatives t</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel__adapt_8txt_source.html#l00100">fsi_collapsible_channel_adapt.txt:100</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a872560e53bf73ef0bd1b69f2a40612c8"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a872560e53bf73ef0bd1b69f2a40612c8">oomph::QuarterPipeDomain::~QuarterPipeDomain</a></div><div class="ttdeci">~QuarterPipeDomain()</div><div class="ttdoc">Destructor:</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00088">quarter_pipe_domain.h:88</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_aab6f3fd79bc6dea1eb267f3b55630a2b"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#aab6f3fd79bc6dea1eb267f3b55630a2b">oomph::QuarterPipeDomain::r_R</a></div><div class="ttdeci">void r_R(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;f, const double &amp;rmin, const double &amp;rmax, const double &amp;thetamin, const double &amp;thetamax, const double &amp;zmin, const double &amp;zmax)</div><div class="ttdoc">Boundary of macro element zeta .</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00328">quarter_pipe_domain.h:328</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a2760038e136d58a41dcbcd045bd13ae4"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a2760038e136d58a41dcbcd045bd13ae4">oomph::QuarterPipeDomain::Inner_boundary_cross_section_pt</a></div><div class="ttdeci">GeomObject * Inner_boundary_cross_section_pt</div><div class="ttdoc">Geom object representing the inner boundary of the cross section.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00148">quarter_pipe_domain.h:148</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a85aaa5d1217c49e2144bbfd37dbad0fd"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a85aaa5d1217c49e2144bbfd37dbad0fd">oomph::QuarterPipeDomain::r_F</a></div><div class="ttdeci">void r_F(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;f, const double &amp;rmin, const double &amp;rmax, const double &amp;thetamin, const double &amp;thetamax, const double &amp;zmin, const double &amp;zmax)</div><div class="ttdoc">Boundary of macro element zeta .</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00433">quarter_pipe_domain.h:433</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a5e2252883456cd65902663fda09296d5"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a5e2252883456cd65902663fda09296d5">oomph::QuarterPipeDomain::Rmax</a></div><div class="ttdeci">double Rmax</div><div class="ttdoc">Outer radius.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00137">quarter_pipe_domain.h:137</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_ada15e8a576d3715e8ed88ea9bef5508a"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#ada15e8a576d3715e8ed88ea9bef5508a">oomph::QuarterPipeDomain::Axial_spacing_fct_pt</a></div><div class="ttdeci">AxialSpacingFctPt Axial_spacing_fct_pt</div><div class="ttdoc">Function pointer for function that implements axial spacing of macro elements.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00152">quarter_pipe_domain.h:152</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_aab1bf3900c3537c44942e3fee0c3d24e"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#aab1bf3900c3537c44942e3fee0c3d24e">oomph::QuarterPipeDomain::Nz</a></div><div class="ttdeci">unsigned Nz</div><div class="ttdoc">Number of elements axial direction.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00131">quarter_pipe_domain.h:131</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_ac71370e6c78fd37aa59e7a52d62d1cbe"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#ac71370e6c78fd37aa59e7a52d62d1cbe">oomph::QuarterPipeDomain::Rmin</a></div><div class="ttdeci">double Rmin</div><div class="ttdoc">Inner radius.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00134">quarter_pipe_domain.h:134</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a0798f3962e840bdb3d31e4e0dada055d"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a0798f3962e840bdb3d31e4e0dada055d">oomph::QuarterPipeDomain::Length</a></div><div class="ttdeci">double Length</div><div class="ttdoc">Length.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00140">quarter_pipe_domain.h:140</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a540d441b38146aacb12938d5f885789c"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a540d441b38146aacb12938d5f885789c">oomph::QuarterPipeDomain::AxialSpacingFctPt</a></div><div class="ttdeci">double(* AxialSpacingFctPt)(const double &amp;xi)</div><div class="ttdoc">Typedef for function pointer for function that implements axial spacing of macro elements.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00097">quarter_pipe_domain.h:97</a></div></div>
<div class="ttc" id="afsi__collapsible__channel__adapt_8txt_html_a9c6741891789e8156d85c39d4e3adaa7"><div class="ttname"><a href="fsi__collapsible__channel__adapt_8txt.html#a9c6741891789e8156d85c39d4e3adaa7">GeomObject</a></div><div class="ttdeci">this is used if there is only a single node update as in the c AlgebraicCollapsibleChannelMesh n n A vector such as the intrinsic coordinates of reference points on the c GeomObjects n n By we assume that a newly created c AlgebraicNode is updated by the same node update function as the c AlgebraicNodes in its father element Therefore we pass the pointer to the c the node update function and the vector of pointers to c GeomObjects to the newly created c and interpolate the reference values between those stored at the c AlgebraicNodes in the father elements In most cases this provides a sensible default For it is hard to imagine a situation in which it would be sensible to update the position of newly created c AlgebraicNodes by a procedure that differs from that used for the surrounding c AlgebraicNodes that already existed in the father element since the reference values vary from node to in the c AlgebraicCollapsibleChannelMesh one of the reference values is the f x_1 f coordinate of the reference point on the fixed lower wall For the c AlgebraicNodes that already existed in the coarse base this value is given by the the c AlgebraicNodes f x_1 f coordinate in the undeformed mesh Interpolation of this value for the newly created c AlgebraicNodes results in an axially uniform subdivision of the refined elements The same procedure may be used to assign the reference value that represents the intrinsic coordinate of the reference point on the upper wall at least as long as the upper wall is only ever addressed as a compound c GeomObject</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel__adapt_8txt_source.html#l00226">fsi_collapsible_channel_adapt.txt:226</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="annular__domain_8h_source.html#l00034">annular_domain.h:34</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_ab6aec719fb0b333abf3ef9a1bf0414ac"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#ab6aec719fb0b333abf3ef9a1bf0414ac">oomph::QuarterPipeDomain::operator=</a></div><div class="ttdeci">void operator=(const QuarterPipeDomain &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00082">quarter_pipe_domain.h:82</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a21c58b76f546300c308d6e1f303a3433"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a21c58b76f546300c308d6e1f303a3433">oomph::QuarterPipeDomain::r_L</a></div><div class="ttdeci">void r_L(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;f, const double &amp;rmin, const double &amp;rmax, const double &amp;thetamin, const double &amp;thetamax, const double &amp;zmin, const double &amp;zmax)</div><div class="ttdoc">Boundary of macro element zeta .</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00292">quarter_pipe_domain.h:292</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a3b79d0bf40336f7961a8b2bb58080dba"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a3b79d0bf40336f7961a8b2bb58080dba">oomph::QuarterPipeDomain::default_axial_spacing_fct</a></div><div class="ttdeci">static double default_axial_spacing_fct(const double &amp;xi)</div><div class="ttdoc">Default for function that implements axial spacing of macro elements.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00156">quarter_pipe_domain.h:156</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a5c023c7a9d6e43d123566bc2f7bb21f0"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a5c023c7a9d6e43d123566bc2f7bb21f0">oomph::QuarterPipeDomain::r_U</a></div><div class="ttdeci">void r_U(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;f, const double &amp;rmin, const double &amp;rmax, const double &amp;thetamin, const double &amp;thetamax, const double &amp;zmin, const double &amp;zmax)</div><div class="ttdoc">Boundary of macro element zeta .</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00400">quarter_pipe_domain.h:400</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_aeb912b40da8cd2883768fe2ca989e640"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#aeb912b40da8cd2883768fe2ca989e640">oomph::QuarterPipeDomain::Ntheta</a></div><div class="ttdeci">unsigned Ntheta</div><div class="ttdoc">Number of elements azimuthal direction.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00125">quarter_pipe_domain.h:125</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html">oomph::QuarterPipeDomain</a></div><div class="ttdoc">Domain representing a quarter pipe.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00042">quarter_pipe_domain.h:42</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_a09e3620b090b3bae5d2bf8c2e6ac9812"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#a09e3620b090b3bae5d2bf8c2e6ac9812">oomph::QuarterPipeDomain::QuarterPipeDomain</a></div><div class="ttdeci">QuarterPipeDomain(const QuarterPipeDomain &amp;)</div><div class="ttdoc">Broken copy constructor.</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00075">quarter_pipe_domain.h:75</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_ae8cc6433c58dcfb265335744ed8a330a"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#ae8cc6433c58dcfb265335744ed8a330a">oomph::QuarterPipeDomain::macro_element_boundary</a></div><div class="ttdeci">void macro_element_boundary(const unsigned &amp;t, const unsigned &amp;i_macro, const unsigned &amp;i_direct, const Vector&lt; double &gt; &amp;s, Vector&lt; double &gt; &amp;f)</div><div class="ttdoc">Vector representation of the i_macro-th macro element boundary i_direct (U/D/L/R/F/B) at time level t...</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00214">quarter_pipe_domain.h:214</a></div></div>
<div class="ttc" id="afsi__collapsible__channel__adapt_8txt_html_abe1a872647b7cfc1c732b57adef7d1b9"><div class="ttname"><a href="fsi__collapsible__channel__adapt_8txt.html#abe1a872647b7cfc1c732b57adef7d1b9">s</a></div><div class="ttdeci">respectively The red arrow identifies the reference point for the newly created node VI whose reference coordinate f IV and i e the nodes in its father element I w textwidth update_single Illustration of the default update procedure for the node update IV and V in its father element the default assignment is not appropriate for nodes that are updated by and the values of the coordinate at which the reference points are located This is illustrated in the sketch below in which the sub c parametrised by their coordinates f s</div><div class="ttdef"><b>Definition:</b> <a href="fsi__collapsible__channel__adapt_8txt_source.html#l00254">fsi_collapsible_channel_adapt.txt:254</a></div></div>
<div class="ttc" id="aclassoomph_1_1QuarterPipeDomain_html_afb9763dac929fd4371a6ef860d9a5caf"><div class="ttname"><a href="classoomph_1_1QuarterPipeDomain.html#afb9763dac929fd4371a6ef860d9a5caf">oomph::QuarterPipeDomain::QuarterPipeDomain</a></div><div class="ttdeci">QuarterPipeDomain(const unsigned &amp;ntheta, const unsigned &amp;nr, const unsigned &amp;nz, const double &amp;rmin, const double &amp;rmax, const double &amp;length)</div><div class="ttdoc">Constructor: Pass number of elements in various directions, the inner and outer radius and the length...</div><div class="ttdef"><b>Definition:</b> <a href="quarter__pipe__domain_8h_source.html#l00049">quarter_pipe_domain.h:49</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Aug 4 2021 20:27:31
        </div>
      </div>
    </footer>
</body>
</html>

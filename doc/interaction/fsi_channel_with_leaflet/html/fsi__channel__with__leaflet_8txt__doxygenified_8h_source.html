<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: fsi_channel_with_leaflet.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fsi_channel_with_leaflet.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fsi__channel__with__leaflet_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: Flow in a 2D channel with an elastic leaflet </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">In this example we consider the flow in a 2D channel which is partially</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">obstructed by an elastic leaflet -- the  FSI generalisation of the</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../navier_stokes/channel_with_leaflet/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">Navier-Stokes problem in which the motion of the leaflet is</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">prescribed.&lt;/A&gt; A particular feature of this problem is that the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">leaflet (modelled as a thin-walled beam structure) is totally immersed</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">in the fluid and is therefore exposed to the fluid traction from</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">both sides. </span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">The problem presented here was used as one of the test cases</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">for \c oomph-lib&#39;s FSI preconditioner; see \n\n</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">&lt;A href=&quot;http://www.maths.man.ac.uk/~mheil/oomph_lib_additional_material/HeilHazelBoyleCompMech/HeilHazelBoyleCompMech.pdf&quot;&gt;Heil, M., Hazel, A.L. &amp; Boyle, J. (2008): Solvers for large-displacement fluid-structure interaction problems: Segregated vs. monolithic approaches. Computational Mechanics.&lt;/A&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">In this tutorial we concentrate on the problem formulation. </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">The application of the preconditioner is discussed </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt;elsewhere&lt;/a&gt; --</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">the required source code is contained in the</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;A href=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt;driver code.&lt;/A&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">\section the_problem The Problem</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">The figure below shows a sketch of the problem:  A 2D channel of</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">height  \f$ H^*_{tot}\f$ and length \f$ L^*_{left} + L^*_{right} \f$ </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">is partially occluded by a thin-walled elastic leaflet of height </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">\f$ H^*_{leaflet} \f$. (As usual, we use asterisks to distinguish</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">dimensional quantities from their non-dimensional equivalents to be</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">introduced later.) We assume that the leaflet is</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">sufficiently thin so that, as far as the boundary conditions</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">for the fluid are concerned, the leaflet can be assumed to </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">be infinitely thin. This allows us to parametrise its shape </span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">by a single Lagrangian coordinate \f$ \xi^* \f$. Hence we write the</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">position vector to a material point on the leaflet as</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">\f$ {\bf R}^*_w(\xi^*,t^*) \f$. </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">A pulsatile Poiseuille flow whose mean velocity fluctuates between</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">\f$ U^* \f$ and \f$ 2 U^* \f$ is imposed at the upstream end of the</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">channel. The outflow is assumed to be parallel and axially </span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">traction-free.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">\image html fsi_channel_with_leaflet_dim.gif &quot;Sketch of the problem. &quot; </span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\image latex fsi_channel_with_leaflet_dim.eps &quot;Sketch of the problem. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">We non-dimensionalise all length and coordinates on the channel </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">width, \f$ H^*_{tot} \f$ , time on the natural timescale of the flow,</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">\f$ H^*_{tot}/U^* \f$, the velocities on the (minimum) mean velocity,  </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\f$ U^* \f$, and the pressure on the viscous scale. </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">The fluid flow is then governed by the non-dimensional Navier-Stokes equations</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">Re \left( St \frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">u_j \frac{\partial u_i}{\partial x_j} \right) =</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i}  +</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left[ \left(</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right) \right],</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">where \f$ Re = \rho U^* H_0^* / \mu \f$ and \f$ St = 1 \f$,</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0,</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">subject to a time-periodic, parabolic inflow with non-dimensional</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">period \f$ T \f$,</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">{\bf u} = 6 x_2 (1-x_2) \left( 1 + \frac{1}{2} (1-\cos(2 \pi t/T)) \right) </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">{\bf e}_1</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">in the inflow cross-section; parallel, axially-traction-free outflow</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">at the outlet; and no-slip on the stationary channel walls, </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">\f$ {\bf u} = {\bf 0} \f$. The no-slip condition on the</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">leaflet is</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">{\bf u} = \frac{\partial {\bf R}_w(\xi,t)}{\partial t}.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">We model the leaflet as a thin-walled, massless, elastic Kirchhoff-Love</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">beam of wall thickness \f$ h^* \f$. The beam&#39;s effective (1D) elastic modulus</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">is given by \f$ E_{eff} = E/(1-\nu^2), \f$ where \f$ E \f$ and \f$ \nu \f$</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">are its 3D Young&#39;s modulus and Poisson&#39;s ratio, respectively.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">The beam&#39;s deformation is governed by the principle of virtual</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">displacements, discussed in detail </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt;in another </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">tutorial.&lt;/A&gt; </span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">As in the Navier-Stokes equations, we scale all lengths in</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">the beam problem on the channel&#39;s width, \f$ H^*_{tot}. \f$ The</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">non-dimensional position vector</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">\f$ {\bf r}_w(\xi) \f$ to the undeformed wall is then given by</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">{\bf r}_w(\xi) = </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">{\bf R}_w(\xi,t=0) = </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">X_0  \\</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\xi</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">\right) \ \ \ \ \ \ \mbox{where $\xi \in [0,H_{leaflet}].$}</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">Our non-dimensionalisation of the principle of virtual displacements</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">requires all stresses and tractions to be non-dimensionalised </span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">on the beam&#39;s (effective 1D) elastic modulus, \f$ E_{eff} \f$. </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">The non-dimensional load vector \f$ {\bf f} = {\bf f}^{*}/E_{eff} \f$ </span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">that acts on the leaflet (combining the fluid tractions acting</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">on its front and back faces) is then given by</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">f_i = Q \bigg\{ </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">\left( p\big|_{front} \ N_i^{[front]} -</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">\right)\bigg|_{front} N_j^{[front]} \right)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">+</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">. \hspace{3cm} + \left( p\big|_{back} \ N_i^{[back]} -</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">\right)\bigg|_{back} N_j^{[back]} \right) </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">\bigg\}</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">\ \ \ \ \ \ \mbox{for $i=1,2,$}</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">Q = \frac{\mu U}{E_{eff} H_{tot}^*}</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">is the ratio of the fluid pressure scale, \f$ \mu U/H_{tot}^* \f$ ,</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">used to non-dimensionalise the Navier-Stokes equations, to the</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">beam&#39;s effective elastic modulus, \f$ E_{eff} \f$. The parameter \f$ Q</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">\f$ therefore indicates the strength of the fluid-structure</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">interaction. In particular, if \f$ Q=0 \f$ the leaflet does not</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">&quot;feel&quot; the fluid traction. \f$ {\bf N}_{front} \f$ and </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">\f$ {\bf N}_{back} \f$ are the outer unit normals on the &quot;front&quot; and &quot;back&quot;</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">faces of the deformed leaflet, as shown in this sketch of </span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">the non-dimensional version of the problem: </span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">\image html fsi_channel_with_leaflet.gif &quot;Sketch of the problem in dimensionless variables. &quot; </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">\image latex fsi_channel_with_leaflet.eps &quot;Sketch of the problem in dimensionless variables. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">The figure below shows (a) a snapshot of the flow field  </span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">(pressure contours and instantaneous streamlines) and (b) the time-trace</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">of the horizontal position of the leaflet&#39;s tip for a Reynolds number</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">of \f$ Re = 200 \f$, a non-dimensional period of \f$ T=2 \f$,</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">and an interaction parameter of \f$ Q = 10^{-6}</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">\f$. Following the decay of initial transients the leaflet performs</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">periodic large-amplitude oscillations with the period of the pulsating</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">inflow.  Large velocity gradients develop at the front of the leaflet and </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">in the shear layer that emanates from its tip and separates the </span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">recirculating flow region behind the leaflet from the main flow.  Fig. (c) </span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">illustrates the non-uniform mesh refinement and shows</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">the improved resolution in the high-shear regions, particularly near </span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">the leaflet&#39;s tip where the pressure is singular. The mesh was </span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">continuously adapted throughout the simulation and contained an average of</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">about 32,000 degrees of freedom. This is a fraction of the 1,324,343 degrees </span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">of freedom that would be required to achieve the same local resolution via </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">uniform mesh refinement.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">\image html flow_from_paper.gif &quot;Computational results. &quot; </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">\image latex flow_from_paper.eps &quot;Computational results. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">The corresponding &lt;A HREF=&quot;../figures/fsi_channel_with_leaflet_flow.avi&quot;&gt;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">animation&lt;/A&gt; illustrates the algebraic node update strategy </span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">(implemented with an \c AlgebraicMesh, discussed in more detail</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">in  &lt;A HREF=&quot;../../fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">another tutorial&lt;/A&gt;) and the evolution of</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">the flow field. Note that the instantaneous streamlines intersect</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">the (impermeable) leaflet because the leaflet is not stationary. </span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">The animation shows how the mesh adapts itself to changes in the flow</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">field -- using much smaller elements in high-shear regions,</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">including the artificial outflow boundary layer that is created</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">by the imposition of parallel outflow in a region where the </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">flow is far from fully-developed.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">\section parameters The global parameters</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">As usual we use a namespace to define the problem parameters:</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">The Reynolds number and its product with the Strouhal number </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">(both initialised to 50),</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">\dontinclude fsi_channel_with_leaflet.cc</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">\skipline start_of_global_parameters</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">\until ReSt=50.0;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">the leaflet&#39;s non-dimensional wall thickness, \f$ h = h^*/</span><a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">H</a>^*<a class="code" href="fsi__channel__with__leaflet_8txt.html#a67449ddd13526d7fe38a05989d83024e">_</a>{tot}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">\f</a>$, <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> FSI <a class="code" href="fsi__channel__with__leaflet_8txt.html#a4af603fc4c1619d83f53265a371e9941">parameter</a>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">\until</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a5b052db3a93fe3ee2945af0117375d3d">Q</a>=1.0e-6; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a93ba8afbc1ac7bd561a42939f0da10dd">parameters</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> define <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> magnitude of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> pulsating inflow.</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;\until end_of_namespace</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;&lt;HR&gt;  </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">\section</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> The undeformed <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;We use a \c GeomObject to describe <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a>, stress-free shape</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> elastic <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a>: a vertical straight line. The member function</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;\c d2position(...) provides <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> first <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> second derivatives of</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> position vector, as required by <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> variational principle</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> governs <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> beam&#39;s <a class="code" href="fsi__channel__with__leaflet_8txt.html#a0bc5d73f4ec8d09587bf603929fdb61c">deformation</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;see &lt;A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> beam theory tutorial for details. &lt;/A&gt;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;\skipline start_of_undeformed_leaflet</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> end_of_undeformed_wall</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">section</a> <a class="code" href="fsi__channel__with__leaflet_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> The driver code</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;As with most time-dependent demo <a class="code" href="fsi__channel__with__leaflet_8txt.html#a7e58cb9b843665019b338e942240e67e">codes</a>, <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> specification of </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;a non-zero number of command line arguments will be interpreted </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;as <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> code being run as part  of \c oomph-lib&#39;s self-test in which</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;case only a few <a class="code" href="fsi__channel__with__leaflet_8txt.html#a809303b96330f4d120002050282e3ae1">timesteps</a> will be performed. Therefore we start by storing</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> command line arguments in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> namespace \c CommandLineArgs</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;to make them accessible throughout <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> code.</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;\skipline start_of_main</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> ::setup(</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;Next we specify <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> geometry <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a93ba8afbc1ac7bd561a42939f0da10dd">parameters</a>, <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> build </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> \c Problem <span class="keywordtype">object</span>, using <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> \c AlgebraicElement version of</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> two-dimensional \c RefineableQTaylorHoodElements.</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> ,ny2,x_0);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;We prepare a \c DocInfo <span class="keywordtype">object</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> open a trace file to document</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> system&#39;s evolution.</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> trace.open</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;Next we assign <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> timestepping <a class="code" href="fsi__channel__with__leaflet_8txt.html#a93ba8afbc1ac7bd561a42939f0da10dd">parameters</a> (using fewer <a class="code" href="fsi__channel__with__leaflet_8txt.html#a809303b96330f4d120002050282e3ae1">timesteps</a> if <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;code is run during a self-test) <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> document <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> system&#39;s <a class="code" href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a> </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;state which provides <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af0e84ca9572abef167dabb1d2b59d6f7">guess</a> for <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> Newton iteration in </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> subsequent steady solve.</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> doc_info.number()++; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;We wish to start <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> time-dependent simulation from an <a class="code" href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;condition <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> corresponds to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> steady solution of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a> </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;with unit <a class="code" href="fsi__channel__with__leaflet_8txt.html#ab98838d1085f3365366a7213b4a146b8">influx</a> (i.e. <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> steady solution obtained if <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;time-dependent boundary condition <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> is applied at <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> inlet is held</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;fixed at its value for \<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a>$ t= 0 \<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a>$). For <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> required</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;Reynolds number of \<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a>$ <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9a15a4e12ba10c0745f4eb8e891e41ec">Re</a>=200 \<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a>$, <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> currently assigned</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af0e84ca9572abef167dabb1d2b59d6f7">guess</a> (zero velocity <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> pressure, with <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> wall  </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;in its undeformed position) is &quot;too far&quot; from <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> actual solution</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> Newton method would diverge (try it!). Therefore we</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;generate <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a> steady solution in a preliminary sequence</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;of steady computations in which we first compute <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> solution for</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;a Reynolds number of  \<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a>$ <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9a15a4e12ba10c0745f4eb8e891e41ec">Re</a>=50 \<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a>$ (for this value <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> Newton </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;method does converge).</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;This solution is <a class="code" href="fsi__channel__with__leaflet_8txt.html#a5154e015d549544a76116ffb507f7e02">then</a> used as <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af0e84ca9572abef167dabb1d2b59d6f7">guess</a> for <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> computation</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;at  \<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a>$ <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9a15a4e12ba10c0745f4eb8e891e41ec">Re</a>=100 \<a class="code" href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a>$, etc. We allow for up to 3 <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> adaptations </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;for each Reynolds number to allow <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> to adapt itself to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a5db5860dbc53a1c30bbcf5ce59f9715d">flow</a></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a81f62a6d87a20cfe1459e35dbeeb99da">conditions</a> before starting <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> time-dependent run.</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> reached final Reynolds number</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a6e82490b1ad3f2c80ea94a70b0eab909">Finally</a>, we start <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> proper timestepping <a class="code" href="fsi__channel__with__leaflet_8txt.html#a63d53108aaf6a609e12f63d26927620e">procedure</a>, allowing for</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;one <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> adaptation per timestep <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> suppressing <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> re-assignment</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a> condition after <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> adaptation by setting</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> \c first flag to false.</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> }<span class="comment">//end of main</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">section</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a> The Problem class</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;The \c Problem class contains <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> usual member functions, most of which</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;are either empty or explained in more detail below. </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;\dontinclude fsi_channel_with_leaflet.cc</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;\skipline start_of_problem_class</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> doc_solution</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;Two member functions are implemented here: The function </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;\c actions_before_implicit_timestep() updates <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> time-dependent</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;velocity profile at <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> upstream boundary (boundary 3; see <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;enumeration of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundaries in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;&lt;A HREF=&quot;../../../meshes/mesh_list/html/index.html<span class="preprocessor">#channel_with_leaflet&quot;&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;&lt;CODE&gt;ChannelWithLeafletMesh&lt;/CODE&gt;&lt;/A&gt;):</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a>   } <span class="comment">// end of actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;Since <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> node-update is performed by an algebraic node-update</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a63d53108aaf6a609e12f63d26927620e">procedure</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> nodal positions in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> must be </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;updated whenever any of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> (solid) degrees-of-<a class="code" href="fsi__channel__with__leaflet_8txt.html#a13f24d2daeab0c2bd43ad2efbabb3f9e">freedom</a> change.</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;This is done automatically during <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> computation of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> shape</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;derivatives (implemented in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> \c AlgebraicElement wrapper <span class="keyword">class</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;described &lt;A HREF=&quot;../../fsi_collapsible_channel_algebraic/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;another tutorial&lt;/A&gt;), but an additional node update must be performed</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;when <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> unknowns are updated by <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> Newton solver. This</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;is achieved by performing a further node-update in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> function </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;\c actions_before_newton_convergence_check():</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;The private member data contains <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> usual pointers to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> \c</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;Problem<span class="stringliteral">&#39;s two sub-meshes,</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="stringliteral">the pointer to \c GeomObject that represents the leaflet, and</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="stringliteral">the total height of the channel.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="stringliteral">\until };</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="stringliteral">&lt;HR&gt;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="stringliteral">&lt;HR&gt;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="stringliteral">\section constructor The problem constructor</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="stringliteral">We start the problem construction by creating two timesteppers:</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="stringliteral">A \c BFD&lt;2&gt; timestepper for the fluid and the fake timestepper</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="stringliteral">\c Steady&lt;2&gt; for the (massless) solid. </span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="stringliteral">(&lt;A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt;Recall </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="stringliteral">&lt;/A&gt; that timesteppers</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="stringliteral">from the \c Steady family return zero time-derivatives but keep </span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="stringliteral">track of the past histories. These are needed during the adaptive</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="stringliteral">refinement of the fluid mesh: when assigning the history of the</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="stringliteral">previous nodal positions for newly created fluid nodes, we must</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="stringliteral">evaluate the position of the leaflet at previous timesteps; this is</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="stringliteral">discussed in more detail in </span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="stringliteral">&lt;A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="stringliteral">another tutorial&lt;/A&gt;.)</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="stringliteral">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="stringliteral">\until add_time_stepper_pt(wall_time_stepper_pt);</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="stringliteral">Next we create the mesh of 1D Hermite beam elements that represents</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="stringliteral">the leaflet, passing a pointer to an instance of the \c</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="stringliteral">UndeformedLeaflet to its constructor.</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="stringliteral">\until ,undeformed_wall_pt,wall_time_stepper_pt);</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="stringliteral">The wall mesh defines the geometry of the deformed leaflet, therefore</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="stringliteral">we create a \c GeomObject representation of that mesh, using the</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="stringliteral">\c MeshAsGeomObject class, and pass it to the constructor of the fluid mesh:</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="stringliteral">\until  fluid_time_stepper_pt);</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="stringliteral">We specify an error estimator for the fluid mesh</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="stringliteral">and add both meshes to the \c Problem before combining them</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="stringliteral">into a global mesh.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="stringliteral">\until  build_global_mesh();</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="stringliteral">Dirichlet conditions (prescribed velocity) are applied on virtually</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="stringliteral">all boundaries of the fluid domain (prescribed inflow at the inlet;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="stringliteral">zero velocity on the rigid channel walls; fluid velocity prescribed</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="stringliteral">by the wall motion on the leaflet), apart from the outflow</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="stringliteral">(boundary 1; see the enumeration of the mesh boundaries in the</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="stringliteral">&lt;A HREF=&quot;../../../meshes/mesh_list/html/index.html#channel_with_leaflet&quot;&gt;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="stringliteral">&lt;CODE&gt;ChannelWithLeafletMesh&lt;/CODE&gt;&lt;/A&gt;) where the axial velocity </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="stringliteral">is unknown (and determined indirectly</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="stringliteral">by the &quot;axially-traction-free&quot; condition) while the vertical</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="stringliteral">velocity has to be set to zero to ensure parallel outflow.</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="stringliteral">\until end loop over boundaries</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="stringliteral">Next we assign the parabolic velocity profile at the inlet</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="stringliteral">(recall that all values are initialised to zero so no further action</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="stringliteral">is required on any of the other Dirichlet boundaries). </span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="stringliteral">\until  }// end of setup boundary condition</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="stringliteral">The leaflet is clamped at its lower end so we pin its \f$x_1\f$- and</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="stringliteral">\f$x_2\f$-positions, and impose a vertical slope by setting \f$ dx_1/ds = 0 \f$</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="stringliteral">(where s is the local coordinate along the element; see the</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="stringliteral">discussion of the boundary conditions for beam elements in </span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="stringliteral">&lt;A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt;another</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="stringliteral">tutorial&lt;/A&gt; for details).</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="stringliteral">\until pin_position(1,0)</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="stringliteral">Next, we complete the build of the fluid elements by passing </span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="stringliteral">pointers to the relevant physical parameters to the elements</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="stringliteral">and pinning any redundant pressure degrees of freedom; see</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="stringliteral">&lt;A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="stringliteral">another tutorial&lt;/A&gt; for details.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="stringliteral">\until pin_redundant</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="stringliteral"> When completing the build of the wall elements we use the function</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="stringliteral">\c enable_fluid_loading_on_both_sides() to indicate that</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="stringliteral">the leaflet is completely immersed in the fluid so that</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="stringliteral">fluid tractions act on both of its faces. When setting up the</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="stringliteral">fluid-structure interaction below, one of the two faces</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="stringliteral">will have to be identified as the &quot;front&quot; (face 0) and the other</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="stringliteral">one as the &quot;back&quot; (face 1). The function \c normal_points_into_fluid()</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="stringliteral">allows us to indicate if the outer unit normal on the leaflet </span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="stringliteral">(as computed by \c FSIHermiteBeamElement::get_normal(...) points</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="stringliteral">into the fluid, when viewed from the &quot;front&quot; face. Here it does not --</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="stringliteral">see \ref comm for more details on this slightly subtle point). </span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="stringliteral">\until // end of loop over elements</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="stringliteral">We can now set up the fluid structure interaction. The motion of the</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="stringliteral">leaflet determines the fluid velocity of all nodes on boundaries 4 and 5</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="stringliteral">via the no-slip condition (see the enumeration of the mesh boundaries in the</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="stringliteral">&lt;A HREF=&quot;../../../meshes/mesh_list/html/index.html#channel_with_leaflet&quot;&gt;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="stringliteral">&lt;CODE&gt;ChannelWithLeafletMesh&lt;/CODE&gt;&lt;/A&gt;). The fluid velocity at these nodes can be updated</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="stringliteral">automatically whenever a fluid node is moved (by the fluid mesh&#39;</span>s</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;node-update function) by specifying an auxiliary node update function.</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> aux node update fct has been set</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a6e82490b1ad3f2c80ea94a70b0eab909">Finally</a>, we have to determine which fluid elements are adjacent</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> two faces of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> \c FSIHermiteBeamElements </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;to allow them to compute <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid traction they are exposed to.</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;This is done separately for <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <span class="stringliteral">&quot;front&quot;</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <span class="stringliteral">&quot;back&quot;</span> faces. The</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="stringliteral">&quot;front&quot;</span> of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> (<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a> 0) is assumed to coincide with <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;boundary 4; <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <span class="stringliteral">&quot;back&quot;</span> (<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a> 1) is assumed to coincide with <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;boundary 5.</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a>   (<span class="keyword">this</span>,5,<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>); </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;Following <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> setup of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid-structure interaction we</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;assign <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> equation <a class="code" href="fsi__channel__with__leaflet_8txt.html#a5030e5e476128f5498f50a96ccc79c68">numbers</a>:</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;\skipline   <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">\until</a> cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;\skipline end of constructor</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">\section</a> adapt Actions after <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> adaptation</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;Once <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> has been adapted we free all pressure</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;degrees of <a class="code" href="fsi__channel__with__leaflet_8txt.html#a13f24d2daeab0c2bd43ad2efbabb3f9e">freedom</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a5154e015d549544a76116ffb507f7e02">then</a> (re-)pin any redundant ones;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;see <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> discussion in </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;&lt;A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;another tutorial&lt;/a&gt; for details.</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;\skipline start_of_actions_after_adapt</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> pin_redundant</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;Any newly created fluid nodes on <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> (i.e. on <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundaries 4 <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> 5) must be subjected to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> automatic</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;application of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> no-slip condition. For simplicity </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;we (re-)specify <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> auxiliary node update function pointer</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;for all of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> nodes on those boundaries.</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a>  aux node update fct has been (re-)set</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a6e82490b1ad3f2c80ea94a70b0eab909">Finally</a>, <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> adaptation of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> may change <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;elements <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> are adjacent to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> wall elements so we re-generate <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;corresponding FSI lookup schemes.</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> end_of_actions_after_adapt</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">section</a> doc Post Processing</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;The function \c doc_solution(...) documents <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> results. We output</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> solid meshes <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> document selected additional quantities</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> trace file.</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;\skipline start_of_doc_solution</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;The remaining output is created to determine which elements</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;are located next to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundaries 4 <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> 5</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;(Yes, &lt;a href=&quot;../../../meshes/mesh_list/html/index.html<span class="preprocessor">#channel_with_leaflet&quot;&gt;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> documentation <span class="keywordflow">for</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a>&lt;/A&gt; illustrates <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> enumeration of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;boundaries but we generally prefer to be paranoid; see \ref comm ), </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> to establish <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> direction of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> unit normal on <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> beam. </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a> end_of_doc_solution</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">section</a> comm_ex Further comments <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> exercises</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;\subsection comm Further comments</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;-# &lt;B&gt;How does one identify <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <span class="stringliteral">&quot;front&quot;</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <span class="stringliteral">&quot;back&quot;</span> of an immersed beam</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   structure?&lt;/B&gt; \n\n</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   When setting up <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid-structure interaction in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> \ref constructor</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   we had to associate <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundaries 4 <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> 5 (<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   boundaries adjacent to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> (see <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> enumeration of </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundaries in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   &lt;A HREF=<span class="stringliteral">&quot;../../../meshes/mesh_list/html/index.html#channel_with_leaflet&quot;</span>&gt;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   &lt;CODE&gt;ChannelWithLeafletMesh&lt;/CODE&gt;&lt;/A&gt;) with <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <span class="stringliteral">&quot;front&quot;</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <span class="stringliteral">&quot;back&quot;</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fully immersed beam structure. Furthermore, since <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   computation of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid traction acting on <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> depends on <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   direction of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> normal, <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> normal on <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <span class="stringliteral">&quot;front&quot;</span> of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   points in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> opposite direction to <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> on its <span class="stringliteral">&quot;back&quot;</span> it is</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   important to assess which normal is used in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> automatic </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   computation of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid traction.</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   There are two ways of establishing <span class="keyword">this</span>: \n\n </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   -# &lt;B&gt;Quick <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> dirty:&lt;/B&gt; \n Set </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      \c FSIHermiteBeamElement::normal_points_into_fluid() to \c true</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> perform a steady computation. If <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> is sucked</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      towards <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> high-pressure region you got it wrong. \n\n</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   -<span class="preprocessor"># &lt;B&gt;Do it properly:&lt;/B&gt; \n Use the output generated in </span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      \c doc_solution(...) to identify <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> elements adjacent</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundaries 4 <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> 5 (i.e. <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid elements next to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a>&#39;s &quot;front&quot; <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> &quot;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a89a8bbf1f2261d6b35114127e679a44f">back</a>&quot; faces), respectively, <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> normal vector</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      returned by \c FSIHermiteBeamElement::get_normal(...) -- this</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      is <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> normal <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> is used in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> computation of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      traction. The figure below shows a plot of these</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      within an adaptively refined fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a>. \n\n</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;\image html front_and_back.gif &quot;Elements near <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> `front&#39; (red) <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> `<a class="code" href="fsi__channel__with__leaflet_8txt.html#a89a8bbf1f2261d6b35114127e679a44f">back</a>&#39; (green) of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> outer unit normal on <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a>. &quot; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;\image latex front_and_back.eps &quot;Elements near <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> `front&#39; (red) <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> `<a class="code" href="fsi__channel__with__leaflet_8txt.html#a89a8bbf1f2261d6b35114127e679a44f">back</a>&#39; (green) of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> outer unit normal on <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a>. &quot; <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac2251d957156f2dc699aa406b25241a7">width</a>=0.75\textwidth</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      The red <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> green elements are <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid elements adjacent to</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundaries 4 <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> 5 (i.e. <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> &quot;front&quot; <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> &quot;<a class="code" href="fsi__channel__with__leaflet_8txt.html#a89a8bbf1f2261d6b35114127e679a44f">back</a>&quot; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a>), respectively. The normal</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      vectors (shown in blue) point towards <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> upstream end of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> channel so </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      they point \e away \e from (rather than \e into) <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> is adjacent to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> &quot;front&quot; (<a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> red region). This is why we set</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      \c FSIHermiteBeamElement::normal_points_into_fluid()=false</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      (Admittedly, we used <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> former method to get this right <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> only</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      documented <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> proper way to do it when writing this tutorial...)</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      \n\n</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;-<span class="preprocessor"># &lt;B&gt;Use of faster solvers: \c oomph-lib&#39;s FSI preconditioner&lt;/B&gt; \n\n</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   The <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a> presented in <span class="keyword">this</span> tutorial was used as one of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> test cases</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   for \c oomph-lib<span class="stringliteral">&#39;s FSI preconditioner; see \n\n</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral">   &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">   &lt;a href=&quot;http://www.maths.man.ac.uk/~mheil/oomph_lib_additional_material/HeilHazelBoyleCompMech/HeilHazelBoyleCompMech.pdf&quot;&gt;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">   Heil, M., Hazel, A.L. &amp; Boyle, J. (2008): Solvers for</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="stringliteral">   large-displacement fluid-structure interaction problems: </span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="stringliteral">   Segregated vs. monolithic approaches. Computational Mechanics.&lt;/a&gt;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="stringliteral">   &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="stringliteral">   \n\n</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="stringliteral">   The use of this preconditioner (which leads to much faster solution</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="stringliteral">   times) is described in another tutorial. However, the required source</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="stringliteral">   code is already part of the driver code and has simply been ignored</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral">   in this tutorial. Feel free to experiment with the preconditioner </span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="stringliteral">   by modifying</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="stringliteral">   &lt;A HREF=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt;the source code.&lt;/A&gt;</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="stringliteral">   </span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="stringliteral">\subsection ex Exercises</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="stringliteral">-# Confirm that choosing the wrong value for the flag  </span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="stringliteral">   \c FSIHermiteBeamElement::normal_points_into_fluid() makes</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="stringliteral">   the leaflet move in the wrong direction as it perceives positive</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="stringliteral">   fluid tractions as negative ones and vice versa. Here is </span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="stringliteral">   what you should get:</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="stringliteral">\image html normal_points_in_wrong_direction.gif &quot;Deformation of the leaflet with the wrong choice of FSIHermiteBeamElement::normal_points_into_fluid(): The leaflet gets sucked towards the high-pressure region. &quot; </span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="stringliteral">\image latex normal_points_in_wrong_direction.eps &quot;Deformation of the leaflet with the wrong choice of FSIHermiteBeamElement::normal_points_into_fluid(): The leaflet gets sucked towards the high-pressure region. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="stringliteral">   Clearly, the normal points in the wrong direction and the</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="stringliteral">   tractions have the wrong sign. This can be made &quot;consistent&quot;,</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="stringliteral">   however, by also swapping the association between the mesh boundaries</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="stringliteral">   and the leaflet&#39;</span>s faces. I.e. <span class="keywordflow">if</span> we associate <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundary 5</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   with <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <span class="stringliteral">&quot;front&quot;</span> via  \n\n</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   \code</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="comment">// Front of leaflet: face 0</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>=0; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   FSI_functions::setup_fluid_load_info_for_solid_elements&lt;ELEMENT,2&gt;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    (<span class="keyword">this</span>,5,<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>); </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   \endcode</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   \n <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a> boundary 4 with <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <span class="stringliteral">&quot;back&quot;</span> via \n\n</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    \code</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   <span class="comment">// Back of leaflet: face 1</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>=1; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   FSI_functions::setup_fluid_load_info_for_solid_elements&lt;ELEMENT,2&gt;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    (<span class="keyword">this</span>,4,<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>); </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   \endcode</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   \n <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> code gives <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> right results again (make sure you change </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> code in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a> constructor <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a> in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> actions</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   after adaptation!) -- sometimes two wrongs <span class="keywordflow">do</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   cancel each other out! </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   \n\n </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;-# &lt;A HREF=<span class="stringliteral">&quot;../figures/fsi_channel_with_leaflet_flow.avi&quot;</span>&gt;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   The animation&lt;/A&gt; of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a5db5860dbc53a1c30bbcf5ce59f9715d">flow</a> field shows <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#a13e1ec791255fbd9a473a8b318abf6e3">outflow</a> boundary condition is applied <span class="stringliteral">&quot;too close&quot;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a>: in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> relatively <span class="keywordtype">short</span> domain chosen here,</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a13e1ec791255fbd9a473a8b318abf6e3">outflow</a> is far from fully developed <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   as a result <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> imposition of a <a class="code" href="fsi__channel__with__leaflet_8txt.html#adfa699c1fb198b4d5003250cd5ca3a33">parallel</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a5db5860dbc53a1c30bbcf5ce59f9715d">flow</a> leads to <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   development of a artificial <a class="code" href="fsi__channel__with__leaflet_8txt.html#a13e1ec791255fbd9a473a8b318abf6e3">outflow</a> boundary layer. \n\n</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;\image html outflow_bl.gif <span class="stringliteral">&quot;Artificial outflow boundary layer. &quot;</span> </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;\image latex outflow_bl.eps <span class="stringliteral">&quot;Artificial outflow boundary layer. &quot;</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#ac2251d957156f2dc699aa406b25241a7">width</a>=0.75\textwidth</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   Confirm </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a> an increase in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> downstream length of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> domain (or a reduction</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> Reynolds number) improves <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> situation. </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   \n\n </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;-# The algebraic node-update technique employed in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   &lt;A HREF=<span class="stringliteral">&quot;../../../meshes/mesh_list/html/index.html#channel_with_leaflet&quot;</span>&gt;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   &lt;CODE&gt;ChannelWithLeafletMesh&lt;/CODE&gt;&lt;/A&gt; forces \e all fluid nodes</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   to move when <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a> deforms. An increase in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> downstream</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   length of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> fluid domain therefore leads to a significant</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   increase in computational cost. Use <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> improved node-update</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   technique suggested in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   &lt;A HREF=<span class="stringliteral">&quot;../../../navier_stokes/channel_with_leaflet/html/index.html#ex&quot;</span>&gt;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   corresponding Navier-Stokes example&lt;/A&gt; (only move <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> nodes</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> vicinity of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a>) to improve <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   efficiency of <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> code. </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;.</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;&lt;HR&gt; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">section</a> ackn Acknowledgements</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;- This code was originally developed by Floraine Cordier.</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;&lt;HR&gt;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">section</a> sources Source files <span class="keywordflow">for</span> <span class="keyword">this</span> tutorial</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;- The source files <span class="keywordflow">for</span> <span class="keyword">this</span> tutorial are located in <a class="code" href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a> directory:\n\n</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;&lt;A HREF=<span class="stringliteral">&quot;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="stringliteral">../../../../</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="stringliteral">demo_drivers/interaction/fsi_channel_with_leaflet/</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="stringliteral">&quot;</span>&gt;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;demo_drivers/interaction/fsi_channel_with_leaflet/</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;&lt;/A&gt;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;&lt;/CENTER&gt;\n</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;- The driver code is: \n\n</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;&lt;CENTER&gt;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;&lt;A HREF=<span class="stringliteral">&quot;</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="stringliteral">../../../../</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="stringliteral">demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="stringliteral">&quot;</span>&gt;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;&lt;/A&gt;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;&lt;/CENTER&gt;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;.</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;&lt;hr&gt;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;&lt;hr&gt;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;\<a class="code" href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">section</a> pdf PDF file</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of <span class="keyword">this</span> document is available.</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;**/</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a0e05e3042ed17da815d9cdb68fff1cc2"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a0e05e3042ed17da815d9cdb68fff1cc2">H_</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H f f mu U H_</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00140">fsi_channel_with_leaflet.txt:140</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a81f62a6d87a20cfe1459e35dbeeb99da"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a81f62a6d87a20cfe1459e35dbeeb99da">conditions</a></div><div class="ttdeci">Dirichlet conditions(prescribed velocity) are applied on virtually all boundaries of the fluid domain(prescribed inflow at the inlet</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_aea622b993ae035e986e4ded1c3c4f63d"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#aea622b993ae035e986e4ded1c3c4f63d">leaflet</a></div><div class="ttdeci">and the parameters that define the magnitude of the pulsating inflow until end_of_namespace&lt; HR &gt;&lt; HR &gt; section leaflet The undeformed leaflet We use a c GeomObject to describe the stress free shape of the elastic leaflet</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00224">fsi_channel_with_leaflet.txt:224</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a89a8bbf1f2261d6b35114127e679a44f"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a89a8bbf1f2261d6b35114127e679a44f">back</a></div><div class="ttdeci">see&lt; A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details until pin_redundant When completing the build of the wall elements we use the function c one of the two faces will have to be identified as the front(face 0) and the other one as the &quot;back&quot;(face 1). The function \c normal_points_into_fluid() allows us to indicate if the outer unit normal on the leaflet(as computed by \c FSIHermiteBeamElement the back(face 1) is assumed to coincide with the fluid mesh boundary 5. \until(this</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a13f24d2daeab0c2bd43ad2efbabb3f9e"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a13f24d2daeab0c2bd43ad2efbabb3f9e">freedom</a></div><div class="ttdeci">fluid velocity prescribed by the wall motion on the apart from the and impose a vertical slope by setting f dx_1 we complete the build of the fluid elements by passing pointers to the relevant physical parameters to the elements and pinning any redundant pressure degrees of freedom</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00406">fsi_channel_with_leaflet.txt:406</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a67449ddd13526d7fe38a05989d83024e"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a67449ddd13526d7fe38a05989d83024e">_</a></div><div class="ttdeci">see n n&lt; CENTER &gt;&lt; A href=&quot;http: &lt;/CENTER&gt; In this tutorial we concentrate on the problem formulation The application of the preconditioner is discussed&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt; elsewhere&lt;/a&gt; the required source code is contained in the&lt;A href=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt; driver code&lt;/A&gt;&lt;HR&gt;&lt;HR&gt; section the_problem The Problem The figure below shows a sketch of the we use asterisks to distinguish dimensional quantities from their non dimensional equivalents to be introduced later We assume that the leaflet is sufficiently thin so as far as the boundary conditions for the fluid are the leaflet can be assumed to be infinitely thin This allows us to parametrise its shape by a single Lagrangian coordinate f xi* f Hence we write the position vector to a material point on the leaflet as f H* _</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00052">fsi_channel_with_leaflet.txt:52</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a10ce8f652e1f7e37624e9c8e5dde94d5"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a></div><div class="ttdeci">see&lt; A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details until pin_redundant When completing the build of the wall elements we use the function c one of the two faces will have to be identified as the front(face 0) and the other one as the &quot;back&quot;(face 1). The function \c normal_points_into_fluid() allows us to indicate if the outer unit normal on the leaflet(as computed by \c FSIHermiteBeamElement the Fluid_mesh_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00446">fsi_channel_with_leaflet.txt:446</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a13e1ec791255fbd9a473a8b318abf6e3"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a13e1ec791255fbd9a473a8b318abf6e3">outflow</a></div><div class="ttdeci">fluid velocity prescribed by the wall motion on the apart from the outflow(boundary 1;see the enumeration of the mesh boundaries in the&lt; A HREF=&quot;../../../meshes/mesh_list/html/index.html#channel_with_leaflet&quot;&gt;&lt; CODE &gt;ChannelWithLeafletMesh&lt;/CODE &gt;&lt;/A &gt;) where the axial velocity is unknown(and determined indirectly by the &quot;axially-traction-free&quot; condition) while the vertical velocity has to be set to zero to ensure parallel outflow. \until end loop over boundaries Next we assign the parabolic velocity profile at the inlet(recall that all values are initialised to zero so no further action is required on any of the other Dirichlet boundaries). \until } The leaflet is clamped at its lower end so we pin its \f $x_1\f$- and \f $x_2\f$-positions</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a5db5860dbc53a1c30bbcf5ce59f9715d"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a5db5860dbc53a1c30bbcf5ce59f9715d">flow</a></div><div class="ttdeci">see n n&lt; CENTER &gt;&lt; A href=&quot;http: &lt;/CENTER&gt; In this tutorial we concentrate on the problem formulation The application of the preconditioner is discussed&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt; elsewhere&lt;/a&gt; the required source code is contained in the&lt;A href=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt; driver code&lt;/A&gt;&lt;HR&gt;&lt;HR&gt; section the_problem The Problem The figure below shows a sketch of the we use asterisks to distinguish dimensional quantities from their non dimensional equivalents to be introduced later We assume that the leaflet is sufficiently thin so as far as the boundary conditions for the fluid are the leaflet can be assumed to be infinitely thin This allows us to parametrise its shape by a single Lagrangian coordinate f xi* f Hence we write the position vector to a material point on the leaflet as f H time on the natural timescale of the flow</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00052">fsi_channel_with_leaflet.txt:52</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="fsi__channel__with__leaflet_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00756">fsi_channel_with_leaflet.cc:756</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a93ba8afbc1ac7bd561a42939f0da10dd"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a93ba8afbc1ac7bd561a42939f0da10dd">parameters</a></div><div class="ttdeci">We prepare a c DocInfo object and open a trace file to document the system s evolution until trace open Next we assign the timestepping parameters(using fewer timesteps if the code is run during a self-test) and document the system 's initial state which provides the initial guess for the Newton iteration in the subsequent steady solve. \until doc_info.number()++</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_af876a1fa220e312da5a298a4e012ef7d"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#af876a1fa220e312da5a298a4e012ef7d">the</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H f f mu U used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f as shown in this sketch of the non dimensional version of the a non dimensional period of f and an interaction parameter of f particularly near the leaflet s tip where the pressure is singular The mesh was continuously adapted throughout the simulation and contained an average of degrees of freedom This is a fraction of the</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00171">fsi_channel_with_leaflet.txt:171</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a9c9bc0f08e849f3cc8a6298fe08f8c21"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a9c9bc0f08e849f3cc8a6298fe08f8c21">that</a></div><div class="ttdeci">see n n&lt; CENTER &gt;&lt; A href=&quot;http: &lt;/CENTER&gt; In this tutorial we concentrate on the problem formulation The application of the preconditioner is discussed&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt; elsewhere&lt;/a&gt; the required source code is contained in the&lt;A href=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt; driver code&lt;/A&gt;&lt;HR&gt;&lt;HR&gt; section the_problem The Problem The figure below shows a sketch of the we use asterisks to distinguish dimensional quantities from their non dimensional equivalents to be introduced later We assume that the leaflet is sufficiently thin so that</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00038">fsi_channel_with_leaflet.txt:38</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_ac2251d957156f2dc699aa406b25241a7"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#ac2251d957156f2dc699aa406b25241a7">width</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s width</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00099">fsi_channel_with_leaflet.txt:99</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_adc77c86dbe31ae29b9c7082ea1fff7a4"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a></div><div class="ttdeci">see&lt; A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details until pin_redundant When completing the build of the wall elements we use the function c one of the two faces will have to be identified as the front(face 0) and the other one as the &quot;back&quot;(face 1). The function \c normal_points_into_fluid() allows us to indicate if the outer unit normal on the leaflet(as computed by \c FSIHermiteBeamElement the Wall_mesh_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00446">fsi_channel_with_leaflet.txt:446</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_af482980f508b68ffde165f3a15adbbe1"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#af482980f508b68ffde165f3a15adbbe1">strategy</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H f f mu U used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f as shown in this sketch of the non dimensional version of the a non dimensional period of f and an interaction parameter of f particularly near the leaflet s tip where the pressure is singular The mesh was continuously adapted throughout the simulation and contained an average of degrees of freedom This is a fraction of degrees of freedom that would be required to achieve the same resolution via uniform mesh refinement I w textwidth flow_from_paper Computational results The corresponding&lt; A HREF=&quot;../figures/fsi_channel_with_leaflet_flow.avi&quot;&gt; animation&lt;/A &gt; illustrates the algebraic node update strategy(implemented with an \c AlgebraicMesh, discussed in more detail in&lt; A HREF=&quot;../../fsi_collapsible_channel_algebraic/html/index.html&quot;&gt; another tutorial&lt;/A &gt;) and the evolution of the flow field. Note that the instantaneous streamlines intersect the(impermeable) leaflet because the leaflet is not stationary. The animation shows how the mesh adapts itself to changes in the flow field -- using much smaller elements in high-shear regions</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a5cdfc24fc90d340363aacf0d7ec53a0f"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a5cdfc24fc90d340363aacf0d7ec53a0f">section</a></div><div class="ttdeci">see n n&lt; CENTER &gt;&lt; A href=&quot;http: &lt;/CENTER&gt; In this tutorial we concentrate on the problem formulation The application of the preconditioner is discussed&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt; elsewhere&lt;/a&gt; the required source code is contained in the&lt;A href=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt; driver code&lt;/A&gt;&lt;HR&gt;&lt;HR&gt; section the_problem The Problem The figure below shows a sketch of the we use asterisks to distinguish dimensional quantities from their non dimensional equivalents to be introduced later We assume that the leaflet is sufficiently thin so as far as the boundary conditions for the fluid are the leaflet can be assumed to be infinitely thin This allows us to parametrise its shape by a single Lagrangian coordinate f xi* f Hence we write the position vector to a material point on the leaflet as f H time on the natural timescale of the f H the velocities on f U and the pressure on the viscous scale The fluid flow is then governed by the non dimensional Navier Stokes equations f [Re \left( St \frac{\partial u_i}{\partial t} + u_j \frac{\partial u_i}{\partial x_j} \right) =- \frac{\partial p}{\partial x_i} +\frac{\partial }{\partial x_j} \left[ \left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i} \right) \right],\f] where f and&lt;CENTER&gt; f [\frac{\partial u_i}{\partial x_i} = 0,\f]&lt;/CENTER&gt; subject to a time parabolic inflow with non dimensional period f T&lt;CENTER&gt; f [{\bf u} = 6 x_2 (1-x_2) \left( 1 + \frac{1}{2} (1-\cos(2 \pi t/T)) \right) {\bf e}_1\f]&lt;/CENTER&gt; in the inflow cross section</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00080">fsi_channel_with_leaflet.txt:80</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_aebe8ae3bdaefec08febefd4c52bfea46"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#aebe8ae3bdaefec08febefd4c52bfea46">E_</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H f E_</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00114">fsi_channel_with_leaflet.txt:114</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a6388e0fc50060e394b2f90c6f28a376c"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a6388e0fc50060e394b2f90c6f28a376c">ratio</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s ratio</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00092">fsi_channel_with_leaflet.txt:92</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a63d53108aaf6a609e12f63d26927620e"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a63d53108aaf6a609e12f63d26927620e">procedure</a></div><div class="ttdeci">We wish to start the time dependent simulation from an initial condition that corresponds to the steady solution of the problem with unit the currently assigned initial etc We allow for up to mesh adaptations for each Reynolds number to allow the mesh to adapt itself to the flow conditions before starting the time dependent run until reached final Reynolds number we start the proper timestepping procedure</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00287">fsi_channel_with_leaflet.txt:287</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a3b0af813fab0be3a543f96237094f7ca"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a3b0af813fab0be3a543f96237094f7ca">thickness</a></div><div class="ttdeci">the leaflet s non dimensional wall thickness</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00198">fsi_channel_with_leaflet.txt:198</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_acb1c75ce579feac2f20489b489791588"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#acb1c75ce579feac2f20489b489791588">displacements</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of displacements</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00095">fsi_channel_with_leaflet.txt:95</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a4af603fc4c1619d83f53265a371e9941"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a4af603fc4c1619d83f53265a371e9941">parameter</a></div><div class="ttdeci">the leaflet s non dimensional wall f and the FSI parameter</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00207">fsi_channel_with_leaflet.txt:207</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_aac91f44098141c2bf2230fccce275e6a"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#aac91f44098141c2bf2230fccce275e6a">until</a></div><div class="ttdeci">Next we create the mesh of Hermite beam elements that represents the passing a pointer to an instance of the c UndeformedLeaflet to its constructor until</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00362">fsi_channel_with_leaflet.txt:362</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a9a15a4e12ba10c0745f4eb8e891e41ec"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a9a15a4e12ba10c0745f4eb8e891e41ec">Re</a></div><div class="ttdeci">see n n&lt; CENTER &gt;&lt; A href=&quot;http: &lt;/CENTER&gt; In this tutorial we concentrate on the problem formulation The application of the preconditioner is discussed&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt; elsewhere&lt;/a&gt; the required source code is contained in the&lt;A href=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt; driver code&lt;/A&gt;&lt;HR&gt;&lt;HR&gt; section the_problem The Problem The figure below shows a sketch of the we use asterisks to distinguish dimensional quantities from their non dimensional equivalents to be introduced later We assume that the leaflet is sufficiently thin so as far as the boundary conditions for the fluid are the leaflet can be assumed to be infinitely thin This allows us to parametrise its shape by a single Lagrangian coordinate f xi* f Hence we write the position vector to a material point on the leaflet as f H time on the natural timescale of the f H the velocities on f U and the pressure on the viscous scale The fluid flow is then governed by the non dimensional Navier Stokes equations f [Re \left( St \frac{\partial u_i}{\partial t} + u_j \frac{\partial u_i}{\partial x_j} \right) =- \frac{\partial p}{\partial x_i} +\frac{\partial }{\partial x_j} \left[ \left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i} \right) \right],\f] where f Re</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00065">fsi_channel_with_leaflet.txt:65</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a809303b96330f4d120002050282e3ae1"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a809303b96330f4d120002050282e3ae1">timesteps</a></div><div class="ttdeci">see the enumeration of the mesh boundaries in the&lt; A HREF=&quot;../../../meshes/mesh_list/html/index.html#channel_with_leaflet&quot;&gt;&lt; CODE &gt; ChannelWithLeafletMesh&lt;/CODE &gt;&lt;/A &gt; but an additional node update must be performed when the unknowns are updated by the Newton solver This is achieved by performing a further node update in the function c actions_before_newton_convergence_check()&lt; HR &gt;&lt; HR &gt; section constructor The problem constructor We start the problem construction by creating two we must evaluate the position of the leaflet at previous timesteps</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00350">fsi_channel_with_leaflet.txt:350</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a085ee4bf968ffdd01a41b8c41864f907"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a></div><div class="ttdeci">double ReSt</div><div class="ttdoc">Womersley number: Product of Reynolds and Strouhal numbers.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00052">fsi_channel_with_leaflet.cc:52</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_abf258b001136468043833934ee1b3afa"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#abf258b001136468043833934ee1b3afa">about</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H f f mu U used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f as shown in this sketch of the non dimensional version of the a non dimensional period of f and an interaction parameter of f particularly near the leaflet s tip where the pressure is singular The mesh was continuously adapted throughout the simulation and contained an average of about</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00171">fsi_channel_with_leaflet.txt:171</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_adfa699c1fb198b4d5003250cd5ca3a33"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#adfa699c1fb198b4d5003250cd5ca3a33">parallel</a></div><div class="ttdeci">parallel</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00080">fsi_channel_with_leaflet.txt:80</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a5154e015d549544a76116ffb507f7e02"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a5154e015d549544a76116ffb507f7e02">then</a></div><div class="ttdeci">skipline end of constructor&lt; HR &gt;&lt; HR &gt; section adapt Actions after the mesh adaptation Once the fluid mesh has been adapted we free all pressure degrees of freedom and then(re-) pin any redundant ones</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_aa82ca9f1c5efd140c153e31d5c906c15"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a></div><div class="ttdeci">see&lt; A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details until pin_redundant When completing the build of the wall elements we use the function c one of the two faces will have to be identified as the front(face 0) and the other one as the &quot;back&quot;(face 1). The function \c normal_points_into_fluid() allows us to indicate if the outer unit normal on the leaflet(as computed by \c FSIHermiteBeamElement the face</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00446">fsi_channel_with_leaflet.txt:446</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_ab98838d1085f3365366a7213b4a146b8"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#ab98838d1085f3365366a7213b4a146b8">influx</a></div><div class="ttdeci">We wish to start the time dependent simulation from an initial condition that corresponds to the steady solution of the problem with unit influx(i.e. the steady solution obtained if the time-dependent boundary condition that is applied at the inlet is held fixed at its value for \f$ t=0 \f$). For the required Reynolds number of \f$ Re</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a0bc5d73f4ec8d09587bf603929fdb61c"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a0bc5d73f4ec8d09587bf603929fdb61c">deformation</a></div><div class="ttdeci">and the parameters that define the magnitude of the pulsating inflow until end_of_namespace&lt; HR &gt;&lt; HR &gt; section leaflet The undeformed leaflet We use a c GeomObject to describe the stress free shape of the elastic as required by the variational principle that governs the beam s deformation</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00225">fsi_channel_with_leaflet.txt:225</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a86afc94a816f5f12de8ee89438cb7901"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a86afc94a816f5f12de8ee89438cb7901">mesh</a></div><div class="ttdeci">The wall mesh defines the geometry of the deformed therefore we create a c GeomObject representation of that mesh</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00365">fsi_channel_with_leaflet.txt:365</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a7e58cb9b843665019b338e942240e67e"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a7e58cb9b843665019b338e942240e67e">codes</a></div><div class="ttdeci">see&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; the beam theory tutorial for details&lt;/A &gt; skipline start_of_undeformed_leaflet until end_of_undeformed_wall&lt; HR &gt;&lt; HR &gt; section main The driver code As with most time dependent demo codes</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00238">fsi_channel_with_leaflet.txt:238</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_af8bb9455d2ea188a2264ce33c37ec21b"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#af8bb9455d2ea188a2264ce33c37ec21b">effective</a></div><div class="ttdeci">and no slip on the stationary channel elastic Kirchhoff Love beam of wall thickness f h *f The beam s effective(1D) elastic modulus is given by \f$ E_</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00091">fsi_channel_with_leaflet.txt:91</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a50b6609c7621b1933e85d311a771e0df"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a50b6609c7621b1933e85d311a771e0df">modulus</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H f f mu U used to non dimensionalise the Navier Stokes to the beam s effective elastic modulus</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00142">fsi_channel_with_leaflet.txt:142</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a1552dff3dd44f8e34386071734005e6d"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a1552dff3dd44f8e34386071734005e6d">initial</a></div><div class="ttdeci">and the parameters that define the magnitude of the pulsating inflow until end_of_namespace&lt; HR &gt;&lt; HR &gt; section leaflet The undeformed leaflet We use a c GeomObject to describe the initial</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00221">fsi_channel_with_leaflet.txt:221</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a5b052db3a93fe3ee2945af0117375d3d"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a5b052db3a93fe3ee2945af0117375d3d">Q</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H f f mu U used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f Q</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00144">fsi_channel_with_leaflet.txt:144</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af6e07423e22c0991084d9a2f43727805"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Non-dimensional wall thickness.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00055">fsi_channel_with_leaflet.cc:55</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a5030e5e476128f5498f50a96ccc79c68"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a5030e5e476128f5498f50a96ccc79c68">numbers</a></div><div class="ttdeci">Following the setup of the fluid structure interaction we assign the equation numbers</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00453">fsi_channel_with_leaflet.txt:453</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a02d8735dd8a1ef9ec27c5f7b17cceed2"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a02d8735dd8a1ef9ec27c5f7b17cceed2">h</a></div><div class="ttdeci">the leaflet s non dimensional wall f h</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00206">fsi_channel_with_leaflet.txt:206</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a6e82490b1ad3f2c80ea94a70b0eab909"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a6e82490b1ad3f2c80ea94a70b0eab909">Finally</a></div><div class="ttdeci">We wish to start the time dependent simulation from an initial condition that corresponds to the steady solution of the problem with unit the currently assigned initial etc We allow for up to mesh adaptations for each Reynolds number to allow the mesh to adapt itself to the flow conditions before starting the time dependent run until reached final Reynolds number Finally</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00287">fsi_channel_with_leaflet.txt:287</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_ac6e586e420b7484ba755ca0c2a67c341"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#ac6e586e420b7484ba755ca0c2a67c341">and</a></div><div class="ttdeci">see the discussion in&lt; A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/a &gt; for details skipline start_of_actions_after_adapt until pin_redundant Any newly created fluid nodes on the the adaptation of the fluid mesh may change the fluid elements that are adjacent to the wall elements so we re generate the corresponding FSI lookup schemes until end_of_actions_after_adapt&lt; HR &gt;&lt; HR &gt; section doc Post Processing The function c doc_solution(...) documents the results. We output the fluid and solid meshes and document selected additional quantities in the trace file. \skipline start_of_doc_solution \until&lt;&lt; std The remaining output is created to determine which elements are located next to the fluid mesh boundaries and(Yes,&lt; a href=&quot;../../../meshes/mesh_list/html/index.html#channel_with_leaflet&quot;&gt; the documentation for the mesh&lt;/A &gt; illustrates the enumeration of the mesh boundaries but we generally prefer to be paranoid;see \ref comm)</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_af0e84ca9572abef167dabb1d2b59d6f7"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#af0e84ca9572abef167dabb1d2b59d6f7">guess</a></div><div class="ttdeci">We wish to start the time dependent simulation from an initial condition that corresponds to the steady solution of the problem with unit the currently assigned initial guess(zero velocity and pressure, with the wall in its undeformed position) is &quot;too far&quot; from the actual solution and the Newton method would diverge(it!). Therefore we generate the initial steady solution in a preliminary sequence of steady computations in which we first compute the solution for a Reynolds number of \f$ Re</div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_addae5d0024c89858ff6af8be20128e9b"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#addae5d0024c89858ff6af8be20128e9b">f</a></div><div class="ttdeci">see n n&lt; CENTER &gt;&lt; A href=&quot;http: &lt;/CENTER&gt; In this tutorial we concentrate on the problem formulation The application of the preconditioner is discussed&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt; elsewhere&lt;/a&gt; the required source code is contained in the&lt;A href=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt; driver code&lt;/A&gt;&lt;HR&gt;&lt;HR&gt; section the_problem The Problem The figure below shows a sketch of the we use asterisks to distinguish dimensional quantities from their non dimensional equivalents to be introduced later We assume that the leaflet is sufficiently thin so as far as the boundary conditions for the fluid are the leaflet can be assumed to be infinitely thin This allows us to parametrise its shape by a single Lagrangian coordinate f xi* f Hence we write the position vector to a material point on the leaflet as f</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00043">fsi_channel_with_leaflet.txt:43</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_abbb977d4712081610d3fbcc3962207ea"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00015">fsi_channel_with_leaflet.txt:15</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 16:33:55
        </div>
      </div>
    </footer>
</body>
</html>

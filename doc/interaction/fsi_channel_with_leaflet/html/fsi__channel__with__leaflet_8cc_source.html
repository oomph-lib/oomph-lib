<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: fsi_channel_with_leaflet.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_e04e7117dd418a6eb6e24eeac048a60a.html">interaction</a></li><li class="navelem"><a class="el" href="dir_d463693807c420c9daeb4a1a8adeb448.html">fsi_channel_with_leaflet</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fsi_channel_with_leaflet.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fsi__channel__with__leaflet_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Generic oomph-lib includes</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;beam.h&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;navier_stokes.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;multi_physics.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//Include the mesh</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;meshes/channel_with_leaflet_mesh.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// The wall mesh</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;meshes/one_d_lagrangian_mesh.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//==== start_of_global_parameters================================</span><span class="comment"></span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// Global parameters</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span><span class="comment">//===============================================================</span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html">   46</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{<span class="comment"></span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> /// Reynolds number</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">   49</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a9a15a4e12ba10c0745f4eb8e891e41ec">Re</a>=50.0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> /// Womersley number: Product of Reynolds and Strouhal numbers</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">   52</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">ReSt</a>=50.0;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> /// Non-dimensional wall thickness.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">   55</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">H</a>=0.05;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> /// \short Fluid structure interaction parameter: Ratio of stresses used for</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> /// non-dimensionalisation of fluid to solid stresses. </span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a66cb7ecda9ba0cd72367dd697f154545">   59</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a5b052db3a93fe3ee2945af0117375d3d">Q</a>=1.0e-6;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> /// Period for fluctuations in flux</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a2ffa220a56bff9b6b495ed47954d513f">   62</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a2ffa220a56bff9b6b495ed47954d513f">Period</a>=2.0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> /// Min. flux</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#aa46dc81a0757e8f9707646e03c32d4fc">   65</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa46dc81a0757e8f9707646e03c32d4fc">Min_flux</a>=1.0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> /// Max. flux</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#aee645139728fd3d01573b161c74e7e8a">   68</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aee645139728fd3d01573b161c74e7e8a">Max_flux</a>=2.0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> /// \short Flux: Pulsatile flow fluctuating between Min_flux and Max_flux </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> /// with period Period</span></div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#ad651484fe06209606bccefe6fe23be0c">   72</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#ad651484fe06209606bccefe6fe23be0c">flux</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; t)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; {  </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa46dc81a0757e8f9707646e03c32d4fc">Min_flux</a>+</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   (<a class="code" href="namespaceGlobal__Physical__Variables.html#aee645139728fd3d01573b161c74e7e8a">Max_flux</a>-<a class="code" href="namespaceGlobal__Physical__Variables.html#aa46dc81a0757e8f9707646e03c32d4fc">Min_flux</a>)*0.5*(1.0-cos(2.0*MathematicalConstants::Pi*t/<a class="code" href="namespaceGlobal__Physical__Variables.html#a2ffa220a56bff9b6b495ed47954d513f">Period</a>));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;} <span class="comment">// end_of_namespace</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">//=====start_of_undeformed_leaflet=================================</span><span class="comment"></span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">///GeomObject: Undeformed straight, vertical leaflet</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classUndeformedLeaflet.html">   90</a></span>&#160;<span class="keyword">class </span><a class="code" href="classUndeformedLeaflet.html">UndeformedLeaflet</a> : <span class="keyword">public</span> GeomObject</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> /// Constructor: argument is the x-coordinate of the leaflet</span></div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classUndeformedLeaflet.html#ac4c0478b1f329360684af14b59043b12">   96</a></span>&#160;<span class="comment"></span> <a class="code" href="classUndeformedLeaflet.html#ac4c0478b1f329360684af14b59043b12">UndeformedLeaflet</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x0): GeomObject(1,2)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   X0=x0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> /// \short Position vector at Lagrangian coordinate zeta </span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classUndeformedLeaflet.html#a8e9b79702eb9a38e19886b84aeb47918">  102</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classUndeformedLeaflet.html#a8e9b79702eb9a38e19886b84aeb47918">position</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <span class="comment">// Position Vector</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   r[0] = X0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   r[1] = zeta[0];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> /// \short Parametrised position on object: r(zeta). Evaluated at</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> /// previous timestep. t=0: current time; t&gt;0: previous</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> /// timestep. Calls steady version.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classUndeformedLeaflet.html#a6949784da1030dd63ef741d170ef9798">  113</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classUndeformedLeaflet.html#a6949784da1030dd63ef741d170ef9798">position</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; t, <span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;               Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="comment">// Use the steady version</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   position(zeta,r);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  } <span class="comment">// end of position</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> /// \short Posn vector and its  1st &amp; 2nd derivatives</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> /// w.r.t. to coordinates:</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> /// \f$ \frac{dR_i}{d \zeta_\alpha}\f$ = drdzeta(alpha,i). </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> /// \f$ \frac{d^2R_i}{d \zeta_\alpha d \zeta_\beta}\f$ = </span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> /// ddrdzeta(alpha,beta,i). Evaluated at current time.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classUndeformedLeaflet.html#a47d674756ce22e00a44ca0bd030a99da">  126</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classUndeformedLeaflet.html#a47d674756ce22e00a44ca0bd030a99da">d2position</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                 Vector&lt;double&gt;&amp; r,</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                 DenseMatrix&lt;double&gt; &amp;drdzeta,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                 RankThreeTensor&lt;double&gt; &amp;ddrdzeta)<span class="keyword"> const</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="comment">// Position vector</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   r[0] = X0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   r[1] = zeta[0];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="comment">// Tangent vector</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   drdzeta(0,0)=0.0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   drdzeta(0,1)=1.0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="comment">// Derivative of tangent vector</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   ddrdzeta(0,0,0)=0.0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   ddrdzeta(0,0,1)=0.0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  } <span class="comment">// end of d2position</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> /// Number of geometric Data in GeomObject: None.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classUndeformedLeaflet.html#a56153a1d117dd41657183655de094d3e">  145</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classUndeformedLeaflet.html#a56153a1d117dd41657183655de094d3e">ngeom_data</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> 0;}  </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; private :</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> /// x position of the undeformed leaflet&#39;s origin. </span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classUndeformedLeaflet.html#aa89fc695af9e53aa38894c9d875afd36">  150</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classUndeformedLeaflet.html#aa89fc695af9e53aa38894c9d875afd36">X0</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}; <span class="comment">//end_of_undeformed_wall</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">//=====start_of_problem_class========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">/// FSI leaflet in channel</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span><span class="comment">//===================================================================</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html">  164</a></span>&#160;<span class="keyword">class </span><a class="code" href="classFSIChannelWithLeafletProblem.html">FSIChannelWithLeafletProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> /// \short Constructor: Pass the lenght of the domain at the left</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> /// of the leaflet lleft,the lenght of the domain at the right of the</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> /// leaflet lright,the height of the leaflet hleaflet, the total height</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> /// of the domain htot, the number of macro-elements at the left of the</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> /// leaflet nleft, the number of macro-elements at the right of the</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> /// leaflet nright, the number of macro-elements under hleaflet ny1,</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> /// the number of macro-elements above hleaflet ny2, the abscissa</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> /// of the origin of the leaflet x_0.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span> <a class="code" href="classFSIChannelWithLeafletProblem.html">FSIChannelWithLeafletProblem</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lleft,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lright, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; hleaflet,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; htot,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nleft, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nright,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ny1, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp;  ny2,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                              <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x_0);  </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> /// Destructor empty</span></div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#a5df1d8f7229314a92ffb48ec61f56fe0">  185</a></span>&#160;<span class="comment"></span> <a class="code" href="classFSIChannelWithLeafletProblem.html#a5df1d8f7229314a92ffb48ec61f56fe0">~FSIChannelWithLeafletProblem</a>(){}</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> /// Actions after solve (empty)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#abff6e46a940263c9255a61f649bb4239">  188</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classFSIChannelWithLeafletProblem.html#abff6e46a940263c9255a61f649bb4239">actions_after_newton_solve</a>(){}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> /// Actions before solve (empty) </span></div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#a8a32ef77f32b3283b4b509669deb0a11">  191</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classFSIChannelWithLeafletProblem.html#a8a32ef77f32b3283b4b509669deb0a11">actions_before_newton_solve</a>(){}</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> /// Actions after adaptation</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> actions_after_adapt();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> /// Access function to the wall mesh</span></div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#ab6a1c532882a71ddd576c752da389de0">  197</a></span>&#160;<span class="comment"></span> OneDLagrangianMesh&lt;FSIHermiteBeamElement&gt;* <a class="code" href="classFSIChannelWithLeafletProblem.html#ab6a1c532882a71ddd576c752da389de0">wall_mesh_pt</a>() </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  } </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> /// Access function to fluid mesh</span></div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#aec9244497829f9a85cbca7307c4d4e10">  203</a></span>&#160;<span class="comment"></span> RefineableAlgebraicChannelWithLeafletMesh&lt;ELEMENT&gt;* <a class="code" href="classFSIChannelWithLeafletProblem.html#aec9244497829f9a85cbca7307c4d4e10">fluid_mesh_pt</a>()</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> /// Doc the solution</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo&amp; doc_info, ofstream&amp; trace);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/// Update the inflow velocity</span></div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#ac73220fa534cf2409bb0ebcf2fb5e1d5">  213</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classFSIChannelWithLeafletProblem.html#ac73220fa534cf2409bb0ebcf2fb5e1d5">actions_before_implicit_timestep</a>()</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="comment">// Actual time</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordtype">double</span> t=time_pt()-&gt;time();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="comment">// Amplitude of flow</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <span class="keywordtype">double</span> ampl=<a class="code" href="namespaceGlobal__Physical__Variables.html#ad651484fe06209606bccefe6fe23be0c">Global_Physical_Variables::flux</a>(t);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="comment">// Update parabolic flow along boundary 3</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <span class="keywordtype">unsigned</span> ibound=3; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <span class="keywordtype">unsigned</span> num_nod= <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">double</span> ycoord = <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound,inod)-&gt;x(1); </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">double</span> uy = ampl*6.0*ycoord/Htot*(1.0-ycoord/Htot);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(0,uy);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(1,0.0);    </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  } <span class="comment">// end of actions_before_implicit_timestep</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> /// \short Update before checking Newton convergence: Update the</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> /// nodal positions in the fluid mesh in response to possible </span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"> /// changes in the wall shape</span></div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#aff02228eddae18ef3d57306ba1e61495">  236</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classFSIChannelWithLeafletProblem.html#aff02228eddae18ef3d57306ba1e61495">actions_before_newton_convergence_check</a>()</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;node_update();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> /// Pointer to the fluid mesh</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">  244</a></span>&#160;<span class="comment"></span> RefineableAlgebraicChannelWithLeafletMesh&lt;ELEMENT&gt;* <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> /// Pointer to the &quot;wall&quot; mesh</span></div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">  247</a></span>&#160;<span class="comment"></span> OneDLagrangianMesh&lt;FSIHermiteBeamElement&gt;* <a class="code" href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">Wall_mesh_pt</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> /// Pointer to the GeomObject that represents the wall</span></div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#ade82d11fc4bdd54b848f02361f8cc99e">  250</a></span>&#160;<span class="comment"></span> GeomObject* <a class="code" href="classFSIChannelWithLeafletProblem.html#ade82d11fc4bdd54b848f02361f8cc99e">Leaflet_pt</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> /// Total height of the domain</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#a765a35c452989fa2d54bc1441d04925c">  253</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classFSIChannelWithLeafletProblem.html#a765a35c452989fa2d54bc1441d04925c">Htot</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;};</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">//=====start_of_constructor==============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">/// Constructor</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">  265</a></span>&#160;<a class="code" href="classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">FSIChannelWithLeafletProblem&lt;ELEMENT&gt;::FSIChannelWithLeafletProblem</a>(</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lleft,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lright,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; hleaflet,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; htot,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nleft,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nright,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ny1,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp;  ny2,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x_0) : Htot(htot)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; <span class="comment">// Timesteppers:</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; <span class="comment">//--------------</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; <span class="comment">// Allocate the timestepper</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; BDF&lt;2&gt;* fluid_time_stepper_pt=<span class="keyword">new</span> BDF&lt;2&gt;;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#a2686101caa40fa891e30660e3dacd6c7">add_time_stepper_pt</a>(fluid_time_stepper_pt);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; <span class="comment">// Allocate the wall timestepper</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; Steady&lt;2&gt;* <a class="code" href="fsi__channel__with__leaflet_8txt.html#a554e2755ee0f2660c24d8053b1a26eba">wall_time_stepper_pt</a>=<span class="keyword">new</span> Steady&lt;2&gt;;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#a2686101caa40fa891e30660e3dacd6c7">add_time_stepper_pt</a>(<a class="code" href="fsi__channel__with__leaflet_8txt.html#a554e2755ee0f2660c24d8053b1a26eba">wall_time_stepper_pt</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; <span class="comment">// Discretise leaflet</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; <span class="comment">//-------------------</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; <span class="comment">// Geometric object that represents the undeformed leaflet</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; <a class="code" href="classUndeformedLeaflet.html">UndeformedLeaflet</a>* <a class="code" href="fsi__channel__with__leaflet_8txt.html#aa9c84a4ff4c6e8e4df583cc7720541fb">undeformed_wall_pt</a>=<span class="keyword">new</span> <a class="code" href="classUndeformedLeaflet.html">UndeformedLeaflet</a>(x_0);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; <span class="comment">//Create the &quot;wall&quot; mesh with FSI Hermite beam elements</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; <span class="keywordtype">unsigned</span> n_wall_el=5;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; <a class="code" href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">Wall_mesh_pt</a> = <span class="keyword">new</span> OneDLagrangianMesh&lt;FSIHermiteBeamElement&gt;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  (n_wall_el,hleaflet,<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa9c84a4ff4c6e8e4df583cc7720541fb">undeformed_wall_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#a554e2755ee0f2660c24d8053b1a26eba">wall_time_stepper_pt</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; <span class="comment">// Provide GeomObject representation of leaflet mesh and build fluid mesh</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; <span class="comment">//-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; <span class="comment">// Build a geometric object (one Lagrangian, two Eulerian coordinates)</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; <span class="comment">// from the wall mesh</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; MeshAsGeomObject* wall_geom_object_pt=</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keyword">new</span> MeshAsGeomObject(<a class="code" href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">Wall_mesh_pt</a>); </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">//Build the mesh</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a> =<span class="keyword">new</span> RefineableAlgebraicChannelWithLeafletMesh&lt;ELEMENT&gt;(</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  wall_geom_object_pt,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  lleft, lright,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  hleaflet,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  htot,nleft,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  nright,ny1,ny2,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  fluid_time_stepper_pt);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; <span class="comment">// Set error estimator</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; Z2ErrorEstimator* error_estimator_pt=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;spatial_error_estimator_pt()=error_estimator_pt;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; <span class="comment">// Build global mesh</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; <span class="comment">//------------------</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; <span class="comment">// Add the sub meshes to the problem</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; add_sub_mesh(<a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; add_sub_mesh(<a class="code" href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">Wall_mesh_pt</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; <span class="comment">// Combine all submeshes into a single Mesh</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#a0ae549c3a1e99d9d4dd46a0443635590">build_global_mesh</a>();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; <span class="comment">// Fluid boundary conditions</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; <span class="comment">//--------------------------</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; <span class="comment">//Pin the boundary nodes of the fluid mesh</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; <span class="keywordtype">unsigned</span> num_bound = <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;nboundary();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ibound=0;ibound&lt;num_bound;ibound++)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordtype">unsigned</span> num_nod= <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound,inod)-&gt;pin(1);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;     </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="comment">// Do not pin the x velocity of the outflow</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">if</span>( ibound != 1)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;       <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound,inod)-&gt;pin(0); </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      }      </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; <span class="comment">// end loop over boundaries</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; <span class="comment">// Setup parabolic flow along boundary 3 (everything else that&#39;s </span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; <span class="comment">// pinned has homogenous boundary conditions so no action is required</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; <span class="comment">// as that&#39;s the default assignment). Inflow profile is parabolic</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; <span class="comment">// and this is interpolated correctly during mesh refinement so</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; <span class="comment">// no re-assignment necessary after adaptation.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; <span class="keywordtype">unsigned</span> ibound=3; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; <span class="keywordtype">unsigned</span> num_nod= <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordtype">double</span> ycoord = <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound,inod)-&gt;x(1); </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordtype">double</span> uy = 6.0*ycoord/htot*(1.0-ycoord/htot);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(0,uy);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound,inod)-&gt;set_value(1,0.0);    </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }<span class="comment">// end of setup boundary condition</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; <span class="comment">// Boundary conditions for wall mesh</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; <span class="comment">//----------------------------------</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; <span class="comment">// Set the boundary conditions: the lower end of the beam is fixed in space</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; <span class="keywordtype">unsigned</span> b=0; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; <span class="comment">// Pin displacements in both x and y directions</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; <a class="code" href="classFSIChannelWithLeafletProblem.html#ab6a1c532882a71ddd576c752da389de0">wall_mesh_pt</a>()-&gt;boundary_node_pt(b,0)-&gt;pin_position(0); </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; <a class="code" href="classFSIChannelWithLeafletProblem.html#ab6a1c532882a71ddd576c752da389de0">wall_mesh_pt</a>()-&gt;boundary_node_pt(b,0)-&gt;pin_position(1);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; <span class="comment">// Infinite slope: Pin type 1 (slope) dof for displacement direction 0 </span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; <a class="code" href="classFSIChannelWithLeafletProblem.html#ab6a1c532882a71ddd576c752da389de0">wall_mesh_pt</a>()-&gt;boundary_node_pt(b,0)-&gt;pin_position(1,0);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; <span class="comment">// Complete build of fluid elements</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; <span class="comment">//---------------------------------</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; <span class="keywordtype">unsigned</span> n_element = <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;nelement();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; <span class="comment">// Loop over the elements to set up element-specific </span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; <span class="comment">// things that cannot be handled by constructor</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(<a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;element_pt(e));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="comment">//Set the Reynolds number</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   el_pt-&gt;re_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="comment">//Set the Womersley number</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   el_pt-&gt;re_st_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  }<span class="comment">// end loop over elements</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; <span class="comment">// Pin redudant pressure dofs</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; RefineableNavierStokesEquations&lt;2&gt;::</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  pin_redundant_nodal_pressures(<a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;element_pt());</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; <span class="comment">// Complete build of wall elements</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; <span class="comment">//--------------------------------</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; n_element = <a class="code" href="classFSIChannelWithLeafletProblem.html#ab6a1c532882a71ddd576c752da389de0">wall_mesh_pt</a>()-&gt;nelement();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="comment">// Upcast to the specific element type</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   FSIHermiteBeamElement *elem_pt = </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>FSIHermiteBeamElement*<span class="keyword">&gt;</span>(<a class="code" href="classFSIChannelWithLeafletProblem.html#ab6a1c532882a71ddd576c752da389de0">wall_mesh_pt</a>()-&gt;element_pt(e));</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="comment">// Set physical parameters for each element:</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   elem_pt-&gt;h_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   <span class="comment">// Function that specifies the load ratios</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   elem_pt-&gt;q_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a66cb7ecda9ba0cd72367dd697f154545">Global_Physical_Variables::Q</a>;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="comment">// Set the undeformed shape for each element</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   elem_pt-&gt;undeformed_beam_pt() = <a class="code" href="fsi__channel__with__leaflet_8txt.html#aa9c84a4ff4c6e8e4df583cc7720541fb">undeformed_wall_pt</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="comment">// Leaflet is immersed and loaded by fluid on both sides</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   elem_pt-&gt;enable_fluid_loading_on_both_sides();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="comment">// The normal to the leaflet, as computed by the </span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="comment">// FSIHermiteElements points away from the fluid rather than </span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   <span class="comment">// into the fluid (as assumed by default) when viewed from</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   <span class="comment">// the &quot;front&quot; (face 0).</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   elem_pt-&gt;set_normal_pointing_out_of_fluid();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  } <span class="comment">// end of loop over elements</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; <span class="comment">// Setup FSI</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; <span class="comment">//----------</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; <span class="comment">// The velocity of the fluid nodes on the wall (fluid mesh boundary 4,5)</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; <span class="comment">// is set by the wall motion -- hence the no-slip condition must be</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; <span class="comment">// re-applied whenever a node update is performed for these nodes. </span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; <span class="comment">// Such tasks may be performed automatically by the auxiliary node update </span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; <span class="comment">// function specified by a function pointer:</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ibound=4;ibound&lt;6;ibound++ )</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  { </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keywordtype">unsigned</span> num_nod= <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    {   </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;     <a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound, inod)-&gt;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      set_auxiliary_node_update_fct_pt(</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;       FSI_functions::apply_no_slip_on_moving_wall);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }<span class="comment">// aux node update fct has been set</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; <span class="comment">// Work out which fluid dofs affect the residuals of the wall elements:</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; <span class="comment">// We pass the boundary between the fluid and solid meshes and </span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; <span class="comment">// pointers to the meshes. The interaction boundary is boundary 4 and 5</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; <span class="comment">// of the 2D fluid mesh.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; <span class="comment">// Front of leaflet: Set face=0 (which is also the default so this argument</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; <span class="comment">// could be omitted)</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; <span class="keywordtype">unsigned</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>=0; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; FSI_functions::setup_fluid_load_info_for_solid_elements&lt;ELEMENT,2&gt;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  (<span class="keyword">this</span>,4,<a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>,<a class="code" href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">Wall_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>); </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; <span class="comment">// Back of leaflet: face 1, needs to be specified explicitly</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>=1; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; FSI_functions::setup_fluid_load_info_for_solid_elements&lt;ELEMENT,2&gt;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  (<span class="keyword">this</span>,5,<a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>,<a class="code" href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">Wall_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>); </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; <span class="comment">// Choose iterative solvers with FSI preconditioner (only if not test)</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; <span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; <span class="keywordflow">if</span> (CommandLineArgs::Argc==1)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="comment">// Build iterative linear solver</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="comment">//------------------------------</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   GMRES&lt;CRDoubleMatrix&gt;* iterative_linear_solver_pt =</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keyword">new</span> GMRES&lt;CRDoubleMatrix&gt;;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="comment">// Set maximum number of iterations</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   iterative_linear_solver_pt-&gt;max_iter() = 200;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="comment">// Pass solver to problem:</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   linear_solver_pt()=iterative_linear_solver_pt;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <span class="comment">// Build preconditioner</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="comment">//---------------------</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   FSIPreconditioner* prec_pt=<span class="keyword">new</span> FSIPreconditioner(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <span class="comment">// Set Navier Stokes mesh:</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   prec_pt-&gt;set_navier_stokes_mesh(<a class="code" href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">Fluid_mesh_pt</a>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="comment">// Set solid mesh:</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   prec_pt-&gt;set_wall_mesh(<a class="code" href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">Wall_mesh_pt</a>);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="comment">// By default, the Schur complement preconditioner uses SuperLU as</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="comment">// an exact preconditioner (i.e. a solver) for the</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="comment">// momentum and Schur complement blocks.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="comment">// Can overwrite this by passing pointers to</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="comment">// other preconditioners that perform the (approximate)</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <span class="comment">// solves of these blocks</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">#ifdef OOMPH_HAS_HYPRE</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <span class="comment">// Create internal preconditioner used on Schur block</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <span class="comment">//---------------------------------------------------</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   HyprePreconditioner* p_preconditioner_pt = <span class="keyword">new</span> HyprePreconditioner;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="comment">// Shut up!</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   p_preconditioner_pt-&gt;disable_doc_time();</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <span class="comment">// Set defaults parameters for use as preconditioner on Poisson-type problem</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   Hypre_default_settings::</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    set_defaults_for_2D_poisson_problem(p_preconditioner_pt);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="comment">// Pass to preconditioner</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="comment">//prec_pt-&gt;set_p_preconditioner(p_preconditioner_pt);</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="comment">// Create internal preconditioner used on momentum block</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="comment">//------------------------------------------------------</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   HyprePreconditioner* f_preconditioner_pt = <span class="keyword">new</span> HyprePreconditioner;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="comment">// Shut up!</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   f_preconditioner_pt-&gt;disable_doc_time();</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <span class="comment">// Set default parameters for use as preconditioner in for momentum </span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="comment">// block in Navier-Stokes problem</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   Hypre_default_settings::</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    set_defaults_for_navier_stokes_momentum_block(f_preconditioner_pt);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="comment">// Use Hypre for momentum block</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="comment">//prec_pt-&gt;set_f_preconditioner(f_preconditioner_pt);</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="comment">// Retain fluid onto solid terms in FSI preconditioner</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   prec_pt-&gt;use_block_triangular_version_with_fluid_on_solid();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="comment">// Pass preconditioner to iterative linear solver</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   iterative_linear_solver_pt-&gt;preconditioner_pt()= prec_pt;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;     </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}<span class="comment">//end of constructor</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">//==== start_of_actions_after_adapt=================================</span><span class="comment"></span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">/// Actions_after_adapt()</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#acc3f4745ea9b4524aebbc4f2556d1286">  572</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFSIChannelWithLeafletProblem.html#acc3f4745ea9b4524aebbc4f2556d1286">FSIChannelWithLeafletProblem&lt;ELEMENT&gt;::actions_after_adapt</a>()</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;{</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; <span class="comment">// Unpin all pressure dofs</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; RefineableNavierStokesEquations&lt;2&gt;::</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  unpin_all_pressure_dofs(<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;element_pt());</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; <span class="comment">// Pin redundant pressure dofs</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; RefineableNavierStokesEquations&lt;2&gt;::</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  pin_redundant_nodal_pressures(<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;element_pt());</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; <span class="comment">// (Re-)apply the no slip condition on the moving wall</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; <span class="comment">//-----------------------------------------------------</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; <span class="comment">// The velocity of the fluid nodes on the wall (fluid mesh boundary 4,5)</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; <span class="comment">// is set by the wall motion -- hence the no-slip condition must be</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; <span class="comment">// re-applied whenever a node update is performed for these nodes. </span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; <span class="comment">// Such tasks may be performed automatically by the auxiliary node update </span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; <span class="comment">// function specified by a function pointer:</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ibound=4;ibound&lt;6;ibound++ )</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  { </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <span class="keywordtype">unsigned</span> num_nod= <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    {   </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;     <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;boundary_node_pt(ibound, inod)-&gt;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      set_auxiliary_node_update_fct_pt(</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;       FSI_functions::apply_no_slip_on_moving_wall);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  } <span class="comment">// aux node update fct has been (re-)set</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; <span class="comment">// Re-setup FSI</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; <span class="comment">//-------------</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; <span class="comment">// Work out which fluid dofs affect the residuals of the wall elements:</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; <span class="comment">// We pass the boundary between the fluid and solid meshes and </span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; <span class="comment">// pointers to the meshes. The interaction boundary is boundary 4 and 5</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; <span class="comment">// of the 2D fluid mesh.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; <span class="comment">// Front of leaflet: Set face=0 (which is also the default so this argument</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; <span class="comment">// could be omitted)</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; <span class="keywordtype">unsigned</span> <a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>=0; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; FSI_functions::setup_fluid_load_info_for_solid_elements&lt;ELEMENT,2&gt;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  (<span class="keyword">this</span>,4,<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>); </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; <span class="comment">// Back of leaflet: face 1, needs to be specified explicitly</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>=1; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; FSI_functions::setup_fluid_load_info_for_solid_elements&lt;ELEMENT,2&gt;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  (<span class="keyword">this</span>,5,<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>,<a class="code" href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a>); </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;} <span class="comment">// end_of_actions_after_adapt</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">//==start_of_doc_solution=================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">/// Doc the solution</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="classFSIChannelWithLeafletProblem.html#a055f124f38dca43bc3ed36b80c5c0880">  633</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classFSIChannelWithLeafletProblem.html#a055f124f38dca43bc3ed36b80c5c0880">FSIChannelWithLeafletProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; doc_info,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                                         ofstream&amp; trace)</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;{ </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; npts=5; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; <span class="comment">// Output fluid solution </span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; some_file.close();</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; <span class="comment">// Output wall solution </span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/wall_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; some_file.close();</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; <span class="comment">// Get node at tip of leaflet</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; <span class="keywordtype">unsigned</span> n_el_wall=<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>-&gt;nelement();</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; Node* tip_node_pt=<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>-&gt;finite_element_pt(n_el_wall-1)-&gt;node_pt(1);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; <span class="comment">// Get time:</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; <span class="keywordtype">double</span> time=time_pt()-&gt;time();</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; <span class="comment">// Write trace file</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; trace &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;       &lt;&lt; <a class="code" href="namespaceGlobal__Physical__Variables.html#ad651484fe06209606bccefe6fe23be0c">Global_Physical_Variables::flux</a>(time) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;       &lt;&lt; tip_node_pt-&gt;x(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;       &lt;&lt; tip_node_pt-&gt;x(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;       &lt;&lt; tip_node_pt-&gt;dposition_dt(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;       &lt;&lt; tip_node_pt-&gt;dposition_dt(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;       &lt;&lt; doc_info.number() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;       &lt;&lt; std::endl;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; <span class="comment">// Help me figure out what the &quot;front&quot; and &quot;back&quot; faces of the leaflet are</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; <span class="comment">//------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; <span class="comment">// Output fluid elements on fluid mesh boundary 4 (associated with</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; <span class="comment">// the &quot;front&quot;)</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; <span class="keywordtype">unsigned</span> bound=4;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/fluid_boundary_elements_front_%i.dat&quot;</span>,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;         doc_info.directory().c_str(),</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; <span class="keywordtype">unsigned</span> nel= <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;nboundary_element(bound);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;boundary_element_pt(bound,e))</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    -&gt;output(some_file,npts);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; some_file.close();</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; <span class="comment">// Output fluid elements on fluid mesh boundary 5 (associated with</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; <span class="comment">// the &quot;back&quot;)</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; bound=5;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/fluid_boundary_elements_back_%i.dat&quot;</span>,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;         doc_info.directory().c_str(),</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; nel= <a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;nboundary_element(bound);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(<a class="code" href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a>-&gt;boundary_element_pt(bound,e))</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    -&gt;output(some_file,npts);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; some_file.close();</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; <span class="comment">// Output normal vector on wall elements</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/wall_normal_%i.dat&quot;</span>,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;         doc_info.directory().c_str(),</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; nel=<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>-&gt;nelement();</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; Vector&lt;double&gt; s(1);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; Vector&lt;double&gt; x(2);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; Vector&lt;double&gt; xi(1);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; Vector&lt;double&gt; N(2);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   FSIHermiteBeamElement* el_pt=</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>FSIHermiteBeamElement*<span class="keyword">&gt;</span>(<a class="code" href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a>-&gt;element_pt(e));</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <span class="comment">// Loop over plot points</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;npts;i++)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;     s[0]=-1.0+2.0*double(i)/double(npts-1);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;     <span class="comment">// Get Eulerian position</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;     el_pt-&gt;interpolated_x(s,x);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;     <span class="comment">// Get unit normal</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;     el_pt-&gt;get_normal(s,N);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;     <span class="comment">// Get Lagrangian coordinate</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;     el_pt-&gt;interpolated_xi(s,xi);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;     </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;     some_file &lt;&lt; x[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; x[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;               &lt;&lt; N[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; N[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;               &lt;&lt; xi[0] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; some_file.close();</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;} <span class="comment">// end_of_doc_solution</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">//======= start_of_main================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">/// Driver code  -- pass a command line argument if you want to run</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">/// the code in validation mode where it only performs a few steps</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"></span><span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00756"></a><span class="lineno"><a class="line" href="fsi__channel__with__leaflet_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">  756</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="fsi__channel__with__leaflet_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;{</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; <span class="comment">// Store command line arguments</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; CommandLineArgs::setup(argc,argv);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; <span class="comment">//Parameters for the leaflet: x-position of root and height</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; <span class="keywordtype">double</span> x_0 = 1.0; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; <span class="keywordtype">double</span> hleaflet=0.5;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; <span class="comment">// Number of elements in various regions of mesh</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; <span class="keywordtype">unsigned</span> nleft=6; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; <span class="keywordtype">unsigned</span> nright=18;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; <span class="keywordtype">unsigned</span> ny1=3; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; <span class="keywordtype">unsigned</span> ny2=3; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; <span class="comment">// Dimensions of fluid mesh: length to the left and right of leaflet</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; <span class="comment">// and total height</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; <span class="keywordtype">double</span> lleft =1.0; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; <span class="keywordtype">double</span> lright=3.0; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; <span class="keywordtype">double</span> htot=1.0;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; <span class="comment">//Build the problem</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; <a class="code" href="classFSIChannelWithLeafletProblem.html">FSIChannelWithLeafletProblem</a>&lt;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  AlgebraicElement&lt;RefineableQTaylorHoodElement&lt;2&gt; &gt; &gt;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a>(lleft,lright,hleaflet,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;          htot,nleft,nright,ny1,ny2,x_0); </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; <span class="comment">// Set up doc info</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; DocInfo doc_info; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; <span class="comment">// Trace file</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; ofstream trace;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,doc_info.directory().c_str());</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; trace.open(filename);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; <span class="comment">// Number of timesteps (reduced for validation)</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; <span class="keywordtype">unsigned</span> nstep=200;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; <span class="keywordflow">if</span> (CommandLineArgs::Argc&gt;1)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   nstep=2;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; <span class="comment">//Timestep: </span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; <span class="keywordtype">double</span> dt=0.05;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; <span class="comment">// Initialise timestep </span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a>.initialise_dt(dt);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; <span class="comment">// Doc initial guess for steady solve</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a>.doc_solution(doc_info,trace);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; doc_info.number()++; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; <span class="comment">// Initial loop to increment the Reynolds number in sequence of steady solves</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; <span class="keywordtype">unsigned</span> n_increment=4;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; <span class="comment">// Just to one step for validation run</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; <span class="keywordflow">if</span> (CommandLineArgs::Argc&gt;1)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   n_increment=1;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; <span class="comment">// Set max. number of adaptations</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; <span class="keywordtype">unsigned</span> max_adapt=3;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>=0.0;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n_increment;i++)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="comment">// Increase Re and ReSt (for St=1)</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;   <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>+=50.0;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <a class="code" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a>=<a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="comment">// Solve the steady problem </span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   std::cout &lt;&lt; <span class="stringliteral">&quot;Computing a steady solution for Re=&quot;</span> </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;             &lt;&lt;  <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a>.steady_newton_solve(max_adapt);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a>.doc_solution(doc_info,trace);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   doc_info.number()++; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  } <span class="comment">// reached final Reynolds number </span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; <span class="comment">// Proper time-dependent run</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; <span class="comment">//--------------------------</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; <span class="comment">// Limit the number of adaptations during unsteady run to one per timestep</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; max_adapt=1;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; <span class="comment">// Don&#39;t re-set the initial conditions when adapting the mesh</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; <span class="keywordtype">bool</span> first = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; <span class="comment">// Timestepping loop</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  { </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;   <span class="comment">// Solve the problem</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a>.unsteady_newton_solve(dt,max_adapt,first);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   <span class="comment">// Output the solution</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   <a class="code" href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a>.doc_solution(doc_info,trace);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   <span class="comment">// Step number</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   doc_info.number()++;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}<span class="comment">//end of main</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassUndeformedLeaflet_html_a56153a1d117dd41657183655de094d3e"><div class="ttname"><a href="classUndeformedLeaflet.html#a56153a1d117dd41657183655de094d3e">UndeformedLeaflet::ngeom_data</a></div><div class="ttdeci">unsigned ngeom_data() const</div><div class="ttdoc">Number of geometric Data in GeomObject: None.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00145">fsi_channel_with_leaflet.cc:145</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a2ffa220a56bff9b6b495ed47954d513f"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a2ffa220a56bff9b6b495ed47954d513f">Global_Physical_Variables::Period</a></div><div class="ttdeci">double Period</div><div class="ttdoc">Period for fluctuations in flux.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00062">fsi_channel_with_leaflet.cc:62</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_a055f124f38dca43bc3ed36b80c5c0880"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#a055f124f38dca43bc3ed36b80c5c0880">FSIChannelWithLeafletProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info, ofstream &amp;trace)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00633">fsi_channel_with_leaflet.cc:633</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_a8a32ef77f32b3283b4b509669deb0a11"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#a8a32ef77f32b3283b4b509669deb0a11">FSIChannelWithLeafletProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Actions before solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00191">fsi_channel_with_leaflet.cc:191</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a10ce8f652e1f7e37624e9c8e5dde94d5"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a10ce8f652e1f7e37624e9c8e5dde94d5">Fluid_mesh_pt</a></div><div class="ttdeci">see&lt; A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details until pin_redundant When completing the build of the wall elements we use the function c one of the two faces will have to be identified as the front(face 0) and the other one as the &quot;back&quot;(face 1). The function \c normal_points_into_fluid() allows us to indicate if the outer unit normal on the leaflet(as computed by \c FSIHermiteBeamElement the Fluid_mesh_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00446">fsi_channel_with_leaflet.txt:446</a></div></div>
<div class="ttc" id="aclassUndeformedLeaflet_html_a6949784da1030dd63ef741d170ef9798"><div class="ttname"><a href="classUndeformedLeaflet.html#a6949784da1030dd63ef741d170ef9798">UndeformedLeaflet::position</a></div><div class="ttdeci">void position(const unsigned &amp;t, const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">Parametrised position on object: r(zeta). Evaluated at previous timestep. t=0: current time; t&gt;0: pre...</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00113">fsi_channel_with_leaflet.cc:113</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html">FSIChannelWithLeafletProblem</a></div><div class="ttdoc">FSI leaflet in channel.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00164">fsi_channel_with_leaflet.cc:164</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="fsi__channel__with__leaflet_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00756">fsi_channel_with_leaflet.cc:756</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_abff6e46a940263c9255a61f649bb4239"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#abff6e46a940263c9255a61f649bb4239">FSIChannelWithLeafletProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Actions after solve (empty)</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00188">fsi_channel_with_leaflet.cc:188</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_a943437726f0a54fa8f7fc9ffb12bc4cd"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#a943437726f0a54fa8f7fc9ffb12bc4cd">FSIChannelWithLeafletProblem::Wall_mesh_pt</a></div><div class="ttdeci">OneDLagrangianMesh&lt; FSIHermiteBeamElement &gt; * Wall_mesh_pt</div><div class="ttdoc">Pointer to the &quot;wall&quot; mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00247">fsi_channel_with_leaflet.cc:247</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_acc3f4745ea9b4524aebbc4f2556d1286"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#acc3f4745ea9b4524aebbc4f2556d1286">FSIChannelWithLeafletProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adaptation.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00572">fsi_channel_with_leaflet.cc:572</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa46dc81a0757e8f9707646e03c32d4fc"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa46dc81a0757e8f9707646e03c32d4fc">Global_Physical_Variables::Min_flux</a></div><div class="ttdeci">double Min_flux</div><div class="ttdoc">Min. flux.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00065">fsi_channel_with_leaflet.cc:65</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a554e2755ee0f2660c24d8053b1a26eba"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a554e2755ee0f2660c24d8053b1a26eba">wall_time_stepper_pt</a></div><div class="ttdeci">Next we create the mesh of Hermite beam elements that represents the passing a pointer to an instance of the c UndeformedLeaflet to its constructor wall_time_stepper_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00362">fsi_channel_with_leaflet.txt:362</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ad651484fe06209606bccefe6fe23be0c"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ad651484fe06209606bccefe6fe23be0c">Global_Physical_Variables::flux</a></div><div class="ttdeci">double flux(const double &amp;t)</div><div class="ttdoc">Flux: Pulsatile flow fluctuating between Min_flux and Max_flux with period Period.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00072">fsi_channel_with_leaflet.cc:72</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a0ae549c3a1e99d9d4dd46a0443635590"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a0ae549c3a1e99d9d4dd46a0443635590">build_global_mesh</a></div><div class="ttdeci">We specify an error estimator for the fluid mesh and add both meshes to the c Problem before combining them into a global mesh until build_global_mesh()</div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_ade82d11fc4bdd54b848f02361f8cc99e"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#ade82d11fc4bdd54b848f02361f8cc99e">FSIChannelWithLeafletProblem::Leaflet_pt</a></div><div class="ttdeci">GeomObject * Leaflet_pt</div><div class="ttdoc">Pointer to the GeomObject that represents the wall.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00250">fsi_channel_with_leaflet.cc:250</a></div></div>
<div class="ttc" id="aclassUndeformedLeaflet_html"><div class="ttname"><a href="classUndeformedLeaflet.html">UndeformedLeaflet</a></div><div class="ttdoc">GeomObject: Undeformed straight, vertical leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00090">fsi_channel_with_leaflet.cc:90</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_adc77c86dbe31ae29b9c7082ea1fff7a4"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#adc77c86dbe31ae29b9c7082ea1fff7a4">Wall_mesh_pt</a></div><div class="ttdeci">see&lt; A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details until pin_redundant When completing the build of the wall elements we use the function c one of the two faces will have to be identified as the front(face 0) and the other one as the &quot;back&quot;(face 1). The function \c normal_points_into_fluid() allows us to indicate if the outer unit normal on the leaflet(as computed by \c FSIHermiteBeamElement the Wall_mesh_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00446">fsi_channel_with_leaflet.txt:446</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aee645139728fd3d01573b161c74e7e8a"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aee645139728fd3d01573b161c74e7e8a">Global_Physical_Variables::Max_flux</a></div><div class="ttdeci">double Max_flux</div><div class="ttdoc">Max. flux.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00068">fsi_channel_with_leaflet.cc:68</a></div></div>
<div class="ttc" id="aclassUndeformedLeaflet_html_aa89fc695af9e53aa38894c9d875afd36"><div class="ttname"><a href="classUndeformedLeaflet.html#aa89fc695af9e53aa38894c9d875afd36">UndeformedLeaflet::X0</a></div><div class="ttdeci">double X0</div><div class="ttdoc">x position of the undeformed leaflet's origin.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00150">fsi_channel_with_leaflet.cc:150</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_a40cee3652918bdcf67569afc89d3074d"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#a40cee3652918bdcf67569afc89d3074d">FSIChannelWithLeafletProblem::Fluid_mesh_pt</a></div><div class="ttdeci">RefineableAlgebraicChannelWithLeafletMesh&lt; ELEMENT &gt; * Fluid_mesh_pt</div><div class="ttdoc">Pointer to the fluid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00244">fsi_channel_with_leaflet.cc:244</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_ac73220fa534cf2409bb0ebcf2fb5e1d5"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#ac73220fa534cf2409bb0ebcf2fb5e1d5">FSIChannelWithLeafletProblem::actions_before_implicit_timestep</a></div><div class="ttdeci">void actions_before_implicit_timestep()</div><div class="ttdoc">Update the inflow velocity.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00213">fsi_channel_with_leaflet.cc:213</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_aec9244497829f9a85cbca7307c4d4e10"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#aec9244497829f9a85cbca7307c4d4e10">FSIChannelWithLeafletProblem::fluid_mesh_pt</a></div><div class="ttdeci">RefineableAlgebraicChannelWithLeafletMesh&lt; ELEMENT &gt; * fluid_mesh_pt()</div><div class="ttdoc">Access function to fluid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00203">fsi_channel_with_leaflet.cc:203</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a9a15a4e12ba10c0745f4eb8e891e41ec"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a9a15a4e12ba10c0745f4eb8e891e41ec">Re</a></div><div class="ttdeci">see n n&lt; CENTER &gt;&lt; A href=&quot;http: &lt;/CENTER&gt; In this tutorial we concentrate on the problem formulation The application of the preconditioner is discussed&lt;a href=&quot;../../../preconditioners/fsi/html/index.html&quot;&gt; elsewhere&lt;/a&gt; the required source code is contained in the&lt;A href=&quot;../../../../demo_drivers/interaction/fsi_channel_with_leaflet/fsi_channel_with_leaflet.cc&quot;&gt; driver code&lt;/A&gt;&lt;HR&gt;&lt;HR&gt; section the_problem The Problem The figure below shows a sketch of the we use asterisks to distinguish dimensional quantities from their non dimensional equivalents to be introduced later We assume that the leaflet is sufficiently thin so as far as the boundary conditions for the fluid are the leaflet can be assumed to be infinitely thin This allows us to parametrise its shape by a single Lagrangian coordinate f xi* f Hence we write the position vector to a material point on the leaflet as f H time on the natural timescale of the f H the velocities on f U and the pressure on the viscous scale The fluid flow is then governed by the non dimensional Navier Stokes equations f [Re \left( St \frac{\partial u_i}{\partial t} + u_j \frac{\partial u_i}{\partial x_j} \right) =- \frac{\partial p}{\partial x_i} +\frac{\partial }{\partial x_j} \left[ \left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i} \right) \right],\f] where f Re</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00065">fsi_channel_with_leaflet.txt:65</a></div></div>
<div class="ttc" id="aclassUndeformedLeaflet_html_ac4c0478b1f329360684af14b59043b12"><div class="ttname"><a href="classUndeformedLeaflet.html#ac4c0478b1f329360684af14b59043b12">UndeformedLeaflet::UndeformedLeaflet</a></div><div class="ttdeci">UndeformedLeaflet(const double &amp;x0)</div><div class="ttdoc">Constructor: argument is the x-coordinate of the leaflet.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00096">fsi_channel_with_leaflet.cc:96</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a085ee4bf968ffdd01a41b8c41864f907"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a></div><div class="ttdeci">double ReSt</div><div class="ttdoc">Womersley number: Product of Reynolds and Strouhal numbers.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00052">fsi_channel_with_leaflet.cc:52</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_aa82ca9f1c5efd140c153e31d5c906c15"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#aa82ca9f1c5efd140c153e31d5c906c15">face</a></div><div class="ttdeci">see&lt; A HREF=&quot;../../../navier_stokes/adaptive_driven_cavity/html/index.html&quot;&gt; another tutorial&lt;/A &gt; for details until pin_redundant When completing the build of the wall elements we use the function c one of the two faces will have to be identified as the front(face 0) and the other one as the &quot;back&quot;(face 1). The function \c normal_points_into_fluid() allows us to indicate if the outer unit normal on the leaflet(as computed by \c FSIHermiteBeamElement the face</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00446">fsi_channel_with_leaflet.txt:446</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_aaa0a455e91c4fb2dd9696607b802d01b"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#aaa0a455e91c4fb2dd9696607b802d01b">FSIChannelWithLeafletProblem::FSIChannelWithLeafletProblem</a></div><div class="ttdeci">FSIChannelWithLeafletProblem(const double &amp;lleft, const double &amp;lright, const double &amp;hleaflet, const double &amp;htot, const unsigned &amp;nleft, const unsigned &amp;nright, const unsigned &amp;ny1, const unsigned &amp;ny2, const double &amp;x_0)</div><div class="ttdoc">Constructor: Pass the lenght of the domain at the left of the leaflet lleft,the lenght of the domain ...</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00265">fsi_channel_with_leaflet.cc:265</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_a5df1d8f7229314a92ffb48ec61f56fe0"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#a5df1d8f7229314a92ffb48ec61f56fe0">FSIChannelWithLeafletProblem::~FSIChannelWithLeafletProblem</a></div><div class="ttdeci">~FSIChannelWithLeafletProblem()</div><div class="ttdoc">Destructor empty.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00185">fsi_channel_with_leaflet.cc:185</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_aa9c84a4ff4c6e8e4df583cc7720541fb"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#aa9c84a4ff4c6e8e4df583cc7720541fb">undeformed_wall_pt</a></div><div class="ttdeci">Next we create the mesh of Hermite beam elements that represents the passing a pointer to an instance of the c UndeformedLeaflet to its constructor undeformed_wall_pt</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00362">fsi_channel_with_leaflet.txt:362</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a5b052db3a93fe3ee2945af0117375d3d"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a5b052db3a93fe3ee2945af0117375d3d">Q</a></div><div class="ttdeci">f where f E f and f nu f are its Young s modulus and Poisson s respectively The beam s deformation is governed by the principle virtual of discussed in detail&lt; A HREF=&quot;../../../beam/tensioned_string/html/index.html&quot;&gt; in another tutorial&lt;/A &gt; As in the Navier Stokes we scale all lengths in the beam problem on the channel s f H f f mu U used to non dimensionalise the Navier Stokes to the beam s effective elastic f if f Q</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00144">fsi_channel_with_leaflet.txt:144</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_ab6a1c532882a71ddd576c752da389de0"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#ab6a1c532882a71ddd576c752da389de0">FSIChannelWithLeafletProblem::wall_mesh_pt</a></div><div class="ttdeci">OneDLagrangianMesh&lt; FSIHermiteBeamElement &gt; * wall_mesh_pt()</div><div class="ttdoc">Access function to the wall mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00197">fsi_channel_with_leaflet.cc:197</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af6e07423e22c0991084d9a2f43727805"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Non-dimensional wall thickness.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00055">fsi_channel_with_leaflet.cc:55</a></div></div>
<div class="ttc" id="aclassUndeformedLeaflet_html_a47d674756ce22e00a44ca0bd030a99da"><div class="ttname"><a href="classUndeformedLeaflet.html#a47d674756ce22e00a44ca0bd030a99da">UndeformedLeaflet::d2position</a></div><div class="ttdeci">void d2position(const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r, DenseMatrix&lt; double &gt; &amp;drdzeta, RankThreeTensor&lt; double &gt; &amp;ddrdzeta) const</div><div class="ttdoc">Posn vector and its 1st &amp; 2nd derivatives w.r.t. to coordinates:  = drdzeta(alpha,...</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00126">fsi_channel_with_leaflet.cc:126</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">Global parameters.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00046">fsi_channel_with_leaflet.cc:46</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_a765a35c452989fa2d54bc1441d04925c"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#a765a35c452989fa2d54bc1441d04925c">FSIChannelWithLeafletProblem::Htot</a></div><div class="ttdeci">double Htot</div><div class="ttdoc">Total height of the domain.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00253">fsi_channel_with_leaflet.cc:253</a></div></div>
<div class="ttc" id="aclassFSIChannelWithLeafletProblem_html_aff02228eddae18ef3d57306ba1e61495"><div class="ttname"><a href="classFSIChannelWithLeafletProblem.html#aff02228eddae18ef3d57306ba1e61495">FSIChannelWithLeafletProblem::actions_before_newton_convergence_check</a></div><div class="ttdeci">void actions_before_newton_convergence_check()</div><div class="ttdoc">Update before checking Newton convergence: Update the nodal positions in the fluid mesh in response t...</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00236">fsi_channel_with_leaflet.cc:236</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a66cb7ecda9ba0cd72367dd697f154545"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a66cb7ecda9ba0cd72367dd697f154545">Global_Physical_Variables::Q</a></div><div class="ttdeci">double Q</div><div class="ttdoc">Fluid structure interaction parameter: Ratio of stresses used for non-dimensionalisation of fluid to ...</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00059">fsi_channel_with_leaflet.cc:59</a></div></div>
<div class="ttc" id="aclassUndeformedLeaflet_html_a8e9b79702eb9a38e19886b84aeb47918"><div class="ttname"><a href="classUndeformedLeaflet.html#a8e9b79702eb9a38e19886b84aeb47918">UndeformedLeaflet::position</a></div><div class="ttdeci">void position(const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">Position vector at Lagrangian coordinate zeta.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00102">fsi_channel_with_leaflet.cc:102</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_a2686101caa40fa891e30660e3dacd6c7"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#a2686101caa40fa891e30660e3dacd6c7">add_time_stepper_pt</a></div><div class="ttdeci">this is discussed in more detail in&lt; A HREF=&quot;../../fsi_collapsible_channel_adapt/html/index.html&quot;&gt; another tutorial&lt;/A &gt; skipline start_of_constructor until add_time_stepper_pt(wall_time_stepper_pt)</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8cc_source.html#l00049">fsi_channel_with_leaflet.cc:49</a></div></div>
<div class="ttc" id="afsi__channel__with__leaflet_8txt_html_abbb977d4712081610d3fbcc3962207ea"><div class="ttname"><a href="fsi__channel__with__leaflet_8txt.html#abbb977d4712081610d3fbcc3962207ea">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="fsi__channel__with__leaflet_8txt_source.html#l00015">fsi_channel_with_leaflet.txt:15</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Jul 8 2021 23:20:19
        </div>
      </div>
    </footer>
</body>
</html>

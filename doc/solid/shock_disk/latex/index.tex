Detailed documentation to be written. Here\textquotesingle{}s the already fairly well documented driver code...


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//LIC// ====================================================================}}
\DoxyCodeLine{\textcolor{comment}{//LIC// This file forms part of oomph-\/lib, the object-\/oriented, }}
\DoxyCodeLine{\textcolor{comment}{//LIC// multi-\/physics finite-\/element library, available }}
\DoxyCodeLine{\textcolor{comment}{//LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// Copyright (C) 2006-\/2023 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\textcolor{comment}{//LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\textcolor{comment}{//LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\textcolor{comment}{//LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\textcolor{comment}{//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\textcolor{comment}{//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\textcolor{comment}{//LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\textcolor{comment}{//LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\textcolor{comment}{//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\textcolor{comment}{//LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\textcolor{comment}{//LIC// }}
\DoxyCodeLine{\textcolor{comment}{//LIC//====================================================================}}
\DoxyCodeLine{\textcolor{comment}{// Driver for large-\/displacement elasto-\/dynamic test problem:}}
\DoxyCodeLine{\textcolor{comment}{// Circular disk impulsively loaded by compressive load.}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//My own includes}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}generic.h"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}solid.h"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//Need to instantiate templated mesh}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}meshes/quarter\_circle\_sector\_mesh.h"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{using namespace }oomph;}
\DoxyCodeLine{ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Global variables}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//================================================================}}
\DoxyCodeLine{\textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceGlobal__Physical__Variables}{Global\_Physical\_Variables}}}
\DoxyCodeLine{\{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Pointer to constitutive law}}
\DoxyCodeLine{\textcolor{comment}{} ConstitutiveLaw* \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a2a37fb040c832ee7a086bb13bb02a100}{Constitutive\_law\_pt}};}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Elastic modulus}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a09a019474b7405b35da2437f7779bc7e}{E}}=1.0;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Poisson's ratio}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a3962c36313826b19f216f6bbbdd6a477}{Nu}}=0.3;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Uniform pressure}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{P}} = 0.00;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Constant pressure load}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a19f4e20a92e7d216b4d2b00308f96917}{constant\_pressure}}(\textcolor{keyword}{const} Vector<double> \&xi,\textcolor{keyword}{const} Vector<double> \&x,}
\DoxyCodeLine{                        \textcolor{keyword}{const} Vector<double> \&n, Vector<double> \&traction)}
\DoxyCodeLine{ \{}
\DoxyCodeLine{  \textcolor{keywordtype}{unsigned} dim = traction.size();}
\DoxyCodeLine{  \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<dim;i++)}
\DoxyCodeLine{   \{}
\DoxyCodeLine{    traction[i] = -\/\mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{P}}*n[i];}
\DoxyCodeLine{   \}}
\DoxyCodeLine{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// ////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Elastic quarter circle sector mesh with functionality to}}
\DoxyCodeLine{\textcolor{comment}{/// attach traction elements to the curved surface. We "{}upgrade"{}}}
\DoxyCodeLine{\textcolor{comment}{/// the RefineableQuarterCircleSectorMesh to become an}}
\DoxyCodeLine{\textcolor{comment}{/// SolidMesh and equate the Eulerian and Lagrangian coordinates,}}
\DoxyCodeLine{\textcolor{comment}{/// thus making the domain represented by the mesh the stress-\/free }}
\DoxyCodeLine{\textcolor{comment}{/// configuration. }}
\DoxyCodeLine{\textcolor{comment}{/// \(\backslash\)n\(\backslash\)n}}
\DoxyCodeLine{\textcolor{comment}{/// The member function \(\backslash\)c make\_traction\_element\_mesh() creates}}
\DoxyCodeLine{\textcolor{comment}{/// a separate mesh of SolidTractionElements that are attached to the}}
\DoxyCodeLine{\textcolor{comment}{/// mesh's curved boundary (boundary 1). }}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template} <\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\textcolor{keyword}{class }\mbox{\hyperlink{classElasticRefineableQuarterCircleSectorMesh}{ElasticRefineableQuarterCircleSectorMesh}} :}
\DoxyCodeLine{ \textcolor{keyword}{public} \textcolor{keyword}{virtual} RefineableQuarterCircleSectorMesh<ELEMENT>,}
\DoxyCodeLine{ \textcolor{keyword}{public} \textcolor{keyword}{virtual} SolidMesh}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Constructor: Build mesh and copy Eulerian coords to Lagrangian}}
\DoxyCodeLine{\textcolor{comment}{ /// ones so that the initial configuration is the stress-\/free one.}}
\DoxyCodeLine{\textcolor{comment}{} \mbox{\hyperlink{classElasticRefineableQuarterCircleSectorMesh}{ElasticRefineableQuarterCircleSectorMesh<ELEMENT>}}(GeomObject* wall\_pt,}
\DoxyCodeLine{                                         \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& xi\_lo,}
\DoxyCodeLine{                                         \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& fract\_mid,}
\DoxyCodeLine{                                         \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& xi\_hi,}
\DoxyCodeLine{                                         TimeStepper* time\_stepper\_pt=}
\DoxyCodeLine{                                         \&Mesh::Default\_TimeStepper) :}
\DoxyCodeLine{  RefineableQuarterCircleSectorMesh<ELEMENT>(wall\_pt,xi\_lo,fract\_mid,xi\_hi,}
\DoxyCodeLine{                                             time\_stepper\_pt)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{\textcolor{preprocessor}{\#ifdef PARANOID}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{   /// Check that the element type is derived from the SolidFiniteElement}}
\DoxyCodeLine{\textcolor{comment}{}   SolidFiniteElement* el\_pt=\textcolor{keyword}{dynamic\_cast<}SolidFiniteElement*\textcolor{keyword}{>}}
\DoxyCodeLine{    (finite\_element\_pt(0));}
\DoxyCodeLine{   \textcolor{keywordflow}{if} (el\_pt==0)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{      \textcolor{stringliteral}{"{}Element needs to be derived from SolidFiniteElement\(\backslash\)n"{}},}
\DoxyCodeLine{      OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{      OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{    \}}
\DoxyCodeLine{\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{// Make the current configuration the undeformed one by}}
\DoxyCodeLine{   \textcolor{comment}{// setting the nodal Lagrangian coordinates to their current}}
\DoxyCodeLine{   \textcolor{comment}{// Eulerian ones}}
\DoxyCodeLine{   set\_lagrangian\_nodal\_coordinates();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Function to create mesh made of traction elements}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} make\_traction\_element\_mesh(SolidMesh*\& traction\_mesh\_pt)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{// Make new mesh}}
\DoxyCodeLine{   traction\_mesh\_pt=\textcolor{keyword}{new} SolidMesh;}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{// Loop over all elements on boundary 1:}}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} b=1;}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} n\_element = this-\/>nboundary\_element(b);}
\DoxyCodeLine{   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     \textcolor{comment}{// The element itself:}}
\DoxyCodeLine{     FiniteElement* fe\_pt = this-\/>boundary\_element\_pt(b,e);}
\DoxyCodeLine{     }
\DoxyCodeLine{     \textcolor{comment}{// Find the index of the face of element e along boundary b}}
\DoxyCodeLine{     \textcolor{keywordtype}{int} face\_index = this-\/>face\_index\_at\_boundary(b,e);}
\DoxyCodeLine{     }
\DoxyCodeLine{     \textcolor{comment}{// Create new element}}
\DoxyCodeLine{     traction\_mesh\_pt-\/>add\_element\_pt(\textcolor{keyword}{new} SolidTractionElement<ELEMENT>}
\DoxyCodeLine{                                      (fe\_pt,face\_index));}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Function to wipe and re-\/create mesh made of traction elements}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} remake\_traction\_element\_mesh(SolidMesh*\& traction\_mesh\_pt)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{// Wipe existing mesh (but don't call it's destructor as this}}
\DoxyCodeLine{   \textcolor{comment}{// would wipe all the nodes too!)}}
\DoxyCodeLine{   traction\_mesh\_pt-\/>flush\_element\_and\_node\_storage();}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{// Loop over all elements on boundary 1:}}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} b=1;}
\DoxyCodeLine{   \textcolor{keywordtype}{unsigned} n\_element = this-\/>nboundary\_element(b);}
\DoxyCodeLine{   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e=0;e<n\_element;e++)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     \textcolor{comment}{// The element itself:}}
\DoxyCodeLine{     FiniteElement* fe\_pt = this-\/>boundary\_element\_pt(b,e);}
\DoxyCodeLine{     }
\DoxyCodeLine{     \textcolor{comment}{// Find the index of the face of element e along boundary b}}
\DoxyCodeLine{     \textcolor{keywordtype}{int} face\_index = this-\/>face\_index\_at\_boundary(b,e);}
\DoxyCodeLine{     }
\DoxyCodeLine{     \textcolor{comment}{// Create new element}}
\DoxyCodeLine{     traction\_mesh\_pt-\/>add\_element\_pt(\textcolor{keyword}{new} SolidTractionElement<ELEMENT>}
\DoxyCodeLine{                                      (fe\_pt,face\_index));}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{/// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//====================================================================== }\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// "{}Shock"{} wave propagates through an impulsively loaded}}
\DoxyCodeLine{\textcolor{comment}{/// circular disk.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//====================================================================== }}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keyword}{class} TIMESTEPPER>}
\DoxyCodeLine{\textcolor{keyword}{class }\mbox{\hyperlink{classDiskShockWaveProblem}{DiskShockWaveProblem}} : \textcolor{keyword}{public} Problem}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Constructor:}}
\DoxyCodeLine{\textcolor{comment}{} \mbox{\hyperlink{classDiskShockWaveProblem}{DiskShockWaveProblem}}();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Run the problem; specify case\_number to label output}}
\DoxyCodeLine{\textcolor{comment}{ /// directory}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} run(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& case\_number);}
\DoxyCodeLine{ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Access function for the solid mesh}}
\DoxyCodeLine{\textcolor{comment}{} \mbox{\hyperlink{classElasticRefineableQuarterCircleSectorMesh}{ElasticRefineableQuarterCircleSectorMesh<ELEMENT>}}*\& solid\_mesh\_pt() }
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{keywordflow}{return} Solid\_mesh\_pt;  }
\DoxyCodeLine{  \} }
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Access function for the mesh of surface traction elements}}
\DoxyCodeLine{\textcolor{comment}{} SolidMesh*\& traction\_mesh\_pt() }
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{keywordflow}{return} Traction\_mesh\_pt;  }
\DoxyCodeLine{  \} }
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Doc the solution}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} doc\_solution();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Update function (empty)}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} actions\_after\_newton\_solve() \{\}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Update function (empty)}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} actions\_before\_newton\_solve() \{\}}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Actions after adaption: Kill and then re-\/build the traction }}
\DoxyCodeLine{\textcolor{comment}{ /// elements on boundary 1 and re-\/assign the equation numbers}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} actions\_after\_adapt();}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Doc displacement and velocity: label file with before and after}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} doc\_displ\_and\_veloc(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& stage=0);}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Dump problem-\/specific parameters values, then dump}}
\DoxyCodeLine{\textcolor{comment}{ /// generic problem data.}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} dump\_it(ofstream\& dump\_file);}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Read problem-\/specific parameter values, then recover}}
\DoxyCodeLine{\textcolor{comment}{ /// generic problem data.}}
\DoxyCodeLine{\textcolor{comment}{} \textcolor{keywordtype}{void} restart(ifstream\& restart\_file);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{private}:}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Output}}
\DoxyCodeLine{ DocInfo Doc\_info;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Trace file}}
\DoxyCodeLine{\textcolor{comment}{} ofstream Trace\_file;}
\DoxyCodeLine{ \textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Vector of pointers to nodes whose position we're tracing}}
\DoxyCodeLine{\textcolor{comment}{} Vector<Node*> Trace\_node\_pt;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Pointer to solid mesh}}
\DoxyCodeLine{\textcolor{comment}{} \mbox{\hyperlink{classElasticRefineableQuarterCircleSectorMesh}{ElasticRefineableQuarterCircleSectorMesh<ELEMENT>}}* Solid\_mesh\_pt;}
\DoxyCodeLine{\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{ /// Pointer to mesh of traction elements}}
\DoxyCodeLine{\textcolor{comment}{} SolidMesh* Traction\_mesh\_pt;}
\DoxyCodeLine{}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//====================================================================== }\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Constructor}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//====================================================================== }}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keyword}{class} TIMESTEPPER>}
\DoxyCodeLine{\mbox{\hyperlink{classDiskShockWaveProblem_ae670d0120936f410134ba3e3b61aa880}{DiskShockWaveProblem<ELEMENT,TIMESTEPPER>::DiskShockWaveProblem}}() }
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Allocate the timestepper}}
\DoxyCodeLine{ add\_time\_stepper\_pt(\textcolor{keyword}{new} TIMESTEPPER);}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Set coordinates and radius for the circle that defines }}
\DoxyCodeLine{ \textcolor{comment}{// the outer curvilinear boundary of the domain}}
\DoxyCodeLine{ \textcolor{keywordtype}{double} x\_c=0.0;}
\DoxyCodeLine{ \textcolor{keywordtype}{double} y\_c=0.0;}
\DoxyCodeLine{ \textcolor{keywordtype}{double} r=1.0;}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Build geometric object that specifies the fish back in the}}
\DoxyCodeLine{ \textcolor{comment}{// undeformed configuration (basically a deep copy of the previous one)}}
\DoxyCodeLine{ GeomObject* curved\_boundary\_pt=\textcolor{keyword}{new} Circle(x\_c,y\_c,r,time\_stepper\_pt());}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// The curved boundary of the mesh is defined by the geometric object}}
\DoxyCodeLine{ \textcolor{comment}{// What follows are the start and end coordinates on the geometric object:}}
\DoxyCodeLine{ \textcolor{keywordtype}{double} xi\_lo=0.0;}
\DoxyCodeLine{ \textcolor{keywordtype}{double} xi\_hi=2.0*atan(1.0);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Fraction along geometric object at which the radial dividing line}}
\DoxyCodeLine{ \textcolor{comment}{// is placed}}
\DoxyCodeLine{ \textcolor{keywordtype}{double} fract\_mid=0.5;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Now create the mesh}}
\DoxyCodeLine{ solid\_mesh\_pt() = \textcolor{keyword}{new} \mbox{\hyperlink{classElasticRefineableQuarterCircleSectorMesh}{ElasticRefineableQuarterCircleSectorMesh<ELEMENT>}}(}
\DoxyCodeLine{  curved\_boundary\_pt,xi\_lo,fract\_mid,xi\_hi,time\_stepper\_pt());}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set up trace nodes as the nodes on boundary 1 (=curved boundary) in }}
\DoxyCodeLine{ \textcolor{comment}{// the original mesh (they exist under any refinement!) }}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nnod0=solid\_mesh\_pt()-\/>nboundary\_node(0);}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nnod1=solid\_mesh\_pt()-\/>nboundary\_node(1);}
\DoxyCodeLine{ Trace\_node\_pt.resize(nnod0+nnod1);}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<nnod0;j++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   Trace\_node\_pt[j]=solid\_mesh\_pt()-\/>boundary\_node\_pt(0,j);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<nnod1;j++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   Trace\_node\_pt[j+nnod0]=solid\_mesh\_pt()-\/>boundary\_node\_pt(1,j);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Build traction element mesh}}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>make\_traction\_element\_mesh(traction\_mesh\_pt());}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Solid mesh is first sub-\/mesh}}
\DoxyCodeLine{ add\_sub\_mesh(solid\_mesh\_pt());}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Traction mesh is first sub-\/mesh}}
\DoxyCodeLine{ add\_sub\_mesh(traction\_mesh\_pt());}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Build combined "{}global"{} mesh}}
\DoxyCodeLine{ build\_global\_mesh();}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Create/set error estimator}}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>spatial\_error\_estimator\_pt()=\textcolor{keyword}{new} Z2ErrorEstimator;}
\DoxyCodeLine{  }
\DoxyCodeLine{ \textcolor{comment}{// Fiddle with adaptivity targets and doc}}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>max\_permitted\_error()=0.006; \textcolor{comment}{//0.03;}}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>min\_permitted\_error()=0.0006;\textcolor{comment}{// 0.0006; //0.003;}}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>doc\_adaptivity\_targets(cout);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Pin the bottom in the vertical direction}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} n\_bottom = solid\_mesh\_pt()-\/>nboundary\_node(0);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Loop over the node}}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_bottom;i++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   solid\_mesh\_pt()-\/>boundary\_node\_pt(0,i)-\/>pin\_position(1);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Pin the left edge in the horizontal direction}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} n\_side = solid\_mesh\_pt()-\/>nboundary\_node(2);}
\DoxyCodeLine{ \textcolor{comment}{//Loop over the node}}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_side;i++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   solid\_mesh\_pt()-\/>boundary\_node\_pt(2,i)-\/>pin\_position(0);}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Find number of elements in solid mesh}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} n\_element =solid\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{  }
\DoxyCodeLine{ \textcolor{comment}{//Set parameters and function pointers for solid elements}}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_element;i++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{comment}{//Cast to a solid element}}
\DoxyCodeLine{   ELEMENT *el\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(mesh\_pt()-\/>element\_pt(i));}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{//Set the constitutive law}}
\DoxyCodeLine{   el\_pt-\/>constitutive\_law\_pt() =}
\DoxyCodeLine{    \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a2a37fb040c832ee7a086bb13bb02a100}{Global\_Physical\_Variables::Constitutive\_law\_pt}};}
\DoxyCodeLine{   }
\DoxyCodeLine{   \textcolor{comment}{// Switch on inertia}}
\DoxyCodeLine{   el\_pt-\/>enable\_inertia();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Pin the redundant solid pressures}}
\DoxyCodeLine{ PVDEquationsBase<2>::pin\_redundant\_nodal\_solid\_pressures(}
\DoxyCodeLine{  solid\_mesh\_pt()-\/>element\_pt());}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Find number of elements in traction mesh}}
\DoxyCodeLine{ n\_element=traction\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{  }
\DoxyCodeLine{ \textcolor{comment}{//Set function pointers for traction elements}}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_element;i++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{comment}{//Cast to a solid traction element}}
\DoxyCodeLine{   SolidTractionElement<ELEMENT> *el\_pt = }
\DoxyCodeLine{    \textcolor{keyword}{dynamic\_cast<}SolidTractionElement<ELEMENT>*\textcolor{keyword}{>}}
\DoxyCodeLine{    (traction\_mesh\_pt()-\/>element\_pt(i));}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{//Set the traction function}}
\DoxyCodeLine{   el\_pt-\/>traction\_fct\_pt() = \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a19f4e20a92e7d216b4d2b00308f96917}{Global\_Physical\_Variables::constant\_pressure}};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Attach the boundary conditions to the mesh}}
\DoxyCodeLine{ cout << assign\_eqn\_numbers() << std::endl; }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Refine uniformly}}
\DoxyCodeLine{ refine\_uniformly();}
\DoxyCodeLine{ refine\_uniformly();}
\DoxyCodeLine{ refine\_uniformly();}
\DoxyCodeLine{ }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Now the non-\/pinned positions of the SolidNodes will have been}}
\DoxyCodeLine{ \textcolor{comment}{// determined by interpolation. This is appropriate for uniform}}
\DoxyCodeLine{ \textcolor{comment}{// refinements once the code is up and running since we can't place}}
\DoxyCodeLine{ \textcolor{comment}{// new SolidNodes at the positions determined by the MacroElement.}}
\DoxyCodeLine{ \textcolor{comment}{// However, here we want to update the nodes to fit the exact}}
\DoxyCodeLine{ \textcolor{comment}{// intitial configuration.}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Update all solid nodes based on the Mesh's Domain/MacroElement}}
\DoxyCodeLine{ \textcolor{comment}{// representation}}
\DoxyCodeLine{ \textcolor{keywordtype}{bool} update\_all\_solid\_nodes=\textcolor{keyword}{true};}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>node\_update(update\_all\_solid\_nodes);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Now set the Eulerian equal to the Lagrangian coordinates}}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>set\_lagrangian\_nodal\_coordinates();}
\DoxyCodeLine{ }
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Kill and then re-\/build the traction elements on boundary 1,}}
\DoxyCodeLine{\textcolor{comment}{/// pin redundant pressure dofs and re-\/assign the equation numbers.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keyword}{class} TIMESTEPPER>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{classDiskShockWaveProblem_ac2a22a8399355e461d1a9ad1e5425c9a}{DiskShockWaveProblem<ELEMENT,TIMESTEPPER>::actions\_after\_adapt}}()}
\DoxyCodeLine{\{ }
\DoxyCodeLine{ \textcolor{comment}{// Wipe and re-\/build traction element mesh}}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>remake\_traction\_element\_mesh(traction\_mesh\_pt());}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Re-\/build combined "{}global"{} mesh}}
\DoxyCodeLine{ rebuild\_global\_mesh();}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Find number of elements in traction mesh}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} n\_element=traction\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{  }
\DoxyCodeLine{ \textcolor{comment}{//Loop over the elements in the traction element mesh}}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=0;i<n\_element;i++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   \textcolor{comment}{//Cast to a solid traction element}}
\DoxyCodeLine{   SolidTractionElement<ELEMENT> *el\_pt = }
\DoxyCodeLine{    \textcolor{keyword}{dynamic\_cast<}SolidTractionElement<ELEMENT>*\textcolor{keyword}{>}}
\DoxyCodeLine{    (traction\_mesh\_pt()-\/>element\_pt(i));}
\DoxyCodeLine{}
\DoxyCodeLine{   \textcolor{comment}{//Set the traction function}}
\DoxyCodeLine{   el\_pt-\/>traction\_fct\_pt() = \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a19f4e20a92e7d216b4d2b00308f96917}{Global\_Physical\_Variables::constant\_pressure}};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Pin the redundant solid pressures}}
\DoxyCodeLine{ PVDEquationsBase<2>::pin\_redundant\_nodal\_solid\_pressures(}
\DoxyCodeLine{  solid\_mesh\_pt()-\/>element\_pt());}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Do equation numbering}}
\DoxyCodeLine{ cout << assign\_eqn\_numbers() << std::endl; }
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Doc the solution}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keyword}{class} TIMESTEPPER>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{classDiskShockWaveProblem_a7685309caac199d18f3f81468d9fcb23}{DiskShockWaveProblem<ELEMENT,TIMESTEPPER>::doc\_solution}}()}
\DoxyCodeLine{\{}
\DoxyCodeLine{ \textcolor{comment}{// Number of plot points}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} npts;}
\DoxyCodeLine{ npts=5; }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Output shape of deformed body}}
\DoxyCodeLine{ ofstream some\_file;}
\DoxyCodeLine{ \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{ sprintf(filename,\textcolor{stringliteral}{"{}\%s/soln\%i.dat"{}},Doc\_info.directory().c\_str(),}
\DoxyCodeLine{         Doc\_info.number());}
\DoxyCodeLine{ some\_file.open(filename);}
\DoxyCodeLine{ solid\_mesh\_pt()-\/>output(some\_file,npts);}
\DoxyCodeLine{ some\_file.close();}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Output traction}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nel=traction\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{ sprintf(filename,\textcolor{stringliteral}{"{}\%s/traction\%i.dat"{}},Doc\_info.directory().c\_str(),}
\DoxyCodeLine{         Doc\_info.number());}
\DoxyCodeLine{ some\_file.open(filename);}
\DoxyCodeLine{ Vector<double> unit\_normal(2);}
\DoxyCodeLine{ Vector<double> traction(2);}
\DoxyCodeLine{ Vector<double> x\_dummy(2);}
\DoxyCodeLine{ Vector<double> s\_dummy(1);}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e=0;e<nel;e++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   some\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<npts;i++)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     s\_dummy[0]=-\/1.0+2.0*double(i)/double(npts-\/1);}
\DoxyCodeLine{     SolidTractionElement<ELEMENT>* el\_pt=}
\DoxyCodeLine{      \textcolor{keyword}{dynamic\_cast<}SolidTractionElement<ELEMENT>*\textcolor{keyword}{>}(}
\DoxyCodeLine{       traction\_mesh\_pt()-\/>finite\_element\_pt(e));}
\DoxyCodeLine{     el\_pt-\/>outer\_unit\_normal(s\_dummy,unit\_normal);}
\DoxyCodeLine{     el\_pt-\/>traction(s\_dummy,traction);}
\DoxyCodeLine{     el\_pt-\/>interpolated\_x(s\_dummy,x\_dummy);}
\DoxyCodeLine{     some\_file << x\_dummy[0] << \textcolor{stringliteral}{"{} "{}} << x\_dummy[1] << \textcolor{stringliteral}{"{} "{}} }
\DoxyCodeLine{               << traction[0] << \textcolor{stringliteral}{"{} "{}} << traction[1] << \textcolor{stringliteral}{"{} "{}}  }
\DoxyCodeLine{               << std::endl;}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ some\_file.close(); }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Doc displacement and velocity}}
\DoxyCodeLine{ doc\_displ\_and\_veloc();}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Get displacement as a function of the radial coordinate}}
\DoxyCodeLine{ \textcolor{comment}{// along boundary 0}}
\DoxyCodeLine{ \{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Number of elements along boundary 0:}}
\DoxyCodeLine{  \textcolor{keywordtype}{unsigned} nelem=solid\_mesh\_pt()-\/>nboundary\_element(0);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Open files}}
\DoxyCodeLine{  sprintf(filename,\textcolor{stringliteral}{"{}\%s/displ\%i.dat"{}},Doc\_info.directory().c\_str(),}
\DoxyCodeLine{          Doc\_info.number());}
\DoxyCodeLine{  some\_file.open(filename);}
\DoxyCodeLine{  }
\DoxyCodeLine{  Vector<double> s(2);}
\DoxyCodeLine{  Vector<double> x(2);}
\DoxyCodeLine{  Vector<double> dxdt(2);}
\DoxyCodeLine{  Vector<double> xi(2);}
\DoxyCodeLine{  Vector<double> r\_exact(2);}
\DoxyCodeLine{  Vector<double> v\_exact(2);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e=0;e<nelem;e++)}
\DoxyCodeLine{   \{}
\DoxyCodeLine{    some\_file << \textcolor{stringliteral}{"{}ZONE "{}} << std::endl;}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<npts;i++)}
\DoxyCodeLine{     \{}
\DoxyCodeLine{      \textcolor{comment}{// Move along bottom edge of element}}
\DoxyCodeLine{      s[0]=-\/1.0+2.0*double(i)/double(npts-\/1);}
\DoxyCodeLine{      s[1]=-\/1.0;}
\DoxyCodeLine{}
\DoxyCodeLine{      \textcolor{comment}{// Get pointer to element}}
\DoxyCodeLine{      SolidFiniteElement* el\_pt=\textcolor{keyword}{dynamic\_cast<}SolidFiniteElement*\textcolor{keyword}{>}}
\DoxyCodeLine{       (solid\_mesh\_pt()-\/>boundary\_element\_pt(0,e));}
\DoxyCodeLine{      }
\DoxyCodeLine{      \textcolor{comment}{// Get Lagrangian coordinate}}
\DoxyCodeLine{      el\_pt-\/>interpolated\_xi(s,xi);}
\DoxyCodeLine{}
\DoxyCodeLine{      \textcolor{comment}{// Get Eulerian coordinate}}
\DoxyCodeLine{      el\_pt-\/>interpolated\_x(s,x);}
\DoxyCodeLine{}
\DoxyCodeLine{      \textcolor{comment}{// Get velocity }}
\DoxyCodeLine{      el\_pt-\/>interpolated\_dxdt(s,1,dxdt);}
\DoxyCodeLine{  }
\DoxyCodeLine{      \textcolor{comment}{// Plot radial distance and displacement}}
\DoxyCodeLine{      some\_file << xi[0] << \textcolor{stringliteral}{"{} "{}} << x[0]-\/xi[0] << \textcolor{stringliteral}{"{} "{}} }
\DoxyCodeLine{                << dxdt[0] << std::endl;}
\DoxyCodeLine{     \}}
\DoxyCodeLine{   \}}
\DoxyCodeLine{  some\_file.close(); }
\DoxyCodeLine{ \}}
\DoxyCodeLine{}
\DoxyCodeLine{  }
\DoxyCodeLine{ \textcolor{comment}{// Write trace file}}
\DoxyCodeLine{ Trace\_file << time\_pt()-\/>time()  << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} ntrace\_node=Trace\_node\_pt.size();}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<ntrace\_node;j++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   Trace\_file << sqrt(pow(Trace\_node\_pt[j]-\/>x(0),2)+}
\DoxyCodeLine{                      pow(Trace\_node\_pt[j]-\/>x(1),2)) << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ Trace\_file << std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// removed until Jacobi eigensolver is re-\/instated}}
\DoxyCodeLine{ \textcolor{comment}{// // Output principal stress vectors at the centre of all elements}}
\DoxyCodeLine{ \textcolor{comment}{// SolidHelpers::doc\_2D\_principal\_stress<ELEMENT>(Doc\_info,solid\_mesh\_pt());}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//  // Write restart file}}
\DoxyCodeLine{\textcolor{comment}{//  sprintf(filename,"{}\%s/restart\%i.dat"{},Doc\_info.directory().c\_str(),}}
\DoxyCodeLine{\textcolor{comment}{//          Doc\_info.number());}}
\DoxyCodeLine{\textcolor{comment}{//  some\_file.open(filename);}}
\DoxyCodeLine{\textcolor{comment}{//  dump\_it(some\_file);}}
\DoxyCodeLine{\textcolor{comment}{//  some\_file.close();}}
\DoxyCodeLine{ }
\DoxyCodeLine{}
\DoxyCodeLine{ cout << \textcolor{stringliteral}{"{}Doced solution for step "{}} }
\DoxyCodeLine{      << Doc\_info.number() }
\DoxyCodeLine{      << std::endl << std::endl << std::endl;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Doc displacement and veloc in displ\_and\_veloc*.dat.}}
\DoxyCodeLine{\textcolor{comment}{/// The int stage defaults to 0, in which case the '*' in the}}
\DoxyCodeLine{\textcolor{comment}{/// filename is simply the step number specified by the Problem's}}
\DoxyCodeLine{\textcolor{comment}{/// DocInfo object. If it's +/-\/1, the word "{}before"{} and "{}after"{}}}
\DoxyCodeLine{\textcolor{comment}{/// get inserted. This allows checking of the veloc/displacment}}
\DoxyCodeLine{\textcolor{comment}{/// interpolation during adaptive mesh refinement.}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keyword}{class} TIMESTEPPER>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{classDiskShockWaveProblem_a75403423b0a031adabb5b487fa88373f}{DiskShockWaveProblem<ELEMENT,TIMESTEPPER>::doc\_displ\_and\_veloc}}(}
\DoxyCodeLine{ \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& stage)}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{ ofstream some\_file;}
\DoxyCodeLine{ \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Number of plot points}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} npts;}
\DoxyCodeLine{ npts=5; }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Open file}}
\DoxyCodeLine{ \textcolor{keywordflow}{if} (stage==-\/1)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   sprintf(filename,\textcolor{stringliteral}{"{}\%s/displ\_and\_veloc\_before\%i.dat"{}},}
\DoxyCodeLine{           Doc\_info.directory().c\_str(),Doc\_info.number());}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (stage==1)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   sprintf(filename,\textcolor{stringliteral}{"{}\%s/displ\_and\_veloc\_after\%i.dat"{}},}
\DoxyCodeLine{           Doc\_info.directory().c\_str(),Doc\_info.number());}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{keywordflow}{else} }
\DoxyCodeLine{  \{}
\DoxyCodeLine{   sprintf(filename,\textcolor{stringliteral}{"{}\%s/displ\_and\_veloc\%i.dat"{}},}
\DoxyCodeLine{           Doc\_info.directory().c\_str(),Doc\_info.number());}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ some\_file.open(filename);}
\DoxyCodeLine{}
\DoxyCodeLine{ Vector<double> s(2),x(2),dxdt(2),xi(2),displ(2);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Loop over solid elements}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nel=solid\_mesh\_pt()-\/>nelement();}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e=0;e<nel;e++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   some\_file << \textcolor{stringliteral}{"{}ZONE I="{}} << npts << \textcolor{stringliteral}{"{}, J="{}} << npts << std::endl;}
\DoxyCodeLine{   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i=0;i<npts;i++)}
\DoxyCodeLine{    \{}
\DoxyCodeLine{     s[0]=-\/1.0+2.0*double(i)/double(npts-\/1);}
\DoxyCodeLine{     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<npts;j++)}
\DoxyCodeLine{      \{}
\DoxyCodeLine{       s[1]=-\/1.0+2.0*double(j)/double(npts-\/1);}
\DoxyCodeLine{}
\DoxyCodeLine{       \textcolor{comment}{// Cast to full element type}}
\DoxyCodeLine{       ELEMENT* el\_pt=\textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(solid\_mesh\_pt()-\/>}
\DoxyCodeLine{                                             finite\_element\_pt(e));}
\DoxyCodeLine{}
\DoxyCodeLine{       \textcolor{comment}{// Eulerian coordinate}}
\DoxyCodeLine{       el\_pt-\/>interpolated\_x(s,x);}
\DoxyCodeLine{}
\DoxyCodeLine{       \textcolor{comment}{// Lagrangian coordinate}}
\DoxyCodeLine{       el\_pt-\/>interpolated\_xi(s,xi);}
\DoxyCodeLine{}
\DoxyCodeLine{       \textcolor{comment}{// Displacement}}
\DoxyCodeLine{       displ[0]=x[0]-\/xi[0];}
\DoxyCodeLine{       displ[1]=x[1]-\/xi[1];}
\DoxyCodeLine{}
\DoxyCodeLine{       \textcolor{comment}{// Velocity (1st deriv)}}
\DoxyCodeLine{       el\_pt-\/>interpolated\_dxdt(s,1,dxdt);}
\DoxyCodeLine{}
\DoxyCodeLine{       some\_file << x[0] << \textcolor{stringliteral}{"{} "{}} << x[1] << \textcolor{stringliteral}{"{} "{}} }
\DoxyCodeLine{                 << displ[0] << \textcolor{stringliteral}{"{} "{}} << displ[1] << \textcolor{stringliteral}{"{} "{}}  }
\DoxyCodeLine{                 << dxdt[0] << \textcolor{stringliteral}{"{} "{}} << dxdt[1] << \textcolor{stringliteral}{"{} "{}}  }
\DoxyCodeLine{                 << std::endl;}
\DoxyCodeLine{      \}}
\DoxyCodeLine{    \}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ some\_file.close(); }
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Dump the solution}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keyword}{class} TIMESTEPPER>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{classDiskShockWaveProblem_a2eaf91d3e0eb5f37b9920fc3d9d54cb9}{DiskShockWaveProblem<ELEMENT,TIMESTEPPER>::dump\_it}}(ofstream\& dump\_file)}
\DoxyCodeLine{\{}
\DoxyCodeLine{ \textcolor{comment}{// Call generic dump()}}
\DoxyCodeLine{ Problem::dump(dump\_file);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Read solution from disk}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keyword}{class} TIMESTEPPER>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{classDiskShockWaveProblem_ae883625e9bbe6ea442413f7c970d3fb1}{DiskShockWaveProblem<ELEMENT,TIMESTEPPER>::restart}}(ifstream\& restart\_file)}
\DoxyCodeLine{\{}
\DoxyCodeLine{ \textcolor{comment}{// Read generic problem data}}
\DoxyCodeLine{ Problem::read(restart\_file);}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//==================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Run the problem; specify case\_number to label output directory}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//==================================================================}}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT, \textcolor{keyword}{class} TIMESTEPPER>}
\DoxyCodeLine{\textcolor{keywordtype}{void} \mbox{\hyperlink{classDiskShockWaveProblem_af8dc3befd3eba59b008c315bfe077340}{DiskShockWaveProblem<ELEMENT,TIMESTEPPER>::run}}(}
\DoxyCodeLine{ \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& case\_number)}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// If there's a command line argument, run the validation (i.e. do only }}
\DoxyCodeLine{ \textcolor{comment}{// 3 timesteps; otherwise do a few cycles}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nstep=400;}
\DoxyCodeLine{ \textcolor{keywordflow}{if} (CommandLineArgs::Argc!=1)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   nstep=3;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Define output directory}}
\DoxyCodeLine{ \textcolor{keywordtype}{char} dirname[100];}
\DoxyCodeLine{ sprintf(dirname,\textcolor{stringliteral}{"{}RESLT\%i"{}},case\_number);}
\DoxyCodeLine{ Doc\_info.set\_directory(dirname);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Step number}}
\DoxyCodeLine{ Doc\_info.number()=0;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Open trace file}}
\DoxyCodeLine{ \textcolor{keywordtype}{char} filename[100];   }
\DoxyCodeLine{ sprintf(filename,\textcolor{stringliteral}{"{}\%s/trace.dat"{}},Doc\_info.directory().c\_str());}
\DoxyCodeLine{ Trace\_file.open(filename);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set up trace nodes as the nodes on boundary 1 (=curved boundary) in }}
\DoxyCodeLine{ \textcolor{comment}{// the original mesh (they exist under any refinement!) }}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nnod0=solid\_mesh\_pt()-\/>nboundary\_node(0);}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} nnod1=solid\_mesh\_pt()-\/>nboundary\_node(1);}
\DoxyCodeLine{ Trace\_file << \textcolor{stringliteral}{"{}VARIABLES=\(\backslash\)"{}time\(\backslash\)"{}"{}};}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<nnod0;j++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   Trace\_file << \textcolor{stringliteral}{"{}, \(\backslash\)"{}radial node "{}} << j << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j=0;j<nnod1;j++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   Trace\_file << \textcolor{stringliteral}{"{}, \(\backslash\)"{}azimuthal node "{}} << j << \textcolor{stringliteral}{"{}\(\backslash\)"{} "{}};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{ Trace\_file << std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//  // Restart?}}
\DoxyCodeLine{\textcolor{comment}{//  //-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//  // Pointer to restart file}}
\DoxyCodeLine{\textcolor{comment}{//  ifstream* restart\_file\_pt=0;}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//  // No restart}}
\DoxyCodeLine{\textcolor{comment}{//  //-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\textcolor{comment}{//  if (CommandLineArgs::Argc==1)}}
\DoxyCodeLine{\textcolor{comment}{//   \{}}
\DoxyCodeLine{\textcolor{comment}{//    cout << "{}No restart"{} << std::endl;}}
\DoxyCodeLine{\textcolor{comment}{//   \}}}
\DoxyCodeLine{\textcolor{comment}{//  // Restart}}
\DoxyCodeLine{\textcolor{comment}{//  //-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\textcolor{comment}{//  else if (CommandLineArgs::Argc==2)}}
\DoxyCodeLine{\textcolor{comment}{//   \{}}
\DoxyCodeLine{\textcolor{comment}{//    // Open restart file}}
\DoxyCodeLine{\textcolor{comment}{//    restart\_file\_pt=new ifstream(CommandLineArgs::Argv[1],ios\_base::in);}}
\DoxyCodeLine{\textcolor{comment}{//    if (restart\_file\_pt!=0)}}
\DoxyCodeLine{\textcolor{comment}{//     \{}}
\DoxyCodeLine{\textcolor{comment}{//      cout << "{}Have opened "{} << CommandLineArgs::Argv[1] << }}
\DoxyCodeLine{\textcolor{comment}{//       "{} for restart. "{} << std::endl;}}
\DoxyCodeLine{\textcolor{comment}{//     \}}}
\DoxyCodeLine{\textcolor{comment}{//    else}}
\DoxyCodeLine{\textcolor{comment}{//     \{}}
\DoxyCodeLine{\textcolor{comment}{//      cout << "{}ERROR while trying to open "{} << CommandLineArgs::Argv[1] << }}
\DoxyCodeLine{\textcolor{comment}{//       "{} for restart."{} << std::endl;}}
\DoxyCodeLine{\textcolor{comment}{//     \}}}
\DoxyCodeLine{\textcolor{comment}{//    // Do the actual restart}}
\DoxyCodeLine{\textcolor{comment}{//    pause("{}need to do the actual restart"{});}}
\DoxyCodeLine{\textcolor{comment}{//    //problem.restart(*restart\_file\_pt);}}
\DoxyCodeLine{\textcolor{comment}{//   \}}}
\DoxyCodeLine{\textcolor{comment}{//  // More than one restart file specified?}}
\DoxyCodeLine{\textcolor{comment}{//  else }}
\DoxyCodeLine{\textcolor{comment}{//   \{}}
\DoxyCodeLine{\textcolor{comment}{//    cout << "{}Can only specify one input file "{} << std::endl;}}
\DoxyCodeLine{\textcolor{comment}{//    cout << "{}You specified the following command line arguments: "{} << std::endl;}}
\DoxyCodeLine{\textcolor{comment}{//    CommandLineArgs::output();}}
\DoxyCodeLine{\textcolor{comment}{//    //assert(false);}}
\DoxyCodeLine{\textcolor{comment}{//   \}}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Initial parameter values}}
\DoxyCodeLine{ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a23c2ade6398f54040b869f7f3a2bcc4b}{Global\_Physical\_Variables::P}} = 0.1; }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Initialise time}}
\DoxyCodeLine{ \textcolor{keywordtype}{double} time0=0.0;}
\DoxyCodeLine{ time\_pt()-\/>time()=time0;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Set initial timestep}}
\DoxyCodeLine{ \textcolor{keywordtype}{double} dt=0.01; }
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Impulsive start}}
\DoxyCodeLine{ assign\_initial\_values\_impulsive(dt); }
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Doc initial state}}
\DoxyCodeLine{ doc\_solution();}
\DoxyCodeLine{ Doc\_info.number()++;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// First step without adaptivity}}
\DoxyCodeLine{ unsteady\_newton\_solve(dt); }
\DoxyCodeLine{ doc\_solution();}
\DoxyCodeLine{ Doc\_info.number()++;}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Timestepping loop for subsequent steps with adaptivity}}
\DoxyCodeLine{ \textcolor{keywordtype}{unsigned} max\_adapt=1;}
\DoxyCodeLine{ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} i=1;i<nstep;i++)}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   unsteady\_newton\_solve(dt,max\_adapt,\textcolor{keyword}{false});}
\DoxyCodeLine{   doc\_solution();}
\DoxyCodeLine{   Doc\_info.number()++;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\textcolor{comment}{/// Driver for simple elastic problem}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\textcolor{keywordtype}{int} \mbox{\hyperlink{shock__disk_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main}}(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char}* argv[])}
\DoxyCodeLine{\{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Store command line arguments}}
\DoxyCodeLine{ CommandLineArgs::setup(argc,argv);}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{//Initialise physical parameters}}
\DoxyCodeLine{ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a09a019474b7405b35da2437f7779bc7e}{Global\_Physical\_Variables::E}} = 1.0; \textcolor{comment}{// ADJUST }}
\DoxyCodeLine{ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a3962c36313826b19f216f6bbbdd6a477}{Global\_Physical\_Variables::Nu}} = 0.3; \textcolor{comment}{// ADJUST}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// "{}Big G"{} Linear constitutive equations:}}
\DoxyCodeLine{  \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a2a37fb040c832ee7a086bb13bb02a100}{Global\_Physical\_Variables::Constitutive\_law\_pt}} = }
\DoxyCodeLine{   \textcolor{keyword}{new} GeneralisedHookean(\&\mbox{\hyperlink{namespaceGlobal__Physical__Variables_a3962c36313826b19f216f6bbbdd6a477}{Global\_Physical\_Variables::Nu}},}
\DoxyCodeLine{                          \&\mbox{\hyperlink{namespaceGlobal__Physical__Variables_a09a019474b7405b35da2437f7779bc7e}{Global\_Physical\_Variables::E}});}
\DoxyCodeLine{ }
\DoxyCodeLine{  \textcolor{comment}{//Set up the problem:}}
\DoxyCodeLine{  \textcolor{keywordtype}{unsigned} case\_number=0;}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{ \textcolor{comment}{// Pure displacement formulation}}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   cout << \textcolor{stringliteral}{"{}Running case "{}} << case\_number }
\DoxyCodeLine{        << \textcolor{stringliteral}{"{}: Pure displacement formulation"{}} << std::endl;}
\DoxyCodeLine{   \mbox{\hyperlink{classDiskShockWaveProblem}{DiskShockWaveProblem<RefineableQPVDElement<2,3>}}, Newmark<1> > problem;}
\DoxyCodeLine{   problem.\mbox{\hyperlink{classDiskShockWaveProblem_af8dc3befd3eba59b008c315bfe077340}{run}}(case\_number);}
\DoxyCodeLine{   case\_number++;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{   }
\DoxyCodeLine{ \textcolor{comment}{// Pressure-\/displacement with Crouzeix Raviart-\/type pressure}}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   cout << \textcolor{stringliteral}{"{}Running case "{}} << case\_number }
\DoxyCodeLine{        << \textcolor{stringliteral}{"{}: Pressure/displacement with Crouzeix-\/Raviart pressure"{}} << std::endl;}
\DoxyCodeLine{   \mbox{\hyperlink{classDiskShockWaveProblem}{DiskShockWaveProblem<RefineableQPVDElementWithPressure<2>}}, Newmark<1> >}
\DoxyCodeLine{    problem;}
\DoxyCodeLine{   problem.\mbox{\hyperlink{classDiskShockWaveProblem_af8dc3befd3eba59b008c315bfe077340}{run}}(case\_number);}
\DoxyCodeLine{   case\_number++;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Pressure-\/displacement with Taylor-\/Hood-\/type pressure}}
\DoxyCodeLine{  \{}
\DoxyCodeLine{   cout << \textcolor{stringliteral}{"{}Running case "{}} << case\_number }
\DoxyCodeLine{        << \textcolor{stringliteral}{"{}: Pressure/displacement with Taylor-\/Hood pressure"{}} << std::endl;}
\DoxyCodeLine{   \mbox{\hyperlink{classDiskShockWaveProblem}{DiskShockWaveProblem<RefineableQPVDElementWithContinuousPressure<2>}}, }
\DoxyCodeLine{    Newmark<1> > problem;}
\DoxyCodeLine{   problem.\mbox{\hyperlink{classDiskShockWaveProblem_af8dc3befd3eba59b008c315bfe077340}{run}}(case\_number);}
\DoxyCodeLine{   case\_number++;}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{ }
\DoxyCodeLine{ \textcolor{comment}{// Clean up }}
\DoxyCodeLine{ \textcolor{keyword}{delete} \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a2a37fb040c832ee7a086bb13bb02a100}{Global\_Physical\_Variables::Constitutive\_law\_pt}};}
\DoxyCodeLine{ \mbox{\hyperlink{namespaceGlobal__Physical__Variables_a2a37fb040c832ee7a086bb13bb02a100}{Global\_Physical\_Variables::Constitutive\_law\_pt}}=0;}
\DoxyCodeLine{}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{}

\end{DoxyCodeInclude}


\DoxyHorRuler{0}
 \DoxyHorRuler{0}
 \hypertarget{index_pdf}{}\doxysection{PDF file}\label{index_pdf}
A \href{../latex/refman.pdf}{\texttt{ pdf version}} of this document is available. \end{document}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: airy_cantilever2.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_5cf61d7090cf0a648240fff12926b59f.html">solid</a></li><li class="navelem"><a class="el" href="dir_76e1189eab1269e084f22e5995ef374b.html">airy_cantilever</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">airy_cantilever2.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="airy__cantilever2_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//Driver for Airy cantilever beam problem</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//Oomph-lib includes</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;solid.h&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;constitutive.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//The mesh</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;meshes/rectangular_quadmesh.h&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceoomph.html">oomph</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//#define REFINE</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//=================start_wrapper==================================</span><span class="comment"></span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/// Wrapper class for solid elements to modify their output </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/// functions.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> ELEMENT</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> /// Constructor: Call constructor of underlying element</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classoomph_1_1MySolidElement.html#afe8a392ac0bed5890f64b75adea8f5af">   56</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1MySolidElement.html#afe8a392ac0bed5890f64b75adea8f5af">MySolidElement</a>() : ELEMENT() {};</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> /// Overload output function:</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="classoomph_1_1MySolidElement.html#abf5b903419201b1fd6f1587749337650">   59</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1MySolidElement.html#abf5b903419201b1fd6f1587749337650">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="comment">// Element dimension</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordtype">unsigned</span> el_dim = this-&gt;dim();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   Vector&lt;double&gt; s(el_dim);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   Vector&lt;double&gt; x(el_dim);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   DenseMatrix&lt;double&gt; sigma(el_dim,el_dim);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="keywordflow">switch</span>(el_dim)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;     </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;     <span class="comment">//Tecplot header info </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;     outfile &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; n_plot &lt;&lt; <span class="stringliteral">&quot;, J=&quot;</span> &lt;&lt; n_plot &lt;&lt; std::endl;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;     </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;     <span class="comment">//Loop over element nodes</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_plot;l2++)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;       s[1] = -1.0 + l2*2.0/(n_plot-1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l1=0;l1&lt;n_plot;l1++)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;         s[0] = -1.0 + l1*2.0/(n_plot-1);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;         <span class="comment">// Get Eulerian coordinates and stress</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         this-&gt;interpolated_x(s,x);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;         this-&gt;get_stress(s,sigma);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;         <span class="comment">//Output the x,y,..</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++) </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          {outfile &lt;&lt; x[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;         <span class="comment">// Output stress</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         outfile &lt;&lt; sigma(0,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                 &lt;&lt; sigma(1,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                 &lt;&lt; sigma(1,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;     </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;     std::ostringstream error_message;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;     error_message &lt;&lt; <span class="stringliteral">&quot;Output for dim !=2 not implemented&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;     <span class="keywordflow">throw</span> OomphLibError(error_message.str(),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                         OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                         OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;};</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">//===========start_face_geometry==============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">/// FaceGeometry of wrapped element is the same as the underlying element</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span><span class="comment">//============================================================================</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">class </span>FaceGeometry&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;ELEMENT&gt; &gt; :</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; <span class="keyword">public</span> <span class="keyword">virtual</span> FaceGeometry&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> /// \short Constructor [this was only required explicitly</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> /// from gcc 4.5.2 onwards...]</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classoomph_1_1FaceGeometry_3_01MySolidElement_3_01ELEMENT_01_4_01_4.html#a4b9e14efef623686f22fb2d3747e16c3">  130</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1FaceGeometry_3_01MySolidElement_3_01ELEMENT_01_4_01_4.html#a4b9e14efef623686f22fb2d3747e16c3">FaceGeometry</a>() : FaceGeometry&lt;ELEMENT&gt;() {}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;};</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">//=======start_namespace==========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">/// Global variables</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> /// Pointer to strain energy function</span></div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">  155</a></span>&#160;<span class="comment"></span> StrainEnergyFunction*<a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Strain_energy_function_pt</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> /// &quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">  158</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">C1</a>=1.3;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> /// &quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law</span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">  161</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">C2</a>=1.3;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> /// Half height of beam</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">H</a>=0.5;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> /// Length of beam</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">L</a>=10.0;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> /// Pointer to constitutive law</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"></span> ConstitutiveLaw* <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> /// Elastic modulus</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a09a019474b7405b35da2437f7779bc7e">E</a>=1.0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> /// Poisson&#39;s ratio</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Nu</a>=0.3;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> /// Uniform pressure</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">P</a> = 0.0;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> /// \short Constant pressure load. The arguments to this function are imposed</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> /// on us by the SolidTractionElements which allow the traction to </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> /// depend on the Lagrangian and Eulerian coordinates x and xi, and on the </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> /// outer unit normal to the surface. Here we only need the outer unit</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> /// normal.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a19f4e20a92e7d216b4d2b00308f96917">constant_pressure</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;xi, <span class="keyword">const</span> Vector&lt;double&gt; &amp;x,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        <span class="keyword">const</span> Vector&lt;double&gt; &amp;n, Vector&lt;double&gt; &amp;traction)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordtype">unsigned</span> dim = traction.size();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;dim;i++)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    traction[i] = -<a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">P</a>*n[i];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; } <span class="comment">// end traction</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> /// Non-dim gravity</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Gravity</a>=0.0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> /// Non-dimensional gravity as body force</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="airy__cantilever_8txt.html#afe1df791b65813080b641a6e5cd8d3f2">gravity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time, </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;              <span class="keyword">const</span> Vector&lt;double&gt; &amp;xi, </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;              Vector&lt;double&gt; &amp;b)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  b[0]=0.0;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  b[1]=-<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Gravity</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;} <span class="comment">//end namespace</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">//=============begin_problem============================================ </span><span class="comment"></span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">/// Problem class for the cantilever &quot;beam&quot; structure.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword">class </span><a class="code" href="classCantileverProblem.html">CantileverProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;{</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> /// Constructor:</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"></span> <a class="code" href="classCantileverProblem.html">CantileverProblem</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; incompress, <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; use_fd);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> /// Update function (empty)</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">  226</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">actions_after_newton_solve</a>() {}</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"> /// Update function (empty)</span></div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">  229</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">actions_before_newton_solve</a>() {}</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> /// Access function for the solid mesh</span></div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="classCantileverProblem.html#a26843782873897ee5e45647d17204b86">  234</a></span>&#160;<span class="comment"></span> ElasticRefineableRectangularQuadMesh&lt;ELEMENT&gt;*&amp; <a class="code" href="classCantileverProblem.html#a26843782873897ee5e45647d17204b86">solid_mesh_pt</a>() </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  {<span class="keywordflow">return</span> Solid_mesh_pt;} </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"> /// Access function for the solid mesh</span></div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classCantileverProblem.html#a63d315bcebba1a439e4b5ec0fec5b6ab">  240</a></span>&#160;<span class="comment"></span> ElasticRectangularQuadMesh&lt;ELEMENT&gt;*&amp; <a class="code" href="classCantileverProblem.html#a63d315bcebba1a439e4b5ec0fec5b6ab">solid_mesh_pt</a>() </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  {<span class="keywordflow">return</span> Solid_mesh_pt;} </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> /// Access function to the mesh of surface traction elements</span></div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="classCantileverProblem.html#af9e9b4a4686ac29bc7e4ef5d6baeae5a">  247</a></span>&#160;<span class="comment"></span> SolidMesh*&amp; <a class="code" href="classCantileverProblem.html#af9e9b4a4686ac29bc7e4ef5d6baeae5a">traction_mesh_pt</a>(){<span class="keywordflow">return</span> Traction_mesh_pt;} </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> /// Actions before adapt: Wipe the mesh of traction elements</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> actions_before_adapt();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> /// Actions after adapt: Rebuild the mesh of traction elements</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> actions_after_adapt();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> /// Doc the solution</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"> /// Run the job -- doc in RESLTi_case</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> run_it(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i_case);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> /// \short Pass pointer to traction function to the</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> /// elements in the traction mesh</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> set_traction_pt();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> /// \short Create traction elements</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="airy__cantilever_8txt.html#ad63aa99916a71fec81be9b37db1dcac9">create_traction_elements</a>();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"> /// Delete traction elements</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> delete_traction_elements();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> /// Trace file</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> ofstream Trace_file;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> /// Pointers to node whose position we&#39;re tracing</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> Node* Trace_node_pt;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"> /// Pointer to solid mesh</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span> ElasticRefineableRectangularQuadMesh&lt;ELEMENT&gt;* Solid_mesh_pt;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> /// Pointer to solid mesh</span></div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classCantileverProblem.html#af46dcd5eca58d44f1078e54f7779f0d5">  288</a></span>&#160;<span class="comment"></span> ElasticRectangularQuadMesh&lt;ELEMENT&gt;* <a class="code" href="classCantileverProblem.html#af46dcd5eca58d44f1078e54f7779f0d5">Solid_mesh_pt</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> /// Pointers to meshes of traction elements</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span> SolidMesh* Traction_mesh_pt;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> /// DocInfo object for output</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> DocInfo Doc_info;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;};</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">//===========start_of_constructor======================================= </span><span class="comment"></span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/// Constructor: </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classCantileverProblem.html#a83b396aa3bd0c2d9a491c605c208de83">  306</a></span>&#160;<a class="code" href="classCantileverProblem.html#abba97fc4b8402bc0363fdf16322f6572">CantileverProblem&lt;ELEMENT&gt;::CantileverProblem</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; incompress,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; use_fd) </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; <span class="comment">// Create the mesh</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; <span class="comment">// # of elements in x-direction</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; <span class="keywordtype">unsigned</span> n_x=20;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; <span class="comment">// # of elements in y-direction</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; <span class="keywordtype">unsigned</span> n_y=2;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; <span class="comment">// Domain length in x-direction</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; <span class="keywordtype">double</span> l_x= <a class="code" href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">Global_Physical_Variables::L</a>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; <span class="comment">// Domain length in y-direction</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; <span class="keywordtype">double</span> l_y=2.0*<a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; <span class="comment">// Shift mesh downwards so that centreline is at y=0:</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; Vector&lt;double&gt; origin(2);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; origin[0]=0.0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; origin[1]=-0.5*l_y;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; <span class="comment">//Now create the mesh </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; solid_mesh_pt() = <span class="keyword">new</span> ElasticRefineableRectangularQuadMesh&lt;ELEMENT&gt;(</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  n_x,n_y,l_x,l_y,origin);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; <span class="comment">// Set error estimator</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; <span class="keyword">dynamic_cast&lt;</span>ElasticRefineableRectangularQuadMesh&lt;ELEMENT&gt;* <span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  solid_mesh_pt())-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; <span class="comment">//Now create the mesh </span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; solid_mesh_pt() = <span class="keyword">new</span> ElasticRectangularQuadMesh&lt;ELEMENT&gt;(</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  n_x,n_y,l_x,l_y,origin);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; <span class="comment">//Assign the physical properties to the elements before any refinement</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; <span class="comment">//Loop over the elements in the main mesh</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; <span class="keywordtype">unsigned</span> n_element =solid_mesh_pt()-&gt;nelement();</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_element;i++)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <span class="comment">//Cast to a solid element</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(solid_mesh_pt()-&gt;element_pt(i));</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <span class="comment">// Set the constitutive law</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   el_pt-&gt;constitutive_law_pt() =</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <span class="comment">//Set the body force</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   el_pt-&gt;body_force_fct_pt() = <a class="code" href="namespaceGlobal__Physical__Variables.html#a0777aef63372db7f91ad894c38159681">Global_Physical_Variables::gravity</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="comment">// Get Jacobian by FD?</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <span class="keywordflow">if</span>(use_fd)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;     el_pt-&gt;enable_evaluate_jacobian_by_fd();</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     el_pt-&gt;disable_evaluate_jacobian_by_fd();</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="comment">// Is it incompressible </span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <span class="keywordflow">if</span> (incompress)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    {     </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;     PVDEquationsWithPressure&lt;2&gt;* test_pt = </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>PVDEquationsWithPressure&lt;2&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;       solid_mesh_pt()-&gt;element_pt(i));</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;     <span class="keywordflow">if</span> (test_pt!=0)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;       test_pt-&gt;set_incompressible();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; <span class="comment">// Choose a control node: The last node in the solid mesh</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; <span class="keywordtype">unsigned</span> nnod=solid_mesh_pt()-&gt;nnode();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; Trace_node_pt=solid_mesh_pt()-&gt;node_pt(nnod-1);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; <span class="comment">// Refine the mesh uniformly</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; <span class="keyword">dynamic_cast&lt;</span>ElasticRefineableRectangularQuadMesh&lt;ELEMENT&gt;* <span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  solid_mesh_pt())-&gt;<a class="code" href="airy__cantilever_8txt.html#ad749ff967f9a81125d67e4579d24b3ed">refine_uniformly</a>();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; <span class="comment">// Construct the traction element mesh</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; Traction_mesh_pt=<span class="keyword">new</span> SolidMesh;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; <a class="code" href="airy__cantilever_8txt.html#ad63aa99916a71fec81be9b37db1dcac9">create_traction_elements</a>();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; <span class="comment">// Pass pointer to traction function to the elements</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; <span class="comment">// in the traction mesh</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; set_traction_pt();</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; <span class="comment">// Solid mesh is first sub-mesh</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; add_sub_mesh(solid_mesh_pt());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; <span class="comment">// Add traction sub-mesh</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; add_sub_mesh(traction_mesh_pt());</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; <span class="comment">// Build combined &quot;global&quot; mesh</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; build_global_mesh();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; <span class="comment">// Pin the left boundary (boundary 3) in both directions</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; <span class="keywordtype">unsigned</span> n_side = mesh_pt()-&gt;nboundary_node(3);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; <span class="comment">//Loop over the nodes</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_side;i++)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   solid_mesh_pt()-&gt;boundary_node_pt(3,i)-&gt;pin_position(0);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   solid_mesh_pt()-&gt;boundary_node_pt(3,i)-&gt;pin_position(1);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; <span class="comment">// Pin the redundant solid pressures (if any)</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; PVDEquationsBase&lt;2&gt;::pin_redundant_nodal_solid_pressures(</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  solid_mesh_pt()-&gt;element_pt());</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; <span class="comment">//Attach the boundary conditions to the mesh</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; cout &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;} <span class="comment">//end of constructor</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">//=====================start_of_actions_before_adapt======================</span><span class="comment"></span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">/// Actions before adapt: Wipe the mesh of traction elements</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#a50f8964219c507562945655e0ed5fc23">CantileverProblem&lt;ELEMENT&gt;::actions_before_adapt</a>()</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;{</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; <span class="comment">// Kill the traction elements and wipe surface mesh</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; delete_traction_elements();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; rebuild_global_mesh();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}<span class="comment">// end of actions_before_adapt</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">//=====================start_of_actions_after_adapt=======================</span><span class="comment"></span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">///  Actions after adapt: Rebuild the mesh of traction elements</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#af4d135ace3eac657b38de362e1644c75">CantileverProblem&lt;ELEMENT&gt;::actions_after_adapt</a>()</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;{</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; <span class="comment">// Create traction elements from all elements that are </span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; <span class="comment">// adjacent to boundary 2 and add them to surface meshes</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; <a class="code" href="airy__cantilever_8txt.html#ad63aa99916a71fec81be9b37db1dcac9">create_traction_elements</a>();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; rebuild_global_mesh();</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; <span class="comment">// Pin the redundant solid pressures (if any)</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; PVDEquationsBase&lt;2&gt;::pin_redundant_nodal_solid_pressures(</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  solid_mesh_pt()-&gt;element_pt());</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; <span class="comment">// Set pointer to prescribed traction function for traction elements</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; set_traction_pt();</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}<span class="comment">// end of actions_after_adapt</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">//==================start_of_set_traction_pt==============================</span><span class="comment"></span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">/// Set pointer to traction function for the relevant</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">/// elements in the traction mesh</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#a96a9716947a15930f3881fcec6d448e2">CantileverProblem&lt;ELEMENT&gt;::set_traction_pt</a>()</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; <span class="comment">// Loop over the elements in the traction element mesh</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; <span class="comment">// for elements on the top boundary (boundary 2)</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; <span class="keywordtype">unsigned</span> n_element=traction_mesh_pt()-&gt;nelement();</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_element;i++)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="comment">//Cast to a solid traction element</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   SolidTractionElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>SolidTractionElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    (traction_mesh_pt()-&gt;element_pt(i));</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="comment">//Set the traction function</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   el_pt-&gt;traction_fct_pt() = <a class="code" href="namespaceGlobal__Physical__Variables.html#a19f4e20a92e7d216b4d2b00308f96917">Global_Physical_Variables::constant_pressure</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}<span class="comment">// end of set traction pt</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">//============start_of_create_traction_elements==============================</span><span class="comment"></span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">/// Create traction elements </span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#abb6f19d964d96a531bf1a60732c72ce9">CantileverProblem&lt;ELEMENT&gt;::create_traction_elements</a>()</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;{</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; <span class="comment">// Traction elements are located on boundary 2:</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; <span class="keywordtype">unsigned</span> b=2;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; <span class="keywordtype">unsigned</span> n_element = solid_mesh_pt()-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; <span class="comment">// Loop over the bulk elements adjacent to boundary b?</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    solid_mesh_pt()-&gt;boundary_element_pt(b,e));</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="keywordtype">int</span> face_index = solid_mesh_pt()-&gt;face_index_at_boundary(b,e);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="comment">// Create new element and add to mesh</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   Traction_mesh_pt-&gt;add_element_pt(<span class="keyword">new</span> SolidTractionElement&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                    (bulk_elem_pt,face_index));   </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  }  </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; <span class="comment">// Pass the pointer to the traction function to the traction elements</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; set_traction_pt();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;} <span class="comment">// end of create_traction_elements</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">//============start_of_delete_traction_elements==============================</span><span class="comment"></span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">/// Delete traction elements and wipe the  traction meshes</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#aeb64122ce3783bf36df3696c41e5d2a5">CantileverProblem&lt;ELEMENT&gt;::delete_traction_elements</a>()</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;{</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; <span class="comment">// How many surface elements are in the surface mesh</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; <span class="keywordtype">unsigned</span> n_element = Traction_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; <span class="comment">// Loop over the surface elements</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <span class="comment">// Kill surface element</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <span class="keyword">delete</span> Traction_mesh_pt-&gt;element_pt(e);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; <span class="comment">// Wipe the mesh</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; Traction_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;} <span class="comment">// end of delete_traction_elements</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">//==============start_doc===========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">/// Doc the solution</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#a7571348f8724e71be4e67dc64cea3877">CantileverProblem&lt;ELEMENT&gt;::doc_solution</a>()</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; <span class="keywordtype">unsigned</span> n_plot = 5; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; <span class="comment">// Output shape of and stress in deformed body</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; <span class="comment">//--------------------------------------------</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;         Doc_info.number());</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; solid_mesh_pt()-&gt;output(some_file,n_plot);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; some_file.close();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; <span class="comment">// Output St. Venant solution</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; <span class="comment">//---------------------------</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/exact_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;         Doc_info.number());</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; <span class="comment">// Element dimension</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; <span class="keywordtype">unsigned</span> el_dim=2;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; Vector&lt;double&gt; s(el_dim);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; Vector&lt;double&gt; x(el_dim);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; Vector&lt;double&gt; xi(el_dim);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; DenseMatrix&lt;double&gt; sigma(el_dim,el_dim);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; <span class="comment">// Constants for exact (St. Venant) solution</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; <span class="keywordtype">double</span> a=-1.0/4.0*<a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; <span class="keywordtype">double</span> b=-3.0/8.0*<a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>/<a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; <span class="keywordtype">double</span> c=1.0/8.0*<a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>/</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  pow(<a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>,3);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; <span class="keywordtype">double</span> d=1.0/20.0*<a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>/<a class="code" href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; <span class="comment">// Loop over all elements to plot exact solution for stresses</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; <span class="keywordtype">unsigned</span> nel=solid_mesh_pt()-&gt;nelement();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  {   </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   <span class="comment">// Get pointer to element</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   ELEMENT* el_pt=<span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    solid_mesh_pt()-&gt;element_pt(e));</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <span class="comment">//Tecplot header info </span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   some_file &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; n_plot &lt;&lt; <span class="stringliteral">&quot;, J=&quot;</span> &lt;&lt; n_plot &lt;&lt; std::endl;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="comment">//Loop over plot points</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_plot;l2++)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;     s[1] = -1.0 + l2*2.0/(n_plot-1);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l1=0;l1&lt;n_plot;l1++)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;       s[0] = -1.0 + l1*2.0/(n_plot-1);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;       </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;       <span class="comment">// Get Eulerian and Lagrangian coordinates</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;       el_pt-&gt;interpolated_x(s,x);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;       el_pt-&gt;interpolated_xi(s,xi);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;       </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;       <span class="comment">//Output the x,y,..</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;el_dim;i++) </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        {some_file &lt;&lt; x[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;       </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;       <span class="comment">// Change orientation of coordinate system relative</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;       <span class="comment">// to solution in lecture notes</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;       <span class="keywordtype">double</span> xx=<a class="code" href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">Global_Physical_Variables::L</a>-xi[0];</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;       <span class="keywordtype">double</span> yy=xi[1];</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;         <span class="comment">// Approximate analytical (St. Venant) solution</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         sigma(0,0)=c*(6.0*xx*xx*yy-4.0*yy*yy*yy)+</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;          6.0*d*yy;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;         sigma(1,1)=2.0*(a+b*yy+c*yy*yy*yy);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;         sigma(1,0)=2.0*(b*xx+3.0*c*xx*yy*yy);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;         sigma(0,1)=sigma(1,0);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;         <span class="comment">// Output stress</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;         some_file &lt;&lt; sigma(0,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                   &lt;&lt; sigma(1,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                   &lt;&lt; sigma(1,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                   &lt;&lt; std::endl;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; some_file.close();</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; <span class="comment">// Write trace file: Load/displacement characteristics</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; Trace_file &lt;&lt; <a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            &lt;&lt; Trace_node_pt-&gt;x(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            &lt;&lt; Trace_node_pt-&gt;x(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            &lt;&lt; std::endl;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; <span class="comment">// Increment label for output files</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; Doc_info.number()++;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;} <span class="comment">//end doc</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">//==============start_run_it========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">/// Run it</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="classCantileverProblem.html#a5c78c6602e0cbeac68239804c2d52243">  672</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCantileverProblem.html#a5c78c6602e0cbeac68239804c2d52243">CantileverProblem&lt;ELEMENT&gt;::run_it</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; i_case)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;{</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#ifdef TIME_SOLID_JAC</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  PVDEquationsBase&lt;2&gt;::Solid_timer.reset();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; <span class="comment">// Set output directory</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; <span class="keywordtype">char</span> dirname[100];   </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; sprintf(dirname,<span class="stringliteral">&quot;RESLT_refine%i&quot;</span>,i_case);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; sprintf(dirname,<span class="stringliteral">&quot;RESLT_norefine%i&quot;</span>,i_case);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; Doc_info.set_directory(dirname);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; <span class="comment">// Open trace file</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; <span class="keywordtype">char</span> filename[100];   </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,Doc_info.directory().c_str());</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; Trace_file.open(filename);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; <span class="comment">// Doc solution</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; doc_solution();</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; <span class="comment">// Initial values for parameter values</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>=0.0; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a>=0.0;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; <span class="comment">//Parameter incrementation</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; <span class="keywordtype">unsigned</span> nstep=1; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; <span class="keywordtype">double</span> p_increment=1.0e-5;   </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;nstep;i++)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="comment">// Increment pressure load</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>+=p_increment;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="comment">// Solve the problem with Newton&#39;s method, allowing</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   <span class="comment">// up to max_adapt mesh adaptations after every solve.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <span class="comment">// Max. number of adaptations per solve</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="keywordtype">unsigned</span> max_adapt=1;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   newton_solve(max_adapt);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   newton_solve();</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   <span class="comment">// Doc solution</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   doc_solution();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="preprocessor">#ifdef TIME_SOLID_JAC</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; std::cout &lt;&lt; <span class="stringliteral">&quot;Total fill_in... : &quot;</span> </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;           &lt;&lt;   PVDEquationsBase&lt;2&gt;::Solid_timer.cumulative_time(0) </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;           &lt;&lt; std::endl;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; std::cout &lt;&lt; <span class="stringliteral">&quot;Total d_stress_dG: &quot;</span> </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;           &lt;&lt;   PVDEquationsBase&lt;2&gt;::Solid_timer.cumulative_time(1) </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;           &lt;&lt; std::endl;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; std::cout &lt;&lt; <span class="stringliteral">&quot;Total Jac        : &quot;</span> </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;           &lt;&lt;   PVDEquationsBase&lt;2&gt;::Solid_timer.cumulative_time(2) </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;           &lt;&lt; std::endl;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  PVDEquationsBase&lt;2&gt;::Solid_timer.reset();</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">//=======start_of_main==================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">/// Driver for cantilever beam loaded by surface traction and/or</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">/// gravity</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00757"></a><span class="lineno"><a class="line" href="airy__cantilever2_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">  757</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="airy__cantilever2_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;{</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; <span class="keywordtype">bool</span> use_fd=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; <span class="comment">// Is the material incomressible</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; <span class="keywordtype">bool</span> incompress=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; <span class="comment">// Number of cases per implementation</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; <span class="keywordtype">unsigned</span> ncase=5;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; <span class="comment">// Loop over fd and analytical implementation</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   <span class="comment">// Generalised Hookean constitutive equations</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   <span class="comment">//-------------------------------------------</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a> = </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;     <span class="keyword">new</span> GeneralisedHookean(&amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a>,</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                            &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a09a019474b7405b35da2437f7779bc7e">Global_Physical_Variables::E</a>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    incompress=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;     <span class="comment">//Set up the problem with pure displacement based elements</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem&lt;MySolidElement&lt;RefineableQPVDElement&lt;2,3&gt;</a> &gt; &gt; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;     </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(0+i*ncase);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="preprocessor">#else   </span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;     <span class="comment">//Set up the problem with pure displacement based elements</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem&lt;MySolidElement&lt;QPVDElement&lt;2,3&gt;</a> &gt; &gt; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;     </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(0+i*ncase);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;     <span class="comment">//Set up the problem with continous pressure/displacement</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem</a>&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      RefineableQPVDElementWithContinuousPressure&lt;2&gt; &gt; &gt; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd); </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;     </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(1+i*ncase);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;     <span class="comment">//Set up the problem with continous pressure/displacement</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem</a>&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      QPVDElementWithContinuousPressure&lt;2&gt; &gt; &gt; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd); </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;     </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(1+i*ncase);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor">#ifdef REFINE    </span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;     <span class="comment">//Set up the problem with discontinous pressure/displacement</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem</a>&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      RefineableQPVDElementWithPressure&lt;2&gt; &gt; &gt; <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd); </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;     </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(2+i*ncase);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;     <span class="comment">//Set up the problem with discontinous pressure/displacement</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem</a>&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      QPVDElementWithPressure&lt;2&gt; &gt; &gt; <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd); </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;     </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(2+i*ncase);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keyword">delete</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a>=0;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;   </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   <span class="comment">// Incompressible Mooney Rivlin</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;   <span class="comment">//-----------------------------</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;   {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a> = </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;     <span class="keyword">new</span> MooneyRivlin(&amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">Global_Physical_Variables::C1</a>,</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                      &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">Global_Physical_Variables::C2</a>);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// Define a constitutive law (based on strain energy function)</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a> = </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;     <span class="keyword">new</span> IsotropicStrainEnergyFunctionConstitutiveLaw(</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a>);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    incompress=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;     <span class="comment">//Set up the problem with continous pressure/displacement</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem</a>&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      RefineableQPVDElementWithContinuousPressure&lt;2&gt; &gt; &gt; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd); </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;     </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(3+i*ncase);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;     <span class="comment">//Set up the problem with continous pressure/displacement</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem</a>&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      QPVDElementWithContinuousPressure&lt;2&gt; &gt; &gt; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd); </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;     </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(3+i*ncase);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="preprocessor">#ifdef REFINE</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;     <span class="comment">//Set up the problem with discontinous pressure/displacement</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem</a>&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      RefineableQPVDElementWithPressure&lt;2&gt; &gt; &gt; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd); </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;     </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(4+i*ncase);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;     <span class="comment">//Set up the problem with discontinous pressure/displacement</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;     <a class="code" href="classCantileverProblem.html">CantileverProblem</a>&lt;<a class="code" href="classoomph_1_1MySolidElement.html">MySolidElement</a>&lt;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      QPVDElementWithPressure&lt;2&gt; &gt; &gt; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>(incompress,use_fd); </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;     </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;     <a class="code" href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.run_it(4+i*ncase);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keyword">delete</span>  <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a>=0;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keyword">delete</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a>=0;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   }</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   use_fd=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   std::cout &lt;&lt; <span class="stringliteral">&quot;\n\n\n CR Total fill_in... : bla \n\n\n &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;   </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;} <span class="comment">//end of main</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aairy__cantilever_8txt_html_ad749ff967f9a81125d67e4579d24b3ed"><div class="ttname"><a href="airy__cantilever_8txt.html#ad749ff967f9a81125d67e4579d24b3ed">refine_uniformly</a></div><div class="ttdeci">We employ the c Z2ErrorEstimator to assess the accuracy of the computed solution and to control the adaptive mesh refinement When used with the c the c Z2ErrorEstimator uses the components of Green s strain tensor as fluxes in its flux recovery procedure skipline Set error until Z2 we pass the constitutive equations and the gravitational body force to the select a control and perform one uniform mesh refinement until refine_uniformly()</div></div>
<div class="ttc" id="aclassCantileverProblem_html_aeb64122ce3783bf36df3696c41e5d2a5"><div class="ttname"><a href="classCantileverProblem.html#aeb64122ce3783bf36df3696c41e5d2a5">CantileverProblem::delete_traction_elements</a></div><div class="ttdeci">void delete_traction_elements()</div><div class="ttdoc">Delete traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00472">airy_cantilever.cc:472</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a19f4e20a92e7d216b4d2b00308f96917"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a19f4e20a92e7d216b4d2b00308f96917">Global_Physical_Variables::constant_pressure</a></div><div class="ttdeci">void constant_pressure(const Vector&lt; double &gt; &amp;xi, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Constant pressure load. The arguments to this function are imposed on us by the SolidTractionElements...</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00174">airy_cantilever.cc:174</a></div></div>
<div class="ttc" id="aairy__cantilever_8txt_html_ad63aa99916a71fec81be9b37db1dcac9"><div class="ttname"><a href="airy__cantilever_8txt.html#ad63aa99916a71fec81be9b37db1dcac9">create_traction_elements</a></div><div class="ttdeci">We pin the position of all nodes on the left boundary(boundary 3) of the bulk mesh. The subsequent call to \c PVDEquationsBase&lt; 2 &gt; Next we output the approximate St Venant solution at the same plot points and write the load displacement characteristics to the trace file until end doc&lt; HR &gt;&lt; HR &gt; section exercises Comments and exercises subsection ex Exercises gravity rather than a pressure load Consult the document&lt; A HREF=&quot;../../solid_theory/html/index.html&quot;&gt; Solid the macroscopic deformation due to a gravitational load is identical to that induced by an equivalent pressure equivalent meaning that the total force on the beam is the same for both cases n n and c RefineableQPVDElementWithContinuousPressure&lt; 2 &gt; and compare the results Both of these two elements are based on a pressure displacement the former employing a discontinuous pressure the latter employing a continuous pressure representation(as in Taylor-Hood elements). Confirm that calls to \c PVDEquationsBase&lt; 2 &gt;[\b Note:Since this element is only defined and used in a 2D drivercode, there is little point in implementing the output for 1D or 3D elements. However, paranoid as we are, we check thedimension of the element and throw an error if it is wrong.] Finally we declare that the c FaceGeometry of the wrapped element is the same as that of the underlying element This step is required to allow the automatic construction of c SolidTractionElements in c create_traction_elements(). \dontinclude airy_cantilever.cc \skipline start_face_geometry \until }</div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a73135f793690b4386bf83bbefc7bf310"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a></div><div class="ttdeci">StrainEnergyFunction * Strain_energy_function_pt</div><div class="ttdoc">Pointer to strain energy function.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00155">airy_cantilever2.cc:155</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_a26843782873897ee5e45647d17204b86"><div class="ttname"><a href="classCantileverProblem.html#a26843782873897ee5e45647d17204b86">CantileverProblem::solid_mesh_pt</a></div><div class="ttdeci">ElasticRefineableRectangularQuadMesh&lt; ELEMENT &gt; *&amp; solid_mesh_pt()</div><div class="ttdoc">Access function for the solid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00234">airy_cantilever2.cc:234</a></div></div>
<div class="ttc" id="aclassoomph_1_1FaceGeometry_3_01MySolidElement_3_01ELEMENT_01_4_01_4_html_a4b9e14efef623686f22fb2d3747e16c3"><div class="ttname"><a href="classoomph_1_1FaceGeometry_3_01MySolidElement_3_01ELEMENT_01_4_01_4.html#a4b9e14efef623686f22fb2d3747e16c3">oomph::FaceGeometry&lt; MySolidElement&lt; ELEMENT &gt; &gt;::FaceGeometry</a></div><div class="ttdeci">FaceGeometry()</div><div class="ttdoc">Constructor [this was only required explicitly from gcc 4.5.2 onwards...].</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00130">airy_cantilever2.cc:130</a></div></div>
<div class="ttc" id="aclassoomph_1_1MySolidElement_html_abf5b903419201b1fd6f1587749337650"><div class="ttname"><a href="classoomph_1_1MySolidElement.html#abf5b903419201b1fd6f1587749337650">oomph::MySolidElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;n_plot)</div><div class="ttdoc">Overload output function:</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00059">airy_cantilever2.cc:59</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_a96a9716947a15930f3881fcec6d448e2"><div class="ttname"><a href="classCantileverProblem.html#a96a9716947a15930f3881fcec6d448e2">CantileverProblem::set_traction_pt</a></div><div class="ttdeci">void set_traction_pt()</div><div class="ttdoc">Pass pointer to traction function to the elements in the traction mesh.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00413">airy_cantilever.cc:413</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_af46dcd5eca58d44f1078e54f7779f0d5"><div class="ttname"><a href="classCantileverProblem.html#af46dcd5eca58d44f1078e54f7779f0d5">CantileverProblem::Solid_mesh_pt</a></div><div class="ttdeci">ElasticRectangularQuadMesh&lt; ELEMENT &gt; * Solid_mesh_pt</div><div class="ttdoc">Pointer to solid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00288">airy_cantilever2.cc:288</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a5d5f19442938130d36ee7476ae25049c"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a></div><div class="ttdeci">ConstitutiveLaw * Constitutive_law_pt</div><div class="ttdoc">Pointer to constitutive law.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00158">airy_cantilever.cc:158</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a1b8bfc451f6b7ac89eca18f04338f47f"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a1b8bfc451f6b7ac89eca18f04338f47f">Global_Physical_Variables::L</a></div><div class="ttdeci">double L</div><div class="ttdoc">Length of beam.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00155">airy_cantilever.cc:155</a></div></div>
<div class="ttc" id="aairy__cantilever_8txt_html_afe1df791b65813080b641a6e5cd8d3f2"><div class="ttname"><a href="airy__cantilever_8txt.html#afe1df791b65813080b641a6e5cd8d3f2">gravity</a></div><div class="ttdeci">mainpage Demo the bending of a cantilever subject to a pressure loading on its upper face and or gravity We assume that the material behaves like a generalised Hookean solid with elastic modulus f E *f and Poisson s ratio f nu f Here is a e g H Eschenauer &amp;W Schnell Elastizitaetstheorie BI&lt; HR &gt;&lt; HR &gt; section results Results The following figure shows an animation of beam s deformation in response to an increase in the uniform f P at zero gravity</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8txt_source.html#l00027">airy_cantilever.txt:27</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a09a019474b7405b35da2437f7779bc7e"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a09a019474b7405b35da2437f7779bc7e">Global_Physical_Variables::E</a></div><div class="ttdeci">double E</div><div class="ttdoc">Elastic modulus.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00161">airy_cantilever.cc:161</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a8b80d3e8d63b8d0a0ed435a2dd7fe2ad"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a></div><div class="ttdeci">double Gravity</div><div class="ttdoc">Non-dim gravity.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00186">airy_cantilever.cc:186</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_a293902b825898ce043ffce3f0691f5a5"><div class="ttname"><a href="classCantileverProblem.html#a293902b825898ce043ffce3f0691f5a5">CantileverProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update function (empty)</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00229">airy_cantilever2.cc:229</a></div></div>
<div class="ttc" id="aclassoomph_1_1MySolidElement_html_afe8a392ac0bed5890f64b75adea8f5af"><div class="ttname"><a href="classoomph_1_1MySolidElement.html#afe8a392ac0bed5890f64b75adea8f5af">oomph::MySolidElement::MySolidElement</a></div><div class="ttdeci">MySolidElement()</div><div class="ttdoc">Constructor: Call constructor of underlying element.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00056">airy_cantilever2.cc:56</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_af4d135ace3eac657b38de362e1644c75"><div class="ttname"><a href="classCantileverProblem.html#af4d135ace3eac657b38de362e1644c75">CantileverProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the mesh of traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00388">airy_cantilever.cc:388</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_a5c78c6602e0cbeac68239804c2d52243"><div class="ttname"><a href="classCantileverProblem.html#a5c78c6602e0cbeac68239804c2d52243">CantileverProblem::run_it</a></div><div class="ttdeci">void run_it(const unsigned &amp;i_case)</div><div class="ttdoc">Run the job  doc in RESLTi_case.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00672">airy_cantilever2.cc:672</a></div></div>
<div class="ttc" id="aclassoomph_1_1MySolidElement_html"><div class="ttname"><a href="classoomph_1_1MySolidElement.html">oomph::MySolidElement</a></div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00048">airy_cantilever.cc:48</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a3962c36313826b19f216f6bbbdd6a477"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Poisson's ratio.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00164">airy_cantilever.cc:164</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_af9e9b4a4686ac29bc7e4ef5d6baeae5a"><div class="ttname"><a href="classCantileverProblem.html#af9e9b4a4686ac29bc7e4ef5d6baeae5a">CantileverProblem::traction_mesh_pt</a></div><div class="ttdeci">SolidMesh *&amp; traction_mesh_pt()</div><div class="ttdoc">Access function to the mesh of surface traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00247">airy_cantilever2.cc:247</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00040">airy_cantilever.cc:40</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a849754fa7155c1a31481674ce4845658"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">Global_Physical_Variables::C1</a></div><div class="ttdeci">double C1</div><div class="ttdoc">&quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00158">airy_cantilever2.cc:158</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_a4a70a4328d287aaa15c7811562122013"><div class="ttname"><a href="classCantileverProblem.html#a4a70a4328d287aaa15c7811562122013">CantileverProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update function (empty)</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00226">airy_cantilever2.cc:226</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html"><div class="ttname"><a href="classCantileverProblem.html">CantileverProblem</a></div><div class="ttdoc">Problem class for the cantilever &quot;beam&quot; structure.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00205">airy_cantilever.cc:205</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af9defd1b5745cce50d2c386b3ac0e0ae"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">Global_Physical_Variables::C2</a></div><div class="ttdeci">double C2</div><div class="ttdoc">&quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00161">airy_cantilever2.cc:161</a></div></div>
<div class="ttc" id="aairy__cantilever2_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="airy__cantilever2_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00757">airy_cantilever2.cc:757</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_a7571348f8724e71be4e67dc64cea3877"><div class="ttname"><a href="classCantileverProblem.html#a7571348f8724e71be4e67dc64cea3877">CantileverProblem::doc_solution</a></div><div class="ttdeci">void doc_solution()</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00495">airy_cantilever.cc:495</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0777aef63372db7f91ad894c38159681"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0777aef63372db7f91ad894c38159681">Global_Physical_Variables::gravity</a></div><div class="ttdeci">void gravity(const double &amp;time, const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;b)</div><div class="ttdoc">Non-dimensional gravity as body force.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00189">airy_cantilever.cc:189</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_abba97fc4b8402bc0363fdf16322f6572"><div class="ttname"><a href="classCantileverProblem.html#abba97fc4b8402bc0363fdf16322f6572">CantileverProblem::CantileverProblem</a></div><div class="ttdeci">CantileverProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00269">airy_cantilever.cc:269</a></div></div>
<div class="ttc" id="aairy__cantilever_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="airy__cantilever_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8txt_source.html#l00003">airy_cantilever.txt:3</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af6e07423e22c0991084d9a2f43727805"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af6e07423e22c0991084d9a2f43727805">Global_Physical_Variables::H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Half height of beam.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00152">airy_cantilever.cc:152</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_a63d315bcebba1a439e4b5ec0fec5b6ab"><div class="ttname"><a href="classCantileverProblem.html#a63d315bcebba1a439e4b5ec0fec5b6ab">CantileverProblem::solid_mesh_pt</a></div><div class="ttdeci">ElasticRectangularQuadMesh&lt; ELEMENT &gt; *&amp; solid_mesh_pt()</div><div class="ttdoc">Access function for the solid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever2_8cc_source.html#l00240">airy_cantilever2.cc:240</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">Global variables.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00148">airy_cantilever.cc:148</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a23c2ade6398f54040b869f7f3a2bcc4b"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a></div><div class="ttdeci">double P</div><div class="ttdoc">Uniform pressure.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00167">airy_cantilever.cc:167</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_a50f8964219c507562945655e0ed5fc23"><div class="ttname"><a href="classCantileverProblem.html#a50f8964219c507562945655e0ed5fc23">CantileverProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the mesh of traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00372">airy_cantilever.cc:372</a></div></div>
<div class="ttc" id="aclassCantileverProblem_html_abb6f19d964d96a531bf1a60732c72ce9"><div class="ttname"><a href="classCantileverProblem.html#abb6f19d964d96a531bf1a60732c72ce9">CantileverProblem::create_traction_elements</a></div><div class="ttdeci">void create_traction_elements()</div><div class="ttdoc">Create traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="airy__cantilever_8cc_source.html#l00437">airy_cantilever.cc:437</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 6 2021 23:58:45
        </div>
      </div>
    </footer>
</body>
</html>

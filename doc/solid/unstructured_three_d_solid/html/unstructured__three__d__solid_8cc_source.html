<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: unstructured_three_d_solid.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_5cf61d7090cf0a648240fff12926b59f.html">solid</a></li><li class="navelem"><a class="el" href="dir_b36b57e1fabd50ab7ca29507568846b4.html">unstructured_three_d_solid</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">unstructured_three_d_solid.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="unstructured__three__d__solid_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Driver code for a simple unstructured solid problem using a mesh</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// generated from an input file generated by the 3d mesh generator</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// tetgen</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//Generic routines</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;solid.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;constitutive.h&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// Get the mesh</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;meshes/tetgen_mesh.h&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//=======================start_mesh========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// Tetgen-based mesh upgraded to become a solid mesh</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classMySolidTetgenMesh.html">   47</a></span>&#160;<span class="keyword">class </span><a class="code" href="classMySolidTetgenMesh.html">MySolidTetgenMesh</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> TetgenMesh&lt;ELEMENT&gt;, </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                       <span class="keyword">public</span> <span class="keyword">virtual</span> SolidMesh </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> /// Constructor: </span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classMySolidTetgenMesh.html#ac6f8d5bf403bb9da0149184c30eb6d8d">   54</a></span>&#160;<span class="comment"></span> <a class="code" href="classMySolidTetgenMesh.html#ac6f8d5bf403bb9da0149184c30eb6d8d">MySolidTetgenMesh</a>(<span class="keyword">const</span> std::string&amp; node_file_name,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <span class="keyword">const</span> std::string&amp; element_file_name,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                <span class="keyword">const</span> std::string&amp; face_file_name,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                TimeStepper* time_stepper_pt=</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                &amp;Mesh::Default_TimeStepper) : </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  TetgenMesh&lt;ELEMENT&gt;(node_file_name, element_file_name,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                      face_file_name, time_stepper_pt)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="comment">//Assign the Lagrangian coordinates</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   set_lagrangian_nodal_coordinates();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="comment">// Find elements next to boundaries</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   setup_boundary_element_info();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> /// Empty Destructor</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classMySolidTetgenMesh.html#ad0e9bf1679a2ba8d3d655b95d7124e91">   70</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <a class="code" href="classMySolidTetgenMesh.html#ad0e9bf1679a2ba8d3d655b95d7124e91">~MySolidTetgenMesh</a>() { }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;};</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">//////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">//=======start_namespace==========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">/// Global variables</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="namespaceGlobal__Parameters.html">   84</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Parameters.html">Global_Parameters</a></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> /// Poisson&#39;s ratio</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">   88</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Nu</a>=0.3;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> /// Create constitutive law</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="namespaceGlobal__Parameters.html#adbd1f040f375c96fe56b3f475f7dbec2">   91</a></span>&#160;<span class="comment"></span> ConstitutiveLaw* <a class="code" href="namespaceGlobal__Parameters.html#adbd1f040f375c96fe56b3f475f7dbec2">Constitutive_law_pt</a>=<span class="keyword">new</span> GeneralisedHookean(&amp;<a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Nu</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> /// Non-dim gravity</span></div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespaceGlobal__Parameters.html#a335000b5db4206486a116ae0468d2d0c">   94</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a335000b5db4206486a116ae0468d2d0c">Gravity</a>=0.0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> /// Non-dimensional gravity as body force</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="namespaceGlobal__Parameters.html#a200109847bf4cc26da4d00e8d68d569e">   97</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#a200109847bf4cc26da4d00e8d68d569e">gravity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;              <span class="keyword">const</span> Vector&lt;double&gt; &amp;xi,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;              Vector&lt;double&gt; &amp;b)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  b[0]=-<a class="code" href="namespaceGlobal__Parameters.html#a335000b5db4206486a116ae0468d2d0c">Gravity</a>; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  b[1]=0.0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  b[2]=0.0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; } <span class="comment">// end gravity</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> /// Uniform pressure</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">  107</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a> = 0.0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> /// \short Constant pressure load. The arguments to this function are imposed</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> /// on us by the SolidTractionElements which allow the traction to </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> /// depend on the Lagrangian and Eulerian coordinates x and xi, and on the </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> /// outer unit normal to the surface. Here we only need the outer unit</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> /// normal.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespaceGlobal__Parameters.html#a7dc25ca2abd48b7f1bffb2d6129f02bd">  114</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#a7dc25ca2abd48b7f1bffb2d6129f02bd">constant_pressure</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;xi, <span class="keyword">const</span> Vector&lt;double&gt; &amp;x,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                        <span class="keyword">const</span> Vector&lt;double&gt; &amp;n, Vector&lt;double&gt; &amp;traction)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">unsigned</span> dim = traction.size();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;dim;i++)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    traction[i] = -<a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a>*n[i];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; } <span class="comment">// end traction</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;} <span class="comment">//end namespace</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//=============start_problem===========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">/// Unstructured solid problem</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span><span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html">  136</a></span>&#160;<span class="keyword">class </span><a class="code" href="classUnstructuredSolidProblem.html">UnstructuredSolidProblem</a> : <span class="keyword">public</span> <a class="code" href="unstructured__three__d__solid_8txt.html#a369f11bc5cf9fc0b3069a6f53624f7e2">Problem</a></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> /// Constructor: </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span> <a class="code" href="classUnstructuredSolidProblem.html">UnstructuredSolidProblem</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html#a25fe105d949498bf8f7c15aff96a7d00">  145</a></span>&#160;<span class="comment"></span> <a class="code" href="classUnstructuredSolidProblem.html#a25fe105d949498bf8f7c15aff96a7d00">~UnstructuredSolidProblem</a>(){}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> /// Doc the solution</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo&amp; doc_info);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> /// Create traction elements</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="unstructured__three__d__solid_8txt.html#a99adc9b3c56170216a114b9b14978e9a">create_traction_elements</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> /// Bulk solid mesh</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html#ad6a8cbe2c2f3596385e1a2484bfb68f7">  156</a></span>&#160;<span class="comment"></span> <a class="code" href="classMySolidTetgenMesh.html">MySolidTetgenMesh&lt;ELEMENT&gt;</a>* <a class="code" href="classUnstructuredSolidProblem.html#ad6a8cbe2c2f3596385e1a2484bfb68f7">Solid_mesh_pt</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> /// Meshes of traction elements</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html#a32e691a698667053003e21333fc65057">  159</a></span>&#160;<span class="comment"></span> Vector&lt;SolidMesh*&gt; <a class="code" href="classUnstructuredSolidProblem.html#a32e691a698667053003e21333fc65057">Solid_traction_mesh_pt</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> /// IDs of solid mesh boundaries where displacements are pinned</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html#a62ea7d593eaac6a3a0f0455c4a3fd805">  162</a></span>&#160;<span class="comment"></span> Vector&lt;unsigned&gt; <a class="code" href="classUnstructuredSolidProblem.html#a62ea7d593eaac6a3a0f0455c4a3fd805">Pinned_solid_boundary_id</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> /// \short IDs of solid mesh boundaries which make up the traction interface</span></div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html#a4cf906bac719c9a942c04bda2798080f">  165</a></span>&#160;<span class="comment"></span> Vector&lt;unsigned&gt; <a class="code" href="classUnstructuredSolidProblem.html#a4cf906bac719c9a942c04bda2798080f">Solid_traction_boundary_id</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;};</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">//=============start_constructor==========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/// Constructor for unstructured solid problem</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">  175</a></span>&#160;<a class="code" href="classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">UnstructuredSolidProblem&lt;ELEMENT&gt;::UnstructuredSolidProblem</a>()</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{ </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">//Create solid bulk mesh</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; <span class="keywordtype">string</span> node_file_name=<span class="stringliteral">&quot;fsi_bifurcation_solid.1.node&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; <span class="keywordtype">string</span> element_file_name=<span class="stringliteral">&quot;fsi_bifurcation_solid.1.ele&quot;</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; <span class="keywordtype">string</span> face_file_name=<span class="stringliteral">&quot;fsi_bifurcation_solid.1.face&quot;</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; Solid_mesh_pt =  <span class="keyword">new</span> <a class="code" href="classMySolidTetgenMesh.html">MySolidTetgenMesh&lt;ELEMENT&gt;</a>(node_file_name,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                              element_file_name,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                              face_file_name);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; <span class="comment">// The following IDs corresponds to the boundary IDs specified in</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; <span class="comment">// the *.poly file from which tetgen generated the unstructured mesh.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> /// IDs of solid mesh boundaries where displacements are pinned</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> Pinned_solid_boundary_id.resize(3);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; Pinned_solid_boundary_id[0]=0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; Pinned_solid_boundary_id[1]=1;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; Pinned_solid_boundary_id[2]=2;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// The solid mesh boundaries where an internal pressure is applied</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; Solid_traction_boundary_id.resize(12);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;12;i++)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   Solid_traction_boundary_id[i]=i+3;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; <span class="comment">// Apply BCs for solid</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; <span class="comment">//--------------------</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; <span class="comment">// Doc pinned solid nodes</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; std::ofstream bc_file(<span class="stringliteral">&quot;RESLT/pinned_solid_nodes.dat&quot;</span>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; <span class="comment">// Pin positions at inflow boundary (boundaries 0 and 1)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; <span class="keywordtype">unsigned</span> n=Pinned_solid_boundary_id.size();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="comment">// Get boundary ID</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="keywordtype">unsigned</span> b=Pinned_solid_boundary_id[i];</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordtype">unsigned</span> num_nod= Solid_mesh_pt-&gt;nboundary_node(b);  </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {    </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;     <span class="comment">// Get node</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;     SolidNode* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(b,inod);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;     <span class="comment">// Pin all directions</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;3;i++)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;       nod_pt-&gt;pin_position(i);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;       </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;       <span class="comment">// ...and doc it as pinned</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;       bc_file &lt;&lt; nod_pt-&gt;x(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;     </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;     bc_file &lt;&lt; std::endl;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; bc_file.close();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; <span class="comment">// Complete the build of all elements so they are fully functional</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; <span class="comment">//----------------------------------------------------------------</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; <span class="keywordtype">unsigned</span> n_element = Solid_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_element;i++)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="comment">//Cast to a solid element</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    Solid_mesh_pt-&gt;element_pt(i));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="comment">// Set the constitutive law   </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   el_pt-&gt;constitutive_law_pt() =</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="namespaceGlobal__Parameters.html#adbd1f040f375c96fe56b3f475f7dbec2">Global_Parameters::Constitutive_law_pt</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="comment">//Set the body force</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   el_pt-&gt;body_force_fct_pt() = <a class="code" href="namespaceGlobal__Parameters.html#a200109847bf4cc26da4d00e8d68d569e">Global_Parameters::gravity</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; <span class="comment">// Create traction elements</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; <span class="comment">//-------------------------</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; <span class="comment">// Create meshes of traction elements</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; n=Solid_traction_boundary_id.size();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; Solid_traction_mesh_pt.resize(n);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   Solid_traction_mesh_pt[i]=<span class="keyword">new</span> SolidMesh;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; <span class="comment">// Build the traction elements</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; <a class="code" href="unstructured__three__d__solid_8txt.html#a99adc9b3c56170216a114b9b14978e9a">create_traction_elements</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; <span class="comment">// Combine the lot</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; <span class="comment">//----------------</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; <span class="comment">// The solid bulk mesh</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; add_sub_mesh(Solid_mesh_pt);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; <span class="comment">// The solid traction meshes</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; n=Solid_traction_boundary_id.size();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   add_sub_mesh(Solid_traction_mesh_pt[i]);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; <span class="comment">// Build global mesh</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; build_global_mesh();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; std::cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;} <span class="comment">// end constructor</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//============start_of_create_traction_elements==========================</span><span class="comment"></span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">/// Create traction elements </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html#a9137960284200ed998989f785965f902">  297</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUnstructuredSolidProblem.html#a9137960284200ed998989f785965f902">UnstructuredSolidProblem&lt;ELEMENT&gt;::create_traction_elements</a>()</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; <span class="comment">// Loop over traction boundaries</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; <span class="keywordtype">unsigned</span> n=Solid_traction_boundary_id.size();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <span class="comment">// Get boundary ID</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <span class="keywordtype">unsigned</span> b=Solid_traction_boundary_id[i];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <span class="keywordtype">unsigned</span> n_element = Solid_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;     <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;     ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      Solid_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;     </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;     <span class="comment">//What is the index of the face of the element e along boundary b</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;     <span class="keywordtype">int</span> face_index = Solid_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;     </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;     <span class="comment">// Create new element </span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;     SolidTractionElement&lt;ELEMENT&gt;* el_pt=</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keyword">new</span> SolidTractionElement&lt;ELEMENT&gt;(bulk_elem_pt,face_index);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;     </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;     <span class="comment">// Add it to the mesh</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;     Solid_traction_mesh_pt[i]-&gt;add_element_pt(el_pt);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;     </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;     <span class="comment">//Set the traction function</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;     el_pt-&gt;traction_fct_pt() = <a class="code" href="namespaceGlobal__Parameters.html#a7dc25ca2abd48b7f1bffb2d6129f02bd">Global_Parameters::constant_pressure</a>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;} <span class="comment">// end of create_traction_elements</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/// Doc the solution</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="classUnstructuredSolidProblem.html#ab3d66fd61b69d12b4f159d763fc44f15">  340</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUnstructuredSolidProblem.html#ab3d66fd61b69d12b4f159d763fc44f15">UnstructuredSolidProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; doc_info)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;{ </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; <span class="comment">// Number of plot points</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; npts=5;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; <span class="comment">// Output solid solution</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/solid_soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; Solid_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; some_file.close();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; <span class="comment">// Output traction</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; <span class="comment">//----------------</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/traction%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; <span class="keywordtype">unsigned</span> n=Solid_traction_boundary_id.size();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;n;i++)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   Solid_traction_mesh_pt[i]-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; some_file.close();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;} <span class="comment">// end doc</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">//============================start_main==================================</span><span class="comment"></span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">/// Demonstrate how to solve an unstructured 3D solid problem</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="unstructured__three__d__solid_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">  380</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="unstructured__three__d__solid_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; <span class="comment">// Store command line arguments</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; CommandLineArgs::setup(argc,argv);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; <span class="comment">// Label for output</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; <span class="comment">// Output directory</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; <span class="comment">//Set up the problem</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; <a class="code" href="classUnstructuredSolidProblem.html">UnstructuredSolidProblem&lt;TPVDElement&lt;3,3&gt;</a> &gt; <a class="code" href="unstructured__three__d__solid_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; <span class="comment">//Output initial configuration</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; <a class="code" href="unstructured__three__d__solid_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution(doc_info);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; doc_info.number()++;   </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// Parameter study</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; <a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">Global_Parameters::P</a>=0.0; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; <span class="keywordtype">double</span> g_increment=1.0e-3; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; <span class="keywordtype">double</span> p_increment=1.0e-2; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; <span class="keywordtype">unsigned</span> nstep=6;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; <span class="keywordflow">if</span> (CommandLineArgs::Argc!=1)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   std::cout &lt;&lt; <span class="stringliteral">&quot;Validation -- only doing two steps&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   nstep=2;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; <span class="comment">// Do the parameter study</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="comment">// Solve the problem</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <a class="code" href="unstructured__three__d__solid_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.newton_solve();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="comment">//Output solution</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <a class="code" href="unstructured__three__d__solid_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a>.doc_solution(doc_info);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   doc_info.number()++;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="comment">// Bump up load</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <a class="code" href="namespaceGlobal__Parameters.html#a335000b5db4206486a116ae0468d2d0c">Global_Parameters::Gravity</a>+=g_increment;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">Global_Parameters::P</a>+=p_increment; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;} <span class="comment">// end main</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassMySolidTetgenMesh_html_ad0e9bf1679a2ba8d3d655b95d7124e91"><div class="ttname"><a href="classMySolidTetgenMesh.html#ad0e9bf1679a2ba8d3d655b95d7124e91">MySolidTetgenMesh::~MySolidTetgenMesh</a></div><div class="ttdeci">virtual ~MySolidTetgenMesh()</div><div class="ttdoc">Empty Destructor.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00070">unstructured_three_d_solid.cc:70</a></div></div>
<div class="ttc" id="aunstructured__three__d__solid_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="unstructured__three__d__solid_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Demonstrate how to solve an unstructured 3D solid problem.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00380">unstructured_three_d_solid.cc:380</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a32e691a698667053003e21333fc65057"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a32e691a698667053003e21333fc65057">UnstructuredSolidProblem::Solid_traction_mesh_pt</a></div><div class="ttdeci">Vector&lt; SolidMesh * &gt; Solid_traction_mesh_pt</div><div class="ttdoc">Meshes of traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00159">unstructured_three_d_solid.cc:159</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a25fe105d949498bf8f7c15aff96a7d00"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a25fe105d949498bf8f7c15aff96a7d00">UnstructuredSolidProblem::~UnstructuredSolidProblem</a></div><div class="ttdeci">~UnstructuredSolidProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00145">unstructured_three_d_solid.cc:145</a></div></div>
<div class="ttc" id="aunstructured__three__d__solid_8txt_html_a369f11bc5cf9fc0b3069a6f53624f7e2"><div class="ttname"><a href="unstructured__three__d__solid_8txt.html#a369f11bc5cf9fc0b3069a6f53624f7e2">Problem</a></div><div class="ttdeci">we add the various meshes as sub meshes to the c Problem</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8txt_source.html#l00286">unstructured_three_d_solid.txt:286</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a4cf906bac719c9a942c04bda2798080f"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a4cf906bac719c9a942c04bda2798080f">UnstructuredSolidProblem::Solid_traction_boundary_id</a></div><div class="ttdeci">Vector&lt; unsigned &gt; Solid_traction_boundary_id</div><div class="ttdoc">IDs of solid mesh boundaries which make up the traction interface.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00165">unstructured_three_d_solid.cc:165</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a62ea7d593eaac6a3a0f0455c4a3fd805"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a62ea7d593eaac6a3a0f0455c4a3fd805">UnstructuredSolidProblem::Pinned_solid_boundary_id</a></div><div class="ttdeci">Vector&lt; unsigned &gt; Pinned_solid_boundary_id</div><div class="ttdoc">IDs of solid mesh boundaries where displacements are pinned.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00162">unstructured_three_d_solid.cc:162</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a9137960284200ed998989f785965f902"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a9137960284200ed998989f785965f902">UnstructuredSolidProblem::create_traction_elements</a></div><div class="ttdeci">void create_traction_elements()</div><div class="ttdoc">Create traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00297">unstructured_three_d_solid.cc:297</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a18ce02b6e4bbc86403c9e1b32c095772"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">UnstructuredSolidProblem::UnstructuredSolidProblem</a></div><div class="ttdeci">UnstructuredSolidProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00175">unstructured_three_d_solid.cc:175</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html"><div class="ttname"><a href="namespaceGlobal__Parameters.html">Global_Parameters</a></div><div class="ttdoc">Global variables.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00084">unstructured_three_d_solid.cc:84</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html"><div class="ttname"><a href="classUnstructuredSolidProblem.html">UnstructuredSolidProblem</a></div><div class="ttdoc">Unstructured solid problem.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00136">unstructured_three_d_solid.cc:136</a></div></div>
<div class="ttc" id="aunstructured__three__d__solid_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="unstructured__three__d__solid_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8txt_source.html#l00007">unstructured_three_d_solid.txt:7</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a31fb55c20db4aa0127aafa20f0d76731"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">Global_Parameters::P</a></div><div class="ttdeci">double P</div><div class="ttdoc">Uniform pressure.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00107">unstructured_three_d_solid.cc:107</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a200109847bf4cc26da4d00e8d68d569e"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a200109847bf4cc26da4d00e8d68d569e">Global_Parameters::gravity</a></div><div class="ttdeci">void gravity(const double &amp;time, const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;b)</div><div class="ttdoc">Non-dimensional gravity as body force.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00097">unstructured_three_d_solid.cc:97</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_adbd1f040f375c96fe56b3f475f7dbec2"><div class="ttname"><a href="namespaceGlobal__Parameters.html#adbd1f040f375c96fe56b3f475f7dbec2">Global_Parameters::Constitutive_law_pt</a></div><div class="ttdeci">ConstitutiveLaw * Constitutive_law_pt</div><div class="ttdoc">Create constitutive law.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00091">unstructured_three_d_solid.cc:91</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a20fccdcfa2c15ad8b951b9ada3bb1661"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Poisson's ratio.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00088">unstructured_three_d_solid.cc:88</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_ad6a8cbe2c2f3596385e1a2484bfb68f7"><div class="ttname"><a href="classUnstructuredSolidProblem.html#ad6a8cbe2c2f3596385e1a2484bfb68f7">UnstructuredSolidProblem::Solid_mesh_pt</a></div><div class="ttdeci">MySolidTetgenMesh&lt; ELEMENT &gt; * Solid_mesh_pt</div><div class="ttdoc">Bulk solid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00156">unstructured_three_d_solid.cc:156</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a335000b5db4206486a116ae0468d2d0c"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a335000b5db4206486a116ae0468d2d0c">Global_Parameters::Gravity</a></div><div class="ttdeci">double Gravity</div><div class="ttdoc">Non-dim gravity.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00094">unstructured_three_d_solid.cc:94</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_ab3d66fd61b69d12b4f159d763fc44f15"><div class="ttname"><a href="classUnstructuredSolidProblem.html#ab3d66fd61b69d12b4f159d763fc44f15">UnstructuredSolidProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00340">unstructured_three_d_solid.cc:340</a></div></div>
<div class="ttc" id="aunstructured__three__d__solid_8txt_html_a99adc9b3c56170216a114b9b14978e9a"><div class="ttname"><a href="unstructured__three__d__solid_8txt.html#a99adc9b3c56170216a114b9b14978e9a">create_traction_elements</a></div><div class="ttdeci">mainpage Demo bifurcating vessel whose deformation is studied here conveys(and is loaded by) a viscous fluid.&lt; HR &gt;&lt; HR &gt; \section problem The problem(and results) Here is an animation of the problem We complete the build of the elements by setting the pointer to the constitutive equation and the body force until Next we create the traction attaching them to the bulk solid elements that are adjacent to the boundaries that constitute the inside of the vessel until create_traction_elements()</div></div>
<div class="ttc" id="aclassMySolidTetgenMesh_html"><div class="ttname"><a href="classMySolidTetgenMesh.html">MySolidTetgenMesh</a></div><div class="ttdoc">Tetgen-based mesh upgraded to become a solid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00047">unstructured_three_d_solid.cc:47</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a7dc25ca2abd48b7f1bffb2d6129f02bd"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a7dc25ca2abd48b7f1bffb2d6129f02bd">Global_Parameters::constant_pressure</a></div><div class="ttdeci">void constant_pressure(const Vector&lt; double &gt; &amp;xi, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Constant pressure load. The arguments to this function are imposed on us by the SolidTractionElements...</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00114">unstructured_three_d_solid.cc:114</a></div></div>
<div class="ttc" id="aclassMySolidTetgenMesh_html_ac6f8d5bf403bb9da0149184c30eb6d8d"><div class="ttname"><a href="classMySolidTetgenMesh.html#ac6f8d5bf403bb9da0149184c30eb6d8d">MySolidTetgenMesh::MySolidTetgenMesh</a></div><div class="ttdeci">MySolidTetgenMesh(const std::string &amp;node_file_name, const std::string &amp;element_file_name, const std::string &amp;face_file_name, TimeStepper *time_stepper_pt=&amp;Mesh::Default_TimeStepper)</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00054">unstructured_three_d_solid.cc:54</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 16 2021 19:43:49
        </div>
      </div>
    </footer>
</body>
</html>

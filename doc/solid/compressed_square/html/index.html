<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Demo problem: Compressible and incompressible behaviour</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Demo problem: Compressible and incompressible behaviour </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The purpose of this tutorial is to discuss the use of compressible and incompressible constitutive equations for solid mechanics problems. As discussed in the <a href="../../solid_theory/html/index.html#elastic_constitutive">Solid Mechanics Theory Tutorial</a>, problems in which the solid is truly incompressible require a solution based on the pressure/displacement formulation of the principle of virtual displacements (PVD). Mathematically, this is because the pressure acts as the Lagrange multiplier that enforces incompressibility. The pressure/displacement form of the PVD may be discretised with finite elements that employ continuous (e.g. Taylor-Hood-type) or discontinuous (e.g. Crouzeix-Raviart-type) elements.</p>
<p>Some constitutive equations allow for compressible and incompressible behaviour, depending on their parameters. Problems involving such constitutive equations may be solved with large number of formulations. As an example, consider <code>oomph-lib's</code> generalised Hookean constitutive equation (see the <a href="#disclaimer">disclaimer</a> below).</p>
<p><b> I. The displacement form </b></p>
<p><code>oomph-lib's</code> generalised Hookean constitutive law assumes that the 2nd Piola Kirchhoff stress <img class="formulaInl" alt="$ \sigma^{ij} $" src="form_0.png" width="15" height="11"/> (non-dimensionalised on Young's modulus <img class="formulaInl" alt="$ E $" src="form_1.png" width="10" height="9"/>) is related to Green's strain tensor <img class="formulaInl" alt="$ \gamma_{ij} = 1/2 \ (G_{ij} - g_{ij}) $" src="form_2.png" width="113" height="14"/> via </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma^{ij} = \frac{1}{2(1+\nu)} \left( G^{ik} G^{jl} + G^{il} G^{jk} + \frac{2\nu}{1-2\nu} G^{ij} G^{kl} \right) \gamma_{kl}. \hspace{3cm} (1) \]" src="form_3.png" width="425" height="31"/>
</p>
<p> Here <img class="formulaInl" alt="$ g_{ij} $" src="form_4.png" width="15" height="10"/> and <img class="formulaInl" alt="$ G_{ij} $" src="form_5.png" width="18" height="14"/> are the metric tensors associated with the undeformed and deformed configurations. This constitutive law reduces to the the classical version of Hooke's law for small strains when <img class="formulaInl" alt="$ G_{ij} \to g_{ij}. $" src="form_6.png" width="55" height="14"/> In the above form, the constitutive law can be used directly in the displacement-based form of the PVD, unless <img class="formulaInl" alt="$ \nu = 1/2 $" src="form_7.png" width="43" height="14"/> &ndash; the case that corresponds to incompressible behaviour in the small-displacement regime. (While the above formulation only breaks down completely when <img class="formulaInl" alt="$ \nu = 1/2, $" src="form_8.png" width="45" height="14"/> numerical solutions based on the above form of the constitutive equation become badly-behaved as <img class="formulaInl" alt="$ \nu $" src="form_9.png" width="6" height="6"/> approaches that value.)</p>
<p><b> II. The pressure-displacement form for compressible and incompressible behaviour</b></p>
<p>To avoid the problems that arise as <img class="formulaInl" alt="$ \nu \to 1/2, $" src="form_10.png" width="48" height="14"/> the constitutive equation may be rewritten in the form </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma^{ij} = \overline{\sigma}^{ij} - p \ G^{ij} \ , \]" src="form_11.png" width="101" height="15"/>
</p>
<p> where the deviatoric stress is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{\sigma}^{ij} = \frac{1}{2(1+\nu)} \bigg( G^{ik} G^{jl} + G^{il} G^{jk} \bigg) \gamma_{kl}. \]" src="form_12.png" width="209" height="31"/>
</p>
<p> To remain consistent with (1), the pressure <img class="formulaInl" alt="$ p $" src="form_13.png" width="8" height="9"/> must then be determined via the equation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p \ \frac{1}{\kappa} + d = 0, \hspace{4cm} (2) \]" src="form_14.png" width="229" height="26"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ d = G^{ij} \gamma_{ij} \]" src="form_15.png" width="56" height="16"/>
</p>
<p> is the generalised dilatation (which reduces to the actual dilatation in the small-strain limit). The inverse bulk modulus is defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{1}{\kappa} = \frac{(1-2\nu)(1+\nu)}{\nu} \]" src="form_16.png" width="111" height="28"/>
</p>
<p> and tends to zero as <img class="formulaInl" alt="$ \nu \to 0. $" src="form_17.png" width="35" height="9"/> The alternative form of the constitutive equation can therefore be used for any value of <img class="formulaInl" alt="$ \nu $" src="form_9.png" width="6" height="6"/>. If <img class="formulaInl" alt="$ \nu = 1/2, $" src="form_8.png" width="45" height="14"/> the constraint (2) enforces <img class="formulaInl" alt="$ d=0, $" src="form_18.png" width="33" height="13"/> i.e incompressible behaviour (at least in the small displacement regime &ndash; for large deflections the constraint (2) simply ensures that the generalised dilatation vanishes; this may not be a physically meaningful constraint).</p>
<p><b> III. Truly incompressible behaviour</b></p>
<p>Finally, we may retain the decomposition of the stress into its deviatoric and non-deviatoric parts but determine the pressure from the actual incompressibility constraint, i.e. replace (2) by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \det G_{ij} - \det g_{ij} = 0. \hspace{5cm} (3) \]" src="form_19.png" width="306" height="14"/>
</p>
<p> In this case, the deviatoric part of the stress is determined by the material's constitutive parameters, i.e. its Young's modulus and its Poisson ratio while the pressure (acting as the Lagrange multiplier for the constraint (3)) enforces true incompressibility.</p>
<p><a class="anchor" id="disclaimer"></a></p>
<table border="1">
<tr>
<td bgcolor="cornsilk"><center> <b>Disclaimer</b> </center> We wish to stress that not all the combinations discussed above are necessarily physically meaningful. For instance, as already acknowledged, setting <img class="formulaInl" alt="$ \nu = 1/2 $" src="form_7.png" width="43" height="14"/> in formulation II does not ensure true incompressibility (in the sense of (3)) if the solid undergoes large deflections. Similarly, setting <img class="formulaInl" alt="$ \nu $" src="form_9.png" width="6" height="6"/> to a value that differs from <img class="formulaInl" alt="$ 1/2 $" src="form_20.png" width="19" height="14"/> while enforcing true incompressibility via formulation III would be extremely odd. Furthermore, it is not clear (to us) if our generalisation of Hooke's law (obtained by replacing the undeformed metric tensor <img class="formulaInl" alt="$ g_{ij} $" src="form_4.png" width="15" height="10"/> by its deformed counterpart <img class="formulaInl" alt="$ G_{ij} $" src="form_5.png" width="18" height="14"/> yields a constitutive equation that is particularly useful for any specific material. However, the same is true for any other constitutive equation &ndash; not all of them are useful for all materials! The important point is that all constitutive equations that allow for compressible and incompressible behaviour contain combinations of constitutive parameters that blow up as incompressibility is approached. Formulation II shows how to express such constitutive laws in a way that can be used for any value of the constitutive parameters.   </td></tr>
</table>
<p>With this disclaimer in mind, we will now demonstrate the use of the various combinations outlined above in a simple test problem for which an exact (linearised) solution is available.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="problem"></a>
The problem</h1>
<p>Here is a sketch of the problem: Three faces of a square elastic body are surrounded by "slippery" rigid walls that allow the body to slide freely along them. The body is subject to a vertical, gravitational body force, acting in the negative <img class="formulaInl" alt="$ y $" src="form_21.png" width="8" height="9"/> -direction.</p>
<div class="image">
<img src="sketch.gif" alt=""/>
<div class="caption">
Sketch of the problem. </div></div>
 <p>We choose the height of the square as the reference length for the non-dimensionalisation by setting <img class="formulaInl" alt="$ {\cal L} = L, $" src="form_22.png" width="38" height="13"/> and use the characteristic stiffness associated with the body's constitutive equation to scale the stresses and the body forces. For instance, for linear elastic behaviour, we choose the reference stress to be the solid's Young's modulus, thus setting <img class="formulaInl" alt="$ {\cal S} = E. $" src="form_23.png" width="39" height="10"/> The non-dimensional body force is then given by <img class="formulaInl" alt="$ {\bf f} = - g \ {\bf e}_y, $" src="form_24.png" width="59" height="14"/> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ g = \frac{\rho g^* L}{E} \]" src="form_25.png" width="53" height="28"/>
</p>
<p> indicates the magnitude of the gravitational load relative to the body's stiffness; see the <a href="../../solid_theory/html/index.html#non-dim_solid">Solid Mechanics Theory Tutorial</a> for full details on the non-dimensionalisation of the governing equations.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="exact"></a>
An exact solution</h1>
<p>Assuming weak loading, i.e. <img class="formulaInl" alt="$ g \ll 1 $" src="form_26.png" width="33" height="11"/>, the body will undergo small deflections and its deformation will be governed by the equations of linear elasticity. Given that the walls bounding the solid are slippery, it is easy to show that a displacement field has the form <img class="formulaInl" alt="$ {\bf u} = v(y)\ {\bf e}_y $" src="form_27.png" width="64" height="14"/>. Inserting this ansatz into the Navier-Lame equations shows that the non-dimensional displacement in the vertical direction is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ v(y) = g \ \frac{(1+\nu)(1-2\nu)}{(1-\nu)} \left( \frac{1}{2} y^2 - y \right). \]" src="form_28.png" width="204" height="31"/>
</p>
<p> The stresses are given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma_{xx} = \frac{g \ \nu}{(1-\nu)} (y-1) \ , \ \ \ \ \sigma_{xy} = 0 \ , \mbox{ \ \ \ and \ \ \ } \sigma_{yy} = g \ (y-1) \ . \]" src="form_29.png" width="336" height="28"/>
</p>
<p> This shows that, as the solid approaches incompressibility, <img class="formulaInl" alt="$ \nu \to 1/2, $" src="form_10.png" width="48" height="14"/> the displacements are suppressed and the stress distribution becomes hydrostatic with <img class="formulaInl" alt="$ \sigma_{xx} \to \sigma_{yy}. $" src="form_30.png" width="60" height="11"/></p>
<hr  />
 <hr  />
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>Here is a plot of the three non-zero quantities (the vertical displacement <img class="formulaInl" alt="$ v $" src="form_31.png" width="8" height="6"/>, and the horizontal and vertical stresses, <img class="formulaInl" alt="$ \sigma_{xx} $" src="form_32.png" width="18" height="9"/> and <img class="formulaInl" alt="$ \sigma_{yy} $" src="form_33.png" width="18" height="10"/>, respectively) for <img class="formulaInl" alt="$ g = 10^{-2} $" src="form_34.png" width="49" height="14"/> and <img class="formulaInl" alt="$ \nu =0.45. $" src="form_35.png" width="49" height="9"/> The shaded surface shows the exact solution while the mesh shows the finite element solution obtained with the displacement formulation of the problem. The solutions obtained with formulations II and III are graphically indistinguishable. All other quantities (the transverse displacement and the shear stress <img class="formulaInl" alt="$ \sigma_{xy} $" src="form_36.png" width="18" height="10"/>) are of order <img class="formulaInl" alt="$ 10^{-12}. $" src="form_37.png" width="34" height="11"/></p>
<div class="image">
<img src="validate_vs_lin.gif" alt=""/>
<div class="caption">
Plot of the vertical displacement and the horizontal and vertical stresses, respectively. </div></div>
 <p>The driver code listed below also computes solutions for various other values of <img class="formulaInl" alt="$ \nu $" src="form_9.png" width="6" height="6"/> (including the incompressible case <img class="formulaInl" alt="$ \nu=1/2 $" src="form_38.png" width="43" height="14"/>), and demonstrates how to enforce "true" incompressibility via formulation III. Furthermore, it computes a solution based on the incompressible Mooney-Rivlin constitutive law. The agreement between analytical and computed results is as good as the one shown in the above plot. In particular in all cases where incompressibility is enforced, the vertical displacement is suppressed and the stress state becomes hydrostatic, as predicted by the analytical solution.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="wrapper"></a>
Modifying the element's output function</h1>
<p>Since we wish to compare the stresses and displacements against the analytical solution, we modify the <code>SolidElement's</code> output function by means of a wrapper class that overloads the <code>SolidElement::output(...)</code>.</p>
 <div class="fragment"><div class="line"><span class="comment">//=================start_wrapper==================================</span></div>
<div class="line"><span class="comment">/// Wrapper class for solid element to modify the output </span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span>MySolidElement : <span class="keyword">public</span> <span class="keyword">virtual</span> ELEMENT</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: Call constructor of underlying element</span></div>
<div class="line"><span class="comment"></span> MySolidElement() : ELEMENT() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Overload output function</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> output(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line">  {</div>
<div class="line">   Vector&lt;double&gt; s(2);</div>
<div class="line">   Vector&lt;double&gt; x(2);</div>
<div class="line">   Vector&lt;double&gt; xi(2);</div>
<div class="line">   DenseMatrix&lt;double&gt; sigma(2,2);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Tecplot header info </span></div>
<div class="line">   outfile &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; n_plot &lt;&lt; <span class="stringliteral">&quot;, J=&quot;</span> &lt;&lt; n_plot &lt;&lt; std::endl;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Loop over plot points</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_plot;l2++)</div>
<div class="line">    {</div>
<div class="line">     s[1] = -1.0 + l2*2.0/(n_plot-1);</div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l1=0;l1&lt;n_plot;l1++)</div>
<div class="line">      {</div>
<div class="line">       s[0] = -1.0 + l1*2.0/(n_plot-1);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Get Eulerian and Lagrangian coordinates and the stress</span></div>
<div class="line">       this-&gt;interpolated_x(s,x);</div>
<div class="line">       this-&gt;interpolated_xi(s,xi);</div>
<div class="line">       this-&gt;get_stress(s,sigma);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">//Output the x,y coordinates</span></div>
<div class="line">       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++) </div>
<div class="line">        {outfile &lt;&lt; x[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Output displacements, the difference between Eulerian and Lagrangian</span></div>
<div class="line">       <span class="comment">// coordinates</span></div>
<div class="line">       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++) </div>
<div class="line">        {outfile &lt;&lt; x[i]-xi[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line">       </div>
<div class="line">       <span class="comment">//Output stress</span></div>
<div class="line">       outfile &lt;&lt; sigma(0,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">               &lt;&lt; sigma(1,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">               &lt;&lt; sigma(1,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">               &lt;&lt; std::endl;</div>
<div class="line">      }</div>
<div class="line">    }  </div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="namespace"></a>
Problem Parameters</h1>
<p>As usual we define the various problem parameters in a global namespace. We prepare a pointer to a constitutive equation and define Poisson's ratio for use with the generalised Hookean constitutive law.</p>
<div class="fragment"><div class="line"><span class="comment">//=======start_namespace==========================================</span></div>
<div class="line"><span class="comment">/// Global variables</span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line">{</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to constitutive law</span></div>
<div class="line"><span class="comment"></span> ConstitutiveLaw* <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Constitutive_law_pt</a>=0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Poisson&#39;s ratio for Hooke&#39;s law</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Nu</a>=0.45;</div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">//////////////////////////////////////////////////////////////////// ////////////////////////////////...</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00110">compressed_square.cc:111</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a2a37fb040c832ee7a086bb13bb02a100"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a></div><div class="ttdeci">ConstitutiveLaw * Constitutive_law_pt</div><div class="ttdoc">Pointer to constitutive law.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00114">compressed_square.cc:114</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a3962c36313826b19f216f6bbbdd6a477"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Poisson's ratio for Hooke's law.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00117">compressed_square.cc:117</a></div></div>
</div><!-- fragment --><p> We also prepare a pointer to a strain energy function and define the coefficients for the Mooney Rivlin law:</p>
<div class="fragment"><div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to strain energy function </span></div>
<div class="line"><span class="comment"></span> StrainEnergyFunction* <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Strain_energy_function_pt</a>=0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// First &quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">C1</a>=1.3;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Second &quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">C2</a>=1.3;</div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a73135f793690b4386bf83bbefc7bf310"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a></div><div class="ttdeci">StrainEnergyFunction * Strain_energy_function_pt</div><div class="ttdoc">Pointer to strain energy function.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00120">compressed_square.cc:120</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a849754fa7155c1a31481674ce4845658"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">Global_Physical_Variables::C1</a></div><div class="ttdeci">double C1</div><div class="ttdoc">First &quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00123">compressed_square.cc:123</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af9defd1b5745cce50d2c386b3ac0e0ae"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">Global_Physical_Variables::C2</a></div><div class="ttdeci">double C2</div><div class="ttdoc">Second &quot;Mooney Rivlin&quot; coefficient for generalised Mooney Rivlin law.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00126">compressed_square.cc:126</a></div></div>
</div><!-- fragment --><p> Finally, we define the gravitational body force.</p>
<div class="fragment"><div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Non-dim gravity</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Gravity</a>=0.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Non-dimensional gravity as body force</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a0777aef63372db7f91ad894c38159681">gravity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time, </div>
<div class="line">              <span class="keyword">const</span> Vector&lt;double&gt; &amp;xi,</div>
<div class="line">              Vector&lt;double&gt; &amp;b)</div>
<div class="line"> {</div>
<div class="line">  b[0]=0.0;</div>
<div class="line">  b[1]=-<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Gravity</a>;</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end namespace</span></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0777aef63372db7f91ad894c38159681"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0777aef63372db7f91ad894c38159681">Global_Physical_Variables::gravity</a></div><div class="ttdeci">void gravity(const double &amp;time, const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;b)</div><div class="ttdoc">Non-dimensional gravity as body force.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00132">compressed_square.cc:132</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a8b80d3e8d63b8d0a0ed435a2dd7fe2ad"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a></div><div class="ttdeci">double Gravity</div><div class="ttdoc">Non-dim gravity.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00129">compressed_square.cc:129</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="main"></a>
The driver code</h1>
<p>The driver code solves the problem with a large number of different formulations and constitutive equations. We start with the generalised Hookean constitutive equation and consider three different values of Poisson's ratio, corresponding to compressible, near-incompressible and incompressible behaviour:</p>
 <div class="fragment"><div class="line"><span class="comment">//=======start_of_main==================================================</span></div>
<div class="line"><span class="comment">/// Driver for compressed square</span></div>
<div class="line"><span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="compressed__square_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Flag to indicate if we want the material to be incompressible </span></div>
<div class="line"> <span class="keywordtype">bool</span> incompress=<span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Label for different cases</span></div>
<div class="line"> <span class="keywordtype">int</span> case_number=-1;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Generalised Hookean constitutive equations</span></div>
<div class="line"> <span class="comment">//===========================================</span></div>
<div class="line"> {</div>
<div class="line">  <span class="comment">// Nu values</span></div>
<div class="line">  Vector&lt;double&gt; nu_value(3);</div>
<div class="line">  nu_value[0]=0.45;</div>
<div class="line">  nu_value[1]=0.499999;</div>
<div class="line">  nu_value[2]=0.5;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Loop over nu values</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;3;i++)</div>
<div class="line">   {</div>
<div class="line">    <span class="comment">// Set Poisson ratio</span></div>
<div class="line">    <a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a>=nu_value[i];</div>
<div class="line">  </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;===========================================\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Doing Nu=&quot;</span> &lt;&lt;  <a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a> </div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;===========================================\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create constitutive equation</span></div>
<div class="line">    <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a> = </div>
<div class="line">     <span class="keyword">new</span> GeneralisedHookean(&amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a>);</div>
<div class="ttc" id="acompressed__square_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="compressed__square_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver for compressed square.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00421">compressed_square.cc:421</a></div></div>
</div><!-- fragment --><p> First, we solve the problem in the pure displacement formulation, using (the wrapped version of the) displacement-based <code>QPVDElements</code>. (As discussed above, the displacement formulation cannot be used for <img class="formulaInl" alt="$ \nu=1/2 $" src="form_38.png" width="43" height="14"/>.)</p>
<div class="fragment"><div class="line">    </div>
<div class="line">    <span class="comment">// Displacement-based formulation</span></div>
<div class="line">    <span class="comment">//--------------------------------</span></div>
<div class="line">    <span class="comment">// (not for nu=1/2, obviously)</span></div>
<div class="line">    <span class="keywordflow">if</span> (i!=2) </div>
<div class="line">     {</div>
<div class="line">      case_number++;</div>
<div class="line">      std::cout </div>
<div class="line">       &lt;&lt; <span class="stringliteral">&quot;Doing Generalised Hookean with displacement formulation: Case &quot;</span></div>
<div class="line">       &lt;&lt; case_number &lt;&lt; std::endl;</div>
<div class="line">      </div>
<div class="line">      <span class="comment">//Set up the problem with pure displacement based elements</span></div>
<div class="line">      incompress=<span class="keyword">false</span>;</div>
<div class="line">      <a class="code" href="classCompressedSquareProblem.html">CompressedSquareProblem&lt;MySolidElement&lt;QPVDElement&lt;2,3&gt;</a> &gt; &gt; </div>
<div class="line">       problem(incompress);</div>
<div class="line">      </div>
<div class="line">      <span class="comment">// Run it</span></div>
<div class="line">      problem.run_it(case_number,incompress);</div>
<div class="line">     }</div>
<div class="ttc" id="aclassCompressedSquareProblem_html"><div class="ttname"><a href="classCompressedSquareProblem.html">CompressedSquareProblem</a></div><div class="ttdoc">Problem class.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00148">compressed_square.cc:149</a></div></div>
</div><!-- fragment --><p> Next we consider the pressure/displacement formulation with continuous pressures (Taylor-Hood), using the <br  />
 <code>QPVDElementWithContinuousPressure</code> element.</p>
<div class="fragment"><div class="line">    </div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Generalised Hookean with continuous pressure, compressible</span></div>
<div class="line">    <span class="comment">//-----------------------------------------------------------</span></div>
<div class="line">    {</div>
<div class="line">     case_number++;</div>
<div class="line">     std::cout </div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Doing Generalised Hookean with displacement/cont pressure &quot;</span></div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;formulation: Case &quot;</span> &lt;&lt; case_number &lt;&lt; std::endl;     </div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Set up the problem with continous pressure/displacement</span></div>
<div class="line">     incompress=<span class="keyword">false</span>;</div>
<div class="line">     <a class="code" href="classCompressedSquareProblem.html">CompressedSquareProblem</a>&lt;MySolidElement&lt;</div>
<div class="line">      QPVDElementWithContinuousPressure&lt;2&gt; &gt; &gt; </div>
<div class="line">      problem(incompress); </div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Run it</span></div>
<div class="line">     problem.run_it(case_number,incompress);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> We suppress the listing of the remaining combinations (see the driver code <a href="../../../../demo_drivers/solid/compressed_square/compressed_square.cc">compressed_square.cc </a>for details):</p><ul>
<li>Pressure/displacement formulation with discontinuous pressures (Crouzeix-Raviart), using the <code>QPVDElementWithPressure</code> element.</li>
<li>Pressure/displacement formulation with continuous pressures (Taylor-Hood), using the <code>QPVDElementWithContinuousPressure</code> element, with true incompressibility enforced via formulation III.</li>
<li>Pressure/displacement formulation with discontinuous pressures (Crouzeix-Raviart), using the <code>QPVDElementWithPressure</code> element, with true incompressibility enforced via formulation III.</li>
</ul>
<p>Before the end of the loop over the different <img class="formulaInl" alt="$ \nu $" src="form_9.png" width="6" height="6"/> values we delete the constitutive equation, allowing it to be re-built with a different Poisson ratio.</p>
<div class="fragment"><div class="line">    <span class="comment">// Clean up</span></div>
<div class="line">    <span class="keyword">delete</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a>;</div>
<div class="line">    <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a>=0;</div>
<div class="line">    </div>
<div class="line">   } </div>
<div class="line"> </div>
<div class="line"> } <span class="comment">// end generalised Hookean</span></div>
</div><!-- fragment --><p> Next we build the strain-energy-based Mooney-Rivlin constitutive law</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Incompressible Mooney Rivlin</span></div>
<div class="line"> <span class="comment">//=============================</span></div>
<div class="line"> {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create strain energy function</span></div>
<div class="line">  <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a> = </div>
<div class="line">   <span class="keyword">new</span> MooneyRivlin(&amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a849754fa7155c1a31481674ce4845658">Global_Physical_Variables::C1</a>,</div>
<div class="line">                    &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#af9defd1b5745cce50d2c386b3ac0e0ae">Global_Physical_Variables::C2</a>);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Define a constitutive law (based on strain energy function)</span></div>
<div class="line">  <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a> = </div>
<div class="line">   <span class="keyword">new</span> IsotropicStrainEnergyFunctionConstitutiveLaw(</div>
<div class="line">    <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a>);</div>
</div><!-- fragment --><p> and solve the problem with <code>QPVDElementWithContinuousPressure</code> and <code>QPVDElementWithPressure</code> elements, enforcing true incompressibility enforced via formulation III by setting the <code>incompressible</code> flag to true.</p>
<div class="fragment"><div class="line">    </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mooney-Rivlin with continous pressure/displacement; </span></div>
<div class="line">  <span class="comment">//----------------------------------------------------</span></div>
<div class="line">  <span class="comment">// incompressible</span></div>
<div class="line">  <span class="comment">//---------------</span></div>
<div class="line">  {</div>
<div class="line">   case_number++;</div>
<div class="line">   std::cout </div>
<div class="line">    &lt;&lt; <span class="stringliteral">&quot;Doing Mooney Rivlin with cont pressure formulation: Case &quot;</span></div>
<div class="line">    &lt;&lt; case_number &lt;&lt; std::endl; </div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set up the problem with continous pressure/displacement</span></div>
<div class="line">   incompress=<span class="keyword">true</span>;</div>
<div class="line">   <a class="code" href="classCompressedSquareProblem.html">CompressedSquareProblem</a>&lt;MySolidElement&lt;</div>
<div class="line">    QPVDElementWithContinuousPressure&lt;2&gt; &gt; &gt; </div>
<div class="line">    problem(incompress); </div>
<div class="line">     </div>
<div class="line">   <span class="comment">// Run it</span></div>
<div class="line">   problem.run_it(case_number,incompress);</div>
<div class="line">  }</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mooney-Rivlin with discontinous pressure/displacement; </span></div>
<div class="line">  <span class="comment">//-------------------------------------------------------</span></div>
<div class="line">  <span class="comment">// incompressible</span></div>
<div class="line">  <span class="comment">//---------------</span></div>
<div class="line">  {</div>
<div class="line">   case_number++;</div>
<div class="line">   std::cout </div>
<div class="line">    &lt;&lt; <span class="stringliteral">&quot;Doing Mooney Rivlin with discont pressure formulation: Case &quot;</span></div>
<div class="line">    &lt;&lt; case_number &lt;&lt; std::endl; </div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set up the problem with discontinous pressure/displacement</span></div>
<div class="line">   incompress=<span class="keyword">true</span>;</div>
<div class="line">   <a class="code" href="classCompressedSquareProblem.html">CompressedSquareProblem</a>&lt;MySolidElement&lt;</div>
<div class="line">    QPVDElementWithPressure&lt;2&gt; &gt; &gt; </div>
<div class="line">    problem(incompress); </div>
<div class="line">     </div>
<div class="line">   <span class="comment">// Run it</span></div>
<div class="line">   problem.run_it(case_number,incompress);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Clean up</span></div>
<div class="line">  <span class="keyword">delete</span>  <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Physical__Variables.html#a73135f793690b4386bf83bbefc7bf310">Global_Physical_Variables::Strain_energy_function_pt</a>=0;</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">delete</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a>=0;</div>
<div class="line">  </div>
<div class="line"> }</div>
<div class="line">   </div>
<div class="line">} <span class="comment">//end of main</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="class"></a>
The Problem class</h1>
<p>The <code>Problem</code> class has the usual member functions. The <code>i_case</code> label is used to distinguish different cases while the boolean <code>incompressible</code> indicates if we wish to enforce incompressibility via formulation III.</p>
 <div class="fragment"><div class="line"><span class="comment">//=============begin_problem============================================ </span></div>
<div class="line"><span class="comment">/// Problem class</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code" href="classCompressedSquareProblem.html">CompressedSquareProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: Pass flag that determines if we want to use</span></div>
<div class="line"><span class="comment"> /// a true incompressible formulation</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classCompressedSquareProblem.html#af013df43f2a9f6ee8ff16cf59ddd9439">CompressedSquareProblem</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; incompress);</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classCompressedSquareProblem.html#afef46d13ff7c8b2845e96a84762077dc">actions_after_newton_solve</a>() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classCompressedSquareProblem.html#aed8338e212b31c56a5df20c222385e15">actions_before_newton_solve</a>() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Doc the solution &amp; exact (linear) solution for compressible </span></div>
<div class="line"><span class="comment"> /// or incompressible materials</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classCompressedSquareProblem.html#a34d511f377379122d65b2a1402898f5c">doc_solution</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; incompress);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Run the job -- doc in RESLTi_case</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classCompressedSquareProblem.html#a1543bb8bcba7bf3491e29d141faaf774">run_it</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; i_case,<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; incompress);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Trace file</span></div>
<div class="line"><span class="comment"></span> ofstream <a class="code" href="classCompressedSquareProblem.html#afc8bc8ff7811d18f8d59cd1c35e6cb00">Trace_file</a>;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Pointers to node whose position we&#39;re tracing</span></div>
<div class="line"><span class="comment"></span> Node* <a class="code" href="classCompressedSquareProblem.html#a0af6b1044a8392a3ae3d753f4db52664">Trace_node_pt</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// DocInfo object for output</span></div>
<div class="line"><span class="comment"></span> DocInfo <a class="code" href="classCompressedSquareProblem.html#a2269691c7bef351c87a4421d275fe7c3">Doc_info</a>;</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="ttc" id="aclassCompressedSquareProblem_html_a0af6b1044a8392a3ae3d753f4db52664"><div class="ttname"><a href="classCompressedSquareProblem.html#a0af6b1044a8392a3ae3d753f4db52664">CompressedSquareProblem::Trace_node_pt</a></div><div class="ttdeci">Node * Trace_node_pt</div><div class="ttdoc">Pointers to node whose position we're tracing.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00176">compressed_square.cc:176</a></div></div>
<div class="ttc" id="aclassCompressedSquareProblem_html_a1543bb8bcba7bf3491e29d141faaf774"><div class="ttname"><a href="classCompressedSquareProblem.html#a1543bb8bcba7bf3491e29d141faaf774">CompressedSquareProblem::run_it</a></div><div class="ttdeci">void run_it(const int &amp;i_case, const bool &amp;incompress)</div><div class="ttdoc">Run the job – doc in RESLTi_case.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00379">compressed_square.cc:379</a></div></div>
<div class="ttc" id="aclassCompressedSquareProblem_html_a2269691c7bef351c87a4421d275fe7c3"><div class="ttname"><a href="classCompressedSquareProblem.html#a2269691c7bef351c87a4421d275fe7c3">CompressedSquareProblem::Doc_info</a></div><div class="ttdeci">DocInfo Doc_info</div><div class="ttdoc">DocInfo object for output.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00179">compressed_square.cc:179</a></div></div>
<div class="ttc" id="aclassCompressedSquareProblem_html_a34d511f377379122d65b2a1402898f5c"><div class="ttname"><a href="classCompressedSquareProblem.html#a34d511f377379122d65b2a1402898f5c">CompressedSquareProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(const bool &amp;incompress)</div><div class="ttdoc">Doc the solution &amp; exact (linear) solution for compressible or incompressible materials.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00284">compressed_square.cc:284</a></div></div>
<div class="ttc" id="aclassCompressedSquareProblem_html_aed8338e212b31c56a5df20c222385e15"><div class="ttname"><a href="classCompressedSquareProblem.html#aed8338e212b31c56a5df20c222385e15">CompressedSquareProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update function (empty)</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00161">compressed_square.cc:161</a></div></div>
<div class="ttc" id="aclassCompressedSquareProblem_html_af013df43f2a9f6ee8ff16cf59ddd9439"><div class="ttname"><a href="classCompressedSquareProblem.html#af013df43f2a9f6ee8ff16cf59ddd9439">CompressedSquareProblem::CompressedSquareProblem</a></div><div class="ttdeci">CompressedSquareProblem(const bool &amp;incompress)</div><div class="ttdoc">Constructor: Pass flag that determines if we want to use a true incompressible formulation.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00189">compressed_square.cc:189</a></div></div>
<div class="ttc" id="aclassCompressedSquareProblem_html_afc8bc8ff7811d18f8d59cd1c35e6cb00"><div class="ttname"><a href="classCompressedSquareProblem.html#afc8bc8ff7811d18f8d59cd1c35e6cb00">CompressedSquareProblem::Trace_file</a></div><div class="ttdeci">ofstream Trace_file</div><div class="ttdoc">Trace file.</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00173">compressed_square.cc:173</a></div></div>
<div class="ttc" id="aclassCompressedSquareProblem_html_afef46d13ff7c8b2845e96a84762077dc"><div class="ttname"><a href="classCompressedSquareProblem.html#afef46d13ff7c8b2845e96a84762077dc">CompressedSquareProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update function (empty)</div><div class="ttdef"><b>Definition:</b> <a href="compressed__square_8cc_source.html#l00158">compressed_square.cc:158</a></div></div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="constructor"></a>
The Problem constructor</h1>
<p>We start by building the mesh &ndash; the <code>SolidMesh</code> version of the <code>ElasticRectangularQuadMesh</code>.</p>
<div class="fragment"><div class="line"><span class="comment">//===========start_of_constructor======================================= </span></div>
<div class="line"><span class="comment">/// Constructor: Pass flag that determines if we want to enforce</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// incompressibility</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a class="code" href="classCompressedSquareProblem.html#af013df43f2a9f6ee8ff16cf59ddd9439">CompressedSquareProblem&lt;ELEMENT&gt;::CompressedSquareProblem</a>(</div>
<div class="line"> <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; incompress)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create the mesh</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// # of elements in x-direction</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_x=5;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// # of elements in y-direction</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_y=5;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Domain length in x-direction</span></div>
<div class="line"> <span class="keywordtype">double</span> l_x=1.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Domain length in y-direction</span></div>
<div class="line"> <span class="keywordtype">double</span> l_y=1.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Now create the mesh </span></div>
<div class="line"> mesh_pt() = <span class="keyword">new</span> ElasticRectangularQuadMesh&lt;ELEMENT&gt;(n_x,n_y,l_x,l_y);</div>
</div><!-- fragment --><p> We complete the build of the elements by specifying the constitutive equation and the gravitational body force.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Assign the physical properties to the elements</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element=mesh_pt()-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_element;i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Cast to a solid element</span></div>
<div class="line">   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(i));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Set the constitutive law</span></div>
<div class="line">   el_pt-&gt;constitutive_law_pt() =</div>
<div class="line">    <a class="code" href="namespaceGlobal__Physical__Variables.html#a2a37fb040c832ee7a086bb13bb02a100">Global_Physical_Variables::Constitutive_law_pt</a>;</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Set the body force</span></div>
<div class="line">   el_pt-&gt;body_force_fct_pt() = <a class="code" href="namespaceGlobal__Physical__Variables.html#a0777aef63372db7f91ad894c38159681">Global_Physical_Variables::gravity</a>;</div>
</div><!-- fragment --><p> If the element is based on the pressure/displacement form of the principle of virtual displacements we enforce (true) incompressibility if required. Note that, by default, <code>oomph-lib's</code> pressure/displacement-based solid mechanics elements do not assume incompressibility, i.e. the default is to use formulation II.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Is the element based on the pressure/displacement formulation?</span></div>
<div class="line">   PVDEquationsWithPressure&lt;2&gt;* test_pt = </div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span>PVDEquationsWithPressure&lt;2&gt;*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(i));</div>
<div class="line">   <span class="keywordflow">if</span> (test_pt!=0)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// Do we want true incompressibility (formulation III in the </span></div>
<div class="line">     <span class="comment">// associated tutorial) or not (formulation II)</span></div>
<div class="line">     <span class="keywordflow">if</span> (incompress)</div>
<div class="line">      {     </div>
<div class="line">       test_pt-&gt;set_incompressible();</div>
<div class="line">      }</div>
<div class="line">     <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">       <span class="comment">// Note that this assignment isn&#39;t strictly necessary as it&#39;s the</span></div>
<div class="line">       <span class="comment">// default setting, but it doesn&#39;t do any harm to be explicit.</span></div>
<div class="line">       test_pt-&gt;set_compressible();</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  } <span class="comment">// end compressibility</span></div>
</div><!-- fragment --><p> Finally, we pick a control node to document the solid's load-displacement characteristics and apply the boundary conditions (no displacements normal to the "slippery" walls) before setting up the equation numbering scheme.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Choose a control node: The last node in the solid mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nnod=mesh_pt()-&gt;nnode();</div>
<div class="line"> Trace_node_pt=mesh_pt()-&gt;node_pt(nnod-1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Pin the left and right boundaries (1 and 2) in the horizontal directions</span></div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> b=1;b&lt;4;b+=2)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> nnod = mesh_pt()-&gt;nboundary_node(b);</div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;nnod;i++)</div>
<div class="line">    {</div>
<div class="line">     <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(</div>
<div class="line">      mesh_pt()-&gt;boundary_node_pt(b,i))-&gt;pin_position(0);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Pin the bottom boundary (0) in the vertical direction</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=0;</div>
<div class="line"> {</div>
<div class="line">  <span class="keywordtype">unsigned</span> nnod= mesh_pt()-&gt;nboundary_node(b);</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;nnod;i++)</div>
<div class="line">   {</div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span>SolidNode*<span class="keyword">&gt;</span>(</div>
<div class="line">     mesh_pt()-&gt;boundary_node_pt(b,i))-&gt;pin_position(1);</div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Assign equation numbers</span></div>
<div class="line"> assign_eqn_numbers();</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end of constructor</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="doc"></a>
Post-processing</h1>
<p>The post-processing routine documents the load-displacement characteristics in a trace file and outputs the deformed domain shape.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//==============start_doc===========================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Doc the solution</span></div>
<div class="line"><span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCompressedSquareProblem.html#a34d511f377379122d65b2a1402898f5c">CompressedSquareProblem&lt;ELEMENT&gt;::doc_solution</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; incompress)</div>
<div class="line">{</div>
<div class="line"> ofstream some_file;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of plot points</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_plot = 5; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output shape of and stress in deformed body</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> mesh_pt()-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Write trace file: Load/displacement characteristics</span></div>
<div class="line"> Trace_file &lt;&lt; <a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a>  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line">            &lt;&lt; Trace_node_pt-&gt;x(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line">            &lt;&lt; Trace_node_pt-&gt;x(1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line">            &lt;&lt; std::endl;</div>
</div><!-- fragment --><p> We then output the exact solution of the linearised equations using the same format as in the element's overloaded output function.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output exact solution for linear elasticity</span></div>
<div class="line"> <span class="comment">// -------------------------------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/exact_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> <span class="keywordtype">unsigned</span> nelem=mesh_pt()-&gt;nelement(); </div>
<div class="line"> Vector&lt;double&gt; s(2);</div>
<div class="line"> Vector&lt;double&gt; x(2);</div>
<div class="line"> DenseMatrix&lt;double&gt; sigma(2,2);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Poisson&#39;s ratio</span></div>
<div class="line"> <span class="keywordtype">double</span> nu=<a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a>;</div>
<div class="line"> <span class="keywordflow">if</span> (incompress) nu=0.5;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over all elements</span></div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nelem;e++)</div>
<div class="line">  {  </div>
<div class="line">   <span class="comment">//Cast to a solid element</span></div>
<div class="line">   ELEMENT* el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(e));</div>
<div class="line">    </div>
<div class="line">   <span class="comment">//Tecplot header info </span></div>
<div class="line">   some_file &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; n_plot &lt;&lt; <span class="stringliteral">&quot;, J=&quot;</span> &lt;&lt; n_plot &lt;&lt; std::endl;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Loop over plot points</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_plot;l2++)</div>
<div class="line">    {</div>
<div class="line">     s[1] = -1.0 + l2*2.0/(n_plot-1);</div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l1=0;l1&lt;n_plot;l1++)</div>
<div class="line">      {</div>
<div class="line">       s[0] = -1.0 + l1*2.0/(n_plot-1);</div>
<div class="line">       </div>
<div class="line">       <span class="comment">// Get Lagrangian coordinates</span></div>
<div class="line">         el_pt-&gt;interpolated_x(s,x);</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Output the x,y,..</span></div>
<div class="line">         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++) </div>
<div class="line">          {some_file &lt;&lt; x[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;}</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Exact vertical displacement</span></div>
<div class="line">         <span class="keywordtype">double</span> v_exact=<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a>*</div>
<div class="line">          (1.0+nu)*(1.0-2*nu)/(1.0-nu)*(0.5*x[1]*x[1]-x[1]);</div>
<div class="line">         </div>
<div class="line">         <span class="comment">// x and y displacement</span></div>
<div class="line">         some_file &lt;&lt; <span class="stringliteral">&quot;0.0 &quot;</span> &lt;&lt;   v_exact &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"> </div>
<div class="line">         <span class="comment">// Stresses</span></div>
<div class="line">         sigma(0,0)=nu/(1.0-nu)*<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a>*(x[1]-1.0);</div>
<div class="line">         sigma(1,0)=0.0;</div>
<div class="line">         sigma(1,1)=<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a>*(x[1]-1.0);</div>
<div class="line">          </div>
<div class="line">         <span class="comment">// Output linear stress tensor</span></div>
<div class="line">         some_file &lt;&lt; sigma(0,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">                   &lt;&lt; sigma(1,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">                   &lt;&lt; sigma(1,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">                   &lt;&lt; std::endl;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Increment label for output files</span></div>
<div class="line"> Doc_info.number()++;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end doc</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="comm_ex"></a>
Comments and Exercises</h1>
<p>As usual, <code>oomph-lib</code> provides self-tests that assess if the enforcement incompressibility (or the lack thereof) is consistent:</p><ul>
<li>The compiler will not allow the user to enforce incompressibility on elements that are based on the displacement form of the principle of virtual displacements. This is because the displacement-based elements do not have a member function <code>incompressible()</code>. <br  />
<br  />
</li>
<li>Certain constitutive laws, such as the Mooney-Rivlin law used in the present example require an incompressible formulation. If <code>oomph-lib</code> is compiled with the <code>PARANOID</code> flag, an error is thrown if such a constitutive law is used by an element for which incompressibility has not been requested. <br  />
<br  />
 <center> <b>Recall that the default setting is not to enforce incompressibility!</b> </center> <br  />
 If the library is compiled without the <code>PARANOID</code> flag no warning will be issued but the results will be "wrong" at least in the sense that the material does not behave like an incompressible Mooney-Rivlin solid. In fact, it is likely that the Newton solver will diverge. Anyway, as we keep saying, without the <code>PARANOID</code> flag, you're on your own! <br  />
<br  />
</li>
</ul>
<p>You should experiment with different combinations of constitutive laws and element types to familiarise yourself with these issues.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
<center> <a href="../../../../demo_drivers/solid/compressed_square/">demo_drivers/solid/compressed_square/ </a> </center><br  />
</li>
<li>The driver code is: <br  />
<br  />
<center> <a href="../../../../demo_drivers/solid/compressed_square/compressed_square.cc">demo_drivers/solid/compressed_square/compressed_square.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Dec 19 2024 11:27:50
        </div>
      </div>
    </footer>
</body>
</html>

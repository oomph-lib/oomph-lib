<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Demo problem: Solid Mechanics using unstructured meshes</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Demo problem: Solid Mechanics using unstructured meshes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The purpose of this tutorial is to demonstrate the solution of solid mechanics problems using unstructured meshes. We focus primarily on two-dimensional meshes, generated using <a href="http://www.cs.berkeley.edu/~jrs/">Jonathan Shewchuk's</a> open-source mesh generator <a href="http://www.cs.cmu.edu/~quake/triangle.html"><code>Triangle</code>,</a> based on the output from the open-source drawing program <a href="http://en.wikipedia.org/wiki/Xfig">xfig.</a> An example three-dimensional problem is described <a href="../../unstructured_three_d_solid/html/index.html">here; </a> see also <a class="el" href="index.html#three_d">3D Problems</a> later in this document.</p>
<p>The solid mechanics problem studied here also serves as a "warm-up problem" for the <a href="../../../interaction/unstructured_fsi/html/index.html">corresponding fluid-structure interaction problem </a> in which the solid object is immersed in (and loaded by) a viscous fluid.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="problem"></a>
The problem</h1>
<p>Here is a sketch of the problem: A slightly strange-looking elastic solid is loaded by gravity and by a pressure load, acting on its upper face.</p>
<div class="image">
<img src="solid_sketch.gif" alt=""/>
<div class="caption">
Sketch of the problem. </div></div>
 <hr  />
 <hr  />
<h1><a class="anchor" id="mesh"></a>
Mesh generation</h1>
<p>We employ the combination of <a href="http://en.wikipedia.org/wiki/Xfig">xfig</a>, <code>oomph-lib's</code> conversion code <a href="../../../meshes/mesh_from_xfig/html/index.html"><code>fig2poly</code> </a>, and the unstructured mesh generator <a href="http://www.cs.cmu.edu/~quake/triangle.html"><code>Triangle</code> </a> to generate the mesh, using the procedure discussed in <a href="../../../meshes/mesh_from_xfig/html/index.html">another tutorial.</a></p>
<p>We start by drawing the outline of the solid as a polyline in <a href="http://en.wikipedia.org/wiki/Xfig">xfig</a>:</p>
<div class="image">
<img src="xfig_screenshot.gif" alt=""/>
<div class="caption">
xfig drawing of the solid body. </div></div>
 <p>(Note that we draw the solid upside-down because of the way <a href="http://en.wikipedia.org/wiki/Xfig">xfig</a> orients its coordinate axes.)</p>
<p>We save the figure as a *.fig file and convert it to a *.poly file using <code>oomph-lib's</code> conversion code <a href="../../../meshes/mesh_from_xfig/html/index.html"><code>fig2poly</code> </a> (a copy of which is located in <code>oomph-lib's</code> <code>bin</code> directory):</p>
<div class="fragment"><div class="line">fig3poly solid.fig </div>
</div><!-- fragment --><p>This creates a file called <code>solid.fig.poly</code> that can be processed using Triangle. For instance, to create a quality mesh with a maximum element size of 0.025 we use </p><div class="fragment"><div class="line">triangle -q -a0.025 solid.fig.poly</div>
</div><!-- fragment --><p>Here is a plot of the mesh, generated by <code>showme</code> distributed with <a href="http://www.cs.cmu.edu/~quake/triangle.html"><code>Triangle</code> </a>:</p>
<div class="image">
<img src="showme_screenshot.gif" alt=""/>
<div class="caption">
Visualisation of the mesh with showme. </div></div>
 <p>The <code> *.poly, *.ele </code> and <code> *.node </code> files generated by <a href="http://www.cs.cmu.edu/~quake/triangle.html"><code>Triangle</code> </a> can now be used as input to <code>oomph-lib's</code> <code>TriangleMesh</code> class.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>The animation shown below illustrates the solid's deformation. The first frame shows the undeformed, stress-free reference configuration; the second frame shows the deformation induced by gravity. Subsequent frames illustrate the deformation in response to the (additional) increasing "suction" applied at the upper face.</p>
<div class="image">
<img src="two_d.gif" alt=""/>
<div class="caption">
Plot of the deformation. </div></div>
 <p>The blue markers show the position of pinned nodes.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="mesh_code"></a>
Creating the mesh</h1>
<p>We create the mesh by multiple inheritance from <code>oomph-lib's</code> <code>TriangleMesh</code> and the <code>SolidMesh</code> base class:</p>
 <div class="fragment"><div class="line"><span class="comment">//================start_mesh===============================================</span></div>
<div class="line"><span class="comment">/// Triangle-based mesh upgraded to become a solid mesh</span></div>
<div class="line"><span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code" href="classElasticTriangleMesh.html">ElasticTriangleMesh</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> TriangleMesh&lt;ELEMENT&gt;, </div>
<div class="line">                            <span class="keyword">public</span> <span class="keyword">virtual</span> SolidMesh </div>
<div class="line">{</div>
<div class="ttc" id="aclassElasticTriangleMesh_html"><div class="ttname"><a href="classElasticTriangleMesh.html">ElasticTriangleMesh</a></div><div class="ttdoc">Triangle-based mesh upgraded to become a solid mesh.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__two__d__solid_8cc_source.html#l00047">unstructured_two_d_solid.cc:49</a></div></div>
</div><!-- fragment --><p> The constructor calls the constructor of the underlying <code>TriangleMesh</code>, and, as usual, sets the Lagrangian coordinates to the current nodal positions, making the current configuration stress-free.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Constructor: </span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classElasticTriangleMesh.html">ElasticTriangleMesh</a>(<span class="keyword">const</span> std::string&amp; node_file_name,</div>
<div class="line">                     <span class="keyword">const</span> std::string&amp; element_file_name,</div>
<div class="line">                     <span class="keyword">const</span> std::string&amp; poly_file_name,</div>
<div class="line">                     TimeStepper* time_stepper_pt=</div>
<div class="line">                     &amp;Mesh::Default_TimeStepper) : </div>
<div class="line"> TriangleMesh&lt;ELEMENT&gt;(node_file_name,element_file_name,</div>
<div class="line">                       poly_file_name, time_stepper_pt)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Assign the Lagrangian coordinates</span></div>
<div class="line">   set_lagrangian_nodal_coordinates();</div>
</div><!-- fragment --><p> The <code>TriangleMesh</code> constructor associates each polyline in the <code>xfig</code> drawing with a distinct <code>oomph-lib</code> mesh boundary. Hence the boundary nodes are initially located on the same, single boundary. To facilitate the application of boundary conditions, we divide the single boundary into three:</p>
<div class="fragment"><div class="line"> </div>
<div class="line">   <span class="comment">// Identify special boundaries</span></div>
<div class="line">   set_nboundary(3);</div>
</div><!-- fragment --><p> We loop over all nodes in the mesh and identify nodes on the lower (pinned) boundary by their y-coordinate. We remove the node from the boundary 0 and re-allocate it to the new boundary 1:</p>
<div class="fragment"><div class="line"> </div>
<div class="line">   <span class="keywordtype">unsigned</span> n_node=this-&gt;nnode();</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0;j&lt;n_node;j++)</div>
<div class="line">    {</div>
<div class="line">     Node* nod_pt=this-&gt;node_pt(j);</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// Boundary 1 is lower boundary</span></div>
<div class="line">     <span class="keywordflow">if</span> (nod_pt-&gt;x(1)&lt;0.15)</div>
<div class="line">      {</div>
<div class="line">       this-&gt;remove_boundary_node(0,nod_pt);</div>
<div class="line">       this-&gt;add_boundary_node(1,nod_pt);</div>
<div class="line">      }</div>
</div><!-- fragment --><p> Similarly, we identify all nodes on the upper boundary and re-assign them to boundary 2, before re-generating the various boundary lookup schemes that identify which elements are located next to the various mesh boundaries:</p>
<div class="fragment"><div class="line"> </div>
<div class="line">     <span class="comment">// Boundary 2 is upper boundary</span></div>
<div class="line">     <span class="keywordflow">if</span> (nod_pt-&gt;x(1)&gt;2.69)</div>
<div class="line">      {</div>
<div class="line">       this-&gt;remove_boundary_node(0,nod_pt);</div>
<div class="line">       this-&gt;add_boundary_node(2,nod_pt);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   std::cout &lt;&lt; <span class="stringliteral">&quot;About to setup the boundary elements&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">   <span class="comment">// Re-setup boundary info, i.e. elements next to boundaries</span></div>
<div class="line">   TriangleMesh&lt;ELEMENT&gt;::setup_boundary_element_info();</div>
<div class="line">   <span class="comment">//This is the bit that has gone wrong</span></div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Empty Destructor</span></div>
<div class="line"><span class="comment"></span> <span class="keyword">virtual</span> ~<a class="code" href="classElasticTriangleMesh.html">ElasticTriangleMesh</a>() { }</div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="namespace"></a>
Problem Parameters</h1>
<p>As usual we define the various problem parameters in a global namespace. We define Poisson's ratio and prepare a pointer to a constitutive equation.</p>
<div class="fragment"><div class="line"><span class="comment">//=======start_namespace==========================================</span></div>
<div class="line"><span class="comment">/// Global variables</span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line">{<span class="comment"></span></div>
<div class="line"><span class="comment"> /// Poisson&#39;s ratio</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Nu</a>=0.3;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to constitutive law</span></div>
<div class="line"><span class="comment"></span> ConstitutiveLaw* <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Constitutive_law_pt</a>=0;</div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">//////////////////////////////////////////////////////////////////// ////////////////////////////////...</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00112">unstructured_three_d_solid.cc:113</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a3962c36313826b19f216f6bbbdd6a477"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Poisson's ratio.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00119">unstructured_three_d_solid.cc:119</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a5d5f19442938130d36ee7476ae25049c"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a></div><div class="ttdeci">ConstitutiveLaw * Constitutive_law_pt</div><div class="ttdoc">Pointer to constitutive law.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00116">unstructured_three_d_solid.cc:116</a></div></div>
</div><!-- fragment --><p> Next we define the gravitational body force</p>
<div class="fragment"><div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Non-dim gravity</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Gravity</a>=0.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Non-dimensional gravity as body force</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a0777aef63372db7f91ad894c38159681">gravity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; time, </div>
<div class="line">              <span class="keyword">const</span> Vector&lt;double&gt; &amp;xi, </div>
<div class="line">              Vector&lt;double&gt; &amp;b)</div>
<div class="line"> {</div>
<div class="line">  b[0]=0.0;</div>
<div class="line">  b[1]=-<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Gravity</a>;</div>
<div class="line"> }</div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0777aef63372db7f91ad894c38159681"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0777aef63372db7f91ad894c38159681">Global_Physical_Variables::gravity</a></div><div class="ttdeci">void gravity(const double &amp;time, const Vector&lt; double &gt; &amp;xi, Vector&lt; double &gt; &amp;b)</div><div class="ttdoc">Non-dimensional gravity as body force.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00125">unstructured_three_d_solid.cc:125</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a8b80d3e8d63b8d0a0ed435a2dd7fe2ad"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a></div><div class="ttdeci">double Gravity</div><div class="ttdoc">Non-dim gravity.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00122">unstructured_three_d_solid.cc:122</a></div></div>
</div><!-- fragment --><p> and the pressure load to be applied at the upper boundary</p>
<div class="fragment"><div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Uniform pressure</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">P</a> = 0.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constant pressure load. The arguments to this function are imposed</span></div>
<div class="line"><span class="comment"> /// on us by the SolidTractionElements which allow the traction to </span></div>
<div class="line"><span class="comment"> /// depend on the Lagrangian and Eulerian coordinates x and xi, and on the </span></div>
<div class="line"><span class="comment"> /// outer unit normal to the surface. Here we only need the outer unit</span></div>
<div class="line"><span class="comment"> /// normal.</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a19f4e20a92e7d216b4d2b00308f96917">constant_pressure</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;xi, <span class="keyword">const</span> Vector&lt;double&gt; &amp;x,</div>
<div class="line">                        <span class="keyword">const</span> Vector&lt;double&gt; &amp;n, Vector&lt;double&gt; &amp;traction)</div>
<div class="line"> {</div>
<div class="line">  <span class="keywordtype">unsigned</span> dim = traction.size();</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;dim;i++)</div>
<div class="line">   {</div>
<div class="line">    traction[i] = -<a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">P</a>*n[i];</div>
<div class="line">   }</div>
<div class="line"> } </div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end namespace</span></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a19f4e20a92e7d216b4d2b00308f96917"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a19f4e20a92e7d216b4d2b00308f96917">Global_Physical_Variables::constant_pressure</a></div><div class="ttdeci">void constant_pressure(const Vector&lt; double &gt; &amp;xi, const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; double &gt; &amp;traction)</div><div class="ttdoc">Constant pressure load. The arguments to this function are imposed on us by the SolidTractionElements...</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00142">unstructured_three_d_solid.cc:142</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a23c2ade6398f54040b869f7f3a2bcc4b"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a></div><div class="ttdeci">double P</div><div class="ttdoc">Uniform pressure.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00135">unstructured_three_d_solid.cc:135</a></div></div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="main"></a>
The driver code</h1>
<p>The driver code is straightforward. We specify an output directory and instantiate a constitutive equation. (Recall that the single-argument constructor to the <code>GeneralisedHookean</code> constitutive law implies that all stresses are non-dimensionalised on Young's modulus <img class="formulaInl" alt="$ E $" src="form_0.png" width="10" height="9"/>).</p>
 <div class="fragment"><div class="line"><span class="comment">//===========start_main===================================================</span></div>
<div class="line"><span class="comment">/// Demonstrate how to solve an unstructured solid problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="unstructured__two__d__solid_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Label for output</span></div>
<div class="line"> DocInfo doc_info;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output directory</span></div>
<div class="line"> doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create generalised Hookean constitutive equations</span></div>
<div class="line"> <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a> = </div>
<div class="line">  <span class="keyword">new</span> GeneralisedHookean(&amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a3962c36313826b19f216f6bbbdd6a477">Global_Physical_Variables::Nu</a>);</div>
<div class="ttc" id="aunstructured__two__d__solid_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="unstructured__two__d__solid_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Demonstrate how to solve an unstructured solid problem.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__two__d__solid_8cc_source.html#l00328">unstructured_two_d_solid.cc:328</a></div></div>
</div><!-- fragment --><p> We create the <code>Problem</code> object using a displacement formulation of the equations and output the initial configuration</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> {</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Running with pure displacement formulation\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Set up the problem</span></div>
<div class="line">  <a class="code" href="classUnstructuredSolidProblem.html">UnstructuredSolidProblem&lt;TPVDElement&lt;2,3&gt;</a> &gt; problem;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Output initial configuration</span></div>
<div class="line">  problem.<a class="code" href="classUnstructuredSolidProblem.html#ab3d66fd61b69d12b4f159d763fc44f15">doc_solution</a>(doc_info);</div>
<div class="line">  doc_info.number()++;</div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html"><div class="ttname"><a href="classUnstructuredSolidProblem.html">UnstructuredSolidProblem</a></div><div class="ttdoc">Unstructured solid problem.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00164">unstructured_three_d_solid.cc:165</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_ab3d66fd61b69d12b4f159d763fc44f15"><div class="ttname"><a href="classUnstructuredSolidProblem.html#ab3d66fd61b69d12b4f159d763fc44f15">UnstructuredSolidProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00302">unstructured_three_d_solid.cc:302</a></div></div>
</div><!-- fragment --><p> Finally, we perform a straightforward parameter study, applying a constant gravitational load and slowly increasing the suction (negative pressure) on the upper boundary.</p>
<div class="fragment"><div class="line">  </div>
<div class="line">  <span class="comment">// Parameter study</span></div>
<div class="line">  <a class="code" href="namespaceGlobal__Physical__Variables.html#a8b80d3e8d63b8d0a0ed435a2dd7fe2ad">Global_Physical_Variables::Gravity</a>=2.0e-4;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>=0.0;</div>
<div class="line">  <span class="keywordtype">double</span> pressure_increment=-1.0e-4;</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">unsigned</span> nstep=2; <span class="comment">// 10;</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line">   {</div>
<div class="line">    <span class="comment">// Solve the problem</span></div>
<div class="line">    problem.newton_solve();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Output solution</span></div>
<div class="line">    problem.<a class="code" href="classUnstructuredSolidProblem.html#ab3d66fd61b69d12b4f159d763fc44f15">doc_solution</a>(doc_info);</div>
<div class="line">    doc_info.number()++;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Bump up suction</span></div>
<div class="line">    <a class="code" href="namespaceGlobal__Physical__Variables.html#a23c2ade6398f54040b869f7f3a2bcc4b">Global_Physical_Variables::P</a>+=pressure_increment;</div>
<div class="line">   }</div>
<div class="line"> } <span class="comment">//end_displacement_formulation</span></div>
</div><!-- fragment --><p> The parameter study is then repeated for a pressure-displacement formulation with and without an incompressibility constraint, see the <a href="../../../../demo_drivers/solid/unstructured_solid/unstructured_two_d_solid.cc">source code </a> for details.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="class"></a>
The Problem class</h1>
<p>The <code>Problem</code> class has the usual member functions and provides storage for the two sub-meshes: the bulk mesh of 2D solid elements and the mesh of 1D traction elements that will be attached to the upper boundary.</p>
 <div class="fragment"><div class="line"><span class="comment">//==============start_problem=========================================</span></div>
<div class="line"><span class="comment">/// Unstructured solid problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt; </div>
<div class="line"><span class="keyword">class </span><a class="code" href="classUnstructuredSolidProblem.html">UnstructuredSolidProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: </span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">UnstructuredSolidProblem</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classUnstructuredSolidProblem.html#a25fe105d949498bf8f7c15aff96a7d00">~UnstructuredSolidProblem</a>(){}</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Doc the solution</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classUnstructuredSolidProblem.html#ab3d66fd61b69d12b4f159d763fc44f15">doc_solution</a>(DocInfo&amp; doc_info);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Bulk mesh</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classElasticTriangleMesh.html">ElasticTriangleMesh&lt;ELEMENT&gt;</a>* <a class="code" href="classUnstructuredSolidProblem.html#a09c0a07feb1586f2cca3766b4ac92099">Solid_mesh_pt</a>;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Pointer to mesh of traction elements</span></div>
<div class="line"><span class="comment"></span> SolidMesh* <a class="code" href="classUnstructuredSolidProblem.html#ade114e509464031ba8657600584b9743">Traction_mesh_pt</a>;</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a09c0a07feb1586f2cca3766b4ac92099"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a09c0a07feb1586f2cca3766b4ac92099">UnstructuredSolidProblem::Solid_mesh_pt</a></div><div class="ttdeci">ElasticTetMesh&lt; ELEMENT &gt; * Solid_mesh_pt</div><div class="ttdoc">Bulk mesh.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00187">unstructured_three_d_solid.cc:187</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a18ce02b6e4bbc86403c9e1b32c095772"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">UnstructuredSolidProblem::UnstructuredSolidProblem</a></div><div class="ttdeci">UnstructuredSolidProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00200">unstructured_three_d_solid.cc:201</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_a25fe105d949498bf8f7c15aff96a7d00"><div class="ttname"><a href="classUnstructuredSolidProblem.html#a25fe105d949498bf8f7c15aff96a7d00">UnstructuredSolidProblem::~UnstructuredSolidProblem</a></div><div class="ttdeci">~UnstructuredSolidProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00173">unstructured_three_d_solid.cc:173</a></div></div>
<div class="ttc" id="aclassUnstructuredSolidProblem_html_ade114e509464031ba8657600584b9743"><div class="ttname"><a href="classUnstructuredSolidProblem.html#ade114e509464031ba8657600584b9743">UnstructuredSolidProblem::Traction_mesh_pt</a></div><div class="ttdeci">SolidMesh * Traction_mesh_pt</div><div class="ttdoc">Pointer to mesh of traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__three__d__solid_8cc_source.html#l00190">unstructured_three_d_solid.cc:190</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="constructor"></a>
The Problem constructor</h1>
<p>We start by building the bulk mesh, using the files created by <a href="http://www.cs.cmu.edu/~quake/triangle.html"><code>Triangle</code> </a>.</p>
<div class="fragment"><div class="line"><span class="comment">//===============start_constructor========================================</span></div>
<div class="line"><span class="comment">/// Constructor for unstructured solid problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a class="code" href="classUnstructuredSolidProblem.html#a18ce02b6e4bbc86403c9e1b32c095772">UnstructuredSolidProblem&lt;ELEMENT&gt;::UnstructuredSolidProblem</a>()</div>
<div class="line">{  </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Create solid mesh</span></div>
<div class="line"> <span class="keywordtype">string</span> node_file_name=<span class="stringliteral">&quot;solid.fig.1.node&quot;</span>;</div>
<div class="line"> <span class="keywordtype">string</span> element_file_name=<span class="stringliteral">&quot;solid.fig.1.ele&quot;</span>;</div>
<div class="line"> <span class="keywordtype">string</span> poly_file_name=<span class="stringliteral">&quot;solid.fig.1.poly&quot;</span>; </div>
<div class="line"> Solid_mesh_pt = <span class="keyword">new</span> <a class="code" href="classElasticTriangleMesh.html">ElasticTriangleMesh&lt;ELEMENT&gt;</a>(node_file_name,</div>
<div class="line">                                                  element_file_name,</div>
<div class="line">                                                  poly_file_name);</div>
</div><!-- fragment --><p> Next we create traction elements, attaching them to the "bulk" solid elements that are adjacent to boundary 2. We also specify the load function.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Traction elements are located on boundary 2:</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=2;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Make traction mesh</span></div>
<div class="line"> Traction_mesh_pt=<span class="keyword">new</span> SolidMesh;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Solid_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">   ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">    Solid_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">   <span class="keywordtype">int</span> face_index = Solid_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Create solid traction element</span></div>
<div class="line">   SolidTractionElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line">    <span class="keyword">new</span> SolidTractionElement&lt;ELEMENT&gt;(bulk_elem_pt,face_index);   </div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Add to mesh</span></div>
<div class="line">   Traction_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Set the traction function</span></div>
<div class="line">   el_pt-&gt;traction_fct_pt() = <a class="code" href="namespaceGlobal__Physical__Variables.html#a19f4e20a92e7d216b4d2b00308f96917">Global_Physical_Variables::constant_pressure</a>;</div>
<div class="line">  }  </div>
</div><!-- fragment --><p> We add both meshes as sub-meshes to the <code>Problem</code> and build the global mesh</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Add sub meshes</span></div>
<div class="line"> add_sub_mesh(Solid_mesh_pt);</div>
<div class="line"> add_sub_mesh(Traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build global mesh</span></div>
<div class="line"> build_global_mesh();</div>
</div><!-- fragment --><p> Next we apply the boundary conditions at the lower boundary where we suppress the displacements in both directions. We document the position of the pinned nodes to allow us to check that the boundary IDs were identified correctly &ndash; see <a class="el" href="index.html#comm_ex">Comments and Exercises</a> for a further discussion of this issue.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Doc pinned solid nodes</span></div>
<div class="line"> std::ofstream bc_file(<span class="stringliteral">&quot;pinned_nodes.dat&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Pin both positions at lower boundary (boundary 1)</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> ibound=1;</div>
<div class="line"> <span class="keywordtype">unsigned</span> num_nod= mesh_pt()-&gt;nboundary_node(ibound);</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inod=0;inod&lt;num_nod;inod++)</div>
<div class="line">  {  </div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Get node</span></div>
<div class="line">   SolidNode* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(ibound,inod);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Pin both directions</span></div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line">    {</div>
<div class="line">     nod_pt-&gt;pin_position(i);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// ...and doc it as pinned</span></div>
<div class="line">     bc_file &lt;&lt; nod_pt-&gt;x(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   bc_file &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> bc_file.close();</div>
</div><!-- fragment --><p> Finally, we complete the build of the solid elements by specifying their constitutive equation and the body force before assigning the equation numbers.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete the build of all elements so they are fully functional</span></div>
<div class="line"> n_element = Solid_mesh_pt-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_element;i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Cast to a solid element</span></div>
<div class="line">   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Solid_mesh_pt-&gt;element_pt(i));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Set the constitutive law</span></div>
<div class="line">   el_pt-&gt;constitutive_law_pt() =</div>
<div class="line">    <a class="code" href="namespaceGlobal__Physical__Variables.html#a5d5f19442938130d36ee7476ae25049c">Global_Physical_Variables::Constitutive_law_pt</a>;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set the body force</span></div>
<div class="line">   el_pt-&gt;body_force_fct_pt() = <a class="code" href="namespaceGlobal__Physical__Variables.html#a0777aef63372db7f91ad894c38159681">Global_Physical_Variables::gravity</a>;</div>
<div class="line">  }</div>
<div class="line">   </div>
<div class="line"> <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"> cout &lt;&lt;<span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end constructor</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="doc"></a>
Post-processing</h1>
<p>The post-processing routine outputs the deformed domain shape and the applied traction. In the spirit of continuing paranoia we also document the domain boundaries; see <a class="el" href="index.html#comm_ex">Comments and Exercises</a>.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//========================================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Doc the solution</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classUnstructuredSolidProblem.html#ab3d66fd61b69d12b4f159d763fc44f15">UnstructuredSolidProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; doc_info)</div>
<div class="line">{ </div>
<div class="line"> </div>
<div class="line"> ofstream some_file;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of plot points</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> npts;</div>
<div class="line"> npts=5;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output solution</span></div>
<div class="line"> <span class="comment">//----------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Solid_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output traction</span></div>
<div class="line"> <span class="comment">//----------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/traction%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Traction_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output boundaries</span></div>
<div class="line"> <span class="comment">//------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/boundaries.dat&quot;</span>,doc_info.directory().c_str());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Solid_mesh_pt-&gt;output_boundaries(some_file);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="comm_ex"></a>
Comments and Exercises</h1>
<h2><a class="anchor" id="bound"></a>
Identification/assignment of mesh boundaries</h2>
<p>This tutorial demonstrates that the use of unstructured meshes for solid mechanics problems is extremely straightforward. The only aspect that requires some care (and not just for solid mechanics applications) is the correct identification/assignment of domain boundaries when the mesh is generated with <a href="http://en.wikipedia.org/wiki/Xfig">xfig.</a> The fact that we documented the mesh boundaries and the positions of the pinned nodes in the driver code suggests (correctly!) that we managed to get both assignments (slightly) wrong when we first wrote the driver code. The manual identification of nodes on domain boundaries is tedious and therefore error prone and, as usual, it pays to <b>be as a paranoid as possible</b>! Ignore this advice at your own risk...</p>
<p>We also welcome any improvements to our conversion code <a href="../../../../demo_drivers/meshing/mesh_from_xfig_triangle/fig2poly.cc">fig2poly.cc </a> that would allow the specification of domain boundaries from within <a href="http://en.wikipedia.org/wiki/Xfig">xfig.</a> It's probably not possible but if you have any ideas how to go about this (either by hijacking information that can be generated by <a href="http://en.wikipedia.org/wiki/Xfig">xfig</a> or via some other GUI interface), <a href="../../../contact/html/index.html">let us know.</a></p>
<hr  />
<h2><a class="anchor" id="three_d"></a>
3D Problems</h2>
<p>Unstructured meshes may also be used for the 3D solid mechanics problems. The overall procedure is very similar to that documented above, we will not provide a detailed discussion of the corresponding 3D driver code</p>
<center> <a href="../../../../demo_drivers/solid/unstructured_solid/unstructured_three_d_solid.cc">demo_drivers/solid/unstructured_solid/unstructured_three_d_solid.cc </a> </center><p>which computes the deformation of the hollow cube used in the <a href="../../../meshes/mesh_from_tetgen/html/index.html">Mesh Generation with Tetgen Tutorial</a>.</p>
<p>Here is an animation of the cube's deformation when it is subjected to gravity, acting in the negative <img class="formulaInl" alt="$ z $" src="form_1.png" width="6" height="6"/>-direction, and a "suction" force applied on the upper face, while its right face is held in a fixed position.</p>
<div class="image">
<img src="three_d.gif" alt=""/>
<div class="caption">
Plot of the deformation of a hollow 3D cube. </div></div>
 <p>An alternative three-dimensional problem: the deformation of a bifurcating tube is described <a href="../../unstructured_three_d_solid/html/index.html">here. </a></p>
<hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
<center> <a href="../../../../demo_drivers/solid/unstructured_solid/">demo_drivers/solid/unstructured_solid/ </a> </center><br  />
</li>
<li>The driver codes are: <br  />
<br  />
<center> <a href="../../../../demo_drivers/solid/unstructured_solid/unstructured_two_d_solid.cc">demo_drivers/solid/unstructured_solid/unstructured_two_d_solid.cc </a> </center> and <center> <a href="../../../../demo_drivers/solid/unstructured_solid/unstructured_three_d_solid.cc">demo_drivers/solid/unstructured_solid/unstructured_three_d_solid.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Dec 19 2024 11:27:17
        </div>
      </div>
    </footer>
</body>
</html>

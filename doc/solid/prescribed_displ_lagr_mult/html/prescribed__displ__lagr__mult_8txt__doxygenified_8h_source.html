<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: prescribed_displ_lagr_mult.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">prescribed_displ_lagr_mult.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="prescribed__displ__lagr__mult_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Demo problem: Deformation of a solid by a prescribed boundary motion</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">The purpose of this tutorial is to demonstrate how to impose the deformation </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">of domain boundaries using Lagrange multipliers. This</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">functionality is required, e.g. when using (pseudo-)solid mechanics</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">to update the shape of the fluid mesh in fluid-structure interaction</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">problems, say. (See \ref comm_and_ex for a discussion of</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">an alternative, somewhat easier method for imposing boundary</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">displacements in single-physics solid mechanics problems). </span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">\section model The model problem</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">Here is a sketch of the model problem. A unit square is parametrised</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">by two Lagrangian coordinates \f$ (\xi^1,\xi^2) \f$. Three of the four</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">boundaries are held in a fixed position while</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">the square&#39;s upper boundary \f$ \partial D_{prescr}\f$ </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">(which is parametrised by the boundary coordinate</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">\f$ \zeta\f$) is displaced to a new position given by </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">\f$ {\bf R}_{prescr}(\zeta) \f$:</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">\image html sketch.gif &quot;Sketch of the problem. &quot; </span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">\image latex sketch.eps &quot;Sketch of the problem. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">\section theory Theory and implementation</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">We identify the upper boundary by writing the Lagrangian coordinates </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">of points on \f$ \partial D_{prescr} \f$ as</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">\left. \big( \xi^1, \xi^2\big)\right|_{\partial D_{prescr}} = </span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\big( \xi^1_{\partial D_{prescr}}(\zeta), </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">      \xi^2_{\partial D_{prescr}}(\zeta) \big)</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">which allows us to write the displacement constraint as</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">{\bf R}(\xi^1_{\partial D_{prescr}}(\zeta),\xi^2_{\partial</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">D_{prescr}}(\zeta)) = {\bf R}_{prescr}(\zeta).</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">We enforce this constraint by augmenting the principle of</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">virtual displacements, discussed in </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">&lt;a href=&quot;../../solid_theory/html/index.html#equilibrium&quot;&gt;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">the solid mechanics theory tutorial&lt;/a&gt;, by a Lagrange multiplier term</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">so that it becomes</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\int \left\{ \sigma^{ij}  \ \delta \gamma_{ij} -  \left( {\bf f} - </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">\Lambda^2 \frac{\partial^2 {\bf R}}{\partial t^2} \right) \cdot </span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\delta {\bf R} \right\} \ dv -</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">\oint_{A_{tract}} {\bf T} \cdot \delta {\bf R} \ dA</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">\ + \ \delta \Pi_{constraint} = 0</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">where </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> \Pi_{constraint} = \int_{\partial D} </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">\bigg( {\bf R}(\xi^1(\zeta),\xi^2(\zeta)) - {\bf R}_{prescr}(\zeta) \bigg)</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\cdot {\bf \Lambda} \ dS.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">Here</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">dS = \left| \frac{d {\bf R}(\xi^1(\zeta),\xi^2(\zeta))}{d \zeta}</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\right| d\zeta </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">is the differential of the arclength along the domain boundary</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">and the vector \f$ {\bf \Lambda} \f$ (not to be confused with the</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">scalar \f$ \Lambda^2 \f$ which represents the non-dimensional</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">density in (1)!) is the Lagrange multiplier -- the</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">surface traction to be applied to \f$ \partial D_{prescr} \f$</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">to deform the boundary into the required shape.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">We discretise this constraint by attaching \c FaceElements to</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">the boundaries of the &quot;bulk&quot; solid elements that are adjacent to </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">\f$ \partial D_{prescr} \f$. We denote the number of nodes in </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">these \c FaceElements by \f$ N \f$ and write the \f$ i \f$-th component </span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">of the discrete Lagrange multiplier stored at node \f$ j \f$ as </span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">\f$ L_{ij} \f$. Thus the \f$ i \f$ -th component of the Lagrange</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">multiplier at local coordinate \f$ s \f$ in the element is given by</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">\Lambda_i = \sum_{j=1}^{N} L_{ij} \psi_j(s)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">where \f$ \psi_j(s) \f$ is the shape function associated with node </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">\f$ j \f$.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">Upon taking the variations of the discretised constraint</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">with respect to the unknown nodal positions and the discrete</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">Lagrange multipliers we obtain &lt;b&gt;(i)&lt;/b&gt; additional contributions to the</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">residuals of the &quot;bulk&quot; solid mechanics equations (these</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">may be interpreted as the virtual work done by the boundary</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">tractions required to impose the prescribed boundary displacement)</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">and  &lt;b&gt;(ii)&lt;/b&gt; the equations that impose the displacement</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">constraints in weak form.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> The actual implementation of this approach in \c oomph-lib is best</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">thought of as a generalisation of the \c SolidTractionElements that</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">are used to impose a prescribed traction to the boundary of a solid domain. </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">The main difference is that in the </span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">\c ImposeDisplacementByLagrangeMultiplierElement, the imposed</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">traction is one of the unknowns in the problem and must be </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">determined via the displacement constraint, using the approach</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">described above. The element introduces additional unknowns (the nodal</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">values of the Lagrange multiplier) into the problem, therefore </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">the \c ImposeDisplacementByLagrangeMultiplierElement resizes</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">(increases) the number of values stored at the node from the value</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">that was originally assigned by the &quot;bulk&quot; solid element it is</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">attached to. (If the elements are used in a single-physics</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">solid mechanics problem the discrete Lagrange multipliers are the </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">only nodal values in the problem since the unknown nodal positions</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">are stored in a separate \c Data item; cf. </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">&lt;A HREF=&quot;../../solid_theory/html/index.html#solid_node&quot;&gt; </span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">&quot;Solid mechanics: Theory and implementation&quot;&lt;/A&gt; for more details). </span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">The prescribed boundary shape \f$ {\bf R}_{prescr}(\zeta) \f$</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">is provided by a \c GeomObject.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">The animation below shows the domain deformation in response to a</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">prescribed boundary displacement given by</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">{\bf R}_{prescr}(\zeta)=</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\zeta \\</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">1</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">\right)</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">+ A</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">5 \zeta\ (\zeta-1) \ (\zeta-0.7) \\</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">\frac{1}{2}\left(1-\cos\left(2\pi\zeta\right)\right)  </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">\right)</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">With this choice the upper boundary remains flat (i.e. at \f$ x_2=1 \f$)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">when \f$ A=0 \f$. As \f$ A \f$ increases, the boundary is pulled</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">upwards into a  sinusoidal shape while simultaneously being pushed</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">to the right. The vectors in the animation represent the Lagrange</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">multipliers (i.e. the physical surface tractions) required to deform</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">the domain into the required shape. Note how the automatic mesh</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">adaptation refines the mesh in regions where the solid is strongly</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">deformed.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">\image html lagr_distort.gif &quot;Domain deformation in response to the prescribed boundary displacement. &quot; </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">\image latex lagr_distort.eps &quot;Domain deformation in response to the prescribed boundary displacement. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">\section prescribed_boundary Describing the prescribed boundary motion with a GeomObject</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">Here is the implementation of the prescribed boundary shape as the </span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">\c WarpedLine, a two-dimensional \c GeomObject whose shape is parametrised</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">by a single intrinsic coordinate. </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">\skipline Start_of_warped_line</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">\until };</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">\section namespace Global parameters</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">As usual we define the problem parameters in a global namespace.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">We provide an instantiation of the \c GeomObject that defines</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">the deformed boundary shape (setting its initial displacement </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">amplitude to zero), and create an instance of \c oomph-lib&#39;s </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">generalised Hookean constitutive equation with a Poisson ratio of</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">0.3 (recall that the use of the single-argument constructor for this</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">constitutive equation implies that all stresses are non-dimensionalised</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">on Young&#39;s modulus \f$ E \f$; see </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">&lt;a href=&quot;../../solid_theory/html/index.html#non-dim_solid&quot;&gt;</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">the solid mechanics theory tutorial&lt;/a&gt; for details).</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">\skipline start_namespace</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">\until end namespace</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">\section driver The driver code</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">We build an instantiation of the \c Problem class (described below), </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">using nine-noded, two-dimensional \c RefineableQPVDElements</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">to discretise the domain, and document the initial </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">domain shape.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">\until doc_solution</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">We perform a parameter study, increasing the amplitude of the </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">prescribed boundary  deflection in small increments, while allowing </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">one mesh adaptation per solution.   </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">\until doc_solution</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> Since the main use of the methodology demonstrated here is in </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">free-boundary problems where the solution of the solid problem</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">merely serves to update the nodal positions in response to the</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">prescribed boundary motion, we re-set the nodes&#39; Lagrangian</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">coordinates to their Eulerian positions after every solve. </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">This makes the deformed configuration stress-free and tends to </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">stabilise the computation, allowing larger domain deformations</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">to be computed. We stress, however, that this renders the </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">computed solutions physically meaningless in the sense that</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">the domain shapes no longer represent the solution of the</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">original elasticity problem for which the stress-free, undeformed</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">configuration remains unchanged throughout the body&#39;s deformation.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">\section problem The Problem class</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">The definition of the \c Problem class follows the usual pattern.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">We provide an access functions to the bulk mesh, as well</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">as a few private helper functions that attach and detach</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">the \c ImposeDisplacementByLagrangeMultiplierElements from the</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">bulk mesh before and after the mesh adaptation. </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">\skipline begin_problem</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">\until };</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">\section constructor The Problem constructor</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">We start by creating the &quot;bulk&quot; mesh, discretising the domain with </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">5x5 elements of the type specified by the class&#39;s template argument.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">\until l_x,l_y);</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">Next we specify the error estimator, pass the pointer to the constitutive</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">equation to the elements and perform one uniform mesh refinement:</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">\until refine_uniformly();</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">We now create a new \c SolidMesh in which we store the elements</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">that apply the displacement constraint. These elements are built (and</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">added to the newly created \c SolidMesh) in the helper function</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">\c create_lagrange_multiplier_elements(). Both meshes are then combined</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">to the \c Problem&#39;s global mesh. </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">\until build_global_mesh();</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">We pin the position of the nodes on all domain boundaries apart from the</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">top boundary (boundary 2) and pin any redundant pressure degrees of freedom.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">(This is not strictly necessary in the present driver code</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">since the displacement-based \c RefineableQPVDElements do not have </span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">any pressure degrees of freedom. However, it is good practice to </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">do this anyway to guard against unpleasant surprises when the</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">element type is changed at some point).</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">\until solid_mesh_pt()-&gt;element_pt());</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">Finally, we assign the equation numbers and specify the output</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">directory. </span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">\section actions_before_adapt Actions before mesh adaptation</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">As usual, we remove the \c FaceElements that apply the displacement</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">constraints before the bulk mesh is adapted.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">\skipline start_of_actions_before_adapt</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">\until  end of actions_before_adapt</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">\section actions_after_adapt Actions after mesh adaptation</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">We re-attach the \c FaceElements that apply the displacement</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">constraints once the bulk mesh has been adapted. Since the </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">hanging status of nodes in the bulk mesh can change during</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">the mesh adaptation it is again good practice to pin any</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">nodal solid pressure values that may have become redundant.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">\skipline start_of_actions_after_adapt</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">\until  end of actions_after_adapt</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">\section lagr_elements Creating the Lagrange multiplier elements that impose the displacement constraint</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">The creation of the Lagrange multiplier elements that impose the </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">displacement constraint follows the usual pattern. We loop over</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">the &quot;bulk&quot; solid elements that are adjacent to mesh boundary 2</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">and attach \c ImposeDisplacementByLagrangeMultiplierElements</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">to the appropriate faces. </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">\skipline start_of_create_lagrange_multiplier_elements</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">Next we loop over the newly-created  </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">\c ImposeDisplacementByLagrangeMultiplierElements and specify  the </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">\c GeomObject that defines the imposed boundary displacements.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">We also specify which boundary of the bulk mesh</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">the \c ImposeDisplacementByLagrangeMultiplierElements are located</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">on. This is required to enable the \c</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">ImposeDisplacementByLagrangeMultiplierElements to extract the</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">appropriate boundary coordinate from its constituent nodes.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">(We discussed </span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">&lt;a href=&quot;../../../poisson/fish_poisson2/html/index.html#boundary_coords&quot;&gt;</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">elsewhere&lt;/a&gt; that boundary coordinates are usually defined (and </span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">passed to the nodes) when the nodes are first created, typically </span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">during the construction of the bulk mesh. Since nodes can be </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">located on multiple domain boundaries, each boundary coordinate</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">is associated with a particular boundary number. Passing this number</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">to the \c ImposeDisplacementByLagrangeMultiplierElements allows</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">them to obtain the correct boundary coordinate from the node.) </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">\until &amp;Global_Physical_Variables::Boundary_geom_object,b);</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">Finally, we impose boundary conditions for the Lagrange multipliers.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">Their values must be pinned (and set to zero) at the left and right ends</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">of the upper mesh boundary (boundary 2), since the displacement of the</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">nodes at these points is already enforced by the boundary conditions imposed </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">at the left and right vertical boundaries (boundaries 1 and 3).</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">&lt;a name=&quot;bcs_for_lagrange_multipliers&quot;&gt;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">We&lt;/a&gt; discussed above that the discrete Lagrange multipliers</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">are added to any already existing nodal degrees of freedom when the</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">\c ImposeDisplacementByLagrangeMultiplierElements are attached</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">to the faces of the &quot;bulk&quot; solid elements. The number of nodal values </span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">that were stored at an element&#39;s \c j -th node before the </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">additional nodal values were added, can be obtained from the </span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">function \c nbulk_value(j), defined in the \c FaceElement base class.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">We pin the Lagrange multipliers at the &quot;corner nodes&quot; by</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">looping over all nodes in the \c ImposeDisplacementByLagrangeMultiplierElements</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">and pinning the additional nodal values of any nodes that are </span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">located on mesh boundaries 1 or 3. </span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">\until end of create_lagrange_multiplier_elements</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">\section kill_lagr_elements Deleting the Lagrange multiplier elements that impose the displacement constraint</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">The function \c delete_lagrange_multiplier_elements() deletes the</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">Lagrange multiplier elements that impose the displacement constraint</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">and flushes the associated mesh. </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">\skipline start_of_delete_lagrange_multiplier_elements</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">\until end of delete_lagrange_multiplier_elements</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">\section doc Post-processing</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">The function \c doc_solution() outputs the shape of the deformed body</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">and the Lagrange multiplier along the upper boundary.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult.cc</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">\skipline start_doc</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">\until end doc</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">\section comm_and_ex Comments and Exercises</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">\subsection comm Comments</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">As mentioned in the introduction, there is an alternative, much</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">simpler way of imposing prescribed boundary motions which </span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">does not require Lagrange multipliers: Pin the nodal positions of </span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">all nodes on \f$ \partial D_{prescr} \f$ and update their </span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">positions manually before calling the Newton solver, e.g.</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">by changing the \c actions_before_newton_solve() function to</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">\dontinclude prescribed_displ_lagr_mult2.cc</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">\skipline Update boundary position directly</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">\until end actions_before_newton_solve</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">This approach is implemented in the alternative driver</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">code </span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">&lt;a href=&quot;../../../../demo_drivers/solid/prescribed_displ_lagr_mult/prescribed_displ_lagr_mult2.cc&quot;&gt;prescribed_displ_lagr_mult2.cc&lt;/a&gt;.   </span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">\subsection ex Exercises</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">-# In order to familiarise yourself with the details of how \c FaceElements </span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">   add additional nodal values to the nodes they are attached</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">   to, output the values of \c n_bulk_value and \c nval</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">   in the loop that pins the Lagrange multipliers in </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">   \c create_lagrange_multiplier_elements(). Explain why, for the</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">   \c RefineableQPVDElement&lt;2,3&gt; used here, we have </span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">   \c n_bulk_value = 0. What happens if you use elements of type</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">   \c RefineableQPVDElementWithContinousPressure&lt;2&gt; instead?</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">-# Comment out the call to \c set_lagrangian_nodal_coordinates() after </span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">   the solve and compare the robustness of the computation and </span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">   the resulting domain shapes. [Hint: You will have to reduce the increment</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">   for the amplitude of the prescribed boundary deflection to</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">   0.025 or less, otherwise the Newton iteration will diverge</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">   very rapidly.]</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">-# Explore the performance of the alternative driver code (without the use</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">   of Lagrange multipliers) </span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">   &lt;a href=&quot;../../../../demo_drivers/solid/prescribed_displ_lagr_mult/prescribed_displ_lagr_mult2.cc&quot;&gt;prescribed_displ_lagr_mult2.cc&lt;/a&gt;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">   and explain why it is less robust than the version with Lagrange </span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">   multipliers (in the sense that the increment in the amplitude of </span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">   the prescribed boundary displacement</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">   has to be reduced significantly to keep the Newton method from</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">   diverging). Hint: Compare the domain shapes before the </span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">   call to the Newton solver.</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">-# Omit the specification of the boundary number in the bulk</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">   mesh by commenting out the call to \c</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">   set_boundary_number_in_bulk_mesh(...) in the function</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">   \c create_lagrange_multiplier_elements(). Check what happens</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">   when the code is compiled with and without the \c PARANOID flag.</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a4594cc67d151c2f09d749a2d054e7f71"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a4594cc67d151c2f09d749a2d054e7f71">l_x</a></div><div class="ttdeci">&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by creating the bulk discretising the domain with elements of the type specified by the class s template argument dontinclude prescribed_displ_lagr_mult cc skipline start_of_constructor until l_x</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00259">prescribed_displ_lagr_mult.txt:259</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_aefdd2e0c6df754997c79c7206b37460b"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#aefdd2e0c6df754997c79c7206b37460b">estimator</a></div><div class="ttdeci">Next we specify the error estimator</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00261">prescribed_displ_lagr_mult.txt:261</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_ac9a34d9d2e1f547b1745b8639371a2c4"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#ac9a34d9d2e1f547b1745b8639371a2c4">boundary</a></div><div class="ttdeci">We pin the position of the nodes on all domain boundaries apart from the top boundary(boundary 2) and pin any redundant pressure degrees of freedom.(This is not strictly necessary in the present driver code since the displacement-based \c RefineableQPVDElements do not have any pressure degrees of freedom. However</div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a0b1bd7c99a3ffd67dac7b495b8b2ac71"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a0b1bd7c99a3ffd67dac7b495b8b2ac71">built</a></div><div class="ttdeci">We now create a new c SolidMesh in which we store the elements that apply the displacement constraint These elements are built(and added to the newly created \c SolidMesh) in the helper function \c create_lagrange_multiplier_elements(). Both meshes are then combined to the \c Problem 's global mesh. \until build_global_mesh()</div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a669de053ef4d94b8e5d5477fcfa04199"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a669de053ef4d94b8e5d5477fcfa04199">prescr</a></div><div class="ttdeci">\big(\xi^1_{\partial D_{prescr}}(\zeta), \xi^2_{\partial D_{prescr}}(\zeta) \big) \f] which allows us to write the displacement constraint as \f[{\bf R}(\xi^1_{\partial D_{prescr}}(\zeta),\xi^2_{\partial D_{prescr}}(\zeta))={\bf R}_{prescr}(\zeta). \f] We enforce this constraint by augmenting the principle of virtual displacements, discussed in&lt; a href=&quot;../../solid_theory/html/index.html#equilibrium&quot;&gt; the solid mechanics theory tutorial&lt;/a &gt;, by a Lagrange multiplier term so that it becomes \f[\int \left\{ \sigma^{ij} \ \delta \gamma_{ij} - \left({\bf f} - \Lambda^2 \frac{\partial^2 {\bf R}}{\partial t^2} \right) \cdot \delta {\bf R} \right\} \ dv - \oint_{A_{tract}} {\bf T} \cdot \delta {\bf R} \ dA \+\ \delta \Pi_{constraint}=0 \ \ \ \ \ \ \ \ @E[continuous_pdv]@ \f] where \f[\Pi_{constraint}=\int_{\partial D} \bigg({\bf R}(\xi^1(\zeta),\xi^2(\zeta)) - {\bf R}_{prescr}(\zeta) \bigg) \cdot {\bf \Lambda} \ dS. \f] Here \f[dS=\left|\frac{d {\bf R}(\xi^1(\zeta),\xi^2(\zeta))}{d \zeta} \right|d\zeta \f] is the differential of the arclength along the domain boundary and the vector \f$ {\bf \Lambda} \f$(not to be confused with the scalar \f$ \Lambda^2 \f$ which represents the non-dimensional density in( @R[continuous_pdv]@)!) is the Lagrange multiplier -- the surface traction to be applied to \f$ \partial D_{prescr} \f$ to deform the boundary into the required shape. We discretise this constraint by attaching \c FaceElements to the boundaries of the &quot;bulk&quot; solid elements that are adjacent to \f$ \partial D_{prescr} \f$. We denote the number of nodes in these \c FaceElements by \f$ N \f$ and write the \f$ i \f$-th component of the discrete Lagrange multiplier stored at node \f$ j \f$ as \f$ L_{ij} \f$. Thus the \f$ i \f$ -th component of the Lagrange multiplier at local coordinate \f$ s \f$ in the element is given by \f[\Lambda_i=\sum_{j=1}^{N} L_{ij} \psi_j(s) \f] where \f$ \psi_j(s) \f$ is the shape function associated with node \f$ j \f$. Upon taking the variations of the discretised constraint with respect to the unknown nodal positions and the discrete Lagrange multipliers we obtain&lt; b &gt;(i)&lt;/b &gt; additional contributions to the residuals of the &quot;bulk&quot; solid mechanics equations(these may be interpreted as the virtual work done by the boundary tractions required to impose the prescribed boundary displacement) and&lt; b &gt;(ii)&lt;/b &gt; the equations that impose the displacement constraints in weak form. The actual implementation of this approach in \c oomph-lib is best thought of as a generalisation of the \c SolidTractionElements that are used to impose a prescribed traction to the boundary of a solid domain. The main difference is that in the \c ImposeDisplacementByLagrangeMultiplierElement, the imposed traction is one of the unknowns in the problem and must be determined via the displacement constraint, using the approach described above. The element introduces additional unknowns(the nodal values of the Lagrange multiplier) into the problem, therefore the \c ImposeDisplacementByLagrangeMultiplierElement resizes(increases) the number of values stored at the node from the value that was originally assigned by the &quot;bulk&quot; solid element it is attached to.(If the elements are used in a single-physics solid mechanics problem the discrete Lagrange multipliers are the only nodal values in the problem since the unknown nodal positions are stored in a separate \c Data item prescr</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00111">prescribed_displ_lagr_mult.txt:111</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a4074baada03976c061d5672f4237cca5"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a4074baada03976c061d5672f4237cca5">problem</a></div><div class="ttdeci">mainpage Demo problem</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00005">prescribed_displ_lagr_mult.txt:5</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a68e55ef45cd7ea9b0c7931ec49e3e533"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a68e55ef45cd7ea9b0c7931ec49e3e533">of</a></div><div class="ttdeci">namespace Global parameters As usual we define the problem parameters in a global namespace We provide an instantiation of the c GeomObject that defines the deformed boundary and create an instance of c oomph lib s generalised Hookean constitutive equation with a Poisson ratio of(recall that the use of the single-argument constructor for this constitutive equation implies that all stresses are non-dimensionalised on Young 's modulus \f$ E \f$;see&lt; a href=&quot;../../solid_theory/html/index.html#non-dim_solid&quot;&gt; the solid mechanics theory tutorial&lt;/a &gt; for details). \dontinclude prescribed_displ_lagr_mult.cc \skipline start_namespace \until end namespace&lt; HR &gt;&lt; HR &gt; \section driver The driver code We build an instantiation of the \c Problem class(described below)</div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_ab9bf07933bb0e16b652de3a6658c154c"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#ab9bf07933bb0e16b652de3a6658c154c">multipliers</a></div><div class="ttdeci">cf&lt; A HREF=&quot;../../solid_theory/html/index.html#solid_node&quot;&gt; Solid the boundary is pulled upwards into a sinusoidal shape while simultaneously being pushed to the right The vectors in the animation represent the Lagrange multipliers(i.e. the physical surface tractions) required to deform the domain into the required shape. Note how the automatic mesh adaptation refines the mesh in regions where the solid is strongly deformed. @I w 0.75\textwidth lagr_distort &quot;Domain deformation in response to the prescribed boundary displacement. &quot;&lt; HR &gt;&lt; HR &gt; \section prescribed_boundary Describing the prescribed boundary motion with a GeomObject Here is the implementation of the prescribed boundary shape as the \c WarpedLine</div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_ac504b023dd205b8c47901261e968e30e"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#ac504b023dd205b8c47901261e968e30e">boundaries</a></div><div class="ttdeci">we assign the equation numbers and specify the output directory until end of constructor&lt; HR &gt;&lt; HR &gt; section actions_before_adapt Actions before mesh adaptation As we remove the c FaceElements that apply the displacement constraints before the bulk mesh is adapted dontinclude prescribed_displ_lagr_mult cc skipline start_of_actions_before_adapt until end of actions_before_adapt&lt; HR &gt;&lt; HR &gt; section actions_after_adapt Actions after mesh adaptation We re attach the c FaceElements that apply the displacement constraints once the bulk mesh has been adapted Since the hanging status of nodes in the bulk mesh can change during the mesh adaptation it is again good practice to pin any nodal solid pressure values that may have become redundant dontinclude prescribed_displ_lagr_mult cc skipline start_of_actions_after_adapt until end of actions_after_adapt&lt; HR &gt;&lt; HR &gt; section lagr_elements Creating the Lagrange multiplier elements that impose the displacement constraint The creation of the Lagrange multiplier elements that impose the displacement constraint follows the usual pattern We loop over the bulk solid elements that are adjacent to mesh boundary and attach c ImposeDisplacementByLagrangeMultiplierElements to the appropriate faces dontinclude prescribed_displ_lagr_mult cc skipline start_of_create_lagrange_multiplier_elements until Next we loop over the newly created c ImposeDisplacementByLagrangeMultiplierElements and specify the c GeomObject that defines the imposed boundary displacements We also specify which boundary of the bulk mesh the c ImposeDisplacementByLagrangeMultiplierElements are located on This is required to enable the c ImposeDisplacementByLagrangeMultiplierElements to extract the appropriate boundary coordinate from its constituent nodes(We discussed&lt; a href=&quot;../../../poisson/fish_poisson2/html/index.html#boundary_coords&quot;&gt; elsewhere&lt;/a &gt; that boundary coordinates are usually defined(and passed to the nodes) when the nodes are first created, typically during the construction of the bulk mesh. Since nodes can be located on multiple domain boundaries, each boundary coordinate is associated with a particular boundary number. Passing this number to the \c ImposeDisplacementByLagrangeMultiplierElements allows them to obtain the correct boundary coordinate from the node.) \until &amp;Global_Physical_Variables we impose boundary conditions for the Lagrange multipliers Their values must be since the displacement of the nodes at these points is already enforced by the boundary conditions imposed at the left and right vertical boundaries(boundaries 1 and 3).&lt; a name</div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_abe6579a9afc252024055f89c417d4f29"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#abe6579a9afc252024055f89c417d4f29">mesh</a></div><div class="ttdeci">&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by creating the bulk mesh</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00254">prescribed_displ_lagr_mult.txt:254</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a4e949986140abf44b3ee7478368a3fd0"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a4e949986140abf44b3ee7478368a3fd0">shape</a></div><div class="ttdeci">namespace Global parameters As usual we define the problem parameters in a global namespace We provide an instantiation of the c GeomObject that defines the deformed boundary shape(setting its initial displacement amplitude to zero)</div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a050053d5163a04cba4b7a840490a0302"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a050053d5163a04cba4b7a840490a0302">until</a></div><div class="ttdeci">cf&lt; A HREF=&quot;../../solid_theory/html/index.html#solid_node&quot;&gt; Solid the boundary is pulled upwards into a sinusoidal shape while simultaneously being pushed to the right The vectors in the animation represent the Lagrange a two dimensional c GeomObject whose shape is parametrised by a single intrinsic coordinate dontinclude prescribed_displ_lagr_mult cc skipline Start_of_warped_line until</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00168">prescribed_displ_lagr_mult.txt:168</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a924128d27e91eca2e0b593d2ef3b07f6"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a924128d27e91eca2e0b593d2ef3b07f6">refinement</a></div><div class="ttdeci">Next we specify the error pass the pointer to the constitutive equation to the elements and perform one uniform mesh refinement</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00264">prescribed_displ_lagr_mult.txt:264</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a70e156ba08d56ab9ab1360ed22c1e003"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a70e156ba08d56ab9ab1360ed22c1e003">l_y</a></div><div class="ttdeci">&lt; HR &gt;&lt; HR &gt; section constructor The Problem constructor We start by creating the bulk discretising the domain with elements of the type specified by the class s template argument dontinclude prescribed_displ_lagr_mult cc skipline start_of_constructor until l_y</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00259">prescribed_displ_lagr_mult.txt:259</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a0ca414f8d3c45e7e959038f8b1b53e2d"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a0ca414f8d3c45e7e959038f8b1b53e2d">here</a></div><div class="ttdeci">we assign the equation numbers and specify the output directory until end of constructor&lt; HR &gt;&lt; HR &gt; section actions_before_adapt Actions before mesh adaptation As we remove the c FaceElements that apply the displacement constraints before the bulk mesh is adapted dontinclude prescribed_displ_lagr_mult cc skipline start_of_actions_before_adapt until end of actions_before_adapt&lt; HR &gt;&lt; HR &gt; section actions_after_adapt Actions after mesh adaptation We re attach the c FaceElements that apply the displacement constraints once the bulk mesh has been adapted Since the hanging status of nodes in the bulk mesh can change during the mesh adaptation it is again good practice to pin any nodal solid pressure values that may have become redundant dontinclude prescribed_displ_lagr_mult cc skipline start_of_actions_after_adapt until end of actions_after_adapt&lt; HR &gt;&lt; HR &gt; section lagr_elements Creating the Lagrange multiplier elements that impose the displacement constraint The creation of the Lagrange multiplier elements that impose the displacement constraint follows the usual pattern We loop over the bulk solid elements that are adjacent to mesh boundary and attach c ImposeDisplacementByLagrangeMultiplierElements to the appropriate faces dontinclude prescribed_displ_lagr_mult cc skipline start_of_create_lagrange_multiplier_elements until Next we loop over the newly created c ImposeDisplacementByLagrangeMultiplierElements and specify the c GeomObject that defines the imposed boundary displacements We also specify which boundary of the bulk mesh the c ImposeDisplacementByLagrangeMultiplierElements are located on This is required to enable the c ImposeDisplacementByLagrangeMultiplierElements to extract the appropriate boundary coordinate from its constituent nodes(We discussed&lt; a href=&quot;../../../poisson/fish_poisson2/html/index.html#boundary_coords&quot;&gt; elsewhere&lt;/a &gt; that boundary coordinates are usually defined(and passed to the nodes) when the nodes are first created, typically during the construction of the bulk mesh. Since nodes can be located on multiple domain boundaries, each boundary coordinate is associated with a particular boundary number. Passing this number to the \c ImposeDisplacementByLagrangeMultiplierElements allows them to obtain the correct boundary coordinate from the node.) \until &amp;Global_Physical_Variables we impose boundary conditions for the Lagrange multipliers Their values must be since the displacement of the nodes at these points is already enforced by the boundary conditions imposed at the left and right vertical used here</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00432">prescribed_displ_lagr_mult.txt:432</a></div></div>
<div class="ttc" id="aprescribed__displ__lagr__mult_8txt_html_a227e86b4229bfca68af5803a97546bc8"><div class="ttname"><a href="prescribed__displ__lagr__mult_8txt.html#a227e86b4229bfca68af5803a97546bc8">mechanics</a></div><div class="ttdeci">cf&lt; A HREF=&quot;../../solid_theory/html/index.html#solid_node&quot;&gt; Solid mechanics</div><div class="ttdef"><b>Definition:</b> <a href="prescribed__displ__lagr__mult_8txt_source.html#l00144">prescribed_displ_lagr_mult.txt:144</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 18:11:17
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: b_convection.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">b_convection.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="b__convection_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Boussinesq Convection: Combining the Navier--Stokes and Advection--Diffusion equations</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">\image html symm_broken.gif &quot;Steady Convection Rolls: contours of temperature and the vector velocity field for a two-dimensional domain heated from below at Ra = 1800 &quot; </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">\image latex symm_broken.eps &quot;Steady Convection Rolls: contours of temperature and the vector velocity field for a two-dimensional domain heated from below at Ra = 1800 &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> We study convection of an</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> incompressible Newtonian fluid heated from below in a</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> two-dimensional domain of height \f$ H \f$:</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> the B&amp;eacute;nard problem. The lower wall is maintained at a</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> temperature \f$ \theta_{bottom} \f$ and the upper wall is maintained at</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> a temperature \f$ \theta_{top} \f$, where \f$ \theta_{bottom} &gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> \theta_{top} \f$ .</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> The governing</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> equations are the (2D) Navier--Stokes equations </span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> under the Boussinesq</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> approximation, in which all variations in</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> physical properties with temperature are neglected, apart </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> from that of the density</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> in the gravitational-body-force term in the momentum equations. </span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> This &quot;buoyancy&quot; term is given by</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> \f[ \Delta\rho G^{*}_{i}, \f] where \f$ \Delta\rho \f$ is the variation</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> in density and \f$ G^{*}_{i} \f$ is the \f$ i \f$ -th component of </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> the gravitational body force. Under the additional assumption that</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> variations in temperature are small, we can use the linear</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> relationship</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> \f[ \Delta\rho = -\alpha\rho_{0}(\theta^{*} - \theta_{0}), \f]</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> where \f$ \alpha \f$ is the coefficient of thermal expansion of the</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> fluid, \f$ \theta^{*} \f$ is the (dimensional) temperature and</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> \f$ \rho_{0} \f$ is the density at the reference temperature </span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> \f$ \theta_{0} \f$ .</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> The equations governing the fluid motion are thus the</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> Navier--Stokes equations with the inclusion of the additional</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> buoyancy term. In Cartesian coordinates, we have</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">&lt;center&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">\f[ \rho_{0} \left (\frac{\partial u^{*}_i}{\partial t^{*}} + </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">u^{*}_j \frac{\partial u^{*}_i}{\partial x^{*}_j} \right) =</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">- \frac{\partial p^{*}}{\partial x^{*}_i} +  \left[\rho_{0} - </span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">  \alpha\rho_{0}(\theta^{*}</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> - \theta_{0})\right] G^{*}_i + \mu_{0}</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\frac{\partial }{\partial x^{*}_j} \left[</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">\frac{\partial u^{*}_i}{\partial x^{*}_j} +  </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">\frac{\partial u^{*}_j}{\partial x^{*}_i} \right],</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">&lt;/center&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">&lt;center&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">\frac{\partial u^{*}_i}{\partial x^{*}_i} = 0.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">&lt;/center&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">Here, \f$ u^{*}_{i} \f$ is the \f$ i \f$ -th (dimensional) </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">velocity component and</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">\f$ x^{*}_{i} \f$ is the position in the \f$i\f$-th coordinate</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">direction; \f$ \mu_{0} \f$ is the dynamic viscosity of the</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">fluid at the reference temperature and \f$ t^{*} \f$ is the </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">dimensional time.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">The equation that governs the evolution of the temperature field is the</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">advection-diffusion equation where the &quot;wind&quot; is the fluid</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">velocity. Thus,</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">&lt;center&gt;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">\f[ \frac{\partial \theta^{*}}{\partial t^{*}} +</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">u^{*}_{j}\frac{\partial \theta^{*}}{\partial x^{*}_{j}} = </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">\kappa\frac{\partial}{\partial x^{*}_{j}}\left(\frac{\partial</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\theta^{*}}{\partial</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">x^{*}_{j}}\right),\f]</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">&lt;/center&gt;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">where \f$ \kappa \f$ is the (constant) thermal diffusivity of the fluid.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">We choose the height of the domain, \f$ H \f$, as the length scale and</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">let the characteristic thermal diffusion speed over that length,</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">\f$ \kappa/H \f$, be</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">the velocity scale, so that the P&amp;eacute;clet number, \f$ Pe =</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">UH/\kappa = 1 \f$ . The fluid pressure is</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">non-dimensionalised on the viscous scale, \f$ \mu_{0} \kappa/H^{2} \f$ , </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">and the hydrostatic pressure gradient is included explicitly, </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">so that we work with the dimensionless excess pressure.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">The temperature is non-dimensionalised so that it is -0.5 at the upper</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">(cooled) wall and 0.5 at the bottom (heated) wall and the</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">reference temperature is then \f$ \theta_{0} = (\theta_{top} +</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">\theta_{bottom})/2 \f$. Finally, the</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">timescale is chosen to be the thermal diffusion timescale,</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">\f$ \kappa/H^{2} \f$ . Hence</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">\f[ x^{*}_{i} = x_{i} H, \quad u^{*}_{i} =  u_{i} \kappa/H, \quad</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">    p^{*} = -\rho_{0} g H x_{2} + \frac{\mu_{0}\kappa}{H^{2}}p,\quad</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">    \theta^{*} = \theta_{0} </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">   + \theta(\theta_{bottom} - \theta_{top}),</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">    \quad t^{*} = \frac{\kappa}{H^{2}}t. \f]</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">The governing equations become</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">&lt;center&gt;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\f[ Pr^{-1}\left(\frac{\partial u_i}{\partial t} + </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> u_j \frac{\partial u_i}{\partial x_j} \right) =</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">- \frac{\partial p}{\partial x_i}  - Ra \theta G_i +</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">\frac{\partial }{\partial x_j} \left[</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_j} +  </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">\frac{\partial u_j}{\partial x_i} \right],</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">\frac{\partial u_i}{\partial x_i} = 0,</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">\f[ \frac{\partial \theta}{\partial t} +</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">u_{j}\frac{\partial \theta}{\partial x_{j}} = </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\frac{\partial}{\partial x_{j}}\left(\frac{\partial \theta}{\partial</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">x_{j}}\right),\f].</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">&lt;/center&gt;</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">The appropriate dimensionless numbers are the Prandtl number </span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">\f$ Pr = \frac{\nu}{\kappa} \f$, and the Rayleigh number, </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">\f$ Ra = \frac{\alpha (\theta_{bottom} - \theta_{top})g</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">H^{3}}{\nu\kappa} \f$ ; \f$ g \f$ is the acceleration due to gravity and</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">\f$ \nu = \mu_{0}/\rho_{0} \f$ is the kinematic viscosity of the</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">fluid.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> We consider the solution of this coupled set of equations in a</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> two-dimensional domain \f$ 0 \leq x_{1} \leq 3 \f$ , \f$ 0 \leq x_{2} \leq</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> 1 \f$ . The boundary</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> conditions are no-slip at the top and bottom walls</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> \f[ u_{1} = u_{2} = 0 \quad\mbox{on } x_{2} = 0, 1; \f]</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> constant temperature at the top and bottom walls (heated from below)</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> \f[ \theta = 0.5 \quad\mbox{on } x_{2}=0 \quad\mbox{and}\quad</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">     \theta = -0.5 \quad\mbox{on } x_{2} = 1; \f]</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> and symmetry boundary conditions at the sides:</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> \f[ u_{1} = 0,\quad \frac{\partial u_{2}}{\partial x_{1}} = 0,</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> \quad  \mbox{ and }</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">    \frac{\partial \theta}{\partial x_{1}} = 0 \quad\mbox{on } x_{1} =</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> 0,3. \f]</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> We assume that gravity acts vertically downward so that \f$ G_{1} =</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> 0 \f$ and \f$ G_{2} = -1 \f$ .</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> There is a trivial steady-state solution that consists of a</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> linearly-varying temperature field balanced by a quadratic pressure</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> field:</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> \f[ u_{1} = u_{2} = 0, \quad \theta = 0.5 - x_2, \quad p = P_{0} + 0.5</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> \ Ra</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> \ x_{2} \left(1 - x_{2}\right). \f]</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">\image html base_flow.gif &quot;The base flow: no flow and a linear temperature distribution &quot; </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\image latex base_flow.eps &quot;The base flow: no flow and a linear temperature distribution &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">A linear stability analysis shows that this solution becomes unstable</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">via an up-down, symmetry-breaking, pitchfork bifurcation </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">at a critical Rayleigh number of \f$ Ra_{crit} \approx 1708 \f$ with a</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">critical wavenumber of \f$ k \approx 3.11, \f$  see for example Hydrodynamic</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">and Hydromagnetic Stability by S. Chandrasekhar OUP (1961). </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">Thus, for \f$ Ra &gt; 1708 \f$ there are three possible steady</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">solutions, the (unstable) trivial steady state and two (stable)</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">symmetry-broken states. In principle, all three states can be</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">computed directly by solving the steady equations. However, we</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">typically find that if the steady computation is started with a zero</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">initial guess for the velocity and temperature, the Newton method</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">converges to the trivial state. In order to demonstrate that </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">this state is indeed unstable we therefore apply a time-dependent, </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">mass-conserving  perturbation to the vertical velocity at the upper </span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">wall and time-march the system while rapidly reducing the size of the </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">perturbation. The system then evolves towards the nontrivial steady state</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">as shown in the &lt;a href=&quot;../figures/convect.avi&quot;&gt;animation&lt;/a&gt; from</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">which the plots shown above were extracted. (In the </span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">&lt;A HREF=&quot;../../refine_b_convect/html/index.html&quot;&gt; </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">next tutorial where we discuss </span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">the adaptive solution of this problem&lt;/A&gt; we shall demonstrate an alternative</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">technique for obtaining this solutions).</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> Note that by choosing our domain of a particular size and applying</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> symmetry conditions at the sidewalls we are only able to realise a</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> discrete set of wavelengths (those that exactly fit into the box). At</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> the chosen Rayleigh number, 1800, only one of these modes is unstable;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> that of wavelength 2.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">\section namespace Global parameters and functions</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">The problem contains three global parameters, the P&amp;eacute;clet number,</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">the Prandtl number and the Rayleigh number</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">which we define in a namespace, as usual. In fact, \f$ 1/Pr \f$ is the</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">natural dimensionless grouping, and so we use the</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">inverse Prandtl number as our variable.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">\dontinclude boussinesq_convection.cc</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">\until end_of_namespace</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">In the driver code we set the direction of gravity and construct </span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">our problem, using the new</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">\ref element &quot;BuoyantQCrouzeixRaviartElement&quot;, a multi-physics</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">element, created by combining the \c QCrouzeixRaviart Navier-Stokes</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">elements with the \c QAdvectionDiffusion elements via</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">multiple inheritance. (Details of the element&#39;s </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">implementation are discussed in the section \ref element below.)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">\dontinclude boussinesq_convection.cc</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">\until problem;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">We assign the boundary conditions at the time \f$ t=0 \f$ and</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">initially perform a single steady solve to obtain the trivial</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">(and temporally unstable) trivial solution; see the section </span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">\ref comments for a more detailed discussion of the </span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">\c Problem::steady_newton_solve() function.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">\skipline Apply</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">\until doc_solution</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">The result of this calculation is the trivial symmetric base flow. We</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">next timestep the system using the (unstable) steady solution as the</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">initial condition. As time increases, the flow evolves to one of the </span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">stable asymmetric solutions, as shown in the </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">&lt;a href=&quot;../figures/convect.avi&quot;&gt; animation of the results.&lt;/a&gt; </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">As usual, we only perform a few timesteps when the code is used as a self-test,</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">i.e. if any command-line parameters are passed to the driver code.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">\skipline Set the</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">\section problem The problem class</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">The problem class contains five non-trivial functions:</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">the constructor, the \c fix_pressure(...) function,</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">as well as the functions \c set_boundary_conditions(...),</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">\c actions_before_implicit_timestep(...) and </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">\c doc_solution(...), all discussed below.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">\subsection const The constructor</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">We pass the element type as a</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">template parameter to the problem constructor, which has no</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">arguments. The constructor creates a \c BFD&lt;2&gt; timestepper and builds a</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">\c RectangularQuadMesh of \f$ 8\times 8 \f$ elements.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">\dontinclude boussinesq_convection.cc</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">\until RectangularQuadMesh</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">Next, the boundary constraints are imposed. We pin all velocities and</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">the temperature on the top and bottom walls and pin only the horizontal</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">velocity on the sidewalls. Since the domain is enclosed, the pressure</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">is only determined up the an arbitrary constant. We resolve this</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">ambiguity by pinning a single pressure value, using the </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">\c fix_pressure(...) function.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">\skipline Set the boundary</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">\until fix_pressure(</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">We complete the build of the elements by setting the pointers </span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">to the physical parameters and finally assign the equation numbers</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">\skipline unsigned n_element</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">\subsection set_bound The function set_boundary_conditions(...)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">In order to examine the stability of the symmetric state, we impose a</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">time-dependent boundary condition that transiently perturbs </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">the vertical velocity field at the upper boundary. Our boundary</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">condition is </span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">\f[ u_{2}\big|_{x_2=1} = \epsilon \ t \ \mbox{e}^{-t} \sin(2\pi x_{1}/3), \f]</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">where \f$ \epsilon \ll 1 \f$ . The perturbation is zero at</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">\f$ t=0 \f$ , tends to zero as \f$ t\to\infty \f$ , and is mass conserving.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">This is implemented in the  function below</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">\dontinclude boussinesq_convection.cc</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">\skipline start_of_set_bound</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">\until end_of_set_bound</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">\subsection fix_p The function fix_pressure(...)</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">This function is a simple wrapper to the element&#39;s \c</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">fix_pressure(...) function.</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">\dontinclude boussinesq_convection.cc</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">\skipline Fix pressure</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">\until end_of_fix_pressure </span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">\subsection actions_bef  The function actions_before_implicit_timestep()</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">This function is used to ensure that the time-dependent boundary conditions </span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">are set to the correct value before solving the problem at the next</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">time level.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">\dontinclude boussinesq_convection.cc</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">\skipline Actions before the timestep</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">\subsection doc The function doc_solution(...)</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> This function writes the complete velocity, pressure and temperature</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> fields to a file in the output directory.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">\dontinclude boussinesq_convection.cc</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">\skipline start_doc_solution</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> \section element Creating the new BuoyantQCrouzeixRaviartElement class</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">The sketch below illustrates how the new multi-physics </span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">\c BuoyantQCrouzeixRaviartElement is constructed by multiple </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">inheritance from the two existing single-physics elements: </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">\image html multi_physics.gif &quot;Sketch illustrating the construction of the BuoyantQCrouzeixRaviartElement by multiple inheritance. &quot; </span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">\image latex multi_physics.eps &quot;Sketch illustrating the construction of the BuoyantQCrouzeixRaviartElement by multiple inheritance. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">- The nine-noded two-dimensional \c QCrouzeixRaviartElement </span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">  is based on a nine-node quadrilateral geometric \c FiniteElement from</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">  the \c QElement family. All of its \c Nodes store two values,</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">  the horizontal and vertical velocity, respectively. The element also</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">  stores internal \c Data which represents the (discontinuous) pressure</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">  degrees of freedom; in the sketch this \c Data is represented by the</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">  dashed box. \n\n</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">- The two-dimensional \c QAdvectionDiffusionElement is based on the </span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">  same geometric \c FiniteElement and stores one value </span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">  (the temperature, \f$ \theta \f$ ) at each \c Node. </span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">Both elements are fully-functional and provide their contributions</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">to the global system of nonlinear algebraic equations that is solved</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">by Newton&#39;s method via the two member functions </span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">\c fill_in_contribution_to_residuals(...) and  </span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">\c fill_in_contribution_to_jacobian(...).</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">- The \c QAdvectionDiffusionElement&#39;s member function</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">  \c fill_in_contribution_to_residuals(...) computes the element&#39;s</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">  contribution to the global residual vector for a given </span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">  &quot;wind&quot;.  The &quot;wind&quot; is specified by its virtual member function </span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">  \c get_wind_adv_diff(...) and in the </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../advection_diffusion/two_d_adv_diff_adapt/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">  single-physics advection diffusion problems studied so far&lt;/A&gt;, the</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">  &quot;wind&quot; tended to specified \e a \e priori by the user. The element&#39;s  </span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">  member function \c fill_in_contribution_to_jacobian(...) computes</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">  the elemental Jacobian matrix, i.e. the derivatives of the elemental </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">  residual vector with respect to its unknown nodal values (the</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">  temperatures). \n\n</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">- Similarly, the \c QCrouzeixRaviartElement&#39;s member function</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">  \c fill_in_contribution_to_residuals(...) computes the element&#39;s</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">  contribution to the global residual vector for a given </span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">  body force.  The body force is specified by its virtual member function </span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">  \c get_body_force_nst(...) and in the </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../navier_stokes/circular_driven_cavity/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">  single-physics Navier-Stokes problems studied so far&lt;/A&gt;, the</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">  body force tended to specified \e a \e priori by the user. The element&#39;s </span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">  member function \c fill_in_contribution_to_jacobian(...) computes</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">  the elemental Jacobian matrix, i.e. the derivatives of the elemental </span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">  residual vector with respect to its unknown nodal and internal </span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">  values (the velocities and the pressure).</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">When combining the two single-physics elements to a multi-physics</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">element, we have to take the interaction between the constituent </span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">equations into account: In the coupled problem</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">the &quot;wind&quot; in the advection-diffusion equations is given by</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">the Navier-Stokes velocities, while the body force</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">in the Navier-Stokes equations is a function of the</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">temperature. When implementing these interactions we </span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">wish to recycle as much of the elements&#39; existing functionality as </span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">possible. This may be achieved by the following straightforward steps:</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">-# Construct the combined multi-physics element by multiple inheritance. \n\n</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">-# Overload the \c FiniteElement::required_nvalue(...) function</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">   to ensure that each \c Node provides a sufficient amount of </span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">   storage for the (larger) number of nodal values required in</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">   the multi-physics problem. \n\n</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">-# Overload the constituent element&#39;s member functions that </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">   indicate which nodal value corresponds to which type of</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">   degree of freedom. For instance, in the single-physics </span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">   advection-diffusion problem, the temperature is stored at the</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">   zero-th nodal value whereas in the combined multi-physics element,</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">   the temperature is stored as the second value, as shown in the</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">   above sketch. \n\n</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">-# Provide a final overload for the element&#39;s </span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">   \c fill_in_contribution_to_residuals(...)</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">   and \c fill_in_contribution_to_jacobian(...) functions.  </span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">   The former simply concatenates the residual vectors computed </span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">   by the constituent single-physics elements.  The latter function</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">   is easiest to implement by finite differencing the</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">   combined element&#39;s residual vector. [A more efficient</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">   approach (in terms of cpu time, not necessarily terms of </span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">   development time!) is to recycle the diagonal blocks computed </span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">   by the constituent elements&#39;s \c fill_in_contribution_to_jacobian(...) </span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">   functions and to use finite-differencing only for the off-diagonal</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">   (interaction) blocks; see the section \ref comments a more detailed</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">   discussion of this technique.]</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">That&#39;s all! Here is the implementation:</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">\skipline class definition</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">\until virtual QCrouzeixRaviart</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">The class contains a single new physical parameter, the Rayleigh number, as</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">usual referenced  by a pointer to a double precision datum,</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">\skipline Rayleigh</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">\until Ra_pt</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">with suitable access functions.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">\skipline Access</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">\until ra_pt</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">The constructor calls the constructors of the component classes</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">(\c QCrouzeixRaviartElement and \c QAdvectionDiffusionElement) and initialises</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">the value of the Rayleigh number to zero, via a static default</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">parameter value.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">\skipline Constructor</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">\until } </span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">We must overload the function \c FiniteElement::required_nvalue()</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">because the new element will store \c DIM+1 unknowns at each node: \c</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">DIM fluid velocity components and the value of the temperature,</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">as shown in the sketch above.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">\skipline The required</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">\until QCrouzeix </span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">In the standard single-physics advection-diffusion elements the temperature</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">is the only value stored at the nodes and is stored as \c</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">value(0). Similarly, in the single-physics Navier--Stokes elements,</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">the fluid velocities are stored in the first \c DIM nodal values.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">In our new multi-physics element, we must decide where to</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">store the different variables and then inform the single-physics elements</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">of our choice. As indicated in the above sketch, we choose to store </span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">the temperature \b after the</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">fluid velocities, so that it is \c value(DIM). The recommended</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">mechanism for communicating the location of the variables to the</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">single-physics elements is to use an index function. Hence, </span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">single-physics elements that are to be the components of multi-physics </span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">elements must have an index function for their variables. For</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">instance, the function</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">\c u_index_adv_diff(...) is used in the \c AdvectionDiffusionEquations</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">class to read out the position (index) at which the advected variable</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">(the temperature) is stored. That function is now overloaded in our </span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">multi-physics element:</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">\skipline Overload the index</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">We need not overload the index function for the fluid velocities </span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">because they remain stored in the first \c DIM positions at the node.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">The coupling between the two sets of single-physics equations is</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">achieved by overloading the two functions \c get_wind_adv_diff(), used</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">in the advection-diffusion equations and \c get_body_force_nst(), used in</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">the Navier--Stokes equations</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">\skipline Overload the wind</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">\skipline Overload the body force</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">The elemental residual vector is composed of the residuals from the</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">two single-physics elements and we simply call the underlying</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">functions for each element in turn.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">\skipline Calculate the element</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">Finally, we compute the Jacobian matrix by finite-differencing</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">the element&#39;s combined residual vector, using the </span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">default implementation of the \c fill_in_contribution_to_jacobian(...)</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">function in the \c FiniteElement base class:</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">\skipline Compute the element&#39;s residual vector and the Jacobian matrix</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">Finally, we overload the output function to print the fluid</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">velocities, the fluid pressure and the temperature.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">\dontinclude boussinesq_elements.h</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">\skipline Start of output function</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">\until End of output function</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">\section comm_and_ex Comments and Exercises</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">\subsection comments Comments</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">- &lt;STRONG&gt;The &lt;CODE&gt;steady_newton_solve()&lt;/CODE&gt;function:&lt;/STRONG&gt;</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">  In most previous examples we have encountered two</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">  main interfaces to \c oomph-lib&#39;s Newton solver: \n\n</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">  - The function \c Problem::newton_solve() employs Newton&#39;s method to</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">    solve the system of nonlinear algebraic equations arising from the </span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">    \c Problem&#39;s discretisation. The current \c Data values are used as</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">    the initial guess for the Newton iteration. On return from this function,</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">    all unknown \c Data values will have been assigned their correct values</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">    so that the solution of the problem may be plotted by calls</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">    to the elements&#39; \c output functions. We tended to use this function</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">    to solve steady problems.</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">    \n\n</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">  - Given the solution at time \f$ t = t_{\mbox{orig}} \f$ , the unsteady </span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">    Newton solver &lt;code&gt; Problem::unsteady_newton_solve(dt,...) &lt;/code&gt;</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">    increments time by \c dt, shifts the &quot;history&quot; values and then</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">    computes the solution at the advanced time, \f$ t =</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">    t_{\mbox{orig}} \f$ + \c dt.</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">    On return from this function, all unknown \c Data values (and</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">    the corresponding &quot;history&quot; values) will have been assigned their </span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">    correct values so that the solution at time \f$ t =</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">    t_{\mbox{orig}} \f$ + \c dt  may be plotted by calls</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">    to the elements&#39; \c output functions. We tended to use this function</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">    for unsteady problems. </span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">    \n\n</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">  Inspection of the </span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">  \c Problem::unsteady_newton_solve(...) function shows </span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">  that this function is, in fact, a wrapper around \c</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">  Problem::newton_solve(), and that the latter function solves the </span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  discretised equations &lt;EM&gt;including any terms that arise from an </span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">  implicit time-discretisation&lt;/EM&gt;. The only purpose of the wrapper</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  function is to shift the history values before taking the next timestep.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">  This raises the question how to compute steady solutions</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">  (i.e. solutions obtained by setting the time-derivatives in the </span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">  governing equation to zero) of a \c Problem that was discretised</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">  in a form that allows for timestepping, as in the problem studied</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">  here. This is the role of the function </span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">  \c Problem::steady_newton_solve(): The function performs</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">  the following steps:</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">  -# Disable all  \c TimeSteppers in the \c Problem</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">     by calling their \c TimeStepper::make_steady() member function.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">  -# Call the \c Problem::newton_solve() function to compute</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">     the solution of the discretised problem with all</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">     time-derivatives set to zero.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">  -# Re-activate all \c TimeSteppers (unless they were already in </span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">     &quot;steady&quot; mode when the function was called).</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">  -# Call the function \c Problem::assign_initial_values_impulsive()</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">     to ensure that the &quot;history&quot; values used by the (now re-activated)</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">     \c TimeSteppers are consistent with an impulsive start from</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">     the steady solution just computed.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">  . </span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">  On return from this function, all unknown \c Data values (and</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">  the corresponding &quot;history&quot; values) will have been assigned their </span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">  correct values so that the solution just computed is</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">  a steady solution to the full unsteady equations.</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">- &lt;STRONG&gt; \anchor opt Optimising the implementation of multi-physics</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">  interactions:&lt;/STRONG&gt;</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">  The combined multi-physics element discussed above was implemented</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">  with just a few straightforward lines of code. The ease of </span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">  implementation comes at a price, however, and more efficient</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">  implementations (in terms of CPU time) are possible: \n\n</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">  -# &lt;STRONG&gt;Using finite-differencing only for the off-diagonal terms</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">     in the Jacobian matrix:&lt;/STRONG&gt; \n\n</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">     While the use of finite-differencing in the setup of the</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">     Jacobian matrix is convenient, it does not exploit the fact</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">     that the constituent single-physics elements already provide</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">     analytical (and hence cheaper-to-compute) expressions for the</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">     two diagonal blocks in the coupled Jacobian matrix (i.e. the</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">     derivatives of the fluid residuals with respect to</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">     the fluid variables, and the derivatives of the advection</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">     diffusion residuals with respect to the temperature degrees of</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">     freedom). It is possible to recycle these entries and to use</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">     finite-differencing only to compute the off-diagonal interaction</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">     blocks (i.e. the derivatives of the Navier-Stokes residuals with </span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">     respect to the temperature degrees of freedom, and the</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">     derivatives of the advection-diffusion residuals with respect</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">     to the velocities). In fact, the source code for the</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">     \c BuoyantQCrouzeixRaviartElement includes such an</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">     implementation. The full finite-difference-based computation </span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">     discussed above </span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">     is used if the code is compiled with the compiler flag </span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">     \c USE_FD_JACOBIAN_FOR_BUOYANT_Q_ELEMENT. </span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">     Finite-differences are used for the off-diagonal blocks only when the</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">     compiler flag \c</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">     USE_OFF_DIAGONAL_FD_JACOBIAN_FOR_BUOYANT_Q_ELEMENT</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">     is passed.</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">     When comparing the two versions of the code, we found the</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">     run times for the full finite-difference-based version to be</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">     approximately 3-7% higher, depending on the spatial </span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">     resolution used. The implementation of the more efficient version</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">     is still straightforward and can be found in the</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">     source code</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">     &lt;A HREF=&quot;../../../../demo_drivers/multi_physics/boussinesq_convection/boussinesq_convection.cc&quot;&gt;boussinesq_convection.cc.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">     &lt;/A&gt; </span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">  -# &lt;STRONG&gt;Using an analytic Jacobian matrix:&lt;/STRONG&gt; \n\n</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">     As discussed above, the re-use of the analytic expressions</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">     for the diagonal blocks of the coupled Jacobian matrix is</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">     straightforward. For a yet more efficient computation </span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">     we can assemble analytic expressions for </span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">     the off-diagonal interaction blocks; </span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">     although this does require</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">     knowledge of precisely how the governing equations were</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">     implemented in the single-physics elements. Once again,</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">     the source code for the</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">     \c BuoyantQCrouzeixRaviartElement includes such an implementation </span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">     and, moreover, it is the default behaviour. We found the assembly</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">     time for the analytic coupled Jacobian to be approximately 15\%</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">     of the finite-difference based versions. The implementation </span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">     is reasonably straightforward and can be found in the</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">     source code</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">     &lt;A HREF=&quot;../../../../demo_drivers/multi_physics/boussinesq_convection/boussinesq_convection.cc&quot;&gt;boussinesq_convection.cc.</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">     &lt;/A&gt; </span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">  -# &lt;STRONG&gt;Complete re-implementation of the coupled</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">     element:&lt;/STRONG&gt; \n\n</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">     Although recycling the analytically computed diagonal blocks in the</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">     Jacobian matrix leads to a modest speedup, and the use of</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">     analytic off-diagonal blocks to a further speedup, the</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">     computation of the coupled residual vector and Jacobian matrix</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">     are still somewhat inefficient. This is because the contributions</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">     from the Navier-Stokes and advection-diffusion equations are </span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">     computed in two separate integration loops; and, if computed, the</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">     assembly of the analytic off-diagonal terms requires a third</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">     integration loop. The only solution to this</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">     problem would be to fully merge the source codes for two elements</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">     to create a customised element. In the present problem this would</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">     not be too difficult, particularly since the derivatives of the Navier-Stokes</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">     residuals with respect to the temperature, and the derivatives of</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">     the advection-diffusion residuals with respect to the velocities</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">     are easy to calculate. However, a reimplementation in this form would break the</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">     modularity of the library as any subsequent changes/improvements to the</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">     Navier-Stokes elements, say, would have to be added manually to</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">     the coupled element. If maximum speed is absolutely essential</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">     in your application, you may still wish to choose this option. The</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">     existing Navier-Stokes and advection diffusion elements provide</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">     the required building blocks for your custom-written coupled element.</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">\subsection exercises Exercises</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">-# Confirm that the system is stable, i.e. returns to the trivial state,</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">   when \f$ Ra = 1700 \f$ .</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">-# How does the time-evolution of the system change when no-slip</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">   boundary conditions for the fluid velocity are applied on the side</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">   boundaries (a rigid box model)?</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">-# Re-write the multi-physics elements so that the temperature is</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">   stored \b before the fluid velocities. Confirm that the solution is</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">   unchanged in this case.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">-# Assess the computational cost of the finite-difference based</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">   setup of the elements&#39; Jacobian matrices by comparing the</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">   run times of the two versions of the code.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">-# Try using \c QTaylorHoodElements as the &quot;fluid&quot; element part of the</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">   multi-physics elements. N.B. in this case, the temperature \b must be</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">   stored as the first variable at the nodes because we assume that it is</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">   always stored at the same location in every node. </span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">&lt;A HREF=&quot;</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">../../../../</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">demo_drivers/multi_physics/boussinesq_convection/</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">&quot;&gt;</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">demo_drivers/multi_physics/boussinesq_convection/</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">&lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">&lt;A HREF=&quot;</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">../../../../</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">demo_drivers/multi_physics/boussinesq_convection/boussinesq_convection.cc</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">&quot;&gt;</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">demo_drivers/multi_physics/boussinesq_convection/boussinesq_convection.cc</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">\n</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">- The source code for the elements is in: \n\n</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../src/multi_physics/boussinesq_elements.h&quot;&gt;</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">src/multi_physics/boussinesq_elements.h&lt;/A&gt;</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="ab__convection_8txt_html_a2233a8cc7df0b099554a37c4967cf749"><div class="ttname"><a href="b__convection_8txt.html#a2233a8cc7df0b099554a37c4967cf749">datum</a></div><div class="ttdeci">see the section ref comments a more detailed discussion of this technique n n That s all ! Here is the the Rayleigh as usual referenced by a pointer to a double precision datum</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00411">b_convection.txt:411</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a637fd2a6a7c5b34ed3288300d8bf84b7"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a637fd2a6a7c5b34ed3288300d8bf84b7">Global_Physical_Variables::Rayleigh</a></div><div class="ttdeci">double Rayleigh</div><div class="ttdoc">Rayleigh number, set to be greater than the threshold for linear instability.</div><div class="ttdef"><b>Definition:</b> <a href="boussinesq__convection_8cc_source.html#l00058">boussinesq_convection.cc:58</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a614600538dee959f62cb1ffc1990bdec"><div class="ttname"><a href="b__convection_8txt.html#a614600538dee959f62cb1ffc1990bdec">t</a></div><div class="ttdeci">We assign the boundary conditions at the time f t</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00199">b_convection.txt:199</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a701d7c985ded9f56ed1590af2ce41df9"><div class="ttname"><a href="b__convection_8txt.html#a701d7c985ded9f56ed1590af2ce41df9">H</a></div><div class="ttdeci">the timescale is chosen to be the thermal diffusion f kappa H</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00083">b_convection.txt:83</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_ae0724829d011e7e8888fe004e659d442"><div class="ttname"><a href="b__convection_8txt.html#ae0724829d011e7e8888fe004e659d442">inheritance</a></div><div class="ttdeci">namespace as usual In fact f Pr f is the natural dimensionless grouping and so we use the inverse Prandtl number as our variable dontinclude boussinesq_convection cc skipline start_of_namespace until end_of_namespace&lt; HR &gt;&lt; HR &gt; section main The driver code In the driver code we set the direction of gravity and construct our problem using the new ref element BuoyantQCrouzeixRaviartElement a multi physics element created by combining the c QCrouzeixRaviart Navier Stokes elements with the c QAdvectionDiffusion elements via multiple inheritance(Details of the element 's implementation are discussed in the section \ref element below.) \dontinclude boussinesq_convection.cc \skipline start_of_main \until problem</div></div>
<div class="ttc" id="ab__convection_8txt_html_a9f8783c06da74551face2b32bcb1c56a"><div class="ttname"><a href="b__convection_8txt.html#a9f8783c06da74551face2b32bcb1c56a">x_2</a></div><div class="ttdeci">functions x_2</div></div>
<div class="ttc" id="ab__convection_8txt_html_a6ec8bf32b5263f45245a578865d52730"><div class="ttname"><a href="b__convection_8txt.html#a6ec8bf32b5263f45245a578865d52730">timescale</a></div><div class="ttdeci">the timescale is chosen to be the thermal diffusion timescale</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00080">b_convection.txt:80</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a2bcbf09f62c47d4625f6a52377b80dd5"><div class="ttname"><a href="b__convection_8txt.html#a2bcbf09f62c47d4625f6a52377b80dd5">usual</a></div><div class="ttdeci">see the section ref comments for a more detailed discussion of the c the flow evolves to one of the stable asymmetric as shown in the&lt; a href=&quot;../figures/convect.avi&quot;&gt; animation of the results&lt;/a &gt; As usual</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00213">b_convection.txt:213</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_aa7618cdeded74065ec1fd800d6ac7f1e"><div class="ttname"><a href="b__convection_8txt.html#aa7618cdeded74065ec1fd800d6ac7f1e">explicitly</a></div><div class="ttdeci">clet f f and the hydrostatic pressure gradient is included explicitly</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00076">b_convection.txt:76</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a966d37d9bbf93b5f40b2caebb8060373"><div class="ttname"><a href="b__convection_8txt.html#a966d37d9bbf93b5f40b2caebb8060373">f</a></div><div class="ttdeci">f&lt; center &gt; f[\frac{\partial \theta^{ *}}{\partial t^{ *}}+u^{ *}_{j}\frac{\partial \theta^{ *}}{\partial x^{ *}_{j}}=\kappa\frac{\partial}{\partial x^{ *}_{j}}\left(\frac{\partial\theta^{ *}}{\partialx^{ *}_{j}}\right),\f]&lt;/center &gt; where f kappa f is f H f</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00070">b_convection.txt:70</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a88833426c28cf4e984b7a5121288abad"><div class="ttname"><a href="b__convection_8txt.html#a88833426c28cf4e984b7a5121288abad">x_</a></div><div class="ttdeci">f g f is the acceleration due to gravity and f f leq x_</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00116">b_convection.txt:116</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a6c56217d4e683024d52e242f2be04816"><div class="ttname"><a href="b__convection_8txt.html#a6c56217d4e683024d52e242f2be04816">Ra</a></div><div class="ttdeci">the timescale is chosen to be the thermal diffusion f kappa and the Rayleigh f Ra</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00110">b_convection.txt:110</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_afa3516b8f49e9c3e0469fe5ce3ed975d"><div class="ttname"><a href="b__convection_8txt.html#afa3516b8f49e9c3e0469fe5ce3ed975d">Pe</a></div><div class="ttdeci">clet f Pe</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00073">b_convection.txt:73</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a323074de7c721d1eecdd1570861df3bc"><div class="ttname"><a href="b__convection_8txt.html#a323074de7c721d1eecdd1570861df3bc">extracted</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry pitchfork bifurcation at a critical Rayleigh number of f f see for example Hydrodynamic and Hydromagnetic Stability by S Chandrasekhar for f Ra f there are three possible steady all three states can be computed directly by solving the steady equations we typically find that if the steady computation is started with a zero initial guess for the velocity and the Newton method converges to the trivial state In order to demonstrate that this state is indeed unstable we therefore apply a time mass conserving perturbation to the vertical velocity at the upper wall and time march the system while rapidly reducing the size of the perturbation The system then evolves towards the nontrivial steady state as shown in the&lt; a href=&quot;../figures/convect.avi&quot;&gt; animation&lt;/a &gt; from which the plots shown above were extracted(In the&lt; A HREF=&quot;../../refine_b_convect/html/index.html&quot;&gt; next tutorial where we discuss the adaptive solution of this problem&lt;/A &gt; we shall demonstrate an alternative technique for obtaining this solutions). Note that by choosing our domain of a particular size and applying symmetry conditions at the sidewalls we are only able to realise a discrete set of wavelengths(those that exactly fit into the box). At the chosen Rayleigh number</div></div>
<div class="ttc" id="ab__convection_8txt_html_ac67a9411863c7f350e382bd6be3d22fa"><div class="ttname"><a href="b__convection_8txt.html#ac67a9411863c7f350e382bd6be3d22fa">frac</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad frac</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00124">b_convection.txt:124</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_ad3edf8e29f2ce1b61629ec22d9f89f76"><div class="ttname"><a href="b__convection_8txt.html#ad3edf8e29f2ce1b61629ec22d9f89f76">eacute</a></div><div class="ttdeci">f&lt; center &gt; f[\frac{\partial \theta^{ *}}{\partial t^{ *}}+u^{ *}_{j}\frac{\partial \theta^{ *}}{\partial x^{ *}_{j}}=\kappa\frac{\partial}{\partial x^{ *}_{j}}\left(\frac{\partial\theta^{ *}}{\partialx^{ *}_{j}}\right),\f]&lt;/center &gt; where f kappa f is f H as the length scale and let the characteristic thermal diffusion speed over that f kappa H be the velocity so that the P &amp; eacute</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00073">b_convection.txt:73</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a932a40c3da9f0cb8a9e1a0444b4a2934"><div class="ttname"><a href="b__convection_8txt.html#a932a40c3da9f0cb8a9e1a0444b4a2934">element</a></div><div class="ttdeci">see the section ref comments a more detailed discussion of this technique n n That s all ! Here is the the Rayleigh as usual referenced by a pointer to a double precision dontinclude boussinesq_elements h skipline Rayleigh until Ra_pt with suitable access functions dontinclude boussinesq_elements h skipline Access until ra_pt The constructor calls the constructors of the component via static a default parameter value dontinclude boussinesq_elements h skipline Constructor until We must overload the function c FiniteElement::required_nvalue() because the new element will store \c DIM+1 unknowns at each node although this does require knowledge of precisely how the governing equations were implemented in the single physics elements Once the source code for the c BuoyantQCrouzeixRaviartElement includes such an implementation it is the default behaviour We found the assembly time for the analytic coupled Jacobian to be approximately of the finite difference based versions The implementation is reasonably straightforward and can be found in the source code&lt; A HREF=&quot;../../../../demo_drivers/multi_physics/boussinesq_convection/boussinesq_convection.cc&quot;&gt; boussinesq_convection cc&lt;/A &gt; n n element</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00633">b_convection.txt:633</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a4fb52b3d32ce7932d2a0f2608f19772f"><div class="ttname"><a href="b__convection_8txt.html#a4fb52b3d32ce7932d2a0f2608f19772f">G_</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f G_</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00128">b_convection.txt:128</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a5ae294c91d10f441e7f86ebe03316bee"><div class="ttname"><a href="b__convection_8txt.html#a5ae294c91d10f441e7f86ebe03316bee">temperature</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry pitchfork bifurcation at a critical Rayleigh number of f f see for example Hydrodynamic and Hydromagnetic Stability by S Chandrasekhar for f Ra f there are three possible steady all three states can be computed directly by solving the steady equations we typically find that if the steady computation is started with a zero initial guess for the velocity and temperature</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00150">b_convection.txt:150</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_aad47374f6a74dd61903fc9f901f8aed4"><div class="ttname"><a href="b__convection_8txt.html#aad47374f6a74dd61903fc9f901f8aed4">nu</a></div><div class="ttdeci">f g f is the acceleration due to gravity and f nu</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00112">b_convection.txt:112</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_ae69b8c977ed7216ee947f4a48d7085b1"><div class="ttname"><a href="b__convection_8txt.html#ae69b8c977ed7216ee947f4a48d7085b1">implementation</a></div><div class="ttdeci">see the section ref comments a more detailed discussion of this technique n n That s all ! Here is the implementation</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00410">b_convection.txt:410</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a64a3d160ab7590603e9e17b2f6eb7283"><div class="ttname"><a href="b__convection_8txt.html#a64a3d160ab7590603e9e17b2f6eb7283">Convection</a></div><div class="ttdeci">mainpage Boussinesq Convection</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00008">b_convection.txt:8</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a8eb85bb81f9473f57686410a9ab8fd11"><div class="ttname"><a href="b__convection_8txt.html#a8eb85bb81f9473f57686410a9ab8fd11">mu_</a></div><div class="ttdeci">f mu_</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00054">b_convection.txt:54</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_ae341c32dae57308fdfe1bb0c93122841"><div class="ttname"><a href="b__convection_8txt.html#ae341c32dae57308fdfe1bb0c93122841">length</a></div><div class="ttdeci">f&lt; center &gt; f[\frac{\partial \theta^{ *}}{\partial t^{ *}}+u^{ *}_{j}\frac{\partial \theta^{ *}}{\partial x^{ *}_{j}}=\kappa\frac{\partial}{\partial x^{ *}_{j}}\left(\frac{\partial\theta^{ *}}{\partialx^{ *}_{j}}\right),\f]&lt;/center &gt; where f kappa f is f H as the length scale and let the characteristic thermal diffusion speed over that length</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00071">b_convection.txt:71</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_abb40edc915d909518869fa6ba093f9ea"><div class="ttname"><a href="b__convection_8txt.html#abb40edc915d909518869fa6ba093f9ea">walls</a></div><div class="ttdeci">f constant temperature at the top and bottom walls(heated from below) \f[\theta=0.5 \quad\mbox</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00120">b_convection.txt:120</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_ad617d15763f287b784c9bc805b88b157"><div class="ttname"><a href="b__convection_8txt.html#ad617d15763f287b784c9bc805b88b157">upper</a></div><div class="ttdeci">clet f f and the hydrostatic pressure gradient is included so that we work with the dimensionless excess pressure The temperature is non dimensionalised so that it is at the upper(cooled) wall and 0.5 at the bottom(heated) wall and the reference temperature is then \f$ \theta_</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00079">b_convection.txt:79</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="boussinesq__elements_8h_source.html#l00041">boussinesq_elements.h:41</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a1d8185d9befa4da1c95f3ec8795784bb"><div class="ttname"><a href="b__convection_8txt.html#a1d8185d9befa4da1c95f3ec8795784bb">breaking</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry breaking</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00141">b_convection.txt:141</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a6df958e8960b33cd5ff25eb1ea3a7867"><div class="ttname"><a href="b__convection_8txt.html#a6df958e8960b33cd5ff25eb1ea3a7867">the</a></div><div class="ttdeci">f&lt; center &gt; f[\frac{\partial \theta^{ *}}{\partial t^{ *}}+u^{ *}_{j}\frac{\partial \theta^{ *}}{\partial x^{ *}_{j}}=\kappa\frac{\partial}{\partial x^{ *}_{j}}\left(\frac{\partial\theta^{ *}}{\partialx^{ *}_{j}}\right),\f]&lt;/center &gt; where f kappa f is the(constant) thermal diffusivity of the fluid. We choose the height of the domain</div></div>
<div class="ttc" id="ab__convection_8txt_html_ac495fb4eb6e21d45773e819afce10e64"><div class="ttname"><a href="b__convection_8txt.html#ac495fb4eb6e21d45773e819afce10e64">elements</a></div><div class="ttdeci">if the assembly of the analytic off diagonal terms requires a third integration loop The only solution to this problem would be to fully merge the source codes for two elements to create a customised element In the present problem this would not be too particularly since the derivatives of the Navier Stokes residuals with respect to the and the derivatives of the advection diffusion residuals with respect to the velocities are easy to calculate a reimplementation in this form would break the modularity of the library as any subsequent changes improvements to the Navier Stokes elements</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00648">b_convection.txt:648</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a1c06e1f30a186e7f69c2192f4d55c672"><div class="ttname"><a href="b__convection_8txt.html#a1c06e1f30a186e7f69c2192f4d55c672">unstable</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry pitchfork bifurcation at a critical Rayleigh number of f f see for example Hydrodynamic and Hydromagnetic Stability by S Chandrasekhar for f Ra f there are three possible steady all three states can be computed directly by solving the steady equations we typically find that if the steady computation is started with a zero initial guess for the velocity and the Newton method converges to the trivial state In order to demonstrate that this state is indeed unstable we therefore apply a time mass conserving perturbation to the vertical velocity at the upper wall and time march the system while rapidly reducing the size of the perturbation The system then evolves towards the nontrivial steady state as shown in the&lt; a href=&quot;../figures/convect.avi&quot;&gt; animation&lt;/a &gt; from which the plots shown above were only one of these modes is unstable</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00166">b_convection.txt:166</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a46c2381b619699303aee8ea20e8b1984"><div class="ttname"><a href="b__convection_8txt.html#a46c2381b619699303aee8ea20e8b1984">computed</a></div><div class="ttdeci">if computed</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00638">b_convection.txt:638</a></div></div>
<div class="ttc" id="aboussinesq__convection_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="boussinesq__convection_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Driver code for 2D Boussinesq convection problem.</div><div class="ttdef"><b>Definition:</b> <a href="boussinesq__convection_8cc_source.html#l00314">boussinesq_convection.cc:314</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_ade58d2cda152abdd6d0566a78c74c9af"><div class="ttname"><a href="b__convection_8txt.html#ade58d2cda152abdd6d0566a78c74c9af">sides</a></div><div class="ttdeci">f and symmetry boundary conditions at the sides</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00124">b_convection.txt:124</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a2f93a5ae7a405957df5443f3493937b8"><div class="ttname"><a href="b__convection_8txt.html#a2f93a5ae7a405957df5443f3493937b8">Ra_</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry pitchfork bifurcation at a critical Rayleigh number of f Ra_</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00142">b_convection.txt:142</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_aaefe56910275fa0086188178de0d031f"><div class="ttname"><a href="b__convection_8txt.html#aaefe56910275fa0086188178de0d031f">However</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry pitchfork bifurcation at a critical Rayleigh number of f f see for example Hydrodynamic and Hydromagnetic Stability by S Chandrasekhar for f Ra f there are three possible steady all three states can be computed directly by solving the steady equations However</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00148">b_convection.txt:148</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a6f500fe9acd37479161f6e72875211d7"><div class="ttname"><a href="b__convection_8txt.html#a6f500fe9acd37479161f6e72875211d7">G</a></div><div class="ttdeci">nard problem The lower wall is maintained at a temperature f where f f where f Delta rho f is the variation in density and f G</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00021">b_convection.txt:21</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a2fc5d35c2b0fb533dcc7eb2975b4bdcd"><div class="ttname"><a href="b__convection_8txt.html#a2fc5d35c2b0fb533dcc7eb2975b4bdcd">scale</a></div><div class="ttdeci">f&lt; center &gt; f[\frac{\partial \theta^{ *}}{\partial t^{ *}}+u^{ *}_{j}\frac{\partial \theta^{ *}}{\partial x^{ *}_{j}}=\kappa\frac{\partial}{\partial x^{ *}_{j}}\left(\frac{\partial\theta^{ *}}{\partialx^{ *}_{j}}\right),\f]&lt;/center &gt; where f kappa f is f H as the length scale and let the characteristic thermal diffusion speed over that f kappa H be the velocity scale</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00073">b_convection.txt:73</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_af604fc107609a048b83fb8ac48b1b158"><div class="ttname"><a href="b__convection_8txt.html#af604fc107609a048b83fb8ac48b1b158">solutions</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry pitchfork bifurcation at a critical Rayleigh number of f f see for example Hydrodynamic and Hydromagnetic Stability by S Chandrasekhar for f Ra f there are three possible steady solutions</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00146">b_convection.txt:146</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a8e6f8c38d51502d3098e08c842e269ec"><div class="ttname"><a href="b__convection_8txt.html#a8e6f8c38d51502d3098e08c842e269ec">u</a></div><div class="ttdeci">nard problem The lower wall is maintained at a temperature f where f f where f Delta rho f is the variation in density and f we can use the linear relationship f[\Delta\rho=-\alpha\rho_{0}(\theta^{ *} - \theta_{0}), \f] where f alpha f is the coefficient of thermal expansion of the f we have&lt; center &gt; f u[\rho_{0} \left(\frac{\partial u^{ *}_i}{\partial t^{ *}}+u^{ *}_j \frac{\partial u^{ *}_i}{\partial x^{ *}_j} \right)=- \frac{\partial p^{ *}}{\partial x^{ *}_i}+\left[\rho_{0} - \alpha\rho_{0}(\theta^{ *} - \theta_{0})\right] G^{ *}_i+\mu_{0}\frac{\partial }{\partial x^{ *}_j} \left[\frac{\partial u^{ *}_i}{\partial x^{ *}_j}+\frac{\partial u^{ *}_j}{\partial x^{ *}_i} \right],\f]&lt;/center &gt; and&lt; center &gt; f[\frac{\partial u^{ *}_i}{\partial x^{ *}_i}=0.\f]&lt;/center &gt; f</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00051">b_convection.txt:51</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a4a045af2547c93c6b9801986cc145179"><div class="ttname"><a href="b__convection_8txt.html#a4a045af2547c93c6b9801986cc145179">theta_</a></div><div class="ttdeci">nard problem The lower wall is maintained at a temperature f theta_</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00009">b_convection.txt:9</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a2e7763410ea08b6335861f1bf00141d6"><div class="ttname"><a href="b__convection_8txt.html#a2e7763410ea08b6335861f1bf00141d6">number</a></div><div class="ttdeci">clet number</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00073">b_convection.txt:73</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a4fdaafe88e475e1868368898f8f54e86"><div class="ttname"><a href="b__convection_8txt.html#a4fdaafe88e475e1868368898f8f54e86">theta</a></div><div class="ttdeci">nard problem The lower wall is maintained at a temperature f where f f where f Delta rho f is the variation in density and f we can use the linear relationship f[\Delta\rho=-\alpha\rho_{0}(\theta^{ *} - \theta_{0}), \f] where f alpha f is the coefficient of thermal expansion of the theta)</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00027">b_convection.txt:27</a></div></div>
<div class="ttc" id="aclassfunctions_html"><div class="ttname"><a href="classfunctions.html">functions</a></div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00222">b_convection.txt:222</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a420fbcecedb3768239fce0133b07209f"><div class="ttname"><a href="b__convection_8txt.html#a420fbcecedb3768239fce0133b07209f">classes</a></div><div class="ttdeci">see the section ref comments a more detailed discussion of this technique n n That s all ! Here is the the Rayleigh as usual referenced by a pointer to a double precision dontinclude boussinesq_elements h skipline Rayleigh until Ra_pt with suitable access functions dontinclude boussinesq_elements h skipline Access until ra_pt The constructor calls the constructors of the component classes(\c QCrouzeixRaviartElement and \c QAdvectionDiffusionElement) and initialises the value of the Rayleigh number to zero</div></div>
<div class="ttc" id="ab__convection_8txt_html_ab56a0e8dabe1e9e6a7fd6913e6448220"><div class="ttname"><a href="b__convection_8txt.html#ab56a0e8dabe1e9e6a7fd6913e6448220">and</a></div><div class="ttdeci">see the section ref comments a more detailed discussion of this technique n n That s all ! Here is the the Rayleigh as usual referenced by a pointer to a double precision dontinclude boussinesq_elements h skipline Rayleigh until Ra_pt with suitable access functions dontinclude boussinesq_elements h skipline Access until ra_pt The constructor calls the constructors of the component via static a default parameter value dontinclude boussinesq_elements h skipline Constructor until We must overload the function c FiniteElement::required_nvalue() because the new element will store \c DIM+1 unknowns at each node although this does require knowledge of precisely how the governing equations were implemented in the single physics elements Once the source code for the c BuoyantQCrouzeixRaviartElement includes such an implementation and</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00622">b_convection.txt:622</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a6a9f7409ec2ef8ae0b6cfe6bba1c0519"><div class="ttname"><a href="b__convection_8txt.html#a6a9f7409ec2ef8ae0b6cfe6bba1c0519">dependent</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry pitchfork bifurcation at a critical Rayleigh number of f f see for example Hydrodynamic and Hydromagnetic Stability by S Chandrasekhar for f Ra f there are three possible steady all three states can be computed directly by solving the steady equations we typically find that if the steady computation is started with a zero initial guess for the velocity and the Newton method converges to the trivial state In order to demonstrate that this state is indeed unstable we therefore apply a time dependent</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00152">b_convection.txt:152</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a3f3e5c3d4c0d52729bf526e9405fb131"><div class="ttname"><a href="b__convection_8txt.html#a3f3e5c3d4c0d52729bf526e9405fb131">Here</a></div><div class="ttdeci">nard problem The lower wall is maintained at a temperature f where f f where f Delta rho f is the variation in density and f we can use the linear relationship f[\Delta\rho=-\alpha\rho_{0}(\theta^{ *} - \theta_{0}), \f] where f alpha f is the coefficient of thermal expansion of the f we have&lt; center &gt; f Here[\rho_{0} \left(\frac{\partial u^{ *}_i}{\partial t^{ *}}+u^{ *}_j \frac{\partial u^{ *}_i}{\partial x^{ *}_j} \right)=- \frac{\partial p^{ *}}{\partial x^{ *}_i}+\left[\rho_{0} - \alpha\rho_{0}(\theta^{ *} - \theta_{0})\right] G^{ *}_i+\mu_{0}\frac{\partial }{\partial x^{ *}_j} \left[\frac{\partial u^{ *}_i}{\partial x^{ *}_j}+\frac{\partial u^{ *}_j}{\partial x^{ *}_i} \right],\f]&lt;/center &gt; and&lt; center &gt; f[\frac{\partial u^{ *}_i}{\partial x^{ *}_i}=0.\f]&lt;/center &gt;</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00051">b_convection.txt:51</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a48431064d3f18e147d2752b7ffc29643"><div class="ttname"><a href="b__convection_8txt.html#a48431064d3f18e147d2752b7ffc29643">fluid</a></div><div class="ttdeci">nard problem The lower wall is maintained at a temperature f where f f where f Delta rho f is the variation in density and f we can use the linear relationship f[\Delta\rho=-\alpha\rho_{0}(\theta^{ *} - \theta_{0}), \f] where f alpha f is the coefficient of thermal expansion of th fluid)</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00027">b_convection.txt:27</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a2f3f74f086b1c9b68fd5f85f88059466"><div class="ttname"><a href="b__convection_8txt.html#a2f3f74f086b1c9b68fd5f85f88059466">value</a></div><div class="ttdeci">in the sketch this c Data is represented by the dashed box n n The two dimensional c QAdvectionDiffusionElement is based on the same geometric c FiniteElement and stores one value(the temperature, \f$ \theta \f$) at each \c Node. . Both elements are fully-functional and provide their contributions to the global system of nonlinear algebraic equations that is solved by Newton 's method via the two member functions \c fill_in_contribution_to_residuals(...) and \c fill_in_contribution_to_jacobian(...). - The \c QAdvectionDiffusionElement 's member function \c fill_in_contribution_to_residuals(...) computes the element 's contribution to the global residual vector for a given &quot;wind&quot;. The &quot;wind&quot; is specified by its virtual member function \c get_wind_adv_diff(...) and in the&lt; A HREF</div></div>
<div class="ttc" id="ab__convection_8txt_html_a7b759b82c8692c82ee304c5f26280463"><div class="ttname"><a href="b__convection_8txt.html#a7b759b82c8692c82ee304c5f26280463">mbox</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad mbox</div><div class="ttdef"><b>Definition:</b> <a href="b__convection_8txt_source.html#l00125">b_convection.txt:125</a></div></div>
<div class="ttc" id="ab__convection_8txt_html_a5838c8613f0b47f19e71c46f00407c71"><div class="ttname"><a href="b__convection_8txt.html#a5838c8613f0b47f19e71c46f00407c71">OUP</a></div><div class="ttdeci">f and symmetry boundary conditions at the quad quad f We assume that gravity acts vertically downward so that f symmetry pitchfork bifurcation at a critical Rayleigh number of f f see for example Hydrodynamic and Hydromagnetic Stability by S Chandrasekhar OUP(1961). Thus</div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 18:16:32
        </div>
      </div>
    </footer>
</body>
</html>

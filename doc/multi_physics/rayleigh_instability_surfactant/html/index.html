<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: The Rayleigh&ndash;Plateau instability in the presence of an insoluble surfactant</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The Rayleigh&ndash;Plateau instability in the presence of an insoluble surfactant </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this tutorial we present an example of surface-transport equations in a free-surface Navier&ndash;Stokes problem. This is a multi-domain, multi-physics problem because there is a coupling between the equations on the surface and those in the bulk. The coupling from the bulk to the surface transport arises through the surface velocity in the surface transport equation. The coupling from the surface transport to bulk arises in a more subtle manner because the surface concentration affects the surface tension. In this tutorial, we describe how to use the existing framework to create surface transport equations and how to include them in a free-surface problem.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="example_problem"></a>
The example problem</h1>
<p>The problem to be solved is the evolution of an annular film of fluid on the inside of a solid cylinder in the presence of an insoluble surfactant on the interface: a modification of the classic Rayleigh&ndash;Plateau instability. For validation, we reproduce some of the results given in `A 2-D model of Rayleigh instability in capillary tubes &mdash; surfactant effects' by D. Campana, J. Di Paolo &amp; F. A. Saita, <em> Int. J. Multiphase Flow, </em> vol <b> 30 </b>, pp 431&ndash;454, (2004). Our formulation, however, is different from their approach as described in detail in our <a href="../../../navier_stokes/surface_theory/html/index.html">free-surface theory document. </a></p>
<center> <table class="doxtable">
<tr>
<td><center> <b> The unsteady axisymmetric free-surface Navier&ndash;Stokes equations with insoluble surfactant .</b> </center><p> Solve </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ Re \left[ St \frac{\partial u_r}{\partial t} + u_r \frac{\partial u_r}{\partial r} - \frac{u_\theta^2}{r} + u_z \frac{\partial u_r}{\partial z} \right] = -\frac{\partial p}{\partial r} + \left[ \frac{\partial^2 u_r}{\partial r^2} + \frac{1}{r}\frac{\partial u_r}{\partial r} - \frac{u_r}{r^2} + \frac{\partial^2 u_r}{\partial z^2} \right], \]" src="form_0.png" width="426" height="31"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Re \left[ St \frac{\partial u_\theta}{\partial t} + u_r \frac{\partial u_\theta}{\partial r} + \frac{u_r u_\theta}{r} + u_z \frac{\partial u_\theta}{\partial z} \right] = + \left[ \frac{\partial^2 u_\theta}{\partial r^2} + \frac{1}{r}\frac{\partial u_\theta}{\partial r} - \frac{u_\theta}{r^2} + \frac{\partial^2 u_\theta}{\partial z^2} \right], \]" src="form_1.png" width="410" height="31"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ Re \left[ St \frac{\partial u_z}{\partial t} + u_r \frac{\partial u_z}{\partial r} + u_z \frac{\partial u_z}{\partial z} \right] = -\frac{\partial p}{\partial z} + \left[ \frac{\partial^2 u_z}{\partial r^2} + \frac{1}{r}\frac{\partial u_z}{\partial r} + \frac{\partial^2 u_z}{\partial z^2} \right], \]" src="form_2.png" width="366" height="31"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial u_r}{\partial r} + \frac{u_r}{r} + \frac{\partial u_z}{\partial z} = 0 \ \ \ \ \ \ \ \ \ \ (1) \]" src="form_3.png" width="171" height="28"/>
</p>
<p> in the bulk fluid.</p>
<p class="intertd">The governing equations are subject to the no slip boundary conditions </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_r = u_\theta = u_z = 0 \ \ \ \ \ \ \ \ \ \ (2) \]" src="form_4.png" width="151" height="14"/>
</p>
<p> on the outer solid boundary ( <img class="formulaInl" alt="$ r = 1.0 $" src="form_5.png" width="40" height="9"/>) and the symmetry boundary conditions </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_z = u_\theta = 0 \ \ \ \ \ \ \ \ \ \ (3) \]" src="form_6.png" width="123" height="14"/>
</p>
<p> on the bottom ( <img class="formulaInl" alt="$ z = 0.0 $" src="form_7.png" width="39" height="9"/>) and top ( <img class="formulaInl" alt="$ z = \pi / \alpha $" src="form_8.png" width="45" height="14"/>) boundaries.</p>
<p class="intertd">We denote the position vector to the free surface by <img class="formulaInl" alt="$ \mathbf{R} $" src="form_9.png" width="13" height="10"/>, which is subject to the kinematic condition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left(u_i - St\, \frac{\partial R_i}{\partial t}\right) n_i = 0, \ \ \ \ \ \ \ \ \ \ (4) \]" src="form_10.png" width="180" height="31"/>
</p>
<p> and the dynamic condition </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \tau_{ij}^{[2]}n_j = \tau_{ij}^{[1]}n_j+\frac{1}{Ca}\left (\sigma \kappa n_i + \frac{\partial \sigma}{\partial s} t_{i} \right). \ \ \ \ \ \ \ \ \ \ (5) \]" src="form_11.png" width="264" height="31"/>
</p>
<p> where <img class="formulaInl" alt="$ \sigma = \sigma^{*} / \sigma_{ref} $" src="form_12.png" width="66" height="14"/> is the dimensionless surface tension relative to a reference value.</p>
<p class="intertd">An insoluble surfactant of surface concentration <img class="formulaInl" alt="$ \Gamma^{*}$" src="form_13.png" width="14" height="10"/> is non-dimensionalised with respect to a reference value <img class="formulaInl" alt="$ \Gamma = \Gamma^{*}/\Gamma_{ref} $" src="form_14.png" width="69" height="14"/> and obeys the surface transport equation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ St \left(\frac{\partial \Gamma}{\partial t} - \dot{\mbox{\boldmath$R$}} \mbox{\boldmath$\cdot$} \mbox{\boldmath$\nabla$}_{\!\!_{S}} \Gamma \right) + \mbox{\boldmath$\nabla$}_{\!\!_{S}} \mbox{\boldmath$\cdot$} \left(\Gamma \mbox{\boldmath$U$}\right) = \frac{1}{Pe_{s}} \mbox{\boldmath$\nabla$}_{\!\!_{S}}\mbox{\boldmath$\cdot$} \mbox{\boldmath$\nabla$}_{\!\!_{S}} \Gamma \]" src="form_15.png" width="254" height="31"/>
</p>
<p> on the interface.</p>
<p class="intertd">The surface tension is a function of the surfactant concentration <img class="formulaInl" alt="$ \sigma(\Gamma)$" src="form_16.png" width="24" height="14"/> and a linear equation of state is chosen </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma = 1 - \beta (\Gamma - 1). \]" src="form_17.png" width="96" height="14"/>
</p>
<p class="intertd">The symmetry boundary conditions on the bottom ( <img class="formulaInl" alt="$ z = 0.0 $" src="form_7.png" width="39" height="9"/>) and top ( <img class="formulaInl" alt="$ z = \pi / \alpha $" src="form_8.png" width="45" height="14"/>) boundaries are </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial \Gamma}{\partial z} = 0. \]" src="form_18.png" width="43" height="28"/>
</p>
<p class="endtd">Initially, the system is at rest and <img class="formulaInl" alt="$ \Gamma =1 $" src="form_19.png" width="31" height="9"/>. The free surface is moved into the position: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{R} = \left[1.0 - H*(1.0 + \epsilon\cos \left(\alpha z\right) \right] \mbox{\boldmath$e$}_{r} \]" src="form_20.png" width="189" height="14"/>
</p>
<p> where <img class="formulaInl" alt="$ \epsilon $" src="form_21.png" width="5" height="6"/> is a small parameter and <img class="formulaInl" alt="$ H$" src="form_22.png" width="11" height="10"/> is the undeformed film thickness.   </p>
</td></tr>
</table>
<br  />
 </center><hr  />
 <hr  />
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>We choose parameters based on those used to compute Figures 8 and 9 in Campana et al; namely <img class="formulaInl" alt="$ H = 0.2 $" src="form_23.png" width="44" height="10"/>, <img class="formulaInl" alt="$ Re = 40 $" src="form_24.png" width="44" height="10"/>, <img class="formulaInl" alt="$ St = 1$" src="form_25.png" width="35" height="10"/>, <img class="formulaInl" alt="$ Ca = H^{3} $" src="form_26.png" width="49" height="11"/>, <img class="formulaInl" alt="$ \alpha = 1.047 $" src="form_27.png" width="54" height="9"/>, <img class="formulaInl" alt="$ \epsilon = 10^{-3}$" src="form_28.png" width="46" height="11"/>, <img class="formulaInl" alt="$ \beta = 3.6 \times 10^{-3} $" src="form_29.png" width="81" height="14"/> and <img class="formulaInl" alt="$Pe_{S} = 4032$" src="form_30.png" width="64" height="13"/>. For these parameters, the system is unstable to the Rayleigh&ndash;Plateau instability and evolves towards a state in which the tube is completely occluded by the fluid at one end.</p>
<div class="image">
<img src="trace.gif" alt=""/>
<div class="caption">
Time trace of the radius of the interface at z=0 showing dramatic collapse near t=80. </div></div>
 <div class="image">
<img src="evolution.gif" alt=""/>
<div class="caption">
Evolution of the interface at times t=0, 10, 20, 30, 40, 50, 60, 70, 80 showing the developing lobe. </div></div>
 <div class="image">
<img src="evo_conc.gif" alt=""/>
<div class="caption">
Evolution of the surfactant concentration on the interface at times t=0, 10, 20, 30, 40, 50, 60, 70, 80 accumulation in the developing lobe caused by the reduced surface area and advective flow into the lobe. </div></div>
 <hr  />
 <hr  />
<h1><a class="anchor" id="global"></a>
Global parameters and functions</h1>
<p>The global parameters are simply the dimensionless parameters described above.</p>
 <div class="fragment"><div class="line"><span class="comment">//==start_of_namespace===================================================</span></div>
<div class="line"><span class="comment">/// Namespace for physical parameters</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// The parameter values are chosen to be those used in Figures 8, 9 </span></div>
<div class="line"><span class="comment"></span><span class="comment">/// in Campana et al.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Film thickness parameter</span></div>
<div class="line"> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a4d1da0a125f6044733e121f0f3d958ca">Film_Thickness</a> = 0.2;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Reynolds number</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Re</a> = 40.0;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Womersley number</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">ReSt</a> = <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Re</a>; <span class="comment">// (St = 1)</span></div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Product of Reynolds number and inverse of Froude number</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">ReInvFr</a> = 0.0; <span class="comment">// (Fr = 0)</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Capillary number</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Ca</a> = pow(<a class="code" href="namespaceGlobal__Physical__Variables.html#a4d1da0a125f6044733e121f0f3d958ca">Film_Thickness</a>,3.0);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// External pressure</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">P_ext</a> = 0.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Direction of gravity</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; <a class="code" href="namespaceGlobal__Physical__Variables.html#af5ae275cf339105b9a54821c034df470">G</a>(3);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Wavelength of the domain</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Alpha</a> = 1.047;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Free surface cosine deformation parameter</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a28f21de3d342b1dab2fa0be362c6a944">Epsilon</a> = 1.0e-3;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Surface Elasticity number (weak case)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Beta</a> = 3.6e-3;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Surface Peclet number</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a99dc85e71075cd6efb06e692d8a15bcd">Peclet_S</a> = 4032.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Sufrace Peclet number multiplied by Strouhal number</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#abec1e1c8c78ade3a7b2e7396321c6466">Peclet_St_S</a> = 1.0; </div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Pvd file -- a wrapper for all the different</span></div>
<div class="line"><span class="comment"> /// vtu output files plus information about continuous time</span></div>
<div class="line"><span class="comment"> /// to facilitate animations in paraview</span></div>
<div class="line"><span class="comment"></span> ofstream <a class="code" href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Pvd_file</a>;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// End of namespace</span></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdoc">Namepspace for global parameters, chosen from Campana et al. as in the axisymmetric problem.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00051">3d_rayleigh_instability_surfactant.cc:52</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0406c0cbd463d1df2458fe5de98a00eb"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">Global_Physical_Variables::P_ext</a></div><div class="ttdeci">double P_ext</div><div class="ttdoc">External pressure.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00074">rayleigh_instability_insoluble_surfactant.cc:74</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a085ee4bf968ffdd01a41b8c41864f907"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a></div><div class="ttdeci">double ReSt</div><div class="ttdoc">Womersley = Reynolds times Strouhal.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00060">3d_rayleigh_instability_surfactant.cc:60</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a28f21de3d342b1dab2fa0be362c6a944"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a28f21de3d342b1dab2fa0be362c6a944">Global_Physical_Variables::Epsilon</a></div><div class="ttdeci">double Epsilon</div><div class="ttdoc">Free surface cosine deformation parameter.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00075">3d_rayleigh_instability_surfactant.cc:75</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a351a17b52cfcabc688393423f3de361b"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Global_Physical_Variables::Beta</a></div><div class="ttdeci">double Beta</div><div class="ttdoc">Surface Elasticity number (weak case)</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00078">3d_rayleigh_instability_surfactant.cc:78</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a4d1da0a125f6044733e121f0f3d958ca"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a4d1da0a125f6044733e121f0f3d958ca">Global_Physical_Variables::Film_Thickness</a></div><div class="ttdeci">double Film_Thickness</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00054">3d_rayleigh_instability_surfactant.cc:54</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a4f2fe790aa186202e4e2d5f6ee21d7f4"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Global_Physical_Variables::Pvd_file</a></div><div class="ttdeci">ofstream Pvd_file</div><div class="ttdoc">Pvd file – a wrapper for all the different vtu output files plus information about continuous time to...</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00097">rayleigh_instability_insoluble_surfactant.cc:97</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a8b32b93d2e546f9375ec418474107838"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Global_Physical_Variables::Ca</a></div><div class="ttdeci">double Ca</div><div class="ttdoc">Capillary number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00066">3d_rayleigh_instability_surfactant.cc:66</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a99dc85e71075cd6efb06e692d8a15bcd"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a99dc85e71075cd6efb06e692d8a15bcd">Global_Physical_Variables::Peclet_S</a></div><div class="ttdeci">double Peclet_S</div><div class="ttdoc">Surface Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00081">3d_rayleigh_instability_surfactant.cc:81</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa2e802ee7cc8e1ac900ba94c3ce86eb7"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Global_Physical_Variables::Alpha</a></div><div class="ttdeci">double Alpha</div><div class="ttdoc">Wavelength of the domain.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00072">3d_rayleigh_instability_surfactant.cc:72</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa6286f02b476912dd7550eced538331a"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">Global_Physical_Variables::ReInvFr</a></div><div class="ttdeci">double ReInvFr</div><div class="ttdoc">Product of Reynolds and Froude number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00063">3d_rayleigh_instability_surfactant.cc:63</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00057">3d_rayleigh_instability_surfactant.cc:57</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_abec1e1c8c78ade3a7b2e7396321c6466"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#abec1e1c8c78ade3a7b2e7396321c6466">Global_Physical_Variables::Peclet_St_S</a></div><div class="ttdeci">double Peclet_St_S</div><div class="ttdoc">Sufrace Peclet number multiplied by Strouhal number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00084">3d_rayleigh_instability_surfactant.cc:84</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af5ae275cf339105b9a54821c034df470"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af5ae275cf339105b9a54821c034df470">Global_Physical_Variables::G</a></div><div class="ttdeci">Vector&lt; double &gt; G(3)</div><div class="ttdoc">Direction of gravity.</div></div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="main"></a>
The driver code and problem class</h1>
<p>The driver code and problem are very similar to those in the <a href="../../../navier_stokes/single_layer_free_surface/html/index.html">two-dimensional </a> and <a href="../../../axisym_navier_stokes/two_layer_interface_axisym/html/index.html">axisymmetric </a> interface-relaxation problems on which this driver was based. The main difference between this problem and standard free surface problems is that instead of <br  />
 <a class="el" href="classoomph_1_1SpineAxisymmetricFluidInterfaceElement.html">oomph::SpineAxisymmetricFluidInterfaceElement</a>, we use the custom <a class="el" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html" title="Spine-based Marangoni surface tension elements that add a linear dependence on concentration of a sur...">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement</a>. The symmetry boundary conditions for the surface concentration are the natural boundary conditions of our formulation, so we "do
 nothing" for the additional field at the boundaries.</p>
<p>An additional member function <code><a class="el" href="classInterfaceProblem.html#a9b19bc90667fe8c7885d8ee113812e27" title="Compute the total mass.">InterfaceProblem::compute_total_mass()</a></code> is provided as a check on the implementation of the the surface transport equations. The surfactant cannot be removed from the surface, so its mass must be conserved. The function simply loops over the interface elements and sums their contribution to the total mass.  </p><div class="fragment"><div class="line"> <span class="comment">/// Compute the total mass of the insoluble surfactant</span></div>
<div class="line"> <span class="keywordtype">double</span> compute_total_mass()</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Initialise to zero</span></div>
<div class="line">   <span class="keywordtype">double</span> mass = 0.0;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Determine number of 1D interface elements in mesh</span></div>
<div class="line">   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_interface_element = Interface_mesh_pt-&gt;nelement();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Loop over the interface elements</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_interface_element;e++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line">     SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;* el_pt = </div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span>SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span></div>
<div class="line">      (Interface_mesh_pt-&gt;element_pt(e));</div>
<div class="line">     <span class="comment">//Add contribution from each element</span></div>
<div class="line">     mass += el_pt-&gt;integrate_c();</div>
<div class="line">    }</div>
<div class="line">   <span class="keywordflow">return</span> mass;</div>
<div class="line">  } <span class="comment">// End of compute_total_mass</span></div>
</div><!-- fragment --> <hr  />
 <hr  />
<h1><a class="anchor" id="element"></a>
The SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement class</h1>
<p>This class is implemented in our driver code and inherits directly from <a class="el" href="classoomph_1_1SpineAxisymmetricFluidInterfaceElement.html">oomph::SpineAxisymmetricFluidInterfaceElement</a>. The class provides storage for the required additional dimensionless groups and the nodal index where the surface concentration will be stored.  </p><div class="fragment"><div class="line"><span class="comment">/// Spine-based Marangoni surface tension elements that add</span></div>
<div class="line"><span class="comment">/// a linear dependence on concentration</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// of a surface chemical to the surface tension, </span></div>
<div class="line"><span class="comment"></span><span class="comment">/// which decreases with increasing concentration.</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// The non-dimensionalisation is the same as Campana et al (2004)</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// but we may wish to revisit this.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span>SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement : </div>
<div class="line">  <span class="keyword">public</span> SpineAxisymmetricFluidInterfaceElement&lt;ELEMENT&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><span class="comment"> /// Pointer to an Elasticity number</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">double</span> *Beta_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to Surface Peclet number</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">double</span> *Peclet_S_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to the surface Peclect Strouhal number</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">double</span> *Peclet_Strouhal_S_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Index at which the surfactant concentration is stored at the</span></div>
<div class="line"><span class="comment"> /// nodes</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> C_index;</div>
</div><!-- fragment --><p> Most of the functionality is already provided by the underlying <code>FluidInterfaceElement</code> and we need simply to overload a few functions. The constructor sets default values for the physical constants and adds the additional data value to nodes on the surface. </p><div class="fragment"><div class="line"> <span class="comment">/// Constructor that passes the bulk element and face index down</span></div>
<div class="line"><span class="comment"> /// to the underlying</span></div>
<div class="line"><span class="comment"></span>  SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement(FiniteElement* <span class="keyword">const</span> &amp;element_pt, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;face_index) : SpineAxisymmetricFluidInterfaceElement&lt;ELEMENT&gt;</div>
<div class="line">                                                                                                                       (element_pt,face_index)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Initialise the values</span></div>
<div class="line">   Beta_pt = &amp;Default_Physical_Constant_Value;</div>
<div class="line">   Peclet_S_pt = &amp;Default_Physical_Constant_Value;</div>
<div class="line">   Peclet_Strouhal_S_pt = &amp;Default_Physical_Constant_Value;</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Add the additional surfactant terms to these surface elements</span></div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Read out the number of nodes on the face</span></div>
<div class="line">   <span class="comment">//For some reason I need to specify the this pointer here(!)</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n_node_face = this-&gt;nnode();</div>
<div class="line">   <span class="comment">//Set the additional data values in the face</span></div>
<div class="line">   <span class="comment">//There is one additional values at each node --- the lagrange multiplier</span></div>
<div class="line">   Vector&lt;unsigned&gt; additional_data_values(n_node_face);</div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_node_face;i++) additional_data_values[i] = 1;</div>
<div class="line">   <span class="comment">//Resize the data arrays accordingly </span></div>
<div class="line">   this-&gt;resize_nodes(additional_data_values);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//The C_index is the new final value</span></div>
<div class="line">   <span class="comment">//Minor HACK HERE</span></div>
<div class="line">   C_index = this-&gt;node_pt(0)-&gt;nvalue()-1;</div>
<div class="line">}</div>
</div><!-- fragment --><p> The function <code>FluidInterfaceElement::sigma()</code> is overloaded using the equation of state defined in the problem specification  </p><div class="fragment"><div class="line"> <span class="keywordtype">double</span> sigma(<span class="keyword">const</span> Vector&lt;double&gt; &amp;s)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Find the number of shape functions</span></div>
<div class="line">   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line">   <span class="comment">//Now get the shape fuctions at the local coordinate</span></div>
<div class="line">   Shape psi(n_node);</div>
<div class="line">   this-&gt;shape(s,psi);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Now interpolate the surfactant concentration</span></div>
<div class="line">   <span class="keywordtype">double</span> C=0.0;</div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line">    {</div>
<div class="line">     C += this-&gt;nodal_value(l,C_index)*psi(l);</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Get the Elasticity number</span></div>
<div class="line">   <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Beta</a> = this-&gt;beta();</div>
<div class="line">   <span class="comment">//Return the variable surface tension</span></div>
<div class="line">   <span class="keywordflow">return</span> (1.0 - <a class="code" href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Beta</a>*(C-1.0));</div>
<div class="line">  } <span class="comment">// End of sigma</span></div>
</div><!-- fragment --><p> The majority of the work is performed in </p><div class="fragment"><div class="line">  <span class="keywordtype">void</span> add_additional_residual_contributions_interface(Vector&lt;double&gt; &amp;residuals, DenseMatrix&lt;double&gt; &amp;jacobian,</div>
<div class="line">                                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;flag,<span class="keyword">const</span> Shape &amp;psif, <span class="keyword">const</span> DShape &amp;dpsifds,</div>
<div class="line">                                                       <span class="keyword">const</span> DShape &amp;dpsifdS, <span class="keyword">const</span> DShape &amp;dpsifdS_div,</div>
<div class="line">                                                       <span class="keyword">const</span> Vector&lt;double&gt; &amp;s,</div>
<div class="line">                                                       <span class="keyword">const</span> Vector&lt;double&gt; &amp;interpolated_x, <span class="keyword">const</span> Vector&lt;double&gt; &amp;interpolated_n, </div>
<div class="line">                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;W,<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;J)</div>
<div class="line">  {</div>
</div><!-- fragment --><p> which provides the additional surface transport equations. In the example code two formulations of the surface transport equations are provided the one used by Campana et al in which the curvature is computed explicitly and the formulation derived in our <a href="../../../navier_stokes/surface_theory/html/index.html">free-surface theory, </a> in which the curvature is not required. The version used is determined by an internal boolean </p><div class="fragment"><div class="line">   <span class="comment">//Flag to control whether the Campana formulation (false) </span></div>
<div class="line">   <span class="comment">// or our own (true) is used</span></div>
<div class="line">   <span class="keywordtype">bool</span> Integrated_curvature = <span class="keyword">true</span>;</div>
</div><!-- fragment --><p> The remainder of the function adds the residuals associated with the surfactant transport equations which are described in the <a href="../../../navier_stokes/surface_theory/html/index.html">free-surface theory. </a> Note that an additional term arises due to the azimuthal curvature compared to the standard one-dimensional surface.</p>
<p>The function <code>fill_in_contribution_to_jacobian(...)</code> is also overloaded to that the effect of surfactant concentration on the bulk equations is computed by finite differences. This could be modified in the future so that the appropriate derivative terms are included in <code>add_additional_residual_contributions_interface(...)</code>.</p>
<p>Finally the elements contain a function </p><div class="fragment"><div class="line"> <span class="keywordtype">double</span> integrate_c() const</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Find out how many nodes there are</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set up memeory for the shape functions</span></div>
<div class="line">   Shape psif(n_node);</div>
<div class="line">   DShape dpsifds(n_node,1);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Set the value of n_intpt</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Storage for the local coordinate</span></div>
<div class="line">   Vector&lt;double&gt; s(1);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Storage for the total mass</span></div>
<div class="line">   <span class="keywordtype">double</span> mass = 0.0;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Loop over the integration points</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Get the local coordinate at the integration point</span></div>
<div class="line">     s[0] = this-&gt;integral_pt()-&gt;knot(ipt,0);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Get the integral weight</span></div>
<div class="line">     <span class="keywordtype">double</span> W = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Call the derivatives of the shape function</span></div>
<div class="line">     this-&gt;dshape_local_at_knot(ipt,psif,dpsifds);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Define and zero the tangent Vectors and local velocities</span></div>
<div class="line">     Vector&lt;double&gt; interpolated_x(2,0.0);</div>
<div class="line">     Vector&lt;double&gt; interpolated_t(2,0.0);</div>
<div class="line">     <span class="keywordtype">double</span> interpolated_c = 0.0;</div>
<div class="line">     </div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Loop over the shape functions to compute concentration and tangent</span></div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line">      {</div>
<div class="line">       interpolated_c += this-&gt;nodal_value(l,C_index)*psif(l);</div>
<div class="line">       <span class="comment">//Calculate the tangent vector</span></div>
<div class="line">       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line">        {</div>
<div class="line">         interpolated_x[i] += this-&gt;nodal_position(l,i)*psif(l);</div>
<div class="line">         interpolated_t[i] += this-&gt;nodal_position(l,i)*dpsifds(l,0);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//The first positional coordinate is the radial coordinate</span></div>
<div class="line">     <span class="keywordtype">double</span> r = interpolated_x[0];</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Calculate the length of the tangent Vector</span></div>
<div class="line">   <span class="keywordtype">double</span> tlength = interpolated_t[0]*interpolated_t[0] + </div>
<div class="line">    interpolated_t[1]*interpolated_t[1];</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set the Jacobian of the line element</span></div>
<div class="line">   <span class="keywordtype">double</span> J = sqrt(tlength);</div>
<div class="line"> </div>
<div class="line">   mass += interpolated_c*r*W*J;</div>
<div class="line">    }</div>
<div class="line">   <span class="keywordflow">return</span> mass;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//Define the default physical value to be one</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">double</span> SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;::Default_Physical_Constant_Value = 1.0;</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Inherit from the standard Horizontal single-layer SpineMesh</span></div>
<div class="line"><span class="comment">/// and modify the spine_node_update() function so that it is appropriate</span></div>
<div class="line"><span class="comment">/// for an annular film, rather than a fluid fibre.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span>MyHorizontalSingleLayerSpineMesh : </div>
<div class="line">  <span class="keyword">public</span> HorizontalSingleLayerSpineMesh&lt;ELEMENT&gt;</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: Pass number of elements in x-direction, number of</span></div>
<div class="line"><span class="comment"> /// elements in y-direction, radial extent, axial length , and pointer </span></div>
<div class="line"><span class="comment"> /// to timestepper (defaults to Steady timestepper)</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html#a0bd73ed947e30341144d081df52332b5">MyHorizontalSingleLayerSpineMesh</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, </div>
<div class="ttc" id="aclassoomph_1_1MyHorizontalSingleLayerSpineMesh_html_a0bd73ed947e30341144d081df52332b5"><div class="ttname"><a href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html#a0bd73ed947e30341144d081df52332b5">oomph::MyHorizontalSingleLayerSpineMesh::MyHorizontalSingleLayerSpineMesh</a></div><div class="ttdeci">MyHorizontalSingleLayerSpineMesh(const unsigned &amp;nx, const unsigned &amp;ny, const double &amp;lx, const double &amp;ly, TimeStepper *time_stepper_pt=&amp;Mesh::Default_TimeStepper)</div><div class="ttdoc">Constructor: Pass number of elements in x-direction, number of elements in y-direction,...</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00718">rayleigh_instability_insoluble_surfactant.cc:718</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00112">3d_rayleigh_instability_surfactant.cc:113</a></div></div>
</div><!-- fragment --><p> that computes the integral of the concentration over the elemental surface, representing the total mass of surfactant within the element.</p>
<hr  />
 <hr  />
<h2><a class="anchor" id="exercises"></a>
Exercises</h2>
<ol type="1">
<li>Investigate the difference between the solutions for the two formulations of the surfactant transport equations. Which conserves mass more accurately? <br  />
<br  />
</li>
<li>Investigate the influence of variations in <img class="formulaInl" alt="$\beta$" src="form_31.png" width="9" height="13"/> and try to reproduce the results found by Campana et al.</li>
<li>Look at the three-dimensional (non-axisymmetric) version of the code found in the same directory. Confirm that the same results are produced. Is the instability stable to non-axisymmetric perturbations? Use the code to investigate what happens if you make the cross-sectional boundary slightly elliptical rather than circular?</li>
</ol>
<hr  />
 <hr  />
 <h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
<center> <a href="../../../../demo_drivers/multi_physics/rayleigh_instability_surfactant">demo_drivers/multi_physics/rayleigh_instability_surfactant </a> </center> <br  />
<br  />
 which contains refineable and non-refineable multi-domain versions of the Boussinesq convection problem. <br  />
<br  />
</li>
<li>The full driver code for the problem described in this tutorial is:<br  />
<br  />
<center> <a href="
../../../../
demo_drivers/multi_physics/rayleigh_instability_surfactant/rayleigh_instability_insoluble_surfactant.cc
">demo_drivers/multi_physics/rayleigh_instability_surfactant/rayleigh_instability_insoluble_surfactant.cc </a> </center> <br  />
<br  />
</li>
<li>The corresponding driver code for the non-refineable version of the problem is:<br  />
<br  />
<center> <a href="
../../../../
demo_drivers/multi_physics/boussinesq_convection/multi_domain_boussinesq_convection.cc
">demo_drivers/multi_physics/boussinesq_convection/multi_domain_boussinesq_convection.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Dec 19 2024 11:32:59
        </div>
      </div>
    </footer>
</body>
</html>

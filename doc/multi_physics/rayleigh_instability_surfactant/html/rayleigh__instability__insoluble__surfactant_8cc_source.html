<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: rayleigh_instability_insoluble_surfactant.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_7da5dbffa6769dc9eed5368d3005526a.html">multi_physics</a></li><li class="navelem"><a class="el" href="dir_358f0367c412e67c7214faeb24130143.html">rayleigh_instability_surfactant</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">rayleigh_instability_insoluble_surfactant.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="rayleigh__instability__insoluble__surfactant_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// Driver for axisymmetric single-layer fluid problem. Plateau-Rayleigh </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// instability (unstable if H&gt;2*pi*R -&gt; forming drops)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// in the presence of an insoluble surfactant. The problem is described in</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// A 2-D model of Rayleigh instability in capillary tubes --- surfactant </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// effects by D. Campana, J. Di Paolo &amp; F. A. Saita, Int. J. Multiphase Flow,</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// vol 30, pp 431--454, (2004).</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">// The initial version of this code was developed by Aman Rajvardhan.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// Generic oomph-lib header</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// Axisymmetric Navier-Stokes headers</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;axisym_navier_stokes.h&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// Interface headers</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;fluid_interface.h&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// The mesh, including horizontal spines</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;meshes/horizontal_single_layer_spine_mesh.h&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//Use the oomph and std namespaces </span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceoomph.html">oomph</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//==start_of_namespace===================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/// Namespace for physical parameters</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/// The parameter values are chosen to be those used in Figures 8, 9 </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/// in Campana et al.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">//Film thickness parameter</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a4d1da0a125f6044733e121f0f3d958ca">Film_Thickness</a> = 0.2;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> /// Reynolds number</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Re</a> = 40.0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> /// Womersley number</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">ReSt</a> = <a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Re</a>; <span class="comment">// (St = 1)</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> /// Product of Reynolds number and inverse of Froude number</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">ReInvFr</a> = 0.0; <span class="comment">// (Fr = 0)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> /// Capillary number</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Ca</a> = pow(<a class="code" href="namespaceGlobal__Physical__Variables.html#a4d1da0a125f6044733e121f0f3d958ca">Film_Thickness</a>,3.0);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"> /// External pressure</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">   74</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">P_ext</a> = 0.0;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> /// Direction of gravity</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span> Vector&lt;double&gt; <a class="code" href="namespaceGlobal__Physical__Variables.html#af5ae275cf339105b9a54821c034df470">G</a>(3);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> /// Wavelength of the domain</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Alpha</a> = 1.047;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> /// Free surface cosine deformation parameter</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a28f21de3d342b1dab2fa0be362c6a944">Epsilon</a> = 1.0e-3;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> /// \short Surface Elasticity number (weak case)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Beta</a> = 3.6e-3;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"> /// \short Surface Peclet number</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a99dc85e71075cd6efb06e692d8a15bcd">Peclet_S</a> = 4032.0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> /// \short Sufrace Peclet number multiplied by Strouhal number</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#abec1e1c8c78ade3a7b2e7396321c6466">Peclet_St_S</a> = 1.0; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> /// \short Pvd file -- a wrapper for all the different</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> /// vtu output files plus information about continuous time</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> /// to facilitate animations in paraview</span></div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">   97</a></span>&#160;<span class="comment"></span> ofstream <a class="code" href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Pvd_file</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;} <span class="comment">// End of namespace</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">//==================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">///Spine-based Marangoni surface tension elements that add</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">///a linear dependence on concentration</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">///of a surface chemical to the surface tension, </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">///which decreases with increasing concentration.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">///The non-dimensionalisation is the same as Campana et al (2004)</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">///but we may wish to revisit this.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span><span class="comment">//=================================================================</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">  115</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement</a> : </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keyword">public</span> <a class="code" href="classoomph_1_1SpineAxisymmetricFluidInterfaceElement.html">SpineAxisymmetricFluidInterfaceElement</a>&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;{</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> /// Pointer to an Elasticity number</span></div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a3884b52470fdf8d031224e2f7060e56d">  120</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> *<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a3884b52470fdf8d031224e2f7060e56d">Beta_pt</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> /// Pointer to Surface Peclet number</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a71f8f35b8f8db2341c9eedee754c957a">  123</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> *<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a71f8f35b8f8db2341c9eedee754c957a">Peclet_S_pt</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> /// Pointer to the surface Peclect Strouhal number</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a8e2a9a53bcc19471bcb36ed2c169fb57">  126</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> *<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a8e2a9a53bcc19471bcb36ed2c169fb57">Peclet_Strouhal_S_pt</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> /// Index at which the surfactant concentration is stored at the</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> /// nodes</span></div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a81a18102b611767a582804f1acdc8143">  130</a></span>&#160;<span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a81a18102b611767a582804f1acdc8143">C_index</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> /// Default value of the physical constants</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a652e8408b5cc7af8b934d895782b8ff5">  133</a></span>&#160;<span class="comment"></span> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a652e8408b5cc7af8b934d895782b8ff5">Default_Physical_Constant_Value</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> ///Get the surfactant concentration</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a8f0df8c1e9120011fa51b15ab2694d34">  138</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a8f0df8c1e9120011fa51b15ab2694d34">interpolated_C</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;s)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;     <span class="comment">//Find number of nodes</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="comment">//Get the nodal index at which the unknown is stored</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> c_index = C_index;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="comment">//Local shape function</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   Shape psi(n_node);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="comment">//Find values of shape function</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   this-&gt;shape(s,psi);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="comment">//Initialise value of C</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="keywordtype">double</span> C = 0.0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">//Loop over the local nodes and sum</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++) </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;       C += this-&gt;nodal_value(l,c_index)*psi(l);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;     }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">return</span>(C);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> /// The time derivative of the surface concentration</span></div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a7ee3faea2d8e082efde048e7adb9e9c1">  165</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a7ee3faea2d8e082efde048e7adb9e9c1">dcdt_surface</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;l)<span class="keyword"> const</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="comment">// Get the data&#39;s timestepper</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    TimeStepper* time_stepper_pt= this-&gt;node_pt(l)-&gt;time_stepper_pt();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="comment">//Initialise dudt</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">double</span> dcdt=0.0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="comment">//Loop over the timesteps, if there is a non Steady timestepper</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (time_stepper_pt-&gt;type()!=<span class="stringliteral">&quot;Steady&quot;</span>)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;     <span class="comment">//Find the index at which the variable is stored</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> c_index = C_index;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;     <span class="comment">// Number of timsteps (past &amp; present)</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_time = time_stepper_pt-&gt;ntstorage();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;     </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> t=0;t&lt;n_time;t++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;       dcdt += time_stepper_pt-&gt;weight(1,t)*this-&gt;nodal_value(t,l,c_index);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">return</span> dcdt;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> /// The surface tension function is linear in the</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> /// concentration with constant of proportionality equal</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> /// to the elasticity  number.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a7312e78a1b5449ea2ff6d856a4fd9c46">  192</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a7312e78a1b5449ea2ff6d856a4fd9c46">sigma</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;s)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="comment">//Find the number of shape functions</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="comment">//Now get the shape fuctions at the local coordinate</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   Shape psi(n_node);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   this-&gt;shape(s,psi);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="comment">//Now interpolate the surfactant concentration</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <span class="keywordtype">double</span> C=0.0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;     C += this-&gt;nodal_value(l,C_index)*psi(l);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="comment">//Get the Elasticity number</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Beta</a> = this-&gt;beta();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   <span class="comment">//Return the variable surface tension</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="keywordflow">return</span> (1.0 - <a class="code" href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Beta</a>*(C-1.0));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  } <span class="comment">// End of sigma</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> /// \short Fill in the contribution to the residuals</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> /// Calculate the contribution to the jacobian</span></div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#aa34b8b5ac73054e367fd321bf1ae6346">  215</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#aa34b8b5ac73054e367fd321bf1ae6346">fill_in_contribution_to_jacobian</a>(Vector&lt;double&gt; &amp;residuals,DenseMatrix&lt;double&gt; &amp;jacobian)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="comment">//Call the generic routine with the flag set to 1</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    this-&gt;fill_in_generic_residual_contribution_interface(residuals,jacobian,1);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">//Use finite differences to handle concentration variations in the</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">//bulk equations</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">//Find the number of dofs in the element</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dof = this-&gt;ndof();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">//Create newres vector</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    Vector&lt;double&gt; newres(n_dof);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">//Integer storage for local unknown</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">int</span> local_unknown=0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">//Use the default finite difference step</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> fd_step = this-&gt;Default_fd_jacobian_step;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">//Loop over the nodes again</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;     {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">//Get the number of values stored at the node</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordtype">unsigned</span> c_index = this-&gt;C_index;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">//Get the local equation number</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      local_unknown = this-&gt;nodal_local_eqn(n,c_index);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="comment">//If it&#39;s not pinned</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;       {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">//Store a pointer to the nodal data value</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordtype">double</span> *value_pt = this-&gt;node_pt(n)-&gt;value_pt(c_index);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="comment">//Save the old value of the Nodal data</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordtype">double</span> old_var = *value_pt;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">//Increment the value of the Nodal data</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        *value_pt += fd_step;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">//Calculate the new residuals</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        this-&gt;get_residuals(newres);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="comment">//Do finite differences</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> m=0;m&lt;n_dof;m++)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;         {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          <span class="keywordtype">double</span> sum = (newres[m] - residuals[m])/fd_step;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <span class="comment">//Stick the entry into the Jacobian matrix</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          jacobian(m,local_unknown) = sum;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">//Reset the Nodal data</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        *value_pt = old_var;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;       }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;     }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="comment">//Call the generic routine to handle the spine variables</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    SpineElement&lt;FaceGeometry&lt;ELEMENT&gt; &gt;::fill_in_jacobian_from_geometric_data(jacobian);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">  /// \short Overload the Helper function to calculate the residuals and </span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">  /// jacobian entries. This particular function ensures that the</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">  /// additional entries are calculated inside the integration loop</span></div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a56c90572b8969dff01a4baa9de850d91">  279</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a56c90572b8969dff01a4baa9de850d91">add_additional_residual_contributions_interface</a>(Vector&lt;double&gt; &amp;residuals, DenseMatrix&lt;double&gt; &amp;jacobian,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;flag,<span class="keyword">const</span> Shape &amp;psif, <span class="keyword">const</span> DShape &amp;dpsifds,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                                       <span class="keyword">const</span> DShape &amp;dpsifdS, <span class="keyword">const</span> DShape &amp;dpsifdS_div,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                                       <span class="keyword">const</span> Vector&lt;double&gt; &amp;s,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                                       <span class="keyword">const</span> Vector&lt;double&gt; &amp;interpolated_x, <span class="keyword">const</span> Vector&lt;double&gt; &amp;interpolated_n, </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                                       <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;W,<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;J)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <span class="comment">//Flag to control whether the Campana formulation (false) </span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <span class="comment">// or our own (true) is used</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   <span class="keywordtype">bool</span> Integrated_curvature = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="comment">//Storage for the local equation numbers and unknowns</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <span class="keywordtype">int</span> local_eqn = 0, local_unknown = 0;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="comment">//Surface advection-diffusion equation</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <span class="comment">//Find the index at which the concentration is stored</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keywordtype">unsigned</span> c_index = this-&gt;C_index;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   Vector&lt;unsigned&gt; u_index = this-&gt;U_index_interface;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="comment">//Read out the surface peclect number</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> Pe_s = this-&gt;peclet_s();</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <span class="comment">//const double PeSt_s = this-&gt;peclet_strouhal_s();</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="comment">//Read out the radial position</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> r = interpolated_x[0];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="comment">//Rescale the jacobian to be the &quot;raw&quot; version</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span> J_raw = J/r;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="comment">//Now calculate the concentration at this point</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="comment">//Assuming the same shape functions are used (which they are)</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <span class="keywordtype">double</span> interpolated_C = 0.0;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <span class="keywordtype">double</span> interpolated_dCds = 0.0;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordtype">double</span> dCdt = 0.0;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   <span class="comment">//The tangent vector</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ndim = this-&gt;node_pt(0)-&gt;ndim();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   Vector&lt;double&gt; interpolated_tangent(ndim,0.0);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   Vector&lt;double&gt; interpolated_u(ndim,0.0);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   Vector&lt;double&gt; mesh_velocity(ndim,0.0);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   Vector&lt;double&gt; interpolated_duds(ndim,0.0);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <span class="keywordflow">if</span>(ndim+1 != u_index.size())</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">throw</span> OomphLibError(<span class="stringliteral">&quot;Dimension Incompatibility&quot;</span>,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                          OOMPH_CURRENT_FUNCTION,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                          OOMPH_EXCEPTION_LOCATION);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;     {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> psi = psif(l);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span> dpsi = dpsifds(l,0);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;       interpolated_C += this-&gt;nodal_value(l,c_index)*psi;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;       interpolated_dCds += this-&gt;nodal_value(l,c_index)*dpsi;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;       dCdt += dcdt_surface(l)*psi;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;ndim;i++)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;         interpolated_tangent[i] += this-&gt;nodal_position(l,i)*dpsi;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         interpolated_u[i] += this-&gt;nodal_value(l,u_index[i])*psi;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;         interpolated_duds[i] += this-&gt;nodal_value(l,u_index[i])*dpsi;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;       <span class="comment">//Mesh Velocity</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j=0;j&lt;ndim;j++)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         mesh_velocity[j] += this-&gt;dnodal_position_dt(l,j)*psi;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;     }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="keywordtype">double</span> u_tangent = 0.0, t_length = 0.0;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;ndim;i++) </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;     {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;       u_tangent += interpolated_u[i]*interpolated_tangent[i];</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;       t_length  += interpolated_tangent[i]*interpolated_tangent[i];</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;     }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="comment">//Work out the second derivative of position</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   Vector&lt;double&gt; d2xds(2,0.0);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;     d2xds[i] = this-&gt;nodal_position(0,i) + </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      this-&gt;nodal_position(2,i) - 2.0*this-&gt;nodal_position(1,i);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="comment">//Let&#39;s do the first component of the curvature</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordtype">double</span> k1 = 0.0;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     k1 += (d2xds[i]/(J_raw*J_raw) - interpolated_tangent[i]*(</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;             interpolated_tangent[0]*d2xds[0] </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;             + interpolated_tangent[1]*d2xds[1])/(J_raw*J_raw*J_raw*J_raw))*interpolated_n[i];</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="comment">//Second component of the curvature</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <span class="keywordtype">double</span> k2 = - (interpolated_n[0] / r);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="comment">//Now we add the flux term to the appropriate residuals</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;     <span class="comment">//Read out the apprporiate local equation</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;     local_eqn = this-&gt;nodal_local_eqn(l,c_index);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;     </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     <span class="comment">//If not a boundary condition</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;     <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;       <span class="comment">//Time derivative</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;       residuals[local_eqn] += dCdt*psif(l)*r*W*J_raw;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;       <span class="keywordtype">double</span> tmp = 0.0;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;       <span class="comment">//Compute our version in which second derivatives are not required</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;       <span class="keywordflow">if</span>(Integrated_curvature)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;           tmp += </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            (interpolated_u[i] - mesh_velocity[i])*interpolated_tangent[i];</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;         <span class="comment">//First Advection term</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         residuals[local_eqn] += tmp*interpolated_dCds*psif(l)*r*W/J_raw;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;         <span class="comment">//Additional term from axisymmetric formulation</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         residuals[local_eqn] += interpolated_C*interpolated_u[0]*psif(l)*W*J_raw;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="comment">//Second Advection term</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;         residuals[local_eqn] += interpolated_C*</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          (interpolated_duds[0]*interpolated_tangent[0]</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;           + interpolated_duds[1]*interpolated_tangent[1])*r*W*psif(l)/J_raw;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;       <span class="comment">//This is the Campana formulation</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;         <span class="comment">//ALE term</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;           tmp += -mesh_velocity[i]*interpolated_tangent[i];</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;         residuals[local_eqn] += tmp*interpolated_dCds*psif(l)*r*W/J_raw;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;         <span class="comment">// Curvature (normal velocity) term</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         residuals[local_eqn] -= </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          interpolated_C*(k1 + k2)*psif(l)*r*W*J_raw*(</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;           interpolated_u[0]*interpolated_n[0]</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;           + interpolated_u[1]*interpolated_n[1]);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;         <span class="comment">//Integrated by parts tangential advection term</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;         residuals[local_eqn] -= interpolated_C*(</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          interpolated_tangent[0]*interpolated_u[0] + </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          interpolated_tangent[1]*interpolated_u[1])*dpsifds(l,0)*r*W/J_raw;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;       </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;       <span class="comment">//Diffusion term</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;       residuals[local_eqn] += (1.0/Pe_s)*interpolated_dCds*dpsifds(l,0)*r*W/J_raw;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;       </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;       <span class="comment">//We also need to worry about the jacobian terms</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;       <span class="keywordflow">if</span>(flag)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;         <span class="comment">//Loop over the nodes again</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;           <span class="comment">//Get the time stepper</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;           TimeStepper* time_stepper_pt=this-&gt;node_pt(l2)-&gt;time_stepper_pt();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;           </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;           <span class="comment">//Get the unknown c_index</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;           local_unknown =this-&gt;nodal_local_eqn(l2,c_index);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;           </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;           <span class="keywordflow">if</span>(local_unknown &gt;=0)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;             jacobian(local_eqn,local_unknown) += </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;              time_stepper_pt-&gt;weight(1,0)*psif(l2)*psif(l)*r*W*J_raw;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;             </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;             <span class="keywordflow">if</span>(Integrated_curvature)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;              {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;               jacobian(local_eqn,local_unknown) += ((interpolated_u[0] - mesh_velocity[0])*interpolated_tangent[0]</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                     + (interpolated_u[1] - mesh_velocity[1])*interpolated_tangent[1])*dpsifds(l2,0)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                *psif(l)*r*W/J_raw;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;               jacobian(local_eqn,local_unknown) += psif(l2)*interpolated_u[0]*psif(l)*W*J_raw;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;               </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;               jacobian(local_eqn,local_unknown) += psif(l2)*(interpolated_tangent[0]*interpolated_duds[0]</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                                              + interpolated_tangent[1]*interpolated_duds[1])*psif(l)*r*W/J_raw;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;              }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;             <span class="keywordflow">else</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;              {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;               jacobian(local_eqn,local_unknown) -=</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                (mesh_velocity[0]*interpolated_tangent[0] + mesh_velocity[1]*interpolated_tangent[1])*dpsifds(l2,0)*psif(l)*r*W/J_raw;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;               </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;               jacobian(local_eqn,local_unknown) -= psif(l2)*(k1 + k2)*psif(l)*r*W*J_raw*(interpolated_u[0]*interpolated_n[0]</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                                                                      + interpolated_u[1]*interpolated_n[1]);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;               </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;               jacobian(local_eqn,local_unknown) -= psif(l2)*(interpolated_tangent[0]*interpolated_u[0] + interpolated_tangent[1]*</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                                              interpolated_u[1])*dpsifds(l,0)*r*W/J_raw;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;              }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;             </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;             jacobian(local_eqn,local_unknown) += (1.0/Pe_s)*dpsifds(l2,0)*dpsifds(l,0)*r*W/J_raw;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;             </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;           <span class="comment">//Loop over the velocity components</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i2=0;i2&lt;ndim;i2++)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;             </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;             <span class="comment">//Get the unknown</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;             local_unknown = this-&gt;nodal_local_eqn(l2,u_index[i2]);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;             </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;             </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;             <span class="comment">//If not a boundary condition</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;             <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;              {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;               </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;               <span class="comment">// jacobian(local_eqn,local_unknown) += time_stepper_pt-&gt;weight(1,0)*psif(l2)*PeSt_s*psif(l)*r*W*J_raw;</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;               <span class="keywordflow">if</span>(Integrated_curvature)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                 jacobian(local_eqn,local_unknown) += </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                  interpolated_dCds*psif(l2)*interpolated_tangent[i2]*psif(l)*r*W/J_raw;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                 <span class="keywordflow">if</span>(i2==0)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                  {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                   jacobian(local_eqn,local_unknown) += interpolated_C*psif(l2)*W*J_raw;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                  }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;               <span class="keywordflow">else</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                 jacobian(local_eqn,local_unknown) -= interpolated_C*(k1 + k2)*psif(l)*r*W*J_raw*psif(l2)*interpolated_n[i2];</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                 </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                 jacobian(local_eqn,local_unknown) -=  interpolated_C*interpolated_tangent[i2]*psif(l2)*dpsifds(l,0)*r*W/J_raw;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;               </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;               jacobian(local_eqn,local_unknown) += </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                interpolated_C*interpolated_tangent[i2]*dpsifds(l2,0)*psif(l)*r*W/J_raw;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;              }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;          }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    } <span class="comment">//End of loop over the nodes</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  }  </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"> /// Add the element&#39;s contribution to its residuals vector,</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"> /// jacobian matrix and mass matrix</span></div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ab8e6a649149c0e1aadb95dc820b8be86">  521</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ab8e6a649149c0e1aadb95dc820b8be86">fill_in_contribution_to_jacobian_and_mass_matrix</a>( Vector&lt;double&gt; &amp;residuals, DenseMatrix&lt;double&gt; &amp;jacobian, </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                                         DenseMatrix&lt;double&gt; &amp;mass_matrix)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">//Add the contribution to the jacobian</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    this-&gt;fill_in_contribution_to_jacobian(residuals,jacobian);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">//No mass matrix terms, but should probably do kinematic bit here</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"> ///Constructor that passes the bulk element and face index down</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"> ///to the underlying</span></div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#acb97c1d7f3192309150432c840b34944">  532</a></span>&#160;<span class="comment"></span>  <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#acb97c1d7f3192309150432c840b34944">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement</a>(FiniteElement* <span class="keyword">const</span> &amp;element_pt, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;face_index) : <a class="code" href="classoomph_1_1SpineAxisymmetricFluidInterfaceElement.html">SpineAxisymmetricFluidInterfaceElement</a>&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                                                                                                       (element_pt,face_index)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <span class="comment">//Initialise the values</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   Beta_pt = &amp;Default_Physical_Constant_Value;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   Peclet_S_pt = &amp;Default_Physical_Constant_Value;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   Peclet_Strouhal_S_pt = &amp;Default_Physical_Constant_Value;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="comment">//Add the additional surfactant terms to these surface elements</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <span class="comment">//Read out the number of nodes on the face</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <span class="comment">//For some reason I need to specify the this pointer here(!)</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="keywordtype">unsigned</span> n_node_face = this-&gt;nnode();</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="comment">//Set the additional data values in the face</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="comment">//There is one additional values at each node --- the lagrange multiplier</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   Vector&lt;unsigned&gt; additional_data_values(n_node_face);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_node_face;i++) additional_data_values[i] = 1;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="comment">//Resize the data arrays accordingly </span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   this-&gt;resize_nodes(additional_data_values);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <span class="comment">//The C_index is the new final value</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="comment">//Minor HACK HERE</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   C_index = this-&gt;node_pt(0)-&gt;nvalue()-1;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"> ///Return the Elasticity number</span></div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a898d0f93192f1b42826a5fc1043f8534">  558</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a898d0f93192f1b42826a5fc1043f8534">beta</a>() {<span class="keywordflow">return</span> *Beta_pt;}</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"> ///Return the surface peclect number</span></div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a6a927de4f0ec496fce8114f5710f1db2">  561</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a6a927de4f0ec496fce8114f5710f1db2">peclet_s</a>() {<span class="keywordflow">return</span> *Peclet_S_pt;}</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"> ///Return the surface peclect strouhal number</span></div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a3af89ee44ddbf97c56f44b13117f5e7e">  564</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a3af89ee44ddbf97c56f44b13117f5e7e">peclet_strouhal_s</a>() {<span class="keywordflow">return</span> *Peclet_Strouhal_S_pt;}</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"> ///Access function for pointer to the Elasticity number</span></div>
<div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#adb3f668c377e5a8c3362e7bd7ac1d989">  567</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>* &amp;<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#adb3f668c377e5a8c3362e7bd7ac1d989">beta_pt</a>() {<span class="keywordflow">return</span> Beta_pt;}</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"> ///Access function for pointer to the surface Peclet number</span></div>
<div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ae8e42e0510d001c3e4874b0ad32fbe44">  570</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>* &amp;<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ae8e42e0510d001c3e4874b0ad32fbe44">peclet_s_pt</a>() {<span class="keywordflow">return</span> Peclet_S_pt;}</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> ///Access function for pointer to the surface Peclet x Strouhal number</span></div>
<div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a943d445ebca59b8c2eeb6584eeba366e">  573</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span>* &amp;<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a943d445ebca59b8c2eeb6584eeba366e">peclet_strouhal_s_pt</a>() {<span class="keywordflow">return</span> Peclet_Strouhal_S_pt;}</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ac69e8f0d0de52bcef7c2fa939c1ba2f1">  575</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ac69e8f0d0de52bcef7c2fa939c1ba2f1">output</a>(std::ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_plot)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   outfile.precision(16);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <span class="comment">//Set output Vector</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   Vector&lt;double&gt; s(1);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="comment">//Tecplot header info </span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   outfile &lt;&lt; <span class="stringliteral">&quot;ZONE I=&quot;</span> &lt;&lt; n_plot &lt;&lt; std::endl;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> dim = this-&gt;dim();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   Shape psi(n_node);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   DShape dpsi(n_node,dim);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="comment">//Loop over plot points</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_plot;l++)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        s[0] = -1.0 + l*2.0/(n_plot-1);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        this-&gt;dshape_local(s,psi,dpsi);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        Vector&lt;double&gt; interpolated_tangent(2,0.0);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;         {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> dpsi_ = dpsi(l,0);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;           {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            interpolated_tangent[i] += this-&gt;nodal_position(l,i)*dpsi_;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;           }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;         }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment">//Tangent</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordtype">double</span> t_vel = (this-&gt;interpolated_u(s,0)*interpolated_tangent[0] + this-&gt;interpolated_u(s,1)*interpolated_tangent[1])/</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;         sqrt(interpolated_tangent[0]*interpolated_tangent[0] + interpolated_tangent[1]*interpolated_tangent[1]);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="comment">//Output the x,y,u,v </span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++) outfile &lt;&lt; this-&gt;interpolated_x(s,i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++) outfile &lt;&lt; this-&gt;interpolated_u(s,i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;      </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="comment">//Output a dummy pressure</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        outfile &lt;&lt; 0.0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="comment">//Output the concentration</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        outfile &lt;&lt; interpolated_C(s) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="comment">//Output the interfacial tension</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        outfile &lt;&lt; <a class="code" href="rayleigh__instability__surfactant_8txt.html#a56933c4e69e45788991a5fdc8ba11a1d">sigma</a>(s) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; t_vel &lt;&lt; std::endl;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; outfile &lt;&lt; std::endl;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"> /// \short Compute the concentration intergated over the area</span></div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#aeb6b9fa726b084884c1e00291d077eea">  627</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#aeb6b9fa726b084884c1e00291d077eea">integrate_c</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="comment">//Find out how many nodes there are</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <span class="keywordtype">unsigned</span> n_node = this-&gt;nnode();</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   <span class="comment">//Set up memeory for the shape functions</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   Shape psif(n_node);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   DShape dpsifds(n_node,1);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <span class="comment">//Set the value of n_intpt</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <span class="keywordtype">unsigned</span> n_intpt = this-&gt;integral_pt()-&gt;nweight();</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="comment">//Storage for the local coordinate</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   Vector&lt;double&gt; s(1);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="comment">//Storage for the total mass</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="keywordtype">double</span> mass = 0.0;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <span class="comment">//Loop over the integration points</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;     <span class="comment">//Get the local coordinate at the integration point</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;     s[0] = this-&gt;integral_pt()-&gt;knot(ipt,0);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;     </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;     <span class="comment">//Get the integral weight</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;     <span class="keywordtype">double</span> W = this-&gt;integral_pt()-&gt;weight(ipt);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;     </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;     <span class="comment">//Call the derivatives of the shape function</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;     this-&gt;dshape_local_at_knot(ipt,psif,dpsifds);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;     </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;     <span class="comment">//Define and zero the tangent Vectors and local velocities</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;     Vector&lt;double&gt; interpolated_x(2,0.0);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;     Vector&lt;double&gt; interpolated_t(2,0.0);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;     <span class="keywordtype">double</span> interpolated_c = 0.0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;     </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;     </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;     <span class="comment">//Loop over the shape functions to compute concentration and tangent</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;       interpolated_c += this-&gt;nodal_value(l,C_index)*psif(l);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;       <span class="comment">//Calculate the tangent vector</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;2;i++)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;         interpolated_x[i] += this-&gt;nodal_position(l,i)*psif(l);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;         interpolated_t[i] += this-&gt;nodal_position(l,i)*dpsifds(l,0);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;     </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;     <span class="comment">//The first positional coordinate is the radial coordinate</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;     <span class="keywordtype">double</span> r = interpolated_x[0];</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <span class="comment">//Calculate the length of the tangent Vector</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <span class="keywordtype">double</span> tlength = interpolated_t[0]*interpolated_t[0] + </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    interpolated_t[1]*interpolated_t[1];</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="comment">//Set the Jacobian of the line element</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordtype">double</span> J = sqrt(tlength);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   mass += interpolated_c*r*W*J;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keywordflow">return</span> mass;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;};</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">//Define the default physical value to be one</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;::Default_Physical_Constant_Value</a> = 1.0;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceoomph.html">oomph</a></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;{</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">//======================================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">/// Inherit from the standard Horizontal single-layer SpineMesh</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">/// and modify the spine_node_update() function so that it is appropriate</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">/// for an annular film, rather than a fluid fibre.</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html">  709</a></span>&#160;<span class="keyword">class </span><a class="code" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html">MyHorizontalSingleLayerSpineMesh</a> : </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keyword">public</span> HorizontalSingleLayerSpineMesh&lt;ELEMENT&gt;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;{</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"> /// \short Constructor: Pass number of elements in x-direction, number of</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment"> /// elements in y-direction, radial extent, axial length , and pointer </span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"> /// to timestepper (defaults to Steady timestepper)</span></div>
<div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html#a0bd73ed947e30341144d081df52332b5">  718</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html#a0bd73ed947e30341144d081df52332b5">MyHorizontalSingleLayerSpineMesh</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;nx, </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;ny,</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;lx,</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ly,</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                                  TimeStepper* time_stepper_pt=</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                  &amp;Mesh::Default_TimeStepper) :</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  HorizontalSingleLayerSpineMesh&lt;ELEMENT&gt;(nx,ny,lx,ly,time_stepper_pt) {}</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment"> /// \short Node update function assumed spines rooted at the wall</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"> /// fixed to be at r=1 and directed inwards to r=0.</span></div>
<div class="line"><a name="l00728"></a><span class="lineno"><a class="line" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html#ad007f1c20530cda9a495d89a4470772c">  728</a></span>&#160;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html#ad007f1c20530cda9a495d89a4470772c">spine_node_update</a>(SpineNode* spine_node_pt)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="comment">//Get fraction along the spine</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   <span class="keywordtype">double</span> W = spine_node_pt-&gt;fraction();</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <span class="comment">//Get spine height</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <span class="keywordtype">double</span> H = spine_node_pt-&gt;h();</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   <span class="comment">//Set the value of y</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   spine_node_pt-&gt;x(0) = 1.0-(1.0-W)*H;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;};</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;}</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">//==start_of_problem_class===============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">/// Single axisymmetric fluid interface problem including the</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">/// transport of an insoluble surfactant.</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keyword">class</span> TIMESTEPPER&gt;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="keyword">class </span><a class="code" href="classInterfaceProblem.html">InterfaceProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;{</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"> /// Constructor: Pass the number of elements in radial and axial directions </span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"> /// and the length of the domain in the z direction)</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment"></span> <a class="code" href="classInterfaceProblem.html">InterfaceProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_r, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_z, </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;l_z);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#a90c191f8046069099b199743e7ce7111">  761</a></span>&#160;<span class="comment"></span> <a class="code" href="classInterfaceProblem.html#a90c191f8046069099b199743e7ce7111">~InterfaceProblem</a>() {}</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment"> /// Spine heights/lengths are unknowns in the problem so their values get</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment"> /// corrected during each Newton step. However, changing their value does</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment"> /// not automatically change the nodal positions, so we need to update all</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"> /// of them here.</span></div>
<div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">  767</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">actions_before_newton_convergence_check</a>()</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   Bulk_mesh_pt-&gt;node_update();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"> /// Set initial conditions: Set all nodal velocities to zero and</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"> /// initialise the previous velocities to correspond to an impulsive</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"> /// start</span></div>
<div class="line"><a name="l00775"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">  775</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">set_initial_condition</a>()</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   <span class="comment">// Determine number of nodes in mesh</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = Bulk_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   <span class="comment">// Loop over all nodes in mesh</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;     <span class="comment">// Loop over the three velocity components</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;3;i++)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;       <span class="comment">// Set velocity component i of node n to zero</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;       Bulk_mesh_pt-&gt;node_pt(n)-&gt;set_value(i,0.0);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   <span class="comment">// Initialise the previous velocity values for timestepping</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   <span class="comment">// corresponding to an impulsive start</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   assign_initial_values_impulsive();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  } <span class="comment">// End of set_initial_condition</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"> /// The global temporal error norm, based on the movement of the nodes</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"> /// in the radial direction only (because that&#39;s the only direction</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment"> /// in which they move!)</span></div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#a5eb5fa3bf4e7884984f285e24ba3ee7b">  801</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classInterfaceProblem.html#a5eb5fa3bf4e7884984f285e24ba3ee7b">global_temporal_error_norm</a>()</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <span class="comment">//Temp</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <span class="keywordtype">double</span> global_error = 0.0;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   <span class="comment">//Find out how many nodes there are in the problem</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = Bulk_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;   </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <span class="comment">//Loop over the nodes and calculate the errors in the positions</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;     <span class="comment">//Set the dimensions to be restricted to the radial direction only</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_dim = 1; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;     <span class="comment">//Set the position error to zero</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;     <span class="keywordtype">double</span> node_position_error = 0.0;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;     <span class="comment">//Loop over the dimensions</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_dim;i++)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;       <span class="comment">//Get position error</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;       <span class="keywordtype">double</span> error = </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        Bulk_mesh_pt-&gt;node_pt(n)-&gt;position_time_stepper_pt()-&gt;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        temporal_error_in_position(Bulk_mesh_pt-&gt;node_pt(n),i);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;     </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;       <span class="comment">//Add the square of the individual error to the position error</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;       node_position_error += error*error;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;     </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;     <span class="comment">//Divide the position error by the number of dimensions</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;     node_position_error /= n_dim;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;     <span class="comment">//Now add to the global error</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;     global_error += node_position_error;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   <span class="comment">//Now the global error must be divided by the number of nodes</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   global_error /= n_node;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="comment">//Return the square root of the errr</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <span class="keywordflow">return</span> sqrt(global_error);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment"> /// \short Access function for the specific mesh</span></div>
<div class="line"><a name="l00843"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#a6df8c17d561715be1e6e7badfe339122">  843</a></span>&#160;<span class="comment"></span> <a class="code" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html">MyHorizontalSingleLayerSpineMesh&lt;ELEMENT&gt;</a>*  <a class="code" href="classInterfaceProblem.html#a6df8c17d561715be1e6e7badfe339122">Bulk_mesh_pt</a>; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment"> /// \short Mesh for the free surface (interface) elements</span></div>
<div class="line"><a name="l00846"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#afd6b076362ccdb4ade0450fa3d3bf1ac">  846</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classInterfaceProblem.html#afd6b076362ccdb4ade0450fa3d3bf1ac">Interface_mesh_pt</a>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"> /// Doc the solution</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo &amp;doc_info);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment"> /// Do unsteady run up to maximum time t_max with given timestep dt</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> unsteady_run(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;t_max, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;dt); </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment"> /// Compute the total mass of the insoluble surfactant</span></div>
<div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#a9b19bc90667fe8c7885d8ee113812e27">  855</a></span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="classInterfaceProblem.html#a9b19bc90667fe8c7885d8ee113812e27">compute_total_mass</a>()</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   <span class="comment">//Initialise to zero</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   <span class="keywordtype">double</span> mass = 0.0;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   <span class="comment">// Determine number of 1D interface elements in mesh</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_interface_element = Interface_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   <span class="comment">// Loop over the interface elements</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_interface_element;e++)</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;     <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;     <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;</a>* el_pt = </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      (Interface_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;     <span class="comment">//Add contribution from each element</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;     mass += el_pt-&gt;<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#aeb6b9fa726b084884c1e00291d077eea">integrate_c</a>();</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   <span class="keywordflow">return</span> mass;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  } <span class="comment">// End of compute_total_mass</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment"> /// Deform the mesh/free surface to a prescribed function</span></div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#a4514af9aa19dd50d10ca18f12039428f">  880</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classInterfaceProblem.html#a4514af9aa19dd50d10ca18f12039428f">deform_free_surface</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;epsilon)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   <span class="comment">// Determine number of spines in mesh</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_spine = Bulk_mesh_pt-&gt;nspine();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;   <span class="comment">// Loop over spines in mesh</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_spine;i++)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;     </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;     <span class="comment">// Determine z coordinate of spine</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;     <span class="keywordtype">double</span> z_value = Bulk_mesh_pt-&gt;boundary_node_pt(1,i)-&gt;x(1);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;     <span class="comment">// Set spine height</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;     Bulk_mesh_pt-&gt;spine_pt(i)-&gt;height() = </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="namespaceGlobal__Physical__Variables.html#a4d1da0a125f6044733e121f0f3d958ca">Global_Physical_Variables::Film_Thickness</a>*(1.0 +  </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                                 + epsilon*cos(<a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Global_Physical_Variables::Alpha</a>*z_value));</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    } <span class="comment">// End of loop over spines</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;   </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;   <span class="comment">// Update nodes in bulk mesh</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;   Bulk_mesh_pt-&gt;node_update();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  } <span class="comment">// End of deform_free_surface</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">  /// Trace file</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"></span>  ofstream Trace_file;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;}; <span class="comment">// End of problem class</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">//==start_of_constructor==================================================</span><span class="comment"></span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">/// Constructor for single fluid interface problem</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keyword">class</span> TIMESTEPPER&gt;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<a class="code" href="classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem&lt;ELEMENT,TIMESTEPPER&gt;::</a></div>
<div class="line"><a name="l00916"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#af1ab49eb511b5a8db27e7b4e509a0c5c">  916</a></span>&#160;<a class="code" href="classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_r, </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n_z,</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;l_z) </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;{</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; <span class="comment">// Allocate the timestepper (this constructs the time object as well)</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; add_time_stepper_pt(<span class="keyword">new</span> TIMESTEPPER(<span class="keyword">true</span>));</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; <span class="comment">// Build and assign mesh (the &quot;false&quot; boolean flag tells the mesh</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; <span class="comment">// constructor that the domain is not periodic in r)</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; Bulk_mesh_pt = <span class="keyword">new</span> <a class="code" href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html">MyHorizontalSingleLayerSpineMesh&lt;ELEMENT&gt;</a>(n_r,n_z,1.0,l_z,time_stepper_pt());</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; <span class="comment">//Create &quot;surface mesh&quot; that will only contain the interface elements</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; Interface_mesh_pt = <span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <span class="comment">// Boundary 1 is the outer boundary</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;   <span class="comment">// The boundaries are labelled</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   <span class="comment">//                   2</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;   <span class="comment">//                 3   1</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;   <span class="comment">//                   0</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordtype">unsigned</span> n_element = Bulk_mesh_pt-&gt;nboundary_element(3);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="comment">// Loop over the bulk elements adjacent to boundary b?</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;     Bulk_mesh_pt-&gt;boundary_element_pt(3,e));</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">// Find the index of the face of element e along boundary b</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordtype">int</span> face_index = Bulk_mesh_pt-&gt;face_index_at_boundary(3,e);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">// Build the corresponding free surface element</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;</a>* interface_element_pt = <span class="keyword">new</span> </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;</a>(bulk_elem_pt,face_index);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">//Add the prescribed-flux element to the surface mesh</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;     Interface_mesh_pt-&gt;add_element_pt(interface_element_pt);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   } <span class="comment">//end of loop over bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; <span class="comment">// Add the two sub meshes to the problem</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; add_sub_mesh(Bulk_mesh_pt);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; add_sub_mesh(Interface_mesh_pt);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; <span class="comment">// Combine all submeshes into a single Mesh</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; build_global_mesh();</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; <span class="comment">// --------------------------------------------</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; <span class="comment">// Set the boundary conditions for this problem</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; <span class="comment">// --------------------------------------------</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; <span class="comment">//Pin all azimuthal velocities</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="keywordtype">unsigned</span> n_node = this-&gt;Bulk_mesh_pt-&gt;nnode();</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;++n)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    this-&gt;Bulk_mesh_pt-&gt;node_pt(n)-&gt;pin(2);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; <span class="comment">// All nodes are free by default -- just pin the ones that have</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; <span class="comment">// Dirichlet conditions here</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; <span class="keywordtype">unsigned</span> ibound = 3;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; <span class="keywordtype">unsigned</span> n_node = Bulk_mesh_pt-&gt;nboundary_node(ibound);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;   {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;     Bulk_mesh_pt-&gt;boundary_node_pt(ibound,n)-&gt;set_value(3,1.0);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; <span class="comment">// Determine number of mesh boundaries</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_boundary = Bulk_mesh_pt-&gt;nboundary();</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; <span class="comment">// Loop over mesh boundaries</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=0;b&lt;n_boundary;b++)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;   <span class="comment">// Determine number of nodes on boundary b</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_node = Bulk_mesh_pt-&gt;nboundary_node(b);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   <span class="comment">// Loop over nodes on boundary b</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;     <span class="comment">// Pin azimuthal velocity on bounds</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;     Bulk_mesh_pt-&gt;boundary_node_pt(b,n)-&gt;pin(2);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;     <span class="comment">// Pin velocity on the outer wall</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;     <span class="keywordflow">if</span>(b==1)</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        Bulk_mesh_pt-&gt;boundary_node_pt(b,n)-&gt;pin(0);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        Bulk_mesh_pt-&gt;boundary_node_pt(b,n)-&gt;pin(1);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;     <span class="comment">// Pin axial velocity on bottom and top walls (no penetration)</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;     <span class="keywordflow">if</span>(b==0 || b==2)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;       Bulk_mesh_pt-&gt;boundary_node_pt(b,n)-&gt;pin(1);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    } <span class="comment">// End of loop over nodes on boundary b</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  } <span class="comment">// End of loop over mesh boundaries</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; <span class="comment">// ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; <span class="comment">// Complete the problem setup to make the elements fully functional</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; <span class="comment">// ----------------------------------------------------------------</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; <span class="comment">// Determine number of bulk elements in mesh</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_bulk = Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; <span class="comment">// Loop over the bulk elements</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_bulk;e++)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;   <span class="comment">// Set the Reynolds number</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;   el_pt-&gt;re_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;   <span class="comment">// Set the Womersley number</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   el_pt-&gt;re_st_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   <span class="comment">// Set the product of the Reynolds number and the inverse of the</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   <span class="comment">// Froude number</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   el_pt-&gt;re_invfr_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">Global_Physical_Variables::ReInvFr</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   <span class="comment">// Set the direction of gravity</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   el_pt-&gt;g_pt() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#af5ae275cf339105b9a54821c034df470">Global_Physical_Variables::G</a>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  } <span class="comment">// End of loop over bulk elements</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; <span class="comment">// Create a Data object whose single value stores the external pressure</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; Data* external_pressure_data_pt = <span class="keyword">new</span> Data(1);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; <span class="comment">// Pin and set the external pressure to some arbitrary value</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; <span class="keywordtype">double</span> p_ext = <a class="code" href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">Global_Physical_Variables::P_ext</a>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; external_pressure_data_pt-&gt;pin(0);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; external_pressure_data_pt-&gt;set_value(0,p_ext);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; <span class="comment">// Determine number of 1D interface elements in mesh</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_interface_element = Interface_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; <span class="comment">// Loop over the interface elements</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_interface_element;e++)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to the present element</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   <a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;</a>* el_pt = </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement&lt;ELEMENT&gt;</a>*<span class="keyword">&gt;</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    (Interface_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;   <span class="comment">// Set the Capillary number</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   el_pt-&gt;<a class="code" href="classoomph_1_1FluidInterfaceElement.html#a1a950f0202d6dd15fab2f0c03927edc9">ca_pt</a>() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Global_Physical_Variables::Ca</a>;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   <span class="comment">// Pass the Data item that contains the single external pressure value</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;   el_pt-&gt;<a class="code" href="classoomph_1_1FluidInterfaceElement.html#a7230ddea36eb36938d64583e5ee4b15f">set_external_pressure_data</a>(external_pressure_data_pt);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   <span class="comment">// Set the surface elasticity number</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   el_pt-&gt;<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#adb3f668c377e5a8c3362e7bd7ac1d989">beta_pt</a>() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Global_Physical_Variables::Beta</a>;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   <span class="comment">// Set the surface peclect number</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   el_pt-&gt;<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ae8e42e0510d001c3e4874b0ad32fbe44">peclet_s_pt</a>() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#a99dc85e71075cd6efb06e692d8a15bcd">Global_Physical_Variables::Peclet_S</a>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;   <span class="comment">// Set the surface peclect number multiplied by strouhal number</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;   el_pt-&gt;<a class="code" href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a943d445ebca59b8c2eeb6584eeba366e">peclet_strouhal_s_pt</a>() = &amp;<a class="code" href="namespaceGlobal__Physical__Variables.html#abec1e1c8c78ade3a7b2e7396321c6466">Global_Physical_Variables::Peclet_St_S</a>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  } <span class="comment">// End of loop over interface elements</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; cout &lt;&lt; <span class="stringliteral">&quot;Number of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;} <span class="comment">// End of constructor</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;   </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">//==start_of_doc_solution=================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">/// Doc the solution</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keyword">class</span> TIMESTEPPER&gt;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classInterfaceProblem.html#a49714e35e94f7d2af0b6ddd22b851f52">InterfaceProblem&lt;ELEMENT,TIMESTEPPER&gt;::</a></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<a class="code" href="classInterfaceProblem.html#a49714e35e94f7d2af0b6ddd22b851f52">doc_solution</a>(DocInfo &amp;doc_info)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;{ </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; <span class="comment">// Output the time</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; <span class="keywordtype">double</span> t= time_pt()-&gt;time();</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; cout &lt;&lt; <span class="stringliteral">&quot;Time is now &quot;</span> &lt;&lt; t &lt;&lt; std::endl;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; <span class="comment">// Document in trace file</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; Trace_file &lt;&lt; time_pt()-&gt;time() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            &lt;&lt; Bulk_mesh_pt-&gt;spine_pt(0)-&gt;height()</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; this-&gt;compute_total_mass() &lt;&lt; std::endl;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; <span class="comment">// Set number of plot points (in each coordinate direction)</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> npts = 5;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; <span class="comment">// Open solution output file</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; <span class="comment">//sprintf(filename,&quot;%s/soln%i.dat&quot;,doc_info.directory().c_str(),</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; <span class="comment">//        doc_info.number());</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; <span class="comment">//some_file.open(filename);</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; <span class="comment">// Output solution to file</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; <span class="comment">//Bulk_mesh_pt-&gt;output(some_file,npts);</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; <span class="comment">//some_file.close();</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; <span class="comment">//Put interface in separate file</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/int%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; Interface_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; some_file.close();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; <span class="comment">// Write file as a tecplot text object...</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">// some_file &lt;&lt; &quot;TEXT X=2.5,Y=93.6,F=HELV,HU=POINT,C=BLUE,H=26,T=\&quot;time = &quot; </span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; <span class="comment">//         &lt;&lt; time_pt()-&gt;time() &lt;&lt; &quot;\&quot;&quot;;</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; <span class="comment">// ...and draw a horizontal line whose length is proportional</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; <span class="comment">// to the elapsed time</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; <span class="comment">//some_file &lt;&lt; &quot;GEOMETRY X=2.5,Y=98,T=LINE,C=BLUE,LT=0.4&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; <span class="comment">//some_file &lt;&lt; &quot;1&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; <span class="comment">//some_file &lt;&lt; &quot;2&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; <span class="comment">//some_file &lt;&lt; &quot; 0 0&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; <span class="comment">//some_file &lt;&lt; time_pt()-&gt;time()*20.0 &lt;&lt; &quot; 0&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; <span class="comment">// Close solution output file</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">// some_file.close();</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; <span class="comment">// Output solution to file in paraview format</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; <span class="comment">//sprintf(filename,&quot;%s/soln%i.vtu&quot;,doc_info.directory().c_str(),</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; <span class="comment">//        doc_info.number());</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; <span class="comment">//some_file.open(filename);</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; <span class="comment">//Bulk_mesh_pt-&gt;output_paraview(some_file,npts);</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; <span class="comment">//some_file.close();</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; <span class="comment">// Write pvd information </span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; <span class="keywordtype">string</span> file_name=<span class="stringliteral">&quot;soln&quot;</span>+StringConversion::to_string(doc_info.number())</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  +<span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; ParaviewHelper::write_pvd_information(<a class="code" href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Global_Physical_Variables::Pvd_file</a>,</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                                       file_name,t);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;} <span class="comment">// End of doc_solution</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">//==start_of_unsteady_run=================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">/// Perform run up to specified time t_max with given timestep dt</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT, <span class="keyword">class</span> TIMESTEPPER&gt;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classInterfaceProblem.html#a241f0290d26462badbe9bb0e1e0d10a5">InterfaceProblem&lt;ELEMENT,TIMESTEPPER&gt;::</a></div>
<div class="line"><a name="l01166"></a><span class="lineno"><a class="line" href="classInterfaceProblem.html#adf1f4e43d10939e4323e0e315b711085"> 1166</a></span>&#160;<a class="code" href="classInterfaceProblem.html#a241f0290d26462badbe9bb0e1e0d10a5">unsteady_run</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;t_max, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;dt)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;{</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; <span class="comment">// Set value of epsilon</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; <span class="keywordtype">double</span> epsilon = <a class="code" href="namespaceGlobal__Physical__Variables.html#a28f21de3d342b1dab2fa0be362c6a944">Global_Physical_Variables::Epsilon</a>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; <span class="comment">// Deform the mesh/free surface</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; deform_free_surface(epsilon);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; <span class="comment">// Initialise DocInfo object</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; <span class="comment">// Set output directory</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; <span class="comment">// Initialise counter for solutions</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160; doc_info.number()=0;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; <span class="comment">// Open trace file</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; <span class="keywordtype">char</span> filename[100];   </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,doc_info.directory().c_str());</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; Trace_file.open(filename);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; <span class="comment">// Initialise trace file</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; Trace_file &lt;&lt; <span class="stringliteral">&quot;time&quot;</span> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;edge spine height&quot;</span> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;contact angle left&quot;</span> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;contact angle right&quot;</span> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; <span class="comment">// Initialise timestep</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; initialise_dt(dt);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; <span class="comment">// Set initial conditions</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; set_initial_condition();</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; <span class="comment">// Determine number of timesteps</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_timestep = unsigned(t_max/dt);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; <span class="comment">// Open pvd file -- a wrapper for all the different</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; <span class="comment">// vtu output files plus information about continuous time</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; <span class="comment">// to facilitate animations in paraview</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln.pvd&quot;</span>,doc_info.directory().c_str());</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Global_Physical_Variables::Pvd_file</a>.open(filename);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; ParaviewHelper::write_pvd_header(<a class="code" href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Global_Physical_Variables::Pvd_file</a>);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; <span class="comment">// Doc initial solution</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; doc_solution(doc_info);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; <span class="comment">// Increment counter for solutions </span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; doc_info.number()++;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; <span class="comment">//double dt_desired = dt;</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; <span class="comment">// Timestepping loop</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> t=1;t&lt;=n_timestep;t++)</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;   <span class="comment">// Output current timestep to screen</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;\nTimestep &quot;</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">&quot; of &quot;</span> &lt;&lt; n_timestep &lt;&lt; std::endl;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;   </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;   <span class="comment">// Take one fixed timestep</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;   unsteady_newton_solve(dt);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;   <span class="comment">//double dt_actual = </span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;   <span class="comment">// adaptive_unsteady_newton_solve(dt_desired,1.0e-6);</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;   <span class="comment">//dt_desired = dt_actual;</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;   <span class="comment">// Doc solution</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;   doc_solution(doc_info);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;   <span class="comment">// Increment counter for solutions </span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   doc_info.number()++;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  } <span class="comment">// End of timestepping loop</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; <span class="comment">// write footer and close pvd file</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; ParaviewHelper::write_pvd_footer(<a class="code" href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Global_Physical_Variables::Pvd_file</a>);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Global_Physical_Variables::Pvd_file</a>.close();</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;} <span class="comment">// End of unsteady_run</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">//==start_of_main=========================================================</span><span class="comment"></span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">/// Driver code for single fluid axisymmetric horizontal interface problem </span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"><a class="line" href="rayleigh__instability__insoluble__surfactant_8cc.html#a0ddf1224851353fc92bfbff6f499fa97"> 1255</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="rayleigh__instability__insoluble__surfactant_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;{</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; <span class="comment">// Store command line arguments</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; CommandLineArgs::setup(argc,argv);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment"> /// Maximum time</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> t_max = 1000.0;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment"> /// Duration of timestep</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment"></span> <span class="keyword">const</span> <span class="keywordtype">double</span> dt = 0.1;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; <span class="comment">// If we are doing validation run, use smaller number of timesteps</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; <span class="keywordflow">if</span>(CommandLineArgs::Argc&gt;1) </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  { </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;   t_max = 0.5; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; <span class="comment">// Number of elements in radial (r) direction</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_r = 10;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;   </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; <span class="comment">// Number of elements in axial (z) direction</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> n_z = 80;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; <span class="comment">// Height of domain</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; <span class="keyword">const</span> <span class="keywordtype">double</span> l_z = MathematicalConstants::Pi/<a class="code" href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Global_Physical_Variables::Alpha</a>;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160; </div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160; <span class="comment">// Set direction of gravity (vertically downwards)</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#af5ae275cf339105b9a54821c034df470">Global_Physical_Variables::G</a>[0] = 0.0;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#af5ae275cf339105b9a54821c034df470">Global_Physical_Variables::G</a>[1] = 0.0;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; <a class="code" href="namespaceGlobal__Physical__Variables.html#af5ae275cf339105b9a54821c034df470">Global_Physical_Variables::G</a>[2] = 0.0;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; <span class="comment">// Set up the spine test problem with AxisymmetricQCrouzeixRaviartElements,</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; <span class="comment">// using the BDF&lt;2&gt; timestepper</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; <a class="code" href="classInterfaceProblem.html">InterfaceProblem&lt;SpineElement&lt;AxisymmetricQCrouzeixRaviartElement &gt;</a>,BDF&lt;2&gt; &gt;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  problem(n_r,n_z,l_z);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; <span class="comment">// Run the unsteady simulation</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; problem.<a class="code" href="classInterfaceProblem.html#a241f0290d26462badbe9bb0e1e0d10a5">unsteady_run</a>(t_max,dt);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;} <span class="comment">// End of main</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassInterfaceProblem_html_a90c191f8046069099b199743e7ce7111"><div class="ttname"><a href="classInterfaceProblem.html#a90c191f8046069099b199743e7ce7111">InterfaceProblem::~InterfaceProblem</a></div><div class="ttdeci">~InterfaceProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00761">rayleigh_instability_insoluble_surfactant.cc:761</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a0406c0cbd463d1df2458fe5de98a00eb"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a0406c0cbd463d1df2458fe5de98a00eb">Global_Physical_Variables::P_ext</a></div><div class="ttdeci">double P_ext</div><div class="ttdoc">External pressure.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00074">rayleigh_instability_insoluble_surfactant.cc:74</a></div></div>
<div class="ttc" id="aclassoomph_1_1FluidInterfaceElement_html_a7230ddea36eb36938d64583e5ee4b15f"><div class="ttname"><a href="classoomph_1_1FluidInterfaceElement.html#a7230ddea36eb36938d64583e5ee4b15f">oomph::FluidInterfaceElement::set_external_pressure_data</a></div><div class="ttdeci">void set_external_pressure_data(Data *external_pressure_data_pt)</div><div class="ttdoc">Set the Data that contains the single pressure value that specifies the &quot;external pressure&quot; for the i...</div><div class="ttdef"><b>Definition:</b> <a href="interface__elements_8h_source.html#l00526">interface_elements.h:526</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a8f0df8c1e9120011fa51b15ab2694d34"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a8f0df8c1e9120011fa51b15ab2694d34">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::interpolated_C</a></div><div class="ttdeci">double interpolated_C(const Vector&lt; double &gt; &amp;s)</div><div class="ttdoc">Get the surfactant concentration.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00138">rayleigh_instability_insoluble_surfactant.cc:138</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_a6df8c17d561715be1e6e7badfe339122"><div class="ttname"><a href="classInterfaceProblem.html#a6df8c17d561715be1e6e7badfe339122">InterfaceProblem::Bulk_mesh_pt</a></div><div class="ttdeci">MyHorizontalSingleLayerSpineMesh&lt; ELEMENT &gt; * Bulk_mesh_pt</div><div class="ttdoc">Access function for the specific mesh.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00843">rayleigh_instability_insoluble_surfactant.cc:843</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa6286f02b476912dd7550eced538331a"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa6286f02b476912dd7550eced538331a">Global_Physical_Variables::ReInvFr</a></div><div class="ttdeci">double ReInvFr</div><div class="ttdoc">Product of Reynolds and Froude number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00063">3d_rayleigh_instability_surfactant.cc:63</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_a241f0290d26462badbe9bb0e1e0d10a5"><div class="ttname"><a href="classInterfaceProblem.html#a241f0290d26462badbe9bb0e1e0d10a5">InterfaceProblem::unsteady_run</a></div><div class="ttdeci">void unsteady_run(const unsigned &amp;nstep)</div><div class="ttdoc">Run an unsteady simulation with specified number of steps.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00484">3d_rayleigh_instability_surfactant.cc:484</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyHorizontalSingleLayerSpineMesh_html"><div class="ttname"><a href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html">oomph::MyHorizontalSingleLayerSpineMesh</a></div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00709">rayleigh_instability_insoluble_surfactant.cc:709</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a3af89ee44ddbf97c56f44b13117f5e7e"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a3af89ee44ddbf97c56f44b13117f5e7e">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::peclet_strouhal_s</a></div><div class="ttdeci">double peclet_strouhal_s()</div><div class="ttdoc">Return the surface peclect strouhal number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00564">rayleigh_instability_insoluble_surfactant.cc:564</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_a0d3af8378c4f0a6e38636be958c300d5"><div class="ttname"><a href="classInterfaceProblem.html#a0d3af8378c4f0a6e38636be958c300d5">InterfaceProblem::set_initial_condition</a></div><div class="ttdeci">void set_initial_condition()</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00775">rayleigh_instability_insoluble_surfactant.cc:775</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_aeb6b9fa726b084884c1e00291d077eea"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#aeb6b9fa726b084884c1e00291d077eea">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::integrate_c</a></div><div class="ttdeci">double integrate_c() const</div><div class="ttdoc">Compute the concentration intergated over the area.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00627">rayleigh_instability_insoluble_surfactant.cc:627</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a81a18102b611767a582804f1acdc8143"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a81a18102b611767a582804f1acdc8143">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::C_index</a></div><div class="ttdeci">unsigned C_index</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00130">rayleigh_instability_insoluble_surfactant.cc:130</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_a4514af9aa19dd50d10ca18f12039428f"><div class="ttname"><a href="classInterfaceProblem.html#a4514af9aa19dd50d10ca18f12039428f">InterfaceProblem::deform_free_surface</a></div><div class="ttdeci">void deform_free_surface(const double &amp;epsilon)</div><div class="ttdoc">Deform the mesh/free surface to a prescribed function.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00880">rayleigh_instability_insoluble_surfactant.cc:880</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a351a17b52cfcabc688393423f3de361b"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a351a17b52cfcabc688393423f3de361b">Global_Physical_Variables::Beta</a></div><div class="ttdeci">double Beta</div><div class="ttdoc">Surface Elasticity number (weak case)</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00078">3d_rayleigh_instability_surfactant.cc:78</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a28f21de3d342b1dab2fa0be362c6a944"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a28f21de3d342b1dab2fa0be362c6a944">Global_Physical_Variables::Epsilon</a></div><div class="ttdeci">double Epsilon</div><div class="ttdoc">Free surface cosine deformation parameter.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00075">3d_rayleigh_instability_surfactant.cc:75</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_aa34b8b5ac73054e367fd321bf1ae6346"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#aa34b8b5ac73054e367fd321bf1ae6346">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::fill_in_contribution_to_jacobian</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian)</div><div class="ttdoc">Fill in the contribution to the residuals Calculate the contribution to the jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00215">rayleigh_instability_insoluble_surfactant.cc:215</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyHorizontalSingleLayerSpineMesh_html_a0bd73ed947e30341144d081df52332b5"><div class="ttname"><a href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html#a0bd73ed947e30341144d081df52332b5">oomph::MyHorizontalSingleLayerSpineMesh::MyHorizontalSingleLayerSpineMesh</a></div><div class="ttdeci">MyHorizontalSingleLayerSpineMesh(const unsigned &amp;nx, const unsigned &amp;ny, const double &amp;lx, const double &amp;ly, TimeStepper *time_stepper_pt=&amp;Mesh::Default_TimeStepper)</div><div class="ttdoc">Constructor: Pass number of elements in x-direction, number of elements in y-direction,...</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00718">rayleigh_instability_insoluble_surfactant.cc:718</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_afd6b076362ccdb4ade0450fa3d3bf1ac"><div class="ttname"><a href="classInterfaceProblem.html#afd6b076362ccdb4ade0450fa3d3bf1ac">InterfaceProblem::Interface_mesh_pt</a></div><div class="ttdeci">Mesh * Interface_mesh_pt</div><div class="ttdoc">Mesh for the free surface (interface) elements.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00846">rayleigh_instability_insoluble_surfactant.cc:846</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_adb3f668c377e5a8c3362e7bd7ac1d989"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#adb3f668c377e5a8c3362e7bd7ac1d989">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::beta_pt</a></div><div class="ttdeci">double *&amp; beta_pt()</div><div class="ttdoc">Access function for pointer to the Elasticity number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00567">rayleigh_instability_insoluble_surfactant.cc:567</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a7312e78a1b5449ea2ff6d856a4fd9c46"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a7312e78a1b5449ea2ff6d856a4fd9c46">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::sigma</a></div><div class="ttdeci">double sigma(const Vector&lt; double &gt; &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00192">rayleigh_instability_insoluble_surfactant.cc:192</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a99dc85e71075cd6efb06e692d8a15bcd"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a99dc85e71075cd6efb06e692d8a15bcd">Global_Physical_Variables::Peclet_S</a></div><div class="ttdeci">double Peclet_S</div><div class="ttdoc">Surface Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00081">3d_rayleigh_instability_surfactant.cc:81</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a943d445ebca59b8c2eeb6584eeba366e"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a943d445ebca59b8c2eeb6584eeba366e">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::peclet_strouhal_s_pt</a></div><div class="ttdeci">double *&amp; peclet_strouhal_s_pt()</div><div class="ttdoc">Access function for pointer to the surface Peclet x Strouhal number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00573">rayleigh_instability_insoluble_surfactant.cc:573</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_af5ae275cf339105b9a54821c034df470"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#af5ae275cf339105b9a54821c034df470">Global_Physical_Variables::G</a></div><div class="ttdeci">Vector&lt; double &gt; G(3)</div><div class="ttdoc">Direction of gravity.</div></div>
<div class="ttc" id="aclassInterfaceProblem_html_a49714e35e94f7d2af0b6ddd22b851f52"><div class="ttname"><a href="classInterfaceProblem.html#a49714e35e94f7d2af0b6ddd22b851f52">InterfaceProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info)</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00443">3d_rayleigh_instability_surfactant.cc:443</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_acb97c1d7f3192309150432c840b34944"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#acb97c1d7f3192309150432c840b34944">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement</a></div><div class="ttdeci">SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement(FiniteElement *const &amp;element_pt, const int &amp;face_index)</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00532">rayleigh_instability_insoluble_surfactant.cc:532</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_aa2e802ee7cc8e1ac900ba94c3ce86eb7"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#aa2e802ee7cc8e1ac900ba94c3ce86eb7">Global_Physical_Variables::Alpha</a></div><div class="ttdeci">double Alpha</div><div class="ttdoc">Wavelength of the domain.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00072">3d_rayleigh_instability_surfactant.cc:72</a></div></div>
<div class="ttc" id="anamespaceoomph_html"><div class="ttname"><a href="namespaceoomph.html">oomph</a></div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00112">3d_rayleigh_instability_surfactant.cc:112</a></div></div>
<div class="ttc" id="aclassoomph_1_1MyHorizontalSingleLayerSpineMesh_html_ad007f1c20530cda9a495d89a4470772c"><div class="ttname"><a href="classoomph_1_1MyHorizontalSingleLayerSpineMesh.html#ad007f1c20530cda9a495d89a4470772c">oomph::MyHorizontalSingleLayerSpineMesh::spine_node_update</a></div><div class="ttdeci">virtual void spine_node_update(SpineNode *spine_node_pt)</div><div class="ttdoc">Node update function assumed spines rooted at the wall fixed to be at r=1 and directed inwards to r=0...</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00728">rayleigh_instability_insoluble_surfactant.cc:728</a></div></div>
<div class="ttc" id="aclassoomph_1_1FluidInterfaceElement_html_a1a950f0202d6dd15fab2f0c03927edc9"><div class="ttname"><a href="classoomph_1_1FluidInterfaceElement.html#a1a950f0202d6dd15fab2f0c03927edc9">oomph::FluidInterfaceElement::ca_pt</a></div><div class="ttdeci">double *&amp; ca_pt()</div><div class="ttdoc">Pointer to the Capillary number.</div><div class="ttdef"><b>Definition:</b> <a href="interface__elements_8h_source.html#l00490">interface_elements.h:490</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_abec1e1c8c78ade3a7b2e7396321c6466"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#abec1e1c8c78ade3a7b2e7396321c6466">Global_Physical_Variables::Peclet_St_S</a></div><div class="ttdeci">double Peclet_St_S</div><div class="ttdoc">Sufrace Peclet number multiplied by Strouhal number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00084">3d_rayleigh_instability_surfactant.cc:84</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_a9b19bc90667fe8c7885d8ee113812e27"><div class="ttname"><a href="classInterfaceProblem.html#a9b19bc90667fe8c7885d8ee113812e27">InterfaceProblem::compute_total_mass</a></div><div class="ttdeci">double compute_total_mass()</div><div class="ttdoc">Compute the total mass of the insoluble surfactant.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00855">rayleigh_instability_insoluble_surfactant.cc:855</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a085ee4bf968ffdd01a41b8c41864f907"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a085ee4bf968ffdd01a41b8c41864f907">Global_Physical_Variables::ReSt</a></div><div class="ttdeci">double ReSt</div><div class="ttdoc">Womersley = Reynolds times Strouhal.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00060">3d_rayleigh_instability_surfactant.cc:60</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_a5eb5fa3bf4e7884984f285e24ba3ee7b"><div class="ttname"><a href="classInterfaceProblem.html#a5eb5fa3bf4e7884984f285e24ba3ee7b">InterfaceProblem::global_temporal_error_norm</a></div><div class="ttdeci">double global_temporal_error_norm()</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00801">rayleigh_instability_insoluble_surfactant.cc:801</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_a2ecc265740dba1626344fc090fad5fa6"><div class="ttname"><a href="classInterfaceProblem.html#a2ecc265740dba1626344fc090fad5fa6">InterfaceProblem::InterfaceProblem</a></div><div class="ttdeci">InterfaceProblem(const unsigned &amp;n_r, const unsigned &amp;n_y, const unsigned &amp;n_theta, const double &amp;r_min, const double &amp;r_max, const double &amp;l_y, const double &amp;theta_max)</div><div class="ttdoc">Problem constructor.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00271">3d_rayleigh_instability_surfactant.cc:271</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a3884b52470fdf8d031224e2f7060e56d"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a3884b52470fdf8d031224e2f7060e56d">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::Beta_pt</a></div><div class="ttdeci">double * Beta_pt</div><div class="ttdoc">Pointer to an Elasticity number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00120">rayleigh_instability_insoluble_surfactant.cc:120</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_ac69e8f0d0de52bcef7c2fa939c1ba2f1"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ac69e8f0d0de52bcef7c2fa939c1ba2f1">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::output</a></div><div class="ttdeci">void output(std::ostream &amp;outfile, const unsigned &amp;n_plot)</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00575">rayleigh_instability_insoluble_surfactant.cc:575</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a56c90572b8969dff01a4baa9de850d91"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a56c90572b8969dff01a4baa9de850d91">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::add_additional_residual_contributions_interface</a></div><div class="ttdeci">void add_additional_residual_contributions_interface(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, const unsigned &amp;flag, const Shape &amp;psif, const DShape &amp;dpsifds, const DShape &amp;dpsifdS, const DShape &amp;dpsifdS_div, const Vector&lt; double &gt; &amp;s, const Vector&lt; double &gt; &amp;interpolated_x, const Vector&lt; double &gt; &amp;interpolated_n, const double &amp;W, const double &amp;J)</div><div class="ttdoc">Overload the Helper function to calculate the residuals and jacobian entries. This particular functio...</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00279">rayleigh_instability_insoluble_surfactant.cc:279</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement</a></div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00115">rayleigh_instability_insoluble_surfactant.cc:115</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a4f2fe790aa186202e4e2d5f6ee21d7f4"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a4f2fe790aa186202e4e2d5f6ee21d7f4">Global_Physical_Variables::Pvd_file</a></div><div class="ttdeci">ofstream Pvd_file</div><div class="ttdoc">Pvd file  a wrapper for all the different vtu output files plus information about continuous time to...</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00097">rayleigh_instability_insoluble_surfactant.cc:97</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a8b32b93d2e546f9375ec418474107838"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a8b32b93d2e546f9375ec418474107838">Global_Physical_Variables::Ca</a></div><div class="ttdeci">double Ca</div><div class="ttdoc">Capillary number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00066">3d_rayleigh_instability_surfactant.cc:66</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a6a927de4f0ec496fce8114f5710f1db2"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a6a927de4f0ec496fce8114f5710f1db2">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::peclet_s</a></div><div class="ttdeci">double peclet_s()</div><div class="ttdoc">Return the surface peclect number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00561">rayleigh_instability_insoluble_surfactant.cc:561</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a898d0f93192f1b42826a5fc1043f8534"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a898d0f93192f1b42826a5fc1043f8534">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::beta</a></div><div class="ttdeci">double beta()</div><div class="ttdoc">Return the Elasticity number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00558">rayleigh_instability_insoluble_surfactant.cc:558</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a652e8408b5cc7af8b934d895782b8ff5"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a652e8408b5cc7af8b934d895782b8ff5">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::Default_Physical_Constant_Value</a></div><div class="ttdeci">static double Default_Physical_Constant_Value</div><div class="ttdoc">Default value of the physical constants.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00133">rayleigh_instability_insoluble_surfactant.cc:133</a></div></div>
<div class="ttc" id="arayleigh__instability__insoluble__surfactant_8cc_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="rayleigh__instability__insoluble__surfactant_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdoc">Driver code for single fluid axisymmetric horizontal interface problem.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l01255">rayleigh_instability_insoluble_surfactant.cc:1255</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a8e2a9a53bcc19471bcb36ed2c169fb57"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a8e2a9a53bcc19471bcb36ed2c169fb57">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::Peclet_Strouhal_S_pt</a></div><div class="ttdeci">double * Peclet_Strouhal_S_pt</div><div class="ttdoc">Pointer to the surface Peclect Strouhal number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00126">rayleigh_instability_insoluble_surfactant.cc:126</a></div></div>
<div class="ttc" id="arayleigh__instability__surfactant_8txt_html_a56933c4e69e45788991a5fdc8ba11a1d"><div class="ttname"><a href="rayleigh__instability__surfactant_8txt.html#a56933c4e69e45788991a5fdc8ba11a1d">sigma</a></div><div class="ttdeci">mainpage The Rayleigh Plateau instability in the presence of an insoluble surfactant In this tutorial we present an example of surface transport equations in a free surface Navier Stokes problem This is a multi multi physics problem because there is a coupling between the equations on the surface and those in the bulk The coupling from the bulk to the surface transport arises through the surface velocity in the surface transport equation The coupling from the surface transport to bulk arises in a more subtle manner because the surface concentration affects the surface tension In this we describe how to use the existing framework to create surface transport equations and how to include them in a free surface problem&lt; HR &gt;&lt; HR &gt; section example_problem The example problem The problem to be solved is the evolution of an annular film of fluid on the inside of a solid cylinder in the presence of an insoluble surfactant on the we reproduce some of the results given in A D model of Rayleigh instability in capillary tubes surfactant effects by D J Di Paolo &amp;F A&lt; em &gt; Int J Multiphase&lt;/em &gt; vol&lt; b &gt;&lt;/b &gt; Our is different from their approach as described in detail in our&lt; a href=&quot;../../../navier_stokes/surface_theory/html/index.html&quot;&gt; free surface theory document&lt;/a &gt;&lt; CENTER &gt;&lt; TABLE &gt;&lt; TR &gt;&lt; TD &gt;&lt; CENTER &gt;&lt; B &gt; The unsteady axisymmetric free surface Navier Stokes equations with insoluble surfactant&lt;/B &gt;&lt;/CENTER &gt; Solve f[Re \left[St \frac{\partial u_r}{\partial t}+u_r \frac{\partial u_r}{\partial r} - \frac{u_\theta^2}{r}+u_z \frac{\partial u_r}{\partial z}\right]=-\frac{\partial p}{\partial r}+\left[\frac{\partial^2 u_r}{\partial r^2}+\frac{1}{r}\frac{\partial u_r}{\partial r} - \frac{u_r}{r^2}+\frac{\partial^2 u_r}{\partial z^2}\right],\f] f[Re \left[St \frac{\partial u_\theta}{\partial t}+u_r \frac{\partial u_\theta}{\partial r}+\frac{u_r u_\theta}{r}+u_z \frac{\partial u_\theta}{\partial z}\right]=+\left[\frac{\partial^2 u_\theta}{\partial r^2}+\frac{1}{r}\frac{\partial u_\theta}{\partial r} - \frac{u_\theta}{r^2}+\frac{\partial^2 u_\theta}{\partial z^2}\right],\f] f[Re \left[St \frac{\partial u_z}{\partial t}+u_r \frac{\partial u_z}{\partial r}+u_z \frac{\partial u_z}{\partial z}\right]=-\frac{\partial p}{\partial z}+\left[\frac{\partial^2 u_z}{\partial r^2}+\frac{1}{r}\frac{\partial u_z}{\partial r}+\frac{\partial^2 u_z}{\partial z^2}\right],\f] and f[\frac{\partial u_r}{\partial r}+\frac{u_r}{r}+\frac{\partial u_z}{\partial z}=0\ \ \ \ \ \ \ \ \ \ @E[eqn:NSlower]@\f] in the bulk fluid The governing equations are subject to the no slip boundary conditions f[u_r=u_\theta=u_z=0 \ \ \ \ \ \ \ \ \ \ @E[eqn:BC1]@\f] on the outer solid E[eqn:kinematicBC] f and the dynamic condition f[\tau_{ij}^{[2]}n_j=\tau_{ij}^{[1]}n_j+\frac{1}{Ca}\left(\sigma \kappa n_i+\frac{\partial \sigma}{\partial s} t_{i} \right).\ \ \ \ \ \ \ \ \ \ @E[eqn:dynamicBC]@\f] where f sigma</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__surfactant_8txt_source.html#l00114">rayleigh_instability_surfactant.txt:114</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a7ee3faea2d8e082efde048e7adb9e9c1"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a7ee3faea2d8e082efde048e7adb9e9c1">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::dcdt_surface</a></div><div class="ttdeci">double dcdt_surface(const unsigned &amp;l) const</div><div class="ttdoc">The time derivative of the surface concentration.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00165">rayleigh_instability_insoluble_surfactant.cc:165</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricFluidInterfaceElement_html"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricFluidInterfaceElement.html">oomph::SpineAxisymmetricFluidInterfaceElement</a></div><div class="ttdef"><b>Definition:</b> <a href="specific__node__update__interface__elements_8h_source.html#l00521">specific_node_update_interface_elements.h:521</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html">Global_Physical_Variables</a></div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00051">3d_rayleigh_instability_surfactant.cc:51</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_a71f8f35b8f8db2341c9eedee754c957a"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#a71f8f35b8f8db2341c9eedee754c957a">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::Peclet_S_pt</a></div><div class="ttdeci">double * Peclet_S_pt</div><div class="ttdoc">Pointer to Surface Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00123">rayleigh_instability_insoluble_surfactant.cc:123</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_ae8e42e0510d001c3e4874b0ad32fbe44"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ae8e42e0510d001c3e4874b0ad32fbe44">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::peclet_s_pt</a></div><div class="ttdeci">double *&amp; peclet_s_pt()</div><div class="ttdoc">Access function for pointer to the surface Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00570">rayleigh_instability_insoluble_surfactant.cc:570</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_a4d1da0a125f6044733e121f0f3d958ca"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#a4d1da0a125f6044733e121f0f3d958ca">Global_Physical_Variables::Film_Thickness</a></div><div class="ttdeci">double Film_Thickness</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00054">3d_rayleigh_instability_surfactant.cc:54</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html_ab4193771472aefce4cd67261491cc344"><div class="ttname"><a href="classInterfaceProblem.html#ab4193771472aefce4cd67261491cc344">InterfaceProblem::actions_before_newton_convergence_check</a></div><div class="ttdeci">void actions_before_newton_convergence_check()</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00767">rayleigh_instability_insoluble_surfactant.cc:767</a></div></div>
<div class="ttc" id="aclassInterfaceProblem_html"><div class="ttname"><a href="classInterfaceProblem.html">InterfaceProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00196">3d_rayleigh_instability_surfactant.cc:196</a></div></div>
<div class="ttc" id="anamespaceGlobal__Physical__Variables_html_ab814e627d2eb5bc50318879d19ab16b9"><div class="ttname"><a href="namespaceGlobal__Physical__Variables.html#ab814e627d2eb5bc50318879d19ab16b9">Global_Physical_Variables::Re</a></div><div class="ttdeci">double Re</div><div class="ttdoc">Reynolds number.</div><div class="ttdef"><b>Definition:</b> <a href="3d__rayleigh__instability__surfactant_8cc_source.html#l00057">3d_rayleigh_instability_surfactant.cc:57</a></div></div>
<div class="ttc" id="aclassoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement_html_ab8e6a649149c0e1aadb95dc820b8be86"><div class="ttname"><a href="classoomph_1_1SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement.html#ab8e6a649149c0e1aadb95dc820b8be86">oomph::SpineAxisymmetricMarangoniSurfactantFluidInterfaceElement::fill_in_contribution_to_jacobian_and_mass_matrix</a></div><div class="ttdeci">void fill_in_contribution_to_jacobian_and_mass_matrix(Vector&lt; double &gt; &amp;residuals, DenseMatrix&lt; double &gt; &amp;jacobian, DenseMatrix&lt; double &gt; &amp;mass_matrix)</div><div class="ttdef"><b>Definition:</b> <a href="rayleigh__instability__insoluble__surfactant_8cc_source.html#l00521">rayleigh_instability_insoluble_surfactant.cc:521</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 23 2021 11:30:13
        </div>
      </div>
    </footer>
</body>
</html>

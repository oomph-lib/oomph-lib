\hypertarget{refineable__tetgen__mesh_8template_8cc_source}{}\doxysection{refineable\+\_\+tetgen\+\_\+mesh.\+template.\+cc}
\label{refineable__tetgen__mesh_8template_8cc_source}\index{refineable\_tetgen\_mesh.template.cc@{refineable\_tetgen\_mesh.template.cc}}
\mbox{\hyperlink{refineable__tetgen__mesh_8template_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2021 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00027}00027 \textcolor{preprocessor}{\#ifndef OOMPH\_REFINEABLE\_TETGEN\_MESH\_TEMPLATE\_CC}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00028}00028 \textcolor{preprocessor}{\#define OOMPH\_REFINEABLE\_TETGEN\_MESH\_TEMPLATE\_CC}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00030}00030 \textcolor{comment}{// Config header generated by autoconfig}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00031}00031 \textcolor{preprocessor}{\#ifdef HAVE\_CONFIG\_H}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00032}00032 \textcolor{preprocessor}{\#include <oomph-\/lib-\/config.h>}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00033}00033 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00035}00035 \textcolor{comment}{// OOMPH-\/LIB Headers}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00036}00036 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{refineable__tetgen__mesh_8template_8h}{refineable\_tetgen\_mesh.template.h}}"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00037}00037 \textcolor{preprocessor}{\#include "{}../generic/sample\_point\_parameters.h"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00038}00038 \textcolor{preprocessor}{\#include "{}../generic/mesh\_as\_geometric\_object.h"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00039}00039 \textcolor{preprocessor}{\#include "{}../generic/projection.h"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00040}00040 \textcolor{preprocessor}{\#include "{}../generic/face\_element\_as\_geometric\_object.h"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00041}00041 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00042}00042 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00043}00043 \{\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00044}00044 \textcolor{comment}{  /// Helper function that updates the input faceted surface}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00045}00045 \textcolor{comment}{  /// by using the flattened elements from FaceMesh(es) that are}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00046}00046 \textcolor{comment}{  /// constructed for the boundaries associated with the segments of the}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00047}00047 \textcolor{comment}{  /// polygon.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00048}00048 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00049}\mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh_a48331c4310ecbad71e98b482d0d3ea0c}{00049}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh_a48331c4310ecbad71e98b482d0d3ea0c}{RefineableTetgenMesh<ELEMENT>::update\_faceted\_surface\_using\_face\_mesh}}(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00050}00050     TetMeshFacetedSurface*\& faceted\_surface\_pt)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00051}00051   \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00052}00052     \textcolor{comment}{// The easiest thing to do is simply to update the}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00053}00053     \textcolor{comment}{// positions of the key control nodes, leaving the connectivity alone,}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00054}00054     \textcolor{comment}{// but that doesn't allow for any surface remeshing}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00055}00055 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00056}00056 \textcolor{comment}{    /// List of vertex nodes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00057}00057 \textcolor{comment}{}    std::list<Node*> new\_vertex\_nodes;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00058}00058     \textcolor{comment}{// List of facets and boundary ids}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00059}00059     std::list<std::pair<Vector<unsigned>, \textcolor{keywordtype}{unsigned}>> new\_facet\_list;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00061}00061     \textcolor{comment}{// Loop over the number of old facets}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00062}00062     \textcolor{keywordtype}{unsigned} n\_old\_facet = faceted\_surface\_pt-\/>nfacet();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00063}00063     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} f = 0; f < n\_old\_facet; f++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00064}00064     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00065}00065       \textcolor{comment}{// Get the boundary id of the facet. Need to subtract one,}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00066}00066       \textcolor{comment}{// which is confusing now I think about it.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00067}00067       \textcolor{comment}{// ALH: Should fix this.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00068}00068       \textcolor{keywordtype}{unsigned} bound = faceted\_surface\_pt-\/>one\_based\_facet\_boundary\_id(f) -\/ 1;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00070}00070       \textcolor{comment}{// Create a face mesh adjacent to the fluid mesh's bound-\/th boundary.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00071}00071       \textcolor{comment}{// The face mesh consists of FaceElements that may also be}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00072}00072       \textcolor{comment}{// interpreted as GeomObjects}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00073}00073       Mesh* face\_mesh\_pt = \textcolor{keyword}{new} Mesh;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00074}00074       this-\/>\textcolor{keyword}{template} build\_face\_mesh<ELEMENT, FaceElementAsGeomObject>(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00075}00075         bound, face\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00077}00077       \textcolor{comment}{// Loop over these new face elements and tell them the boundary number}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00078}00078       \textcolor{comment}{// from the bulk fluid mesh -\/-\/ this is required to they can}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00079}00079       \textcolor{comment}{// get access to the boundary coordinates!}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00080}00080       \textcolor{keywordtype}{unsigned} n\_face\_element = face\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00081}00081       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_face\_element; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00082}00082       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00083}00083         \textcolor{comment}{// Cast the element pointer to the correct thing!}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00084}00084         FaceElementAsGeomObject<ELEMENT>* el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00085}00085           \textcolor{keyword}{dynamic\_cast<}FaceElementAsGeomObject<ELEMENT>*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00086}00086             face\_mesh\_pt-\/>element\_pt(e));}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00088}00088         \textcolor{comment}{// Set bulk boundary number}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00089}00089         el\_pt-\/>set\_boundary\_number\_in\_bulk\_mesh(bound);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00090}00090       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00091}00091 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00092}00092       \textcolor{comment}{// In order to set up the new faceted representation}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00093}00093       \textcolor{comment}{// Need to know the positions of the corner nodes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00094}00094       \textcolor{comment}{// and the connectivity}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00095}00095 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00096}00096       \textcolor{comment}{// Storage for the connectivity information}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00097}00097       Vector<unsigned> new\_local\_facet(3);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00098}00098 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00099}00099       \textcolor{comment}{// Now we have the face mesh loop over the face elements and}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00100}00100       \textcolor{comment}{// print out the end points}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00101}00101       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_face\_element; ++e)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00102}00102       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00103}00103         \textcolor{comment}{// Cache pointer to the element}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00104}00104         FiniteElement \textcolor{keyword}{const}* elem\_pt = face\_mesh\_pt-\/>finite\_element\_pt(e);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00105}00105 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00106}00106         \textcolor{comment}{// Just use the three primary (corner) nodes to define the facet}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00107}00107         \textcolor{keywordtype}{unsigned} n\_vertex\_node = 3;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00108}00108         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_vertex\_node; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00109}00109         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00110}00110           \textcolor{comment}{// Cache the pointer to the node}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00111}00111           Node* \textcolor{keyword}{const} nod\_pt = elem\_pt-\/>node\_pt(n);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00112}00112           \textcolor{comment}{// If the vertex node is in the list return the number}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00113}00113           \textcolor{keywordtype}{unsigned} counter = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00114}00114           \textcolor{keywordtype}{bool} found\_it = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00115}00115           \textcolor{keywordflow}{for} (std::list<Node*>::iterator it = new\_vertex\_nodes.begin();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00116}00116                it != new\_vertex\_nodes.end();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00117}00117                ++it, ++counter)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00118}00118           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00119}00119             \textcolor{comment}{// If we have found the node then store it}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00120}00120             \textcolor{keywordflow}{if} (*it == nod\_pt)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00121}00121             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00122}00122               new\_local\_facet[n] = counter;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00123}00123               found\_it = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00124}00124               \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00125}00125             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00126}00126           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00128}00128           \textcolor{comment}{// If we haven't found it}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00129}00129           \textcolor{comment}{// then add the node to the list and fill in the counter}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00130}00130           \textcolor{keywordflow}{if} (!found\_it)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00131}00131           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00132}00132             new\_vertex\_nodes.push\_back(nod\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00133}00133             \textcolor{comment}{// We know where it is}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00134}00134             new\_local\_facet[n] = counter;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00135}00135           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00136}00136         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00138}00138         \textcolor{comment}{// Add the new facet connectivity to the list}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00139}00139         new\_facet\_list.push\_back(std::make\_pair(new\_local\_facet, bound + 1));}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00140}00140       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00141}00141     \} \textcolor{comment}{// End of loop over old facets}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00143}00143 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00144}00144     \textcolor{comment}{// Probably want the surface mesh in a better data structure so}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00145}00145     \textcolor{comment}{// that we can perform refinement or coarsening on it}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00146}00146     \textcolor{comment}{// i.e. want neighbours, edge flips all that fun stuff}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00147}00147     \textcolor{comment}{// That will go here!}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00148}00148 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00149}00149     \textcolor{comment}{// Now we need to put the information into the appropriate data structures}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00150}00150     \textcolor{comment}{// for the Surface}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00151}00151 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00152}00152     \textcolor{comment}{// Now sort out the facet nodes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00153}00153     \textcolor{keywordtype}{unsigned} n\_facet\_vertex = new\_vertex\_nodes.size();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00154}00154     \textcolor{comment}{// Vector<Vector<double> > facet\_point(n\_facet\_vertex);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00155}00155     Vector<Node*> facet\_nodes\_pt(n\_facet\_vertex);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00156}00156     \textcolor{keywordtype}{unsigned} count = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00157}00157     \textcolor{keywordflow}{for} (std::list<Node*>::iterator it = new\_vertex\_nodes.begin();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00158}00158          it != new\_vertex\_nodes.end();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00159}00159          ++it)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00160}00160     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00161}00161       facet\_nodes\_pt[count] = *it;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00162}00162       \textcolor{comment}{// facet\_point[count].resize(3);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00163}00163       \textcolor{comment}{//   for(unsigned i=0;i<3;i++)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00164}00164       \textcolor{comment}{//    \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00165}00165       \textcolor{comment}{//     facet\_point[count][i] = (*it)-\/>x(i);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00166}00166       \textcolor{comment}{//    \}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00167}00167       ++count;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00168}00168     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00169}00169 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00170}00170     \textcolor{comment}{// And also the facets}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00171}00171     \textcolor{keywordtype}{unsigned} n\_facet = new\_facet\_list.size();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00172}00172     Vector<Vector<unsigned>> new\_facet(n\_facet);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00173}00173     Vector<unsigned> new\_facet\_boundary\_id(n\_facet);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00174}00174     count = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00175}00175     \textcolor{keywordflow}{for} (std::list<std::pair<Vector<unsigned>, \textcolor{keywordtype}{unsigned}>>::iterator it =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00176}00176            new\_facet\_list.begin();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00177}00177          it != new\_facet\_list.end();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00178}00178          ++it)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00179}00179     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00180}00180       new\_facet[count] = (*it).first;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00181}00181       new\_facet\_boundary\_id[count] = (*it).second;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00182}00182       ++count;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00183}00183     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00184}00184 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00185}00185     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} f = 0; f < n\_facet; f++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00186}00186     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00187}00187       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00188}00188       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00189}00189         oomph\_info << new\_facet[f][i] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00190}00190       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00191}00191       oomph\_info << \textcolor{stringliteral}{"{} : "{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00192}00192       oomph\_info << new\_facet\_boundary\_id[f] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00193}00193     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00194}00194 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00195}00195     \textcolor{comment}{// Now just create the new boundary}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00196}00196     \textcolor{keyword}{delete} faceted\_surface\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00197}00197     faceted\_surface\_pt = \textcolor{keyword}{new} TetMeshFacetedClosedSurfaceForRemesh(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00198}00198       facet\_nodes\_pt, new\_facet, new\_facet\_boundary\_id);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00200}00200     \textcolor{comment}{// Also need to setup the reverse look-\/up scheme again}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00201}00201     this-\/>setup\_reverse\_lookup\_schemes\_for\_faceted\_surface(faceted\_surface\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00203}00203     \textcolor{comment}{// Take average to get a new hole position (Won't always work)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00204}00204     Vector<double> inner\_point(3, 0.0);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00205}00205     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_facet\_vertex; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00206}00206     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00207}00207       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00208}00208       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00209}00209         inner\_point[i] += facet\_nodes\_pt[n]-\/>x(i);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00210}00210       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00211}00211     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00212}00212 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00213}00213     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00214}00214     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00215}00215       inner\_point[i] /= n\_facet\_vertex;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00216}00216     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00217}00217 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00218}00218     \textcolor{comment}{// Now set the hole if required}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00219}00219     \textcolor{keyword}{dynamic\_cast<}TetMeshFacetedClosedSurface*\textcolor{keyword}{>}(faceted\_surface\_pt)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00220}00220       -\/>set\_hole\_for\_tetgen(inner\_point);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00221}00221   \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00222}00222 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00223}00223 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00224}00224 \textcolor{comment}{  /// Generate a new faceted representation of the inner hole}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00225}00225 \textcolor{comment}{  /// boundaries}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00226}00226 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00227}\mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh_a001c3ff513cabdfbd67c65bd97ebb768}{00227}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh_a001c3ff513cabdfbd67c65bd97ebb768}{RefineableTetgenMesh<ELEMENT>::surface\_remesh\_for\_inner\_hole\_boundaries}}()}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00228}00228   \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00229}00229     \textcolor{comment}{// Loop over the number of internal boundarys}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00230}00230     \textcolor{keywordtype}{unsigned} n\_hole = this-\/>Internal\_surface\_pt.size();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00231}00231     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ihole = 0; ihole < n\_hole; ihole++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00232}00232     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00233}00233       \textcolor{comment}{// Now can the surface update its own representation goes in here}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00234}00234 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00235}00235       \textcolor{comment}{// If not we have to generate it from the new mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00236}00236       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00237}00237         \textcolor{comment}{// Update the faceted surface associated with the ihole-\/th hole}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00238}00238         this-\/>update\_faceted\_surface\_using\_face\_mesh(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00239}00239           this-\/>Internal\_surface\_pt[ihole]);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00240}00240       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00241}00241     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00242}00242   \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00243}00243 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00244}00244 \textcolor{comment}{  /// Snap the boundary nodes onto any curvilinear boundaries}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00245}00245 \textcolor{comment}{}  \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00246}\mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh_acf9eea5998765dc36b96a2050db3e1e3}{00246}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh_acf9eea5998765dc36b96a2050db3e1e3}{RefineableTetgenMesh<ELEMENT>::snap\_nodes\_onto\_boundary}}(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00247}00247     \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh}{RefineableTetgenMesh<ELEMENT>}}*\& new\_mesh\_pt, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned}\& b)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00248}00248   \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00249}00249     \textcolor{comment}{// Quick return}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00250}00250     \textcolor{keywordflow}{if} (!Boundary\_coordinate\_exists[b])}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00251}00251     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00252}00252       oomph\_info << \textcolor{stringliteral}{"{}Not snapping nodes on boundary "{}} << b}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00253}00253                  << \textcolor{stringliteral}{"{} because no boundary coordinate has been set up.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00254}00254       \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00255}00255     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00256}00256 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00257}00257     \textcolor{comment}{// Firstly we set the boundary coordinates of the new nodes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00258}00258     \textcolor{comment}{// In case the mapping between the geometric object's intrinsic coordiante}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00259}00259     \textcolor{comment}{// and the arc-\/length coordinate is nonlinear.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00260}00260     \textcolor{comment}{// This is only an approximation,}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00261}00261     \textcolor{comment}{// but it will ensure that the nodes that were input to triangle will}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00262}00262     \textcolor{comment}{// retain exactly the same boundary coordinates and}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00263}00263     \textcolor{comment}{// then linear interpolation}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00264}00264     \textcolor{comment}{// is used between those values for any newly created nodes.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00265}00265 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00266}00266 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00267}00267     \textcolor{comment}{// Create a face mesh adjacent to the fluid mesh's b-\/th boundary.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00268}00268     \textcolor{comment}{// The face mesh consists of FaceElements that may also be}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00269}00269     \textcolor{comment}{// interpreted as GeomObjects}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00270}00270     Mesh* face\_mesh\_pt = \textcolor{keyword}{new} Mesh;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00271}00271     this-\/>\textcolor{keyword}{template} build\_face\_mesh<ELEMENT, FaceElementAsGeomObject>(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00272}00272       b, face\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00273}00273 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00274}00274     \textcolor{comment}{// Loop over these new face elements and tell them the boundary number}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00275}00275     \textcolor{comment}{// from the bulk fluid mesh -\/-\/ this is required to they can}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00276}00276     \textcolor{comment}{// get access to the boundary coordinates!}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00277}00277     \textcolor{keywordtype}{unsigned} n\_face\_element = face\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00278}00278     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_face\_element; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00279}00279     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00280}00280       \textcolor{comment}{// Cast the element pointer to the correct thing!}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00281}00281       FaceElementAsGeomObject<ELEMENT>* el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00282}00282         \textcolor{keyword}{dynamic\_cast<}FaceElementAsGeomObject<ELEMENT>*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00283}00283           face\_mesh\_pt-\/>element\_pt(e));}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00284}00284 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00285}00285       \textcolor{comment}{// Set bulk boundary number}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00286}00286       el\_pt-\/>set\_boundary\_number\_in\_bulk\_mesh(b);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00287}00287     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00288}00288 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00289}00289 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00290}00290     \textcolor{comment}{// Compare face meshes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00291}00291     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00292}00292       Mesh* new\_face\_mesh\_pt = \textcolor{keyword}{new} Mesh;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00293}00293       new\_mesh\_pt-\/>template build\_face\_mesh<ELEMENT, FaceElementAsGeomObject>(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00294}00294         b, new\_face\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00295}00295 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00296}00296       std::ostringstream filestring;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00297}00297       filestring << \textcolor{stringliteral}{"{}old\_mesh\_boundary"{}} << b << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00298}00298       face\_mesh\_pt-\/>output(filestring.str().c\_str());}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00299}00299       filestring.clear();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00300}00300       filestring << \textcolor{stringliteral}{"{}new\_mesh\_boundary"{}} << b << \textcolor{stringliteral}{"{}.dat"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00301}00301       new\_face\_mesh\_pt-\/>output(filestring.str().c\_str());}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00302}00302 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00303}00303       Vector<double> b\_coo(2);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00304}00304       std::cout << \textcolor{stringliteral}{"{}OLD-\/-\/-\/\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00305}00305       \textcolor{comment}{// Now let's look at the boundary coordinates}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00306}00306       \textcolor{keywordtype}{unsigned} n\_tmp\_node = this-\/>nboundary\_node(b);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00307}00307       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_tmp\_node; ++n)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00308}00308       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00309}00309         Node* \textcolor{keyword}{const} nod\_pt = this-\/>boundary\_node\_pt(b, n);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00310}00310         nod\_pt-\/>get\_coordinates\_on\_boundary(b, b\_coo);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00311}00311         std::cout << nod\_pt-\/>x(0) << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>x(1) << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>x(2)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00312}00312                   << \textcolor{stringliteral}{"{} "{}} << b\_coo[0] << \textcolor{stringliteral}{"{} "{}} << b\_coo[1] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00313}00313       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00314}00314 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00315}00315       std::cout << \textcolor{stringliteral}{"{}NEW-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00316}00316       \textcolor{comment}{// Now let's look at the boundary coordinates}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00317}00317       n\_tmp\_node = new\_mesh\_pt-\/>nboundary\_node(b);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00318}00318       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_tmp\_node; ++n)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00319}00319       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00320}00320         Node* \textcolor{keyword}{const} nod\_pt = new\_mesh\_pt-\/>boundary\_node\_pt(b, n);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00321}00321         nod\_pt-\/>get\_coordinates\_on\_boundary(b, b\_coo);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00322}00322         std::cout << nod\_pt-\/>x(0) << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>x(1) << \textcolor{stringliteral}{"{} "{}} << nod\_pt-\/>x(2)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00323}00323                   << \textcolor{stringliteral}{"{} "{}} << b\_coo[0] << \textcolor{stringliteral}{"{} "{}} << b\_coo[1] << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00324}00324       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00325}00325     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00327}00327 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00328}00328     \textcolor{comment}{// Now make the mesh as geometric object}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00329}00329     MeshAsGeomObject* mesh\_geom\_obj\_pt = \textcolor{keyword}{new} MeshAsGeomObject(face\_mesh\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00330}00330 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00331}00331     \textcolor{comment}{// Now assign the new nodes positions based on the old meshes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00332}00332     \textcolor{comment}{// potentially curvilinear boundary (its geom object incarnation)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00333}00333     Vector<double> new\_x(3);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00334}00334     Vector<double> b\_coord(2);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00335}00335     \textcolor{keywordtype}{unsigned} n\_new\_boundary\_node = new\_mesh\_pt-\/>nboundary\_node(b);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00336}00336     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_new\_boundary\_node; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00337}00337     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00338}00338       \textcolor{comment}{// Get the boundary coordinate of all new nodes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00339}00339       Node* \textcolor{keyword}{const} nod\_pt = new\_mesh\_pt-\/>boundary\_node\_pt(b, n);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00340}00340       nod\_pt-\/>get\_coordinates\_on\_boundary(b, b\_coord);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00341}00341       \textcolor{comment}{// Let's find boundary coordinates of the new node}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00342}00342       mesh\_geom\_obj\_pt-\/>position(b\_coord, new\_x);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00343}00343       \textcolor{comment}{// Now snap to the boundary}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00344}00344       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00345}00345       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00346}00346         nod\_pt-\/>x(i) = new\_x[i];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00347}00347       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00348}00348     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00349}00349 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00350}00350 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00351}00351     \textcolor{comment}{// Delete the allocated memory for the geometric object and face mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00352}00352     \textcolor{keyword}{delete} mesh\_geom\_obj\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00353}00353     face\_mesh\_pt-\/>flush\_element\_and\_node\_storage();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00354}00354     \textcolor{keyword}{delete} face\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00356}00356     \textcolor{comment}{// Loop over the elements adjacent to the boundary}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00357}00357     \textcolor{keywordtype}{unsigned} n\_element = new\_mesh\_pt-\/>nboundary\_element(b);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00358}00358     \textcolor{keywordflow}{if} (n\_element > 0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00359}00359     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00360}00360       \textcolor{comment}{// Make a dummy simplex element}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00361}00361       TElement<3, 2> dummy\_four\_node\_element;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00362}00362       \textcolor{comment}{// Make a dummy quadratic element}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00363}00363       TElement<3, 3> dummy\_ten\_node\_element;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00364}00364       Vector<double> s(3);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00365}00365       Vector<double> x\_new(3);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00366}00366       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 4; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00367}00367       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00368}00368         dummy\_four\_node\_element.construct\_node(n);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00369}00369       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00370}00370       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 10; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00371}00371       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00372}00372         dummy\_ten\_node\_element.construct\_node(n);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00373}00373       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00374}00374       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_element; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00375}00375       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00376}00376         \textcolor{comment}{// Cache the element pointer}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00377}00377         ELEMENT* elem\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00378}00378           \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(new\_mesh\_pt-\/>boundary\_element\_pt(b, e));}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00379}00379 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00380}00380         \textcolor{comment}{// Find the number of nodes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00381}00381         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_node = elem\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00382}00382         \textcolor{comment}{// Only do something if not simplex element}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00383}00383         \textcolor{keywordflow}{if} (n\_node > 4)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00384}00384         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00385}00385           \textcolor{comment}{// Copy the nodes into the dummy}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00386}00386           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 4; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00387}00387           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00388}00388             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00389}00389             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00390}00390               dummy\_four\_node\_element.node\_pt(n)-\/>x(i) =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00391}00391                 elem\_pt-\/>node\_pt(n)-\/>x(i);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00392}00392             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00393}00393           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00395}00395           \textcolor{comment}{// Now sort out the mid-\/side nodes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00396}00396           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 4; n < 10; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00397}00397           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00398}00398             \textcolor{comment}{// If it's not on a boundary then reset to be interpolated}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00399}00399             \textcolor{comment}{// from the simplex}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00400}00400             \textcolor{keywordflow}{if} (!elem\_pt-\/>node\_pt(n)-\/>is\_on\_boundary())}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00401}00401             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00402}00402               elem\_pt-\/>local\_coordinate\_of\_node(n, s);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00403}00403               dummy\_four\_node\_element.interpolated\_x(s, x\_new);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00404}00404               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00405}00405               \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00406}00406                 elem\_pt-\/>node\_pt(n)-\/>x(i) = x\_new[i];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00407}00407               \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00408}00408             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00409}00409           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00410}00410         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00411}00411 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00412}00412         \textcolor{comment}{// If we have more than 10 nodes interpolate from the quadratic shape}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00413}00413         \textcolor{keywordflow}{if} (n\_node > 10)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00414}00414         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00415}00415           \textcolor{comment}{// Copy the nodes into the dummy}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00416}00416           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < 10; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00417}00417           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00418}00418             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00419}00419             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00420}00420               dummy\_ten\_node\_element.node\_pt(n)-\/>x(i) =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00421}00421                 elem\_pt-\/>node\_pt(n)-\/>x(i);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00422}00422             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00423}00423           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00424}00424 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00425}00425           \textcolor{comment}{// Now sort out the mid-\/face and central nodes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00426}00426           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 10; n < n\_node; n++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00427}00427           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00428}00428             \textcolor{comment}{// If it's not on a boundary then reset to be interpolated}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00429}00429             \textcolor{comment}{// from the simplex}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00430}00430             \textcolor{keywordflow}{if} (!elem\_pt-\/>node\_pt(n)-\/>is\_on\_boundary())}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00431}00431             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00432}00432               elem\_pt-\/>local\_coordinate\_of\_node(n, s);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00433}00433               dummy\_ten\_node\_element.interpolated\_x(s, x\_new);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00434}00434               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00435}00435               \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00436}00436                 elem\_pt-\/>node\_pt(n)-\/>x(i) = x\_new[i];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00437}00437               \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00438}00438             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00439}00439           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00440}00440         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00441}00441       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00442}00442     \} \textcolor{comment}{// End of fix up of elements}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00443}00443   \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00444}00444 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00445}00445 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00446}00446   \textcolor{comment}{//======================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00447}00447 \textcolor{comment}{  /// Adapt problem based on specified elemental error estimates}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00448}00448 \textcolor{comment}{}  \textcolor{comment}{//======================================================================}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00449}00449   \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00450}\mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh_ad75ff5f1e088e611311c3f6a30feea5b}{00450}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh_ad75ff5f1e088e611311c3f6a30feea5b}{RefineableTetgenMesh<ELEMENT>::adapt}}(\textcolor{keyword}{const} Vector<double>\& elem\_error)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00451}00451   \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00452}00452     \textcolor{keywordtype}{double} t\_start = 0.0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00453}00453     \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00454}00454     t\_start = TimingHelpers::timer();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00455}00455     \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00456}00456 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00457}00457     \textcolor{comment}{// Get refinement targets}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00458}00458     Vector<double> target\_size(elem\_error.size());}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00459}00459     \textcolor{keywordtype}{double} max\_edge\_ratio =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00460}00460       this-\/>compute\_volume\_target(elem\_error, target\_size);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00461}00461     \textcolor{comment}{// Get maximum target volume}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00462}00462     \textcolor{keywordtype}{unsigned} n = target\_size.size();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00463}00463     \textcolor{keywordtype}{double} max\_size = 0.0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00464}00464     \textcolor{keywordtype}{double} min\_size = DBL\_MAX;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00465}00465     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00466}00466     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00467}00467       \textcolor{keywordflow}{if} (target\_size[e] > max\_size) max\_size = target\_size[e];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00468}00468       \textcolor{keywordflow}{if} (target\_size[e] < min\_size) min\_size = target\_size[e];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00469}00469     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00470}00470 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00471}00471     oomph\_info << \textcolor{stringliteral}{"{}Maximum target size: "{}} << max\_size << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00472}00472     oomph\_info << \textcolor{stringliteral}{"{}Minimum target size: "{}} << min\_size << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00473}00473     oomph\_info << \textcolor{stringliteral}{"{}Number of elements to be refined "{}} << this-\/>Nrefined}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00474}00474                << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00475}00475     oomph\_info << \textcolor{stringliteral}{"{}Number of elements to be unrefined "{}} << this-\/>Nunrefined}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00476}00476                << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00477}00477     oomph\_info << \textcolor{stringliteral}{"{}Max edge ratio "{}} << max\_edge\_ratio << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00478}00478 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00479}00479     \textcolor{keywordtype}{double} orig\_max\_size, orig\_min\_size;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00480}00480     this-\/>max\_and\_min\_element\_size(orig\_max\_size, orig\_min\_size);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00481}00481     oomph\_info << \textcolor{stringliteral}{"{}Max/min element size in original mesh: "{}} << orig\_max\_size}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00482}00482                << \textcolor{stringliteral}{"{} "{}} << orig\_min\_size << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00483}00483 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00484}00484     \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00485}00485     oomph\_info}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00486}00486       << \textcolor{stringliteral}{"{}adapt: Time for getting volume targets                      : "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00487}00487       << TimingHelpers::timer() -\/ t\_start << \textcolor{stringliteral}{"{} sec "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00488}00488     \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00489}00489 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00490}00490     \textcolor{comment}{//===============================================================}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00491}00491     \textcolor{comment}{// END: Compute target volumes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00492}00492     \textcolor{comment}{//===============================================================}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00493}00493 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00494}00494     \textcolor{comment}{// Check if boundaries need to be updated (regardless of}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00495}00495     \textcolor{comment}{// requirements of bulk error estimator) but don't do anything!}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00496}00496     \textcolor{keywordtype}{bool} check\_only = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00497}00497     \textcolor{keywordtype}{bool} outer\_boundary\_update\_necessary = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00498}00498     \textcolor{keywordtype}{bool} inner\_boundary\_update\_necessary = \textcolor{keyword}{false}; \textcolor{comment}{// true;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00499}00499 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00500}00500     \textcolor{comment}{// Should we bother to adapt?}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00501}00501     \textcolor{keywordflow}{if} ((Nrefined > 0) || (Nunrefined > this-\/>max\_keep\_unrefined()) ||}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00502}00502         (max\_edge\_ratio > this-\/>max\_permitted\_edge\_ratio()))}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00503}00503     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00504}00504       \textcolor{keywordflow}{if} (!((Nrefined > 0) || (Nunrefined > max\_keep\_unrefined())))}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00505}00505       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00506}00506         oomph\_info << \textcolor{stringliteral}{"{}Mesh regeneration triggered by edge ratio criterion\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00507}00507       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00508}00508 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00509}00509       \textcolor{comment}{// Generate remesh of inner surface}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00510}00510       \textcolor{keywordflow}{if} (inner\_boundary\_update\_necessary)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00511}00511       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00512}00512         this-\/>surface\_remesh\_for\_inner\_hole\_boundaries();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00513}00513 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00514}00514 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00515}00515         \textcolor{comment}{// If there is not a geometric object associated with the boundary}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00516}00516         \textcolor{comment}{// the reset the boundary coordinates so that the lengths are consistent}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00517}00517         \textcolor{comment}{// in the new mesh and the old mesh.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00518}00518         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} n\_boundary = this-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00519}00519         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < n\_boundary; ++b)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00520}00520         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00521}00521           \textcolor{comment}{// if(this-\/>boundary\_geom\_object\_pt(b)==0)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00522}00522           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00523}00523             this-\/>\textcolor{keyword}{template} setup\_boundary\_coordinates<ELEMENT>(b);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00524}00524           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00525}00525         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00526}00526       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00528}00528 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00529}00529       \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00530}00530       t\_start = TimingHelpers::timer();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00531}00531       \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00532}00532 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00533}00533       \textcolor{comment}{// Are we dealing with a solid mesh?}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00534}00534       SolidMesh* solid\_mesh\_pt = \textcolor{keyword}{dynamic\_cast<}SolidMesh*\textcolor{keyword}{>}(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00535}00535 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00536}00536       \textcolor{comment}{// Build temporary uniform background mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00537}00537       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00538}00538       \textcolor{comment}{// with volume set by maximum required volume}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00539}00539       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00540}00540       \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh}{RefineableTetgenMesh<ELEMENT>}}* tmp\_new\_mesh\_pt = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00541}00541       \textcolor{keywordflow}{if} (solid\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00542}00542       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00543}00543         \textcolor{comment}{/*throw OomphLibError("{}Solid RefineableTetgenMesh not done yet."{},}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00544}00544 \textcolor{comment}{                            OOMPH\_CURRENT\_FUNCTION,}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00545}00545 \textcolor{comment}{                            OOMPH\_EXCEPTION\_LOCATION);*/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00546}00546         tmp\_new\_mesh\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1RefineableSolidTetgenMesh}{RefineableSolidTetgenMesh<ELEMENT>}}(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00547}00547           this-\/>Outer\_boundary\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00548}00548           this-\/>Internal\_surface\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00549}00549           max\_size,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00550}00550           this-\/>Time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00551}00551           this-\/>Use\_attributes,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00552}00552           this-\/>Corner\_elements\_must\_be\_split);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00553}00553       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00554}00554       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00555}00555       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00556}00556         tmp\_new\_mesh\_pt = \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh}{RefineableTetgenMesh<ELEMENT>}}(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00557}00557           this-\/>Outer\_boundary\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00558}00558           this-\/>Internal\_surface\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00559}00559           max\_size,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00560}00560           this-\/>Time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00561}00561           this-\/>Use\_attributes,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00562}00562           this-\/>Corner\_elements\_must\_be\_split);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00563}00563       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00564}00564 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00565}00565 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00566}00566       \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00567}00567       oomph\_info}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00568}00568         << \textcolor{stringliteral}{"{}adapt: Time for building temp mesh                        : "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00569}00569         << TimingHelpers::timer() -\/ t\_start << \textcolor{stringliteral}{"{} sec "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00570}00570       \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00571}00571 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00572}00572       \textcolor{comment}{// tmp\_new\_mesh\_pt-\/>output("{}pre\_mesh\_nodes\_snapped\_0.dat"{});}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00573}00573 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00574}00574       \textcolor{comment}{// //Move the nodes on the new boundary onto the}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00575}00575       \textcolor{comment}{// //old curvilinear boundary}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00576}00576       \textcolor{comment}{// //If the boundary is straight this will do precisely nothing}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00577}00577       \textcolor{comment}{// //but will be somewhat inefficient}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00578}00578       \textcolor{comment}{// \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00579}00579       \textcolor{comment}{//  const unsigned n\_boundary = this-\/>nboundary();}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00580}00580       \textcolor{comment}{//  for(unsigned b=0;b<n\_boundary;b++)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00581}00581       \textcolor{comment}{//   \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00582}00582       \textcolor{comment}{//    std::cout << "{}Snapping to boundary "{} << b << "{}\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00583}00583       \textcolor{comment}{//    this-\/>snap\_nodes\_onto\_boundary(tmp\_new\_mesh\_pt,b);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00584}00584       \textcolor{comment}{//   \}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00585}00585       \textcolor{comment}{// \}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00586}00586 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00587}00587       \textcolor{comment}{// tmp\_new\_mesh\_pt-\/>output("{}mesh\_nodes\_snapped\_0.dat"{});}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00588}00588 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00589}00589 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00590}00590       \textcolor{comment}{// Get the tetgenio object associated with that mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00591}00591       tetgenio* tmp\_new\_tetgenio\_pt = tmp\_new\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetgenMesh_a4f80936c6c66947f304286605b2046ba}{tetgenio\_pt}}();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00592}00592       \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh}{RefineableTetgenMesh<ELEMENT>}}* new\_mesh\_pt = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00593}00593 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00594}00594       \textcolor{comment}{// If the mesh is a solid mesh then do the mapping based on the}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00595}00595       \textcolor{comment}{// Eulerian coordinates}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00596}00596       \textcolor{keywordtype}{bool} use\_eulerian\_coords = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00597}00597       \textcolor{keywordflow}{if} (solid\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00598}00598       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00599}00599         use\_eulerian\_coords = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00600}00600       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00601}00601 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00602}00602 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_CGAL}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00603}00603 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00604}00604       \textcolor{comment}{// Make cgal-\/based bin}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00605}00605       CGALSamplePointContainerParameters cgal\_params(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00606}00606       \textcolor{keywordflow}{if} (use\_eulerian\_coords)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00607}00607       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00608}00608         cgal\_params.enable\_use\_eulerian\_coordinates\_during\_setup();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00609}00609       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00610}00610       MeshAsGeomObject* mesh\_geom\_obj\_pt = \textcolor{keyword}{new} MeshAsGeomObject(\&cgal\_params);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00611}00611 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00612}00612 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00613}00613 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00614}00614       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00615}00615       error\_message << \textcolor{stringliteral}{"{}Non-\/CGAL-\/based target size transfer not implemented.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00616}00616       \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00617}00617         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00618}00618 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00619}00619       \textcolor{comment}{// Here's the relevant construction from the triangle mesh. Update...}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00620}00620 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00621}00621       \textcolor{comment}{// // Make nonrefineable bin}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00622}00622       \textcolor{comment}{// NonRefineableBinArrayParameters params(this);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00623}00623       \textcolor{comment}{// if (use\_eulerian\_coords)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00624}00624       \textcolor{comment}{//  \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00625}00625       \textcolor{comment}{//   params.enable\_use\_eulerian\_coordinates\_during\_setup();}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00626}00626       \textcolor{comment}{//  \}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00627}00627       \textcolor{comment}{// Vector<unsigned> bin\_dim(2);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00628}00628       \textcolor{comment}{// bin\_dim[0]=Nbin\_x\_for\_area\_transfer;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00629}00629       \textcolor{comment}{// bin\_dim[1]=Nbin\_y\_for\_area\_transfer;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00630}00630       \textcolor{comment}{// params.dimensions\_of\_bin\_array()=bin\_dim;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00631}00631       \textcolor{comment}{// MeshAsGeomObject* mesh\_geom\_obj\_pt=new MeshAsGeomObject(\&params);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00632}00632 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00633}00633 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00634}00634 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00635}00635       \textcolor{comment}{// Set up a map from pointer to element to its number}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00636}00636       \textcolor{comment}{// in the mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00637}00637       std::map<GeneralisedElement*, unsigned> element\_number;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00638}00638       \textcolor{keywordtype}{unsigned} nelem = this-\/>nelement();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00639}00639       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < nelem; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00640}00640       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00641}00641         element\_number[this-\/>element\_pt(e)] = e;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00642}00642       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00643}00643 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00644}00644       \textcolor{comment}{// Now start iterating to refine mesh recursively}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00645}00645       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00646}00646       \textcolor{keywordtype}{bool} done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00647}00647       \textcolor{keywordtype}{unsigned} iter = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00648}00648       \textcolor{keywordflow}{while} (!done)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00649}00649       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00650}00650         \textcolor{comment}{// Accept by default but overwrite if things go wrong below}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00651}00651         done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00652}00652 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00653}00653         \textcolor{comment}{// Loop over elements in new (tmp) mesh and visit all}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00654}00654         \textcolor{comment}{// its integration points. Check where it's located in the bin}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00655}00655         \textcolor{comment}{// structure of the current mesh and pass the target size}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00656}00656         \textcolor{comment}{// to the new element}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00657}00657         \textcolor{keywordtype}{unsigned} nelem = tmp\_new\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00658}00658 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00659}00659         \textcolor{comment}{// Store the target sizes for elements in the temporary}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00660}00660         \textcolor{comment}{// mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00661}00661         Vector<double> new\_transferred\_target\_size(nelem, 0.0);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00662}00662         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < nelem; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00663}00663         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00664}00664           ELEMENT* el\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00665}00665             \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(tmp\_new\_mesh\_pt-\/>element\_pt(e));}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00666}00666           \textcolor{keywordtype}{unsigned} nint = el\_pt-\/>integral\_pt()-\/>nweight();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00667}00667           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} ipt = 0; ipt < nint; ipt++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00668}00668           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00669}00669             \textcolor{comment}{// Get the coordinate of current point}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00670}00670             Vector<double> s(3);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00671}00671             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00672}00672             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00673}00673               s[i] = el\_pt-\/>integral\_pt()-\/>knot(ipt, i);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00674}00674             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00675}00675 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00676}00676             Vector<double> x(3);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00677}00677             el\_pt-\/>interpolated\_x(s, x);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00678}00678 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00679}00679 \textcolor{preprocessor}{\#if OOMPH\_HAS\_CGAL}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00680}00680 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00681}00681             \textcolor{comment}{// Try the five nearest sample points for Newton search}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00682}00682             \textcolor{comment}{// then just settle on the nearest one}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00683}00683             GeomObject* geom\_obj\_pt = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00684}00684             \textcolor{keywordtype}{unsigned} max\_sample\_points = 5;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00685}00685             \textcolor{keyword}{dynamic\_cast<}CGALSamplePointContainer*\textcolor{keyword}{>}(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00686}00686               mesh\_geom\_obj\_pt-\/>sample\_point\_container\_pt())}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00687}00687               -\/>limited\_locate\_zeta(x, max\_sample\_points, geom\_obj\_pt, s);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00688}00688 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00689}00689             \textcolor{keywordflow}{if} (geom\_obj\_pt == 0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00690}00690             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00691}00691               std::stringstream error\_message;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00692}00692               error\_message << \textcolor{stringliteral}{"{}Limited locate zeta failed for zeta = [ "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00693}00693                             << x[0] << \textcolor{stringliteral}{"{} "{}} << x[1] << \textcolor{stringliteral}{"{} "{}} << x[2]}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00694}00694                             << \textcolor{stringliteral}{"{} ]. Makes no sense!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00695}00695               \textcolor{keywordflow}{throw} OomphLibError(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00696}00696                                   OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00697}00697                                   OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00698}00698             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00699}00699             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00700}00700             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00701}00701 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00702}00702               FiniteElement* fe\_pt = \textcolor{keyword}{dynamic\_cast<}FiniteElement*\textcolor{keyword}{>}(geom\_obj\_pt);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00703}00703 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00704}00704               \textcolor{keywordflow}{if} (fe\_pt == 0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00705}00705               \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00706}00706                 std::stringstream error\_message;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00707}00707                 error\_message << \textcolor{stringliteral}{"{}Cast to FE for GeomObject returned by "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00708}00708                                  \textcolor{stringliteral}{"{}limited locate zeta failed for zeta = [ "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00709}00709                               << x[0] << \textcolor{stringliteral}{"{} "{}} << x[1] << \textcolor{stringliteral}{"{} "{}} << x[2]}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00710}00710                               << \textcolor{stringliteral}{"{} ]. Makes no sense!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00711}00711                 \textcolor{keywordflow}{throw} OomphLibError(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00712}00712                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00713}00713                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00714}00714               \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00715}00715               \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00716}00716               \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00717}00717 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00718}00718                 \textcolor{comment}{// What's the target size of the element that contains this}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00719}00719                 \textcolor{comment}{// point}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00720}00720                 \textcolor{keywordtype}{double} tg\_size = target\_size[element\_number[fe\_pt]];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00721}00721 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00722}00722                 \textcolor{comment}{// Go for smallest target size over all integration}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00723}00723                 \textcolor{comment}{// points in new element}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00724}00724                 \textcolor{comment}{// to force "{}one level"{} of refinement (the one-\/level-\/ness}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00725}00725                 \textcolor{comment}{// is enforced below by limiting the actual reduction in}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00726}00726                 \textcolor{comment}{// size}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00727}00727                 \textcolor{keywordflow}{if} (new\_transferred\_target\_size[e] != 0.0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00728}00728                 \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00729}00729                   new\_transferred\_target\_size[e] =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00730}00730                     std::min(new\_transferred\_target\_size[e], tg\_size);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00731}00731                 \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00732}00732                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00733}00733                 \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00734}00734                   new\_transferred\_target\_size[e] = tg\_size;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00735}00735                 \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00736}00736 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00737}00737               \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00738}00738             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00739}00739 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00740}00740 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00741}00741 \textcolor{comment}{// Non-\/CGAL}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00742}00742 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00743}00743 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00744}00744             std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00745}00745             error\_message}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00746}00746               << \textcolor{stringliteral}{"{}Non-\/CGAL-\/based target size transfer not implemented.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00747}00747             \textcolor{keywordflow}{throw} OomphLibError(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00748}00748                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00749}00749                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00750}00750 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00751}00751             \textcolor{comment}{// Here's the relevant construction from the triangle mesh.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00752}00752             \textcolor{comment}{// Update...}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00753}00753 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00754}00754             \textcolor{comment}{// // Find the bin that contains that point and its contents}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00755}00755             \textcolor{comment}{// int bin\_number=0;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00756}00756             \textcolor{comment}{// bin\_array\_pt-\/>get\_bin(x,bin\_number);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00757}00757 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00758}00758             \textcolor{comment}{// // Did we find it?}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00759}00759             \textcolor{comment}{// if (bin\_number<0)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00760}00760             \textcolor{comment}{//  \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00761}00761             \textcolor{comment}{//   // Not even within bin boundaries... odd}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00762}00762             \textcolor{comment}{//   std::stringstream error\_message;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00763}00763             \textcolor{comment}{//   error\_message}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00764}00764             \textcolor{comment}{//    << "{}Very odd -\/-\/ we're looking for a point[ "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00765}00765             \textcolor{comment}{//    << x[0] << "{} "{} << x[1] << "{} "{} << x[2] << "{} ] that's not even}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00766}00766             \textcolor{comment}{//    \(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00767}00767             \textcolor{comment}{//    << "{}located within the bin boundaries.\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00768}00768             \textcolor{comment}{//   throw OomphLibError(error\_message.str(),}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00769}00769             \textcolor{comment}{//                       OOMPH\_CURRENT\_FUNCTION,}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00770}00770             \textcolor{comment}{//                       OOMPH\_EXCEPTION\_LOCATION);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00771}00771             \textcolor{comment}{//  \} // if (bin\_number<0)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00772}00772             \textcolor{comment}{// else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00773}00773             \textcolor{comment}{//  \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00774}00774             \textcolor{comment}{//   // Go for smallest target size of any element in this bin}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00775}00775             \textcolor{comment}{//   // to force "{}one level"{} of refinement (the one-\/level-\/ness}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00776}00776             \textcolor{comment}{//   // is enforced below by limiting the actual reduction in}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00777}00777             \textcolor{comment}{//   // size}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00778}00778             \textcolor{comment}{//   if (new\_transferred\_target\_size[e]!=0)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00779}00779             \textcolor{comment}{//    \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00780}00780             \textcolor{comment}{//      std::min(new\_transferred\_target\_size[e],}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00781}00781             \textcolor{comment}{//               bin\_min\_target\_size[bin\_number]);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00782}00782             \textcolor{comment}{//    \}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00783}00783             \textcolor{comment}{//   else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00784}00784             \textcolor{comment}{//    \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00785}00785             \textcolor{comment}{//     new\_transferred\_target\_size[e]=bin\_min\_target\_size[bin\_number];}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00786}00786             \textcolor{comment}{//    \}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00787}00787 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00788}00788             \textcolor{comment}{//  \}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00789}00789 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00790}00790 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00791}00791 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00792}00792           \} \textcolor{comment}{// for (ipt<nint)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00793}00793 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00794}00794         \} \textcolor{comment}{// for (e<nelem)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00795}00795 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00796}00796 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00797}00797         \textcolor{comment}{// do some output (keep it alive!)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00798}00798         \textcolor{keyword}{const} \textcolor{keywordtype}{bool} output\_target\_sizes = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00799}00799         \textcolor{keywordflow}{if} (output\_target\_sizes)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00800}00800         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00801}00801           \textcolor{keywordtype}{unsigned} length = new\_transferred\_target\_size.size();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00802}00802           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} u = 0; u < length; u++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00803}00803           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00804}00804             oomph\_info << \textcolor{stringliteral}{"{}Element"{}} << u}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00805}00805                        << \textcolor{stringliteral}{"{},target size: "{}} << new\_transferred\_target\_size[u]}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00806}00806                        << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00807}00807           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00808}00808         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00809}00809 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00810}00810         \textcolor{comment}{// Now copy into target size for temporary mesh but limit to}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00811}00811         \textcolor{comment}{// the equivalent of one sub-\/division per iteration}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00812}00812 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00813}00813         \textcolor{keywordtype}{unsigned} n\_ele\_need\_refinement\_iter = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00814}00814 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00815}00815 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00816}00816 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00817}00817         \textcolor{comment}{// Don't delete! Keep these around for debugging}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00818}00818         \textcolor{comment}{// ofstream tmp\_mesh\_file;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00819}00819         \textcolor{comment}{// tmp\_mesh\_file.open("{}tmp\_mesh\_file.dat"{});}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00820}00820         \textcolor{comment}{// tmp\_new\_mesh\_pt-\/>output(tmp\_mesh\_file);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00821}00821         \textcolor{comment}{// tmp\_mesh\_file.close();}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00822}00822 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00823}00823         std::ofstream target\_sizes\_file;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00824}00824         \textcolor{keywordtype}{char} filename[100];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00825}00825         sprintf(filename, \textcolor{stringliteral}{"{}target\_sizes\%i.dat"{}}, iter);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00826}00826         \textcolor{keywordflow}{if} (output\_target\_sizes)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00827}00827         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00828}00828           target\_sizes\_file.open(filename);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00829}00829         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00830}00830 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00831}00831         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} nel\_new = tmp\_new\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00832}00832         Vector<double> new\_target\_size(nel\_new);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00833}00833         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < nel\_new; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00834}00834         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00835}00835           \textcolor{comment}{// The finite element}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00836}00836           FiniteElement* f\_ele\_pt = tmp\_new\_mesh\_pt-\/>finite\_element\_pt(e);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00837}00837 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00838}00838           \textcolor{comment}{// Transferred target size}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00839}00839           \textcolor{keyword}{const} \textcolor{keywordtype}{double} new\_size = new\_transferred\_target\_size[e];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00840}00840           \textcolor{keywordflow}{if} (new\_size <= 0.0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00841}00841           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00842}00842             std::ostringstream error\_stream;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00843}00843             error\_stream}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00844}00844               << \textcolor{stringliteral}{"{}This shouldn't happen! Element whose centroid is at "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00845}00845               << (f\_ele\_pt-\/>node\_pt(0)-\/>x(0) + f\_ele\_pt-\/>node\_pt(1)-\/>x(0) +}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00846}00846                   f\_ele\_pt-\/>node\_pt(2)-\/>x(0) + f\_ele\_pt-\/>node\_pt(3)-\/>x(0)) /}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00847}00847                    4.0}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00848}00848               << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00849}00849               << (f\_ele\_pt-\/>node\_pt(0)-\/>x(1) + f\_ele\_pt-\/>node\_pt(1)-\/>x(1) +}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00850}00850                   f\_ele\_pt-\/>node\_pt(2)-\/>x(1) + f\_ele\_pt-\/>node\_pt(3)-\/>x(1)) /}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00851}00851                    4.0}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00852}00852               << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00853}00853               << (f\_ele\_pt-\/>node\_pt(0)-\/>x(2) + f\_ele\_pt-\/>node\_pt(1)-\/>x(2) +}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00854}00854                   f\_ele\_pt-\/>node\_pt(2)-\/>x(2) + f\_ele\_pt-\/>node\_pt(3)-\/>x(2)) /}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00855}00855                    4.0}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00856}00856               << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00857}00857               << \textcolor{stringliteral}{"{} has no target size assigned\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00858}00858             \textcolor{keywordflow}{throw} OomphLibError(error\_stream.str(),}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00859}00859                                 OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00860}00860                                 OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00861}00861           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00862}00862           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00863}00863           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00864}00864             \textcolor{comment}{// Limit target size to the equivalent of uniform refinement}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00865}00865             \textcolor{comment}{// during this stage of the iteration}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00866}00866             new\_target\_size[e] = new\_size;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00867}00867             \textcolor{keywordflow}{if} (new\_target\_size[e] < f\_ele\_pt-\/>size() / 4.0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00868}00868             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00869}00869               new\_target\_size[e] = f\_ele\_pt-\/>size() / 4.0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00870}00870 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00871}00871               \textcolor{comment}{// ALH: It seems that tetgen "{}enlarges"{} the volume constraint}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00872}00872               \textcolor{comment}{// so this criterion can never be met unless dividing by 1.2}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00873}00873               \textcolor{comment}{// as well. MH: Is this the reason why Andrew's version of}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00874}00874               \textcolor{comment}{// adaptation never converges? Took it out.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00875}00875               \textcolor{comment}{// new\_target\_size[e] /= 1.2;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00876}00876 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00877}00877               \textcolor{comment}{// We'll need to give it another go later}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00878}00878               done = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00879}00879             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00880}00880 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00881}00881             \textcolor{comment}{// Don't delete! Keep around for debugging}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00882}00882             \textcolor{keywordflow}{if} (output\_target\_sizes)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00883}00883             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00884}00884               target\_sizes\_file << \textcolor{stringliteral}{"{}ZONE N=4, E=1, F=FEPOINT, ET=TETRAHEDRON\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00885}00885               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < 4; j++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00886}00886               \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00887}00887                 target\_sizes\_file << f\_ele\_pt-\/>node\_pt(j)-\/>x(0) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00888}00888                                   << f\_ele\_pt-\/>node\_pt(j)-\/>x(1) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00889}00889                                   << f\_ele\_pt-\/>node\_pt(j)-\/>x(2) << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00890}00890                                   << new\_size << \textcolor{stringliteral}{"{} "{}} << new\_target\_size[e]}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00891}00891                                   << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00892}00892               \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00893}00893               target\_sizes\_file << \textcolor{stringliteral}{"{}1 2 3 4\(\backslash\)n"{}}; \textcolor{comment}{// connectivity}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00894}00894 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00895}00895               \textcolor{comment}{// Keep around; just doc at centroid}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00896}00896               \textcolor{comment}{/* target\_sizes\_file  */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00897}00897               \textcolor{comment}{/*  <<  (f\_ele\_pt-\/>node\_pt(0)-\/>x(0)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00898}00898               \textcolor{comment}{/*       f\_ele\_pt-\/>node\_pt(1)-\/>x(0)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00899}00899               \textcolor{comment}{/*       f\_ele\_pt-\/>node\_pt(2)-\/>x(0)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00900}00900               \textcolor{comment}{/*       f\_ele\_pt-\/>node\_pt(3)-\/>x(0))/4.0 << "{} "{} */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00901}00901               \textcolor{comment}{/*  << (f\_ele\_pt-\/>node\_pt(0)-\/>x(1)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00902}00902               \textcolor{comment}{/*      f\_ele\_pt-\/>node\_pt(1)-\/>x(1)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00903}00903               \textcolor{comment}{/*      f\_ele\_pt-\/>node\_pt(2)-\/>x(1)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00904}00904               \textcolor{comment}{/*      f\_ele\_pt-\/>node\_pt(3)-\/>x(1))/4.0 << "{} "{} */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00905}00905               \textcolor{comment}{/*  << (f\_ele\_pt-\/>node\_pt(0)-\/>x(2)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00906}00906               \textcolor{comment}{/*      f\_ele\_pt-\/>node\_pt(1)-\/>x(2)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00907}00907               \textcolor{comment}{/*      f\_ele\_pt-\/>node\_pt(2)-\/>x(2)+ */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00908}00908               \textcolor{comment}{/*      f\_ele\_pt-\/>node\_pt(3)-\/>x(2))/4.0 << "{} "{} */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00909}00909               \textcolor{comment}{/*  << new\_size << "{} "{}  */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00910}00910               \textcolor{comment}{/*  << new\_target\_size[e] << std::endl; */}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00911}00911             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00912}00912 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00913}00913 \textcolor{preprocessor}{\#ifdef OOMPH\_HAS\_MPI}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00914}00914             \textcolor{comment}{// Keep track of the elements that require (un)refinement}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00915}00915             n\_ele\_need\_refinement\_iter++;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00916}00916 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00917}00917 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00918}00918           \} \textcolor{comment}{// else if (new\_size <= 0.0)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00919}00919 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00920}00920         \} \textcolor{comment}{// for (e < nel\_new)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00921}00921 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00922}00922         \textcolor{comment}{// Don't delete! Keep around for debugging}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00923}00923         \textcolor{keywordflow}{if} (output\_target\_sizes)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00924}00924         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00925}00925           target\_sizes\_file.close();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00926}00926         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00927}00927 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00928}00928         \textcolor{keywordflow}{if} (done)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00929}00929         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00930}00930           oomph\_info}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00931}00931             << \textcolor{stringliteral}{"{}All size adjustments accommodated by max. permitted size"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00932}00932             << \textcolor{stringliteral}{"{} reduction during iter "{}} << iter << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00933}00933         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00934}00934         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00935}00935         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00936}00936           oomph\_info << \textcolor{stringliteral}{"{}NOT all size adjustments accommodated by max. "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00937}00937                      << \textcolor{stringliteral}{"{}permitted size reduction  during iter "{}} << iter}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00938}00938                      << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00939}00939         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00940}00940 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00941}00941 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00942}00942         oomph\_info}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00943}00943           << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n\(\backslash\)n==================================================\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00944}00944           << \textcolor{stringliteral}{"{}==================================================\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00945}00945           << \textcolor{stringliteral}{"{}==================================================\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00946}00946           << \textcolor{stringliteral}{"{}==================================================\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00947}00947           << \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00948}00948 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00949}00949         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00950}00950         oomph\_info}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00951}00951           << \textcolor{stringliteral}{"{}adapt: Time for new\_target\_size[.]                      : "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00952}00952           << TimingHelpers::timer() -\/ t\_start << \textcolor{stringliteral}{"{} sec "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00953}00953         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00954}00954 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00955}00955 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00956}00956         \textcolor{comment}{// Now create the new mesh from TriangulateIO structure}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00957}00957         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00958}00958         \textcolor{comment}{// associated with uniform background mesh and the}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00959}00959         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00960}00960         \textcolor{comment}{// associated target element sizes.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00961}00961         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00962}00962 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00963}00963         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00964}00964         t\_start = TimingHelpers::timer();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00965}00965         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00966}00966 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00967}00967         \textcolor{comment}{// Solid mesh?}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00968}00968         \textcolor{keywordflow}{if} (solid\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00969}00969         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00970}00970           \textcolor{comment}{/*std::ostringstream error\_message;}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00971}00971 \textcolor{comment}{          error\_message}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00972}00972 \textcolor{comment}{           << "{}RefineableSolidTetgenMesh not implemented yet.\(\backslash\)n"{};}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00973}00973 \textcolor{comment}{          throw OomphLibError(error\_message.str(),}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00974}00974 \textcolor{comment}{                              OOMPH\_CURRENT\_FUNCTION,}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00975}00975 \textcolor{comment}{                              OOMPH\_EXCEPTION\_LOCATION);*/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00976}00976           new\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00977}00977             \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1RefineableSolidTetgenMesh}{RefineableSolidTetgenMesh<ELEMENT>}}(new\_target\_size,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00978}00978                                                    tmp\_new\_tetgenio\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00979}00979                                                    this-\/>Outer\_boundary\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00980}00980                                                    this-\/>Internal\_surface\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00981}00981                                                    this-\/>Time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00982}00982                                                    this-\/>Use\_attributes);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00983}00983         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00984}00984         \textcolor{comment}{// No solid mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00985}00985         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00986}00986         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00987}00987           new\_mesh\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00988}00988             \textcolor{keyword}{new} \mbox{\hyperlink{classoomph_1_1RefineableTetgenMesh}{RefineableTetgenMesh<ELEMENT>}}(new\_target\_size,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00989}00989                                               tmp\_new\_tetgenio\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00990}00990                                               this-\/>Outer\_boundary\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00991}00991                                               this-\/>Internal\_surface\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00992}00992                                               this-\/>Time\_stepper\_pt,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00993}00993                                               this-\/>Use\_attributes);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00994}00994         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00995}00995 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00996}00996         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00997}00997         oomph\_info}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00998}00998           << \textcolor{stringliteral}{"{}adapt: Time for new\_mesh\_pt                            : "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l00999}00999           << TimingHelpers::timer() -\/ t\_start << \textcolor{stringliteral}{"{} sec "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01000}01000         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01001}01001 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01002}01002 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01003}01003         \textcolor{comment}{// Not done: get ready for another iteration}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01004}01004         iter++;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01005}01005 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01006}01006 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01007}01007         \textcolor{comment}{// Check if the new mesh actually differs from the old one}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01008}01008         \textcolor{comment}{// If not, we're done.}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01009}01009         \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01010}01010         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01011}01011           \textcolor{keywordtype}{unsigned} nnod = tmp\_new\_mesh\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01012}01012           \textcolor{keywordflow}{if} (nnod == new\_mesh\_pt-\/>nnode())}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01013}01013           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01014}01014             \textcolor{keywordtype}{unsigned} nel = tmp\_new\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01015}01015             \textcolor{keywordflow}{if} (nel == new\_mesh\_pt-\/>nelement())}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01016}01016             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01017}01017               \textcolor{keywordtype}{bool} nodes\_identical = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01018}01018               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01019}01019               \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01020}01020                 \textcolor{keywordtype}{bool} coords\_identical = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01021}01021                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < 3; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01022}01022                 \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01023}01023                   \textcolor{keywordflow}{if} (new\_mesh\_pt-\/>node\_pt(j)-\/>x(i) !=}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01024}01024                       tmp\_new\_mesh\_pt-\/>node\_pt(j)-\/>x(i))}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01025}01025                   \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01026}01026                     coords\_identical = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01027}01027                   \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01028}01028                 \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01029}01029                 \textcolor{keywordflow}{if} (!coords\_identical)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01030}01030                 \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01031}01031                   nodes\_identical = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01032}01032                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01033}01033                 \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01034}01034               \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01035}01035               \textcolor{keywordflow}{if} (nodes\_identical)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01036}01036               \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01037}01037                 done = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01038}01038               \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01039}01039             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01040}01040           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01041}01041         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01042}01042 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01043}01043         \textcolor{comment}{// Delete the temporary mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01044}01044         \textcolor{keyword}{delete} tmp\_new\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01045}01045 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01046}01046         \textcolor{comment}{// Now transfer over the pointers}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01047}01047         \textcolor{keywordflow}{if} (!done)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01048}01048         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01049}01049           tmp\_new\_mesh\_pt = new\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01050}01050           tmp\_new\_tetgenio\_pt = new\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetgenMesh_a4f80936c6c66947f304286605b2046ba}{tetgenio\_pt}}();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01051}01051         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01052}01052 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01053}01053       \} \textcolor{comment}{// end of iteration}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01054}01054 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01055}01055       \textcolor{comment}{// Move the nodes on the new boundary onto the}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01056}01056       \textcolor{comment}{// old curvilinear boundary}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01057}01057       \textcolor{comment}{// If the boundary is straight this will do precisely nothing}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01058}01058       \textcolor{comment}{// but will be somewhat inefficient}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01059}01059       \textcolor{comment}{/*\{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01060}01060 \textcolor{comment}{       const unsigned n\_boundary = this-\/>nboundary();}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01061}01061 \textcolor{comment}{       for(unsigned b=0;b<n\_boundary;b++)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01062}01062 \textcolor{comment}{        \{}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01063}01063 \textcolor{comment}{         this-\/>snap\_nodes\_onto\_boundary(new\_mesh\_pt,b);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01064}01064 \textcolor{comment}{        \}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01065}01065 \textcolor{comment}{        \}*/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01066}01066 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01067}01067 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01068}01068       \textcolor{comment}{// Check that the projection step is not disabled}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01069}01069       \textcolor{keywordflow}{if} (!Projection\_is\_disabled)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01070}01070       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01071}01071         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01072}01072         t\_start = TimingHelpers::timer();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01073}01073         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01074}01074 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01075}01075         \textcolor{comment}{// Project current solution onto new mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01076}01076         \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01077}01077         ProjectionProblem<ELEMENT>* project\_problem\_pt =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01078}01078           \textcolor{keyword}{new} ProjectionProblem<ELEMENT>;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01079}01079         project\_problem\_pt-\/>mesh\_pt() = new\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01080}01080         project\_problem\_pt-\/>project(\textcolor{keyword}{this});}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01081}01081         \textcolor{keyword}{delete} project\_problem\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01082}01082 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01083}01083         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01084}01084         oomph\_info}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01085}01085           << \textcolor{stringliteral}{"{}adapt: Time for project soln onto new mesh                : "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01086}01086           << TimingHelpers::timer() -\/ t\_start << \textcolor{stringliteral}{"{} sec "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01087}01087         \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01088}01088       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01089}01089 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01090}01090       \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01091}01091       t\_start = TimingHelpers::timer();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01092}01092       \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01093}01093 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01094}01094       \textcolor{comment}{// this-\/>output("{}pre\_proj"{},5);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01095}01095       \textcolor{comment}{// new\_mesh\_pt-\/>output("{}post\_proj.dat"{},5);}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01096}01096 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01097}01097       \textcolor{comment}{// Flush the old mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01098}01098       \textcolor{keywordtype}{unsigned} nnod = nnode();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01099}01099       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = nnod; j > 0; j-\/-\/)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01100}01100       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01101}01101         \textcolor{keyword}{delete} Node\_pt[j -\/ 1];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01102}01102         Node\_pt[j -\/ 1] = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01103}01103       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01104}01104       \textcolor{keywordtype}{unsigned} nel = nelement();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01105}01105       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = nel; e > 0; e-\/-\/)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01106}01106       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01107}01107         \textcolor{keyword}{delete} Element\_pt[e -\/ 1];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01108}01108         Element\_pt[e -\/ 1] = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01109}01109       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01110}01110 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01111}01111       \textcolor{comment}{// Now copy back to current mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01112}01112       \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01113}01113       nnod = new\_mesh\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01114}01114       Node\_pt.resize(nnod);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01115}01115       nel = new\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01116}01116       Element\_pt.resize(nel);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01117}01117       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01118}01118       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01119}01119         Node\_pt[j] = new\_mesh\_pt-\/>node\_pt(j);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01120}01120       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01121}01121       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < nel; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01122}01122       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01123}01123         Element\_pt[e] = new\_mesh\_pt-\/>element\_pt(e);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01124}01124       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01125}01125 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01126}01126       \textcolor{comment}{// Copy the boundary schemes}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01127}01127       \textcolor{keywordtype}{unsigned} nbound = new\_mesh\_pt-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01128}01128       Boundary\_element\_pt.resize(nbound);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01129}01129       Face\_index\_at\_boundary.resize(nbound);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01130}01130       Boundary\_node\_pt.resize(nbound);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01131}01131       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < nbound; b++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01132}01132       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01133}01133         \textcolor{keywordtype}{unsigned} nel = new\_mesh\_pt-\/>nboundary\_element(b);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01134}01134         Boundary\_element\_pt[b].resize(nel);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01135}01135         Face\_index\_at\_boundary[b].resize(nel);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01136}01136         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < nel; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01137}01137         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01138}01138           Boundary\_element\_pt[b][e] = new\_mesh\_pt-\/>boundary\_element\_pt(b, e);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01139}01139           Face\_index\_at\_boundary[b][e] =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01140}01140             new\_mesh\_pt-\/>face\_index\_at\_boundary(b, e);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01141}01141         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01142}01142         \textcolor{keywordtype}{unsigned} nnod = new\_mesh\_pt-\/>nboundary\_node(b);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01143}01143         Boundary\_node\_pt[b].resize(nnod);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01144}01144         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} j = 0; j < nnod; j++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01145}01145         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01146}01146           Boundary\_node\_pt[b][j] = new\_mesh\_pt-\/>boundary\_node\_pt(b, j);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01147}01147         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01148}01148       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01149}01149 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01150}01150       \textcolor{comment}{// Also copy over the new boundary and region information}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01151}01151       \textcolor{keywordtype}{unsigned} n\_region = new\_mesh\_pt-\/>nregion();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01152}01152 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01153}01153       \textcolor{comment}{// Only bother if we have regions}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01154}01154       \textcolor{keywordflow}{if} (n\_region > 1)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01155}01155       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01156}01156         \textcolor{comment}{// Deal with the region information first}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01157}01157         this-\/>Region\_element\_pt.resize(n\_region);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01158}01158         this-\/>Region\_attribute.resize(n\_region);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01159}01159         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_region; i++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01160}01160         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01161}01161           \textcolor{comment}{// Copy across region attributes (region ids!)}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01162}01162           this-\/>Region\_attribute[i] = new\_mesh\_pt-\/>region\_attribute(i);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01163}01163 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01164}01164           \textcolor{comment}{// Find the number of elements in the region}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01165}01165           \textcolor{keywordtype}{unsigned} r = this-\/>Region\_attribute[i];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01166}01166           \textcolor{keywordtype}{unsigned} n\_region\_element = new\_mesh\_pt-\/>nregion\_element(r);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01167}01167           this-\/>Region\_element\_pt[i].resize(n\_region\_element);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01168}01168           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_region\_element; e++)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01169}01169           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01170}01170             this-\/>Region\_element\_pt[i][e] =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01171}01171               new\_mesh\_pt-\/>region\_element\_pt(r, e);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01172}01172           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01173}01173         \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01174}01174 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01175}01175         \textcolor{comment}{// Now the boundary region information}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01176}01176         this-\/>Boundary\_region\_element\_pt.resize(nbound);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01177}01177         this-\/>Face\_index\_region\_at\_boundary.resize(nbound);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01178}01178 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01179}01179         \textcolor{comment}{// Now loop over the boundaries}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01180}01180         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < nbound; ++b)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01181}01181         \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01182}01182           \textcolor{comment}{// Loop over the regions}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01183}01183           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_region; ++i)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01184}01184           \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01185}01185             \textcolor{keywordtype}{unsigned} r = this-\/>Region\_attribute[i];}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01186}01186 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01187}01187             \textcolor{keywordtype}{unsigned} n\_boundary\_el\_in\_region =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01188}01188               new\_mesh\_pt-\/>nboundary\_element\_in\_region(b, r);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01189}01189             \textcolor{keywordflow}{if} (n\_boundary\_el\_in\_region > 0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01190}01190             \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01191}01191               \textcolor{comment}{// Allocate storage in the map}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01192}01192               this-\/>Boundary\_region\_element\_pt[b][r].resize(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01193}01193                 n\_boundary\_el\_in\_region);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01194}01194               this-\/>Face\_index\_region\_at\_boundary[b][r].resize(}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01195}01195                 n\_boundary\_el\_in\_region);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01196}01196 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01197}01197               \textcolor{comment}{// Copy over the information}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01198}01198               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_boundary\_el\_in\_region; ++e)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01199}01199               \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01200}01200                 this-\/>Boundary\_region\_element\_pt[b][r][e] =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01201}01201                   new\_mesh\_pt-\/>boundary\_element\_in\_region\_pt(b, r, e);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01202}01202                 this-\/>Face\_index\_region\_at\_boundary[b][r][e] =}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01203}01203                   new\_mesh\_pt-\/>face\_index\_at\_boundary\_in\_region(b, r, e);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01204}01204               \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01205}01205             \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01206}01206           \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01207}01207         \} \textcolor{comment}{// End of loop over boundaries}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01208}01208 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01209}01209       \} \textcolor{comment}{// End of case when more than one region}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01210}01210 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01211}01211       \textcolor{comment}{// Copy TriangulateIO representation}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01212}01212       this-\/>set\_deep\_copy\_tetgenio\_pt(new\_mesh\_pt-\/>\mbox{\hyperlink{classoomph_1_1TetgenMesh_a4f80936c6c66947f304286605b2046ba}{tetgenio\_pt}}());}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01213}01213 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01214}01214       \textcolor{comment}{// Flush the mesh}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01215}01215       new\_mesh\_pt-\/>flush\_element\_and\_node\_storage();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01216}01216 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01217}01217       \textcolor{comment}{// Delete the mesh and the problem}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01218}01218       \textcolor{keyword}{delete} new\_mesh\_pt;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01219}01219 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01220}01220 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01221}01221       \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01222}01222       oomph\_info}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01223}01223         << \textcolor{stringliteral}{"{}adapt: Time for moving nodes etc. to actual mesh          : "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01224}01224         << TimingHelpers::timer() -\/ t\_start << \textcolor{stringliteral}{"{} sec "{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01225}01225       \textcolor{comment}{//\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01226}01226 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01227}01227       \textcolor{comment}{// Solid mesh?}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01228}01228       \textcolor{keywordflow}{if} (solid\_mesh\_pt != 0)}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01229}01229       \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01230}01230         \textcolor{comment}{// Warning}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01231}01231         std::stringstream error\_message;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01232}01232         error\_message}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01233}01233           << \textcolor{stringliteral}{"{}Lagrangian coordinates are currently not projected but are\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01234}01234           << \textcolor{stringliteral}{"{}are re-\/set during adaptation. This is not appropriate for\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01235}01235           << \textcolor{stringliteral}{"{}real solid mechanics problems!\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01236}01236         OomphLibWarning(error\_message.str(),}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01237}01237                         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01238}01238                         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01239}01239 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01240}01240         \textcolor{comment}{// Reset Lagrangian coordinates}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01241}01241         \textcolor{keyword}{dynamic\_cast<}SolidMesh*\textcolor{keyword}{>}(\textcolor{keyword}{this})-\/>set\_lagrangian\_nodal\_coordinates();}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01242}01242       \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01243}01243 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01244}01244       \textcolor{keywordtype}{double} max\_area;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01245}01245       \textcolor{keywordtype}{double} min\_area;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01246}01246       this-\/>max\_and\_min\_element\_size(max\_area, min\_area);}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01247}01247       oomph\_info << \textcolor{stringliteral}{"{}Max/min element size in adapted mesh: "{}} << max\_area << \textcolor{stringliteral}{"{} "{}}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01248}01248                  << min\_area << std::endl;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01249}01249     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01250}01250     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01251}01251     \{}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01252}01252       oomph\_info << \textcolor{stringliteral}{"{}Not enough benefit in adaptation.\(\backslash\)n"{}};}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01253}01253       Nrefined = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01254}01254       Nunrefined = 0;}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01255}01255     \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01256}01256   \}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01257}01257 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01258}01258 \} \textcolor{comment}{// namespace oomph}}
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01259}01259 }
\DoxyCodeLine{\Hypertarget{refineable__tetgen__mesh_8template_8cc_source_l01260}01260 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}

\hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source}{}\doxysection{extruded\+\_\+cube\+\_\+mesh\+\_\+from\+\_\+quad\+\_\+mesh\+\_\+with\+\_\+macro\+\_\+elements.\+template.\+cc}
\label{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source}\index{extruded\_cube\_mesh\_from\_quad\_mesh\_with\_macro\_elements.template.cc@{extruded\_cube\_mesh\_from\_quad\_mesh\_with\_macro\_elements.template.cc}}
\mbox{\hyperlink{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00001}00001 \textcolor{comment}{// LIC// ====================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00002}00002 \textcolor{comment}{// LIC// This file forms part of oomph-\/lib, the object-\/oriented,}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00003}00003 \textcolor{comment}{// LIC// multi-\/physics finite-\/element library, available}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00004}00004 \textcolor{comment}{// LIC// at http://www.oomph-\/lib.org.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00005}00005 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00006}00006 \textcolor{comment}{// LIC// Copyright (C) 2006-\/2022 Matthias Heil and Andrew Hazel}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00007}00007 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00008}00008 \textcolor{comment}{// LIC// This library is free software; you can redistribute it and/or}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00009}00009 \textcolor{comment}{// LIC// modify it under the terms of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00010}00010 \textcolor{comment}{// LIC// License as published by the Free Software Foundation; either}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00011}00011 \textcolor{comment}{// LIC// version 2.1 of the License, or (at your option) any later version.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00012}00012 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00013}00013 \textcolor{comment}{// LIC// This library is distributed in the hope that it will be useful,}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00014}00014 \textcolor{comment}{// LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00015}00015 \textcolor{comment}{// LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00016}00016 \textcolor{comment}{// LIC// Lesser General Public License for more details.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00017}00017 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00018}00018 \textcolor{comment}{// LIC// You should have received a copy of the GNU Lesser General Public}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00019}00019 \textcolor{comment}{// LIC// License along with this library; if not, write to the Free Software}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00020}00020 \textcolor{comment}{// LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00021}00021 \textcolor{comment}{// LIC// 02110-\/1301  USA.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00022}00022 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00023}00023 \textcolor{comment}{// LIC// The authors may be contacted at oomph-\/lib@maths.man.ac.uk.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00024}00024 \textcolor{comment}{// LIC//}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00025}00025 \textcolor{comment}{// LIC//====================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00026}00026 \textcolor{comment}{// Oomph-\/lib headers}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00027}00027 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8h}{extruded\_cube\_mesh\_from\_quad\_mesh\_with\_macro\_elements.template.h}}"{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00028}00028 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00029}00029 \textcolor{comment}{/// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00030}00030 \textcolor{comment}{/// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00031}00031 \textcolor{comment}{/// //////////////////////////////////////////////////////////////////////}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00032}00032 \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00033}00033 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceoomph}{oomph}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00034}00034 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00035}00035   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00036}00036 \textcolor{comment}{  /// Get all the boundary information of an element using the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00037}00037 \textcolor{comment}{  /// input (quad\_mesh\_pt) mesh. If the element lies on a boundary then}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00038}00038 \textcolor{comment}{  /// the user will be given the corresponding boundary index and the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00039}00039 \textcolor{comment}{  /// index of the face of quad\_el\_pt attached to the boundary. If the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00040}00040 \textcolor{comment}{  /// element does NOT lie on any boundaries, this function simply}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00041}00041 \textcolor{comment}{  /// returns a vector of size zero.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00042}00042 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00043}00043   \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00044}00044   Vector<std::pair<unsigned, int>> ExtrudedCubeMeshFromQuadMesh<}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00045}\mbox{\hyperlink{classoomph_1_1ExtrudedCubeMeshFromQuadMesh_a5b7cfb164e04a5cdd40977daa3c1373e}{00045}}     ELEMENT>::get\_element\_boundary\_information(QuadMeshBase* quad\_mesh\_pt,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00046}00046                                                FiniteElement* quad\_el\_pt)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00047}00047   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00048}00048     \textcolor{comment}{// Allocate space for the boundary info (initialised to empty)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00049}00049     Vector<std::pair<unsigned, int>> boundary\_info;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00051}00051     \textcolor{comment}{// Find the number of boundaries in the input mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00052}00052     \textcolor{keywordtype}{unsigned} n\_boundary = quad\_mesh\_pt-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00054}00054     \textcolor{comment}{// Loop over the boundaries of the mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00055}00055     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < n\_boundary; b++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00056}00056     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00057}00057       \textcolor{comment}{// How many elements are there on the b-\/th boundary?}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00058}00058       \textcolor{keywordtype}{unsigned} n\_boundary\_element = quad\_mesh\_pt-\/>nboundary\_element(b);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00060}00060       \textcolor{comment}{// Loop over the elements on the b-\/th boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00061}00061       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_boundary\_element; e++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00062}00062       \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00063}00063         \textcolor{comment}{// Is the e-\/th element on the b-\/th boundary the input element?}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00064}00064         \textcolor{keywordflow}{if} (quad\_el\_pt == quad\_mesh\_pt-\/>boundary\_element\_pt(b, e))}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00065}00065         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00066}00066           \textcolor{comment}{// Create a pair to hold the boundary index and element face index}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00067}00067           std::pair<unsigned, int> boundary\_and\_face\_index;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00069}00069           \textcolor{comment}{// Set the first entry (boundary index)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00070}00070           boundary\_and\_face\_index.first = b;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00072}00072           \textcolor{comment}{// Set the second entry (face index)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00073}00073           boundary\_and\_face\_index.second =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00074}00074             quad\_mesh\_pt-\/>face\_index\_at\_boundary(b, e);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00076}00076           \textcolor{comment}{// Add the boundary index to the boundary\_info vector}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00077}00077           boundary\_info.push\_back(boundary\_and\_face\_index);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00078}00078         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00079}00079       \} \textcolor{comment}{// for (unsigned e=0;e<n\_boundary\_element;e++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00080}00080     \} \textcolor{comment}{// for (unsigned b=0;b<n\_boundary;b++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00081}00081 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00082}00082     \textcolor{comment}{// Return the result}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00083}00083     \textcolor{keywordflow}{return} boundary\_info;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00084}00084   \} \textcolor{comment}{// End of get\_element\_boundary\_information}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00085}00085 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00086}00086   \textcolor{comment}{//========================================================================}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00087}00087 \textcolor{comment}{  /// Generic mesh construction. This function contains all the details of}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00088}00088 \textcolor{comment}{  /// the mesh generation process, including all the tedious loops, counting}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00089}00089 \textcolor{comment}{  /// spacing and boundary functions.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00090}00090 \textcolor{comment}{  /// NOTE: The boundary number of the extruded mesh will follow the same}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00091}00091 \textcolor{comment}{  /// numbering as the input quad mesh. The newly created "{}front"{} and "{}back"{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00092}00092 \textcolor{comment}{  /// face of the 3D mesh will added after those boundaries. For example,}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00093}00093 \textcolor{comment}{  /// if the input mesh has 4 boundaries; b\_0, b\_1, b\_2 \& b\_3 then the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00094}00094 \textcolor{comment}{  /// extruded mesh will have 6 boundaries; eb\_0, eb\_1, eb\_2, eb\_3, eb\_4 \&}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00095}00095 \textcolor{comment}{  /// eb\_5 where eb\_4 is the "{}front"{} face and eb5 is the "{}back"{} face. The}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00096}00096 \textcolor{comment}{  /// boundaries eb\_i here satisfy eb\_i = (b\_i) x [Zmin,Zmax].}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00097}00097 \textcolor{comment}{}  \textcolor{comment}{//========================================================================}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00098}00098   \textcolor{keyword}{template}<\textcolor{keyword}{class} ELEMENT>}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00099}\mbox{\hyperlink{classoomph_1_1ExtrudedCubeMeshFromQuadMesh_a0bd947d799c3bb05fb166ab92f6d4ae1}{00099}}   \textcolor{keywordtype}{void} \mbox{\hyperlink{classoomph_1_1ExtrudedCubeMeshFromQuadMesh_a0bd947d799c3bb05fb166ab92f6d4ae1}{ExtrudedCubeMeshFromQuadMesh<ELEMENT>::build\_mesh}}(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00100}00100     QuadMeshBase* quad\_mesh\_pt, TimeStepper* time\_stepper\_pt)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00101}00101   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00102}00102     \textcolor{comment}{// Mesh can only be built with 3D Qelements.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00103}00103     MeshChecker::assert\_geometric\_element<QElementGeometricBase, ELEMENT>(3);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00105}00105     \textcolor{comment}{// Need at least 2 elements in the z-\/direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00106}00106     \textcolor{keywordflow}{if} (Nz == 0)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00107}00107     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00108}00108       \textcolor{comment}{// Create an ostringstream object to create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00109}00109       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00110}00110 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00111}00111       \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00112}00112       error\_message << \textcolor{stringliteral}{"{}Extrude2DQuadMeshTo3DCubeMesh needs at least two "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00113}00113                     << \textcolor{stringliteral}{"{}elements in each,\(\backslash\)ncoordinate direction. You have "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00114}00114                     << \textcolor{stringliteral}{"{}specified Nz="{}} << Nz << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00116}00116       \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00117}00117       \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00118}00118         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00119}00119     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00120}00120 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00121}00121     \textcolor{comment}{// Get the current (i.e. start) time}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00122}00122     \textcolor{keywordtype}{double} t\_mesh\_setup\_start = TimingHelpers::timer();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00123}00123 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00124}00124     \textcolor{comment}{// Get the current (i.e. start) time}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00125}00125     \textcolor{keywordtype}{double} t\_mesh\_construct\_start = TimingHelpers::timer();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00127}00127     \textcolor{comment}{// Get the number of boundaries in the input mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00128}00128     \textcolor{keywordtype}{unsigned} n\_boundary\_in\_quad\_mesh = quad\_mesh\_pt-\/>nboundary();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00130}00130     \textcolor{comment}{// The number of boundaries in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00131}00131     \textcolor{keywordtype}{unsigned} n\_boundary\_in\_extruded\_mesh = n\_boundary\_in\_quad\_mesh + 2;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00132}00132 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00133}00133     \textcolor{comment}{// Set the number of boundaries in the extruded mesh (just need}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00134}00134     \textcolor{comment}{// to add the front and back face to the number of boundaries)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00135}00135     set\_nboundary(n\_boundary\_in\_extruded\_mesh);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00137}00137     \textcolor{comment}{// Get the number of elements in the input mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00138}00138     \textcolor{keywordtype}{unsigned} n\_element\_in\_quad\_mesh = quad\_mesh\_pt-\/>nelement();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00140}00140     \textcolor{comment}{// Allocate storage for the boundary information of each quad element.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00141}00141     \textcolor{comment}{// Takes up more memory but avoids recomputing it many, many times}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00142}00142     Vector<Vector<std::pair<unsigned, int>>> boundary\_information(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00143}00143       n\_element\_in\_quad\_mesh);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00145}00145     \textcolor{comment}{// Loop over all the elements in the quad mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00146}00146     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_element\_in\_quad\_mesh; e++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00147}00147     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00148}00148       \textcolor{comment}{// Get a pointer to the j-\/th element in the mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00149}00149       FiniteElement* quad\_el\_pt = quad\_mesh\_pt-\/>finite\_element\_pt(e);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00151}00151       \textcolor{comment}{// Get the boundary information}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00152}00152       boundary\_information[e] =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00153}00153         get\_element\_boundary\_information(quad\_mesh\_pt, quad\_el\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00154}00154     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00156}00156     \textcolor{comment}{// Allocate storage for the number of elements in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00157}00157     Element\_pt.resize(n\_element\_in\_quad\_mesh * Nz);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00158}00158 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00159}00159     \textcolor{comment}{// Create the first element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00160}00160     ELEMENT* temp\_el\_pt = \textcolor{keyword}{new} ELEMENT;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00162}00162     \textcolor{comment}{// Read out the number of linear points in the element (in one direction)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00163}00163     \textcolor{keywordtype}{unsigned} n\_node\_1d = temp\_el\_pt-\/>nnode\_1d();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00164}00164 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00165}00165     \textcolor{comment}{// Store the variable n\_node\_1d as the private variable, Np}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00166}00166     N\_node\_1d = n\_node\_1d;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00167}00167 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00168}00168     \textcolor{comment}{// Delete the element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00169}00169     \textcolor{keyword}{delete} temp\_el\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00170}00170 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00171}00171     \textcolor{comment}{// Make it a null pointer}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00172}00172     temp\_el\_pt = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00174}00174     \textcolor{comment}{// Need the same number of nodes in one direction in the 2D and 3D element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00175}00175     \textcolor{keywordflow}{if} ((n\_node\_1d != quad\_mesh\_pt-\/>finite\_element\_pt(0)-\/>nnode\_1d()) ||}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00176}00176         (n\_node\_1d * n\_node\_1d != quad\_mesh\_pt-\/>finite\_element\_pt(0)-\/>nnode()))}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00177}00177     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00178}00178       \textcolor{comment}{// Create an ostringstream object to create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00179}00179       std::ostringstream error\_message;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00180}00180 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00181}00181       \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00182}00182       error\_message}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00183}00183         << \textcolor{stringliteral}{"{}Extrude2DQuadMeshTo3DCubeMesh needs the number of "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00184}00184         << \textcolor{stringliteral}{"{}nodes (in the 2D element) in one direction\(\backslash\)n to match "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00185}00185         << \textcolor{stringliteral}{"{}the number of nodes in one direction in the 3D element!"{}};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00187}00187       \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00188}00188       \textcolor{keywordflow}{throw} OomphLibError(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00189}00189         error\_message.str(), OOMPH\_CURRENT\_FUNCTION, OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00190}00190     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00191}00191 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00192}00192     \textcolor{comment}{// Get the total number of nodes in the input mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00193}00193     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node\_in\_quad\_mesh = quad\_mesh\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00194}00194 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00195}00195     \textcolor{comment}{// Loop over the nodes in the spatial mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00196}00196     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_node\_in\_quad\_mesh; i++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00197}00197     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00198}00198       \textcolor{comment}{// Check to see if the i-\/th node is hanging}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00199}00199       \textcolor{keywordflow}{if} (quad\_mesh\_pt-\/>node\_pt(i)-\/>is\_hanging())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00200}00200       \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00201}00201         \textcolor{comment}{// Create an output stream}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00202}00202         std::ostringstream warning\_message\_stream;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00204}00204         \textcolor{comment}{// Create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00205}00205         warning\_message\_stream << \textcolor{stringliteral}{"{}Extrusion machinery is not currently able "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00206}00206                                << \textcolor{stringliteral}{"{}to deal with hanging nodes!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00208}00208         \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00209}00209         \textcolor{keywordflow}{throw} OomphLibError(warning\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00210}00210                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00211}00211                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00212}00212       \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00213}00213     \} \textcolor{comment}{// for (unsigned i=0;i<n\_node\_in\_quad\_mesh;i++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00214}00214 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00215}00215     \textcolor{comment}{// Number of nodes in the z-\/direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00216}00216     \textcolor{keywordtype}{unsigned} n\_node\_in\_z\_direction = (1 + (n\_node\_1d -\/ 1) * Nz);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00217}00217 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00218}00218     \textcolor{comment}{// Get the total number of nodes in the input mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00219}00219     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} n\_node\_in\_cube\_mesh =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00220}00220       n\_node\_in\_quad\_mesh * n\_node\_in\_z\_direction;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00221}00221 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00222}00222     \textcolor{comment}{// Allocate storage for the number of nodes in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00223}00223     Node\_pt.resize(n\_node\_in\_cube\_mesh);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00225}00225     \textcolor{comment}{// Counter for the number of nodes in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00226}00226     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} node\_count = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00227}00227 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00228}00228     \textcolor{comment}{// Loop over each element slice in the z-\/direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00229}00229     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < Nz; i++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00230}00230     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00231}00231       \textcolor{comment}{// Need a map at each element slice to tell us whether or not we've}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00232}00232       \textcolor{comment}{// already created an edge (and thus the nodes on that edge). If the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00233}00233       \textcolor{comment}{// nodes have already been created then all we have to do is copy them}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00234}00234       \textcolor{comment}{// over in reverse order}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00235}00235       std::map<std::pair<Edge, double>, Vector<Node*>> edge\_to\_nodes\_map;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00236}00236 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00237}00237       \textcolor{comment}{// As several edges can attach to a single (corner) node we can}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00238}00238       \textcolor{comment}{// accidentally create duplicate nodes (i.e. nodes that lie at}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00239}00239       \textcolor{comment}{// the same spatial position) because the edges aren't covered in}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00240}00240       \textcolor{comment}{// the required order (something we shouldn't rely on anyway!). To}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00241}00241       \textcolor{comment}{// get around this we store the corner nodes of each quad element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00242}00242       \textcolor{comment}{// with its corresponding z-\/value. This will in turn return the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00243}00243       \textcolor{comment}{// corresponding node in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00244}00244       std::map<std::pair<Node*, double>, Node*>}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00245}00245         quad\_corner\_node\_to\_cube\_node\_map;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00246}00246 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00247}00247       \textcolor{comment}{// Loop over all the elements in one slice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00248}00248       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_element\_in\_quad\_mesh; e++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00249}00249       \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00250}00250         \textcolor{comment}{// Get a pointer to the e-\/th element in the input mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00251}00251         FiniteElement* quad\_el\_pt = quad\_mesh\_pt-\/>finite\_element\_pt(e);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00253}00253         \textcolor{comment}{// Get the index of the cube element in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00254}00254         \textcolor{keywordtype}{unsigned} element\_index = i * n\_element\_in\_quad\_mesh + e;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00255}00255 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00256}00256         \textcolor{comment}{// Create the e-\/th element in the i-\/th slice of the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00257}00257         ELEMENT* cube\_el\_pt = \textcolor{keyword}{new} ELEMENT;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00258}00258 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00259}00259         \textcolor{comment}{// Put it in global storage!}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00260}00260         Element\_pt[element\_index] = cube\_el\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00261}00261 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00262}00262         \textcolor{comment}{// Index of the local node number (in the quad element)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00263}00263         \textcolor{keywordtype}{unsigned} quad\_local\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00264}00264 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00265}00265         \textcolor{comment}{// Index of the local node number (in the cube element)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00266}00266         \textcolor{keywordtype}{unsigned} cube\_local\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00267}00267 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00268}00268         \textcolor{comment}{// Cache the boundary information associated with this element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00269}00269         Vector<std::pair<unsigned, int>> el\_boundary\_information =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00270}00270           boundary\_information[e];}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00271}00271 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00272}00272         \textcolor{comment}{// Loop over the nodes in the third local coordinate direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00273}00273         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n\_2 = 0; n\_2 < n\_node\_1d; n\_2++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00274}00274         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00275}00275           \textcolor{comment}{// Calculate the z-\/value at the n\_2-\/th (z-\/)node in the i-\/th element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00276}00276           \textcolor{comment}{// slice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00277}00277           \textcolor{keywordtype}{double} z\_value = z\_spacing\_function(i, n\_2);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00278}00278 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00279}00279           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00280}00280           \textcolor{comment}{// At a given node slice, there are three options:}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00281}00281           \textcolor{comment}{//     (1) If i>0 and n\_2=0 then we already created the nodes}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00282}00282           \textcolor{comment}{//         (in the current slice) when we created the nodes in}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00283}00283           \textcolor{comment}{//         the previous slice;}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00284}00284           \textcolor{comment}{//     (2) If (1) doesn't hold we may have still have created}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00285}00285           \textcolor{comment}{//         certain nodes along a face/edge of an element that}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00286}00286           \textcolor{comment}{//         we previously created (in this node slice);}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00287}00287           \textcolor{comment}{//     (3) No nodes in this node slice have been created yet so}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00288}00288           \textcolor{comment}{//         set them all up!}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00289}00289           \textcolor{comment}{// NOTE: if (1) occurs, we can skip to the next node slice but}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00290}00290           \textcolor{comment}{// we can't if (2) occurs (or (3), obviously!).}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00291}00291           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00292}00292           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00293}00293           \textcolor{comment}{// Case (1): If we're past the first element slice and we're on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00294}00294           \textcolor{comment}{// the first node slice (in the element) then copy the nodes from}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00295}00295           \textcolor{comment}{// the appropriate element.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00296}00296           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00297}00297           \textcolor{keywordflow}{if} ((i > 0) \&\& (n\_2 == 0))}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00298}00298           \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00299}00299             \textcolor{comment}{// Get the index of the cube element (to copy) in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00300}00300             \textcolor{keywordtype}{unsigned} copy\_element\_index = (i -\/ 1) * n\_element\_in\_quad\_mesh + e;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00301}00301 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00302}00302             \textcolor{comment}{// Get a pointer to the element in the previous slice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00303}00303             \textcolor{comment}{// containing the node we want}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00304}00304             FiniteElement* copy\_cube\_el\_pt =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00305}00305               finite\_element\_pt(copy\_element\_index);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00306}00306 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00307}00307             \textcolor{comment}{// Storage for the local node number in the element that we're}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00308}00308             \textcolor{comment}{// copying}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00309}00309             \textcolor{keywordtype}{unsigned} copy\_cube\_local\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00310}00310 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00311}00311             \textcolor{comment}{// Loop over the nodes in the second local coordinate direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00312}00312             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n\_1 = 0; n\_1 < n\_node\_1d; n\_1++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00313}00313             \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00314}00314               \textcolor{comment}{// Loop over the nodes in the first local coordinate direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00315}00315               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n\_0 = 0; n\_0 < n\_node\_1d; n\_0++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00316}00316               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00317}00317                 \textcolor{comment}{// Calculate the local node number (in the extruded mesh)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00318}00318                 cube\_local\_node\_number = n\_0 + (n\_node\_1d * n\_1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00319}00319 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00320}00320                 \textcolor{comment}{// Calculate the local node number (in the input mesh)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00321}00321                 quad\_local\_node\_number = n\_0 + (n\_node\_1d * n\_1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00322}00322 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00323}00323                 \textcolor{comment}{// Calculate the local node number (in the element we're}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00324}00324                 \textcolor{comment}{// copying it from)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00325}00325                 copy\_cube\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00326}00326                   cube\_local\_node\_number +}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00327}00327                   n\_node\_1d * n\_node\_1d * (n\_node\_1d -\/ 1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00328}00328 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00329}00329                 \textcolor{comment}{// Copy the node over}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00330}00330                 cube\_el\_pt-\/>node\_pt(cube\_local\_node\_number) =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00331}00331                   copy\_cube\_el\_pt-\/>node\_pt(copy\_cube\_local\_node\_number);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00332}00332               \} \textcolor{comment}{// for (unsigned n\_0=0;n\_0<n\_node\_1d;n\_0++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00333}00333             \} \textcolor{comment}{// for (unsigned n\_1=0;n\_1<n\_node\_1d;n\_1++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00334}00334           \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00335}00335           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00336}00336           \textcolor{comment}{// Case (2) \& (3): Loop over the edges in the current node slice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00337}00337           \textcolor{comment}{// and check if any of them have already been set up (and thus}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00338}00338           \textcolor{comment}{// stored in edge\_to\_nodes\_map). If they have then copy them over}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00339}00339           \textcolor{comment}{// and construct all the other nodes. If they haven't then simply}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00340}00340           \textcolor{comment}{// construct all of the nodes.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00341}00341           \textcolor{comment}{// NOTE: if an edge has been created already, we can't make the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00342}00342           \textcolor{comment}{// nodes first, assign the coordinates THEN check as it would}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00343}00343           \textcolor{comment}{// be a wasteful operation. Instead, we get the nodes describing}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00344}00344           \textcolor{comment}{// an edge from the input mesh (quad\_mesh\_pt) and pair it with}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00345}00345           \textcolor{comment}{// the current z-\/value.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00346}00346           \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00347}00347           \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00348}00348           \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00349}00349             \textcolor{comment}{// Create a vector of bools to tell us if we've set the nodes up}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00350}00350             \textcolor{comment}{// in the current node slice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00351}00351             std::vector<bool> has\_node\_been\_setup(n\_node\_1d * n\_node\_1d, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00353}00353             \textcolor{comment}{// Number of edges in a slice (N/E/S/W)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00354}00354             \textcolor{keywordtype}{unsigned} n\_edge = 4;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00356}00356             \textcolor{comment}{// Storage for the edges}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00357}00357             Vector<std::pair<Edge, double>> edges\_and\_z\_value;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00358}00358 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00359}00359             \textcolor{comment}{// Vector to tell us if we are copying any edges (to make sure}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00360}00360             \textcolor{comment}{// we don't store the edge again later!)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00361}00361             std::vector<bool> has\_edge\_been\_done(n\_edge, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00362}00362 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00363}00363             \textcolor{comment}{// What is the last edge? Convert this to an int so the compiler}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00364}00364             \textcolor{comment}{// doesn't complain about comparisons between unsigned and signed}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00365}00365             \textcolor{comment}{// integers...}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00366}00366             \textcolor{keywordtype}{int} last\_edge = int(QuadTreeNames::N + n\_edge);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00367}00367 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00368}00368             \textcolor{comment}{// Loop over the edges}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00369}00369             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i\_edge = QuadTreeNames::N; i\_edge < last\_edge; i\_edge++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00370}00370             \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00371}00371               \textcolor{comment}{// Pointer for the first node associated with this edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00372}00372               Node* node1\_pt = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00374}00374               \textcolor{comment}{// Pointer for the second node associated with this edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00375}00375               Node* node2\_pt = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00377}00377               \textcolor{comment}{// Find the corner nodes associated with this edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00378}00378               \textcolor{keywordflow}{switch} (i\_edge)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00379}00379               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00380}00380                 \textcolor{keywordflow}{case} QuadTreeNames::N:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00381}00381                   \textcolor{comment}{// The first node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00382}00382                   node1\_pt = quad\_el\_pt-\/>node\_pt((n\_node\_1d * n\_node\_1d) -\/ 1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00383}00383 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00384}00384                   \textcolor{comment}{// The second node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00385}00385                   node2\_pt = quad\_el\_pt-\/>node\_pt(n\_node\_1d * (n\_node\_1d -\/ 1));}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00386}00386 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00387}00387                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00388}00388                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00389}00389                 \textcolor{keywordflow}{case} QuadTreeNames::E:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00390}00390                   \textcolor{comment}{// The first node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00391}00391                   node1\_pt = quad\_el\_pt-\/>node\_pt(n\_node\_1d -\/ 1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00393}00393                   \textcolor{comment}{// The second node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00394}00394                   node2\_pt = quad\_el\_pt-\/>node\_pt((n\_node\_1d * n\_node\_1d) -\/ 1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00395}00395 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00396}00396                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00397}00397                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00398}00398                 \textcolor{keywordflow}{case} QuadTreeNames::S:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00399}00399                   \textcolor{comment}{// The first node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00400}00400                   node1\_pt = quad\_el\_pt-\/>node\_pt(0);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00401}00401 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00402}00402                   \textcolor{comment}{// The second node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00403}00403                   node2\_pt = quad\_el\_pt-\/>node\_pt(n\_node\_1d -\/ 1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00404}00404 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00405}00405                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00406}00406                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00407}00407                 \textcolor{keywordflow}{case} QuadTreeNames::W:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00408}00408                   \textcolor{comment}{// The first node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00409}00409                   node1\_pt = quad\_el\_pt-\/>node\_pt(n\_node\_1d * (n\_node\_1d -\/ 1));}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00410}00410 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00411}00411                   \textcolor{comment}{// The second node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00412}00412                   node2\_pt = quad\_el\_pt-\/>node\_pt(0);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00413}00413 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00414}00414                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00415}00415                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00416}00416                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00417}00417                   \textcolor{comment}{// Create an ostringstream object to create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00418}00418                   std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00419}00419 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00420}00420                   \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00421}00421                   error\_message\_stream}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00422}00422                     << \textcolor{stringliteral}{"{}Input is "{}} << i\_edge << \textcolor{stringliteral}{"{} but it can only\(\backslash\)n"{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00423}00423                     << \textcolor{stringliteral}{"{}be either N/E/S/W, i.e. "{}} << QuadTreeNames::N << \textcolor{stringliteral}{"{},"{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00424}00424                     << QuadTreeNames::E << \textcolor{stringliteral}{"{},"{}} << QuadTreeNames::S << \textcolor{stringliteral}{"{} or "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00425}00425                     << QuadTreeNames::W << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00426}00426 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00427}00427                   \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00428}00428                   \textcolor{keywordflow}{throw} OomphLibError(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00429}00429                                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00430}00430                                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00431}00431               \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00432}00432 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00433}00433               \textcolor{comment}{// Create the edge associated with the i\_edge-\/th edge of this}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00434}00434               \textcolor{comment}{// element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00435}00435               Edge edge(node1\_pt, node2\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00436}00436 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00437}00437               \textcolor{comment}{// Pair it up with the z-\/value at the current node slice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00438}00438               std::pair<Edge, double> edge\_and\_z\_value\_pair(edge, z\_value);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00439}00439 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00440}00440               \textcolor{comment}{// Store the edge (with its corresponding z-\/value)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00441}00441               edges\_and\_z\_value.push\_back(edge\_and\_z\_value\_pair);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00442}00442 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00443}00443               \textcolor{comment}{// Is there is a matching entry in the map?}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00444}00444               std::map<std::pair<Edge, double>, Vector<Node*>>::iterator it =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00445}00445                 edge\_to\_nodes\_map.find(edge\_and\_z\_value\_pair);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00446}00446 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00447}00447               \textcolor{comment}{// If we're not at the end then it has already been created}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00448}00448               \textcolor{keywordflow}{if} (it != edge\_to\_nodes\_map.end())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00449}00449               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00450}00450                 \textcolor{comment}{// Get the vector of node pointers}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00451}00451                 Vector<Node*> edge\_nodes\_pt = it-\/>second;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00452}00452 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00453}00453 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00454}00454                 \textcolor{comment}{// Sanity check; make sure enough nodes have been stored}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00455}00455                 \textcolor{keywordflow}{if} (edge\_nodes\_pt.size() != n\_node\_1d)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00456}00456                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00457}00457                   \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00458}00458                   \textcolor{keywordflow}{throw} OomphLibError(\textcolor{stringliteral}{"{}Not enough nodes in edge\_nodes\_pt!"{}},}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00459}00459                                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00460}00460                                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00461}00461                 \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00462}00462 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00463}00463 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00464}00464                 \textcolor{comment}{// Remember that the i\_edge-\/th edge has already been created!}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00465}00465                 \textcolor{keywordflow}{switch} (i\_edge)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00466}00466                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00467}00467                   \textcolor{keywordflow}{case} QuadTreeNames::N:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00468}00468                     \textcolor{comment}{// Indicate that the Northern edge has been done}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00469}00469                     has\_edge\_been\_done[0] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00470}00470 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00471}00471                     \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00472}00472                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00473}00473                   \textcolor{keywordflow}{case} QuadTreeNames::E:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00474}00474                     \textcolor{comment}{// Indicate that the Eastern edge has been done}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00475}00475                     has\_edge\_been\_done[1] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00476}00476 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00477}00477                     \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00478}00478                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00479}00479                   \textcolor{keywordflow}{case} QuadTreeNames::S:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00480}00480                     \textcolor{comment}{// Indicate that the Southern edge has been done}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00481}00481                     has\_edge\_been\_done[2] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00482}00482 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00483}00483                     \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00484}00484                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00485}00485                   \textcolor{keywordflow}{case} QuadTreeNames::W:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00486}00486                     \textcolor{comment}{// Indicate that the Western edge has been done}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00487}00487                     has\_edge\_been\_done[3] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00488}00488 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00489}00489                     \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00490}00490                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00491}00491                   \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00492}00492                     \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00493}00493                     \textcolor{keywordflow}{throw} OomphLibError(\textcolor{stringliteral}{"{}Incorrect edge type!"{}},}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00494}00494                                         OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00495}00495                                         OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00496}00496                 \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00497}00497 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00498}00498                 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00499}00499                 \textcolor{comment}{// Assign the nodes appropriately depending on which edge has}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00500}00500                 \textcolor{comment}{// already been created.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00501}00501                 \textcolor{comment}{// NOTE: the nodes will have been created in anti-\/clockwise}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00502}00502                 \textcolor{comment}{// order which means we will have to assign them in clockwise}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00503}00503                 \textcolor{comment}{// order (from the perspective of the current element).}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00504}00504                 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00505}00505                 \textcolor{comment}{// Loop over the nodes}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00506}00506                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_node = 0; i\_node < n\_node\_1d; i\_node++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00507}00507                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00508}00508                   \textcolor{comment}{// Calculate the value of quad\_local\_node\_number depending on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00509}00509                   \textcolor{comment}{// which edge the node lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00510}00510                   \textcolor{keywordflow}{switch} (i\_edge)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00511}00511                   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00512}00512                     \textcolor{keywordflow}{case} QuadTreeNames::N:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00513}00513                       \textcolor{comment}{// Calculate this Node's quad local node number}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00514}00514                       quad\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00515}00515                         ((n\_node\_1d * n\_node\_1d) -\/ 1) -\/ i\_node;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00516}00516 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00517}00517                       \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00518}00518                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00519}00519                     \textcolor{keywordflow}{case} QuadTreeNames::E:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00520}00520                       \textcolor{comment}{// Calculate this Node's quad local node number}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00521}00521                       quad\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00522}00522                         (n\_node\_1d -\/ 1) + (i\_node * n\_node\_1d);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00523}00523 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00524}00524                       \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00525}00525                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00526}00526                     \textcolor{keywordflow}{case} QuadTreeNames::S:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00527}00527                       \textcolor{comment}{// Calculate this Node's quad local node number}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00528}00528                       quad\_local\_node\_number = i\_node;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00529}00529 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00530}00530                       \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00531}00531                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00532}00532                     \textcolor{keywordflow}{case} QuadTreeNames::W:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00533}00533                       \textcolor{comment}{// Calculate this Node's quad local node number}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00534}00534                       quad\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00535}00535                         (n\_node\_1d * (n\_node\_1d -\/ 1)) -\/ (i\_node * n\_node\_1d);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00537}00537                       \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00538}00538                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00539}00539                   \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00540}00540 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00541}00541                   \textcolor{comment}{// Calculate this Node's cube local node number}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00542}00542                   cube\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00543}00543                     quad\_local\_node\_number + (n\_node\_1d * n\_node\_1d * n\_2);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00544}00544 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00545}00545                   \textcolor{comment}{// Assign the i\_node-\/th node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00546}00546                   cube\_el\_pt-\/>node\_pt(cube\_local\_node\_number) =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00547}00547                     edge\_nodes\_pt[(n\_node\_1d -\/ 1) -\/ i\_node];}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00548}00548 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00549}00549                   \textcolor{comment}{// Indicate that the appropriate node has been set up}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00550}00550                   has\_node\_been\_setup[quad\_local\_node\_number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00551}00551                 \} \textcolor{comment}{// for (unsigned i\_node=0;i\_node<n\_node\_1d;i\_node++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00552}00552               \} \textcolor{comment}{// if (it!=edge\_to\_nodes\_map.end())}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00553}00553             \} \textcolor{comment}{// for (unsigned i\_edge=0;i<n\_edge;i\_edge++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00554}00554 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00555}00555             \textcolor{comment}{// The number of corners}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00556}00556             \textcolor{keywordtype}{unsigned} n\_corner = 4;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00557}00557 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00558}00558             \textcolor{comment}{// Loop over the corner nodes}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00559}00559             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_corner = 0; i\_corner < n\_corner; i\_corner++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00560}00560             \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00561}00561               \textcolor{comment}{// Calculate the value of quad\_local\_node\_number depending on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00562}00562               \textcolor{comment}{// which corner the node lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00563}00563               \textcolor{keywordflow}{switch} (i\_corner)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00564}00564               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00565}00565                 \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00566}00566                   \textcolor{comment}{// Bottom-\/left corner}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00567}00567                   quad\_local\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00569}00569                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00570}00570                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00571}00571                 \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00572}00572                   \textcolor{comment}{// Bottom-\/right corner}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00573}00573                   quad\_local\_node\_number = n\_node\_1d -\/ 1;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00574}00574 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00575}00575                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00576}00576                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00577}00577                 \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00578}00578                   \textcolor{comment}{// Top-\/left corner}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00579}00579                   quad\_local\_node\_number = n\_node\_1d * (n\_node\_1d -\/ 1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00580}00580 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00581}00581                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00582}00582                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00583}00583                 \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00584}00584                   \textcolor{comment}{// Top-\/right corner}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00585}00585                   quad\_local\_node\_number = (n\_node\_1d * n\_node\_1d) -\/ 1;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00586}00586 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00587}00587                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00588}00588                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00589}00589               \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00590}00590 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00591}00591               \textcolor{comment}{// If the node hasn't already been copied from some other edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00592}00592               \textcolor{keywordflow}{if} (!has\_node\_been\_setup[quad\_local\_node\_number])}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00593}00593               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00594}00594                 \textcolor{comment}{// Get a pointer to the first corner node (in the quad mesh)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00595}00595                 Node* quad\_corner\_node\_pt =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00596}00596                   quad\_el\_pt-\/>node\_pt(quad\_local\_node\_number);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00597}00597 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00598}00598                 \textcolor{comment}{// Pair up the corner node and z-\/value}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00599}00599                 std::pair<Node*, double> quad\_corner\_node\_and\_z\_value(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00600}00600                   quad\_corner\_node\_pt, z\_value);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00601}00601 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00602}00602                 \textcolor{comment}{// Have we made this Node yet?}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00603}00603                 std::map<std::pair<Node*, double>, Node*>::iterator it =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00604}00604                   quad\_corner\_node\_to\_cube\_node\_map.find(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00605}00605                     quad\_corner\_node\_and\_z\_value);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00606}00606 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00607}00607                 \textcolor{comment}{// If we found a corresponding entry}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00608}00608                 \textcolor{keywordflow}{if} (it != quad\_corner\_node\_to\_cube\_node\_map.end())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00609}00609                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00610}00610                   \textcolor{comment}{// Index of the local node number}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00611}00611                   cube\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00612}00612                     quad\_local\_node\_number + (n\_node\_1d * n\_node\_1d * n\_2);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00613}00613 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00614}00614                   \textcolor{comment}{// Get the node and store it in the element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00615}00615                   cube\_el\_pt-\/>node\_pt(cube\_local\_node\_number) = it-\/>second;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00616}00616 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00617}00617                   \textcolor{comment}{// Indicate that the node has now been created}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00618}00618                   has\_node\_been\_setup[quad\_local\_node\_number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00619}00619                 \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00620}00620               \} \textcolor{comment}{// if (!has\_node\_been\_setup[quad\_local\_node\_number])}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00621}00621             \} \textcolor{comment}{// for (unsigned i\_corner=0;i\_corner<n\_corner;i\_corner++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00622}00622 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00623}00623             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00624}00624             \textcolor{comment}{// By this point, all nodes which have already been created have}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00625}00625             \textcolor{comment}{// been copied over. All the other nodes now need to be constructed.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00626}00626             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00627}00627             \textcolor{comment}{// Loop over the nodes in the second local coordinate direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00628}00628             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n\_1 = 0; n\_1 < n\_node\_1d; n\_1++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00629}00629             \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00630}00630               \textcolor{comment}{// Loop over the nodes in the first local coordinate direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00631}00631               \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n\_0 = 0; n\_0 < n\_node\_1d; n\_0++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00632}00632               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00633}00633                 \textcolor{comment}{// Calculate the local node number (in the input mesh)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00634}00634                 quad\_local\_node\_number = n\_0 + (n\_node\_1d * n\_1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00635}00635 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00636}00636                 \textcolor{comment}{// Calculate the local node number (in the extruded mesh)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00637}00637                 cube\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00638}00638                   quad\_local\_node\_number + (n\_node\_1d * n\_node\_1d * n\_2);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00639}00639 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00640}00640                 \textcolor{comment}{// Check if the node has already been created (i.e. by copying)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00641}00641                 \textcolor{keywordflow}{if} (has\_node\_been\_setup[quad\_local\_node\_number])}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00642}00642                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00643}00643                   \textcolor{comment}{// If this node has already been set up then skip it}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00644}00644                   \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00645}00645                 \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00646}00646 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00647}00647                 \textcolor{comment}{// Pointer to point to the node we are about to create}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00648}00648                 Node* cube\_node\_pt = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00649}00649 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00650}00650                 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}\textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00651}00651 \textcolor{comment}{                /// / Check if the node that we're about to construct lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00652}00652 \textcolor{comment}{                /// the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00653}00653 \textcolor{comment}{}                \textcolor{comment}{// Front or back face of the mesh. The node can only lie on the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00654}00654                 \textcolor{comment}{// front face if we're on the first element slice and first node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00655}00655                 \textcolor{comment}{// slice. In contrast, the node can only lie on the back face if}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00656}00656                 \textcolor{comment}{// we're on the final element slice and final node slice.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00657}00657                 \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00658}00658                 \textcolor{comment}{// The node lies on the front face or the back face}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00659}00659                 \textcolor{keywordflow}{if} (((i == 0) \&\& (n\_2 == 0)) ||}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00660}00660                     ((i == Nz -\/ 1) \&\& (n\_2 == n\_node\_1d -\/ 1)))}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00661}00661                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00662}00662                   \textcolor{comment}{// The node lies on the front face}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00663}00663                   \textcolor{keywordflow}{if} ((i == 0) \&\& (n\_2 == 0))}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00664}00664                   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00665}00665                     \textcolor{comment}{// Create the boundary node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00666}00666                     cube\_node\_pt = cube\_el\_pt-\/>construct\_boundary\_node(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00667}00667                       cube\_local\_node\_number, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00668}00668 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00669}00669                     \textcolor{comment}{// Indicate that the node has been created now}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00670}00670                     has\_node\_been\_setup[quad\_local\_node\_number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00671}00671 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00672}00672                     \textcolor{comment}{// Add the node to the appropriate boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00673}00673                     add\_boundary\_node(n\_boundary\_in\_quad\_mesh, cube\_node\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00674}00674                   \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00675}00675                   \textcolor{comment}{// The node lies on the back face}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00676}00676                   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ((i == Nz -\/ 1) \&\& (n\_2 == n\_node\_1d -\/ 1))}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00677}00677                   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00678}00678                     \textcolor{comment}{// Create the boundary node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00679}00679                     cube\_node\_pt = cube\_el\_pt-\/>construct\_boundary\_node(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00680}00680                       cube\_local\_node\_number, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00681}00681 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00682}00682                     \textcolor{comment}{// Indicate that the node has been created now}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00683}00683                     has\_node\_been\_setup[quad\_local\_node\_number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00684}00684 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00685}00685                     \textcolor{comment}{// Add the node to the appropriate boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00686}00686                     add\_boundary\_node(n\_boundary\_in\_quad\_mesh + 1,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00687}00687                                       cube\_node\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00688}00688                   \} \textcolor{comment}{// if ((i==0)\&\&(n\_2==0))}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00689}00689 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00690}00690                   \textcolor{comment}{// Get a pointer to the matching quad mesh node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00691}00691                   Node* quad\_node\_pt =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00692}00692                     quad\_el\_pt-\/>node\_pt(quad\_local\_node\_number);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00693}00693 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00694}00694                   \textcolor{comment}{// If this Node lies on a boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00695}00695                   \textcolor{keywordflow}{if} (quad\_node\_pt-\/>is\_on\_boundary())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00696}00696                   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00697}00697                     \textcolor{comment}{// Storage for the set of boundaries that this Node lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00698}00698                     std::set<unsigned>* boundaries\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00699}00699 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00700}00700                     \textcolor{comment}{// Get the boundaries that this Node lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00701}00701                     quad\_node\_pt-\/>get\_boundaries\_pt(boundaries\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00702}00702 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00703}00703                     \textcolor{comment}{// Create an iterator to loop over the entries of the set}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00704}00704                     std::set<unsigned>::const\_iterator const\_it;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00705}00705 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00706}00706                     \textcolor{comment}{// Iterate over the boundaries}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00707}00707                     \textcolor{keywordflow}{for} (const\_it = boundaries\_pt-\/>begin();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00708}00708                          const\_it != boundaries\_pt-\/>end();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00709}00709                          const\_it++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00710}00710                     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00711}00711                       \textcolor{comment}{// Add the node to the appropriate boundary (if it hasn't}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00712}00712                       \textcolor{comment}{// already been added)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00713}00713                       add\_boundary\_node(*const\_it, cube\_node\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00714}00714                     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00715}00715                   \} \textcolor{comment}{// quad\_node\_pt-\/>is\_on\_boundary()}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00716}00716                 \} \textcolor{comment}{// if (((i==0)\&\&(n\_2==0))||((i==Nz-\/1)\&\&(n\_2==n\_node\_1d-\/1)))}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00717}00717 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00718}00718 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00719}00719                 \textcolor{comment}{// Check if there is any other boundary information}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00720}00720                 \textcolor{keywordflow}{if} (el\_boundary\_information.size() > 0)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00721}00721                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00722}00722                   \textcolor{comment}{// How many boundaries are there to cover?}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00723}00723                   \textcolor{keywordtype}{unsigned} n\_boundaries = el\_boundary\_information.size();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00724}00724 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00725}00725                   \textcolor{comment}{// Loop over the boundaries}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00726}00726                   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_bound = 0; i\_bound < n\_boundaries; i\_bound++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00727}00727                   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00728}00728                     \textcolor{comment}{// If the node still hasn't been created yet}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00729}00729                     \textcolor{keywordflow}{if} (!has\_node\_been\_setup[quad\_local\_node\_number])}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00730}00730                     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00731}00731                       \textcolor{comment}{// Create the boundary node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00732}00732                       cube\_node\_pt = cube\_el\_pt-\/>construct\_boundary\_node(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00733}00733                         cube\_local\_node\_number, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00734}00734 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00735}00735                       \textcolor{comment}{// Indicate that the node has been created now}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00736}00736                       has\_node\_been\_setup[quad\_local\_node\_number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00737}00737                     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00738}00738 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00739}00739                     \textcolor{comment}{// Get the boundary information associated with the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00740}00740                     \textcolor{comment}{// i\_bound-\/th entry}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00741}00741                     std::pair<unsigned, int> boundary\_and\_face\_index =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00742}00742                       el\_boundary\_information[i\_bound];}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00743}00743 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00744}00744                     \textcolor{comment}{// Decide whether or not the node lies on the boundary. If}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00745}00745                     \textcolor{comment}{// it does then add it to the boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00746}00746                     \textcolor{keywordflow}{switch} (boundary\_and\_face\_index.second)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00747}00747                     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00748}00748                       \textcolor{keywordflow}{case} -\/1:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00749}00749                         \textcolor{comment}{// If the s[0]=-\/1 boundary of the element lies on the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00750}00750                         \textcolor{comment}{// boundary the node can only lie on the boundary if}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00751}00751                         \textcolor{comment}{// n\_0=0.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00752}00752                         \textcolor{keywordflow}{if} (n\_0 == 0)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00753}00753                         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00754}00754                           \textcolor{comment}{// Now add the node to the appropriate boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00755}00755                           add\_boundary\_node(boundary\_and\_face\_index.first,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00756}00756                                             cube\_node\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00757}00757                         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00758}00758 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00759}00759                         \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00760}00760                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00761}00761                       \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00762}00762                         \textcolor{comment}{// If the s[0]=1 boundary of the element lies on the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00763}00763                         \textcolor{comment}{// boundary the node can only lie on the boundary if}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00764}00764                         \textcolor{comment}{// n\_0=n\_node\_1d-\/1}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00765}00765                         \textcolor{keywordflow}{if} (n\_0 == n\_node\_1d -\/ 1)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00766}00766                         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00767}00767                           \textcolor{comment}{// Now add the node to the appropriate boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00768}00768                           add\_boundary\_node(boundary\_and\_face\_index.first,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00769}00769                                             cube\_node\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00770}00770                         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00771}00771 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00772}00772                         \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00773}00773                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00774}00774                       \textcolor{keywordflow}{case} -\/2:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00775}00775                         \textcolor{comment}{// If the s[1]=-\/1 boundary of the element lies on the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00776}00776                         \textcolor{comment}{// boundary the node can only lie on the boundary if}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00777}00777                         \textcolor{comment}{// n\_1=0.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00778}00778                         \textcolor{keywordflow}{if} (n\_1 == 0)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00779}00779                         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00780}00780                           \textcolor{comment}{// Now add the node to the appropriate boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00781}00781                           add\_boundary\_node(boundary\_and\_face\_index.first,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00782}00782                                             cube\_node\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00783}00783                         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00784}00784 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00785}00785                         \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00786}00786                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00787}00787                       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00788}00788                         \textcolor{comment}{// If the s[1]=1 boundary of the element lies on the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00789}00789                         \textcolor{comment}{// boundary the node can only lie on the boundary if}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00790}00790                         \textcolor{comment}{// n\_1=n\_node\_1d-\/1.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00791}00791                         \textcolor{keywordflow}{if} (n\_1 == n\_node\_1d -\/ 1)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00792}00792                         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00793}00793                           \textcolor{comment}{// Now add the node to the appropriate boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00794}00794                           add\_boundary\_node(boundary\_and\_face\_index.first,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00795}00795                                             cube\_node\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00796}00796                         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00797}00797 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00798}00798                         \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00799}00799                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00800}00800                     \} \textcolor{comment}{// switch (boundary\_and\_face\_index.second)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00801}00801                   \} \textcolor{comment}{// for (unsigned i\_bound=0;i\_bound<n\_boundaries;i\_bound++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00802}00802                 \} \textcolor{comment}{// if (el\_boundary\_information.size()>0)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00803}00803 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00804}00804                 \textcolor{comment}{// Okay, so this Node does not lie on a face of a quad element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00805}00805                 \textcolor{comment}{// that lies on a boundary. However(!), there is still another}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00806}00806                 \textcolor{comment}{// case in which it might lie on a mesh boundary; when the Node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00807}00807                 \textcolor{comment}{// is the ONLY Node in the element that lies on the boundary.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00808}00808                 \textcolor{comment}{// It's a slightly odd scenario but can easily occur on meshes}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00809}00809                 \textcolor{comment}{// created using the QuadFromTriangleMesh class.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00810}00810                 Node* quad\_node\_pt =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00811}00811                   quad\_el\_pt-\/>node\_pt(quad\_local\_node\_number);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00812}00812 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00813}00813                 \textcolor{comment}{// If this Node lies on a boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00814}00814                 \textcolor{keywordflow}{if} (quad\_node\_pt-\/>is\_on\_boundary())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00815}00815                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00816}00816                   \textcolor{comment}{// If we haven't created the Node yet AND the corresponding}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00817}00817                   \textcolor{comment}{// Node in the quad mesh definitely lies on the boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00818}00818                   \textcolor{keywordflow}{if} (cube\_node\_pt == 0)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00819}00819                   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00820}00820                     \textcolor{comment}{// Create the boundary node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00821}00821                     cube\_node\_pt = cube\_el\_pt-\/>construct\_boundary\_node(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00822}00822                       cube\_local\_node\_number, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00823}00823 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00824}00824                     \textcolor{comment}{// Indicate that the node has been created now}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00825}00825                     has\_node\_been\_setup[quad\_local\_node\_number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00826}00826                   \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00827}00827 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00828}00828                   \textcolor{comment}{// Storage for the set of boundaries that this Node lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00829}00829                   std::set<unsigned>* boundaries\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00830}00830 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00831}00831                   \textcolor{comment}{// Get the boundaries that this Node lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00832}00832                   quad\_node\_pt-\/>get\_boundaries\_pt(boundaries\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00833}00833 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00834}00834                   \textcolor{comment}{// Create an iterator to loop over the entries of the set}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00835}00835                   std::set<unsigned>::const\_iterator const\_it;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00836}00836 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00837}00837                   \textcolor{comment}{// Iterate over the boundaries}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00838}00838                   \textcolor{keywordflow}{for} (const\_it = boundaries\_pt-\/>begin();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00839}00839                        const\_it != boundaries\_pt-\/>end();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00840}00840                        const\_it++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00841}00841                   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00842}00842                     \textcolor{comment}{// Add the node to the appropriate boundary (if it hasn't}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00843}00843                     \textcolor{comment}{// already been added)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00844}00844                     add\_boundary\_node(*const\_it, cube\_node\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00845}00845                   \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00846}00846                 \} \textcolor{comment}{// quad\_node\_pt-\/>is\_on\_boundary()}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00847}00847 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00848}00848                 \textcolor{comment}{// If the node still hasn't been created yet}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00849}00849                 \textcolor{keywordflow}{if} (!has\_node\_been\_setup[quad\_local\_node\_number])}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00850}00850                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00851}00851                   \textcolor{comment}{// The only other possibility is that it is a regular node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00852}00852                   cube\_node\_pt = cube\_el\_pt-\/>construct\_node(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00853}00853                     cube\_local\_node\_number, time\_stepper\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00854}00854 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00855}00855                   \textcolor{comment}{// Indicate that the node has now been set up}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00856}00856                   has\_node\_been\_setup[quad\_local\_node\_number] = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00857}00857                 \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00858}00858 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00859}00859                 \textcolor{comment}{// Set the x-\/coordinate of the node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00860}00860                 cube\_node\_pt-\/>x(0) = quad\_node\_pt-\/>x(0);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00861}00861 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00862}00862                 \textcolor{comment}{// Set the y-\/coordinate of the node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00863}00863                 cube\_node\_pt-\/>x(1) = quad\_node\_pt-\/>x(1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00864}00864 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00865}00865                 \textcolor{comment}{// Set the z-\/coordinate of the node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00866}00866                 cube\_node\_pt-\/>x(2) = z\_value;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00867}00867 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00868}00868                 \textcolor{comment}{// Add it to global storage}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00869}00869                 Node\_pt[node\_count] = cube\_node\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00870}00870 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00871}00871                 \textcolor{comment}{// Increment the counter}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00872}00872                 node\_count++;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00873}00873               \} \textcolor{comment}{// for (unsigned n\_0=0;n\_0<n\_node\_1d;n\_0++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00874}00874             \} \textcolor{comment}{// for (unsigned n\_1=0;n\_1<n\_node\_1d;n\_1++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00875}00875 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00876}00876             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00877}00877             \textcolor{comment}{// We've set up the nodes in one slice, now set up the edge-\/to-\/node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00878}00878             \textcolor{comment}{// information and store it in the map edge\_to\_nodes\_map.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00879}00879             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00880}00880             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_edge = 0; i\_edge < n\_edge; i\_edge++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00881}00881             \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00882}00882               \textcolor{comment}{// If it hasn't already been done}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00883}00883               \textcolor{keywordflow}{if} (!has\_edge\_been\_done[i\_edge])}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00884}00884               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00885}00885                 \textcolor{comment}{// Create a vector to store the nodes on this edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00886}00886                 Vector<Node*> edge\_nodes\_pt(n\_node\_1d, 0);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00887}00887 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00888}00888                 \textcolor{comment}{// Loop over the nodes and add them}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00889}00889                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_node = 0; i\_node < n\_node\_1d; i\_node++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00890}00890                 \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00891}00891                   \textcolor{comment}{// Calculate the value of quad\_local\_node\_number depending on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00892}00892                   \textcolor{comment}{// which corner the node lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00893}00893                   \textcolor{keywordflow}{switch} (i\_edge)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00894}00894                   \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00895}00895                     \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00896}00896                       \textcolor{comment}{// Northern edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00897}00897                       quad\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00898}00898                         ((n\_node\_1d * n\_node\_1d) -\/ 1) -\/ i\_node;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00899}00899 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00900}00900                       \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00901}00901                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00902}00902                     \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00903}00903                       \textcolor{comment}{// Eastern edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00904}00904                       quad\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00905}00905                         (n\_node\_1d -\/ 1) + (i\_node * n\_node\_1d);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00906}00906 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00907}00907                       \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00908}00908                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00909}00909                     \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00910}00910                       \textcolor{comment}{// Southern edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00911}00911                       quad\_local\_node\_number = i\_node;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00912}00912 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00913}00913                       \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00914}00914                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00915}00915                     \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00916}00916                       \textcolor{comment}{// Western edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00917}00917                       quad\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00918}00918                         (n\_node\_1d * (n\_node\_1d -\/ 1)) -\/ (i\_node * n\_node\_1d);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00919}00919 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00920}00920                       \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00921}00921                       \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00922}00922                   \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00923}00923 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00924}00924                   \textcolor{comment}{// Index of the local node number}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00925}00925                   cube\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00926}00926                     quad\_local\_node\_number + (n\_node\_1d * n\_node\_1d * n\_2);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00927}00927 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00928}00928                   \textcolor{comment}{// Store the i\_node-\/th node along this edge}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00929}00929                   edge\_nodes\_pt[i\_node] =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00930}00930                     cube\_el\_pt-\/>node\_pt(cube\_local\_node\_number);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00931}00931                 \} \textcolor{comment}{// for (unsigned i\_node=0;i\_node<n\_node\_1d;i\_node++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00932}00932 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00933}00933                 \textcolor{comment}{// Store the nodes along the north edge of the element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00934}00934                 edge\_to\_nodes\_map[edges\_and\_z\_value[i\_edge]] = edge\_nodes\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00935}00935               \} \textcolor{comment}{// if (!has\_edge\_been\_done[i\_edge])}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00936}00936             \} \textcolor{comment}{// for (unsigned i\_edge=0;i\_edge<n\_edge;i\_edge++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00937}00937 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00938}00938             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00939}00939             \textcolor{comment}{// Now store the corner nodes of the element at the current node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00940}00940             \textcolor{comment}{// slice in the map quad\_corner\_node\_to\_cube\_node\_map.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00941}00941             \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00942}00942             \textcolor{comment}{// Loop over the corner nodes}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00943}00943             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_corner = 0; i\_corner < n\_corner; i\_corner++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00944}00944             \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00945}00945               \textcolor{comment}{// Calculate the value of quad\_local\_node\_number depending on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00946}00946               \textcolor{comment}{// which corner the node lies on}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00947}00947               \textcolor{keywordflow}{switch} (i\_corner)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00948}00948               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00949}00949                 \textcolor{keywordflow}{case} 0:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00950}00950                   \textcolor{comment}{// Bottom-\/left corner}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00951}00951                   quad\_local\_node\_number = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00952}00952 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00953}00953                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00954}00954                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00955}00955                 \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00956}00956                   \textcolor{comment}{// Bottom-\/right corner}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00957}00957                   quad\_local\_node\_number = n\_node\_1d -\/ 1;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00958}00958 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00959}00959                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00960}00960                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00961}00961                 \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00962}00962                   \textcolor{comment}{// Top-\/left corner}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00963}00963                   quad\_local\_node\_number = n\_node\_1d * (n\_node\_1d -\/ 1);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00964}00964 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00965}00965                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00966}00966                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00967}00967                 \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00968}00968                   \textcolor{comment}{// Top-\/right corner}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00969}00969                   quad\_local\_node\_number = (n\_node\_1d * n\_node\_1d) -\/ 1;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00970}00970 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00971}00971                   \textcolor{comment}{// Break}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00972}00972                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00973}00973               \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00974}00974 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00975}00975               \textcolor{comment}{// Index of the corresponding corner node (in the cube element)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00976}00976               cube\_local\_node\_number =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00977}00977                 quad\_local\_node\_number + (n\_node\_1d * n\_node\_1d * n\_2);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00978}00978 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00979}00979               \textcolor{comment}{// Get a pointer to the first corner node (in the quad mesh)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00980}00980               Node* quad\_corner\_node\_pt =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00981}00981                 quad\_el\_pt-\/>node\_pt(quad\_local\_node\_number);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00982}00982 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00983}00983               \textcolor{comment}{// Get a pointer to the first corner node (in the cube mesh)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00984}00984               Node* cube\_corner\_node\_pt =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00985}00985                 cube\_el\_pt-\/>node\_pt(cube\_local\_node\_number);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00986}00986 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00987}00987               \textcolor{comment}{// Pair up the corner node and z-\/value}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00988}00988               std::pair<Node*, double> quad\_corner\_node\_and\_z\_value(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00989}00989                 quad\_corner\_node\_pt, z\_value);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00990}00990 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00991}00991               \textcolor{comment}{// Store it in the map}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00992}00992               quad\_corner\_node\_to\_cube\_node\_map[quad\_corner\_node\_and\_z\_value] =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00993}00993                 cube\_corner\_node\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00994}00994             \} \textcolor{comment}{// for (unsigned i\_corner=0;i\_corner<n\_corner;i\_corner++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00995}00995 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00996}00996 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00997}00997             \textcolor{comment}{// Loop over all the nodes in the current node slice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00998}00998             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\_node = 0; i\_node < (n\_node\_1d * n\_node\_1d);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l00999}00999                  i\_node++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01000}01000             \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01001}01001               \textcolor{comment}{// Make sure every node in the current slice has been set up}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01002}01002               \textcolor{keywordflow}{if} (!has\_node\_been\_setup[i\_node])}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01003}01003               \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01004}01004                 \textcolor{comment}{// Create an ostringstream object to create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01005}01005                 std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01006}01006 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01007}01007                 \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01008}01008                 error\_message\_stream << \textcolor{stringliteral}{"{}There are nodes in element "{}} << e}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01009}01009                                      << \textcolor{stringliteral}{"{} which have not been constructed!"{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01010}01010                                      << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01011}01011 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01012}01012                 \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01013}01013                 \textcolor{keywordflow}{throw} OomphLibError(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01014}01014                                     OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01015}01015                                     OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01016}01016               \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01017}01017             \} \textcolor{comment}{// for (unsigned i\_node=0;i\_node<(n\_node\_1d*n\_node\_1d);i\_node++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01018}01018 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01019}01019           \} \textcolor{comment}{// if ((i>0)\&\&(n\_2==0))}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01020}01020         \} \textcolor{comment}{// for (unsigned n\_2=0;n\_2<n\_node\_1d;n\_2++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01021}01021       \} \textcolor{comment}{// for (unsigned e=0;e<n\_element\_in\_quad\_mesh;e++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01022}01022 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01023}01023       \textcolor{comment}{// Sanity check; make sure enough nodes have been stored}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01024}01024       \textcolor{keywordflow}{if} (node\_count != (1 + (n\_node\_1d -\/ 1) * (i + 1)) * n\_node\_in\_quad\_mesh)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01025}01025       \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01026}01026         \textcolor{comment}{// Create an ostringstream object to create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01027}01027         std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01028}01028 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01029}01029         \textcolor{comment}{// The number of nodes we expect there to be in the mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01030}01030         \textcolor{keywordtype}{int} expected\_n\_node =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01031}01031           (1 + (n\_node\_1d -\/ 1) * (i + 1)) * n\_node\_in\_quad\_mesh;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01032}01032 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01033}01033         \textcolor{comment}{// Difference in node count}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01034}01034         \textcolor{keywordtype}{int} node\_diff = expected\_n\_node -\/ node\_count;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01035}01035 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01036}01036         \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01037}01037         error\_message\_stream}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01038}01038           << \textcolor{stringliteral}{"{}There are meant to be "{}} << expected\_n\_node}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01039}01039           << \textcolor{stringliteral}{"{} nodes in the extruded mesh by the\(\backslash\)nend of slice "{}} << i}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01040}01040           << \textcolor{stringliteral}{"{} but you have "{}} << node\_count << \textcolor{stringliteral}{"{}. "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01041}01041           << \textcolor{stringliteral}{"{}That's a difference of "{}} << node\_diff << \textcolor{stringliteral}{"{}!"{}};}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01042}01042 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01043}01043         \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01044}01044         \textcolor{keywordflow}{throw} OomphLibError(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01045}01045                             OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01046}01046                             OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01047}01047       \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01048}01048     \} \textcolor{comment}{// for (unsigned i=0;i<Nz;i++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01049}01049 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01050}01050     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01051}01051     \textcolor{comment}{// Count the number of nodes on the boundaries of the quad mesh; there}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01052}01052     \textcolor{comment}{// should really be a helper function that does this (hint hint)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01053}01053     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01054}01054     \textcolor{comment}{// Use a set to make sure we don't count edge/corner nodes several times}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01055}01055     std::set<const Node*> all\_quad\_boundary\_nodes\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01056}01056 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01057}01057     \textcolor{comment}{// The number of boundary nodes in our extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01058}01058     \textcolor{keywordtype}{int} n\_quad\_mesh\_boundary\_node = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01059}01059 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01060}01060     \textcolor{comment}{// The number of boundaries in the quad mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01061}01061     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < n\_boundary\_in\_quad\_mesh; b++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01062}01062     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01063}01063       \textcolor{comment}{// Add on the number of nodes on the b-\/th boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01064}01064       \textcolor{keywordtype}{unsigned} n\_boundary\_node = quad\_mesh\_pt-\/>nboundary\_node(b);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01065}01065 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01066}01066       \textcolor{comment}{// Loop over the nodes on this boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01067}01067       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_boundary\_node; n++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01068}01068       \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01069}01069         \textcolor{comment}{// We haven't come across this boundary node yet}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01070}01070         \textcolor{keywordflow}{if} (all\_quad\_boundary\_nodes\_pt.find(quad\_mesh\_pt-\/>boundary\_node\_pt(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01071}01071               b, n)) == all\_quad\_boundary\_nodes\_pt.end())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01072}01072         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01073}01073           \textcolor{comment}{// Count this node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01074}01074           n\_quad\_mesh\_boundary\_node++;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01075}01075 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01076}01076           \textcolor{comment}{// Now remember it so we don't count it twice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01077}01077           all\_quad\_boundary\_nodes\_pt.insert(}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01078}01078             quad\_mesh\_pt-\/>boundary\_node\_pt(b, n));}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01079}01079         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01080}01080       \} \textcolor{comment}{// for (unsigned n=0; n<n\_boundary\_node; n++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01081}01081     \} \textcolor{comment}{// for (unsigned b=0; b<n\_boundary\_in\_quad\_mesh; b++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01082}01082 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01083}01083     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01084}01084     \textcolor{comment}{// Count the number of nodes on the boundaries of the extruded cube mesh;}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01085}01085     \textcolor{comment}{// (recall hint hint from above...)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01086}01086     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01087}01087     \textcolor{comment}{// Number of boundary nodes expected in the extruded mesh; initialise to}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01088}01088     \textcolor{comment}{// the number of boundary nodes on the front and back faces}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01089}01089     \textcolor{keywordtype}{int} n\_expected\_boundary\_node = 2 * quad\_mesh\_pt-\/>nnode();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01090}01090 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01091}01091     \textcolor{comment}{// Add on the nodes expected on the extruded mesh boundaries (but ignoring}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01092}01092     \textcolor{comment}{// the boundary nodes on the front and back faces)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01093}01093     n\_expected\_boundary\_node +=}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01094}01094       (((n\_node\_1d -\/ 1) * Nz) -\/ 1) * n\_quad\_mesh\_boundary\_node;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01095}01095 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01096}01096     \textcolor{comment}{// The number of boundary nodes in our extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01097}01097     \textcolor{keywordtype}{int} n\_extruded\_mesh\_boundary\_node = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01098}01098 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01099}01099     \textcolor{comment}{// Use a set to make sure we don't count edge/corner nodes several times}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01100}01100     std::set<const Node*> all\_extruded\_boundary\_nodes\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01101}01101 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01102}01102     \textcolor{comment}{// Loop over the boundaries of the mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01103}01103     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} b = 0; b < n\_boundary\_in\_extruded\_mesh; b++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01104}01104     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01105}01105       \textcolor{comment}{// Add on the number of nodes on the b-\/th boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01106}01106       \textcolor{keywordtype}{unsigned} n\_boundary\_node = nboundary\_node(b);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01107}01107 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01108}01108       \textcolor{comment}{// Loop over the nodes on this boundary}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01109}01109       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} n = 0; n < n\_boundary\_node; n++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01110}01110       \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01111}01111         \textcolor{comment}{// We haven't come across this boundary node yet}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01112}01112         \textcolor{keywordflow}{if} (all\_extruded\_boundary\_nodes\_pt.find(this-\/>boundary\_node\_pt(b, n)) ==}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01113}01113             all\_extruded\_boundary\_nodes\_pt.end())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01114}01114         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01115}01115           \textcolor{comment}{// Count this node}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01116}01116           n\_extruded\_mesh\_boundary\_node++;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01117}01117 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01118}01118           \textcolor{comment}{// Now remember it so we don't count it twice}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01119}01119           all\_extruded\_boundary\_nodes\_pt.insert(this-\/>boundary\_node\_pt(b, n));}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01120}01120         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01121}01121       \} \textcolor{comment}{// for (unsigned n=0; n<n\_boundary\_node; n++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01122}01122     \} \textcolor{comment}{// for (unsigned b=0; b<n\_boundary\_in\_extruded\_mesh; b++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01123}01123 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01124}01124     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01125}01125     \textcolor{comment}{// Check that there is the correct number of boundary nodes}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01126}01126     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01127}01127     \textcolor{comment}{// Error: we don't have the correct number of boundary nodes}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01128}01128     \textcolor{keywordflow}{if} (n\_extruded\_mesh\_boundary\_node != n\_expected\_boundary\_node)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01129}01129     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01130}01130       \textcolor{comment}{// Create an ostringstream object to create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01131}01131       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01132}01132 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01133}01133       \textcolor{comment}{// Difference in node count}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01134}01134       \textcolor{keywordtype}{int} node\_diff = n\_expected\_boundary\_node -\/ n\_extruded\_mesh\_boundary\_node;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01135}01135 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01136}01136       \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01137}01137       error\_message\_stream << \textcolor{stringliteral}{"{}There should be "{}} << n\_expected\_boundary\_node}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01138}01138                            << \textcolor{stringliteral}{"{} boundary nodes in the extruded mesh but there"{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01139}01139                            << \textcolor{stringliteral}{"{}\(\backslash\)nare only "{}} << n\_extruded\_mesh\_boundary\_node}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01140}01140                            << \textcolor{stringliteral}{"{} boundary nodes. That's a difference of "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01141}01141                            << node\_diff << \textcolor{stringliteral}{"{}!"{}} << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01142}01142 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01143}01143       \textcolor{comment}{// Throw an error}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01144}01144       \textcolor{keywordflow}{throw} OomphLibError(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01145}01145                           OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01146}01146                           OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01147}01147     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01148}01148 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01149}01149     \textcolor{comment}{// If the user wishes the mesh setup time to be doc-\/ed}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01150}01150     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1MeshExtrusionHelpers_a08b1a4e9b9e1d7b817fa07ea86f8a2e6}{MeshExtrusionHelpers::Mesh\_extrusion\_helper}}.doc\_mesh\_setup\_time())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01151}01151     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01152}01152       \textcolor{comment}{// Tell the user}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01153}01153       oomph\_info << \textcolor{stringliteral}{"{}Time taken to extrude mesh [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01154}01154                  << TimingHelpers::timer() -\/ t\_mesh\_construct\_start}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01155}01155                  << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01156}01156     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01157}01157 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01158}01158     \textcolor{comment}{// Get the current (i.e. start) time}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01159}01159     \textcolor{keywordtype}{double} t\_mesh\_macro\_start = TimingHelpers::timer();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01160}01160 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01161}01161     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01162}01162     \textcolor{comment}{// If an element has a macro-\/element representation in the quad}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01163}01163     \textcolor{comment}{// mesh then it need an extruded macro-\/element representation in}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01164}01164     \textcolor{comment}{// the extruded mesh so set that up here. Then, use the extruded}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01165}01165     \textcolor{comment}{// macro-\/element representation of the elements to move all the}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01166}01166     \textcolor{comment}{// nodes that need to be moved.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01167}01167     \textcolor{comment}{//-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01168}01168     \textcolor{comment}{// Create a map that takes a Domain and returns the corresponding}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01169}01169     \textcolor{comment}{// ExtrudedDomain object}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01170}01170     std::map<Domain*, ExtrudedDomain*> domain\_to\_extruded\_domain\_map;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01171}01171 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01172}01172     \textcolor{comment}{// Loop over the elements in the input mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01173}01173     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} e = 0; e < n\_element\_in\_quad\_mesh; e++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01174}01174     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01175}01175       \textcolor{comment}{// Get a pointer to the e-\/th element in the input mesh.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01176}01176       \textcolor{comment}{// NOTE: The element is upcast to the QElementBase class so we}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01177}01177       \textcolor{comment}{// can access the s\_macro\_ll() and s\_macro\_ur() functions.}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01178}01178       QElementBase* quad\_el\_pt =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01179}01179         \textcolor{keyword}{dynamic\_cast<}QElementBase*\textcolor{keyword}{>}(quad\_mesh\_pt-\/>finite\_element\_pt(e));}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01180}01180 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01181}01181       \textcolor{comment}{// Check if the element has a macro-\/element representation}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01182}01182       \textcolor{keywordflow}{if} (quad\_el\_pt-\/>macro\_elem\_pt() != 0)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01183}01183       \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01184}01184         \textcolor{comment}{// Get a pointer to the corresponding Domain object}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01185}01185         Domain* domain\_pt = quad\_el\_pt-\/>macro\_elem\_pt()-\/>domain\_pt();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01186}01186 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01187}01187         \textcolor{comment}{// How many macro elements are there in this Domain?}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01188}01188         \textcolor{keywordtype}{unsigned} n\_macro\_element = domain\_pt-\/>nmacro\_element();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01189}01189 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01190}01190         \textcolor{comment}{// Create a pointer to point to the extruded version of the above Domain}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01191}01191         ExtrudedDomain* extruded\_domain\_pt = 0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01192}01192 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01193}01193         \textcolor{comment}{// Create an iterator for the map}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01194}01194         std::map<Domain*, ExtrudedDomain*>::iterator it;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01195}01195 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01196}01196         \textcolor{comment}{// Check if there is a corresponding entry in the map}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01197}01197         it = domain\_to\_extruded\_domain\_map.find(domain\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01198}01198 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01199}01199         \textcolor{comment}{// Check if the extruded version of this domain has already been created}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01200}01200         \textcolor{keywordflow}{if} (it != domain\_to\_extruded\_domain\_map.end())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01201}01201         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01202}01202           \textcolor{comment}{// Get the associated ExtrudedDomain pointer}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01203}01203           extruded\_domain\_pt = it-\/>second;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01204}01204         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01205}01205         \textcolor{comment}{// If there is no entry then we need to create the extruded domain}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01206}01206         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01207}01207         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01208}01208           \textcolor{comment}{// Create an ExtrudedDomain object associated with the mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01209}01209           extruded\_domain\_pt = \textcolor{keyword}{new} ExtrudedDomain(domain\_pt, Nz, Zmin, Zmax);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01210}01210 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01211}01211           \textcolor{comment}{// Now store it in the map}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01212}01212           domain\_to\_extruded\_domain\_map[domain\_pt] = extruded\_domain\_pt;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01213}01213 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01214}01214           \textcolor{comment}{// Add it to the mesh's list of extruded domains}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01215}01215           Extruded\_domain\_pt.push\_back(extruded\_domain\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01216}01216         \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01217}01217 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01218}01218         \textcolor{comment}{// Loop over each element slice in the z-\/direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01219}01219         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < Nz; i++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01220}01220         \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01221}01221           \textcolor{comment}{// What is the ID number of the macro element associated with}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01222}01222           \textcolor{comment}{// this quad element?}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01223}01223           \textcolor{keywordtype}{unsigned} macro\_id =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01224}01224             (i * n\_macro\_element +}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01225}01225              quad\_el\_pt-\/>macro\_elem\_pt()-\/>macro\_element\_number());}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01226}01226 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01227}01227           \textcolor{comment}{// Get a pointer to the extruded macro element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01228}01228           ExtrudedMacroElement* extruded\_macro\_element\_pt =}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01229}01229             extruded\_domain\_pt-\/>macro\_element\_pt(macro\_id);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01230}01230 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01231}01231           \textcolor{comment}{// Get the index of the cube element in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01232}01232           \textcolor{keywordtype}{unsigned} element\_index = i * n\_element\_in\_quad\_mesh + e;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01233}01233 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01234}01234           \textcolor{comment}{// Get the corresponding extruded element from the global storage}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01235}01235           ELEMENT* el\_pt = \textcolor{keyword}{dynamic\_cast<}ELEMENT*\textcolor{keyword}{>}(Element\_pt[element\_index]);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01236}01236 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01237}01237           \textcolor{comment}{// Set its macro element pointer}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01238}01238           el\_pt-\/>set\_macro\_elem\_pt(extruded\_macro\_element\_pt);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01239}01239 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01240}01240           \textcolor{comment}{// The number of dimensions in the extruded mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01241}01241           \textcolor{keywordtype}{unsigned} n\_dim = 3;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01242}01242 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01243}01243           \textcolor{comment}{// Loop over the coordinate directions}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01244}01244           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < n\_dim -\/ 1; i++)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01245}01245           \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01246}01246             \textcolor{comment}{// The i-\/th local coordinate value of the "{}lower-\/left"{} corner of}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01247}01247             \textcolor{comment}{// the current element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01248}01248             el\_pt-\/>s\_macro\_ll(i) = quad\_el\_pt-\/>s\_macro\_ll(i);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01249}01249 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01250}01250             \textcolor{comment}{// The i-\/th local coordinate value of the "{}upper-\/right"{} corner of}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01251}01251             \textcolor{comment}{// the current element}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01252}01252             el\_pt-\/>s\_macro\_ur(i) = quad\_el\_pt-\/>s\_macro\_ur(i);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01253}01253           \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01254}01254 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01255}01255           \textcolor{comment}{// The local coordinate value of the "{}lower-\/left"{} corner which}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01256}01256           \textcolor{comment}{// corresponds to the time direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01257}01257           el\_pt-\/>s\_macro\_ll(n\_dim -\/ 1) = -\/1.0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01258}01258 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01259}01259           \textcolor{comment}{// The local coordinate value of the "{}upper-\/right"{} corner which}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01260}01260           \textcolor{comment}{// corresponds to the time direction}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01261}01261           el\_pt-\/>s\_macro\_ur(n\_dim -\/ 1) = 1.0;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01262}01262         \} \textcolor{comment}{// for (unsigned i=0;i<Nz;i++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01263}01263       \} \textcolor{comment}{// if (quad\_el\_pt-\/>macro\_element\_pt()!=0)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01264}01264     \} \textcolor{comment}{// for (unsigned e=0;e<n\_element\_in\_quad\_mesh;e++)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01265}01265 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01266}01266     \textcolor{comment}{// If the user wishes the mesh setup time to be doc-\/ed}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01267}01267     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1MeshExtrusionHelpers_a08b1a4e9b9e1d7b817fa07ea86f8a2e6}{MeshExtrusionHelpers::Mesh\_extrusion\_helper}}.doc\_mesh\_setup\_time())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01268}01268     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01269}01269       \textcolor{comment}{// Tell the user}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01270}01270       oomph\_info << \textcolor{stringliteral}{"{}Time taken to set up extruded macro-\/elements [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01271}01271                  << TimingHelpers::timer() -\/ t\_mesh\_macro\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01272}01272     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01273}01273 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01274}01274     \textcolor{comment}{// Call the node update function to do all the relevant node moving}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01275}01275     node\_update();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01276}01276 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01277}01277 \textcolor{preprocessor}{\#ifdef PARANOID}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01278}01278     \textcolor{comment}{// Make sure there are no duplicate nodes (i.e. two or more nodes that}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01279}01279     \textcolor{comment}{// occupy the same Eulerian position)}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01280}01280     \textcolor{keywordflow}{if} (check\_for\_repeated\_nodes())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01281}01281     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01282}01282       \textcolor{comment}{// Throw a warning}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01283}01283       OomphLibWarning(\textcolor{stringliteral}{"{}The mesh contains repeated nodes!"{}},}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01284}01284                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01285}01285                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01286}01286     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01287}01287 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01288}01288     \textcolor{comment}{// Also make sure enough nodes have been been created}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01289}01289     \textcolor{keywordflow}{if} (node\_count != n\_node\_in\_cube\_mesh)}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01290}01290     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01291}01291       \textcolor{comment}{// Create an ostringstream object to create an error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01292}01292       std::ostringstream error\_message\_stream;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01293}01293 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01294}01294       \textcolor{comment}{// Create the error message}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01295}01295       error\_message\_stream << \textcolor{stringliteral}{"{}An incorrect number of nodes have been created! "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01296}01296                            << \textcolor{stringliteral}{"{}There are\(\backslash\)nmeant to be "{}} << n\_node\_in\_cube\_mesh}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01297}01297                            << \textcolor{stringliteral}{"{} nodes in the extruded mesh but\(\backslash\)nonly "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01298}01298                            << node\_count << \textcolor{stringliteral}{"{} have actually been constructed!"{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01299}01299                            << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01300}01300 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01301}01301       \textcolor{comment}{// Throw a warning}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01302}01302       OomphLibWarning(error\_message\_stream.str(),}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01303}01303                       OOMPH\_CURRENT\_FUNCTION,}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01304}01304                       OOMPH\_EXCEPTION\_LOCATION);}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01305}01305     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01306}01306 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01307}01307 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01308}01308     \textcolor{comment}{// Setup lookup scheme that establishes which elements are located}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01309}01309     \textcolor{comment}{// on the mesh boundaries}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01310}01310     setup\_boundary\_element\_info();}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01311}01311 }
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01312}01312     \textcolor{comment}{// If the user wishes the mesh setup time to be doc-\/ed}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01313}01313     \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceoomph_1_1MeshExtrusionHelpers_a08b1a4e9b9e1d7b817fa07ea86f8a2e6}{MeshExtrusionHelpers::Mesh\_extrusion\_helper}}.doc\_mesh\_setup\_time())}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01314}01314     \{}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01315}01315       \textcolor{comment}{// Tell the user}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01316}01316       oomph\_info << \textcolor{stringliteral}{"{}Total time for extruded mesh creation/setup [sec]: "{}}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01317}01317                  << TimingHelpers::timer() -\/ t\_mesh\_setup\_start << std::endl;}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01318}01318     \}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01319}01319   \} \textcolor{comment}{// End of build\_mesh}}
\DoxyCodeLine{\Hypertarget{extruded__cube__mesh__from__quad__mesh__with__macro__elements_8template_8cc_source_l01320}01320 \} \textcolor{comment}{// End of namespace oomph}}

\end{DoxyCode}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: linear_solvers.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">linear_solvers.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="linear__solvers_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Linear solvers</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">The purpose of this tutorial is to show how to specify different</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">linear solvers for \c oomph-lib&#39;s Newton solver.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">- \ref overview</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">- \ref available_solvers</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">- \ref how_to_change_linear_solver</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">  - \ref direct</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">  - \ref iterative_linear_solvers </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">  - \ref third_party_iterative_linear_solvers</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">- \ref specific_precond</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">\section overview Overview</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> As discussed in the &lt;a href=&quot;../../the_data_structure/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">bottom-up discussion of \c oomph-lib&#39;s data structure&lt;/a&gt;, by default \c</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">oomph-lib&#39;s Newton solver, \c Problem::newton_solve(...) solves</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">the linear systems arising during the Newton iteration </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">with its default linear solver,</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt;&lt;CODE&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">SuperLUSolver&lt;/CODE&gt;&lt;/a&gt;, a wrapper to Demmel, Eistenstat, Gilbert, Li &amp; </span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">Liu&#39;s sparse direct</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">solver &lt;A HREF=&quot;http://crd.lbl.gov/~xiaoye/SuperLU&quot;&gt;SuperLU.&lt;/A&gt; </span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">\c oomph-lib provides a large number of alternative linear solvers</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">that may be used instead. All linear solvers within the library</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">are derived from the base class </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">&lt;a href=&quot;../../the_data_structure/html/classoomph_1_1LinearSolver.html&quot;&gt;&lt;CODE&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">LinearSolver&lt;/CODE&gt;&lt;/a&gt; which contains a single pure virtual function</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\dontinclude linear_solver.h</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\skipline virtual void solve(Problem* const &amp;problem_pt, DoubleVector &amp;result)=0;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">whose task it is to compute the solution \f$ \delta {\bf x} \f$ (returned</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">in the vector \c result) of the linear system</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">{\cal J} \delta {\bf x} = -{\bf r}</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">where \f$ {\bf r} \f$ and  \f$ {\cal J} \f$ are the  global </span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">Jacobian and the residual vector, computed by the \c Problem pointed</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">to by \c problem_pt. The &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1LinearSolver.html&quot;&gt;&lt;CODE&gt;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">LinearSolver&lt;/CODE&gt;&lt;/a&gt; class also defines linear-algebra-type</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">interfaces that allow the solution of linear systems with matrices</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">other than the \c Problem&#39;s Jacobian matrix. However, these methods </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">may not be implemented for all linear solvers. </span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">\section available_solvers List of available linear solvers</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\c oomph-lib&#39;s linear solvers can be sub-divided into </span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">serial and parallel, and direct and iterative linear solvers.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">Here is a quick overview of the available linear solvers. If you</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">are viewing this document online, the links take you directly to</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">the solvers&#39; class references which explain any solver-specific member</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">functions.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">- &lt;B&gt;Serial solvers: &lt;/B&gt; \n\n</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">  - &lt;B&gt;Direct solvers:&lt;/B&gt; \n\n</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">     - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">        &lt;CODE&gt;SuperLUSolver&lt;/CODE&gt;&lt;/a&gt;: \c oomph-lib&#39;s default linear</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">        solver, a wrapper to Demmel, Eistenstat, Gilbert, Li &amp; </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">        Liu&#39;s sparse direct solver </span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">        &lt;A HREF=&quot;http://crd.lbl.gov/~xiaoye/SuperLU&quot;&gt;SuperLU.&lt;/A&gt; \n\n</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">     - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1HSL__MA42.html&quot;&gt;&lt;CODE&gt;HSL_MA42&lt;/CODE&gt;&lt;/a&gt;: A wrapper to the frontal solver MA42 from the </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">        &lt;a href=&quot;http://www.hsl.rl.ac.uk/&quot;&gt;HSL</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">        library.&lt;/a&gt; This solver is available free-of-charge for</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">        UK academics. The source code can be dropped into </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">        the \c oomph-lib distribution; see the instructions in the</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">        dummy code\n\n</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">        &lt;center&gt;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">        &lt;a href=&quot;../../../external_src/oomph_hsl/dummy_frontal.f&quot;&gt; </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">        external_src/oomph_hsl/dummy_frontal.f&lt;/a&gt;\n\n</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">        &lt;/center&gt;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">     - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1DenseLU.html&quot;&gt;&lt;CODE&gt;DenseLU&lt;/CODE&gt;&lt;/a&gt;: A direct solver, based on the LU decomposition of the </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">        Jacobian matrix which is stored as a dense matrix. Given that the </span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">        Jacobian matrices arising from most problems are sparse, </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">        this is likely to be a very inefficient solver. It is mainly </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">        used by the derived (and even more inefficient!) solver </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">        &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1FD__LU.html&quot;&gt;&lt;CODE&gt;FD_LU&lt;/CODE&gt;&lt;/a&gt;.\n\n</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">     - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1FD__LU.html&quot;&gt;&lt;CODE&gt;FD_LU&lt;/CODE&gt;&lt;/a&gt;: Almost certainly the world&#39;s most inefficient solver. </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">       It computes the Jacobian matrix by finite differencing the global</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">       residual vector, without taking any sparsity into account. </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">       Mainly used by developers as a last-resort sanity check.  \n\n</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">     .</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">  - &lt;b&gt;Iterative solvers:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">     - \c oomph-lib provides its own implementations of various </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">       standard iterative linear solvers. They are derived from the base class </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">       &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1IterativeLinearSolver.html&quot;&gt;&lt;CODE&gt;IterativeLinearSolver&lt;/CODE&gt;&lt;/a&gt; and are typically </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">       templated by the matrix type used store the Jacobian matrix. In most</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">       cases you will want to set the template argument \c MATRIX</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">       to \c CRDoubleMatrix: \n\n</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">       - &lt;a  href=&quot;../../the_data_structure/html/classoomph_1_1GMRES.html&quot;&gt;&lt;CODE&gt;GMRES&lt;/CODE&gt;&lt;/a&gt;:</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">          A Krylov subspace solver for symmetric and non-symmetric</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">          linear systems. The memory usage increases with each </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">          iteration but the iteration can be restarted. \n\n</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">       - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1BiCGStab.html&quot;&gt;&lt;CODE&gt;BiCGStab&lt;/CODE&gt;&lt;/a&gt;:</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">         A Krylov subspace method for symmetric and non-symmetric</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">         linear systems. The memory requirement remains constant</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">         throughout the iteration.\n\n</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">       - &lt;a  href=&quot;../../the_data_structure/html/classoomph_1_1CG.html&quot;&gt;&lt;CODE&gt;CG&lt;/CODE&gt;&lt;/a&gt;:</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">         The classical conjugate gradient method for symmetric</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">         positive definite matrices. The memory requirement remains constant</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">         throughout the iteration. \n</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">       - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1GS.html&quot;&gt;&lt;CODE&gt;GS&lt;/CODE&gt;&lt;/a&gt;:</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">         Gauss-Seidel -- a stationary iterative solver. \n\n</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">       .</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">     - \c oomph-lib also provides wrappers to third-party iterative</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">       linear solvers. These tend to provide their own implementations of </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">       \c GMRES, \c BiCGStab, \c CG, etc. but are not necessarily</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">       derived from \c oomph-lib&#39;s own </span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">       &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1IterativeLinearSolver.html&quot;&gt;&lt;CODE&gt;IterativeLinearSolver&lt;/CODE&gt;&lt;/a&gt; base class. \n\n</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">       - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1HypreSolver.html&quot;&gt;&lt;CODE&gt;HypreSolver&lt;/CODE&gt;&lt;/a&gt;: A wrapper to the high-performance linear solvers/preconditioners from the &lt;a href=&quot;https://computation.llnl.gov/casc/linear_solvers/sls_hypre.html&quot;&gt;Scalable Linear Solvers Project.&lt;/A&gt; \n\n</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">       - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1TrilinosAztecOOSolver.html&quot;&gt;&lt;CODE&gt;TrilinosAztecOOSolver&lt;/CODE&gt;&lt;/a&gt;: A wrapper to the linear solvers from the &lt;a href=&quot;http://trilinos.sandia.gov/&quot;&gt;Trilinos Project.&lt;/a&gt;\n\n</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">       .</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">     .</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">  .</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">- &lt;b&gt;Parallel solvers:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">  - &lt;B&gt;Direct solvers:&lt;/B&gt; \n\n</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">     - When \c oomph-lib is compiled with MPI support, its default</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">       linear solver</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">       &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">       &lt;CODE&gt;SuperLUSolver&lt;/CODE&gt;&lt;/a&gt; becomes a wrapper to Demmel, </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">       Eistenstat, Gilbert, Li &amp; Liu&#39;s parallel sparse direct </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">       solver &lt;A HREF=&quot;http://crd.lbl.gov/~xiaoye/SuperLU#superlu_dist&quot;&gt;</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">       SuperLU_DIST.&lt;/A&gt; This behaviour</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">       can be over-ruled with the member function</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">       \code</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">       SuperLUSolver::set_solver_type(...)</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">       \endcode</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">       whose argument must specify one of the three options listed </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">       in the enumeration </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">       \c SuperLUSolver::Type. This allows the serial</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">       solver &lt;A HREF=&quot;http://crd.lbl.gov/~xiaoye/SuperLU&quot;&gt;</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">       SuperLU&lt;/A&gt; to be used even if \c oomph-lib is compiled with MPI</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">       support. </span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">       \n\n</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">     - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1MumpsSolver.html&quot;&gt;</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">       &lt;CODE&gt; MumpsSolver &lt;/CODE&gt;&lt;/a&gt;: is a wrapper to the </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">       &lt;a href=&quot;http://graal.ens-lyon.fr/MUMPS/&quot;&gt; MUMPS &lt;/a&gt; </span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">       multifrontal solver that is available when \c oomph-lib is</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">       compiled with MPI support and support for MUMPS.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">     .</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">  - &lt;B&gt;Iterative solvers:&lt;/B&gt; \n\n</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">     - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1HypreSolver.html&quot;&gt;&lt;CODE&gt;HypreSolver&lt;/CODE&gt;&lt;/a&gt;: A wrapper to the high-performance linear solvers/preconditioners from the &lt;a href=&quot;https://computation.llnl.gov/casc/linear_solvers/sls_hypre.html&quot;&gt;Scalable Linear Solvers Project.&lt;/A&gt; \n\n</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">     - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1TrilinosAztecOOSolver.html&quot;&gt;&lt;CODE&gt;TrilinosAztecOOSolver&lt;/CODE&gt;&lt;/a&gt;: A wrapper to the linear solvers from the &lt;a href=&quot;http://trilinos.sandia.gov/&quot;&gt;Trilinos Project.&lt;/a&gt;\n\n</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">     .</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">\section how_to_change_linear_solver How to change the LinearSolver</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">\subsection direct Direct solvers</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">Changing \c oomph-lib&#39;s linear solver is straightforward. For</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">instance, to change the linear solver to \c oomph-lib&#39;s \c DenseLU</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">solver, simply create an instance of this solver and pass a pointer</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">to it to the \c Problem. This most easily done in the \c Problem</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">constructor:</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">\dontinclude two_d_poisson_dense_lu.cc</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">\skipline Change solver to</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">\until new DenseLU;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">In any subsequent calls to \c oomph-lib&#39;s Newton solver, \c DenseLU</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">will now be used to solve the linear systems arising during the</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">Newton iteration.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">\subsection iterative_linear_solvers Iterative linear solvers and preconditioners</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">The specification of an iterative linear solver is just as easy: For</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">instance, to specify \c oomph-lib&#39;s conjugate gradient solver \c CG</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">(storing the Jacobian matrix in compressed row format) as the linear </span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">solver, add </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">\dontinclude two_d_poisson_cg.cc</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">\skipline Change solver to</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">\until linear_solver_pt()=solver_pt;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">to the problem constructor.</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">We note that, by default, \c oomph-lib&#39;s \c</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">IterativeLinearSolvers perform the preconditioning using </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">the trivial &quot;identity preconditioner&quot;. Most Krylov subspace solvers perform</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">very poorly without some sort of preconditioning. </span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">Specific preconditioners may be implemented by deriving from the</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">\c Preconditioner base class, by implementing its two pure virtual functions</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">\dontinclude preconditioner.h</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">\skipline Apply the preconditioner</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">\until = 0;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">and</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">\dontinclude preconditioner.h</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">\skipline Setup the preconditioner. Pure virtual generic</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">\until = 0;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">Note that, by default, \c oomph-lib&#39;s \c IterativeLinearSolvers </span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">employ left preconditioning.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">\c oomph-lib provides fully-functional implementations of </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">several general-purpose preconditioners. For instance, the zero-fill-in</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">incomplete LU factorisation preconditioner ILU(0) may be employed</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">by adding the lines</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">\dontinclude two_d_poisson_cg.cc</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">\skipline Specify preconditioner</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">\until ILU</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">to the \c Problem constructor.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">Of particular interest is the availability of an &quot;exact preconditioner&quot;  </span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">&lt;a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUPreconditioner.html&quot;&gt;&lt;CODE&gt;SuperLUPreconditioner&lt;/CODE&gt;&lt;/a&gt;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">whose use guarantees the convergence of any iterative solver within</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">a single iteration -- useful for code development.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">\subsection third_party_iterative_linear_solvers Third-party iterative linear solvers and preconditioners</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">\c oomph-lib provides wrappers to various third-party iterative</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">linear solvers and preconditioners. We stress that these solvers are </span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">not necessarily implemented as \c oomph-lib \c IterativeLinearSolvers </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">since their interfaces for the specification of preconditioners, etc</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">may differ from those employed by \c oomph-lib. Furthermore,</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">unlike \c SuperLUSolver these solvers are not</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">distributed as part of \c oomph-lib so you have to build/install them</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">separately before installing \c oomph-lib (\c oomph-lib&#39;s build </span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">machinery can do this for you if you wish;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">see &lt;a href=&quot;../../the_distribution/html/index.html#external_dist&quot;&gt;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">installation instructions&lt;/a&gt; for details). Once this is done, they may</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">be used like any other linear solver.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">\subsubsection trilinos Trilinos</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\c oomph-lib provides wrappers to the iterative linear solvers/preconditioners</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">from the &lt;a href=&quot;http://trilinos.sandia.gov/&quot;&gt;Trilinos Project.&lt;/a&gt;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">The demo code </span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">&lt;a href=&quot;../../../demo_drivers/linear_solvers/TrilinosSolver_test.cc&quot;&gt;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">TrilinosSolver_test.cc&lt;/a&gt; demonstrates how use various combinations</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">of solvers/preconditioners. Here is a brief overview:</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">&lt;b&gt;Trilinos solvers&lt;/b&gt;</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">The wrappers to Trilinos&#39; Krylov subspace solvers are implemented</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">as \c oomph-lib \c IterativeLinearSolvers, allowing them to be used</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">via the standard interfaces described above. For instance, to use</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">\c oomph-lib&#39;s wrapper to \c Trilinos&#39; Aztec solver, using</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">\c Trilinos&#39; \c ML multilevel preconditioner, set the solvers</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">and preconditioners as usual:</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">\dontinclude TrilinosSolver_test.cc</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">\skipline // Create a Trilinos</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">\until problem.linear_solver_pt() = linear_solver_pt;</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">The actual Krylov subspace solver used by the \c Trilinos solver is </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">specified by passing an enumerated flag (defined as static member </span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">data in the \c TrilinosAztecOOSolver class) to the solver. For</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">instance, \c Trilinos&#39; CG, GMRES and BiCGStab solvers are selected with</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">\dontinclude TrilinosSolver_test.cc</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">\skipline linear_solver_pt-&gt;solver_type() = TrilinosAztecOOSolver::CG;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">\skipline linear_solver_pt-&gt;solver_type() = TrilinosAztecOOSolver::GMRES;</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">\skipline  linear_solver_pt-&gt;solver_type() = TrilinosAztecOOSolver::BiCGStab;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">respectively.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">&lt;b&gt;Trilinos preconditioners&lt;/b&gt;</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">\c oomph-lib provides wrappers to \c Trilinos&#39; ML and IFPACK </span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">preconditioners that allows them to be used as \c oomph-lib </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">\c Preconditioners that may be used with  \c oomph-lib&#39;s</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">own \c IterativeLinearSolvers. Here is an example that shows how</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">to build an instance of \c oomph-lib&#39;s \c GMRES, preconditioned</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">with its wrapper to \c Trilinos&#39; \c IFPACK preconditioner:</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">\dontinclude TrilinosSolver_test.cc</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">\skipline Create oomph-lib linear solver</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">\until linear_solver_pt-&gt;preconditioner_pt()=preconditioner_pt;</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">\subsubsection hypre Hypre</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">\c oomph-lib provides wrappers to the high-performance linear</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">solvers/preconditioners from the </span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">&lt;a href=&quot;https://computation.llnl.gov/casc/linear_solvers/sls_hypre.html&quot;&gt;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">Scalable Linear Solvers Project.&lt;/A&gt; The demo code </span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">&lt;a href=&quot;../../../demo_drivers/linear_solvers/HypreSolver_test.cc&quot;&gt;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">HypreSolver_test.cc&lt;/a&gt; demonstrates how use various combinations</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">of solvers/preconditioners. Here is a brief overview:</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">&lt;b&gt;Hypre solvers&lt;/b&gt;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">The wrappers to Hypre&#39;s Krylov subspace and AMG solvers are implemented</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">as \c oomph-lib \c LinearSolvers (not \c IterativeLinearSolvers!)  </span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">so the interfaces for the specification of preconditioners etc.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">differ from those for \c oomph-lib&#39;s own \c IterativeLinearSolvers.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">The \c HypreSolver is set like any other \c LinearSolver:</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">\dontinclude HypreSolver_test.cc</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">\skipline // Create a new Hypre</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">\until  problem.linear_solver_pt() = hypre_linear_solver_pt;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">The actual solver used by the \c HypreSolver is </span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">specified by passing an enumerated flag (defined as static member </span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">data in the \c HypreSolver class) to the solver. For</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">instance, \c Hypre&#39;s AMG, CG, GMRES and BiCGStab solvers are selected with</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">\dontinclude HypreSolver_test.cc</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">\skipline hypre_linear_solver_pt-&gt;hypre_method() = HypreSolver::BoomerAMG;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">\skipline hypre_linear_solver_pt-&gt;hypre_method() = HypreSolver::CG;</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">\skipline hypre_linear_solver_pt-&gt;hypre_method() = HypreSolver::GMRES;</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">\skipline hypre_linear_solver_pt-&gt;hypre_method() = HypreSolver::BiCGStab;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">respectively.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">These Krylov subspace methods may then be preconditioned by</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">\c Hypre&#39;s own (internal) preconditioners, again by specifying the</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">method via an enumerated flag. So, to use no preconditioning,</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">or to precondition with \c BoomerAMG (and AMG-based preconditioner), </span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">\c Euclid (an ILU preconditioner) or \c ParaSails (a sparse approximate</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">inverse preconditioner), set:</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">\skipline hypre_linear_solver_pt-&gt;internal_preconditioner()=HypreSolver::None;</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">\skipline hypre_linear_solver_pt-&gt;internal_preconditioner()=HypreSolver::Boomer</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">\skipline hypre_linear_solver_pt-&gt;internal_preconditioner()=HypreSolver::Eucl</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">\skipline hypre_linear_solver_pt-&gt;internal_preconditioner()=HypreSolver::ParaS</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">respectively.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">&lt;b&gt;Hypre preconditioners&lt;/b&gt;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">\c oomph-lib provides wrappers to \c Hypre&#39;s </span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">preconditioners that allows them to be used as \c oomph-lib </span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">\c Preconditioners that may be used with  \c oomph-lib&#39;s</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">own \c IterativeLinearSolvers. Here is an example that shows how</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">to build an instance of \c oomph-lib&#39;s \c BiCGStab and to use</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">the \c HyprePreconditioner as the preconditioner:</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">\dontinclude HypreSolver_test.cc</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">\skipline  Build and instance of BiCGStab and pass it to the problem</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">\until  problem.linear_solver_pt() = oomph_linear_solver_pt;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">Now we build an instance of a \c HyprePreconditioner</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">\dontinclude HypreSolver_test.cc</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">\skipline // Create a new Hypre preconditioner</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">\until HyprePreconditioner* hypre_preconditioner_pt = new HyprePreconditioner;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">and set it as the \c Preconditioner for \c oomph-lib&#39;s \c BiCGStab solver:</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">\skipline oomph_linear_solver_pt-&gt;preconditioner_pt()=hypre_preconditioner_pt;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">The actual preconditioning methodology to be used by the \c</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">HyprePreconditioner is again selected via enumerated flags, i.e.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">\skipline hypre_preconditioner_pt-&gt;hypre_method() = HyprePreconditioner::Boom</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">\skipline hypre_preconditioner_pt-&gt;hypre_method() = HyprePreconditioner::Euc</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">or </span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">\skipline hypre_preconditioner_pt-&gt;hypre_method() = HyprePreconditioner::Para</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">\section specific_precond Problem-specific preconditioners</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">In addition to &quot;general-purpose&quot; preconditioners like ILU,</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">\c oomph-lib provides a number of problem-specific preconditioners</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">which are typically based on the library&#39;s block preconditioning</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">framework. Separate documentation is available for these:</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">- We provide a (very!) detailed discussion of \c oomph-lib&#39;s</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">  &lt;a href=&quot;../../mpi/block_preconditioners/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">  block preconditioning framework.&lt;/a&gt; \n\n</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">- Another tutorial discusses \c oomph-lib&#39;s </span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">  &lt;a href=&quot;../../mpi/distributed_general_purpose_block_preconditioners/html/index.html&quot;&gt;&quot;general purpose&quot; </span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">  block preconditioners.&lt;/a&gt; \n\n</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">- The NavierStokesSchurComplementPreconditioner</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">  for Navier-Stokes problems is described in its </span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">  &lt;a href=&quot;../../preconditioners/lsc_navier_stokes/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">  own tutorial. &lt;/a&gt; \n\n</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">- The FSIPreconditioner</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">  for monolithically-discretised fluid-structure interaction problems</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">  is described in its </span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">  &lt;a href=&quot;../../preconditioners/fsi/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">  own tutorial&lt;/a&gt; \n\n</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">- We provide a</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">  &lt;a href=&quot;../../preconditioners/prescribed_displ_lagr_mult/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">  preconditioner for large-displacement solid mechanics problems </span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">  in which boundary displacements are prescribed.&lt;/a&gt;\n\n</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">- The previous preconditioner is mainly used as a subsidiary</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">  block preconditioner for the </span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">  &lt;a href=&quot;../../preconditioners/pseudo_solid_fsi/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">  solution of fluid-structure interaction problems with (pseudo-)solid </span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">  fluid mesh updates.&lt;/a&gt; \n\n</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="alinear__solvers_8txt_html_adbda604d1f4851b0b4f0b86c4934d6ce"><div class="ttname"><a href="linear__solvers_8txt.html#adbda604d1f4851b0b4f0b86c4934d6ce">Gilbert</a></div><div class="ttdeci">mainpage Linear solvers The purpose of this tutorial is to show how to specify different linear solvers for c oomph lib s Newton solver ref overview ref available_solvers ref how_to_change_linear_solver ref direct ref iterative_linear_solvers ref third_party_iterative_linear_solvers ref specific_precond&lt; HR &gt;&lt; HR &gt; section overview Overview As discussed in the&lt; a href=&quot;../../the_data_structure/html/index.html&quot;&gt; bottom up discussion of c oomph lib s data by default c oomph lib s Newton c&lt; a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt;&lt; CODE &gt; SuperLUSolver&lt;/CODE &gt;&lt;/a &gt; a wrapper to Gilbert</div><div class="ttdef"><b>Definition:</b> <a href="linear__solvers_8txt_source.html#l00026">linear_solvers.txt:26</a></div></div>
<div class="ttc" id="alinear__solvers_8txt_html_a603c7efd1d7772457a5d74feae1f6a6c"><div class="ttname"><a href="linear__solvers_8txt.html#a603c7efd1d7772457a5d74feae1f6a6c">hypre_preconditioner_pt</a></div><div class="ttdeci">Now we build an instance of a c HyprePreconditioner dontinclude HypreSolver_test cc skipline until HyprePreconditioner * hypre_preconditioner_pt</div><div class="ttdef"><b>Definition:</b> <a href="linear__solvers_8txt_source.html#l00405">linear_solvers.txt:405</a></div></div>
<div class="ttc" id="alinear__solvers_8txt_html_a54b07dfbbce2dee6991d1cd41c1f28b7"><div class="ttname"><a href="linear__solvers_8txt.html#a54b07dfbbce2dee6991d1cd41c1f28b7">Eistenstat</a></div><div class="ttdeci">mainpage Linear solvers The purpose of this tutorial is to show how to specify different linear solvers for c oomph lib s Newton solver ref overview ref available_solvers ref how_to_change_linear_solver ref direct ref iterative_linear_solvers ref third_party_iterative_linear_solvers ref specific_precond&lt; HR &gt;&lt; HR &gt; section overview Overview As discussed in the&lt; a href=&quot;../../the_data_structure/html/index.html&quot;&gt; bottom up discussion of c oomph lib s data by default c oomph lib s Newton c&lt; a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt;&lt; CODE &gt; SuperLUSolver&lt;/CODE &gt;&lt;/a &gt; a wrapper to Eistenstat</div><div class="ttdef"><b>Definition:</b> <a href="linear__solvers_8txt_source.html#l00026">linear_solvers.txt:26</a></div></div>
<div class="ttc" id="alinear__solvers_8txt_html_a860028602e2117cce6271977d9df25f5"><div class="ttname"><a href="linear__solvers_8txt.html#a860028602e2117cce6271977d9df25f5">solver</a></div><div class="ttdeci">mainpage Linear solvers The purpose of this tutorial is to show how to specify different linear solvers for c oomph lib s Newton solver ref overview ref available_solvers ref how_to_change_linear_solver ref direct ref iterative_linear_solvers ref third_party_iterative_linear_solvers ref specific_precond&lt; HR &gt;&lt; HR &gt; section overview Overview As discussed in the&lt; a href=&quot;../../the_data_structure/html/index.html&quot;&gt; bottom up discussion of c oomph lib s data by default c oomph lib s Newton solver</div><div class="ttdef"><b>Definition:</b> <a href="linear__solvers_8txt_source.html#l00022">linear_solvers.txt:22</a></div></div>
<div class="ttc" id="alinear__solvers_8txt_html_ad5921c76b9a989506b6ece7a10b54765"><div class="ttname"><a href="linear__solvers_8txt.html#ad5921c76b9a989506b6ece7a10b54765">internal_preconditioner</a></div><div class="ttdeci">mainpage Linear solvers The purpose of this tutorial is to show how to specify different linear solvers for c oomph lib s Newton solver ref overview ref available_solvers ref how_to_change_linear_solver ref direct ref iterative_linear_solvers ref third_party_iterative_linear_solvers ref specific_precond&lt; HR &gt;&lt; HR &gt; section overview Overview As discussed in the&lt; a href=&quot;../../the_data_structure/html/index.html&quot;&gt; bottom up discussion of c oomph lib s data by default c oomph lib s Newton c&lt; a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt;&lt; CODE &gt; SuperLUSolver&lt;/CODE &gt;&lt;/a &gt; a wrapper to Li &amp;Liu s sparse direct solver&lt; A HREF=&quot;http:\c oomph-lib provides a large number of alternative linear solversthat may be used instead. All linear solvers within the libraryare derived from the base class &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1LinearSolver.html&quot;&gt;&lt;CODE&gt;LinearSolver&lt;/CODE&gt;&lt;/a&gt; which contains a single pure virtual function\dontinclude linear_solver.h\skipline virtual void solve(Problem* const &amp;problem_pt, DoubleVector &amp;result)=0;whose task it is to compute the solution \f$ \delta {\bf x} \f$ (returnedin the vector \c result) of the linear system\f[{\cal J} \delta {\bf x} = -{\bf r}\f]where \f$ {\bf r} \f$ and \f$ {\cal J} \f$ are the global Jacobian and the residual vector, computed by the \c Problem pointedto by \c problem_pt. The &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1LinearSolver.html&quot;&gt;&lt;CODE&gt;LinearSolver&lt;/CODE&gt;&lt;/a&gt; class also defines linear-algebra-typeinterfaces that allow the solution of linear systems with matricesother than the \c Problem's Jacobian matrix. However, these methods may not be implemented for all linear solvers. &lt;HR&gt;&lt;HR&gt;\section available_solvers List of available linear solvers\c oomph-lib's linear solvers can be sub-divided into serial and parallel, and direct and iterative linear solvers.Here is a quick overview of the available linear solvers. If youare viewing this document online, the links take you directly tothe solvers' class references which explain any solver-specific memberfunctions.- &lt;B&gt;Serial solvers: &lt;/B&gt; \n\n - &lt;B&gt;Direct solvers:&lt;/B&gt; \n\n - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt; &lt;CODE&gt;SuperLUSolver&lt;/CODE&gt;&lt;/a&gt;: \c oomph-lib's default linear solver, a wrapper to Demmel, Eistenstat, Gilbert, Li &amp; Liu's sparse direct solver &lt;A HREF=&quot;http:-&lt; a href=&quot;../../the_data_structure/html/classoomph_1_1HSL__MA42.html&quot;&gt;&lt; CODE &gt;HSL_MA42&lt;/CODE &gt;&lt;/a &gt;:A wrapper to the frontal solver MA42 from the&lt; a href=&quot;http: library.&lt;/a&gt; This solver is available free-of-charge for UK academics. The source code can be dropped into the \c oomph-lib distribution; see the instructions in the dummy code\n\n &lt;center&gt; &lt;a href=&quot;../../../external_src/oomph_hsl/dummy_frontal.f&quot;&gt; external_src/oomph_hsl/dummy_frontal.f&lt;/a&gt;\n\n &lt;/center&gt; - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1DenseLU.html&quot;&gt;&lt;CODE&gt;DenseLU&lt;/CODE&gt;&lt;/a&gt;: A direct solver, based on the LU decomposition of the Jacobian matrix which is stored as a dense matrix. Given that the Jacobian matrices arising from most problems are sparse, this is likely to be a very inefficient solver. It is mainly used by the derived (and even more inefficient!) solver &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1FD__LU.html&quot;&gt;&lt;CODE&gt;FD_LU&lt;/CODE&gt;&lt;/a&gt;.\n\n - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1FD__LU.html&quot;&gt;&lt;CODE&gt;FD_LU&lt;/CODE&gt;&lt;/a&gt;: Almost certainly the world's most inefficient solver. It computes the Jacobian matrix by finite differencing the global residual vector, without taking any sparsity into account. Mainly used by developers as a last-resort sanity check. \n\n . - &lt;b&gt;Iterative solvers:&lt;/b&gt; \n\n - \c oomph-lib provides its own implementations of various standard iterative linear solvers. They are derived from the base class &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1IterativeLinearSolver.html&quot;&gt;&lt;CODE&gt;IterativeLinearSolver&lt;/CODE&gt;&lt;/a&gt; and are typically templated by the matrix type used store the Jacobian matrix. In most cases you will want to set the template argument \c MATRIX to \c CRDoubleMatrix: \n\n - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1GMRES.html&quot;&gt;&lt;CODE&gt;GMRES&lt;/CODE&gt;&lt;/a&gt;: A Krylov subspace solver for symmetric and non-symmetric linear systems. The memory usage increases with each iteration but the iteration can be restarted. \n\n - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1BiCGStab.html&quot;&gt;&lt;CODE&gt;BiCGStab&lt;/CODE&gt;&lt;/a&gt;: A Krylov subspace method for symmetric and non-symmetric linear systems. The memory requirement remains constant throughout the iteration.\n\n - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1CG.html&quot;&gt;&lt;CODE&gt;CG&lt;/CODE&gt;&lt;/a&gt;: The classical conjugate gradient method for symmetric positive definite matrices. The memory requirement remains constant throughout the iteration. \n - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1GS.html&quot;&gt;&lt;CODE&gt;GS&lt;/CODE&gt;&lt;/a&gt;: Gauss-Seidel -- a stationary iterative solver. \n\n . - \c oomph-lib also provides wrappers to third-party iterative linear solvers. These tend to provide their own implementations of \c GMRES, \c BiCGStab, \c CG, etc. but are not necessarily derived from \c oomph-lib's own &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1IterativeLinearSolver.html&quot;&gt;&lt;CODE&gt;IterativeLinearSolver&lt;/CODE&gt;&lt;/a&gt; base class. \n\n - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1HypreSolver.html&quot;&gt;&lt;CODE&gt;HypreSolver&lt;/CODE&gt;&lt;/a&gt;: A wrapper to the high-performance linear solvers/preconditioners from the &lt;a href=&quot;https:-&lt; a href=&quot;../../the_data_structure/html/classoomph_1_1TrilinosAztecOOSolver.html&quot;&gt;&lt; CODE &gt;TrilinosAztecOOSolver&lt;/CODE &gt;&lt;/a &gt;:A wrapper to the linear solvers from the&lt; a href=&quot;http: . . .- &lt;b&gt;Parallel solvers:&lt;/b&gt; \n\n - &lt;B&gt;Direct solvers:&lt;/B&gt; \n\n - When \c oomph-lib is compiled with MPI support, its default linear solver &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt; &lt;CODE&gt;SuperLUSolver&lt;/CODE&gt;&lt;/a&gt; becomes a wrapper to Demmel, Eistenstat, Gilbert, Li &amp; Liu's parallel sparse direct solver &lt;A HREF=&quot;http:SuperLU_DIST.&lt;/A &gt; This behaviour can be over-ruled with the member function \code SuperLUSolver::set_solver_type(...) \endcode whose argument must specify one of the three options listed in the enumeration \c SuperLUSolver::Type. This allows the serial solver&lt; A HREF=&quot;http: SuperLU&lt;/A&gt; to be used even if \c oomph-lib is compiled with MPI support. \n\n - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1MumpsSolver.html&quot;&gt; &lt;CODE&gt; MumpsSolver &lt;/CODE&gt;&lt;/a&gt;: is a wrapper to the &lt;a href=&quot;http:multifrontal solver that is available when \c oomph-lib is compiled with MPI support and support for MUMPS. . -&lt; B &gt;Iterative solvers:&lt;/B &gt; \n\n -&lt; a href=&quot;../../the_data_structure/html/classoomph_1_1HypreSolver.html&quot;&gt;&lt; CODE &gt;HypreSolver&lt;/CODE &gt;&lt;/a &gt;:A wrapper to the high-performance linear solvers/preconditioners from the&lt; a href=&quot;https: - &lt;a href=&quot;../../the_data_structure/html/classoomph_1_1TrilinosAztecOOSolver.html&quot;&gt;&lt;CODE&gt;TrilinosAztecOOSolver&lt;/CODE&gt;&lt;/a&gt;: A wrapper to the linear solvers from the &lt;a href=&quot;http:..&lt; HR &gt;&lt; HR &gt; \section how_to_change_linear_solver How to change the LinearSolver\subsection direct Direct solversChanging \c oomph-lib 's linear solver is straightforward. Forinstance, to change the linear solver to \c oomph-lib 's \c DenseLUsolver, simply create an instance of this solver and pass a pointerto it to the \c Problem. This most easily done in the \c Problemconstructor:\dontinclude two_d_poisson_dense_lu.cc\skipline Change solver to\until new DenseLU;In any subsequent calls to \c oomph-lib 's Newton solver, \c DenseLUwill now be used to solve the linear systems arising during theNewton iteration.&lt; HR &gt;&lt; HR &gt;\subsection iterative_linear_solvers Iterative linear solvers and preconditionersThe specification of an iterative linear solver is just as easy:Forinstance, to specify \c oomph-lib 's conjugate gradient solver \c CG(storing the Jacobian matrix in compressed row format) as the linear solver, add \dontinclude two_d_poisson_cg.cc\skipline Change solver to\until linear_solver_pt()=solver_pt;to the problem constructor.We note that, by default, \c oomph-lib 's \cIterativeLinearSolvers perform the preconditioning using the trivial &quot;identity preconditioner&quot;. Most Krylov subspace solvers performvery poorly without some sort of preconditioning. Specific preconditioners may be implemented by deriving from the\c Preconditioner base class, by implementing its two pure virtual functions\dontinclude preconditioner.h\skipline Apply the preconditioner\until=0;and\dontinclude preconditioner.h\skipline Setup the preconditioner. Pure virtual generic\until=0;Note that, by default, \c oomph-lib 's \c IterativeLinearSolvers employ left preconditioning.\c oomph-lib provides fully-functional implementations of several general-purpose preconditioners. For instance, the zero-fill-inincomplete LU factorisation preconditioner ILU(0) may be employedby adding the lines\dontinclude two_d_poisson_cg.cc\skipline Specify preconditioner\until ILUto the \c Problem constructor.Of particular interest is the availability of an &quot;exact preconditioner&quot;&lt; a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUPreconditioner.html&quot;&gt;&lt; CODE &gt;SuperLUPreconditioner&lt;/CODE &gt;&lt;/a &gt;whose use guarantees the convergence of any iterative solver withina single iteration -- useful for code development.&lt; HR &gt;&lt; HR &gt;\subsection third_party_iterative_linear_solvers Third-party iterative linear solvers and preconditioners\c oomph-lib provides wrappers to various third-party iterativelinear solvers and preconditioners. We stress that these solvers are not necessarily implemented as \c oomph-lib \c IterativeLinearSolvers since their interfaces for the specification of preconditioners, etcmay differ from those employed by \c oomph-lib. Furthermore, unlike \c SuperLUSolver these solvers are notdistributed as part of \c oomph-lib so you have to build/install themseparately before installing \c oomph-lib(\c oomph-lib 's build machinery can do this for you if you wish;see&lt; a href=&quot;../../the_distribution/html/index.html#external_dist&quot;&gt;installation instructions&lt;/a &gt; for details). Once this is done, they maybe used like any other linear solver.&lt; HR &gt;\subsubsection trilinos Trilinos\c oomph-lib provides wrappers to the iterative linear solvers/preconditionersfrom the&lt; a href=&quot;http:The demo code &lt;a href=&quot;../../../demo_drivers/linear_solvers/TrilinosSolver_test.cc&quot;&gt;TrilinosSolver_test.cc&lt;/a&gt; demonstrates how use various combinationsof solvers/preconditioners. Here is a brief overview:&lt;b&gt;Trilinos solvers&lt;/b&gt;The wrappers to Trilinos' Krylov subspace solvers are implementedas \c oomph-lib \c IterativeLinearSolvers, allowing them to be usedvia the standard interfaces described above. For instance, to use\c oomph-lib's wrapper to \c Trilinos' Aztec solver, using\c Trilinos' \c ML multilevel preconditioner, set the solversand preconditioners as usual:\dontinclude TrilinosSolver_test.cc\skipline \until problem.linear_solver_pt() = linear_solver_pt;The actual Krylov subspace solver used by the \c Trilinos solver is specified by passing an enumerated flag (defined as static member data in the \c TrilinosAztecOOSolver class) to the solver. Forinstance, \c Trilinos' CG, GMRES and BiCGStab solvers are selected with\dontinclude TrilinosSolver_test.cc\skipline linear_solver_pt-&gt;solver_type() = TrilinosAztecOOSolver::CG;or \skipline linear_solver_pt-&gt;solver_type() = TrilinosAztecOOSolver::GMRES;or \skipline linear_solver_pt-&gt;solver_type() = TrilinosAztecOOSolver::BiCGStab;respectively.&lt;b&gt;Trilinos preconditioners&lt;/b&gt;\c oomph-lib provides wrappers to \c Trilinos' ML and IFPACK preconditioners that allows them to be used as \c oomph-lib \c Preconditioners that may be used with \c oomph-lib'sown \c IterativeLinearSolvers. Here is an example that shows howto build an instance of \c oomph-lib's \c GMRES, preconditionedwith its wrapper to \c Trilinos' \c IFPACK preconditioner:\dontinclude TrilinosSolver_test.cc\skipline Create oomph-lib linear solver\until linear_solver_pt-&gt;preconditioner_pt()=preconditioner_pt;&lt;HR&gt;&lt;HR&gt;\subsubsection hypre Hypre\c oomph-lib provides wrappers to the high-performance linearsolvers/preconditioners from the &lt;a href=&quot;https:Scalable Linear Solvers Project.&lt;/A &gt; The demo code&lt; a href=&quot;../../../demo_drivers/linear_solvers/HypreSolver_test.cc&quot;&gt;HypreSolver_test.cc&lt;/a &gt; demonstrates how use various combinationsof solvers/preconditioners. Here is a brief overview:&lt; b &gt;Hypre solvers&lt;/b &gt;The wrappers to Hypre 's Krylov subspace and AMG solvers are implementedas \c oomph-lib \c LinearSolvers(not \c IterativeLinearSolvers!) so the interfaces for the specification of preconditioners etc.differ from those for \c oomph-lib 's own \c IterativeLinearSolvers.The \c HypreSolver is set like any other \c LinearSolver:\dontinclude HypreSolver_test.cc\skipline \until problem.linear_solver_pt()=hypre_linear_solver_pt;The actual solver used by the \c HypreSolver is specified by passing an enumerated flag(defined as static member data in the \c HypreSolver class) to the solver. Forinstance, \c Hypre 's AMG, CG, GMRES and BiCGStab solvers are selected with\dontinclude HypreSolver_test.cc\skipline hypre_linear_solver_pt-&gt;hypre_method()=HypreSolver::BoomerAMG;or \skipline hypre_linear_solver_pt-&gt;hypre_method()=HypreSolver::CG;or \skipline hypre_linear_solver_pt-&gt;hypre_method()=HypreSolver::GMRES;or \skipline hypre_linear_solver_pt-&gt;hypre_method()=HypreSolver::BiCGStab;respectively.These Krylov subspace methods may then be preconditioned by\c Hypre 's own(internal) preconditioners, again by specifying themethod via an enumerated flag. So, to use no preconditioning, or to precondition with \c BoomerAMG(and AMG-based preconditioner), \c Euclid(an ILU preconditioner) or \c ParaSails(a sparse approximateinverse preconditioner), set:\skipline hypre_linear_solver_pt-&gt;internal_preconditioner()=HypreSolver::None;or \skipline hypre_linear_solver_pt-&gt;internal_preconditioner()=HypreSolver::Boomeror \skipline hypre_linear_solver_pt-&gt;internal_preconditioner()=HypreSolver::Euclor \skipline hypre_linear_solver_pt-&gt; internal_preconditioner()</div><div class="ttdef"><b>Definition:</b> <a href="linear__solvers_8txt_source.html#l00384">linear_solvers.txt:384</a></div></div>
<div class="ttc" id="alinear__solvers_8txt_html_ad0e238e1f37bba5256f920af211eda9d"><div class="ttname"><a href="linear__solvers_8txt.html#ad0e238e1f37bba5256f920af211eda9d">Demmel</a></div><div class="ttdeci">mainpage Linear solvers The purpose of this tutorial is to show how to specify different linear solvers for c oomph lib s Newton solver ref overview ref available_solvers ref how_to_change_linear_solver ref direct ref iterative_linear_solvers ref third_party_iterative_linear_solvers ref specific_precond&lt; HR &gt;&lt; HR &gt; section overview Overview As discussed in the&lt; a href=&quot;../../the_data_structure/html/index.html&quot;&gt; bottom up discussion of c oomph lib s data by default c oomph lib s Newton c&lt; a href=&quot;../../the_data_structure/html/classoomph_1_1SuperLUSolver.html&quot;&gt;&lt; CODE &gt; SuperLUSolver&lt;/CODE &gt;&lt;/a &gt; a wrapper to Demmel</div><div class="ttdef"><b>Definition:</b> <a href="linear__solvers_8txt_source.html#l00026">linear_solvers.txt:26</a></div></div>
<div class="ttc" id="alinear__solvers_8txt_html_a928af980e34ad7b793176aa0b2b01344"><div class="ttname"><a href="linear__solvers_8txt.html#a928af980e34ad7b793176aa0b2b01344">flags</a></div><div class="ttdeci">The actual preconditioning methodology to be used by the c HyprePreconditioner is again selected via enumerated flags</div><div class="ttdef"><b>Definition:</b> <a href="linear__solvers_8txt_source.html#l00413">linear_solvers.txt:413</a></div></div>
<div class="ttc" id="alinear__solvers_8txt_html_a48b51185c1aafe91ac3ea57bf24915f9"><div class="ttname"><a href="linear__solvers_8txt.html#a48b51185c1aafe91ac3ea57bf24915f9">hypre_method</a></div><div class="ttdeci">The actual preconditioning methodology to be used by the c HyprePreconditioner is again selected via enumerated i e skipline hypre_preconditioner_pt hypre_method()</div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 9 2021 15:30:43
        </div>
      </div>
    </footer>
</body>
</html>
